[
   {
      "body" : "needs rebase",
      "created_at" : "2015-09-23T22:52:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-142754265",
      "id" : 142754265,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-09-23T22:52:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/142754265",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7275704?v=3",
         "events_url" : "https://api.github.com/users/btcdrak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/btcdrak/followers",
         "following_url" : "https://api.github.com/users/btcdrak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/btcdrak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/btcdrak",
         "id" : 7275704,
         "login" : "btcdrak",
         "organizations_url" : "https://api.github.com/users/btcdrak/orgs",
         "received_events_url" : "https://api.github.com/users/btcdrak/received_events",
         "repos_url" : "https://api.github.com/users/btcdrak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/btcdrak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/btcdrak"
      }
   },
   {
      "body" : "This pull request has been updated to no longer be dependent on #6312 or #6564.",
      "created_at" : "2015-10-16T00:27:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-148560327",
      "id" : 148560327,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-16T00:27:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/148560327",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "body" : "@maaku awesome.",
      "created_at" : "2015-10-16T00:33:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-148561038",
      "id" : 148561038,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-16T00:33:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/148561038",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42332216"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42332216"
         }
      },
      "body" : "Minor nit: Other than removing the assertion on cs_main, is there any advantage to calling IsFinalTx directly rather than CheckFinalTx? If that difference could be important I would suggest having two versions of CheckFinalTx, one that does not have the assertion and one that has the assertion and calls the other one, since the rest of the logic seems to just be getting duplicated.",
      "commit_id" : "dea8d21fc63e9f442299c97010e4740558f4f037",
      "created_at" : "2015-10-19T02:21:01Z",
      "diff_hunk" : "@@ -797,10 +822,14 @@ bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransa\n     if (fRequireStandard && !IsStandardTx(tx, reason))\n         return state.DoS(0, false, REJECT_NONSTANDARD, reason);\n \n+    int64_t nLockTimeCutoff = (STANDARD_LOCKTIME_VERIFY_FLAGS & LOCKTIME_MEDIAN_TIME_PAST)\n+                            ? chainActive.Tip()->GetMedianTimePast()\n+                            : GetAdjustedTime();\n+\n     // Only accept nLockTime-using transactions that can be mined in the next\n     // block; we don't want our mempool filled up with transactions that can't\n     // be mined yet.\n-    if (!CheckFinalTx(tx))\n+    if (!IsFinalTx(tx, chainActive.Height() + 1, nLockTimeCutoff))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42332216",
      "id" : 42332216,
      "original_commit_id" : "6bd1f3c4d443de2066514008f72002c5f213d51e",
      "original_position" : 50,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566",
      "updated_at" : "2015-10-23T16:03:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42332216",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/894059?v=3",
         "events_url" : "https://api.github.com/users/CodeShark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/CodeShark/followers",
         "following_url" : "https://api.github.com/users/CodeShark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/CodeShark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/CodeShark",
         "id" : 894059,
         "login" : "CodeShark",
         "organizations_url" : "https://api.github.com/users/CodeShark/orgs",
         "received_events_url" : "https://api.github.com/users/CodeShark/received_events",
         "repos_url" : "https://api.github.com/users/CodeShark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/CodeShark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/CodeShark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/CodeShark"
      }
   },
   {
      "body" : "utACK",
      "created_at" : "2015-10-19T02:23:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-149079502",
      "id" : 149079502,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-19T02:23:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/149079502",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/894059?v=3",
         "events_url" : "https://api.github.com/users/CodeShark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/CodeShark/followers",
         "following_url" : "https://api.github.com/users/CodeShark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/CodeShark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/CodeShark",
         "id" : 894059,
         "login" : "CodeShark",
         "organizations_url" : "https://api.github.com/users/CodeShark/orgs",
         "received_events_url" : "https://api.github.com/users/CodeShark/received_events",
         "repos_url" : "https://api.github.com/users/CodeShark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/CodeShark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/CodeShark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/CodeShark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42332621"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42332621"
         }
      },
      "body" : "style nit: braces not required for this `if`",
      "commit_id" : "dea8d21fc63e9f442299c97010e4740558f4f037",
      "created_at" : "2015-10-19T02:33:48Z",
      "diff_hunk" : "@@ -2693,10 +2722,15 @@ bool ContextualCheckBlock(const CBlock& block, CValidationState& state, CBlockIn\n     const Consensus::Params& consensusParams = Params().GetConsensus();\n \n     // Check that all transactions are finalized\n-    BOOST_FOREACH(const CTransaction& tx, block.vtx)\n-        if (!IsFinalTx(tx, nHeight, block.GetBlockTime())) {\n+    BOOST_FOREACH(const CTransaction& tx, block.vtx) {\n+        int nLockTimeFlags = 0;\n+        int64_t nLockTimeCutoff = (nLockTimeFlags & LOCKTIME_MEDIAN_TIME_PAST)\n+                                ? pindexPrev->GetMedianTimePast()\n+                                : block.GetBlockTime();\n+        if (!IsFinalTx(tx, nHeight, nLockTimeCutoff)) {\n             return state.DoS(10, error(\"%s: contains a non-final transaction\", __func__), REJECT_INVALID, \"bad-txns-nonfinal\");\n         }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42332621",
      "id" : 42332621,
      "original_commit_id" : "6bd1f3c4d443de2066514008f72002c5f213d51e",
      "original_position" : 67,
      "path" : "src/main.cpp",
      "position" : 60,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566",
      "updated_at" : "2015-10-23T16:03:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42332621",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7275704?v=3",
         "events_url" : "https://api.github.com/users/btcdrak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/btcdrak/followers",
         "following_url" : "https://api.github.com/users/btcdrak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/btcdrak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/btcdrak",
         "id" : 7275704,
         "login" : "btcdrak",
         "organizations_url" : "https://api.github.com/users/btcdrak/orgs",
         "received_events_url" : "https://api.github.com/users/btcdrak/received_events",
         "repos_url" : "https://api.github.com/users/btcdrak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/btcdrak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/btcdrak"
      }
   },
   {
      "body" : "utACK",
      "created_at" : "2015-10-19T09:04:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-149152068",
      "id" : 149152068,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-19T09:04:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/149152068",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7275704?v=3",
         "events_url" : "https://api.github.com/users/btcdrak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/btcdrak/followers",
         "following_url" : "https://api.github.com/users/btcdrak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/btcdrak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/btcdrak",
         "id" : 7275704,
         "login" : "btcdrak",
         "organizations_url" : "https://api.github.com/users/btcdrak/orgs",
         "received_events_url" : "https://api.github.com/users/btcdrak/received_events",
         "repos_url" : "https://api.github.com/users/btcdrak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/btcdrak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/btcdrak"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42354524"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42354524"
         }
      },
      "body" : "IsFinalTx is compatible with libconsensus, CheckFinalTx (by using globals) is not.\r\nConsensus functions cannot access globals like chainActive or GetAdjustedTime() directly.",
      "commit_id" : "dea8d21fc63e9f442299c97010e4740558f4f037",
      "created_at" : "2015-10-19T10:07:17Z",
      "diff_hunk" : "@@ -797,10 +822,14 @@ bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransa\n     if (fRequireStandard && !IsStandardTx(tx, reason))\n         return state.DoS(0, false, REJECT_NONSTANDARD, reason);\n \n+    int64_t nLockTimeCutoff = (STANDARD_LOCKTIME_VERIFY_FLAGS & LOCKTIME_MEDIAN_TIME_PAST)\n+                            ? chainActive.Tip()->GetMedianTimePast()\n+                            : GetAdjustedTime();\n+\n     // Only accept nLockTime-using transactions that can be mined in the next\n     // block; we don't want our mempool filled up with transactions that can't\n     // be mined yet.\n-    if (!CheckFinalTx(tx))\n+    if (!IsFinalTx(tx, chainActive.Height() + 1, nLockTimeCutoff))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42354524",
      "id" : 42354524,
      "original_commit_id" : "6bd1f3c4d443de2066514008f72002c5f213d51e",
      "original_position" : 50,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566",
      "updated_at" : "2015-10-23T16:03:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42354524",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42404017"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42404017"
         }
      },
      "body" : "Braces already existed. Principle of smallest diff :)",
      "commit_id" : "dea8d21fc63e9f442299c97010e4740558f4f037",
      "created_at" : "2015-10-19T17:59:07Z",
      "diff_hunk" : "@@ -2693,10 +2722,15 @@ bool ContextualCheckBlock(const CBlock& block, CValidationState& state, CBlockIn\n     const Consensus::Params& consensusParams = Params().GetConsensus();\n \n     // Check that all transactions are finalized\n-    BOOST_FOREACH(const CTransaction& tx, block.vtx)\n-        if (!IsFinalTx(tx, nHeight, block.GetBlockTime())) {\n+    BOOST_FOREACH(const CTransaction& tx, block.vtx) {\n+        int nLockTimeFlags = 0;\n+        int64_t nLockTimeCutoff = (nLockTimeFlags & LOCKTIME_MEDIAN_TIME_PAST)\n+                                ? pindexPrev->GetMedianTimePast()\n+                                : block.GetBlockTime();\n+        if (!IsFinalTx(tx, nHeight, nLockTimeCutoff)) {\n             return state.DoS(10, error(\"%s: contains a non-final transaction\", __func__), REJECT_INVALID, \"bad-txns-nonfinal\");\n         }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42404017",
      "id" : 42404017,
      "original_commit_id" : "6bd1f3c4d443de2066514008f72002c5f213d51e",
      "original_position" : 67,
      "path" : "src/main.cpp",
      "position" : 60,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566",
      "updated_at" : "2015-10-23T16:03:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42404017",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42404520"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42404520"
         }
      },
      "body" : "This isn't consensus code though. @CodeShark is right, we can save some lines by calling CheckFinalTx with an explicit flags parameter. I've made the change.",
      "commit_id" : "dea8d21fc63e9f442299c97010e4740558f4f037",
      "created_at" : "2015-10-19T18:02:36Z",
      "diff_hunk" : "@@ -797,10 +822,14 @@ bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransa\n     if (fRequireStandard && !IsStandardTx(tx, reason))\n         return state.DoS(0, false, REJECT_NONSTANDARD, reason);\n \n+    int64_t nLockTimeCutoff = (STANDARD_LOCKTIME_VERIFY_FLAGS & LOCKTIME_MEDIAN_TIME_PAST)\n+                            ? chainActive.Tip()->GetMedianTimePast()\n+                            : GetAdjustedTime();\n+\n     // Only accept nLockTime-using transactions that can be mined in the next\n     // block; we don't want our mempool filled up with transactions that can't\n     // be mined yet.\n-    if (!CheckFinalTx(tx))\n+    if (!IsFinalTx(tx, chainActive.Height() + 1, nLockTimeCutoff))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42404520",
      "id" : 42404520,
      "original_commit_id" : "6bd1f3c4d443de2066514008f72002c5f213d51e",
      "original_position" : 50,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566",
      "updated_at" : "2015-10-23T16:03:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42404520",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "body" : "Nits addressed and rebased.",
      "created_at" : "2015-10-19T21:09:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-149348318",
      "id" : 149348318,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-19T21:09:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/149348318",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "body" : "Travis is happy.",
      "created_at" : "2015-10-20T00:32:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-149385143",
      "id" : 149385143,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-20T00:32:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/149385143",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "body" : "~~How does this mempool-only change stop the miners from just using their own mempool policies?~~\r\n\r\n**edit:** nvm\r\n>  This is not the soft-fork required to actually rely on the new constraint in production.\r\n\r\n---\r\n\r\nconcept ACK,  though I'd prefer to see a plan for merging the soft-fork before accepting this.",
      "created_at" : "2015-10-20T10:16:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-149511238",
      "id" : 149511238,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-20T11:57:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/149511238",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "body" : "@dcousens These rules will be eventually enforced through a soft-fork.",
      "created_at" : "2015-10-20T11:20:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-149531485",
      "id" : 149531485,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-20T11:20:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/149531485",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7275704?v=3",
         "events_url" : "https://api.github.com/users/btcdrak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/btcdrak/followers",
         "following_url" : "https://api.github.com/users/btcdrak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/btcdrak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/btcdrak",
         "id" : 7275704,
         "login" : "btcdrak",
         "organizations_url" : "https://api.github.com/users/btcdrak/orgs",
         "received_events_url" : "https://api.github.com/users/btcdrak/received_events",
         "repos_url" : "https://api.github.com/users/btcdrak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/btcdrak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/btcdrak"
      }
   },
   {
      "body" : "@dcousens As discussed at the RC meeting on the 15th, we aim to roll this out with CLTV using standard ISM.",
      "created_at" : "2015-10-20T13:03:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-149561636",
      "id" : 149561636,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-20T13:03:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/149561636",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7275704?v=3",
         "events_url" : "https://api.github.com/users/btcdrak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/btcdrak/followers",
         "following_url" : "https://api.github.com/users/btcdrak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/btcdrak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/btcdrak",
         "id" : 7275704,
         "login" : "btcdrak",
         "organizations_url" : "https://api.github.com/users/btcdrak/orgs",
         "received_events_url" : "https://api.github.com/users/btcdrak/received_events",
         "repos_url" : "https://api.github.com/users/btcdrak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/btcdrak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/btcdrak"
      }
   },
   {
      "body" : "Ack.  Please apply soon :)",
      "created_at" : "2015-10-21T00:03:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-149739706",
      "id" : 149739706,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-21T00:03:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/149739706",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/775844?v=3",
         "events_url" : "https://api.github.com/users/rustyrussell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rustyrussell/followers",
         "following_url" : "https://api.github.com/users/rustyrussell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rustyrussell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rustyrussell",
         "id" : 775844,
         "login" : "rustyrussell",
         "organizations_url" : "https://api.github.com/users/rustyrussell/orgs",
         "received_events_url" : "https://api.github.com/users/rustyrussell/received_events",
         "repos_url" : "https://api.github.com/users/rustyrussell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rustyrussell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rustyrussell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rustyrussell"
      }
   },
   {
      "body" : "ACK. ",
      "created_at" : "2015-10-21T00:49:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-149745568",
      "id" : 149745568,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-21T00:49:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/149745568",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "body" : "utACK",
      "created_at" : "2015-10-21T19:38:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-150003294",
      "id" : 150003294,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-21T19:38:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/150003294",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1492956?v=3",
         "events_url" : "https://api.github.com/users/jmcorgan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jmcorgan/followers",
         "following_url" : "https://api.github.com/users/jmcorgan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jmcorgan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jmcorgan",
         "id" : 1492956,
         "login" : "jmcorgan",
         "organizations_url" : "https://api.github.com/users/jmcorgan/orgs",
         "received_events_url" : "https://api.github.com/users/jmcorgan/received_events",
         "repos_url" : "https://api.github.com/users/jmcorgan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jmcorgan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jmcorgan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jmcorgan"
      }
   },
   {
      "body" : "ACK",
      "created_at" : "2015-10-21T22:53:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-150047105",
      "id" : 150047105,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-21T22:53:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/150047105",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5617245?v=3",
         "events_url" : "https://api.github.com/users/afk11/events{/privacy}",
         "followers_url" : "https://api.github.com/users/afk11/followers",
         "following_url" : "https://api.github.com/users/afk11/following{/other_user}",
         "gists_url" : "https://api.github.com/users/afk11/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/afk11",
         "id" : 5617245,
         "login" : "afk11",
         "organizations_url" : "https://api.github.com/users/afk11/orgs",
         "received_events_url" : "https://api.github.com/users/afk11/received_events",
         "repos_url" : "https://api.github.com/users/afk11/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/afk11/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/afk11/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/afk11"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42727618"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42727618"
         }
      },
      "body" : "Why is this `(1<<1)` and not `(1<<0)` ? I don't think it interacts with any other flags. Hard to see from the context.",
      "commit_id" : "dea8d21fc63e9f442299c97010e4740558f4f037",
      "created_at" : "2015-10-22T09:29:02Z",
      "diff_hunk" : "@@ -13,4 +13,10 @@ static const unsigned int MAX_BLOCK_SIGOPS = MAX_BLOCK_SIZE/50;\n /** Coinbase transaction outputs can only be spent after this number of new blocks (network rule) */\n static const int COINBASE_MATURITY = 100;\n \n+/** Flags for LockTime() */\n+enum {\n+    /* Use GetMedianTimePast() instead of nTime for end point timestamp. */\n+    LOCKTIME_MEDIAN_TIME_PAST = (1 << 1),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42727618",
      "id" : 42727618,
      "original_commit_id" : "3bd176969c0a9470924fcfe95c7346603cf571be",
      "original_position" : 7,
      "path" : "src/consensus/consensus.h",
      "position" : 7,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566",
      "updated_at" : "2015-10-23T16:03:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42727618",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42727916"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42727916"
         }
      },
      "body" : "If the value comes from the BIP, please add a reference",
      "commit_id" : "dea8d21fc63e9f442299c97010e4740558f4f037",
      "created_at" : "2015-10-22T09:31:52Z",
      "diff_hunk" : "@@ -13,4 +13,10 @@ static const unsigned int MAX_BLOCK_SIGOPS = MAX_BLOCK_SIZE/50;\n /** Coinbase transaction outputs can only be spent after this number of new blocks (network rule) */\n static const int COINBASE_MATURITY = 100;\n \n+/** Flags for LockTime() */\n+enum {\n+    /* Use GetMedianTimePast() instead of nTime for end point timestamp. */\n+    LOCKTIME_MEDIAN_TIME_PAST = (1 << 1),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42727916",
      "id" : 42727916,
      "original_commit_id" : "3bd176969c0a9470924fcfe95c7346603cf571be",
      "original_position" : 7,
      "path" : "src/consensus/consensus.h",
      "position" : 7,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566",
      "updated_at" : "2015-10-23T16:03:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42727916",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42728075"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42728075"
         }
      },
      "body" : "Add a comment about the flags field, e.g. where they come from",
      "commit_id" : "dea8d21fc63e9f442299c97010e4740558f4f037",
      "created_at" : "2015-10-22T09:34:31Z",
      "diff_hunk" : "@@ -305,7 +305,7 @@ bool IsFinalTx(const CTransaction &tx, int nBlockHeight, int64_t nBlockTime);\n  *\n  * Calls IsFinalTx() with current block height and appropriate block time.\n  */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42728075",
      "id" : 42728075,
      "original_commit_id" : "3bd176969c0a9470924fcfe95c7346603cf571be",
      "original_position" : 3,
      "path" : "src/main.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566",
      "updated_at" : "2015-10-23T16:03:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42728075",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "utACK",
      "created_at" : "2015-10-22T09:43:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-150163322",
      "id" : 150163322,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-22T09:43:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/150163322",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649160?v=3",
         "events_url" : "https://api.github.com/users/rubensayshi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rubensayshi/followers",
         "following_url" : "https://api.github.com/users/rubensayshi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rubensayshi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rubensayshi",
         "id" : 649160,
         "login" : "rubensayshi",
         "organizations_url" : "https://api.github.com/users/rubensayshi/orgs",
         "received_events_url" : "https://api.github.com/users/rubensayshi/received_events",
         "repos_url" : "https://api.github.com/users/rubensayshi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rubensayshi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rubensayshi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rubensayshi"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42728857"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42728857"
         }
      },
      "body" : "There's nothing about brace usage for single-statement blocks in the developer-guide, so let's not nit about this. Also personally I like using braces everywhere where possible to avoid famous bugs like\r\n```\r\nif (something)\r\n    do_something_else();\r\n    goto handle_error;\r\n```\r\n",
      "commit_id" : "dea8d21fc63e9f442299c97010e4740558f4f037",
      "created_at" : "2015-10-22T09:45:00Z",
      "diff_hunk" : "@@ -2693,10 +2722,15 @@ bool ContextualCheckBlock(const CBlock& block, CValidationState& state, CBlockIn\n     const Consensus::Params& consensusParams = Params().GetConsensus();\n \n     // Check that all transactions are finalized\n-    BOOST_FOREACH(const CTransaction& tx, block.vtx)\n-        if (!IsFinalTx(tx, nHeight, block.GetBlockTime())) {\n+    BOOST_FOREACH(const CTransaction& tx, block.vtx) {\n+        int nLockTimeFlags = 0;\n+        int64_t nLockTimeCutoff = (nLockTimeFlags & LOCKTIME_MEDIAN_TIME_PAST)\n+                                ? pindexPrev->GetMedianTimePast()\n+                                : block.GetBlockTime();\n+        if (!IsFinalTx(tx, nHeight, nLockTimeCutoff)) {\n             return state.DoS(10, error(\"%s: contains a non-final transaction\", __func__), REJECT_INVALID, \"bad-txns-nonfinal\");\n         }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42728857",
      "id" : 42728857,
      "original_commit_id" : "6bd1f3c4d443de2066514008f72002c5f213d51e",
      "original_position" : 67,
      "path" : "src/main.cpp",
      "position" : 60,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566",
      "updated_at" : "2015-10-23T16:03:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42728857",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42729640"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42729640"
         }
      },
      "body" : "OK, agreed.",
      "commit_id" : "dea8d21fc63e9f442299c97010e4740558f4f037",
      "created_at" : "2015-10-22T09:54:52Z",
      "diff_hunk" : "@@ -2693,10 +2722,15 @@ bool ContextualCheckBlock(const CBlock& block, CValidationState& state, CBlockIn\n     const Consensus::Params& consensusParams = Params().GetConsensus();\n \n     // Check that all transactions are finalized\n-    BOOST_FOREACH(const CTransaction& tx, block.vtx)\n-        if (!IsFinalTx(tx, nHeight, block.GetBlockTime())) {\n+    BOOST_FOREACH(const CTransaction& tx, block.vtx) {\n+        int nLockTimeFlags = 0;\n+        int64_t nLockTimeCutoff = (nLockTimeFlags & LOCKTIME_MEDIAN_TIME_PAST)\n+                                ? pindexPrev->GetMedianTimePast()\n+                                : block.GetBlockTime();\n+        if (!IsFinalTx(tx, nHeight, nLockTimeCutoff)) {\n             return state.DoS(10, error(\"%s: contains a non-final transaction\", __func__), REJECT_INVALID, \"bad-txns-nonfinal\");\n         }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42729640",
      "id" : 42729640,
      "original_commit_id" : "6bd1f3c4d443de2066514008f72002c5f213d51e",
      "original_position" : 67,
      "path" : "src/main.cpp",
      "position" : 60,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566",
      "updated_at" : "2015-10-23T16:03:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42729640",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7275704?v=3",
         "events_url" : "https://api.github.com/users/btcdrak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/btcdrak/followers",
         "following_url" : "https://api.github.com/users/btcdrak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/btcdrak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/btcdrak",
         "id" : 7275704,
         "login" : "btcdrak",
         "organizations_url" : "https://api.github.com/users/btcdrak/orgs",
         "received_events_url" : "https://api.github.com/users/btcdrak/received_events",
         "repos_url" : "https://api.github.com/users/btcdrak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/btcdrak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/btcdrak"
      }
   },
   {
      "body" : "I think this code would be easier to be confident if it was (and would remain) consensus-correct if it introduced a second IsFinal() (or the like) and then used that explicitly from the mempool codepath. The max on the flags is a fairly weird operation. \r\n\r\nConcept ACK.",
      "created_at" : "2015-10-22T18:16:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-150310861",
      "id" : 150310861,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-22T19:35:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/150310861",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "utACK\r\n\r\n@gmaxwell's nit doesn't bother me, as the CheckFinalTx() function wasn't supposed to be used in consensus code anyway.",
      "created_at" : "2015-10-22T19:40:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-150334351",
      "id" : 150334351,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-22T19:40:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/150334351",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42796070"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42796070"
         }
      },
      "body" : "almost-bike-shedding: Are we going to have CheckFinalTx flags or something more generic like Transaction validation flags?",
      "commit_id" : "dea8d21fc63e9f442299c97010e4740558f4f037",
      "created_at" : "2015-10-22T19:41:30Z",
      "diff_hunk" : "@@ -13,4 +13,10 @@ static const unsigned int MAX_BLOCK_SIGOPS = MAX_BLOCK_SIZE/50;\n /** Coinbase transaction outputs can only be spent after this number of new blocks (network rule) */\n static const int COINBASE_MATURITY = 100;\n \n+/** Flags for LockTime() */\n+enum {\n+    /* Use GetMedianTimePast() instead of nTime for end point timestamp. */\n+    LOCKTIME_MEDIAN_TIME_PAST = (1 << 1),\n+};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42796070",
      "id" : 42796070,
      "original_commit_id" : "6bd1f3c4d443de2066514008f72002c5f213d51e",
      "original_position" : 8,
      "path" : "src/consensus/consensus.h",
      "position" : 8,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566",
      "updated_at" : "2015-10-23T16:03:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42796070",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "utACK",
      "created_at" : "2015-10-22T19:44:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-150335419",
      "id" : 150335419,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-22T19:44:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/150335419",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42797032"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42797032"
         }
      },
      "body" : "Because #6312, which this was originally built on top of, uses `(1<<0)`.",
      "commit_id" : "dea8d21fc63e9f442299c97010e4740558f4f037",
      "created_at" : "2015-10-22T19:50:37Z",
      "diff_hunk" : "@@ -13,4 +13,10 @@ static const unsigned int MAX_BLOCK_SIGOPS = MAX_BLOCK_SIZE/50;\n /** Coinbase transaction outputs can only be spent after this number of new blocks (network rule) */\n static const int COINBASE_MATURITY = 100;\n \n+/** Flags for LockTime() */\n+enum {\n+    /* Use GetMedianTimePast() instead of nTime for end point timestamp. */\n+    LOCKTIME_MEDIAN_TIME_PAST = (1 << 1),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42797032",
      "id" : 42797032,
      "original_commit_id" : "3bd176969c0a9470924fcfe95c7346603cf571be",
      "original_position" : 7,
      "path" : "src/consensus/consensus.h",
      "position" : 7,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566",
      "updated_at" : "2015-10-23T16:03:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42797032",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "body" : "Agreed with @gmaxwell,  lets remove the flag and just have two functions.\r\nIt would be trivially short anyway.",
      "created_at" : "2015-10-23T00:28:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-150394660",
      "id" : 150394660,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-23T00:28:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/150394660",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42828266"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42828266"
         }
      },
      "body" : "I suggest this should check that the *correct* transaction was included.\r\n\r\nPreferably, the test should go on to produce a block that translates into the second transaction being included as well.",
      "commit_id" : "dea8d21fc63e9f442299c97010e4740558f4f037",
      "created_at" : "2015-10-23T02:30:29Z",
      "diff_hunk" : "@@ -261,7 +262,7 @@ BOOST_AUTO_TEST_CASE(CreateNewBlock_validity)\n     //BOOST_CHECK(CheckFinalTx(tx2));\n \n     BOOST_CHECK(pblocktemplate = CreateNewBlock(scriptPubKey));\n-    BOOST_CHECK_EQUAL(pblocktemplate->block.vtx.size(), 3);\n+    BOOST_CHECK_EQUAL(pblocktemplate->block.vtx.size(), 2);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42828266",
      "id" : 42828266,
      "original_commit_id" : "3bd176969c0a9470924fcfe95c7346603cf571be",
      "original_position" : 31,
      "path" : "src/test/miner_tests.cpp",
      "position" : 31,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566",
      "updated_at" : "2015-10-23T16:03:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42828266",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42828565"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42828565"
         }
      },
      "body" : "I don't see why this can't be moved to a const like nMedianTimePast, and skip calculating it for every mempool tx?",
      "commit_id" : "dea8d21fc63e9f442299c97010e4740558f4f037",
      "created_at" : "2015-10-23T02:37:54Z",
      "diff_hunk" : "@@ -162,7 +163,12 @@ CBlockTemplate* CreateNewBlock(const CScript& scriptPubKeyIn)\n              mi != mempool.mapTx.end(); ++mi)\n         {\n             const CTransaction& tx = mi->GetTx();\n-            if (tx.IsCoinBase() || !IsFinalTx(tx, nHeight, pblock->nTime))\n+\n+            int64_t nLockTimeCutoff = (STANDARD_LOCKTIME_VERIFY_FLAGS & LOCKTIME_MEDIAN_TIME_PAST)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42828565",
      "id" : 42828565,
      "original_commit_id" : "3bd176969c0a9470924fcfe95c7346603cf571be",
      "original_position" : 14,
      "path" : "src/miner.cpp",
      "position" : 14,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566",
      "updated_at" : "2015-10-23T16:03:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42828565",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "@gmaxwell The max is only in CheckFinalTx (not IsFinal), which is never used for consensus-critical code...",
      "created_at" : "2015-10-23T02:41:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-150416846",
      "id" : 150416846,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-23T02:41:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/150416846",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "utACK, although prefer if at least [this nit](https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42828565) is done before merge.",
      "created_at" : "2015-10-23T02:42:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-150417092",
      "id" : 150417092,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-23T02:42:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/150417092",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42881236"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42881236"
         }
      },
      "body" : "These flags are passed to `LockTime()`. Adding a bunch of other flag definitions which are not used by `LockTime()` would only cause confusion, I think.",
      "commit_id" : "dea8d21fc63e9f442299c97010e4740558f4f037",
      "created_at" : "2015-10-23T15:52:08Z",
      "diff_hunk" : "@@ -13,4 +13,10 @@ static const unsigned int MAX_BLOCK_SIGOPS = MAX_BLOCK_SIZE/50;\n /** Coinbase transaction outputs can only be spent after this number of new blocks (network rule) */\n static const int COINBASE_MATURITY = 100;\n \n+/** Flags for LockTime() */\n+enum {\n+    /* Use GetMedianTimePast() instead of nTime for end point timestamp. */\n+    LOCKTIME_MEDIAN_TIME_PAST = (1 << 1),\n+};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42881236",
      "id" : 42881236,
      "original_commit_id" : "6bd1f3c4d443de2066514008f72002c5f213d51e",
      "original_position" : 8,
      "path" : "src/consensus/consensus.h",
      "position" : 8,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566",
      "updated_at" : "2015-10-23T16:03:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42881236",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42881848"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42881848"
         }
      },
      "body" : "Any compiler more recent than the 1960's will evaluate an expression consisting entirely of literals at compile time. In this case I prefer the clarity of specifying what is being tested in-line.",
      "commit_id" : "dea8d21fc63e9f442299c97010e4740558f4f037",
      "created_at" : "2015-10-23T15:57:13Z",
      "diff_hunk" : "@@ -162,7 +163,12 @@ CBlockTemplate* CreateNewBlock(const CScript& scriptPubKeyIn)\n              mi != mempool.mapTx.end(); ++mi)\n         {\n             const CTransaction& tx = mi->GetTx();\n-            if (tx.IsCoinBase() || !IsFinalTx(tx, nHeight, pblock->nTime))\n+\n+            int64_t nLockTimeCutoff = (STANDARD_LOCKTIME_VERIFY_FLAGS & LOCKTIME_MEDIAN_TIME_PAST)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r42881848",
      "id" : 42881848,
      "original_commit_id" : "3bd176969c0a9470924fcfe95c7346603cf571be",
      "original_position" : 14,
      "path" : "src/miner.cpp",
      "position" : 14,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566",
      "updated_at" : "2015-10-23T16:03:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/42881848",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "body" : "I believe that nits have been addressed and this is ready for merge. @laanwj ?",
      "created_at" : "2015-10-23T16:03:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-150618824",
      "id" : 150618824,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-10-23T16:03:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/150618824",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r43077185"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/43077185"
         }
      },
      "body" : "nLockTimeCutoff assignment could be move outside the loop. \r\nIs it because nLockTimeFlags will eventually be decided by the version of the transaction ?",
      "commit_id" : "dea8d21fc63e9f442299c97010e4740558f4f037",
      "created_at" : "2015-10-27T02:00:05Z",
      "diff_hunk" : "@@ -2723,10 +2748,15 @@ bool ContextualCheckBlock(const CBlock& block, CValidationState& state, CBlockIn\n     const Consensus::Params& consensusParams = Params().GetConsensus();\n \n     // Check that all transactions are finalized\n-    BOOST_FOREACH(const CTransaction& tx, block.vtx)\n-        if (!IsFinalTx(tx, nHeight, block.GetBlockTime())) {\n+    BOOST_FOREACH(const CTransaction& tx, block.vtx) {\n+        int nLockTimeFlags = 0;\n+        int64_t nLockTimeCutoff = (nLockTimeFlags & LOCKTIME_MEDIAN_TIME_PAST)\n+                                ? pindexPrev->GetMedianTimePast()\n+                                : block.GetBlockTime();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#discussion_r43077185",
      "id" : 43077185,
      "original_commit_id" : "dea8d21fc63e9f442299c97010e4740558f4f037",
      "original_position" : 57,
      "path" : "src/main.cpp",
      "position" : 57,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6566",
      "updated_at" : "2015-10-27T02:00:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/43077185",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "body" : "It seems to me BIP 113 is actually a hardfork being treated as a softfork, at least how it currently stands, and this PR will potentially produce invalid blocks. Suggest reverting it and thinking through revising the BIP to be an actual softfork.",
      "created_at" : "2015-11-01T18:57:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-152851964",
      "id" : 152851964,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-11-01T18:57:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152851964",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "In my understanding - but this is just a rough check - it seems that Luke is right. A transaction whose locktime is between a block's nTime and its GetMedianTimePast() will be accepted post-BIP113 and not before. That looks like going from invalid to valid, which is a hard fork.\r\n",
      "created_at" : "2015-11-01T19:02:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-152852216",
      "id" : 152852216,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-11-01T19:02:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152852216",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Could you explain why it is a hard fork?\nOn Nov 1, 2015 10:58 AM, \"Luke-Jr\" <notifications@github.com> wrote:\n\n> It seems to me BIP 113 is actually a hardfork being treated as a softfork,\n> at least how it currently stands, and this PR will potentially produce\n> invalid blocks. Suggest reverting it and thinking through revising the BIP\n> to be an actual softfork.\n>\n> \n> Reply to this email directly or view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-152851964>.\n>\n",
      "created_at" : "2015-11-01T19:03:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-152852275",
      "id" : 152852275,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-11-01T19:03:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152852275",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "body" : "A valid block cannot have a nTime less than GetMedianTimePast + 1.\nOn Nov 1, 2015 11:03 AM, \"Pieter Wuille\" <notifications@github.com> wrote:\n\n> In my understanding - but this is just a rough check - it seems that Luke\n> is right. A transaction whose locktime is between a block's nTime and its\n> GetMedianTimePast() will be accepted post-BIP113 and not before. That looks\n> like going from invalid to valid, which is a hard fork.\n>\n> \n> Reply to this email directly or view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-152852216>.\n>\n",
      "created_at" : "2015-11-01T19:05:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-152852363",
      "id" : 152852363,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-11-01T19:05:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152852363",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "body" : "Assume you have a perfect sequence of blocks, where block at height N has timestamp N*600.\r\n\r\nBlock 12 has timestamp 7200. Its mediantimepast() is 3600. It is valid as 7200 is >= 3601.\r\n\r\nA transaction has nLockTime 5000. It is invalid currently in block 12, as 5000 is below 7200. Post BIP113, it is valid, as it is above 3600.",
      "created_at" : "2015-11-01T19:09:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-152852532",
      "id" : 152852532,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-11-01T19:15:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152852532",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa No, we're being silly.   The requirement is that the txlocktime be _above_ $thing.  Under the old rule $thing was blocktime,  under this rule it is MTP.   Since blocktime is already required to be greater than MTP,  it's fine.\r\n\r\n5000 < 7200   so that transaction is valid now.   It is > 3600 so it wouldn't be accepted by MTP.\r\n",
      "created_at" : "2015-11-02T04:49:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-152912106",
      "id" : 152912106,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-11-02T04:49:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152912106",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "> The requirement is that the txlocktime be above $thing. Under the old rule $thing was blocktime.\r\n\r\nSo the requirement is : blocktime < txlocktime\r\n[blocktime]7200 < [txlocktime]5000  evaluate to false so the transaction is invalid now.\r\n\r\n",
      "created_at" : "2015-11-02T05:50:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-152920714",
      "id" : 152920714,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-11-02T05:50:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152920714",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "body" : "Indeed, I was wrong. I assumed that the tx timestamp was supposed to be above the block timestamp - not sure why I made that assumption - and even looking at the code didn't convince me otherwise.\r\n\r\nI'm now convinced this is not a problem.",
      "created_at" : "2015-11-02T05:58:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-152921915",
      "id" : 152921915,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-11-02T05:58:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152921915",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "> The requirement is that the txlocktime be above $thing\r\n\r\nThe requirement is that the txlocktime be *under* $thing. Not above !\r\n@sipa your example seemed right and this is indeed a hardfork.",
      "created_at" : "2015-11-02T07:33:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-152942575",
      "id" : 152942575,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-11-02T07:33:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152942575",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "body" : "The requirement is the the blocktime is above the txlocktime, not the other way around.",
      "created_at" : "2015-11-02T07:47:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-152944699",
      "id" : 152944699,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-11-02T07:47:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152944699",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Got it. This is what I said (txlocktime be under blocktime == blocktime be above txlocktime), but got confused by gmaxwell remark who refuted your point by saying wrongly \"txlocktime be above blocktime\".\r\n\r\nI hate comparisons. :(",
      "created_at" : "2015-11-02T07:59:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-152946091",
      "id" : 152946091,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2015-11-02T07:59:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/152946091",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "body" : "Sorry for being late, but could someone confirm my understanding of BIP113's implications below?\r\n\r\nFirst, before BIP113 goes BIP9 ACTIVE, with respect to time based lock times, these must be true:\r\n\r\n1. `nLockTime < block.GetBlockTime()`\r\n1. `previousBlock->GetMedianTimePast() < block.GetBlockTime() <= GetAdjustedTime() + 2 * 60 * 60`\r\n\r\nIn other words, we currently have this for Core nodes that must be true:\r\n\r\n1. `nLockTime < range(previousBlock->GetMedianTimePast() + 1, some variable end time)`\r\n1. `(sixth highest block time of the previous 11 blocks) < block.GetBlockTime() <= (\"node specific perspective of now\" +- < 70 minute peer time offset) + 120 minutes`\r\n\r\nThis work changes changes the first item to be:\r\n\r\n1. `nLockTime < previousBlock->GetMedianTimePast()`\r\n\r\nWith the implications being:\r\n\r\n1. we're removing the uncertainty of the node specific and variable valid time range calculation `> previousBlock->GetMedianTimePast()`\r\n1. we're making mempool policy, and thus relay policy, more restrictive for lock time transactions because it is bound by MTP instead of adjusted time\r\n1. there is a notion that the sixth highest block time of the previous 11 blocks is going to be about an hour before \"now\", and thus take about an hour longer before lock time transactions are considered final/relayable. I inferred this from reading https://github.com/bitcoin/bips/blob/master/bip-0113.mediawiki#compatibility. I wanted to confirm that that is the reasoning, since it seems plausible, but also seemed to contradict https://github.com/bitcoin/bitcoin/pull/6566#issue-101544600 \"Users can compensate for this change by simply adding an hour (3600 seconds) to their time-based lock times.\" I may have just read that differently than it was intended, but it seems like they'd want to subtract an hour to achieve roughly the same point in time that the transaction would become final.",
      "created_at" : "2016-03-28T13:29:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6566#issuecomment-202391906",
      "id" : 202391906,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6566",
      "updated_at" : "2016-03-28T13:47:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/202391906",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6440430?v=3",
         "events_url" : "https://api.github.com/users/mruddy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mruddy/followers",
         "following_url" : "https://api.github.com/users/mruddy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mruddy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mruddy",
         "id" : 6440430,
         "login" : "mruddy",
         "organizations_url" : "https://api.github.com/users/mruddy/orgs",
         "received_events_url" : "https://api.github.com/users/mruddy/received_events",
         "repos_url" : "https://api.github.com/users/mruddy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mruddy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mruddy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mruddy"
      }
   }
]
