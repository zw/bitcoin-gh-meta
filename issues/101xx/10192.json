{
   "assignee" : null,
   "assignees" : [],
   "body" : "This adds a new CuckooCache in validation, caching whether all of a\r\ntransaction's scripts were valid with a given set of script flags.\r\n\r\nUnlike previous attempts at caching an entire transaction's\r\nvalidity, which have nearly universally introduced consensus\r\nfailures, this only caches the validity of a transaction's\r\nscriptSigs. As these are pure functions of the transaction and\r\ndata it commits to, this should be much safer.\r\n\r\nThis is somewhat duplicative with the sigcache, as entries in the\r\nnew cache will also have several entries in the sigcache. However,\r\nthe sigcache is kept both as ATMP relies on it and because it\r\nprevents malleability-based DoS attacks on the new higher-level\r\ncache. Instead, the -sigcachesize option is re-used - cutting the\r\nsigcache size in half and using the newly freed memory for the\r\nscript execution cache.\r\n\r\nTransactions which match the script execution cache never even have\r\nentries in the script check thread's workqueue created.\r\n\r\nNote that the cache is indexed only on the script execution flags\r\nand the transaction's witness hash. While this is sufficient to\r\nmake the CScriptCheck() calls pure functions, this introduces\r\ndependancies on the mempool calculating things such as the\r\nPrecomputedTransactionData object, filling the CCoinsViewCache, etc\r\nin the exact same way as ConnectBlock. I belive this is a reasonable\r\nassumption, but should be noted carefully.\r\n\r\nIn a rather naive benchmark (reindex-chainstate up to block 284k\r\nwith cuckoocache always returning true for contains(),\r\n-assumevalid=0 and a very large dbcache), this connected blocks\r\n~1.7x faster.",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 25,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10192/comments",
   "created_at" : "2017-04-11T21:57:16Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10192/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/10192",
   "id" : 221092807,
   "labels" : [
      {
         "color" : "6060aa",
         "default" : false,
         "id" : 118379652,
         "name" : "Validation",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10192/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 10192,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/10192.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10192",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/10192.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10192"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "Cache full script execution results in addition to signatures",
   "updated_at" : "2017-06-09T20:08:17Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10192",
   "user" : {
      "avatar_url" : "https://avatars3.githubusercontent.com/u/649246?v=3",
      "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
      "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/TheBlueMatt",
      "id" : 649246,
      "login" : "TheBlueMatt",
      "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
      "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
      "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/TheBlueMatt"
   }
}
