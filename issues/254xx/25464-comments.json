[
   {
      "author_association" : "MEMBER",
      "body" : "> In the txs vector created to store ret.getValues()\r\n\r\nThis is not accurate. The memory used by `const std::vector<UniValue>& txs = ret.getValues();` is roughly `0`, as `getValues` returns a reference and the return value is bound as a reference.\r\n\r\nMemory is consumed when creating an unnamed temporary vector, to be passed into `push_backV`. While the argument of `push_backV` is a const reference, there is no enforcement that the caller is providing a reference and the language allows *any* value of the type (lvalue or (p)rvalue) to be passed in.",
      "created_at" : "2022-06-27T12:40:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25464#issuecomment-1167303373",
      "id" : 1167303373,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25464",
      "node_id" : "IC_kwDOABII585Fk6LN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1167303373/reactions"
      },
      "updated_at" : "2022-06-27T12:40:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1167303373",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Does anyone know how to test this accurately?\r\n\r\nI tried massif, but it didn't seem too useful to check intermittent memory spikes.\r\n\r\nMaster:\r\n![Screenshot from 2022-06-28 11-07-26](https://user-images.githubusercontent.com/6399679/176140706-9ee9b584-aee3-43e3-8a62-c4eb37be8ce1.png)\r\n\r\nThis pull:\r\n![Screenshot from 2022-06-28 11-07-26](https://user-images.githubusercontent.com/6399679/176140827-74347fba-f963-4ef9-928b-584d54acf6a4.png)\r\n\r\n",
      "created_at" : "2022-06-28T09:10:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25464#issuecomment-1168450227",
      "id" : 1168450227,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25464",
      "node_id" : "IC_kwDOABII585FpSKz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1168450227/reactions"
      },
      "updated_at" : "2022-06-28T09:10:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1168450227",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "While the massif chart may not be accurate, the maximum memory usage should be.\r\n\r\nI've also confirmed this with `/usr/bin/time --format='%M'`.\r\n\r\n\r\nResults for master:\r\n\r\n* peak memory (`%M`): 0.507 GB\r\n* fastest duration (out of 10 RPC invocations): 2.34 seconds\r\n\r\nThis pull:\r\n\r\n* peak memory: 0.444 GB\r\n* fastest duration (out of 10 RPC invocations): 2.19 seconds\r\n\r\nThus, in my testing, the changes in this pull both *speed-up* and *reduce memory*.",
      "created_at" : "2022-06-29T09:44:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25464#issuecomment-1169767990",
      "id" : 1169767990,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25464",
      "node_id" : "IC_kwDOABII585FuT42",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1169767990/reactions"
      },
      "updated_at" : "2022-06-29T09:44:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1169767990",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25551](https://github.com/bitcoin/bitcoin/pull/25551) (refactor: Throw exception on invalid Univalue pushes over silent ignore by MarcoFalke)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-06-29T12:17:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25464#issuecomment-1169909637",
      "id" : 1169909637,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25464",
      "node_id" : "IC_kwDOABII585Fu2eF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1169909637/reactions"
      },
      "updated_at" : "2022-07-06T12:43:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1169909637",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25464#discussion_r914259215"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25464"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/914259215"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Probably should throw here instead of return a value that is likely to be unchecked (as below)?",
      "commit_id" : "fa8a1c06961f4b1826696e0db8dce81dce627721",
      "created_at" : "2022-07-05T22:38:02Z",
      "diff_hunk" : "@@ -137,6 +139,14 @@ class UniValue {\n     friend const UniValue& find_value( const UniValue& obj, const std::string& name);\n };\n \n+template <class It>\n+bool UniValue::push_backV(It first, It last)\n+{\n+    if (typ != VARR) return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25464#discussion_r914259215",
      "id" : 914259215,
      "line" : 145,
      "node_id" : "PRRC_kwDOABII5842fn0P",
      "original_commit_id" : "fa8a1c06961f4b1826696e0db8dce81dce627721",
      "original_line" : 145,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/univalue/include/univalue.h",
      "position" : 16,
      "pull_request_review_id" : 1029286972,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25464",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/914259215/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-05T22:38:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/914259215",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25464#discussion_r914657187"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25464"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/914657187"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good idea. Fixed in https://github.com/bitcoin/bitcoin/pull/25551 for the whole codebase.",
      "commit_id" : "fa8a1c06961f4b1826696e0db8dce81dce627721",
      "created_at" : "2022-07-06T10:02:30Z",
      "diff_hunk" : "@@ -137,6 +139,14 @@ class UniValue {\n     friend const UniValue& find_value( const UniValue& obj, const std::string& name);\n };\n \n+template <class It>\n+bool UniValue::push_backV(It first, It last)\n+{\n+    if (typ != VARR) return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25464#discussion_r914657187",
      "id" : 914657187,
      "in_reply_to_id" : 914259215,
      "line" : 145,
      "node_id" : "PRRC_kwDOABII5842hI-j",
      "original_commit_id" : "fa8a1c06961f4b1826696e0db8dce81dce627721",
      "original_line" : 145,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/univalue/include/univalue.h",
      "position" : 16,
      "pull_request_review_id" : 1029833779,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25464",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/914657187/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-06T10:02:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/914657187",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "cc @martinus",
      "created_at" : "2022-07-12T12:04:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25464#issuecomment-1181676558",
      "id" : 1181676558,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25464",
      "node_id" : "IC_kwDOABII585GbvQO",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181676558/reactions"
      },
      "updated_at" : "2022-07-12T12:04:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181676558",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25464#discussion_r918895649"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25464"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918895649"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In line 368 and 409 you could use `ret.push_back(std::move(entry));` to safe another copy",
      "commit_id" : "fa8a1c06961f4b1826696e0db8dce81dce627721",
      "created_at" : "2022-07-12T12:13:57Z",
      "diff_hunk" : "@@ -329,11 +329,12 @@ static void MaybePushAddress(UniValue & entry, const CTxDestination &dest)\n  * @param  wtx            The wallet transaction.\n  * @param  nMinDepth      The minimum confirmation depth.\n  * @param  fLong          Whether to include the JSON version of the transaction.\n- * @param  ret            The UniValue into which the result is stored.\n+ * @param  ret            The vector into which the result is stored.\n  * @param  filter_ismine  The \"is mine\" filter flags.\n  * @param  filter_label   Optional label string to filter incoming transactions.\n  */\n-static void ListTransactions(const CWallet& wallet, const CWalletTx& wtx, int nMinDepth, bool fLong, UniValue& ret, const isminefilter& filter_ismine, const std::string* filter_label) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet)\n+template <class Vec>\n+static void ListTransactions(const CWallet& wallet, const CWalletTx& wtx, int nMinDepth, bool fLong, Vec& ret, const isminefilter& filter_ismine, const std::string* filter_label) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25464#discussion_r918895649",
      "id" : 918895649,
      "line" : 337,
      "node_id" : "PRRC_kwDOABII5842xTwh",
      "original_commit_id" : "fa8a1c06961f4b1826696e0db8dce81dce627721",
      "original_line" : 337,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/transactions.cpp",
      "position" : 11,
      "pull_request_review_id" : 1035700456,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25464",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918895649/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-12T12:17:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918895649",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   }
]
