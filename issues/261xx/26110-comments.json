[
   {
      "author_association" : "MEMBER",
      "body" : "I don't think it is unused. There are a number of calls to `SelectCoins` in the following tests and that function uses `min_viable_change`.\r\n\r\nNote that the tests are not exhaustive. If tests do not fail due to removal of code, it is not necessarily that the code was unnecessary or unused, but often that the test was deficient.",
      "created_at" : "2022-09-16T14:58:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26110#issuecomment-1249473904",
      "id" : 1249473904,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26110",
      "node_id" : "IC_kwDOABII585KeXVw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1249473904/reactions"
      },
      "updated_at" : "2022-09-16T14:58:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1249473904",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@achow101 yes that's true, however this is part of `bnb_search_test` which is testing `SelectCoinsBnB`.\r\n\r\nIt's confusing that the tests use `SelectCoins` to call `SelectCoinsBnB` right now.",
      "created_at" : "2022-09-16T15:14:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26110#issuecomment-1249490727",
      "id" : 1249490727,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26110",
      "node_id" : "IC_kwDOABII585Kebcn",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1249490727/reactions"
      },
      "updated_at" : "2022-09-16T15:55:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1249490727",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/817736?v=4",
         "events_url" : "https://api.github.com/users/yancyribbens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yancyribbens/followers",
         "following_url" : "https://api.github.com/users/yancyribbens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yancyribbens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yancyribbens",
         "id" : 817736,
         "login" : "yancyribbens",
         "node_id" : "MDQ6VXNlcjgxNzczNg==",
         "organizations_url" : "https://api.github.com/users/yancyribbens/orgs",
         "received_events_url" : "https://api.github.com/users/yancyribbens/received_events",
         "repos_url" : "https://api.github.com/users/yancyribbens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yancyribbens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yancyribbens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yancyribbens"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26111](https://github.com/bitcoin/bitcoin/pull/26111) (refactor: Simplify bnb coin_selection test params by yancyribbens)\n* [#26020](https://github.com/bitcoin/bitcoin/pull/26020) (test: Change coinselection parameter location to make tests independent by yancyribbens)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-09-17T03:50:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26110#issuecomment-1249991422",
      "id" : 1249991422,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26110",
      "node_id" : "IC_kwDOABII585KgVr-",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1249991422/reactions"
      },
      "updated_at" : "2022-09-24T22:46:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1249991422",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "NACK. I added `min_viable_change` and it's definitely used. You can check it with `git grep min_viable_change`\r\n\r\nP.S. `min_viable_change` is not related to BnB algorithm. it's a parameter for the transaction building.",
      "created_at" : "2022-09-19T07:39:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26110#issuecomment-1250674451",
      "id" : 1250674451,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26110",
      "node_id" : "IC_kwDOABII585Ki8cT",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1250674451/reactions"
      },
      "updated_at" : "2022-09-19T07:39:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1250674451",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The test suit should fail then if it is used, however the tests all pass.  Under what circumstance would `min_viable_change` affect the `BnB` algorithm?  Maybe there's a test or assertion that can be added if `min_viable_change` setting is important to the selection process.",
      "created_at" : "2022-09-19T07:52:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26110#issuecomment-1250685206",
      "id" : 1250685206,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26110",
      "node_id" : "IC_kwDOABII585Ki_EW",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1250685206/reactions"
      },
      "updated_at" : "2022-09-19T07:52:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1250685206",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/817736?v=4",
         "events_url" : "https://api.github.com/users/yancyribbens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yancyribbens/followers",
         "following_url" : "https://api.github.com/users/yancyribbens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yancyribbens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yancyribbens",
         "id" : 817736,
         "login" : "yancyribbens",
         "node_id" : "MDQ6VXNlcjgxNzczNg==",
         "organizations_url" : "https://api.github.com/users/yancyribbens/orgs",
         "received_events_url" : "https://api.github.com/users/yancyribbens/received_events",
         "repos_url" : "https://api.github.com/users/yancyribbens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yancyribbens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yancyribbens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yancyribbens"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> It's confusing that the tests use SelectCoins to call SelectCoinsBnB right now.\r\n\r\nThe coins supplied to the selection algorithm are of round value and match exactly the target, which is the reason why BnB should be used in `SelectCoins`.\r\n\r\nSince BnB does not create change outputs, wouldn't it make sense to remove `min_viable_change` from the test?\r\n\r\n<details>\r\n<summary>Suggestion</summary>\r\n\r\n```diff\r\ndiff --git a/src/wallet/test/coinselector_tests.cpp b/src/wallet/test/coinselector_tests.cpp\r\nindex 264c0aa59..4a5309a4f 100644\r\n--- a/src/wallet/test/coinselector_tests.cpp\r\n+++ b/src/wallet/test/coinselector_tests.cpp\r\n@@ -345,6 +345,7 @@ BOOST_AUTO_TEST_CASE(bnb_search_test)\r\n         coin_selection_params_bnb.m_effective_feerate = CFeeRate(0);\r\n         const auto result10 = SelectCoins(*wallet, available_coins, selected_input, 10 * CENT, coin_control, coin_selection_params_bnb);\r\n         BOOST_CHECK(result10);\r\n+        BOOST_CHECK_EQUAL(result10->GetAlgo(), SelectionAlgorithm::BNB);\r\n     }\r\n     {\r\n         std::unique_ptr<CWallet> wallet = std::make_unique<CWallet>(m_node.chain.get(), \"\", m_args, CreateMockWalletDatabase());\r\n@@ -368,6 +369,7 @@ BOOST_AUTO_TEST_CASE(bnb_search_test)\r\n         CCoinControl coin_control;\r\n         const auto result11 = SelectCoins(*wallet, available_coins, /*pre_set_inputs=*/{}, 10 * CENT, coin_control, coin_selection_params_bnb);\r\n         BOOST_CHECK(EquivalentResult(expected_result, *result11));\r\n+        BOOST_CHECK_EQUAL(result11->GetAlgo(), SelectionAlgorithm::BNB);\r\n         available_coins.Clear();\r\n \r\n         // more coins should be selected when effective fee < long term fee\r\n@@ -383,6 +385,7 @@ BOOST_AUTO_TEST_CASE(bnb_search_test)\r\n         add_coin(1 * CENT, 2, expected_result);\r\n         const auto result12 = SelectCoins(*wallet, available_coins, /*pre_set_inputs=*/{}, 10 * CENT, coin_control, coin_selection_params_bnb);\r\n         BOOST_CHECK(EquivalentResult(expected_result, *result12));\r\n+        BOOST_CHECK_EQUAL(result12->GetAlgo(), SelectionAlgorithm::BNB);\r\n         available_coins.Clear();\r\n \r\n         // pre selected coin should be selected even if disadvantageous\r\n@@ -404,6 +407,7 @@ BOOST_AUTO_TEST_CASE(bnb_search_test)\r\n         available_coins.coins[OutputType::BECH32].erase(++available_coins.coins[OutputType::BECH32].begin());\r\n         const auto result13 = SelectCoins(*wallet, available_coins, selected_input, 10 * CENT, coin_control, coin_selection_params_bnb);\r\n         BOOST_CHECK(EquivalentResult(expected_result, *result13));\r\n+        BOOST_CHECK_EQUAL(result13->GetAlgo(), SelectionAlgorithm::BNB);\r\n     }\r\n }\r\n```\r\n\r\n</details>",
      "created_at" : "2022-11-03T18:52:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26110#issuecomment-1302536190",
      "id" : 1302536190,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26110",
      "node_id" : "IC_kwDOABII585Nox_-",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1302536190/reactions"
      },
      "updated_at" : "2022-11-03T18:52:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1302536190",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@aureleoules \r\n\r\n> The coins supplied to the selection algorithm are of round value and match exactly the target, which is the reason why BnB should be used in SelectCoins\r\n\r\nIt seems to me it would be cleaner to just test `BnB` directly instead of indirectly testing via `SelectCoins`, however, that seems like a much larger refactor.\r\n\r\n> Since BnB does not create change outputs, wouldn't it make sense to remove min_viable_change from the test?\r\n\r\nI _think_ we are driving at the same thing.  `BnB` does not use `min_viable_change` nor does it accept it as an argument, which is why I removed it in this PR.  I think we could certainly add the assertion you suggested, although that seems like a separate change IMO from this PR.",
      "created_at" : "2022-11-03T19:41:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26110#issuecomment-1302584440",
      "id" : 1302584440,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26110",
      "node_id" : "IC_kwDOABII585No9x4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1302584440/reactions"
      },
      "updated_at" : "2022-11-03T19:41:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1302584440",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/817736?v=4",
         "events_url" : "https://api.github.com/users/yancyribbens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yancyribbens/followers",
         "following_url" : "https://api.github.com/users/yancyribbens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yancyribbens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yancyribbens",
         "id" : 817736,
         "login" : "yancyribbens",
         "node_id" : "MDQ6VXNlcjgxNzczNg==",
         "organizations_url" : "https://api.github.com/users/yancyribbens/orgs",
         "received_events_url" : "https://api.github.com/users/yancyribbens/received_events",
         "repos_url" : "https://api.github.com/users/yancyribbens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yancyribbens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yancyribbens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yancyribbens"
      }
   }
]
