[
   {
      "author_association" : "MEMBER",
      "body" : "Re-pushed to fix a commit message.",
      "created_at" : "2022-06-12T14:38:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#issuecomment-1153191314",
      "id" : 1153191314,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25349",
      "node_id" : "IC_kwDOABII585EvE2S",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1153191314/reactions"
      },
      "updated_at" : "2022-06-12T14:38:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1153191314",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r896436437"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/896436437"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm somewhat ambivalent about removing this. The superclass has it so it can be considered part of the API, and it can be useful to show the contents of the structure when debugging/troubleshooting.",
      "commit_id" : "905a4d1b2c9ed6b28f2bfbb156bbb95b1d99c44e",
      "created_at" : "2022-06-14T06:48:46Z",
      "diff_hunk" : "@@ -414,16 +414,9 @@ class CDiskBlockIndex : public CBlockIndex\n         return block.GetHash();\n     }\n \n-\n-    std::string ToString() const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r896436437",
      "id" : 896436437,
      "line" : 418,
      "node_id" : "PRRC_kwDOABII5841bojV",
      "original_commit_id" : "905a4d1b2c9ed6b28f2bfbb156bbb95b1d99c44e",
      "original_line" : 418,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/chain.h",
      "position" : 14,
      "pull_request_review_id" : 1005316130,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/896436437/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-14T06:48:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/896436437",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r896450607"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/896450607"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should we rename it instead?\n\n(Noting that the safe and correct way would be to use dynamic dispatch, like in https://github.com/jonatack/bitcoin/commits/CBlockIndex-CDiskBlockIndex-class-design, if the base and derived classes aren't critical hotspots.)",
      "commit_id" : "905a4d1b2c9ed6b28f2bfbb156bbb95b1d99c44e",
      "created_at" : "2022-06-14T07:06:56Z",
      "diff_hunk" : "@@ -414,16 +414,9 @@ class CDiskBlockIndex : public CBlockIndex\n         return block.GetHash();\n     }\n \n-\n-    std::string ToString() const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r896450607",
      "id" : 896450607,
      "in_reply_to_id" : 896436437,
      "line" : 418,
      "node_id" : "PRRC_kwDOABII5841bsAv",
      "original_commit_id" : "905a4d1b2c9ed6b28f2bfbb156bbb95b1d99c44e",
      "original_line" : 418,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/chain.h",
      "position" : 14,
      "pull_request_review_id" : 1005336203,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/896450607/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-14T07:06:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/896450607",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r896503569"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/896503569"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I agree it's not worth it to set that up just for a debugging function. ",
      "commit_id" : "905a4d1b2c9ed6b28f2bfbb156bbb95b1d99c44e",
      "created_at" : "2022-06-14T08:02:40Z",
      "diff_hunk" : "@@ -414,16 +414,9 @@ class CDiskBlockIndex : public CBlockIndex\n         return block.GetHash();\n     }\n \n-\n-    std::string ToString() const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r896503569",
      "id" : 896503569,
      "in_reply_to_id" : 896436437,
      "line" : 418,
      "node_id" : "PRRC_kwDOABII5841b48R",
      "original_commit_id" : "905a4d1b2c9ed6b28f2bfbb156bbb95b1d99c44e",
      "original_line" : 418,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/chain.h",
      "position" : 14,
      "pull_request_review_id" : 1005411189,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/896503569/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-14T08:02:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/896503569",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r896507421"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/896507421"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Right.",
      "commit_id" : "905a4d1b2c9ed6b28f2bfbb156bbb95b1d99c44e",
      "created_at" : "2022-06-14T08:06:50Z",
      "diff_hunk" : "@@ -414,16 +414,9 @@ class CDiskBlockIndex : public CBlockIndex\n         return block.GetHash();\n     }\n \n-\n-    std::string ToString() const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r896507421",
      "id" : 896507421,
      "in_reply_to_id" : 896436437,
      "line" : 418,
      "node_id" : "PRRC_kwDOABII5841b54d",
      "original_commit_id" : "905a4d1b2c9ed6b28f2bfbb156bbb95b1d99c44e",
      "original_line" : 418,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/chain.h",
      "position" : 14,
      "pull_request_review_id" : 1005417001,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/896507421/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-14T08:06:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/896507421",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25311](https://github.com/bitcoin/bitcoin/pull/25311) (remove CBlockIndex copy construction by jamesob)\n* [#25023](https://github.com/bitcoin/bitcoin/pull/25023) (Remove unused SetTip(nullptr) code by MarcoFalke)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-06-15T08:43:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#issuecomment-1156176143",
      "id" : 1156176143,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25349",
      "node_id" : "IC_kwDOABII585E6dkP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1156176143/reactions"
      },
      "updated_at" : "2022-07-16T17:27:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1156176143",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r905315608"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/905315608"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Resolving as the method is unused and can have inconsistent behavior as described in the OP, but please let me know if a change should be made. ",
      "commit_id" : "905a4d1b2c9ed6b28f2bfbb156bbb95b1d99c44e",
      "created_at" : "2022-06-23T18:00:27Z",
      "diff_hunk" : "@@ -414,16 +414,9 @@ class CDiskBlockIndex : public CBlockIndex\n         return block.GetHash();\n     }\n \n-\n-    std::string ToString() const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r905315608",
      "id" : 905315608,
      "in_reply_to_id" : 896436437,
      "line" : 418,
      "node_id" : "PRRC_kwDOABII58419gUY",
      "original_commit_id" : "905a4d1b2c9ed6b28f2bfbb156bbb95b1d99c44e",
      "original_line" : 418,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/chain.h",
      "position" : 14,
      "pull_request_review_id" : 1017436583,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/905315608/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-23T18:00:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/905315608",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The same approach (and a further design refactoring) were also suggested in https://github.com/bitcoin/bitcoin/pull/25311#discussion_r895318403. ",
      "created_at" : "2022-06-23T18:03:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#issuecomment-1164713443",
      "id" : 1164713443,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25349",
      "node_id" : "IC_kwDOABII585FbB3j",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1164713443/reactions"
      },
      "updated_at" : "2022-07-15T06:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1164713443",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r920099125"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920099125"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Why return `uint256` from `ToString()`? It is irrelevant in this case, but better have the same return type as the parent `CBlockIndex::ToString()` in order to avoid people asking this question :)\r\n\r\n```suggestion\r\n    std::string ToString() = delete;\r\n```",
      "commit_id" : "905a4d1b2c9ed6b28f2bfbb156bbb95b1d99c44e",
      "created_at" : "2022-07-13T13:46:18Z",
      "diff_hunk" : "@@ -414,16 +414,9 @@ class CDiskBlockIndex : public CBlockIndex\n         return block.GetHash();\n     }\n \n-\n-    std::string ToString() const\n-    {\n-        std::string str = \"CDiskBlockIndex(\";\n-        str += CBlockIndex::ToString();\n-        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s)\",\n-            GetBlockHash().ToString(),\n-            hashPrev.ToString());\n-        return str;\n-    }\n+    // To be called only by the base class.\n+    uint256 GetBlockHash() = delete;\n+    uint256 ToString() = delete;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r920099125",
      "id" : 920099125,
      "line" : 419,
      "node_id" : "PRRC_kwDOABII584215k1",
      "original_commit_id" : "905a4d1b2c9ed6b28f2bfbb156bbb95b1d99c44e",
      "original_line" : 419,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/chain.h",
      "position" : 25,
      "pull_request_review_id" : 1037392084,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920099125/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-13T13:55:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920099125",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r920113775"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920113775"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Deleted functions may also return `void`",
      "commit_id" : "905a4d1b2c9ed6b28f2bfbb156bbb95b1d99c44e",
      "created_at" : "2022-07-13T13:58:28Z",
      "diff_hunk" : "@@ -414,16 +414,9 @@ class CDiskBlockIndex : public CBlockIndex\n         return block.GetHash();\n     }\n \n-\n-    std::string ToString() const\n-    {\n-        std::string str = \"CDiskBlockIndex(\";\n-        str += CBlockIndex::ToString();\n-        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s)\",\n-            GetBlockHash().ToString(),\n-            hashPrev.ToString());\n-        return str;\n-    }\n+    // To be called only by the base class.\n+    uint256 GetBlockHash() = delete;\n+    uint256 ToString() = delete;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r920113775",
      "id" : 920113775,
      "in_reply_to_id" : 920099125,
      "line" : 419,
      "node_id" : "PRRC_kwDOABII584219Jv",
      "original_commit_id" : "905a4d1b2c9ed6b28f2bfbb156bbb95b1d99c44e",
      "original_line" : 419,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/chain.h",
      "position" : 25,
      "pull_request_review_id" : 1037412867,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920113775/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-13T13:58:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920113775",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r920147704"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920147704"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It may return anything because it is irrelevant, but if it is going to be different than the return type of the base method, then I would prefer it to return [`std::vector<double>`](https://purple.bikeshed.com/).",
      "commit_id" : "905a4d1b2c9ed6b28f2bfbb156bbb95b1d99c44e",
      "created_at" : "2022-07-13T14:26:44Z",
      "diff_hunk" : "@@ -414,16 +414,9 @@ class CDiskBlockIndex : public CBlockIndex\n         return block.GetHash();\n     }\n \n-\n-    std::string ToString() const\n-    {\n-        std::string str = \"CDiskBlockIndex(\";\n-        str += CBlockIndex::ToString();\n-        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s)\",\n-            GetBlockHash().ToString(),\n-            hashPrev.ToString());\n-        return str;\n-    }\n+    // To be called only by the base class.\n+    uint256 GetBlockHash() = delete;\n+    uint256 ToString() = delete;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r920147704",
      "id" : 920147704,
      "in_reply_to_id" : 920099125,
      "line" : 419,
      "node_id" : "PRRC_kwDOABII58422Fb4",
      "original_commit_id" : "905a4d1b2c9ed6b28f2bfbb156bbb95b1d99c44e",
      "original_line" : 419,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/chain.h",
      "position" : 25,
      "pull_request_review_id" : 1037461943,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920147704/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-13T14:26:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920147704",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r920169558"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920169558"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> [std::vector<double>](https://purple.bikeshed.com/).\r\n\r\nI mentioned it because the standard library seems to be using `void`, but I couldn't find the reference, so I didn't mention the reason. I'd advise against using non-built in types, as this increases the include dependencies.",
      "commit_id" : "905a4d1b2c9ed6b28f2bfbb156bbb95b1d99c44e",
      "created_at" : "2022-07-13T14:45:02Z",
      "diff_hunk" : "@@ -414,16 +414,9 @@ class CDiskBlockIndex : public CBlockIndex\n         return block.GetHash();\n     }\n \n-\n-    std::string ToString() const\n-    {\n-        std::string str = \"CDiskBlockIndex(\";\n-        str += CBlockIndex::ToString();\n-        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s)\",\n-            GetBlockHash().ToString(),\n-            hashPrev.ToString());\n-        return str;\n-    }\n+    // To be called only by the base class.\n+    uint256 GetBlockHash() = delete;\n+    uint256 ToString() = delete;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r920169558",
      "id" : 920169558,
      "in_reply_to_id" : 920099125,
      "line" : 419,
      "node_id" : "PRRC_kwDOABII58422KxW",
      "original_commit_id" : "905a4d1b2c9ed6b28f2bfbb156bbb95b1d99c44e",
      "original_line" : 419,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/chain.h",
      "position" : 25,
      "pull_request_review_id" : 1037494251,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920169558/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-13T14:45:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920169558",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r921850537"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/921850537"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Why return `uint256` from `ToString()`? It is irrelevant in this case, but better have the same return type as the parent `CBlockIndex::ToString()` in order to avoid people asking this question :)\r\n\r\nAgree, fixed (thanks!)",
      "commit_id" : "7866c85387c3fa553437be1e004986b889fcd2de",
      "created_at" : "2022-07-15T06:23:45Z",
      "diff_hunk" : "@@ -414,16 +414,9 @@ class CDiskBlockIndex : public CBlockIndex\n         return block.GetHash();\n     }\n \n-\n-    std::string ToString() const\n-    {\n-        std::string str = \"CDiskBlockIndex(\";\n-        str += CBlockIndex::ToString();\n-        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s)\",\n-            GetBlockHash().ToString(),\n-            hashPrev.ToString());\n-        return str;\n-    }\n+    // To be called only by the base class.\n+    uint256 GetBlockHash() = delete;\n+    uint256 ToString() = delete;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r921850537",
      "id" : 921850537,
      "in_reply_to_id" : 920099125,
      "line" : null,
      "node_id" : "PRRC_kwDOABII58428lKp",
      "original_commit_id" : "905a4d1b2c9ed6b28f2bfbb156bbb95b1d99c44e",
      "original_line" : 419,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/chain.h",
      "position" : null,
      "pull_request_review_id" : 1039847411,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/921850537/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-15T06:23:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/921850537",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Updated per `git range-diff 02ede4f 905a4d1 7866c85` to take review feedback (thanks!)\r\n\r\n> Some non-blocker questions:\r\n> \r\n> Why is overriding non-virtual functions incorrect design?\r\n\r\nTo avoid inconsistent behavior. Public inheritance establishes an invariant over specialization for the derived class. Class usage is confusing when the behavior depends on the pointer definition instead of the object definition (static binding happening where dynamic binding was expected). This can lead to unsuspected or hard-to-track bugs. See **Scott Meyers, *Effective C++*, Item 36: Inherited non-virtual functions should never be redefined**, rephrased in urls like https://programmersought.com/article/50007468749/ and https://www.programminghunter.com/article/96792264397/. I updated the PR description with part of this paragraph.\r\n \r\n> Edit: now I see that the alternative approach in [#25311 (comment)](https://github.com/bitcoin/bitcoin/pull/25311#discussion_r895318403) uses composition instead of inheritance. If indeed the users of `CDiskBlockIndex` do not use all the stuff provided by `CBlockIndex`, then that is a better approach.\r\n\r\nI agree it could potentially be a better design as a follow-up / next step (it is a somewhat more invasive refactoring).",
      "created_at" : "2022-07-15T06:39:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#issuecomment-1185226396",
      "id" : 1185226396,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25349",
      "node_id" : "IC_kwDOABII585GpR6c",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1185226396/reactions"
      },
      "updated_at" : "2022-07-15T17:09:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1185226396",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r922158695"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/922158695"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I am pretty sure that constructing a `CDiskBlockIndex`, then calling the base class's method on the constructed object will result in dereferencing a nullptr (UB)",
      "commit_id" : "7866c85387c3fa553437be1e004986b889fcd2de",
      "created_at" : "2022-07-15T13:20:04Z",
      "diff_hunk" : "@@ -414,16 +414,9 @@ class CDiskBlockIndex : public CBlockIndex\n         return block.GetHash();\n     }\n \n-\n-    std::string ToString() const\n-    {\n-        std::string str = \"CDiskBlockIndex(\";\n-        str += CBlockIndex::ToString();\n-        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s)\",\n-            GetBlockHash().ToString(),\n-            hashPrev.ToString());\n-        return str;\n-    }\n+    // To be called only by the base class.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r922158695",
      "id" : 922158695,
      "line" : 417,
      "node_id" : "PRRC_kwDOABII58429wZn",
      "original_commit_id" : "7866c85387c3fa553437be1e004986b889fcd2de",
      "original_line" : 417,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/chain.h",
      "position" : 23,
      "pull_request_review_id" : 1040286075,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/922158695/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-15T13:20:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/922158695",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r922322439"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/922322439"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I don't get it. Do you mean this?\r\n\r\n```cpp\r\nclass B\r\n{\r\npublic:\r\n    void f() { std::cout << \"B::f()\\n\"; }\r\n};\r\n\r\nclass D : public B\r\n{\r\npublic:\r\n    void f() = delete;\r\n};\r\n\r\nint main(int, char**)\r\n{\r\n    D d;\r\n    static_cast<B*>(&d)->f();\r\n    return 0;\r\n}\r\n```\r\n\r\n(it prints \"B::f()\")\r\n",
      "commit_id" : "7866c85387c3fa553437be1e004986b889fcd2de",
      "created_at" : "2022-07-15T16:24:33Z",
      "diff_hunk" : "@@ -414,16 +414,9 @@ class CDiskBlockIndex : public CBlockIndex\n         return block.GetHash();\n     }\n \n-\n-    std::string ToString() const\n-    {\n-        std::string str = \"CDiskBlockIndex(\";\n-        str += CBlockIndex::ToString();\n-        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s)\",\n-            GetBlockHash().ToString(),\n-            hashPrev.ToString());\n-        return str;\n-    }\n+    // To be called only by the base class.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r922322439",
      "id" : 922322439,
      "in_reply_to_id" : 922158695,
      "line" : 417,
      "node_id" : "PRRC_kwDOABII5842-YYH",
      "original_commit_id" : "7866c85387c3fa553437be1e004986b889fcd2de",
      "original_line" : 417,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/chain.h",
      "position" : 23,
      "pull_request_review_id" : 1040526164,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/922322439/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-15T16:24:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/922322439",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r922336309"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/922336309"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Running mainnet with the following patch:\r\n\r\n```diff\r\ndiff --git a/src/txdb.cpp b/src/txdb.cpp\r\nindex bad3bb80a9..5078ddb6bf 100644\r\n--- a/src/txdb.cpp\r\n+++ b/src/txdb.cpp\r\n@@ -310,7 +310,9 @@ bool CBlockTreeDB::LoadBlockIndexGuts(const Consensus::Params& consensusParams,\r\n             CDiskBlockIndex diskindex;\r\n             if (pcursor->GetValue(diskindex)) {\r\n                 // Construct block index object\r\n                 CBlockIndex* pindexNew = insertBlockIndex(diskindex.ConstructBlockHash());\r\n+                assert(pindexNew);\r\n+                LogPrintf(\"CBI 1: %s\\n\", pindexNew->ToString());\r\n                 pindexNew->pprev          = insertBlockIndex(diskindex.hashPrev);\r\n                 pindexNew->nHeight        = diskindex.nHeight;\r\n                 pindexNew->nFile          = diskindex.nFile;\r\n@@ -323,6 +325,7 @@ bool CBlockTreeDB::LoadBlockIndexGuts(const Consensus::Params& consensusParams,\r\n                 pindexNew->nNonce         = diskindex.nNonce;\r\n                 pindexNew->nStatus        = diskindex.nStatus;\r\n                 pindexNew->nTx            = diskindex.nTx;\r\n+                LogPrintf(\"CBI 2: %s\\n\", pindexNew->ToString());\r\n \r\n                 if (!CheckProofOfWork(pindexNew->GetBlockHash(), pindexNew->nBits, consensusParams)) {\r\n                     return error(\"%s: CheckProofOfWork failed: %s\", __func__, pindexNew->ToString());\r\n```\r\n\r\nprints (many) valid-looking objects.\r\n\r\n```\r\n2022-07-15T16:34:08Z CBI 1: CBlockIndex(pprev=0, nHeight=0, merkle=0000000000000000000000000000000000000000000000000000000000000000, hashBlock=000000000000000000597281aa1ec7e99f0fff6eeda0db8707f77709951ba61a)\r\n2022-07-15T16:34:08Z CBI 2: CBlockIndex(pprev=0x55d02f11c778, nHeight=478600, merkle=40e759d1ea04b507003f1177a66c39ec2783eb464f7d867c3d7f401fb168f2aa, hashBlock=000000000000000000597281aa1ec7e99f0fff6eeda0db8707f77709951ba61a)\r\n\r\n2022-07-15T16:34:08Z CBI 1: CBlockIndex(pprev=0, nHeight=0, merkle=0000000000000000000000000000000000000000000000000000000000000000, hashBlock=00000000000000000506e18c023143c5c3421399d3582be8aa4b263b8f69a61a)\r\n2022-07-15T16:34:08Z CBI 2: CBlockIndex(pprev=0x55d02f11c918, nHeight=427311, merkle=29af1206ec66690b1a0e51c2b07e6ead88056e7c11746c4d448f47e161cbbe39, hashBlock=00000000000000000506e18c023143c5c3421399d3582be8aa4b263b8f69a61a)\r\n```\r\n\r\nand with this patch calling the base function from the child class that is deleted in the child class:\r\n\r\n```diff\r\ndiff --git a/src/txdb.cpp b/src/txdb.cpp\r\nindex bad3bb80a9..c048c2d92a 100644\r\n--- a/src/txdb.cpp\r\n+++ b/src/txdb.cpp\r\n@@ -310,7 +310,7 @@ bool CBlockTreeDB::LoadBlockIndexGuts(const Consensus::Params& consensusParams,\r\n             CDiskBlockIndex diskindex;\r\n             if (pcursor->GetValue(diskindex)) {\r\n                 // Construct block index object\r\n-                CBlockIndex* pindexNew = insertBlockIndex(diskindex.ConstructBlockHash());\r\n+                CBlockIndex* pindexNew = insertBlockIndex(diskindex.GetBlockHash());\r\n                 pindexNew->pprev          = insertBlockIndex(diskindex.hashPrev);\r\n                 pindexNew->nHeight        = diskindex.nHeight;\r\n```\r\n\r\nI see the following build error:\r\n\r\n```\r\ntxdb.cpp:313:69: error: attempt to use a deleted function\r\n                CBlockIndex* pindexNew = insertBlockIndex(diskindex.GetBlockHash());\r\n                                                                    ^\r\n./chain.h:418:13: note: 'GetBlockHash' has been explicitly marked deleted here\r\n    uint256 GetBlockHash() = delete;\r\n            ^\r\n1 error generated.\r\n```\r\n\r\nLet me know if I'm misunderstanding or missing something.",
      "commit_id" : "7866c85387c3fa553437be1e004986b889fcd2de",
      "created_at" : "2022-07-15T16:41:25Z",
      "diff_hunk" : "@@ -414,16 +414,9 @@ class CDiskBlockIndex : public CBlockIndex\n         return block.GetHash();\n     }\n \n-\n-    std::string ToString() const\n-    {\n-        std::string str = \"CDiskBlockIndex(\";\n-        str += CBlockIndex::ToString();\n-        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s)\",\n-            GetBlockHash().ToString(),\n-            hashPrev.ToString());\n-        return str;\n-    }\n+    // To be called only by the base class.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r922336309",
      "id" : 922336309,
      "in_reply_to_id" : 922158695,
      "line" : 417,
      "node_id" : "PRRC_kwDOABII5842-bw1",
      "original_commit_id" : "7866c85387c3fa553437be1e004986b889fcd2de",
      "original_line" : 417,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/chain.h",
      "position" : 23,
      "pull_request_review_id" : 1040546551,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/922336309/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-15T17:33:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/922336309",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r922649077"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/922649077"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I mean that calling the base class method on a disk index object is UB:\r\n\r\n```diff\r\ndiff --git a/src/txdb.cpp b/src/txdb.cpp\r\nindex c048c2d92a..de1384fb61 100644\r\n--- a/src/txdb.cpp\r\n+++ b/src/txdb.cpp\r\n@@ -309,6 +309,7 @@ bool CBlockTreeDB::LoadBlockIndexGuts(const Consensus::Params& consensusParams,\r\n         if (pcursor->GetKey(key) && key.first == DB_BLOCK_INDEX) {\r\n             CDiskBlockIndex diskindex;\r\n             if (pcursor->GetValue(diskindex)) {\r\n+                static_cast<CBlockIndex&>(diskindex).ToString();\r\n                 // Construct block index object\r\n                 CBlockIndex* pindexNew = insertBlockIndex(diskindex.GetBlockHash());\r\n                 pindexNew->pprev          = insertBlockIndex(diskindex.hashPrev);\r\n```\r\n\r\n```\r\n==563291== Invalid read of size 16\r\n==563291==    at 0x2192B0: GetBlockHash (chain.h:266)\r\n==563291==    by 0x2192B0: CBlockIndex::ToString[abi:cxx11]() const (chain.h:309)\r\n==563291==    by 0x3CD954: CBlockTreeDB::LoadBlockIndexGuts(Consensus::Params const&, std::function<CBlockIndex* (uint256 const&)>) (txdb.cpp:312)\r\n==563291==    by 0x210BBF: node::BlockManager::LoadBlockIndex(Consensus::Params const&) (blockstorage.cpp:258)\r\n==563291==    by 0x2114AD: node::BlockManager::LoadBlockIndexDB(Consensus::Params const&) (blockstorage.cpp:323)\r\n==563291==    by 0x410C0B: ChainstateManager::LoadBlockIndex() (validation.cpp:4148)\r\n==563291==    by 0x222EEB: node::LoadChainstate(bool, ChainstateManager&, CTxMemPool*, bool, bool, long, long, long, bool, bool, std::function<bool ()>, std::function<void ()>) (chainstate.cpp:53)\r\n==563291==    by 0x1749A4: AppInitMain(node::NodeContext&, interfaces::BlockAndHeaderTipInfo*) (init.cpp:1456)\r\n==563291==    by 0x159A31: AppInit (bitcoind.cpp:234)\r\n==563291==    by 0x159A31: main (bitcoind.cpp:278)\r\n==563291==  Address 0x0 is not stack'd, malloc'd or (recently) free'd\r\n==563291== \r\n==563291== \r\n==563291== Process terminating with default action of signal 11 (SIGSEGV): dumping core\r\n==563291==  Access not within mapped region at address 0x0\r\n==563291==    at 0x2192B0: GetBlockHash (chain.h:266)\r\n==563291==    by 0x2192B0: CBlockIndex::ToString[abi:cxx11]() const (chain.h:309)\r\n==563291==    by 0x3CD954: CBlockTreeDB::LoadBlockIndexGuts(Consensus::Params const&, std::function<CBlockIndex* (uint256 const&)>) (txdb.cpp:312)\r\n==563291==    by 0x210BBF: node::BlockManager::LoadBlockIndex(Consensus::Params const&) (blockstorage.cpp:258)\r\n==563291==    by 0x2114AD: node::BlockManager::LoadBlockIndexDB(Consensus::Params const&) (blockstorage.cpp:323)\r\n==563291==    by 0x410C0B: ChainstateManager::LoadBlockIndex() (validation.cpp:4148)\r\n==563291==    by 0x222EEB: node::LoadChainstate(bool, ChainstateManager&, CTxMemPool*, bool, bool, long, long, long, bool, bool, std::function<bool ()>, std::function<void ()>) (chainstate.cpp:53)\r\n==563291==    by 0x1749A4: AppInitMain(node::NodeContext&, interfaces::BlockAndHeaderTipInfo*) (init.cpp:1456)\r\n==563291==    by 0x159A31: AppInit (bitcoind.cpp:234)\r\n==563291==    by 0x159A31: main (bitcoind.cpp:278)\r\n```\r\n\r\nSo I'd say the comment should be clarified that it is wholly illegal to call any such method on this object (whether through itself or a class it inherits from).",
      "commit_id" : "2ececec41e780ca0fe3aa945313a34750618c50e",
      "created_at" : "2022-07-16T08:04:50Z",
      "diff_hunk" : "@@ -414,16 +414,9 @@ class CDiskBlockIndex : public CBlockIndex\n         return block.GetHash();\n     }\n \n-\n-    std::string ToString() const\n-    {\n-        std::string str = \"CDiskBlockIndex(\";\n-        str += CBlockIndex::ToString();\n-        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s)\",\n-            GetBlockHash().ToString(),\n-            hashPrev.ToString());\n-        return str;\n-    }\n+    // To be called only by the base class.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r922649077",
      "id" : 922649077,
      "in_reply_to_id" : 922158695,
      "line" : 411,
      "node_id" : "PRRC_kwDOABII5842_oH1",
      "original_commit_id" : "7866c85387c3fa553437be1e004986b889fcd2de",
      "original_line" : 417,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/chain.h",
      "position" : 57,
      "pull_request_review_id" : 1040967502,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/922649077/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-16T08:04:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/922649077",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r922657909"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/922657909"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Added the following belt-and-suspenders check to ensure we don't dereference nullptr.\r\n\r\n```diff\r\n    std::string ToString() const\r\n    {\r\n        return strprintf(\"CBlockIndex(pprev=%p, nHeight=%d, merkle=%s, hashBlock=%s)\",\r\n            pprev, nHeight,\r\n            hashMerkleRoot.ToString(),\r\n-            GetBlockHash().ToString());\r\n+            phashBlock ? GetBlockHash().ToString() : \"\");\r\n    }\r\n```\r\n",
      "commit_id" : "2ececec41e780ca0fe3aa945313a34750618c50e",
      "created_at" : "2022-07-16T09:33:24Z",
      "diff_hunk" : "@@ -414,16 +414,9 @@ class CDiskBlockIndex : public CBlockIndex\n         return block.GetHash();\n     }\n \n-\n-    std::string ToString() const\n-    {\n-        std::string str = \"CDiskBlockIndex(\";\n-        str += CBlockIndex::ToString();\n-        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s)\",\n-            GetBlockHash().ToString(),\n-            hashPrev.ToString());\n-        return str;\n-    }\n+    // To be called only by the base class.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r922657909",
      "id" : 922657909,
      "in_reply_to_id" : 922158695,
      "line" : 411,
      "node_id" : "PRRC_kwDOABII5842_qR1",
      "original_commit_id" : "7866c85387c3fa553437be1e004986b889fcd2de",
      "original_line" : 417,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/chain.h",
      "position" : 57,
      "pull_request_review_id" : 1040974914,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/922657909/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-16T11:44:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/922657909",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r925406215"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925406215"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit1:\r\nThis could print `hashBlock=)`. Maybe better to omit `hashBlock` altogether:\r\n\r\n```cpp\r\nreturn strprintf(\"CBlockIndex(pprev=%p, nHeight=%d, merkle=%s%s)\",\r\n                 pprev, nHeight, hashMerkleRoot.ToString(),\r\n                 phashBlock ? \", hashBlock=\" + GetBlockHash().ToString() : \"\");\r\n```\r\n\r\nnit2:\r\nThis assumes that `GetBlockHash()` will dereference `phashBlock` - it kind of \"knows\" what `GetBlockHash()` will do, which defeats the purpose of isolating/abstracting some code into that method. Given that this is happening internally in `CBlockIndex` I think it would better be:\r\n\r\n```cpp\r\nphashBlock ? phashBlock->ToString() : \"\"\r\n```\r\n",
      "commit_id" : "2ececec41e780ca0fe3aa945313a34750618c50e",
      "created_at" : "2022-07-20T09:49:24Z",
      "diff_hunk" : "@@ -4,13 +4,21 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chain.h>\n+#include <tinyformat.h>\n #include <util/time.h>\n \n std::string CBlockFileInfo::ToString() const\n {\n     return strprintf(\"CBlockFileInfo(blocks=%u, size=%u, heights=%u...%u, time=%s...%s)\", nBlocks, nSize, nHeightFirst, nHeightLast, FormatISO8601Date(nTimeFirst), FormatISO8601Date(nTimeLast));\n }\n \n+std::string CBlockIndex::ToString() const\n+{\n+    return strprintf(\"CBlockIndex(pprev=%p, nHeight=%d, merkle=%s, hashBlock=%s)\",\n+                     pprev, nHeight, hashMerkleRoot.ToString(),\n+                     phashBlock ? GetBlockHash().ToString() : \"\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r925406215",
      "id" : 925406215,
      "line" : 19,
      "node_id" : "PRRC_kwDOABII5843KJQH",
      "original_commit_id" : "2ececec41e780ca0fe3aa945313a34750618c50e",
      "original_line" : 19,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/chain.cpp",
      "position" : 16,
      "pull_request_review_id" : 1044741693,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925406215/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-20T10:22:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925406215",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r925436378"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925436378"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think this should be turned into `assert(phashBlock);` (or even better `assert(phashBlock != nullptr)`). It will crash for sure even in release builds where `Assert()` is a noop. Better provide some meaningful message in that case (from the assert), before crashing. Then this assert can be removed:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/895937edb2cca3046640dc016827a216e0b6d1c1/src/validation.cpp#L2269-L2271",
      "commit_id" : "2ececec41e780ca0fe3aa945313a34750618c50e",
      "created_at" : "2022-07-20T10:21:38Z",
      "diff_hunk" : "@@ -263,7 +263,7 @@ class CBlockIndex\n \n     uint256 GetBlockHash() const\n     {\n-        return *phashBlock;\n+        return *Assert(phashBlock);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r925436378",
      "id" : 925436378,
      "line" : 266,
      "node_id" : "PRRC_kwDOABII5843KQna",
      "original_commit_id" : "2ececec41e780ca0fe3aa945313a34750618c50e",
      "original_line" : 266,
      "original_position" : 15,
      "original_start_line" : 264,
      "path" : "src/chain.h",
      "position" : 15,
      "pull_request_review_id" : 1044741693,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925436378/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 264,
      "start_side" : "RIGHT",
      "updated_at" : "2022-07-20T10:22:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925436378",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r925441496"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925441496"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> I am pretty sure that constructing a CDiskBlockIndex, then calling the base class's method on the constructed object will result in dereferencing a nullptr (UB)\r\n\r\nI see your point now.\r\n\r\n```cpp\r\nCDiskBlockIndex diskindex;\r\n// Will crash because `phashBlock` is nullptr.\r\nstatic_cast<CBlockIndex&>(diskindex).ToString();\r\n```\r\n\r\nBut then, the following will also crash for the same reason:\r\n\r\n```cpp\r\nCBlockIndex index;\r\nindex.ToString();\r\n```\r\n\r\nThe crash is not related to the inheritance or the deleted methods from this PR.",
      "commit_id" : "2ececec41e780ca0fe3aa945313a34750618c50e",
      "created_at" : "2022-07-20T10:27:20Z",
      "diff_hunk" : "@@ -414,16 +414,9 @@ class CDiskBlockIndex : public CBlockIndex\n         return block.GetHash();\n     }\n \n-\n-    std::string ToString() const\n-    {\n-        std::string str = \"CDiskBlockIndex(\";\n-        str += CBlockIndex::ToString();\n-        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s)\",\n-            GetBlockHash().ToString(),\n-            hashPrev.ToString());\n-        return str;\n-    }\n+    // To be called only by the base class.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r925441496",
      "id" : 925441496,
      "in_reply_to_id" : 922158695,
      "line" : 411,
      "node_id" : "PRRC_kwDOABII5843KR3Y",
      "original_commit_id" : "7866c85387c3fa553437be1e004986b889fcd2de",
      "original_line" : 417,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/chain.h",
      "position" : 57,
      "pull_request_review_id" : 1044790892,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925441496/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-20T10:27:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925441496",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r925444518"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925444518"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> The crash is not related to the inheritance or the deleted methods from this PR.\r\n\r\nYes. I'm thinking it would maybe be best to revert this PR to the commit of the last ACK and propose the CBlockIndex improvements separately.\r\n",
      "commit_id" : "2ececec41e780ca0fe3aa945313a34750618c50e",
      "created_at" : "2022-07-20T10:30:55Z",
      "diff_hunk" : "@@ -414,16 +414,9 @@ class CDiskBlockIndex : public CBlockIndex\n         return block.GetHash();\n     }\n \n-\n-    std::string ToString() const\n-    {\n-        std::string str = \"CDiskBlockIndex(\";\n-        str += CBlockIndex::ToString();\n-        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s)\",\n-            GetBlockHash().ToString(),\n-            hashPrev.ToString());\n-        return str;\n-    }\n+    // To be called only by the base class.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r925444518",
      "id" : 925444518,
      "in_reply_to_id" : 922158695,
      "line" : 411,
      "node_id" : "PRRC_kwDOABII5843KSmm",
      "original_commit_id" : "7866c85387c3fa553437be1e004986b889fcd2de",
      "original_line" : 417,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/chain.h",
      "position" : 57,
      "pull_request_review_id" : 1044795221,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925444518/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-20T10:30:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925444518",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r925514590"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925514590"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> The crash is not related to the inheritance or the deleted methods from this PR.\r\n\r\nCorrect, this is why I commented on the documentation, which seemed to encourage calling the deleted method on the base class instead.",
      "commit_id" : "2ececec41e780ca0fe3aa945313a34750618c50e",
      "created_at" : "2022-07-20T11:52:40Z",
      "diff_hunk" : "@@ -414,16 +414,9 @@ class CDiskBlockIndex : public CBlockIndex\n         return block.GetHash();\n     }\n \n-\n-    std::string ToString() const\n-    {\n-        std::string str = \"CDiskBlockIndex(\";\n-        str += CBlockIndex::ToString();\n-        str += strprintf(\"\\n                hashBlock=%s, hashPrev=%s)\",\n-            GetBlockHash().ToString(),\n-            hashPrev.ToString());\n-        return str;\n-    }\n+    // To be called only by the base class.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25349#discussion_r925514590",
      "id" : 925514590,
      "in_reply_to_id" : 922158695,
      "line" : 411,
      "node_id" : "PRRC_kwDOABII5843Kjte",
      "original_commit_id" : "7866c85387c3fa553437be1e004986b889fcd2de",
      "original_line" : 417,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/chain.h",
      "position" : 57,
      "pull_request_review_id" : 1044894494,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25349",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925514590/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-20T11:52:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925514590",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
