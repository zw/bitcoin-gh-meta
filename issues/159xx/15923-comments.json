[
   {
      "author_association" : "MEMBER",
      "body" : "Unless I am mistaken, that would increase the CPU load on nodes when they are asked for blocks other than the tip (which is kept in memory, I believe).\r\n\r\nAlso, I am not sure about the code complexity, since handling archives is easy to get wrong (e.g. CVE-2019-9195)",
      "created_at" : "2019-04-29T19:11:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/15923#issuecomment-487706263",
      "id" : 487706263,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15923",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NzcwNjI2Mw==",
      "updated_at" : "2019-04-29T19:11:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/487706263",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I don't see increased CPU load on nodes as a problem if it's optional feature. For some users CPU load could be the biggest issue, for others disk space. Also, probably sending compressed blocks P2P could be improvement for some full node operators, as for many people bandwidth is the biggest issue currently.",
      "created_at" : "2019-04-29T19:22:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/15923#issuecomment-487709933",
      "id" : 487709933,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15923",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NzcwOTkzMw==",
      "updated_at" : "2019-04-29T19:22:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/487709933",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/4500994?v=4",
         "events_url" : "https://api.github.com/users/kristapsk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kristapsk/followers",
         "following_url" : "https://api.github.com/users/kristapsk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kristapsk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kristapsk",
         "id" : 4500994,
         "login" : "kristapsk",
         "node_id" : "MDQ6VXNlcjQ1MDA5OTQ=",
         "organizations_url" : "https://api.github.com/users/kristapsk/orgs",
         "received_events_url" : "https://api.github.com/users/kristapsk/received_events",
         "repos_url" : "https://api.github.com/users/kristapsk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kristapsk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kristapsk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kristapsk"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "LevelDB compaction has support for Snappy compression by default, which would probably be much easier to support than adding something else in. But there's a catch. LevelDB compaction only works in key-value mode, and the block-store uses a raw 4K-block (disk blocks) mode with no keys, which is a contiguous mode. So, you'd need to convert the block store to key-values to use Snappy compression, which would add a new overhead of a key index, and would change performance in other ways.\r\n\r\nSomething that could technically be done would be to add a \"change block-store type\" function that rebuilds the block storage as a key-value OR contiguous data. Then the option of enabling or disabling compression would be possible. But it would also add some code complexity that I'm not sure is desirable.",
      "created_at" : "2019-05-05T19:48:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/15923#issuecomment-489457589",
      "id" : 489457589,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15923",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4OTQ1NzU4OQ==",
      "updated_at" : "2019-05-05T19:48:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/489457589",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/8435003?v=4",
         "events_url" : "https://api.github.com/users/tryphe/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tryphe/followers",
         "following_url" : "https://api.github.com/users/tryphe/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tryphe/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tryphe",
         "id" : 8435003,
         "login" : "tryphe",
         "node_id" : "MDQ6VXNlcjg0MzUwMDM=",
         "organizations_url" : "https://api.github.com/users/tryphe/orgs",
         "received_events_url" : "https://api.github.com/users/tryphe/received_events",
         "repos_url" : "https://api.github.com/users/tryphe/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tryphe/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tryphe/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tryphe"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@tryphe The blockchain isn't stored in LevelDB at all, and there is no point in doing so.",
      "created_at" : "2019-05-05T19:51:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/15923#issuecomment-489457778",
      "id" : 489457778,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15923",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4OTQ1Nzc3OA==",
      "updated_at" : "2019-05-05T19:51:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/489457778",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@sipa, thanks!\r\n\r\n~~I'm surprised you can actually compress any of it since it's bitmasked anyways.~~\r\n\r\nI guess that's only the chainstate data with the bitmask. Sorry for the confusion. I guess I figured someone would've put data flagged by AV heuristics into the blocks somehow by now.",
      "created_at" : "2019-05-05T19:53:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/15923#issuecomment-489457963",
      "id" : 489457963,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15923",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4OTQ1Nzk2Mw==",
      "updated_at" : "2019-05-05T20:55:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/489457963",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/8435003?v=4",
         "events_url" : "https://api.github.com/users/tryphe/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tryphe/followers",
         "following_url" : "https://api.github.com/users/tryphe/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tryphe/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tryphe",
         "id" : 8435003,
         "login" : "tryphe",
         "node_id" : "MDQ6VXNlcjg0MzUwMDM=",
         "organizations_url" : "https://api.github.com/users/tryphe/orgs",
         "received_events_url" : "https://api.github.com/users/tryphe/received_events",
         "repos_url" : "https://api.github.com/users/tryphe/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tryphe/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tryphe/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tryphe"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@ranseier86  I wonder if the better solution would be to just use something like ZFS or btrfs. You'd get compression at disk level without changing anything.",
      "created_at" : "2019-05-05T20:55:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/15923#issuecomment-489462567",
      "id" : 489462567,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15923",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4OTQ2MjU2Nw==",
      "updated_at" : "2019-05-05T20:56:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/489462567",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/8435003?v=4",
         "events_url" : "https://api.github.com/users/tryphe/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tryphe/followers",
         "following_url" : "https://api.github.com/users/tryphe/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tryphe/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tryphe",
         "id" : 8435003,
         "login" : "tryphe",
         "node_id" : "MDQ6VXNlcjg0MzUwMDM=",
         "organizations_url" : "https://api.github.com/users/tryphe/orgs",
         "received_events_url" : "https://api.github.com/users/tryphe/received_events",
         "repos_url" : "https://api.github.com/users/tryphe/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tryphe/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tryphe/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tryphe"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@tryphe I'm using ZFS on a FreeNAS system for two BTC nodes in jails. One is lz4 compression.  The other is gzip-9.\r\n\r\nHere's some numbers for you:\r\n```shell\r\nroot@btc:~ # du -A -h -d 0 .bitcoin/blocks .bitcoin/chainstate\r\n231G\t.bitcoin/blocks\r\n3.0G\t.bitcoin/chainstate\r\nroot@btc:~ # du -h -d 0 .bitcoin/blocks .bitcoin/chainstate\r\n208G\t.bitcoin/blocks\r\n3.0G\t.bitcoin/chainstate\r\n```\r\n\r\n```shell\r\nroot@btc-gzip9:~ # du -A -h -d 0 .bitcoin/blocks .bitcoin/chainstate\r\n231G\t.bitcoin/blocks\r\n3.0G\t.bitcoin/chainstate\r\nroot@btc-gzip9:~ # du -h -d 0 .bitcoin/blocks .bitcoin/chainstate\r\n190G\t.bitcoin/blocks\r\n2.8G\t.bitcoin/chainstate\r\n```\r\nI have space to test other compression algorithms if that'd be helpful.",
      "created_at" : "2019-05-07T05:19:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/15923#issuecomment-489912283",
      "id" : 489912283,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15923",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4OTkxMjI4Mw==",
      "updated_at" : "2019-05-07T05:19:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/489912283",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/13903678?v=4",
         "events_url" : "https://api.github.com/users/russoj88/events{/privacy}",
         "followers_url" : "https://api.github.com/users/russoj88/followers",
         "following_url" : "https://api.github.com/users/russoj88/following{/other_user}",
         "gists_url" : "https://api.github.com/users/russoj88/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/russoj88",
         "id" : 13903678,
         "login" : "russoj88",
         "node_id" : "MDQ6VXNlcjEzOTAzNjc4",
         "organizations_url" : "https://api.github.com/users/russoj88/orgs",
         "received_events_url" : "https://api.github.com/users/russoj88/received_events",
         "repos_url" : "https://api.github.com/users/russoj88/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/russoj88/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/russoj88/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/russoj88"
      }
   }
]
