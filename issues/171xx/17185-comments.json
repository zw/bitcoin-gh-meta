[
   {
      "author_association" : "NONE",
      "body" : "Same issue in WSL and when running in an administrator prompt. Dunno why the port bind on 8332 is failing. Don't think I have anything running there, if I try to connect netcat to that local port, I get 'Connection Refused'.",
      "created_at" : "2019-10-18T07:20:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17185#issuecomment-543563438",
      "id" : 543563438,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17185",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MzU2MzQzOA==",
      "updated_at" : "2019-10-18T07:23:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/543563438",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/284023?v=4",
         "events_url" : "https://api.github.com/users/ysangkok/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ysangkok/followers",
         "following_url" : "https://api.github.com/users/ysangkok/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ysangkok/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ysangkok",
         "id" : 284023,
         "login" : "ysangkok",
         "node_id" : "MDQ6VXNlcjI4NDAyMw==",
         "organizations_url" : "https://api.github.com/users/ysangkok/orgs",
         "received_events_url" : "https://api.github.com/users/ysangkok/received_events",
         "repos_url" : "https://api.github.com/users/ysangkok/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ysangkok/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ysangkok/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ysangkok"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This is the assertion it crashes on:\r\n```\r\nvoid CZMQAbstractPublishNotifier::Shutdown()\r\n{\r\n    assert(psocket);\r\n```\r\n\r\n- The bind problem is not fatal (it means it cannot bind on IPv6 localhost, but it will still have bound on IPv4 localhost), and continues after it.\r\n- The missing banlist is also not fatal.\r\n\r\nSo I expect it's the zmq arguments.\r\n\r\nCan you try a  different syntax?\r\n\r\n```\r\nzmqpubrawblock=tcp://127.0.0.1:40000\r\nzmqpubrawtx=tcp://127.0.0.1:40000\r\n```",
      "created_at" : "2019-10-18T09:07:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17185#issuecomment-543617846",
      "id" : 543617846,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17185",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MzYxNzg0Ng==",
      "updated_at" : "2019-10-18T09:07:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/543617846",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "The syntax you propose works, but i don't think it should crash with\ninvalid syntax. It would make sense to default to tcp since it is arguably\nmore popular than named pipes.\n\nOn Fri, 18 Oct 2019, 04:12 Wladimir J. van der Laan, <\nnotifications@github.com> wrote:\n\n> This is the assertion it crashes on:\n>\n> void CZMQAbstractPublishNotifier::Shutdown()\n> {\n>     assert(psocket);\n>\n>\n>    - The bind problem is not fatal (it means it cannot bind on IPv6\n>    localhost, but it will still have bound on IPv4 localhost), and continues\n>    after it.\n>    - The missing banlist is also not fatal.\n>\n> So I expect it's the zmq arguments.\n>\n> Can you try a different syntax?\n>\n> zmqpubrawblock=tcp://127.0.0.1:40000\n> zmqpubrawtx=tcp://127.0.0.1:40000\n>\n> â\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/bitcoin/bitcoin/issues/17185?email_source=notifications&email_token=AACFK5YI3XQEWPGPVYA7DZLQPF4YFA5CNFSM4JCDPC7KYY3PNVWWK3TUL52HS4DFVREXG43VMVBW63LNMVXHJKTDN5WW2ZLOORPWSZGOEBTPGNQ#issuecomment-543617846>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AACFK52STQFUUDUOMMSGVK3QPF4YFANCNFSM4JCDPC7A>\n> .\n>\n",
      "created_at" : "2019-10-18T16:04:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17185#issuecomment-543812096",
      "id" : 543812096,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17185",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MzgxMjA5Ng==",
      "updated_at" : "2019-10-18T16:04:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/543812096",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/284023?v=4",
         "events_url" : "https://api.github.com/users/ysangkok/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ysangkok/followers",
         "following_url" : "https://api.github.com/users/ysangkok/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ysangkok/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ysangkok",
         "id" : 284023,
         "login" : "ysangkok",
         "node_id" : "MDQ6VXNlcjI4NDAyMw==",
         "organizations_url" : "https://api.github.com/users/ysangkok/orgs",
         "received_events_url" : "https://api.github.com/users/ysangkok/received_events",
         "repos_url" : "https://api.github.com/users/ysangkok/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ysangkok/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ysangkok/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ysangkok"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I agree it should not crash. Not sure if it should default to tpc but at least should fail to start with an error message. ",
      "created_at" : "2019-10-18T19:50:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17185#issuecomment-543910905",
      "id" : 543910905,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17185",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MzkxMDkwNQ==",
      "updated_at" : "2019-10-18T19:50:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/543910905",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "In macos I get:\r\n```\r\n./src/bitcoind -regtest -debug -zmqpubrawtx=foo\r\n\r\n...\r\n2019-11-02T16:29:37Z zmq: Error: Failed to bind address, errno=Invalid argument\r\n2019-11-02T16:29:37Z zmq: Notifier pubrawtx failed (address = foo)\r\n2019-11-02T16:29:37Z zmq: Shutdown notification interface\r\n2019-11-02T16:29:37Z zmq: Shutdown notifier pubrawtx at foo\r\n...\r\n```\r\nAnd doesn't abort. Can you also check the output with `-debug` argument?",
      "created_at" : "2019-11-02T16:31:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17185#issuecomment-549059441",
      "id" : 549059441,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17185",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0OTA1OTQ0MQ==",
      "updated_at" : "2019-11-02T16:31:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/549059441",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@promag log with `-debug` , as you requested:\r\n\r\n```\r\nPS C:\\Program Files\\Bitcoin\\daemon> .\\bitcoind -regtest -txindex -debug\r\n2019-11-09T19:04:17Z Bitcoin Core version v0.18.1 (release build)\r\n2019-11-09T19:04:17Z Validating signatures for all blocks.\r\n2019-11-09T19:04:17Z Setting nMinimumChainWork=0000000000000000000000000000000000000000000000000000000000000000\r\n2019-11-09T19:04:17Z Using the 'sse4(1way),sse41(4way),avx2(8way)' SHA256 implementation\r\n2019-11-09T19:04:17Z Using RdSeed as additional entropy source\r\n2019-11-09T19:04:17Z Using RdRand as an additional entropy source\r\n2019-11-09T19:04:17Z Default data directory C:\\Users\\janus\\AppData\\Roaming\\Bitcoin\r\n2019-11-09T19:04:17Z Using data directory C:\\Users\\janus\\AppData\\Roaming\\Bitcoin\\regtest\r\n2019-11-09T19:04:17Z Config file: C:\\Users\\janus\\AppData\\Roaming\\Bitcoin\\bitcoin.conf\r\n2019-11-09T19:04:17Z Using at most 125 automatic connections (2048 file descriptors available)\r\n2019-11-09T19:04:17Z Using 16 MiB out of 32/2 requested for signature cache, able to store 524288 elements\r\n2019-11-09T19:04:17Z Using 16 MiB out of 32/2 requested for script execution cache, able to store 524288 elements\r\n2019-11-09T19:04:17Z Using 4 threads for script verification\r\n2019-11-09T19:04:17Z scheduler thread start\r\n2019-11-09T19:04:17Z Allowing HTTP connections from: 127.0.0.0/8 ::1/128\r\n2019-11-09T19:04:17Z Binding RPC on address ::1 port 8332\r\n2019-11-09T19:04:17Z libevent: getaddrinfo: nodename nor servname provided, or not known\r\n2019-11-09T19:04:17Z Binding RPC on address ::1 port 8332 failed.\r\n2019-11-09T19:04:17Z Binding RPC on address 127.0.0.1 port 8332\r\n2019-11-09T19:04:17Z Initialized HTTP server\r\n2019-11-09T19:04:17Z HTTP: creating work queue of depth 16\r\n2019-11-09T19:04:17Z Starting RPC\r\n2019-11-09T19:04:17Z Starting HTTP RPC server\r\n2019-11-09T19:04:17Z Config options rpcuser and rpcpassword will soon be deprecated. Locally-run instances may remove rpcuser to use cookie-based auth, or may be replaced with rpcauth. Please see share/rpcauth for rpcauth auth generation.\r\n2019-11-09T19:04:17Z Registering HTTP handler for / (exactmatch 1)\r\n2019-11-09T19:04:17Z Registering HTTP handler for /wallet/ (exactmatch 0)\r\n2019-11-09T19:04:17Z Starting HTTP server\r\n2019-11-09T19:04:17Z HTTP: starting 4 worker threads\r\n2019-11-09T19:04:17Z Entering http event loop\r\n2019-11-09T19:04:17Z Using wallet directory C:\\Users\\janus\\AppData\\Roaming\\Bitcoin\\regtest\\wallets\r\n2019-11-09T19:04:17Z init message: Verifying wallet(s)...\r\n2019-11-09T19:04:17Z Using BerkeleyDB version Berkeley DB 4.8.30: (April  9, 2010)\r\n2019-11-09T19:04:17Z Using wallet C:\\Users\\janus\\AppData\\Roaming\\Bitcoin\\regtest\\wallets\r\n2019-11-09T19:04:17Z BerkeleyEnvironment::Open: LogDir=C:\\Users\\janus\\AppData\\Roaming\\Bitcoin\\regtest\\wallets\\database ErrorFile=C:\\Users\\janus\\AppData\\Roaming\\Bitcoin\\regtest\\wallets\\db.log\r\n2019-11-09T19:04:17Z init message: Loading banlist...\r\n2019-11-09T19:04:17Z Loaded 0 banned node ips/subnets from banlist.dat  0ms\r\n2019-11-09T19:04:17Z net: setting try another outbound peer=false\r\n2019-11-09T19:04:17Z zmq: version 4.3.1\r\n2019-11-09T19:04:17Z zmq: Initialize notification interface\r\n2019-11-09T19:04:17Z zmq: Outbound message high water mark for pubrawblock at 127.0.0.1:40000 is 1000\r\n2019-11-09T19:04:17Z zmq: Error: Failed to bind address, errno=Invalid argument\r\n2019-11-09T19:04:17Z zmq: Notifier pubrawblock failed (address = 127.0.0.1:40000)\r\n2019-11-09T19:04:17Z zmq: Shutdown notification interface\r\n2019-11-09T19:04:17Z zmq: Shutdown notifier pubrawblock at 127.0.0.1:40000\r\n2019-11-09T19:04:17Z zmq: Shutdown notifier pubrawtx at 127.0.0.1:40001\r\nAssertion failed!\r\n\r\nProgram: C:\\Program Files\\Bitcoin\\daemon\\bitcoind.exe\r\nFile: zmq/zmqpublishnotifier.cpp, Line 115\r\n\r\nExpression: psocket\r\n```",
      "created_at" : "2019-11-09T19:05:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17185#issuecomment-552127953",
      "id" : 552127953,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17185",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1MjEyNzk1Mw==",
      "updated_at" : "2019-11-09T19:05:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/552127953",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/284023?v=4",
         "events_url" : "https://api.github.com/users/ysangkok/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ysangkok/followers",
         "following_url" : "https://api.github.com/users/ysangkok/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ysangkok/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ysangkok",
         "id" : 284023,
         "login" : "ysangkok",
         "node_id" : "MDQ6VXNlcjI4NDAyMw==",
         "organizations_url" : "https://api.github.com/users/ysangkok/orgs",
         "received_events_url" : "https://api.github.com/users/ysangkok/received_events",
         "repos_url" : "https://api.github.com/users/ysangkok/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ysangkok/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ysangkok/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ysangkok"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> It would make sense to default to tcp since it is arguably more popular than named pipes.\r\n\r\nI disagree that the project should be making these kinds of calls. The arguments are provided as-is to zmq, it's up to the user to provide correct input. Ignoring invalid or ambigious input is even worse.\r\n\r\nBut I agree that crashing on an error is bad user experience, it should just print an error message and exit.",
      "created_at" : "2019-11-10T14:24:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17185#issuecomment-552199405",
      "id" : 552199405,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17185",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1MjE5OTQwNQ==",
      "updated_at" : "2019-11-10T14:25:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/552199405",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
