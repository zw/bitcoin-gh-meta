{
   "assignee" : null,
   "body" : "Includes https://github.com/bitcoin/bitcoin/pull/6006 and https://github.com/bitcoin/bitcoin/pull/5990\r\nSupersedes https://github.com/bitcoin/bitcoin/pull/5686 and https://github.com/bitcoin/bitcoin/pull/5744\r\nPR is mainly for discussion and a try to get a direction where to go.\r\n\r\nThis will demonstrate a design of a possible wallet modularity and should allow one to get \"the big picture\". The new wallet (currently called \"corewallet\") is completely decoupled from the core and the current wallet. It can run in parallel with the current wallet.\r\n\r\n## Modularization ##\r\n* The current wallet is functional untouched, but there are serval modularity changes (mainly https://github.com/bitcoin/bitcoin/pull/5990).\r\n\r\n## CoreWallet ##\r\n* Dummy wallet (can only generate addresses)\r\n* logdb: checksummed append only file format\r\n* basic multiwallet support\r\n* No selected-wallet state (no \"active wallet\"), every RPC call should have a \"walletid\" arg (it would be possible to keep this empty if only one wallet is present)\r\n* Very basic Bip32 implementation (I'm currently working on that)\r\n\r\n## RPC ##\r\n* RPC endpoint for CoreWallet is `/wallet`.\r\n* RPC parameters should always come through a property list (json object like `[\"hex\": \"ea6\", \"flag\": true]`) to avoid parameter ordering\r\n\r\n## Bitcoin-Cli ##\r\n[not implemented yet]\r\n* `bitcoin-cli -w` should access the new endpoint and parameters will be converted to a json property list (`bitcoin-cli -w walletid=default flag=true anotherflag=1 <command>` will be converted to `[\"walletid\":\"default\", \"flag\":true, anotherflag:1]`).\r\n\r\n## Code Guidelines ##\r\n* CoreWallet is completely held in a namespace to avoid interfering with CWallet and co.\r\n* CoreWallet should not use any exiting namespaces like std, boost or json_spirit\r\n\r\n## GUI ##\r\n* If CoreWallet gets stable, it would be possible to switch the GUI implementation to the new wallet\r\n* Currently the GUI is tied to the current wallet. Supporting multiple wallet implementations on GUI level makes no sense IMO.\r\n\r\n## Step-by-step approach ##\r\n* corewallet must be enabled during configuring (`--enable-corewallet=yes`), default is `no` so a merging into master could be seen as safe.\r\n\r\n## How to continue\r\nThe groundwork PRs are already open (#6006, #5990, etc.). More small and reviewable PRs will follow.\r\n\r\n A good way would be to merge the modularity groundwork as well as a very basic \"corewallet\" implementation. As long as corewallet will only compile with an additional flag, this should be safe and others could also start contributing to the new wallet (add implementation, help reviewing, etc.).\r\n\r\nCritics, conceptual reviews and ideas are highly welcome. ",
   "closed_at" : "2015-09-15T18:28:10Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
      "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
      "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/jonasschnelli",
      "id" : 178464,
      "login" : "jonasschnelli",
      "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
      "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
      "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/jonasschnelli"
   },
   "comments" : 2,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6008/comments",
   "created_at" : "2015-04-13T17:18:55Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6008/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/6008",
   "id" : 68148127,
   "labels" : [
      {
         "color" : "02d7e1",
         "name" : "Wallet",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6008/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 6008,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/6008.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6008",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/6008.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6008"
   },
   "state" : "closed",
   "title" : "[PoC/Concept review] add 2nd wallet \"corewallet\"",
   "updated_at" : "2015-09-15T18:28:10Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6008",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
      "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
      "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/jonasschnelli",
      "id" : 178464,
      "login" : "jonasschnelli",
      "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
      "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
      "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/jonasschnelli"
   }
}
