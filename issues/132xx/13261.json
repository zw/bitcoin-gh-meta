{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "NONE",
   "body" : "In a simple scenario where Bob pays Marry some BTC sending a signed raw Tx, the accounts / UTOX list show some inconsistency.\r\n\r\nPlease note, that at the end only Marry (but Bob no longer) has an UTOX, but the account balances are shown like this\r\n\r\n```\r\n> listaccounts\r\n{\r\n  \"\": 129.99996200,\r\n  \"Bob\": 10.00000000,\r\n  \"Marry\": 9.99000000\r\n}\r\n```\r\n\r\nIt seems that Marry got payed from the default account, instead of Bob's account as defined in the raw Tx.\r\n\r\n```\r\n> generate 101\r\n\r\n> importprivkey cVfiZLCWbCm3SWoBAToaCoMuYJJjEw5cR6ifuWQY1a5wadXynGC2 Bob \r\n\r\n> importprivkey cMcT5vjU5UiF2mh8WE6EsD3YdFEuFuUKm6rCcA8UuR9FUS6VLeRx Marry\r\n\r\n> listaccounts\r\n{\r\n  \"\": 50.00000000,\r\n  \"Bob\": 0.00000000,\r\n  \"Marry\": 0.00000000\r\n}\r\n\r\n> getaddressesbyaccount Bob\r\n[\r\n  \"n3ha6rJa8ZS7B4v4vwNWn8CnLHfUYXW1XE\",\r\n  \"2Mxztt6zTZ7KPHMdPt8iYtSLxQ9FHAPJMns\",\r\n  \"bcrt1q7d2dzgxmgu4kzpmvrlz306kcffw225ydq2jwm7\"\r\n]\r\n\r\n> getaddressesbyaccount Marry\r\n[\r\n  \"mm2PoHeFncAStYeZJSSTa4bmUVXRa3L6PL\",\r\n  \"2NCvSGnUTueMFim31cpyw7yp1pKwAyeH4Vj\",\r\n  \"bcrt1q835lks7r7s7qru78g7uh6l5apr46akde5z5zq2\"\r\n]\r\n\r\n> sendtoaddress n3ha6rJa8ZS7B4v4vwNWn8CnLHfUYXW1XE 10.0\r\n> generate 1\r\n> listaccounts\r\n{\r\n  \"\": 89.99996200,\r\n  \"Bob\": 10.00000000,\r\n  \"Marry\": 0.00000000\r\n}\r\n\r\n> listunspent 1\r\n[\r\n  ...,\r\n  {\r\n    \"txid\": \"c680f0abc596dfb5cec6dfc44a7ef7e54c2fa0b6557910c67cc4c3474487d37c\",\r\n    \"vout\": 0,\r\n    \"address\": \"n3ha6rJa8ZS7B4v4vwNWn8CnLHfUYXW1XE\",\r\n    \"account\": \"Bob\",\r\n    \"scriptPubKey\": \"76a914f354d120db472b61076c1fc517ead84a5ca5508d88ac\",\r\n    \"amount\": 10.00000000,\r\n    \"confirmations\": 1,\r\n    \"spendable\": true,\r\n    \"solvable\": true,\r\n    \"safe\": true\r\n  },\r\n  ...\r\n]\r\n\r\n> createrawtransaction '[{\"txid\":\"c680f0abc596dfb5cec6dfc44a7ef7e54c2fa0b6557910c67cc4c3474487d37c\",\"vout\":0}]' '{\"mm2PoHeFncAStYeZJSSTa4bmUVXRa3L6PL\":9.99}'\r\n02000000017cd3874447c3c47cc6107955b6a02f4ce5f77e4ac4dfc6ceb5df96c5abf080c60000000000ffffffff01c0878b3b000000001976a9143c69fb43c3f43c01f3c747b97d7e9d08ebaed9b988ac00000000\r\n\r\n> signrawtransaction '02000000017cd3874447c3c47cc6107955b6a02f4ce5f77e4ac4dfc6ceb5df96c5abf080c60000000000ffffffff01c0878b3b000000001976a9143c69fb43c3f43c01f3c747b97d7e9d08ebaed9b988ac00000000' '[{\"txid\":\"c680f0abc596dfb5cec6dfc44a7ef7e54c2fa0b6557910c67cc4c3474487d37c\",\"vout\":0, \"scriptPubKey\":\"76a914f354d120db472b61076c1fc517ead84a5ca5508d88ac\"}]' '[\"cVfiZLCWbCm3SWoBAToaCoMuYJJjEw5cR6ifuWQY1a5wadXynGC2\"]'\r\n{\r\n  \"hex\": \"02000000017cd3874447c3c47cc6107955b6a02f4ce5f77e4ac4dfc6ceb5df96c5abf080c6000000006a473044022009fcc3faa221db782d56f1e388979e61d5eb903ec0f16e919051aba631c3bdbf022073be7a8ea3ba73e436f6dd2f4b365131fe4537bbfa0944a73872e15e55f366eb01210389f32f5b1a8339b53308c4ee36bdcaacec27cf74e4138d2b372c8df323c21cf6ffffffff01c0878b3b000000001976a9143c69fb43c3f43c01f3c747b97d7e9d08ebaed9b988ac00000000\",\r\n  \"complete\": true\r\n}\r\n\r\n> sendrawtransaction 02000000017cd3874447c3c47cc6107955b6a02f4ce5f77e4ac4dfc6ceb5df96c5abf080c6000000006a473044022009fcc3faa221db782d56f1e388979e61d5eb903ec0f16e919051aba631c3bdbf022073be7a8ea3ba73e436f6dd2f4b365131fe4537bbfa0944a73872e15e55f366eb01210389f32f5b1a8339b53308c4ee36bdcaacec27cf74e4138d2b372c8df323c21cf6ffffffff01c0878b3b000000001976a9143c69fb43c3f43c01f3c747b97d7e9d08ebaed9b988ac00000000\r\n> generate 1\r\n\r\n> listunspent 1\r\n[\r\n  {\r\n    \"txid\": \"efcac0dca6a10e9f0a2a89ac34e64309819441dcc2f9553e1d3cf52a333ab939\",\r\n    \"vout\": 0,\r\n    \"address\": \"mqnLRnRoExhUFsP1Y66JLen2h2qXtCw8dF\",\r\n    \"scriptPubKey\": \"210340323d67d27e075030ea9c286e078e30ec728b46710952d3e2bb201cca533b24ac\",\r\n    \"amount\": 50.00000000,\r\n    \"confirmations\": 102,\r\n    \"spendable\": true,\r\n    \"solvable\": true,\r\n    \"safe\": true\r\n  },\r\n  {\r\n    \"txid\": \"fa3a28d1f9136fadb43984e464276b6b2a28443af0a0f73381487a71204a4d44\",\r\n    \"vout\": 0,\r\n    \"address\": \"mm2PoHeFncAStYeZJSSTa4bmUVXRa3L6PL\",\r\n    \"account\": \"Marry\",\r\n    \"scriptPubKey\": \"76a9143c69fb43c3f43c01f3c747b97d7e9d08ebaed9b988ac\",\r\n    \"amount\": 9.99000000,\r\n    \"confirmations\": 1,\r\n    \"spendable\": true,\r\n    \"solvable\": true,\r\n    \"safe\": true\r\n  },\r\n  {\r\n    \"txid\": \"c680f0abc596dfb5cec6dfc44a7ef7e54c2fa0b6557910c67cc4c3474487d37c\",\r\n    \"vout\": 1,\r\n    \"address\": \"2NFAvRVEoE7jfVuZQkSgSNZRkEUeUeic3HR\",\r\n    \"redeemScript\": \"001406a25b3828b5f9a58940279fb65c72fa3ebf8702\",\r\n    \"scriptPubKey\": \"a914f08270c43a050a9faf69dc0bdd3b8e078a48c56987\",\r\n    \"amount\": 39.99996200,\r\n    \"confirmations\": 2,\r\n    \"spendable\": true,\r\n    \"solvable\": true,\r\n    \"safe\": true\r\n  },\r\n  {\r\n    \"txid\": \"8104c596910e143232dd3f6c94875fe42ef358908575bb87e93830d9db2c77d4\",\r\n    \"vout\": 0,\r\n    \"address\": \"mqnLRnRoExhUFsP1Y66JLen2h2qXtCw8dF\",\r\n    \"scriptPubKey\": \"210340323d67d27e075030ea9c286e078e30ec728b46710952d3e2bb201cca533b24ac\",\r\n    \"amount\": 50.00000000,\r\n    \"confirmations\": 101,\r\n    \"spendable\": true,\r\n    \"solvable\": true,\r\n    \"safe\": true\r\n  }\r\n]\r\n\r\n> listaccounts\r\n{\r\n  \"\": 129.99996200,\r\n  \"Bob\": 10.00000000,\r\n  \"Marry\": 9.99000000\r\n}\r\n``` ",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 0,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13261/comments",
   "created_at" : "2018-05-17T09:00:13Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13261/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/13261",
   "id" : 323931798,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13261/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 13261,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "Account inconsistency in regtest with raw Tx",
   "updated_at" : "2018-05-17T09:01:02Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13261",
   "user" : {
      "avatar_url" : "https://avatars1.githubusercontent.com/u/244946?v=4",
      "events_url" : "https://api.github.com/users/tdiesler/events{/privacy}",
      "followers_url" : "https://api.github.com/users/tdiesler/followers",
      "following_url" : "https://api.github.com/users/tdiesler/following{/other_user}",
      "gists_url" : "https://api.github.com/users/tdiesler/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/tdiesler",
      "id" : 244946,
      "login" : "tdiesler",
      "organizations_url" : "https://api.github.com/users/tdiesler/orgs",
      "received_events_url" : "https://api.github.com/users/tdiesler/received_events",
      "repos_url" : "https://api.github.com/users/tdiesler/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/tdiesler/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/tdiesler/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/tdiesler"
   }
}
