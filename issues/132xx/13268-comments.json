[
   {
      "author_association" : "MEMBER",
      "body" : "I'd suggest dropping the third commit, which at first glance would seem to introduce a number of vulnerabilities.  I agree though that it would be useful to add tests that would fail if that third commit were introduced.",
      "created_at" : "2018-05-18T00:49:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13268#issuecomment-390059084",
      "id" : 390059084,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13268",
      "updated_at" : "2018-05-18T00:49:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/390059084",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sdaftuar thanks, by vulnerabilities, I suppose you mean there is a risk of maliciously-crafted transactions bringing down the recipient node by triggering the throws, is that right? I hadn't been considering the changes through that lens, but I can take a second look with that in mind.",
      "created_at" : "2018-05-18T01:04:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13268#issuecomment-390062045",
      "id" : 390062045,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13268",
      "updated_at" : "2018-05-18T01:04:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/390062045",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sdaftuar I removed the third commit. Seems the remaining cases should be safe given they're already asserted against or otherwise assumed to be safe, such that the invalid values are not contended with at all.",
      "created_at" : "2018-05-18T08:46:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13268#issuecomment-390139587",
      "id" : 390139587,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13268",
      "updated_at" : "2018-05-18T08:48:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/390139587",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK on clarifying bounds, but I really don't like the use of exceptions replacing explicit prior checks. I understand that they accomplish the same thing, but IMO it is far less safe because it equates checks that are allowed to fail with those that logically never should. It also turns potential compile-time checks into guaranteed runtime ones.\r\n\r\nLastly, it really harms code clarity. [This one](https://github.com/bitcoin/bitcoin/pull/13268/files#diff-16ff13d96f03a4141db0105c59dc71d5) for example, is a significant regression IMO.",
      "created_at" : "2018-05-18T16:02:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13268#issuecomment-390254067",
      "id" : 390254067,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13268",
      "updated_at" : "2018-05-18T16:02:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/390254067",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> it equates checks that are allowed to fail with those that logically never should\r\n\r\nAccording to http://en.cppreference.com/w/cpp/error/logic_error, this exception type \"reports errors that are a consequence of faulty logic within the program such as violating logical preconditions or class invariants\", so it doesn't seem switching from `operator[]` to `at()` in c++ should be taken to indicate any change in preconditions or intent.\r\n\r\nBut there may still be practical reasons to favor throwing exceptions explicitly or using `assert()` instead of relying on `at()`. For example, Matt thought it was important to assert instead of raising an exception here: https://github.com/bitcoin/bitcoin/pull/11640#discussion_r150035812 to prevent errors from being caught in generic catch blocks.",
      "created_at" : "2018-05-18T16:38:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13268#issuecomment-390263753",
      "id" : 390263753,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13268",
      "updated_at" : "2018-05-18T16:38:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/390263753",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> it doesn't seem switching from operator[] to at() in c++ should be taken to indicate any change in preconditions or intent.\r\n\r\n> But there may still be practical reasons to favor throwing exceptions explicitly or using assert() instead of relying on at().\r\n\r\nThis seems to only be a philosophical distinction to me. Yes, maybe  `std::logic_error` isn't designed to caught by normal program code, and can thus be treated similarly to an assertion failure - but that's not the case in our code. We have 54 `catch (const std::exception& e)` cases in our codebase, some of which will happily continue after catching an out of bounds error.\r\n\r\nPerhaps we should work on making those catch statements be more specific and guarantee they can't catch `std::logic_error`s? Without that, I'm very scared about replacing asserts with exceptions.",
      "created_at" : "2018-05-18T17:40:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13268#issuecomment-390280367",
      "id" : 390280367,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13268",
      "updated_at" : "2018-05-18T17:40:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/390280367",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
