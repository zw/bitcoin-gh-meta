[
   {
      "author_association" : "MEMBER",
      "body" : "I'm glad to see someone working on this!\r\n\r\nOne prior proposal was to put _all_ inbound into one timing bucket, and keep per-peer timing for each outbound with the rationale that the attacker doesn't control our outbounds but could potentially control any inbounds.\r\n\r\nIf we found that to be too slow we could quantize inbound network groups into a small number of buckets (e.g. 4, by computing  hasher(seed, netgroup)&3 or similar) and have timers per that so even when an attacker goes and gets a lot of groups his speedup has a small bound\r\n\r\nI think probably we shouldn't be too afraid of slowing down propagation-- the changes to add delays at all were a massive slowdown and generated basically no notice.\r\n\r\nAlso related to this we might want to track the rate of novel transactions being accepted for a particular peer and up-delay really slow peers (like send every Nth time it would otherwise send).  The rational being that relay of novel transactions blinds tracking (since we won't relay something a peer gave to us back to them) and also lazy tracking stuff tends not to relay anything.   Delaying tx relay to a peer that never sends anything would hardly hurt propagation in the network, but at least might force attackers to be a bit more useful.\r\n",
      "created_at" : "2018-05-21T19:19:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#issuecomment-390754861",
      "id" : 390754861,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13298",
      "updated_at" : "2018-05-21T19:35:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/390754861",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r189687756"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/189687756"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think for IPv6 this could be a slightly far-fetched memory exhaustion DOS.",
      "commit_id" : "8060fbb58e9b28c0f906ab7915a4817cc60f2ca5",
      "created_at" : "2018-05-21T19:21:21Z",
      "diff_hunk" : "@@ -2864,8 +2864,24 @@ bool CConnman::ForNode(NodeId id, std::function<bool(CNode* pnode)> func)\n     return found != nullptr && NodeFullyConnected(found) && func(found);\n }\n \n-int64_t PoissonNextSend(int64_t nNow, int average_interval_seconds) {\n-    return nNow + (int64_t)(log1p(GetRand(1ULL << 48) * -0.0000000000000035527136788 /* -1/2^48 */) * average_interval_seconds * -1000000.0 + 0.5);\n+int64_t CConnman::PoissonNextSendTo(int64_t now, int average_interval_seconds, CNode* pto)\n+{\n+    assert(pto);\n+    uint64_t net_group = pto->nKeyedNetGroup;\n+    std::pair<int, uint64_t> key{average_interval_seconds, net_group};\n+    LOCK(cs_group_next_sends);\n+    std::map<std::pair<int, uint64_t>, int64_t>::iterator group_next_send = group_next_sends.find(key);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r189687756",
      "id" : 189687756,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4OTY4Nzc1Ng==",
      "original_commit_id" : "2b74996e379cd54dffea1004ed478d93f1a2b596",
      "original_position" : 12,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 121915848,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298",
      "updated_at" : "2018-07-05T19:43:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/189687756",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Maybe I'm missing something, but what would be the downside of having a single next send across all outbound peers if propagation latency isn't a huge issue? It seems like delay by net group is moving in that direction",
      "created_at" : "2018-05-21T20:13:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#issuecomment-390768509",
      "id" : 390768509,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13298",
      "updated_at" : "2018-05-21T20:13:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/390768509",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/195769?v=4",
         "events_url" : "https://api.github.com/users/skeees/events{/privacy}",
         "followers_url" : "https://api.github.com/users/skeees/followers",
         "following_url" : "https://api.github.com/users/skeees/following{/other_user}",
         "gists_url" : "https://api.github.com/users/skeees/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/skeees",
         "id" : 195769,
         "login" : "skeees",
         "organizations_url" : "https://api.github.com/users/skeees/orgs",
         "received_events_url" : "https://api.github.com/users/skeees/received_events",
         "repos_url" : "https://api.github.com/users/skeees/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/skeees/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/skeees/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/skeees"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "We assume that outgoing connections are less likely to be (significantly) under attacker control, due to them being self-selected, and addrman having built-in precautions against eclipse attacks (cc @EthanHeilman). Giving different peers a synchronized timer results increases bandwidth spikes, which isn't so much a concern for tx propagation, but may interfere with block propagation if they coincide. For outgoing peers (max 16) this is not that much of a concern, but then again, due to the previous point, synchronizing things is also less useful there.\r\n\r\nRegarding @gmaxwell's point of memory exhaustion, we could introduce a per-group reference counter, and delete the corresponding map entries when no peers in that group remain?",
      "created_at" : "2018-05-21T20:37:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#issuecomment-390774816",
      "id" : 390774816,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13298",
      "updated_at" : "2018-05-21T20:37:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/390774816",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r189709300"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/189709300"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`const CNode*`, alternatively pass the net_group",
      "commit_id" : "8060fbb58e9b28c0f906ab7915a4817cc60f2ca5",
      "created_at" : "2018-05-21T20:47:59Z",
      "diff_hunk" : "@@ -310,6 +310,10 @@ class CConnman\n     unsigned int GetReceiveFloodSize() const;\n \n     void WakeMessageHandler();\n+\n+    /** Attempts to obfuscate tx time through exponentially distributed emitting. */\n+    int64_t PoissonNextSendTo(int64_t now, int average_interval_seconds, CNode* pto);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r189709300",
      "id" : 189709300,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4OTcwOTMwMA==",
      "original_commit_id" : "2b74996e379cd54dffea1004ed478d93f1a2b596",
      "original_position" : 6,
      "path" : "src/net.h",
      "position" : null,
      "pull_request_review_id" : 121941898,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298",
      "updated_at" : "2018-07-05T19:43:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/189709300",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r189709307"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/189709307"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: `include <map>`",
      "commit_id" : "8060fbb58e9b28c0f906ab7915a4817cc60f2ca5",
      "created_at" : "2018-05-21T20:48:00Z",
      "diff_hunk" : "@@ -434,6 +438,9 @@ class CConnman\n      *  This takes the place of a feeler connection */\n     std::atomic_bool m_try_another_outbound_peer;\n \n+    std::map<std::pair<int, uint64_t>, int64_t> group_next_sends GUARDED_BY(cs_group_next_sends);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r189709307",
      "id" : 189709307,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4OTcwOTMwNw==",
      "original_commit_id" : "2b74996e379cd54dffea1004ed478d93f1a2b596",
      "original_position" : 15,
      "path" : "src/net.h",
      "position" : null,
      "pull_request_review_id" : 121941906,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298",
      "updated_at" : "2018-07-05T19:43:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/189709307",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@gmaxwell thanks for the feedback.\r\n\r\nI like the idea of turning it into a small number of buckets.\r\nI think that 8 buckets may be fine considering current load (should not cause significant spikes in bandwidth).\r\n\r\nPlease let me know if you see a better estimation for a reasonable number of buckets.",
      "created_at" : "2018-05-21T20:57:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#issuecomment-390780413",
      "id" : 390780413,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13298",
      "updated_at" : "2018-05-21T20:57:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/390780413",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@skeees Putting all in one will result in more spiky bandwidth usage (e.g. you hit your queue then use a bunch of bandwidth transmitting to everyone at once),  and I _believe_ but lack a rigorous analysis that we get more privacy for a given amount of average delay if the transactions diffuse randomly in the network to hide where they originated from, at least if we assume the target doesn't send many transactions (and that an attacker isn't abusing multiple groups to get a faster effective send.)\r\n\r\nE.g. imagine a user who originates from node X and an attacker that connects to almost all nodes in the network.  If all sends happen at once, when the attacker sees a transaction happen from X first then he can have some confidence that transactions happened from there.   If the send times are independent and the attacker sees a transaction from X first he doesn't learn that much from that transaction.\r\n\r\nThe issue becomes if the attacker connects to you 20 times and the times are independent than he gets effectively a 20th of the delay.  Which is why I was suggesting leaving outbounds independent and putting all inbounds into a single group or a small number of groups. ",
      "created_at" : "2018-05-21T21:38:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#issuecomment-390790891",
      "id" : 390790891,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13298",
      "updated_at" : "2018-05-21T21:38:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/390790891",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r189733029"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/189733029"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think it's suboptimal to put knowledge of the actual scheduling policy in net; it belongs more in net_processing (the `INVENTORY_BROADCAST_INTERVAL` and `NETWORK_GROUP_BUCKETS` should move there as well, I think).\r\n\r\nHow about passing a boolean `per_group` in, or saying that when `net_group = 0` there is no grouping to be done? Then you can keep the decision logic in net_processing, and keep this function generally usable.",
      "commit_id" : "8060fbb58e9b28c0f906ab7915a4817cc60f2ca5",
      "created_at" : "2018-05-21T22:37:27Z",
      "diff_hunk" : "@@ -2864,13 +2865,16 @@ bool CConnman::ForNode(NodeId id, std::function<bool(CNode* pnode)> func)\n     return found != nullptr && NodeFullyConnected(found) && func(found);\n }\n \n-int64_t CConnman::PoissonNextSendTo(int64_t now, int average_interval_seconds, uint64_t net_group)\n+int64_t CConnman::PoissonNextSendTo(int64_t now, bool inbound, uint64_t net_group)\n {\n-    std::pair<int, uint64_t> key{average_interval_seconds, net_group};\n+    if (!inbound) {\n+      return PoissonNextSend(now, INVENTORY_BROADCAST_INTERVAL >> 1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r189733029",
      "id" : 189733029,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4OTczMzAyOQ==",
      "original_commit_id" : "bd666a9789305ac951577c99371311c37ee09bcf",
      "original_position" : 17,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 121969690,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298",
      "updated_at" : "2018-07-05T19:43:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/189733029",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r189743568"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/189743568"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think this needs to be inverted.",
      "commit_id" : "8060fbb58e9b28c0f906ab7915a4817cc60f2ca5",
      "created_at" : "2018-05-21T23:45:15Z",
      "diff_hunk" : "@@ -3474,7 +3474,11 @@ bool PeerLogicValidation::SendMessages(CNode* pto, std::atomic<bool>& interruptM\n             if (pto->nNextInvSend < nNow) {\n                 fSendTrickle = true;\n                 // Use half the delay for outbound peers, as there is less privacy concern for them.\n-                pto->nNextInvSend = PoissonNextSend(nNow, INVENTORY_BROADCAST_INTERVAL >> !pto->fInbound);\n+                if (pto->fInbound) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r189743568",
      "id" : 189743568,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4OTc0MzU2OA==",
      "original_commit_id" : "f890492b4cbcf8f24f78cf29d1c09f8befec2e7b",
      "original_position" : 5,
      "path" : "src/net_processing.cpp",
      "position" : 5,
      "pull_request_review_id" : 121981803,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298",
      "updated_at" : "2018-07-05T19:43:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/189743568",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r189743885"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/189743885"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Without the interval size in the map, the correctness of this function depends on there only being a single interval (which is the case now, so no problem). It would be good to document that in the net.h definition, or change it.",
      "commit_id" : "8060fbb58e9b28c0f906ab7915a4817cc60f2ca5",
      "created_at" : "2018-05-21T23:47:47Z",
      "diff_hunk" : "@@ -2864,8 +2864,21 @@ bool CConnman::ForNode(NodeId id, std::function<bool(CNode* pnode)> func)\n     return found != nullptr && NodeFullyConnected(found) && func(found);\n }\n \n-int64_t PoissonNextSend(int64_t nNow, int average_interval_seconds) {\n-    return nNow + (int64_t)(log1p(GetRand(1ULL << 48) * -0.0000000000000035527136788 /* -1/2^48 */) * average_interval_seconds * -1000000.0 + 0.5);\n+int64_t CConnman::PoissonNextSendTo(int64_t now, int average_interval_seconds, uint64_t net_group_bucket)\n+{\n+    LOCK(cs_net_bucket_next_sends);\n+    std::map<uint64_t, int64_t>::iterator net_bucket_next_send = net_bucket_next_sends.find(net_group_bucket);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r189743885",
      "id" : 189743885,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4OTc0Mzg4NQ==",
      "original_commit_id" : "f890492b4cbcf8f24f78cf29d1c09f8befec2e7b",
      "original_position" : 9,
      "path" : "src/net.cpp",
      "position" : 9,
      "pull_request_review_id" : 121981803,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298",
      "updated_at" : "2018-07-05T19:43:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/189743885",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I've been looking at this paper \"Deanonymization in the Bitcoin P2P Network\" (https://papers.nips.cc/paper/6735-deanonymization-in-the-bitcoin-p2p-network.pdf).  It's got some ideas for how to think about an adversary's strategies with respect to detecting the first node on a network to relay a new transaction.\r\n\r\nIt seems to me there are a couple different kinds of adversaries to consider -- (a) one that makes only inbound connections to listening nodes on the network, versus (b) one that manages to take over some percentage of listening nodes and thus controls x% of the outbound connections on the network.  (And then these could be combined of course.)\r\n\r\nFor type (a) adversaries, there are multiple types of strategies that could be employed to deanonymize the first listening node to relay a transaction.  Perhaps the simplest strategy is the \"first spy\" estimator described in that paper, where the adversary estimates the first node to relay a transaction to it as the source.  Such a strategy seems to be very successful if the adversary connects to each node on the network multiple times, and this PR would mitigate that.  However, based on simulations I've done, I think 8 buckets is too many.  I don't have a sense for how easy it is for an adversary to actually connect from different network groups to achieve the 8 different timings -- so if we decide that is suitably hard, then maybe the point I'm raising is moot -- but if we assume that is achievable, then my simulations suggest a 40% success rate for a first-spy adversary.\r\n\r\nThe paper I mentioned above goes into some length discussing the success bounds of an attacker that is smarter than that and also uses knowledge of the network graph to estimate the source node.  I am still working through simulations that demonstrate the ideas they suggest, but I think I have a rough maximum-likelihood estimator that appears to be -- very roughly -- 15-20% successful at estimating the source node based on the times at which the adversary sees announcements from each node in the network.  This is assuming that the adversary has 1 inbound connection to each node on the network.\r\n\r\nIt seems to me that as a first pass, we might limit the number of buckets so that the effectiveness of a first-spy adversary is on par with that of a smarter adversary[1].  From my analysis so far, I think having 2 buckets for incoming peers would roughly achieve that, with the important caveats that (a) no one has sanity checked my sim results [2], and (b) I don't know yet how good the maximum-likelihood estimator could be if it were smart enough to use 2 connections to each peer.\r\n\r\nIf we weren't concerned about tradeoffs (ie bandwidth spikes or relay propagation delays), I'd say we could just make this all one bucket for inbound peers, to maximize source-privacy in our current transaction relay model.\r\n\r\n------\r\n[1] I think we could also go further and figure out some equilibrium with respect to an adversary controlling X% of the listening nodes/outbound connections on the network, but I'm not sure how to think about the relative costs of these kinds of adversarial approaches.\r\n\r\n[2] If anyone is able to do their own simulations or estimations to corroborate my observations that would be fantastic.",
      "created_at" : "2018-05-25T17:05:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#issuecomment-392121209",
      "id" : 392121209,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13298",
      "updated_at" : "2018-05-25T17:05:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/392121209",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@sdaftuar Do you think there would be reasons to increase the number of groups when there are more connections? Clearly for small numbers of connections the concern about bandwidth spikes doesn't exist, but if a node has 1000 connections, perhaps it does.",
      "created_at" : "2018-05-25T20:52:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#issuecomment-392184018",
      "id" : 392184018,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13298",
      "updated_at" : "2018-05-25T20:52:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/392184018",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@sdaftuar  The suggestion I was leaning towards making but couldn't justify strongly was to multiply the  interval for inbound peers by 2 and have 4 groups-- so that each of the 4 groups gets serviced 4x less often than a outbound peer .     This would make an inbound oriented attacker get as much information from their inbound attack as being a attacker on a single outbound connection. \r\n\r\nI would expect that 4 is still pretty bandwidth spike mitigating.\r\n\r\nWe also do want to have multiple groups so that we have a chance of 'routing around' a first spy monitor.  Though perhaps the outbounds are sufficient for that.\r\n\r\n> I don't have a sense for how easy it is for an adversary to actually connect from different network groups to achieve the 8 different timings \r\n\r\nTrivial, because our \"network groups\" are just /16s you can achieve the 8 groups just with a single EC2 account, picking different datacenters.   Even if we got a bit smarter and put in some prefixes of major VPS providers to be treated as a single group (or one per provider), it's still not terrible hard to get on lots of networks... there are even commercial services that give you addresses in as many /8s as possible for the purpose of jamming the bittorrent DHT stuff for 'anti-piracy' reasons.\r\n\r\nWe should generally assume that network group limitations are a pretty modest roadbump. They're cheap to implement, so \"why not\".... but they don't to much.\r\n\r\n>  also uses knowledge of the network graph to estimate the source node.\r\n\r\nThus future efforts on topology rotation, ... though there are tradeoffs there too. :(\r\n\r\n@sipa \r\n> Do you think there would be reasons to increase the number of groups when there are more connections? \r\n\r\nWell the attacker decides to connect to you, so naively doing that would be foolish since he could just get more information that way.   Another way of looking at it is if you have 1000 connections presumably you have a lot more bandwidth and don't mind the spikes that much.  If you don't like the spikes run fewer connections.\r\n\r\n",
      "created_at" : "2018-05-25T21:32:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#issuecomment-392192843",
      "id" : 392192843,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13298",
      "updated_at" : "2018-05-25T21:32:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/392192843",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Well the attacker decides to connect to you, so naively doing that would be foolish since he could just get more information that way.\r\n\r\nUh, of course. Ignore my suggestion.\r\n\r\n> The suggestion I was leaning towards making but couldn't justify strongly was to multiply the interval for inbound peers by 2 and have 4 groups-- so that each of the 4 groups gets serviced 4x less often than a outbound peer .\r\n\r\nThat seems reasonable, but some simulations - for example on the effect on network wide propagation speed would be useful.",
      "created_at" : "2018-05-28T01:46:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#issuecomment-392397988",
      "id" : 392397988,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13298",
      "updated_at" : "2018-05-28T01:46:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/392397988",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r192597487"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/192597487"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I believe these can all go in `net_processing.cpp` instead of the header file.",
      "commit_id" : "8060fbb58e9b28c0f906ab7915a4817cc60f2ca5",
      "created_at" : "2018-06-03T17:49:03Z",
      "diff_hunk" : "@@ -35,6 +35,23 @@ static constexpr int64_t EXTRA_PEER_CHECK_INTERVAL = 45;\n /** Minimum time an outbound-peer-eviction candidate must be connected for, in order to evict, in seconds */\n static constexpr int64_t MINIMUM_CONNECT_TIME = 30;\n \n+/** Average delay between local address broadcasts in seconds. */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r192597487",
      "id" : 192597487,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5MjU5NzQ4Nw==",
      "original_commit_id" : "c49fa62a8a3e85b1ee5d1cd631960e0d49e92775",
      "original_position" : 4,
      "path" : "src/net_processing.h",
      "position" : null,
      "pull_request_review_id" : 125403230,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298",
      "updated_at" : "2018-07-05T19:43:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/192597487",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "node_id" : "MDQ6VXNlcjg4MTI1Mw==",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r192597834"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/192597834"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Since that is the case, maybe `average_interval_seconds` should be removed as a parameter and just use the `INVENTORY_BROADCAST_INTERVAL` constant directly.",
      "commit_id" : "8060fbb58e9b28c0f906ab7915a4817cc60f2ca5",
      "created_at" : "2018-06-03T18:03:08Z",
      "diff_hunk" : "@@ -2864,8 +2864,21 @@ bool CConnman::ForNode(NodeId id, std::function<bool(CNode* pnode)> func)\n     return found != nullptr && NodeFullyConnected(found) && func(found);\n }\n \n-int64_t PoissonNextSend(int64_t nNow, int average_interval_seconds) {\n-    return nNow + (int64_t)(log1p(GetRand(1ULL << 48) * -0.0000000000000035527136788 /* -1/2^48 */) * average_interval_seconds * -1000000.0 + 0.5);\n+int64_t CConnman::PoissonNextSendTo(int64_t now, int average_interval_seconds, uint64_t net_group_bucket)\n+{\n+    LOCK(cs_net_bucket_next_sends);\n+    std::map<uint64_t, int64_t>::iterator net_bucket_next_send = net_bucket_next_sends.find(net_group_bucket);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r192597834",
      "id" : 192597834,
      "in_reply_to_id" : 189743885,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5MjU5NzgzNA==",
      "original_commit_id" : "f890492b4cbcf8f24f78cf29d1c09f8befec2e7b",
      "original_position" : 9,
      "path" : "src/net.cpp",
      "position" : 9,
      "pull_request_review_id" : 125403230,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298",
      "updated_at" : "2018-07-05T19:43:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/192597834",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "node_id" : "MDQ6VXNlcjg4MTI1Mw==",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r192597938"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/192597938"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "For the sake of encapsulation, I think you can put more of this logic into `int64_t CConnman::PoissonNextSendTo(int64_t now, CNode* node)`, including the check on `fInbound` and the half delay comment.",
      "commit_id" : "8060fbb58e9b28c0f906ab7915a4817cc60f2ca5",
      "created_at" : "2018-06-03T18:08:04Z",
      "diff_hunk" : "@@ -3474,7 +3474,11 @@ bool PeerLogicValidation::SendMessages(CNode* pto, std::atomic<bool>& interruptM\n             if (pto->nNextInvSend < nNow) {\n                 fSendTrickle = true;\n                 // Use half the delay for outbound peers, as there is less privacy concern for them.\n-                pto->nNextInvSend = PoissonNextSend(nNow, INVENTORY_BROADCAST_INTERVAL >> !pto->fInbound);\n+                if (pto->fInbound) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r192597938",
      "id" : 192597938,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5MjU5NzkzOA==",
      "original_commit_id" : "c49fa62a8a3e85b1ee5d1cd631960e0d49e92775",
      "original_position" : 5,
      "path" : "src/net_processing.cpp",
      "position" : 5,
      "pull_request_review_id" : 125403230,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298",
      "updated_at" : "2018-07-05T19:43:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/192597938",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "node_id" : "MDQ6VXNlcjg4MTI1Mw==",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I've been doing some more simulations on this recently.  I still don't have good results for the graph-aware estimators that (in theory) should be pretty powerful.  But I did want to share a couple other results on the first spy estimator:\r\n\r\nFirst my previously reported simulations were more optimistic than I realized, because I was just modeling the effect of limiting the number of connections an adversary could make, without taking into account the delay in propagation across the network that occurs when we bin the inbound peers.  So for instance I previously modeled how well an attacker would do if we limited them to 8 connections per peer, without also modeling the effect on the network due to ALL inbound peers being in those buckets as well.\r\n\r\nSlowing down transaction relay across the network benefits the first-spy estimator (as it increases their window of success).  So I fixed that deficiency in my latest simulation, and I observed that bucketing the inbound peers to 8 buckets -- and assuming that the adversary is in all 8 buckets for all nodes on the network -- appears to give a success rate to the attacker of ~54% (!).\r\n\r\nI did my simulations on randomly generated graphs on 5000 nodes, where each node randomly picked 8 outbound peers.  I assume the adversary is connected in every available inbound bucket.  This uses the existing relay delays we have for inbound peers (2x the mean delay of our outbound peers).  For each row in the table, I ran 2000 simulations.\r\n\r\n| Number of inbound buckets  | Success rate |\r\n| ------------- | ------------- |\r\n| 1  | 19%  |\r\n| 2  | 26%  |\r\n| 3 | 34% |\r\n| 4 | 41% |\r\n| 5 | 46% |\r\n| 6 | 50% |\r\n| 7 | 53% |\r\n| 8 | 54% |\r\n\r\nI also simulated @gmaxwell's suggested strategy, of using 4 inbound buckets, but applying a bigger (4x instead of 2x) delay to inbound peers.  That had a first-spy estimator success rate of 28%.\r\n\r\nI'll update these results with some statistics about total propagation times soon...",
      "created_at" : "2018-06-06T02:20:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#issuecomment-394918763",
      "id" : 394918763,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13298",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NDkxODc2Mw==",
      "updated_at" : "2018-06-06T02:20:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/394918763",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I've run a simulation to figure out how accurate might be a simple first-time spy under different conditions.\r\n\r\nI've used a network of 1000 nodes only (random graphs, 8 outgoing connections), so you can consider the results as upper bound comparing to the real Bitcoin network. (cause more nodes will introduce noise)\r\n500 simulations.\r\n\r\nI've considered an attacker that connects to all of the nodes multiple times so that it takes over all of the inbound buckets.\r\n\r\nR = inbound_connection_interval/outbound_connection_inverval\r\n\r\nR = 2\r\n\r\n| Number of inbound buckets | Success rate |\r\n| ------ | ------ |\r\n| 1 | 13%\r\n| 2 | 26%\r\n| 4 | 50%\r\n| 8 | 63%\r\n\r\nR = 4\r\n\r\n| Number of inbound buckets | Success rate |\r\n| ------ | ------ |\r\n| 1 | 13%\r\n| 2 | 21%\r\n| 4 | 41%\r\n| 8 | 56%\r\n\r\nFrom these numbers, 2 buckets and R=4 seems optimal.\r\n\r\nBoth of mine and @sdaftuar simulations demonstrate that increasing R is useful.\r\nHowever, this makes the assumption about outgoing connections more crucial.\r\n\r\nI'm going to run more simulations soon.",
      "created_at" : "2018-06-07T18:13:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#issuecomment-395515242",
      "id" : 395515242,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13298",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NTUxNTI0Mg==",
      "updated_at" : "2018-06-21T21:47:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/395515242",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I've measured how R affects propagation delay. From my measurements, it looks like the difference is within 25-40% for R=2 comparing to R=4 (I think that's a lot, but probably acceptable for now), and the distribution of values (50% 75% 99% 100%) is similar for different number of buckets as well as different R. \r\n\r\nAnother point I've found is *number of buckets itself does not affect propagation delay much* at least for a reasonable number (up to 8, see prior data), which is surprising for me. It may be because of the size of my simulation (only 1000 nodes).\r\n\r\nAnyway, from my observations it seems like neither setting R=4 nor using a small number of buckets \r\naffect propagation time very dramatically.\r\n\r\n@sdaftuar may have more interesting results here.",
      "created_at" : "2018-06-14T01:21:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#issuecomment-397137042",
      "id" : 397137042,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13298",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NzEzNzA0Mg==",
      "updated_at" : "2018-06-21T21:45:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/397137042",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I was also wondering *what if an attacker has control over 1 of 8 outgoing connections per each peer in the network*.\r\n\r\nIn this case, modifying R does not make any difference: success rate is 37-40% for 1 or 2 bucket scenario (worst case for a spy) for R=2, 4, 8. Success rate for R=8 grows a bit slower with number of buckets comparing  to R = 2, but not significantly (~5-10%).\r\n\r\nHaving less buckets helps in the same fashion as in the previous measurements, but 37% is very high as for the worst case for a spy.\r\n\r\nIf we consider that an attacker may *take control over 1 outgoing per some fraction of nodes*, then having less buckets still would be helpful to prevent first-spy.",
      "created_at" : "2018-06-14T17:36:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#issuecomment-397377622",
      "id" : 397377622,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13298",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NzM3NzYyMg==",
      "updated_at" : "2018-06-21T21:47:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/397377622",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Here are my results on spikes.\r\n\r\n### Meta\r\n\r\nThe graph represents the distribution of times when a random public-IP node in the network sends INVs to its peers.\r\n\r\nI used 1 tx/s for simulation (to get real bandwidth numbers below I believe we should multiply by 3 as this would be closer to the current tx rate, the bandwidth numbers presented in this message are already multiplied by 3), 5000 transactions for each run, the ratio of public IP nodes to private IP nodes in the network is 1 to 10 (which is kinda similar to the current one).\r\n\r\n### Analysis\r\n\r\n![Distributions](https://github.com/naumenkogs/Bitcoin-Simulator/blob/delays_per_net_group/distribution_measurements/distribution_graphs.jpeg?raw=true)\r\n\r\n\r\n\r\nI guess what is important is the tail of the distribution  the probability of huge number of transactions being relayed within one interval of 5 seconds.\r\nI won't say anything about buckets > 2, because my results show that anonymity properties are weak there. I'd say, once we have more nodes in the network and having connections to 100% of nodes will be harder to achieve, we may consider buckets > 2.\r\n\r\nif we choose 1 bucket, r=2 is better because it is less spikey and the success rate is the same. If we are OK with eventual spikes of 18 KB/s, we should do 1 bucket and r=2.\r\n\r\nIf we compare 2-bucket results, the distribution is slightly better for r=2, while anonymity is better for r=4 (5% better). I think r=4 is better here. The eventual spikes here are 14 KB/s.\r\nObviously, r=3 would be something in the middle, I may do additional runs for that scenario, I'm not adding it here to avoid confusion.\r\n\r\nPlease share your thoughts.\r\n\r\nUpd:\r\nRaw data and more graphs (buckets > 2) are available [here](https://github.com/naumenkogs/Bitcoin-Simulator/tree/delays_per_net_group/distribution_measurements).\r\n",
      "created_at" : "2018-07-03T19:36:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#issuecomment-402269863",
      "id" : 402269863,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13298",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwMjI2OTg2Mw==",
      "updated_at" : "2018-07-03T19:57:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/402269863",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r200472200"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/200472200"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@jimpo Does this comment still apply? `CConnman::PoissonNextSendTo` doesn't take a `CNode*` argument anymore, and I think it's better separation to keep the logic for determining the interval separate from the logic for computing the next send.",
      "commit_id" : "8060fbb58e9b28c0f906ab7915a4817cc60f2ca5",
      "created_at" : "2018-07-05T19:57:16Z",
      "diff_hunk" : "@@ -3474,7 +3474,11 @@ bool PeerLogicValidation::SendMessages(CNode* pto, std::atomic<bool>& interruptM\n             if (pto->nNextInvSend < nNow) {\n                 fSendTrickle = true;\n                 // Use half the delay for outbound peers, as there is less privacy concern for them.\n-                pto->nNextInvSend = PoissonNextSend(nNow, INVENTORY_BROADCAST_INTERVAL >> !pto->fInbound);\n+                if (pto->fInbound) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r200472200",
      "id" : 200472200,
      "in_reply_to_id" : 192597938,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMDQ3MjIwMA==",
      "original_commit_id" : "c49fa62a8a3e85b1ee5d1cd631960e0d49e92775",
      "original_position" : 5,
      "path" : "src/net_processing.cpp",
      "position" : 5,
      "pull_request_review_id" : 134796930,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298",
      "updated_at" : "2018-07-05T19:57:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/200472200",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r200492629"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/200492629"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "@naumenkogs This has not been addressed.",
      "commit_id" : "8060fbb58e9b28c0f906ab7915a4817cc60f2ca5",
      "created_at" : "2018-07-05T21:17:55Z",
      "diff_hunk" : "@@ -35,6 +35,23 @@ static constexpr int64_t EXTRA_PEER_CHECK_INTERVAL = 45;\n /** Minimum time an outbound-peer-eviction candidate must be connected for, in order to evict, in seconds */\n static constexpr int64_t MINIMUM_CONNECT_TIME = 30;\n \n+/** Average delay between local address broadcasts in seconds. */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r200492629",
      "id" : 200492629,
      "in_reply_to_id" : 192597487,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMDQ5MjYyOQ==",
      "original_commit_id" : "c49fa62a8a3e85b1ee5d1cd631960e0d49e92775",
      "original_position" : 4,
      "path" : "src/net_processing.h",
      "position" : null,
      "pull_request_review_id" : 134821598,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298",
      "updated_at" : "2018-07-05T21:17:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/200492629",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "node_id" : "MDQ6VXNlcjg4MTI1Mw==",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r200494066"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/200494066"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I'd still prefer a separate method for these four lines `CConnman::PoissonNextSendTo(int64_t now, CNode* node)`. Certainly having the separate `PoissonNextSend` which actually computes the interval is a good idea (which already exists), but `CConnman::PoissonNextSendTo` as defined currently just does the interval caching by netgroup. I find the interface weird and I don't understand the split between logic there and here.\r\n\r\nThat said, it's a pretty minor point and I don't feel too strongly.",
      "commit_id" : "8060fbb58e9b28c0f906ab7915a4817cc60f2ca5",
      "created_at" : "2018-07-05T21:24:18Z",
      "diff_hunk" : "@@ -3474,7 +3474,11 @@ bool PeerLogicValidation::SendMessages(CNode* pto, std::atomic<bool>& interruptM\n             if (pto->nNextInvSend < nNow) {\n                 fSendTrickle = true;\n                 // Use half the delay for outbound peers, as there is less privacy concern for them.\n-                pto->nNextInvSend = PoissonNextSend(nNow, INVENTORY_BROADCAST_INTERVAL >> !pto->fInbound);\n+                if (pto->fInbound) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13298#discussion_r200494066",
      "id" : 200494066,
      "in_reply_to_id" : 192597938,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMDQ5NDA2Ng==",
      "original_commit_id" : "c49fa62a8a3e85b1ee5d1cd631960e0d49e92775",
      "original_position" : 5,
      "path" : "src/net_processing.cpp",
      "position" : 5,
      "pull_request_review_id" : 134823293,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13298",
      "updated_at" : "2018-07-05T21:25:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/200494066",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "node_id" : "MDQ6VXNlcjg4MTI1Mw==",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   }
]
