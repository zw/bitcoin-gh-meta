[
   {
      "body" : "This was one of my gripes as well when nLockTime was started to be added by default. Note that there is some mitigation for this by randomizing the nLockTime in one of then cases:\r\n```c++\r\n    // Secondly occasionally randomly pick a nLockTime even further back, so\r\n    // that transactions that are delayed after signing for whatever reason,\r\n    // e.g. high-latency mix networks and some CoinJoin implementations, have\r\n    // better privacy.\r\n    if (GetRandInt(10) == 0)\r\n        txNew.nLockTime = std::max(0, (int)txNew.nLockTime - GetRandInt(100));\r\n```\r\nSo up-to-date nodes will occasionally send older locktimes as well.\r\n\r\nThere might be additional privacy improvements possible, of course.",
      "created_at" : "2017-03-17T09:08:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/10020#issuecomment-287302691",
      "id" : 287302691,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10020",
      "updated_at" : "2017-03-17T09:08:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/287302691",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Also affects hybrid full block SPV mode #9483 during IBD",
      "created_at" : "2017-03-22T22:55:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/10020#issuecomment-288564996",
      "id" : 288564996,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10020",
      "updated_at" : "2017-03-22T22:55:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/288564996",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/666706?v=3",
         "events_url" : "https://api.github.com/users/rat4/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rat4/followers",
         "following_url" : "https://api.github.com/users/rat4/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rat4/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rat4",
         "id" : 666706,
         "login" : "rat4",
         "organizations_url" : "https://api.github.com/users/rat4/orgs",
         "received_events_url" : "https://api.github.com/users/rat4/received_events",
         "repos_url" : "https://api.github.com/users/rat4/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rat4/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rat4/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rat4"
      }
   },
   {
      "body" : "I found a total of 33 old locktimes in the blockchain in 94 transactions, which indicate offline wallets which can potentially be fingerprinted using this technique.\r\n\r\nOne example is locktime 267128 which can be found in 7 transactions including these two:\r\n37077fdf90be0db661deacd4e2ebf0b786e820782757bd1f18e25159840b9e8d\r\ncf6ba6f7896426e6c2137118482b2e09a55bae1384e565dc40685e75014fa527\r\n\r\nMy output is here: https://www.jamesevans.is/locktime.txt\r\nThe first column contains the locktime and the subsequent columns are the differences between that locktime and the block each transaction was mined into. Adding the first column with the other columns will yield the block containing the transaction. My main goal was to get a feel for the scope of this issue, so although this work can be easily replicated, I haven't included further analysis due to privacy concerns.",
      "created_at" : "2017-06-27T12:10:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/10020#issuecomment-311339203",
      "id" : 311339203,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10020",
      "updated_at" : "2017-06-27T12:10:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/311339203",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2402779?v=3",
         "events_url" : "https://api.github.com/users/keystrike/events{/privacy}",
         "followers_url" : "https://api.github.com/users/keystrike/followers",
         "following_url" : "https://api.github.com/users/keystrike/following{/other_user}",
         "gists_url" : "https://api.github.com/users/keystrike/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/keystrike",
         "id" : 2402779,
         "login" : "keystrike",
         "organizations_url" : "https://api.github.com/users/keystrike/orgs",
         "received_events_url" : "https://api.github.com/users/keystrike/received_events",
         "repos_url" : "https://api.github.com/users/keystrike/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/keystrike/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/keystrike/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/keystrike"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The current implementation of #10040 (984e7ae2fc6319fbd1071fa36efa416a8321d62b) purports to fix this issue, but I'm not sure if the `IsCurrentForAntiFeeSniping` function there would return false if the node is offiline.\r\n  ",
      "created_at" : "2018-01-09T21:22:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/10020#issuecomment-356418313",
      "id" : 356418313,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10020",
      "updated_at" : "2018-01-09T21:23:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356418313",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This has been fixed with #15039.",
      "created_at" : "2019-01-15T15:20:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/10020#issuecomment-454429761",
      "id" : 454429761,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10020",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1NDQyOTc2MQ==",
      "updated_at" : "2019-01-15T15:20:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/454429761",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/2402779?v=4",
         "events_url" : "https://api.github.com/users/keystrike/events{/privacy}",
         "followers_url" : "https://api.github.com/users/keystrike/followers",
         "following_url" : "https://api.github.com/users/keystrike/following{/other_user}",
         "gists_url" : "https://api.github.com/users/keystrike/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/keystrike",
         "id" : 2402779,
         "login" : "keystrike",
         "node_id" : "MDQ6VXNlcjI0MDI3Nzk=",
         "organizations_url" : "https://api.github.com/users/keystrike/orgs",
         "received_events_url" : "https://api.github.com/users/keystrike/received_events",
         "repos_url" : "https://api.github.com/users/keystrike/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/keystrike/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/keystrike/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/keystrike"
      }
   }
]
