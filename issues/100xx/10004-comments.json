[
   {
      "body" : "A few comments here:\r\n\r\n- your node is probably running with the default limitancestorcount / limitdescendant count, which prevents chains of >25 transactions entering your mempool. You can override those with command line arguments.\r\n- when you send the 26th transaction, it gets added your wallet, but is rejected by your mempool. You should see something like this in debug.log:\r\n\r\n```\r\n2017-03-15 21:41:07 AddToWallet 4c1473ae23f8c087116beb04ccb8cf1ee01226bb5a77db4cba1c5a44c8b52de6  new\r\n2017-03-15 21:41:07 CommitTransaction(): Transaction cannot be broadcast immediately, too-long-mempool-chain\r\n```\r\n\r\n- after you generate the next block, the transaction does not get resubmitted to your mempool automatically. You can find the transaction in your wallet using `gettransaction`, but `getrawtransaction` won't show it (because it's not in the mempool):\r\n\r\n```\r\n[ubuntu] /home/ubuntu/bitcoin\r\nÃ¢ÂÂ bitcoin-cli getrawtransaction 4c1473ae23f8c087116beb04ccb8cf1ee01226bb5a77db4cba1c5a44c8b52de6\r\nerror code: -5\r\nerror message:\r\nNo such mempool or blockchain transaction. Use gettransaction for wallet transactions.\r\n[ubuntu] /home/ubuntu/bitcoin\r\nÃ¢ÂÂ bitcoin-cli gettransaction 4c1473ae23f8c087116beb04ccb8cf1ee01226bb5a77db4cba1c5a44c8b52de6\r\n{\r\n  \"amount\": -0.50000000,\r\n ...\r\n \"hex\": \"02000000015415b85a301a420bac34ec12d3786e1b9d8608c29c9a083306da5e0a0a065286010000006b483045022100ca16a86854d1c51c975bf3e55386bb9ca9929c252524eb1118cfb27121e4d97902206d6acedf4596b9edaea93f411474d39746cc3d5348c9de9f43d9c9c937310de5012103880da4e6b6451859b1eed794b76    7a2e5f2a8e7898aa4cc7a83f2aad8165faa13feffffff02a88e0492000000001976a9149e2f8afc219f0db384ce131d7c028753ac350a4a88ac80f0fa020000000017a914d396f368f3b4348ced0ed1f4138bb2906e12f7df8765000000\"\r\n}\r\n```\r\n- at this point, you *could* resubmit the transaction to your mempool by running `sendrawtransaction <txhash>`\r\n- persistent mempool has nothing to do with the transaction being readded after stop-start (since the transaction never made it into the mempool in the first place). The transaction is actually in your wallet file, so when you stop-start, that's where it's being found. You can prove this to yourself by deleting mempool.dat between stopping and starting.\r\n\r\nI think that the correct behaviour here is that the wallet should reject the transaction if it's in a chain that's too long to get accepted by the node's mempool.\r\n",
      "created_at" : "2017-03-15T21:56:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/10004#issuecomment-286892237",
      "id" : 286892237,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10004",
      "updated_at" : "2017-03-15T21:56:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/286892237",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1063656?v=3",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "Ahhh thank you for the explanation! This makes sense. Yeah I suppose the expected behavior for me would be if `sendtoaddress` failed with a \"chain too long\" error before creating that last tx, leaving one last unspent output available for a retry or wait for confirmation... ",
      "created_at" : "2017-03-15T22:23:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/10004#issuecomment-286898585",
      "id" : 286898585,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10004",
      "updated_at" : "2017-03-15T22:23:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/286898585",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/2084648?v=3",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   }
]
