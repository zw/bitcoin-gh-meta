[
   {
      "body" : "I certainly like stuff like this over the forking...\r\n\r\nWhat is the usecase for the IP addresses?  \r\n\r\nThis removes the fIsInitialDownload test around the forking blocknotifyÃ¢ÂÂ that test is incorrect to begin with (it can make you miss reorgs if the blocks have particular weird times), but without it blocknotify is a forkbomb. :)",
      "created_at" : "2013-03-27T22:15:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-15556682",
      "id" : 15556682,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-03-27T22:15:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/15556682",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "The IP address is just to tell when the Bitcoin client has gotten a new IP address from the network.\r\n\r\nI moved the test for 'fIsInitialDownload' so it only evaluates once.(two times in the master code at the moment if you take a look).\r\n\r\n\r\nHmm. There will be scenarios were you would like to have the blocks announced during 'fIsInitialDownload' and when you don't. Will make an parameter for that.\r\n ",
      "created_at" : "2013-03-27T22:30:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-15557336",
      "id" : 15557336,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-03-27T22:30:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/15557336",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1326048?v=3",
         "events_url" : "https://api.github.com/users/fredan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fredan/followers",
         "following_url" : "https://api.github.com/users/fredan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fredan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fredan",
         "id" : 1326048,
         "login" : "fredan",
         "organizations_url" : "https://api.github.com/users/fredan/orgs",
         "received_events_url" : "https://api.github.com/users/fredan/received_events",
         "repos_url" : "https://api.github.com/users/fredan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fredan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fredan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fredan"
      }
   },
   {
      "body" : "Ah, missed that curly removal.\r\n\r\nIn any case that doesn't change the point that IsInitial is not a reliable test, go look at how it's implemented.  The way that it's setup thereÃ¢ÂÂ in theoryÃ¢ÂÂ a miner could construct a reorg that doesn't trigger the notice. This might be bad if you're depending on being told about the reorg in order to abort shipping a good or whatever.\r\n",
      "created_at" : "2013-03-27T22:34:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-15557563",
      "id" : 15557563,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-03-27T22:34:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/15557563",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "+1 for 0mq support in general.  Reading now...",
      "created_at" : "2013-03-27T23:44:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-15560172",
      "id" : 15560172,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-03-27T23:44:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/15560172",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "I like this. Delivering events over 0mq for block/transaction/etc\nnotifications is much more elegant and efficient than launching commands.",
      "created_at" : "2013-03-28T10:45:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-15580166",
      "id" : 15580166,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-03-28T10:45:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/15580166",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Note that 0mq is LGPL, which is a bit more restrictive than the MIT/BSD license that bitcoin-qt is currently licensed under. Specifically LGPL requires you to distribute binaries that can be relinked if the user decides to change the source of the LGPL library. Not an issue with dynamic linking, but static linking is problematic. Other than some graphics assets - see assets-attribution.txt - this would be a new requirement for bitcoin-qt.\r\n\r\nHaving said that, personally I'm happy to ACK the change; users should not be using a copy of bitcoin-qt if the source code isn't available to them.",
      "created_at" : "2013-03-28T12:27:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-15585826",
      "id" : 15585826,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-03-28T12:27:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/15585826",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "Nice!\r\nCan you put the trivial python client in contrib/0mq/ ?\r\n\r\nAlso:\r\n0mq is available in MacPorts, does version matter?\r\nzmq                            @3.2.2          devel/zmq\r\nzmq20                          @2.0.11         devel/zmq20\r\nzmq22                          @2.2.0          devel/zmq22\r\n",
      "created_at" : "2013-03-28T14:50:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-15592572",
      "id" : 15592572,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-03-28T14:59:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/15592572",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "@petertodd  I was aware of the licensingÃ¢ÂÂ I don't think it's problematic.  We have LGPL (QT) and advertising-clause BSD (OpenSSL) in parts of the system which are more essential... ZeroMQ can at least just be left out by someone practicing extreme licensing confusion.  GMP for modular inversion will be a bigger question in the future.",
      "created_at" : "2013-03-28T16:16:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-15597704",
      "id" : 15597704,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-03-28T16:17:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/15597704",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "@gavinandresen \r\n\r\nYes, the version does matter.  Use the version 3.2.2 (which is the latest stable one). \r\n\r\nQuote from 0mq:  \"We recommend this release to anyone developing new applications with ÃÂMQ\"\r\n\r\nI will include example client(s) under contrib/0mq in later commitments. \r\n",
      "created_at" : "2013-03-28T16:28:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-15598501",
      "id" : 15598501,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-03-28T16:28:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/15598501",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1326048?v=3",
         "events_url" : "https://api.github.com/users/fredan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fredan/followers",
         "following_url" : "https://api.github.com/users/fredan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fredan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fredan",
         "id" : 1326048,
         "login" : "fredan",
         "organizations_url" : "https://api.github.com/users/fredan/orgs",
         "received_events_url" : "https://api.github.com/users/fredan/received_events",
         "repos_url" : "https://api.github.com/users/fredan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fredan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fredan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fredan"
      }
   },
   {
      "body" : "@gmaxwell Yup, it's a niche case for it to actually matter, but we should document it clearly for the lawyers; might as well put the info about our dependencies and associated license obligations in assets-attribution.txt or a similar file. (yes, I'm volunteering to write that up)",
      "created_at" : "2013-03-28T16:29:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-15598559",
      "id" : 15598559,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-03-28T16:41:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/15598559",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/7c05592af68dd7d1ec9219c1afe76207797f3214 for binaries and test log.\nThis is an automated test script which runs test cases on each commit every time is updated.\nIt, however, dies sometimes and fails to test properly, if you are waiting on a test, please check timestamps and if the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\nand contact BlueMatt on freenode if something looks broken.",
      "created_at" : "2013-03-30T10:37:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-15672530",
      "id" : 15672530,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-03-30T10:37:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/15672530",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "body" : "@ BitcoinPullTester\r\n\r\nYou need to build with make -f makefile.unix USE_ZMQ=1\r\n\r\nto actually know if this pull request builds or not. You do need to have libzmq installed before that.\r\n",
      "created_at" : "2013-03-30T16:34:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-15677339",
      "id" : 15677339,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-03-30T16:34:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/15677339",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1326048?v=3",
         "events_url" : "https://api.github.com/users/fredan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fredan/followers",
         "following_url" : "https://api.github.com/users/fredan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fredan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fredan",
         "id" : 1326048,
         "login" : "fredan",
         "organizations_url" : "https://api.github.com/users/fredan/orgs",
         "received_events_url" : "https://api.github.com/users/fredan/received_events",
         "repos_url" : "https://api.github.com/users/fredan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fredan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fredan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fredan"
      }
   },
   {
      "body" : "The idea is neat, but there doesn't seem to be much documentation on how to use it or what form the messages take. For instance you call the message \"new block\" but that's not correct is it, it's \"new best block\" - you won't see blocks that connect to a side chain and if a re-org happens (I think) you will only see the new top block and not the intervening blocks published on the queue. Or did I misunderstand the code?",
      "created_at" : "2013-04-01T15:54:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-15721285",
      "id" : 15721285,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-04-01T15:54:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/15721285",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/971089?v=3",
         "events_url" : "https://api.github.com/users/mikehearn/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mikehearn/followers",
         "following_url" : "https://api.github.com/users/mikehearn/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mikehearn/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mikehearn",
         "id" : 971089,
         "login" : "mikehearn",
         "organizations_url" : "https://api.github.com/users/mikehearn/orgs",
         "received_events_url" : "https://api.github.com/users/mikehearn/received_events",
         "repos_url" : "https://api.github.com/users/mikehearn/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mikehearn/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mikehearn/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mikehearn"
      }
   },
   {
      "body" : "@mikehearn\r\n\r\nWhat the publisher does is to send new messages when something happens in the bitcoin client. You don't have to ask if something has happened, you already know that.\r\n\r\nUnder 'contrib/0mq/bitcoin-zmq.py' is an example client of how the publisher part works and their filter defined.\r\n\r\nPlease run this and take a look of what the output is. (Hint: all json)\r\n\r\nTo your other questions that depends on where in the source code that happens. If it's in the main.cpp - SetBestChain, then yes if not, tell me where and I will add that as well.\r\n",
      "created_at" : "2013-04-01T16:20:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-15722511",
      "id" : 15722511,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-04-01T16:20:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/15722511",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1326048?v=3",
         "events_url" : "https://api.github.com/users/fredan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fredan/followers",
         "following_url" : "https://api.github.com/users/fredan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fredan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fredan",
         "id" : 1326048,
         "login" : "fredan",
         "organizations_url" : "https://api.github.com/users/fredan/orgs",
         "received_events_url" : "https://api.github.com/users/fredan/received_events",
         "repos_url" : "https://api.github.com/users/fredan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fredan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fredan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fredan"
      }
   },
   {
      "body" : "Needs rebase.",
      "created_at" : "2013-04-08T05:33:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-16033280",
      "id" : 16033280,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-04-08T05:33:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/16033280",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Don't get me wrong, new best block isn't a bad thing to notify on. New side blocks probably aren't that interesting for most users anyway. Just pointing out that the naming/docs could be updated.",
      "created_at" : "2013-04-08T08:42:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-16038833",
      "id" : 16038833,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-04-08T08:42:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/16038833",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/971089?v=3",
         "events_url" : "https://api.github.com/users/mikehearn/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mikehearn/followers",
         "following_url" : "https://api.github.com/users/mikehearn/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mikehearn/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mikehearn",
         "id" : 971089,
         "login" : "mikehearn",
         "organizations_url" : "https://api.github.com/users/mikehearn/orgs",
         "received_events_url" : "https://api.github.com/users/mikehearn/received_events",
         "repos_url" : "https://api.github.com/users/mikehearn/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mikehearn/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mikehearn/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mikehearn"
      }
   },
   {
      "body" : "This makes a LOT of usecases possible. I use an older fork of bitcoind, based on even older implementation by Gavin, exactly for this purpose - Have an automatic callback whenever a transaction and/or block is coming in (See my fork on github).\r\n\r\nOne suggestion:\r\nAdd an option to get the \"incoming transaction\" notification only when it is for the own wallet. I think this would be a frequent usecase, so the receiving end does not need to do boilerplate code, probably involving additional rpc calls, to find out if the tx is actually interesting.\r\n",
      "created_at" : "2013-04-12T20:44:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-16316589",
      "id" : 16316589,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-04-12T20:44:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/16316589",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/754478?v=3",
         "events_url" : "https://api.github.com/users/TripleSpeeder/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TripleSpeeder/followers",
         "following_url" : "https://api.github.com/users/TripleSpeeder/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TripleSpeeder/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TripleSpeeder",
         "id" : 754478,
         "login" : "TripleSpeeder",
         "organizations_url" : "https://api.github.com/users/TripleSpeeder/orgs",
         "received_events_url" : "https://api.github.com/users/TripleSpeeder/received_events",
         "repos_url" : "https://api.github.com/users/TripleSpeeder/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TripleSpeeder/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TripleSpeeder/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TripleSpeeder"
      }
   },
   {
      "body" : "Some comments after code review:\r\n- There is no authentication for requests over ZMQ, do I get this right?\r\n- When compiling with USE_ZMQ, enabling it should be an option, not be done by default. This allows builders of Linux distributions (for example) to build an executable with all options enabled, and leaves it up to the end user to enable it or not.",
      "created_at" : "2013-04-15T15:58:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-16393896",
      "id" : 16393896,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-04-15T15:58:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/16393896",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/2415#discussion_r3796459"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/2415"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/3796459"
         }
      },
      "body" : "Do you need this usleep? If zeromq has a way to block XXms waiting for a request, I'd prefer that. It would result in less latency when responding to requests and means the process doesn't have to wake up unnecessarily.",
      "commit_id" : "7c05592af68dd7d1ec9219c1afe76207797f3214",
      "created_at" : "2013-04-15T16:01:59Z",
      "diff_hunk" : "@@ -0,0 +1,352 @@\n+// Copyright (c) 2013 The Bitcoin developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <zmq.h>\n+\n+#include \"hash.h\"\n+#include \"bitcoinrpc.h\"\n+#include \"main.h\"\n+\n+#define BZMQ_BUFFER_SIZE 8388608\n+\n+static void *pBZmq_ctx = NULL;\n+static void *pBZmq_socket_pub = NULL;\n+static void *pBZmq_socket_rep = NULL;\n+std::string strBZmq_ID_TRANSACTION = \"cf954abb\";\n+std::string strBZmq_ID_BLOCK = \"ec747b90\";\n+std::string strBZmq_ID_IPADDRESS = \"a610612a\";\n+bool fBZmq_ThreadReqRep = false;\n+\n+extern void TxToJSON(const CTransaction& tx, const uint256 hashBlock, json_spirit::Object& entry);\n+extern json_spirit::Object blockToJSON(const CBlock& block, const CBlockIndex* blockindex);\n+extern std::string JSONRPCExecBatch(const json_spirit::Array&);\n+extern json_spirit::Object JSONRPCExecOne(const json_spirit::Value&);\n+\n+\n+void BZmq_InitCtx() {\n+    pBZmq_ctx = zmq_ctx_new();\n+}\n+\n+void BZmq_InitSockets() {\n+    pBZmq_socket_pub = zmq_socket(pBZmq_ctx, ZMQ_PUB);\n+    pBZmq_socket_rep = zmq_socket(pBZmq_ctx, ZMQ_REP);\n+}\n+\n+void BZmq_CtxSetOptions(std::string& strOpt) {\n+    std::string::size_type nNamePos = strOpt.find(\":\");\n+\n+    if (nNamePos != std::string::npos) \n+    {\n+        std::string strName = strOpt.substr(0, nNamePos);\n+        std::string strValue = strOpt.substr(nNamePos + 1);\n+        std::stringstream streamStringToInts(strValue);\n+        int nValue_int = 0;\n+        streamStringToInts >> nValue_int;\n+        int nRc = -2;\n+\n+        if (strName == \"ZMQ_IO_THREADS\")\n+            nRc = zmq_ctx_set(pBZmq_ctx, ZMQ_IO_THREADS, nValue_int);\n+        if (strName ==  \"ZMQ_MAX_SOCKETS\")\n+            nRc = zmq_ctx_set(pBZmq_ctx, ZMQ_MAX_SOCKETS, nValue_int);\n+\n+        if (nRc == -2)\n+                printf(\"ZMQ_CTX_SET: ERROR! %s does not exists as an strOption!\\n\", strName.c_str());\n+        else\n+            if (nRc < 0)\n+                printf(\"ZMQ_CTX_SET: %s value: %i returncode: %i errno: %i strerror: %s\\n\", strName.c_str(), nValue_int, nRc, errno, strerror(errno));\n+            else\n+                printf(\"ZMQ_CTX_SET: %s value: %i OK\\n\", strName.c_str(), nValue_int);\n+    }\n+}\n+\n+void BZmq_SetSocket(void *pSocket, const char *pszSocketName, std::string& strOpt) {\n+    std::string::size_type nNamePos = strOpt.find(\":\");\n+\n+    if (nNamePos != std::string::npos) \n+    {\n+        std::string strName = strOpt.substr(0, nNamePos);\n+        std::string strValue = strOpt.substr(nNamePos + 1);\n+        std::stringstream streamStringToInts(strValue);\n+        int nRc = -2;\n+        int nValue_int = 0; \n+        streamStringToInts >> nValue_int;\n+        uint64_t nValue_uint64_t = 0;\n+        streamStringToInts >> nValue_uint64_t;\n+        int64_t nValue_int64_t = 0;\n+        streamStringToInts >> nValue_int64_t;\n+\n+        if (strName == \"ZMQ_SNDHWM\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_SNDHWM, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_RCVHWM\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_RCVHWM, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_AFFINITY\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_AFFINITY, &nValue_uint64_t, sizeof(uint64_t));\n+\n+        if (strName == \"ZMQ_SUBSCRIBE\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_SUBSCRIBE, strValue.c_str(), strValue.length());\n+\n+        if (strName == \"ZMQ_UNSUBSCRIBE\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_UNSUBSCRIBE, strValue.c_str(), strValue.length());\n+\n+        if (strName == \"ZMQ_IDENTITY\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_IDENTITY, strValue.c_str(), strValue.length());\n+\n+        if (strName == \"ZMQ_RATE\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_RATE, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_RECOVERY_IVL\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_RECOVERY_IVL, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_SNDBUF\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_SNDBUF, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_RCVBUF\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_RCVBUF, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_LINGER\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_LINGER, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_RECONNECT_IVL\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_RECONNECT_IVL, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_RECONNECT_IVL_MAX\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_RECONNECT_IVL_MAX, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_BACKLOG\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_BACKLOG, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_MAXMSGSIZE\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_MAXMSGSIZE, &nValue_int64_t, sizeof(int64_t));\n+\n+        if (strName == \"ZMQ_MULTICAST_HOPS\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_MULTICAST_HOPS, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_RCVTIMEO\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_RCVTIMEO, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_SNDTIMEO\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_SNDTIMEO, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_IPV4ONLY\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_IPV4ONLY, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_DELAY_ATTACH_ON_CONNECT\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_DELAY_ATTACH_ON_CONNECT, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_ROUTER_MANDATORY\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_ROUTER_MANDATORY, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_XPUB_VERBOSE\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_XPUB_VERBOSE, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_TCP_KEEPALIVE\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_TCP_KEEPALIVE, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_TCP_KEEPALIVE_IDLE\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_TCP_KEEPALIVE_IDLE, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_TCP_KEEPALIVE_CNT\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_TCP_KEEPALIVE_CNT, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_TCP_KEEPALIVE_INTVL\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_TCP_KEEPALIVE_INTVL, &nValue_int, sizeof(int));\n+\n+        if (strName == \"ZMQ_TCP_ACCEPT_FILTER\")\n+            nRc = zmq_setsockopt (pSocket, ZMQ_TCP_ACCEPT_FILTER, strValue.c_str(), strValue.length());\n+\n+        if (nRc == -2)\n+                printf(\"ZMQ_%s_SETSOCKOPT: ERROR! %s does not exists as an strOption!\\n\", pszSocketName, strName.c_str());\n+        else\n+            if (nRc < 0)\n+                printf(\"ZMQ_%s_SETSOCKOPT: %s value: %s returncode: %i errno: %i strerror: %s\\n\", pszSocketName, strName.c_str(), strValue.c_str(), nRc, errno, strerror(errno));\n+            else\n+                printf(\"ZMQ_%s_SETSOCKOPT: %s value: %s OK (int: %i, int64_t:%li, uint64_t: %lu)\\n\", pszSocketName, strName.c_str(), strValue.c_str(), nValue_int, nValue_int64_t, nValue_uint64_t);\n+    }\n+}\n+\n+void BZmq_PubSetOptions(std::string& strOpt) {\n+    BZmq_SetSocket(pBZmq_socket_pub, \"PUB\", strOpt);\n+}\n+\n+void BZmq_PubBind(std::string& strBindAddr) {\n+    int nRc = zmq_bind(pBZmq_socket_pub, strBindAddr.c_str());\n+    printf(\"ZMQ_BIND Publisher binding to socket: %s \", strBindAddr.c_str());\n+    if (nRc < 0)\n+        printf(\"ERROR errno: %i strerror: %s\\n\", errno, strerror(errno));\n+    else\n+        printf(\"OK\\n\");\n+}\n+\n+void BZmq_PubConnect(std::string& strConnectAddr) {\n+    int nRc = zmq_connect(pBZmq_socket_pub, strConnectAddr.c_str());\n+    printf(\"ZMQ_CONNECT Publisher connecting to socket: %s\", strConnectAddr.c_str());\n+    if (nRc < 0)\n+        printf(\"ERROR errno: %i strerror: %s\\n\", errno, strerror(errno));\n+    else\n+        printf(\"OK\\n\");\n+}\n+\n+void BZmq_RepSetOptions(std::string& strOpt) {\n+    BZmq_SetSocket(pBZmq_socket_rep, \"REP\", strOpt);\n+}\n+\n+void BZmq_RepBind(std::string& strBindAddr) {\n+    int nRc = zmq_bind(pBZmq_socket_rep, strBindAddr.c_str());\n+    printf(\"ZMQ_BIND Replier binding to socket: %s \", strBindAddr.c_str());\n+    if (nRc < 0)\n+        printf(\"ERROR errno: %i strerror: %s\\n\", errno, strerror(errno));\n+    else\n+        printf(\"OK\\n\");\n+}\n+\n+void BZmq_RepConnect(std::string& strConnectAddr) {\n+    int nRc = zmq_connect(pBZmq_socket_rep, strConnectAddr.c_str());\n+    printf(\"ZMQ_CONNECT Replier connecting to socket: %s\", strConnectAddr.c_str());\n+    if (nRc < 0)\n+        printf(\"ERROR errno: %i strerror: %s\\n\", errno, strerror(errno));\n+    else\n+        printf(\"OK\\n\");\n+}\n+\n+void BZmq_Shutdown() {\n+    printf(\"BZmq_Shutdown() Begin\\n\");\n+\n+    while(fBZmq_ThreadReqRep)\n+        sleep(1);\n+\n+    if (pBZmq_socket_pub)\n+        zmq_close(pBZmq_socket_pub);\n+\n+    if (pBZmq_ctx)\n+        zmq_term(pBZmq_ctx);\n+\n+    printf(\"BZmq_Shutdown() End\\n\");\n+}\n+\n+void BZmq_Version() {\n+    int nZmq_version_major, nZmq_version_minor, nZmq_version_patch;\n+    zmq_version(&nZmq_version_major, &nZmq_version_minor, &nZmq_version_patch);\n+    printf(\"Using ZMQ version API: %i.%i.%i Runtime: %i.%i.%i\\n\", ZMQ_VERSION_MAJOR, ZMQ_VERSION_MINOR, ZMQ_VERSION_PATCH, nZmq_version_major, nZmq_version_minor, nZmq_version_patch);\n+}\n+\n+void BZmq_SendTX(CTransaction& tx) {\n+    json_spirit::Object result;\n+    TxToJSON(tx, 0, result);\n+\n+    std::string strTemp = strBZmq_ID_TRANSACTION + json_spirit::write_string(json_spirit::Value(result), false);\n+\n+    int nRc = zmq_send(pBZmq_socket_pub, strTemp.c_str(), strTemp.length(), ZMQ_DONTWAIT);\n+\n+    if (nRc < 0)\n+        printf(\"ZMQ ERROR in BZmq_SendTX() errno: %i strerror: %s\\n\", errno, strerror(errno));\n+}\n+\n+void BZmq_SendBlock(CBlockIndex* pblockindex) {\n+    CBlock block;\n+    block.ReadFromDisk(pblockindex);\n+\n+    json_spirit::Object result = blockToJSON(block, pblockindex);\n+    std::string strTemp = strBZmq_ID_BLOCK + json_spirit::write_string(json_spirit::Value(result), false);\n+\n+    int nRc = zmq_send(pBZmq_socket_pub, strTemp.c_str(), strTemp.length(), ZMQ_DONTWAIT);\n+\n+    if (nRc < 0)\n+        printf(\"ZMQ ERROR in BZmq_SendBlock() errno: %i strerror: %s\\n\", errno, strerror(errno));\n+}\n+\n+void BZmq_SendIPAddress(const char *pszIP) {\n+    std::string strIP = pszIP;\n+    std::string::size_type nPortPos = strIP.rfind(\":\");\n+    if (nPortPos != std::string::npos) \n+    {\n+        std::string strIPAddress = strIP.substr(0, nPortPos);\n+        std::string strTemp = strBZmq_ID_IPADDRESS;\n+        strTemp.append(\"{\\\"ip\\\":\\\"\");\n+        strTemp.append(strIPAddress);\n+        strTemp.append(\"\\\",\\\"port\\\":\");\n+        strTemp.append(strIP.substr(nPortPos + 1));\n+        strTemp.append(\"}\");\n+\n+        int nRc = zmq_send(pBZmq_socket_pub, strTemp.c_str(), strTemp.length(), ZMQ_DONTWAIT);\n+\n+        if (nRc < 0)\n+            printf(\"ZMQ ERROR in BZmq_SendIpAddress() errno: %i strerror: %s\\n\", errno, strerror(errno));\n+    }\n+}\n+\n+void BZmq_ThreadReqRep(void *pArg) {\n+/*\n+    This is the Reply socket thread to question which comes from a Request socket.\n+\n+    To make an long story sort:\n+    This thread is an an RPC Server - but for 0MQ.\n+\n+*/\n+    int nRc, nRc_recv;\n+    fBZmq_ThreadReqRep = true;\n+    RenameThread(\"bitcoin-zmqreqrep\");\n+\n+    zmq_pollitem_t BZmq_pollitems [] = {\n+        {pBZmq_socket_rep, 0, ZMQ_POLLIN, 0 }\n+    };\n+\n+    char *BZmq_buffer = (char *)malloc(BZMQ_BUFFER_SIZE);\n+    if (BZmq_buffer != NULL) {\n+        memset(BZmq_buffer, 0, BZMQ_BUFFER_SIZE);\n+\n+        while(!fShutdown) {\n+            nRc = zmq_poll (BZmq_pollitems, 1, 0);\n+            if (nRc == -1) {\n+                printf(\"ZMQ ERROR: zmq_poll in BZmq_ThreadReqRep() errno: %i strerror: %s\\n\", errno, strerror(errno));\n+                break;\n+            }\n+\n+            if (nRc > 0 && !fShutdown)  {\n+                if (BZmq_pollitems [0].revents & ZMQ_POLLIN) {\n+                    nRc_recv = zmq_recv (pBZmq_socket_rep, &BZmq_buffer[0], BZMQ_BUFFER_SIZE, 0);\n+                    if (nRc_recv != -1) {\n+                        if (nRc_recv == 0 || nRc_recv == BZMQ_BUFFER_SIZE)\n+                            //we don't care about these...\n+                            nRc = zmq_send(pBZmq_socket_rep, \"\", 0, ZMQ_DONTWAIT);\n+                        else {\n+                            std::string strCommand = &BZmq_buffer[0];\n+                            json_spirit::Value jsonCommand;\n+                            std::string strTemp;\n+                            if (json_spirit::read_string(strCommand, jsonCommand)) {\n+\n+                                if (jsonCommand.type() == json_spirit::obj_type) {\n+                                    json_spirit::Object result = JSONRPCExecOne(jsonCommand);\n+                                    strTemp = json_spirit::write_string(json_spirit::Value(result), false);\n+                                } else if (jsonCommand.type() == json_spirit::array_type)\n+                                    // array of requests\n+                                    strTemp = JSONRPCExecBatch(jsonCommand.get_array());\n+                                else\n+                                    printf(\"ZMQ ERROR: no jsonCommand.type() found! %s\\n\", strCommand.c_str());\n+\n+                                nRc = zmq_send(pBZmq_socket_rep, strTemp.c_str(), strTemp.length(), ZMQ_DONTWAIT);\n+                                if (nRc < 0)\n+                                    printf(\"ZMQ ERROR: zmq_send in BZmq_ThreadReqRep() errno: %i strerror: %s\\n\", errno, strerror(errno));\n+                            } else {\n+                                printf(\"ZMQ ERROR: read_string failed for command: '%s'\\n\", strCommand.c_str());\n+                                nRc = zmq_send(pBZmq_socket_rep, \"\", 0, ZMQ_DONTWAIT);\n+                            }\n+                        }\n+                        memset(BZmq_buffer, 0, nRc_recv);\n+                    } else\n+                        printf(\"ZMQ ERROR: zmq_recv in BZmq_ThreadReqRep() errno: %i strerror: %s\\n\", errno, strerror(errno));\n+                }\n+            } else \n+                //we are only sleeping if we don't have anything to do.\n+                usleep(10000);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#discussion_r3796459",
      "id" : 3796459,
      "original_commit_id" : "7c05592af68dd7d1ec9219c1afe76207797f3214",
      "original_position" : 343,
      "path" : "src/bitcoin_zmq.cpp",
      "position" : 343,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/2415",
      "updated_at" : "2013-04-15T16:02:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/3796459",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@laanwj \r\n\r\nThe usleep is only running if there is nothing for the thread to do. If we have a lot of request coming in, we will process this until the queue is empty. The reason why I have done this is to be able to shutdown the bitcoin process.\r\n\r\n0mq does not any authentication method. That's correct. Only allow it from trusted sources.\r\n\r\nThe default value for USE_ZMQ is zero (0) in the makefile.unix. That's why you need USE_ZMQ=1 to be able to compile it with 0mq support.\r\n",
      "created_at" : "2013-04-15T16:19:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-16395222",
      "id" : 16395222,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-04-15T16:19:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/16395222",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1326048?v=3",
         "events_url" : "https://api.github.com/users/fredan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fredan/followers",
         "following_url" : "https://api.github.com/users/fredan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fredan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fredan",
         "id" : 1326048,
         "login" : "fredan",
         "organizations_url" : "https://api.github.com/users/fredan/orgs",
         "received_events_url" : "https://api.github.com/users/fredan/received_events",
         "repos_url" : "https://api.github.com/users/fredan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fredan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fredan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fredan"
      }
   },
   {
      "body" : "You seem to be completely misunderstanding me\r\n\r\n1) I know why you added the usleep, so my suggestion is to use a \"blocking read\" for the same time instead of an usleep (which doesn't process messages when they come in). Not an unbounded blocking wait, of course, that would indeed make it impossible to exit the client.\r\n\r\n2) I agree with \"allow it from trusted sources only\". How does this work? Is there some form of access control at all? Or can everyone on localhost connect to it by default?\r\n\r\n3) I understand that. My suggestion is to make it possible to compile with USE_ZMQ=1 but disable zeromq, so that it is possible to compile binaries with zeromq support compiled in, distribute them, and leave it up to the user to enable it or not. Enabling it should not only depend on a compile-time option.\r\n",
      "created_at" : "2013-04-15T17:19:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-16398766",
      "id" : 16398766,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-05-30T16:49:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/16398766",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Agree with @laanwj comments.\r\n\r\nLet's go those addressed, and get this merged.\r\n",
      "created_at" : "2013-05-30T16:48:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-18693102",
      "id" : 18693102,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-05-30T16:48:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/18693102",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "Would it be faster to split this into two pull requests? The first to do the pub/sub notifications of transactions, blocks and ip addresses. The second for the zmq based RPC server. The reason for splitting the latter is there is likely to be much discussion over authentication which would bog down the acceptance of the notification patch,\r\n\r\nI've been using my own zmq patch for notification of blocks in my mining pool which works very similar to this one and it has been operating well for the past couple of years. ",
      "created_at" : "2013-05-31T23:58:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-18779696",
      "id" : 18779696,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-05-31T23:58:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/18779696",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16599?v=3",
         "events_url" : "https://api.github.com/users/doublec/events{/privacy}",
         "followers_url" : "https://api.github.com/users/doublec/followers",
         "following_url" : "https://api.github.com/users/doublec/following{/other_user}",
         "gists_url" : "https://api.github.com/users/doublec/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/doublec",
         "id" : 16599,
         "login" : "doublec",
         "organizations_url" : "https://api.github.com/users/doublec/orgs",
         "received_events_url" : "https://api.github.com/users/doublec/received_events",
         "repos_url" : "https://api.github.com/users/doublec/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/doublec/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/doublec/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/doublec"
      }
   },
   {
      "body" : "@fredan Are you going to fix this up?",
      "created_at" : "2013-07-17T03:48:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-21090391",
      "id" : 21090391,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-07-17T03:48:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/21090391",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Ping @fredan.  Also, ping @doublec in case you are motivated to split this up, and get 0mq support moving again.\r\n",
      "created_at" : "2013-08-25T03:21:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-23221167",
      "id" : 23221167,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-08-25T03:21:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/23221167",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "Splitting it into two sounds like a good idea. I suppose the notifications can be unauthenticated.\r\n",
      "created_at" : "2013-08-29T11:30:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-23482490",
      "id" : 23482490,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-08-29T11:30:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/23482490",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Closing this because of inactivity. If you have time to rework this so it merges cleanly against the current tree, please open a new pull request (and link to the discussion in this closed request, if it is relevant).\r\n",
      "created_at" : "2013-10-21T01:39:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/2415#issuecomment-26688588",
      "id" : 26688588,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2415",
      "updated_at" : "2013-10-21T01:39:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/26688588",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   }
]
