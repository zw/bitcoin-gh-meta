{
   "assignee" : null,
   "body" : "TD and jrmithdobbs ran into this with version 0.6rc1.\r\n\r\nWhat happened:\r\n\r\nBlock 170060 has an invalid-under-new-rules BIP16 transaction. That block is rejected by 0.6rc1 unless you run with the -paytoscripthashtime= argument to move the BIP16 acceptance date.\r\n\r\nThere is a fairly long alternative chain fork at that point, because a couple of mining pool operators who were supporting BIP16 didn't restart their bitcoind's with the new BIP16 deadline.\r\n\r\nThe 0.6rc1 code will save both chains to disk, but rejects the longer as invalid.  So far, so good.\r\n\r\nThe bug:  If you upgrade or set -paytoscripthashtime to the correct date then the next found block will trigger a really big reorg operation.  And with the settings we're using for Berkeley DB, that re-org fails because the database code runs out of locks.\r\n\r\nWorkarounds:  recompile bitcoin so bdb allocated more locks.  Or re-download the blockchain.\r\n\r\nShort-term fix:  Add a command-line flag so anybody who runs into this issue can just re-run with more locks.\r\n\r\nLong-term fix: Rework the block re-org code so it doesn't create one massive database transaction.\r\n",
   "closed_at" : "2012-03-12T22:21:38Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
      "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
      "followers_url" : "https://api.github.com/users/gmaxwell/followers",
      "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/gmaxwell",
      "id" : 858454,
      "login" : "gmaxwell",
      "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
      "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
      "repos_url" : "https://api.github.com/users/gmaxwell/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/gmaxwell"
   },
   "comments" : 1,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/925/comments",
   "created_at" : "2012-03-10T20:29:00Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/925/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/925",
   "id" : 3597184,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/925/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 925,
   "state" : "closed",
   "title" : "Large blockchain re-orgs can fail",
   "updated_at" : "2012-03-12T22:21:38Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/925",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
      "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
      "followers_url" : "https://api.github.com/users/gavinandresen/followers",
      "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/gavinandresen",
      "id" : 331997,
      "login" : "gavinandresen",
      "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
      "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
      "repos_url" : "https://api.github.com/users/gavinandresen/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/gavinandresen"
   }
}
