[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "First reported in https://github.com/bitcoin-core/gui/issues/567#issuecomment-1962422185",
      "created_at" : "2024-02-26T16:34:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29482#issuecomment-1964589707",
      "id" : 1964589707,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29482",
      "node_id" : "IC_kwDOABII5851GUKL",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1964589707/reactions"
      },
      "updated_at" : "2024-02-26T16:34:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1964589707",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "So, `settings.json : listen=0` and `bitcoin.conf : listenonion=1` is interpreted as `bitcoind -listen=0 -listenonion=1` thus the rightful error. However `settings.json : listen=0` and `bitcoin.conf : listen=1` does not create a conflict even though, logically `listen=0` vs `listen=1` is even bigger conflict compared to `listen=0` vs `listenonion=1`.",
      "created_at" : "2024-02-26T16:40:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29482#issuecomment-1964605327",
      "id" : 1964605327,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29482",
      "node_id" : "IC_kwDOABII5851GX-P",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1964605327/reactions"
      },
      "updated_at" : "2024-02-26T16:40:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1964605327",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I think the expected behavior you suggested above seems reasonable, that if -listen=0 and -listenonion=1 are specified the -listen=0 option takes precedence and incoming connections are not accepted. It would be nice to log or show a warning in this case.\r\n\r\nI think current behavior of treating it like an error is also reasonable, too.\r\n\r\nI'm not sure about about the new bug reported in https://github.com/bitcoin-core/gui/issues/567#issuecomment-1962422185 since it is i just a screenshot without steps to reproduce. If that bug is happening without anything specified on the command line or in bitcoin.conf like the original bug https://github.com/bitcoin-core/gui/issues/567 then that is a real unexpected problem and bug.",
      "created_at" : "2024-02-26T16:49:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29482#issuecomment-1964629704",
      "id" : 1964629704,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29482",
      "node_id" : "IC_kwDOABII5851Gd7I",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1964629704/reactions"
      },
      "updated_at" : "2024-02-26T16:49:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1964629704",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> When bitcoind is started with the following configuration files:\r\n\r\nCan you add steps for how bitcoind can get into this state (without manually creating a `settings.json`, which we don't support).",
      "created_at" : "2024-02-26T16:55:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29482#issuecomment-1964642114",
      "id" : 1964642114,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29482",
      "node_id" : "IC_kwDOABII5851Gg9C",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1964642114/reactions"
      },
      "updated_at" : "2024-02-26T16:55:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1964642114",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> However `settings.json : listen=0` and `bitcoin.conf : listen=1` does not create a conflict even though, logically `listen=0` vs `listen=1` is even bigger conflict compared to `listen=0` vs `listenonion=1`.\r\n\r\nsettings.json is supposed to take precdence over bitcoin.conf. The idea is bitcoin.conf can have static values set by packager or os which are treated as defaults, and settings.json has dynamic values chosen by the user which override the defaults. But if user is both creating a bitcoin.conf and also changing settings.json through the gui or rpcs, settings.json will take precedence in that case too.\r\n\r\n> > When bitcoind is started with the following configuration files:\r\n> \r\n> Can you add steps for how bitcoind can get into this state (without manually creating a `settings.json`, which we don't support).\r\n\r\nIt would be good to add steps to the description, but if you use the GUI and uncheck \"allow in coming connections\" in the gui network settings, \"listen\": false will be added to settings.json.",
      "created_at" : "2024-02-26T17:00:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29482#issuecomment-1964653446",
      "id" : 1964653446,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29482",
      "node_id" : "IC_kwDOABII5851GjuG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1964653446/reactions"
      },
      "updated_at" : "2024-02-26T17:00:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1964653446",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I'm not sure about about the new bug reported in https://github.com/bitcoin-core/gui/issues/567#issuecomment-1962422185 since it is i just a screenshot without steps to reproduce. If that bug is happening without anything specified on the command line or in bitcoin.conf like the original bug https://github.com/bitcoin-core/gui/issues/567 then that is a real unexpected problem and bug.\r\n\r\nIt requires `listenonion=1` in `bitcoin.conf`.\r\n\r\n> Can you add steps for how bitcoind can get into this state\r\n\r\nAdded elaborate steps to reproduce in the PR description.\r\n\r\nIs the solution here to set `listen: false, listenonion: false` in `settings.json` when \"Allow incoming connections\" is unchecked? Then any `listenonion=1` from `bitcoin.conf` would be overriden as well, like any `listen=1` is overriden now.",
      "created_at" : "2024-02-28T11:22:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29482#issuecomment-1968774486",
      "id" : 1968774486,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29482",
      "node_id" : "IC_kwDOABII5851WR1W",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1968774486/reactions"
      },
      "updated_at" : "2024-02-28T11:22:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1968774486",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Is the solution here to set `listen: false, listenonion: false` in `settings.json` when \"Allow incoming connections\" is unchecked? \r\n\r\nI think that would be a good solution. Other solutions could be:\r\n\r\n- Adding the listenonion setting to the gui so it is visible (the proxy settings already have options for tor, so this would make the listening and proxy options more consistent)\r\n- Making the `listen=0` `listenonion=1` combination actually work by listening on only the localhost onion port only instead of allowing connections from anywhere.\r\n- Improving the current error message. If the user specified \"listenonion=1\" in the config file while also disabling connections it seems like a high chance that is unintentional. Probably it should just be a GUI warning, not a fatal error, though.",
      "created_at" : "2024-02-28T17:27:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29482#issuecomment-1969488304",
      "id" : 1969488304,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29482",
      "node_id" : "IC_kwDOABII5851ZAGw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1969488304/reactions"
      },
      "updated_at" : "2024-02-28T17:27:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1969488304",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "`listen=0` `listenonion=1` is not possible technically. Let me explain. The name `listenonion=` is really confusing and I got confused by it again. Maybe it is time to rename it. It has nothing to do with TCP listening (as in [`bind(2)`](https://www.man7.org/linux/man-pages/man2/bind.2.html) and [`listen(2)`](https://www.man7.org/linux/man-pages/man2/listen.2.html)). What `listenonion=` does is to connect to the Tor daemon and automatically create and configure a Tor service, like _\"Hey, Tor, please start listening on `foobar.onion:8333` and redirect all connections to that to `127.0.0.1:8334`\"_. It should be called `autocreatetorservice=`. Obviously, if we do not TCP listen on `127.0.0.1:8334` (controlled by `listen=`) then this cannot work.\r\n\r\nIt is further confusing because we can listen for onion connections even when `listenonion=0` - if the Tor daemon is configured manually to redirect connections to `foobar.onion:8333` to `127.0.0.1:8334` (where we run with `bind=127.0.0.1:8334=onion` which is the default).\r\n\r\n> Adding the listenonion setting to the gui so it is visible (the proxy settings already have options for tor, so this would make the listening and proxy options more consistent)\r\n\r\nIf this route is taken, then the GUI should only allow the following combinations:\r\n`listen=0` `listenonion=0`\r\n`listen=1` `listenonion=0`\r\n`listen=1` `listenonion=1`",
      "created_at" : "2024-02-29T13:47:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29482#issuecomment-1971183431",
      "id" : 1971183431,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29482",
      "node_id" : "IC_kwDOABII5851fd9H",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1971183431/reactions"
      },
      "updated_at" : "2024-02-29T13:47:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1971183431",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I think that mostly makes sense, and definitely the most direct way to fix this issue would be one of the GUI fixes (making the Allow Incoming Connections checkbox disable both listen options, or improving the GUI error message and making it nonfatal, or adding a GUI option to control -listenonion).\r\n\r\nAnd I agree the options are really confusing and poorly named. IMO we should deprecate -listen, -listenonion, -bind, -whitebind options while interpreting them for backwards compatibility, and design a new option that lets you directly specify what addresses, ports, and sockets you want to listen on using a general syntax like [socat's](https://linux.die.net/man/1/socat).\r\n\r\nI just think, in theory, `listen=0 listenonion=1` could do a sensible thing and disable listening in general while still autoconfiguring tor and listening exclusively on the localhost onion service port. Probably not worth the implementation complexity, but I don't think it would be \"not possible technically\" unless I am missing something",
      "created_at" : "2024-02-29T14:41:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29482#issuecomment-1971289826",
      "id" : 1971289826,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29482",
      "node_id" : "IC_kwDOABII5851f37i",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1971289826/reactions"
      },
      "updated_at" : "2024-02-29T14:41:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1971289826",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   }
]
