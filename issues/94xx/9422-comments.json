[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9422#discussion_r93954500"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93954500"
         }
      },
      "author_association" : "OWNER",
      "body" : "We never released a version with version 1, I think?",
      "commit_id" : "8d309b8dd08425ff5c4d112caf3239d9a9c4b188",
      "created_at" : "2016-12-27T17:46:02Z",
      "diff_hunk" : "@@ -4027,7 +4027,7 @@ int VersionBitsTipStateSinceHeight(const Consensus::Params& params, Consensus::D\n     return VersionBitsStateSinceHeight(chainActive.Tip(), params, pos, versionbitscache);\n }\n \n-static const uint64_t MEMPOOL_DUMP_VERSION = 1;\n+static const uint64_t MEMPOOL_DUMP_VERSION = 2;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9422#discussion_r93954500",
      "id" : 93954500,
      "original_commit_id" : "6272d9add197fc35888848eda00c419cc5b45c2a",
      "original_position" : 5,
      "path" : "src/validation.cpp",
      "position" : 5,
      "pull_request_review_id" : 14485543,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9422",
      "updated_at" : "2017-09-03T06:23:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93954500",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9422#discussion_r93968876"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93968876"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm planning to for Knots 0.13.2",
      "commit_id" : "8d309b8dd08425ff5c4d112caf3239d9a9c4b188",
      "created_at" : "2016-12-27T20:41:56Z",
      "diff_hunk" : "@@ -4027,7 +4027,7 @@ int VersionBitsTipStateSinceHeight(const Consensus::Params& params, Consensus::D\n     return VersionBitsStateSinceHeight(chainActive.Tip(), params, pos, versionbitscache);\n }\n \n-static const uint64_t MEMPOOL_DUMP_VERSION = 1;\n+static const uint64_t MEMPOOL_DUMP_VERSION = 2;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9422#discussion_r93968876",
      "id" : 93968876,
      "in_reply_to_id" : 93954500,
      "original_commit_id" : "6272d9add197fc35888848eda00c419cc5b45c2a",
      "original_position" : 5,
      "path" : "src/validation.cpp",
      "position" : 5,
      "pull_request_review_id" : 14499690,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9422",
      "updated_at" : "2017-09-03T06:23:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93968876",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Needs rebase.",
      "created_at" : "2017-01-08T10:52:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9422#issuecomment-271143631",
      "id" : 271143631,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9422",
      "updated_at" : "2017-01-08T10:52:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271143631",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9422#discussion_r95257050"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95257050"
         }
      },
      "author_association" : "OWNER",
      "body" : "Ok. There is hardly any loss...",
      "commit_id" : "8d309b8dd08425ff5c4d112caf3239d9a9c4b188",
      "created_at" : "2017-01-09T22:04:17Z",
      "diff_hunk" : "@@ -4027,7 +4027,7 @@ int VersionBitsTipStateSinceHeight(const Consensus::Params& params, Consensus::D\n     return VersionBitsStateSinceHeight(chainActive.Tip(), params, pos, versionbitscache);\n }\n \n-static const uint64_t MEMPOOL_DUMP_VERSION = 1;\n+static const uint64_t MEMPOOL_DUMP_VERSION = 2;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9422#discussion_r95257050",
      "id" : 95257050,
      "in_reply_to_id" : 93954500,
      "original_commit_id" : "6272d9add197fc35888848eda00c419cc5b45c2a",
      "original_position" : 5,
      "path" : "src/validation.cpp",
      "position" : 5,
      "pull_request_review_id" : 15806706,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9422",
      "updated_at" : "2017-09-03T06:23:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95257050",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9422#discussion_r95258618"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95258618"
         }
      },
      "author_association" : "OWNER",
      "body" : "SER_DISK / CLIENT_VERSION? I doubt it matters for anything, but better be consistent for now.",
      "commit_id" : "8d309b8dd08425ff5c4d112caf3239d9a9c4b188",
      "created_at" : "2017-01-09T22:13:06Z",
      "diff_hunk" : "@@ -4092,24 +4113,43 @@ bool LoadMempool(void)\n     return true;\n }\n \n+template <class T>\n+std::vector<unsigned char> SerializeToVector(T o) {\n+    CDataStream ss(SER_NETWORK, PROTOCOL_VERSION);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9422#discussion_r95258618",
      "id" : 95258618,
      "original_commit_id" : "6272d9add197fc35888848eda00c419cc5b45c2a",
      "original_position" : 103,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 15806706,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9422",
      "updated_at" : "2017-09-03T06:23:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95258618",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9422#discussion_r95275633"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95275633"
         }
      },
      "author_association" : "OWNER",
      "body" : "Can't this `try` block be made to enclose all deserialization operations, so that the catch and error reporting can be written only once?",
      "commit_id" : "8d309b8dd08425ff5c4d112caf3239d9a9c4b188",
      "created_at" : "2017-01-10T00:04:18Z",
      "diff_hunk" : "@@ -4050,39 +4050,60 @@ bool LoadMempool(void)\n         if (version != MEMPOOL_DUMP_VERSION) {\n             return false;\n         }\n-        uint64_t num;\n-        file >> num;\n-        double prioritydummy = 0;\n-        while (num--) {\n-            int64_t nTime;\n-            int64_t nFeeDelta;\n-            CTransaction tx(deserialize, file);\n-            file >> nTime;\n-            file >> nFeeDelta;\n-\n-            CAmount amountdelta = nFeeDelta;\n-            if (amountdelta) {\n-                mempool.PrioritiseTransaction(tx.GetHash(), tx.GetHash().ToString(), prioritydummy, amountdelta);\n+        std::map<std::string, std::vector<unsigned char>> mapData;\n+        file >> mapData;\n+\n+        it = mapData.find(\"deltas\");\n+        if (it == mapData.end()) {\n+            try {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9422#discussion_r95275633",
      "id" : 95275633,
      "original_commit_id" : "6272d9add197fc35888848eda00c419cc5b45c2a",
      "original_position" : 31,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 15806706,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9422",
      "updated_at" : "2017-09-03T06:23:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95275633",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Fixed serialisation params. There are conflicts now - may I rebase?",
      "created_at" : "2017-01-12T17:09:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9422#issuecomment-272222303",
      "id" : 272222303,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9422",
      "updated_at" : "2017-01-12T17:09:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272222303",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Rebased.",
      "created_at" : "2017-01-12T20:12:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9422#issuecomment-272270231",
      "id" : 272270231,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9422",
      "updated_at" : "2017-01-12T20:12:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272270231",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9422#discussion_r100462725"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100462725"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The implications seem to be minor, but this means all bitcoin nodes prior to this PR being merged will drop all their mempools on startup. Is that okay? Would it be possible / worth it to load version=1 mempools too? Above comment by @sipa seems to indicate this was never used, in which case I think we should simply say `MEMPOOL_DUMP_VERSION  = 1` above.",
      "commit_id" : "8d309b8dd08425ff5c4d112caf3239d9a9c4b188",
      "created_at" : "2017-02-10T02:49:29Z",
      "diff_hunk" : "@@ -4192,42 +4192,63 @@ bool LoadMempool(void)\n         if (version != MEMPOOL_DUMP_VERSION) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9422#discussion_r100462725",
      "id" : 100462725,
      "original_commit_id" : "7ef2e0d8a81cfad26e124cfacda367f183b5716e",
      "original_position" : 10,
      "path" : "src/validation.cpp",
      "position" : 10,
      "pull_request_review_id" : 21170841,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9422",
      "updated_at" : "2017-09-03T06:23:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100462725",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "I'm not sure this is worth it right now; we can revisit if there is critical information to add to the mempool file?",
      "created_at" : "2018-03-06T18:15:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9422#issuecomment-370876165",
      "id" : 370876165,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9422",
      "updated_at" : "2018-03-06T18:15:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/370876165",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
