{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "This describes a proposed enhancement.\r\n\r\nWith the ability to import keys without full rescan or load an old wallet\r\nwithout a rescan (e.g. with pruning), the user of a wallet is exposed to\r\nthe possiblity that there will be wallet txn that they don't know about.\r\n\r\nEven if the user intentionally put the wallet in this state, they may\r\nforget months later (esp. if managing multiple wallets).  \r\n\r\nFailure to know about this can result funds loss (thinking keys don't\r\nhave funds when they do), and even if there is a UTXO scan, issues may\r\nremain: The user may falsely think they didn't pay someone and then\r\npay again, the user may falsely think they weren't paid and falsely\r\ndemand payment.  The user might screw up their taxes or business\r\nrecords and get themselves in trouble. In short: \"the wallet gives you a complete history\r\nof your transactions, except when it doesn't\" is a somewhat dangerous interface.\r\n\r\nI believe we can avoid these issues by establishing clear behavior.\r\n\r\nTo do this we define a pruned wallet: A pruned wallet knows every\r\nwallet transaction up to height X, and before that only knows about\r\ncoins.\r\n\r\nIn the transaction list there would be a top most entry that\r\nsays something like \"Prior history not shown due to pruning\"\r\nand perhaps a correcting ledger entry that showed the amount\r\nof coins available at the point of pruning.  RPC would provide\r\nthe pruning state via getwalletinfo and potentially a correcting\r\nledger entry at the earliest point in listtransactions.\r\n\r\nAny wallet could be pruned to any height at any time. Any\r\npruned wallet could be unpruned with a rescan.\r\n\r\nIf you import keys in the UI or load a old wallet the GUI could\r\nprompt the user to allow rescan or prune-- or if the age is beyond\r\ntheir blockchain prune depth, allow them to prune or abort.\r\n\r\n(or even rescan by fetching blocks ... wee!)\r\n\r\n(Potentially a wallet could have an unknown pruned state where\r\n a notice is displayed that says it doesn't know if its pruned or not,\r\n allowing the current behavior.)\r\n\r\nThis would also be attractive to large commercial parties\r\nwho have ended up with wallets that are hundreds of megs in size.\r\n(most of that is transaction data that would be eliminated by pruning)\r\n\r\nSome thought might be given to preserving labels for pruned transactions. They don't take much space, and might just be worth preserving.",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 5,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9409/comments",
   "created_at" : "2016-12-22T21:13:47Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9409/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/9409",
   "id" : 197267689,
   "labels" : [
      {
         "color" : "08a781",
         "default" : false,
         "id" : 149424,
         "name" : "Wallet",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9409/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 9409,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "Pruned wallet support",
   "updated_at" : "2017-12-15T13:39:49Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9409",
   "user" : {
      "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
      "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
      "followers_url" : "https://api.github.com/users/gmaxwell/followers",
      "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/gmaxwell",
      "id" : 858454,
      "login" : "gmaxwell",
      "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
      "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
      "repos_url" : "https://api.github.com/users/gmaxwell/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/gmaxwell"
   }
}
