[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/28374).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [theStack](https://github.com/bitcoin/bitcoin/pull/28374#pullrequestreview-1651918134), [sipa](https://github.com/bitcoin/bitcoin/pull/28374#issuecomment-1798520540), [achow101](https://github.com/bitcoin/bitcoin/pull/28374#issuecomment-1800222458) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.\n",
      "created_at" : "2023-08-31T10:14:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#issuecomment-1700759702",
      "id" : 1700759702,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28374",
      "node_id" : "IC_kwDOABII585lX4iW",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1700759702/reactions"
      },
      "updated_at" : "2023-11-07T21:43:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1700759702",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1312997599"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1312997599"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "naming nit: the nonce from `CHACHA20_TESTS` is not provided as a hex string, but as a list of two integers, so the `hex_` prefix doesn't apply here. Maybe something like `nonce_pair` instead? (or simply `nonce` and rename the bytes-version below to somethig else like `nonce_bytes`)\r\n```suggestion\r\n            hex_key, nonce_pair, counter, hex_output = test_vector\r\n```",
      "commit_id" : "7ceb9b77fec4eca6e5054b1f8166735b1dea826c",
      "created_at" : "2023-09-01T13:00:39Z",
      "diff_hunk" : "@@ -0,0 +1,103 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Python implementation of ChaCha20 cipher\"\"\"\n+\n+import unittest\n+\n+CHACHA20_INDICES = (\n+    (0, 4, 8, 12), (1, 5, 9, 13), (2, 6, 10, 14), (3, 7, 11, 15),\n+    (0, 5, 10, 15), (1, 6, 11, 12), (2, 7, 8, 13), (3, 4, 9, 14)\n+)\n+\n+CHACHA20_CONSTANTS = (0x61707865, 0x3320646e, 0x79622d32, 0x6b206574)\n+\n+def rotl32(v, bits):\n+    \"\"\"Rotate the 32-bit value v left by bits bits.\"\"\"\n+    bits %= 32  # Make sure the term below does not throw an exception\n+    return ((v << bits) & 0xffffffff) | (v >> (32 - bits))\n+\n+def chacha20_doubleround(s):\n+    \"\"\"Apply a ChaCha20 double round to 16-element state array s.\n+    See https://cr.yp.to/chacha/chacha-20080128.pdf and https://tools.ietf.org/html/rfc8439\n+    \"\"\"\n+    for a, b, c, d in CHACHA20_INDICES:\n+        s[a] = (s[a] + s[b]) & 0xffffffff\n+        s[d] = rotl32(s[d] ^ s[a], 16)\n+        s[c] = (s[c] + s[d]) & 0xffffffff\n+        s[b] = rotl32(s[b] ^ s[c], 12)\n+        s[a] = (s[a] + s[b]) & 0xffffffff\n+        s[d] = rotl32(s[d] ^ s[a], 8)\n+        s[c] = (s[c] + s[d]) & 0xffffffff\n+        s[b] = rotl32(s[b] ^ s[c], 7)\n+\n+def chacha20_block(key, nonce, cnt):\n+    \"\"\"Compute the 64-byte output of the ChaCha20 block function.\n+    Takes as input a 32-byte key, 12-byte nonce, and 32-bit integer counter.\n+    \"\"\"\n+    # Initial state.\n+    init = [0 for _ in range(16)]\n+    for i in range(4):\n+        init[i] = CHACHA20_CONSTANTS[i]\n+    for i in range(8):\n+        init[4 + i] = int.from_bytes(key[4 * i:4 * (i+1)], 'little')\n+    init[12] = cnt\n+    for i in range(3):\n+        init[13 + i] = int.from_bytes(nonce[4 * i:4 * (i+1)], 'little')\n+    # Perform 20 rounds.\n+    state = list(init)\n+    for _ in range(10):\n+        chacha20_doubleround(state)\n+    # Add initial values back into state.\n+    for i in range(16):\n+        state[i] = (state[i] + init[i]) & 0xffffffff\n+    # Produce byte output\n+    return b''.join(state[i].to_bytes(4, 'little') for i in range(16))\n+\n+\n+# Test vectors from RFC7539/8439 consisting of 32 byte key, 12 byte nonce, block counter\n+# and 64 byte output after applying `chacha20_block` function\n+CHACHA20_TESTS = [\n+    [\"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f\", [0x09000000, 0x4a000000], 1,\n+     \"10f1e7e4d13b5915500fdd1fa32071c4c7d1f4c733c068030422aa9ac3d46c4e\"\n+     \"d2826446079faa0914c2d705d98b02a2b5129cd1de164eb9cbd083e8a2503c4e\"],\n+    [\"0000000000000000000000000000000000000000000000000000000000000000\", [0, 0], 0,\n+     \"76b8e0ada0f13d90405d6ae55386bd28bdd219b8a08ded1aa836efcc8b770dc7\"\n+     \"da41597c5157488d7724e03fb8d84a376a43b8f41518a11cc387b669b2ee6586\"],\n+    [\"0000000000000000000000000000000000000000000000000000000000000000\", [0, 0], 1,\n+     \"9f07e7be5551387a98ba977c732d080dcb0f29a048e3656912c6533e32ee7aed\"\n+     \"29b721769ce64e43d57133b074d839d531ed1f28510afb45ace10a1f4b794d6f\"],\n+    [\"0000000000000000000000000000000000000000000000000000000000000001\", [0, 0], 1,\n+     \"3aeb5224ecf849929b9d828db1ced4dd832025e8018b8160b82284f3c949aa5a\"\n+     \"8eca00bbb4a73bdad192b5c42f73f2fd4e273644c8b36125a64addeb006c13a0\"],\n+    [\"00ff000000000000000000000000000000000000000000000000000000000000\", [0, 0], 2,\n+     \"72d54dfbf12ec44b362692df94137f328fea8da73990265ec1bbbea1ae9af0ca\"\n+     \"13b25aa26cb4a648cb9b9d1be65b2c0924a66c54d545ec1b7374f4872e99f096\"],\n+    [\"0000000000000000000000000000000000000000000000000000000000000000\", [0, 0x200000000000000], 0,\n+     \"c2c64d378cd536374ae204b9ef933fcd1a8b2288b3dfa49672ab765b54ee27c7\"\n+     \"8a970e0e955c14f3a88e741b97c286f75f8fc299e8148362fa198a39531bed6d\"],\n+    [\"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f\", [0, 0x4a000000], 1,\n+     \"224f51f3401bd9e12fde276fb8631ded8c131f823d2c06e27e4fcaec9ef3cf78\"\n+     \"8a3b0aa372600a92b57974cded2b9334794cba40c63e34cdea212c4cf07d41b7\"],\n+    [\"0000000000000000000000000000000000000000000000000000000000000001\", [0, 0], 0,\n+     \"4540f05a9f1fb296d7736e7b208e3c96eb4fe1834688d2604f450952ed432d41\"\n+     \"bbe2a0b6ea7566d2a5d1e7e20d42af2c53d792b1c43fea817e9ad275ae546963\"],\n+    [\"0000000000000000000000000000000000000000000000000000000000000000\", [0, 1], 0,\n+     \"ef3fdfd6c61578fbf5cf35bd3dd33b8009631634d21e42ac33960bd138e50d32\"\n+     \"111e4caf237ee53ca8ad6426194a88545ddc497a0b466e7d6bbdb0041b2f586b\"],\n+    [\"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f\", [0, 0x0706050403020100], 0,\n+     \"f798a189f195e66982105ffb640bb7757f579da31602fc93ec01ac56f85ac3c1\"\n+     \"34a4547b733b46413042c9440049176905d3be59ea1c53f15916155c2be8241a\"],\n+]\n+\n+\n+class TestFrameworkChacha(unittest.TestCase):\n+    def test_chacha20(self):\n+        \"\"\"ChaCha20 test vectors.\"\"\"\n+        for test_vector in CHACHA20_TESTS:\n+            hex_key, hex_nonce, counter, hex_output = test_vector",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1312997599",
      "id" : 1312997599,
      "line" : 139,
      "node_id" : "PRRC_kwDOABII585OQsDf",
      "original_commit_id" : "cb838f0d9c9b84c07b5081c783275680e48a9023",
      "original_line" : 99,
      "original_position" : 99,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/chacha20.py",
      "position" : 139,
      "pull_request_review_id" : 1606904477,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1312997599/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-01T13:42:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1312997599",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313004252"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313004252"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "As `key.py` is currently containing only code related to digital signatures (according to the module description it's a \"secp256k1 elliptic curve protocols implementation\"), the HKDF would maybe be better suited in another (new?) module. Probably it generally makes sense to do a follow-up with restructuring crypto-related helpers, e.g. having an own \"test_framework/crypto\" folder would be nice on the long-term for better structuring I think, as the list of crypto-related modules has grown quite a bit.",
      "commit_id" : "7ceb9b77fec4eca6e5054b1f8166735b1dea826c",
      "created_at" : "2023-09-01T13:07:03Z",
      "diff_hunk" : "@@ -27,6 +27,22 @@ def TaggedHash(tag, data):\n     ss += data\n     return hashlib.sha256(ss).digest()\n \n+# HKDF-SHA256\n+def hmac_sha256(key, data):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313004252",
      "id" : 1313004252,
      "line" : 31,
      "node_id" : "PRRC_kwDOABII585OQtrc",
      "original_commit_id" : "21f71c67895c186137cc19b30f26c57b8a8c562e",
      "original_line" : 31,
      "original_position" : 5,
      "original_start_line" : 30,
      "path" : "test/functional/test_framework/key.py",
      "position" : 5,
      "pull_request_review_id" : 1606904477,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313004252/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 30,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-09-01T13:42:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313004252",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313018187"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313018187"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: named arguments for the boolean here and below would be nice\r\n```suggestion\r\n                enc_aead.crypt(b\"\", b\"\", is_decrypt=False)\r\n```",
      "commit_id" : "7ceb9b77fec4eca6e5054b1f8166735b1dea826c",
      "created_at" : "2023-09-01T13:17:51Z",
      "diff_hunk" : "@@ -112,3 +161,24 @@ def test_aead(self):\n             self.assertEqual(hex_cipher, ciphertext.hex())\n             plaintext = aead_chacha20_poly1305_decrypt(key, nonce, aad, ciphertext)\n             self.assertEqual(plain, plaintext)\n+\n+    def test_fschacha20poly1305aead(self):\n+        \"FSChaCha20Poly1305 AEAD test vectors.\"\n+        for test_vector in FSAEAD_TESTS:\n+            hex_plain, hex_aad, hex_key, msg_idx, hex_cipher = test_vector\n+            plain = bytes.fromhex(hex_plain)\n+            aad = bytes.fromhex(hex_aad)\n+            key = bytes.fromhex(hex_key)\n+\n+            enc_aead = FSChaCha20Poly1305(key)\n+            dec_aead = FSChaCha20Poly1305(key)\n+\n+            for _ in range(msg_idx):\n+                enc_aead.crypt(b\"\", b\"\", False)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313018187",
      "id" : 1313018187,
      "line" : 177,
      "node_id" : "PRRC_kwDOABII585OQxFL",
      "original_commit_id" : "7ceb9b77fec4eca6e5054b1f8166735b1dea826c",
      "original_line" : 177,
      "original_position" : 94,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/bip324_cipher.py",
      "position" : 94,
      "pull_request_review_id" : 1606904477,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313018187/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-01T13:42:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313018187",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313030628"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313030628"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Follow-up idea: it might be nice to also test that the decryption fails (i.e. returns `None` due to poly1305 tag mismatch) if a random bit in `ciphertext` or `aad` is flipped.",
      "commit_id" : "7ceb9b77fec4eca6e5054b1f8166735b1dea826c",
      "created_at" : "2023-09-01T13:28:49Z",
      "diff_hunk" : "@@ -0,0 +1,114 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"ChaCha20 Poly1305 AEAD Construction in RFC 8439\"\"\"\n+\n+import unittest\n+\n+from .chacha20 import chacha20_block\n+from .poly1305 import Poly1305\n+\n+def aead_chacha20_poly1305_encrypt(key, nonce, aad, plaintext):\n+    \"\"\"Encrypt a plaintext using ChaCha20Poly1305.\"\"\"\n+    ret = bytearray()\n+    msg_len = len(plaintext)\n+    for i in range((msg_len + 63) // 64):\n+        now = min(64, msg_len - 64 * i)\n+        keystream = chacha20_block(key, nonce, i + 1)\n+        for j in range(now):\n+            ret.append(plaintext[j + 64 * i] ^ keystream[j])\n+    poly1305 = Poly1305(chacha20_block(key, nonce, 0)[:32])\n+    poly1305.add(aad, pad=True).add(ret, pad=True)\n+    poly1305.add(len(aad).to_bytes(8, 'little') + msg_len.to_bytes(8, 'little'))\n+    ret += poly1305.tag()\n+    return bytes(ret)\n+\n+def aead_chacha20_poly1305_decrypt(key, nonce, aad, ciphertext):\n+    \"\"\"Decrypt a ChaCha20Poly1305 ciphertext.\"\"\"\n+    if len(ciphertext) < 16:\n+        return None\n+    msg_len = len(ciphertext) - 16\n+    poly1305 = Poly1305(chacha20_block(key, nonce, 0)[:32])\n+    poly1305.add(aad, pad=True)\n+    poly1305.add(ciphertext, length=msg_len, pad=True)\n+    poly1305.add(len(aad).to_bytes(8, 'little') + msg_len.to_bytes(8, 'little'))\n+    if ciphertext[-16:] != poly1305.tag():\n+        return None\n+    ret = bytearray()\n+    for i in range((msg_len + 63) // 64):\n+        now = min(64, msg_len - 64 * i)\n+        keystream = chacha20_block(key, nonce, i + 1)\n+        for j in range(now):\n+            ret.append(ciphertext[j + 64 * i] ^ keystream[j])\n+    return bytes(ret)\n+\n+\n+# Test vectors from RFC8439 consisting of plaintext, aad, 32 byte key, 12 byte nonce and ciphertext\n+AEAD_TESTS = [\n+    # RFC 8439 Example from section 2.8.2\n+    [\"4c616469657320616e642047656e746c656d656e206f662074686520636c6173\"\n+     \"73206f66202739393a204966204920636f756c64206f6666657220796f75206f\"\n+     \"6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73\"\n+     \"637265656e20776f756c642062652069742e\",\n+     \"50515253c0c1c2c3c4c5c6c7\",\n+     \"808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9f\",\n+     [7, 0x4746454443424140],\n+     \"d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d6\"\n+     \"3dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b36\"\n+     \"92ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc\"\n+     \"3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd060\"\n+     \"0691\"],\n+    # RFC 8439 Test vector A.5\n+    [\"496e7465726e65742d4472616674732061726520647261667420646f63756d65\"\n+     \"6e74732076616c696420666f722061206d6178696d756d206f6620736978206d\"\n+     \"6f6e74687320616e64206d617920626520757064617465642c207265706c6163\"\n+     \"65642c206f72206f62736f6c65746564206279206f7468657220646f63756d65\"\n+     \"6e747320617420616e792074696d652e20497420697320696e617070726f7072\"\n+     \"6961746520746f2075736520496e7465726e65742d4472616674732061732072\"\n+     \"65666572656e6365206d6174657269616c206f7220746f206369746520746865\"\n+     \"6d206f74686572207468616e206173202fe2809c776f726b20696e2070726f67\"\n+     \"726573732e2fe2809d\",\n+     \"f33388860000000000004e91\",\n+     \"1c9240a5eb55d38af333888604f6b5f0473917c1402b80099dca5cbc207075c0\",\n+     [0, 0x0807060504030201],\n+     \"64a0861575861af460f062c79be643bd5e805cfd345cf389f108670ac76c8cb2\"\n+     \"4c6cfc18755d43eea09ee94e382d26b0bdb7b73c321b0100d4f03b7f355894cf\"\n+     \"332f830e710b97ce98c8a84abd0b948114ad176e008d33bd60f982b1ff37c855\"\n+     \"9797a06ef4f0ef61c186324e2b3506383606907b6a7c02b0f9f6157b53c867e4\"\n+     \"b9166c767b804d46a59b5216cde7a4e99040c5a40433225ee282a1b0a06c523e\"\n+     \"af4534d7f83fa1155b0047718cbc546a0d072b04b3564eea1b422273f548271a\"\n+     \"0bb2316053fa76991955ebd63159434ecebb4e466dae5a1073a6727627097a10\"\n+     \"49e617d91d361094fa68f0ff77987130305beaba2eda04df997b714d6c6f2c29\"\n+     \"a6ad5cb4022b02709beead9d67890cbb22392336fea1851f38\"],\n+    # Test vectors exercising aad and plaintext which are multiples of 16 bytes.\n+    [\"8d2d6a8befd9716fab35819eaac83b33269afb9f1a00fddf66095a6c0cd91951\"\n+     \"a6b7ad3db580be0674c3f0b55f618e34\",\n+     \"\",\n+     \"72ddc73f07101282bbbcf853b9012a9f9695fc5d36b303a97fd0845d0314e0c3\",\n+     [0x3432b75f, 0xb3585537eb7f4024],\n+     \"f760b8224fb2a317b1b07875092606131232a5b86ae142df5df1c846a7f6341a\"\n+     \"f2564483dd77f836be45e6230808ffe402a6f0a3e8be074b3d1f4ea8a7b09451\"],\n+    [\"\",\n+     \"36970d8a704c065de16250c18033de5a400520ac1b5842b24551e5823a3314f3\"\n+     \"946285171e04a81ebfbe3566e312e74ab80e94c7dd2ff4e10de0098a58d0f503\",\n+     \"77adda51d6730b9ad6c995658cbd49f581b2547e7c0c08fcc24ceec797461021\",\n+     [0x1f90da88, 0x75dafa3ef84471a4],\n+     \"aaae5bb81e8407c94b2ae86ae0c7efbe\"],\n+]\n+\n+\n+class TestFrameworkAEAD(unittest.TestCase):\n+    def test_aead(self):\n+        \"\"\"ChaCha20Poly1305 AEAD test vectors.\"\"\"\n+        for test_vector in AEAD_TESTS:\n+            hex_plain, hex_aad, hex_key, hex_nonce, hex_cipher = test_vector\n+            plain = bytes.fromhex(hex_plain)\n+            aad = bytes.fromhex(hex_aad)\n+            key = bytes.fromhex(hex_key)\n+            nonce = hex_nonce[0].to_bytes(4, 'little') + hex_nonce[1].to_bytes(8, 'little')\n+\n+            ciphertext = aead_chacha20_poly1305_encrypt(key, nonce, aad, plain)\n+            self.assertEqual(hex_cipher, ciphertext.hex())\n+            plaintext = aead_chacha20_poly1305_decrypt(key, nonce, aad, ciphertext)\n+            self.assertEqual(plain, plaintext)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313030628",
      "id" : 1313030628,
      "line" : 163,
      "node_id" : "PRRC_kwDOABII585OQ0Hk",
      "original_commit_id" : "8a35ba8bdf15be5bb5e2b36610d5499079fd2153",
      "original_line" : 114,
      "original_position" : 114,
      "original_start_line" : 113,
      "path" : "test/functional/test_framework/bip324_cipher.py",
      "position" : 163,
      "pull_request_review_id" : 1606904477,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313030628/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 162,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-09-01T13:42:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313030628",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313036350"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313036350"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "small nit: not sure if it's really worth to change it, but in Python member variables and methods that shouldn't be accessed from the outside are usually prefixed with an underscore (`_`) (see e.g.: https://peps.python.org/pep-0008/#method-names-and-instance-variables). But that's just a naming convention anyway and the \"private\" usage is not enforced by the language.",
      "commit_id" : "7ceb9b77fec4eca6e5054b1f8166735b1dea826c",
      "created_at" : "2023-09-01T13:33:20Z",
      "diff_hunk" : "@@ -55,6 +57,34 @@ def chacha20_block(key, nonce, cnt):\n     # Produce byte output\n     return b''.join(state[i].to_bytes(4, 'little') for i in range(16))\n \n+class FSChaCha20:\n+    \"\"\"Rekeying wrapper stream cipher around ChaCha20.\"\"\"\n+    def __init__(self, initial_key, rekey_interval=REKEY_INTERVAL):\n+        self.key = initial_key",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313036350",
      "id" : 1313036350,
      "line" : 63,
      "node_id" : "PRRC_kwDOABII585OQ1g-",
      "original_commit_id" : "9a5f84fc5ccc3320df106cc117ba3ba8357f2732",
      "original_line" : 63,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/chacha20.py",
      "position" : 63,
      "pull_request_review_id" : 1606904477,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313036350/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-01T13:42:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313036350",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313713439"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313713439"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "oops, done.",
      "commit_id" : "fb462495adcab99c575f49d4d069214aec898779",
      "created_at" : "2023-09-02T04:15:14Z",
      "diff_hunk" : "@@ -0,0 +1,103 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Python implementation of ChaCha20 cipher\"\"\"\n+\n+import unittest\n+\n+CHACHA20_INDICES = (\n+    (0, 4, 8, 12), (1, 5, 9, 13), (2, 6, 10, 14), (3, 7, 11, 15),\n+    (0, 5, 10, 15), (1, 6, 11, 12), (2, 7, 8, 13), (3, 4, 9, 14)\n+)\n+\n+CHACHA20_CONSTANTS = (0x61707865, 0x3320646e, 0x79622d32, 0x6b206574)\n+\n+def rotl32(v, bits):\n+    \"\"\"Rotate the 32-bit value v left by bits bits.\"\"\"\n+    bits %= 32  # Make sure the term below does not throw an exception\n+    return ((v << bits) & 0xffffffff) | (v >> (32 - bits))\n+\n+def chacha20_doubleround(s):\n+    \"\"\"Apply a ChaCha20 double round to 16-element state array s.\n+    See https://cr.yp.to/chacha/chacha-20080128.pdf and https://tools.ietf.org/html/rfc8439\n+    \"\"\"\n+    for a, b, c, d in CHACHA20_INDICES:\n+        s[a] = (s[a] + s[b]) & 0xffffffff\n+        s[d] = rotl32(s[d] ^ s[a], 16)\n+        s[c] = (s[c] + s[d]) & 0xffffffff\n+        s[b] = rotl32(s[b] ^ s[c], 12)\n+        s[a] = (s[a] + s[b]) & 0xffffffff\n+        s[d] = rotl32(s[d] ^ s[a], 8)\n+        s[c] = (s[c] + s[d]) & 0xffffffff\n+        s[b] = rotl32(s[b] ^ s[c], 7)\n+\n+def chacha20_block(key, nonce, cnt):\n+    \"\"\"Compute the 64-byte output of the ChaCha20 block function.\n+    Takes as input a 32-byte key, 12-byte nonce, and 32-bit integer counter.\n+    \"\"\"\n+    # Initial state.\n+    init = [0 for _ in range(16)]\n+    for i in range(4):\n+        init[i] = CHACHA20_CONSTANTS[i]\n+    for i in range(8):\n+        init[4 + i] = int.from_bytes(key[4 * i:4 * (i+1)], 'little')\n+    init[12] = cnt\n+    for i in range(3):\n+        init[13 + i] = int.from_bytes(nonce[4 * i:4 * (i+1)], 'little')\n+    # Perform 20 rounds.\n+    state = list(init)\n+    for _ in range(10):\n+        chacha20_doubleround(state)\n+    # Add initial values back into state.\n+    for i in range(16):\n+        state[i] = (state[i] + init[i]) & 0xffffffff\n+    # Produce byte output\n+    return b''.join(state[i].to_bytes(4, 'little') for i in range(16))\n+\n+\n+# Test vectors from RFC7539/8439 consisting of 32 byte key, 12 byte nonce, block counter\n+# and 64 byte output after applying `chacha20_block` function\n+CHACHA20_TESTS = [\n+    [\"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f\", [0x09000000, 0x4a000000], 1,\n+     \"10f1e7e4d13b5915500fdd1fa32071c4c7d1f4c733c068030422aa9ac3d46c4e\"\n+     \"d2826446079faa0914c2d705d98b02a2b5129cd1de164eb9cbd083e8a2503c4e\"],\n+    [\"0000000000000000000000000000000000000000000000000000000000000000\", [0, 0], 0,\n+     \"76b8e0ada0f13d90405d6ae55386bd28bdd219b8a08ded1aa836efcc8b770dc7\"\n+     \"da41597c5157488d7724e03fb8d84a376a43b8f41518a11cc387b669b2ee6586\"],\n+    [\"0000000000000000000000000000000000000000000000000000000000000000\", [0, 0], 1,\n+     \"9f07e7be5551387a98ba977c732d080dcb0f29a048e3656912c6533e32ee7aed\"\n+     \"29b721769ce64e43d57133b074d839d531ed1f28510afb45ace10a1f4b794d6f\"],\n+    [\"0000000000000000000000000000000000000000000000000000000000000001\", [0, 0], 1,\n+     \"3aeb5224ecf849929b9d828db1ced4dd832025e8018b8160b82284f3c949aa5a\"\n+     \"8eca00bbb4a73bdad192b5c42f73f2fd4e273644c8b36125a64addeb006c13a0\"],\n+    [\"00ff000000000000000000000000000000000000000000000000000000000000\", [0, 0], 2,\n+     \"72d54dfbf12ec44b362692df94137f328fea8da73990265ec1bbbea1ae9af0ca\"\n+     \"13b25aa26cb4a648cb9b9d1be65b2c0924a66c54d545ec1b7374f4872e99f096\"],\n+    [\"0000000000000000000000000000000000000000000000000000000000000000\", [0, 0x200000000000000], 0,\n+     \"c2c64d378cd536374ae204b9ef933fcd1a8b2288b3dfa49672ab765b54ee27c7\"\n+     \"8a970e0e955c14f3a88e741b97c286f75f8fc299e8148362fa198a39531bed6d\"],\n+    [\"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f\", [0, 0x4a000000], 1,\n+     \"224f51f3401bd9e12fde276fb8631ded8c131f823d2c06e27e4fcaec9ef3cf78\"\n+     \"8a3b0aa372600a92b57974cded2b9334794cba40c63e34cdea212c4cf07d41b7\"],\n+    [\"0000000000000000000000000000000000000000000000000000000000000001\", [0, 0], 0,\n+     \"4540f05a9f1fb296d7736e7b208e3c96eb4fe1834688d2604f450952ed432d41\"\n+     \"bbe2a0b6ea7566d2a5d1e7e20d42af2c53d792b1c43fea817e9ad275ae546963\"],\n+    [\"0000000000000000000000000000000000000000000000000000000000000000\", [0, 1], 0,\n+     \"ef3fdfd6c61578fbf5cf35bd3dd33b8009631634d21e42ac33960bd138e50d32\"\n+     \"111e4caf237ee53ca8ad6426194a88545ddc497a0b466e7d6bbdb0041b2f586b\"],\n+    [\"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f\", [0, 0x0706050403020100], 0,\n+     \"f798a189f195e66982105ffb640bb7757f579da31602fc93ec01ac56f85ac3c1\"\n+     \"34a4547b733b46413042c9440049176905d3be59ea1c53f15916155c2be8241a\"],\n+]\n+\n+\n+class TestFrameworkChacha(unittest.TestCase):\n+    def test_chacha20(self):\n+        \"\"\"ChaCha20 test vectors.\"\"\"\n+        for test_vector in CHACHA20_TESTS:\n+            hex_key, hex_nonce, counter, hex_output = test_vector",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313713439",
      "id" : 1313713439,
      "in_reply_to_id" : 1312997599,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585OTa0f",
      "original_commit_id" : "cb838f0d9c9b84c07b5081c783275680e48a9023",
      "original_line" : 99,
      "original_position" : 99,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/chacha20.py",
      "position" : null,
      "pull_request_review_id" : 1607879160,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313713439/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-02T04:18:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313713439",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/44024636?v=4",
         "events_url" : "https://api.github.com/users/stratospher/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stratospher/followers",
         "following_url" : "https://api.github.com/users/stratospher/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stratospher/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stratospher",
         "id" : 44024636,
         "login" : "stratospher",
         "node_id" : "MDQ6VXNlcjQ0MDI0NjM2",
         "organizations_url" : "https://api.github.com/users/stratospher/orgs",
         "received_events_url" : "https://api.github.com/users/stratospher/received_events",
         "repos_url" : "https://api.github.com/users/stratospher/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stratospher/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stratospher/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stratospher"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313713473"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313713473"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> As key.py is currently containing only code related to digital signatures (according to the module description it's a \"secp256k1 elliptic curve protocols implementation\"), the HKDF would maybe be better suited in another (new?) module.\r\n\r\nmakes sense. what about keeping HKDF in the file where it's used for [initialising v2 transport](https://github.com/bitcoin/bitcoin/blob/edd0cadfaa9645c98f6e0e1c77a489afe4c279c8/test/functional/test_framework/v2_p2p.py#L162)? i'll include this commit in the original #24748 PR with the rest of that file.\r\n\r\n> Probably it generally makes sense to do a follow-up with restructuring crypto-related helpers, e.g. having an own \"test_framework/crypto\" folder would be nice on the long-term for better structuring I think, as the list of crypto-related modules has grown quite a bit.\r\n\r\nyeah! that would be great to have.\r\n",
      "commit_id" : "fb462495adcab99c575f49d4d069214aec898779",
      "created_at" : "2023-09-02T04:15:47Z",
      "diff_hunk" : "@@ -27,6 +27,22 @@ def TaggedHash(tag, data):\n     ss += data\n     return hashlib.sha256(ss).digest()\n \n+# HKDF-SHA256\n+def hmac_sha256(key, data):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313713473",
      "id" : 1313713473,
      "in_reply_to_id" : 1313004252,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585OTa1B",
      "original_commit_id" : "21f71c67895c186137cc19b30f26c57b8a8c562e",
      "original_line" : 31,
      "original_position" : 5,
      "original_start_line" : 30,
      "path" : "test/functional/test_framework/key.py",
      "position" : null,
      "pull_request_review_id" : 1607879160,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313713473/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-09-02T04:18:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313713473",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/44024636?v=4",
         "events_url" : "https://api.github.com/users/stratospher/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stratospher/followers",
         "following_url" : "https://api.github.com/users/stratospher/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stratospher/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stratospher",
         "id" : 44024636,
         "login" : "stratospher",
         "node_id" : "MDQ6VXNlcjQ0MDI0NjM2",
         "organizations_url" : "https://api.github.com/users/stratospher/orgs",
         "received_events_url" : "https://api.github.com/users/stratospher/received_events",
         "repos_url" : "https://api.github.com/users/stratospher/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stratospher/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stratospher/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stratospher"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313713476"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313713476"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done.",
      "commit_id" : "fb462495adcab99c575f49d4d069214aec898779",
      "created_at" : "2023-09-02T04:15:51Z",
      "diff_hunk" : "@@ -112,3 +161,24 @@ def test_aead(self):\n             self.assertEqual(hex_cipher, ciphertext.hex())\n             plaintext = aead_chacha20_poly1305_decrypt(key, nonce, aad, ciphertext)\n             self.assertEqual(plain, plaintext)\n+\n+    def test_fschacha20poly1305aead(self):\n+        \"FSChaCha20Poly1305 AEAD test vectors.\"\n+        for test_vector in FSAEAD_TESTS:\n+            hex_plain, hex_aad, hex_key, msg_idx, hex_cipher = test_vector\n+            plain = bytes.fromhex(hex_plain)\n+            aad = bytes.fromhex(hex_aad)\n+            key = bytes.fromhex(hex_key)\n+\n+            enc_aead = FSChaCha20Poly1305(key)\n+            dec_aead = FSChaCha20Poly1305(key)\n+\n+            for _ in range(msg_idx):\n+                enc_aead.crypt(b\"\", b\"\", False)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313713476",
      "id" : 1313713476,
      "in_reply_to_id" : 1313018187,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585OTa1E",
      "original_commit_id" : "7ceb9b77fec4eca6e5054b1f8166735b1dea826c",
      "original_line" : 177,
      "original_position" : 94,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/bip324_cipher.py",
      "position" : null,
      "pull_request_review_id" : 1607879160,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313713476/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-02T04:18:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313713476",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/44024636?v=4",
         "events_url" : "https://api.github.com/users/stratospher/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stratospher/followers",
         "following_url" : "https://api.github.com/users/stratospher/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stratospher/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stratospher",
         "id" : 44024636,
         "login" : "stratospher",
         "node_id" : "MDQ6VXNlcjQ0MDI0NjM2",
         "organizations_url" : "https://api.github.com/users/stratospher/orgs",
         "received_events_url" : "https://api.github.com/users/stratospher/received_events",
         "repos_url" : "https://api.github.com/users/stratospher/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stratospher/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stratospher/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stratospher"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313713506"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313713506"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "can be done in a follow up if it's desirable to have more tests. ",
      "commit_id" : "fb462495adcab99c575f49d4d069214aec898779",
      "created_at" : "2023-09-02T04:16:02Z",
      "diff_hunk" : "@@ -0,0 +1,114 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"ChaCha20 Poly1305 AEAD Construction in RFC 8439\"\"\"\n+\n+import unittest\n+\n+from .chacha20 import chacha20_block\n+from .poly1305 import Poly1305\n+\n+def aead_chacha20_poly1305_encrypt(key, nonce, aad, plaintext):\n+    \"\"\"Encrypt a plaintext using ChaCha20Poly1305.\"\"\"\n+    ret = bytearray()\n+    msg_len = len(plaintext)\n+    for i in range((msg_len + 63) // 64):\n+        now = min(64, msg_len - 64 * i)\n+        keystream = chacha20_block(key, nonce, i + 1)\n+        for j in range(now):\n+            ret.append(plaintext[j + 64 * i] ^ keystream[j])\n+    poly1305 = Poly1305(chacha20_block(key, nonce, 0)[:32])\n+    poly1305.add(aad, pad=True).add(ret, pad=True)\n+    poly1305.add(len(aad).to_bytes(8, 'little') + msg_len.to_bytes(8, 'little'))\n+    ret += poly1305.tag()\n+    return bytes(ret)\n+\n+def aead_chacha20_poly1305_decrypt(key, nonce, aad, ciphertext):\n+    \"\"\"Decrypt a ChaCha20Poly1305 ciphertext.\"\"\"\n+    if len(ciphertext) < 16:\n+        return None\n+    msg_len = len(ciphertext) - 16\n+    poly1305 = Poly1305(chacha20_block(key, nonce, 0)[:32])\n+    poly1305.add(aad, pad=True)\n+    poly1305.add(ciphertext, length=msg_len, pad=True)\n+    poly1305.add(len(aad).to_bytes(8, 'little') + msg_len.to_bytes(8, 'little'))\n+    if ciphertext[-16:] != poly1305.tag():\n+        return None\n+    ret = bytearray()\n+    for i in range((msg_len + 63) // 64):\n+        now = min(64, msg_len - 64 * i)\n+        keystream = chacha20_block(key, nonce, i + 1)\n+        for j in range(now):\n+            ret.append(ciphertext[j + 64 * i] ^ keystream[j])\n+    return bytes(ret)\n+\n+\n+# Test vectors from RFC8439 consisting of plaintext, aad, 32 byte key, 12 byte nonce and ciphertext\n+AEAD_TESTS = [\n+    # RFC 8439 Example from section 2.8.2\n+    [\"4c616469657320616e642047656e746c656d656e206f662074686520636c6173\"\n+     \"73206f66202739393a204966204920636f756c64206f6666657220796f75206f\"\n+     \"6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73\"\n+     \"637265656e20776f756c642062652069742e\",\n+     \"50515253c0c1c2c3c4c5c6c7\",\n+     \"808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9f\",\n+     [7, 0x4746454443424140],\n+     \"d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d6\"\n+     \"3dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b36\"\n+     \"92ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc\"\n+     \"3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd060\"\n+     \"0691\"],\n+    # RFC 8439 Test vector A.5\n+    [\"496e7465726e65742d4472616674732061726520647261667420646f63756d65\"\n+     \"6e74732076616c696420666f722061206d6178696d756d206f6620736978206d\"\n+     \"6f6e74687320616e64206d617920626520757064617465642c207265706c6163\"\n+     \"65642c206f72206f62736f6c65746564206279206f7468657220646f63756d65\"\n+     \"6e747320617420616e792074696d652e20497420697320696e617070726f7072\"\n+     \"6961746520746f2075736520496e7465726e65742d4472616674732061732072\"\n+     \"65666572656e6365206d6174657269616c206f7220746f206369746520746865\"\n+     \"6d206f74686572207468616e206173202fe2809c776f726b20696e2070726f67\"\n+     \"726573732e2fe2809d\",\n+     \"f33388860000000000004e91\",\n+     \"1c9240a5eb55d38af333888604f6b5f0473917c1402b80099dca5cbc207075c0\",\n+     [0, 0x0807060504030201],\n+     \"64a0861575861af460f062c79be643bd5e805cfd345cf389f108670ac76c8cb2\"\n+     \"4c6cfc18755d43eea09ee94e382d26b0bdb7b73c321b0100d4f03b7f355894cf\"\n+     \"332f830e710b97ce98c8a84abd0b948114ad176e008d33bd60f982b1ff37c855\"\n+     \"9797a06ef4f0ef61c186324e2b3506383606907b6a7c02b0f9f6157b53c867e4\"\n+     \"b9166c767b804d46a59b5216cde7a4e99040c5a40433225ee282a1b0a06c523e\"\n+     \"af4534d7f83fa1155b0047718cbc546a0d072b04b3564eea1b422273f548271a\"\n+     \"0bb2316053fa76991955ebd63159434ecebb4e466dae5a1073a6727627097a10\"\n+     \"49e617d91d361094fa68f0ff77987130305beaba2eda04df997b714d6c6f2c29\"\n+     \"a6ad5cb4022b02709beead9d67890cbb22392336fea1851f38\"],\n+    # Test vectors exercising aad and plaintext which are multiples of 16 bytes.\n+    [\"8d2d6a8befd9716fab35819eaac83b33269afb9f1a00fddf66095a6c0cd91951\"\n+     \"a6b7ad3db580be0674c3f0b55f618e34\",\n+     \"\",\n+     \"72ddc73f07101282bbbcf853b9012a9f9695fc5d36b303a97fd0845d0314e0c3\",\n+     [0x3432b75f, 0xb3585537eb7f4024],\n+     \"f760b8224fb2a317b1b07875092606131232a5b86ae142df5df1c846a7f6341a\"\n+     \"f2564483dd77f836be45e6230808ffe402a6f0a3e8be074b3d1f4ea8a7b09451\"],\n+    [\"\",\n+     \"36970d8a704c065de16250c18033de5a400520ac1b5842b24551e5823a3314f3\"\n+     \"946285171e04a81ebfbe3566e312e74ab80e94c7dd2ff4e10de0098a58d0f503\",\n+     \"77adda51d6730b9ad6c995658cbd49f581b2547e7c0c08fcc24ceec797461021\",\n+     [0x1f90da88, 0x75dafa3ef84471a4],\n+     \"aaae5bb81e8407c94b2ae86ae0c7efbe\"],\n+]\n+\n+\n+class TestFrameworkAEAD(unittest.TestCase):\n+    def test_aead(self):\n+        \"\"\"ChaCha20Poly1305 AEAD test vectors.\"\"\"\n+        for test_vector in AEAD_TESTS:\n+            hex_plain, hex_aad, hex_key, hex_nonce, hex_cipher = test_vector\n+            plain = bytes.fromhex(hex_plain)\n+            aad = bytes.fromhex(hex_aad)\n+            key = bytes.fromhex(hex_key)\n+            nonce = hex_nonce[0].to_bytes(4, 'little') + hex_nonce[1].to_bytes(8, 'little')\n+\n+            ciphertext = aead_chacha20_poly1305_encrypt(key, nonce, aad, plain)\n+            self.assertEqual(hex_cipher, ciphertext.hex())\n+            plaintext = aead_chacha20_poly1305_decrypt(key, nonce, aad, ciphertext)\n+            self.assertEqual(plain, plaintext)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313713506",
      "id" : 1313713506,
      "in_reply_to_id" : 1313030628,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585OTa1i",
      "original_commit_id" : "8a35ba8bdf15be5bb5e2b36610d5499079fd2153",
      "original_line" : 163,
      "original_position" : 114,
      "original_start_line" : 113,
      "path" : "test/functional/test_framework/bip324_cipher.py",
      "position" : null,
      "pull_request_review_id" : 1607879160,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313713506/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-09-02T04:18:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313713506",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/44024636?v=4",
         "events_url" : "https://api.github.com/users/stratospher/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stratospher/followers",
         "following_url" : "https://api.github.com/users/stratospher/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stratospher/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stratospher",
         "id" : 44024636,
         "login" : "stratospher",
         "node_id" : "MDQ6VXNlcjQ0MDI0NjM2",
         "organizations_url" : "https://api.github.com/users/stratospher/orgs",
         "received_events_url" : "https://api.github.com/users/stratospher/received_events",
         "repos_url" : "https://api.github.com/users/stratospher/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stratospher/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stratospher/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stratospher"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313713527"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313713527"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done.",
      "commit_id" : "fb462495adcab99c575f49d4d069214aec898779",
      "created_at" : "2023-09-02T04:16:08Z",
      "diff_hunk" : "@@ -55,6 +57,34 @@ def chacha20_block(key, nonce, cnt):\n     # Produce byte output\n     return b''.join(state[i].to_bytes(4, 'little') for i in range(16))\n \n+class FSChaCha20:\n+    \"\"\"Rekeying wrapper stream cipher around ChaCha20.\"\"\"\n+    def __init__(self, initial_key, rekey_interval=REKEY_INTERVAL):\n+        self.key = initial_key",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313713527",
      "id" : 1313713527,
      "in_reply_to_id" : 1313036350,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585OTa13",
      "original_commit_id" : "9a5f84fc5ccc3320df106cc117ba3ba8357f2732",
      "original_line" : 63,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/chacha20.py",
      "position" : null,
      "pull_request_review_id" : 1607879160,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313713527/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-02T04:18:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313713527",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/44024636?v=4",
         "events_url" : "https://api.github.com/users/stratospher/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stratospher/followers",
         "following_url" : "https://api.github.com/users/stratospher/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stratospher/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stratospher",
         "id" : 44024636,
         "login" : "stratospher",
         "node_id" : "MDQ6VXNlcjQ0MDI0NjM2",
         "organizations_url" : "https://api.github.com/users/stratospher/orgs",
         "received_events_url" : "https://api.github.com/users/stratospher/received_events",
         "repos_url" : "https://api.github.com/users/stratospher/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stratospher/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stratospher/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stratospher"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313714417"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313714417"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This line was added in `FSChaCha20` for rekey interval option and `self.keystream = b''` in the unit tests. That's the only change from [bip-0324/reference.py](https://github.com/bitcoin/bips/blob/cc177ab7bc5abcdcdf9c956ee88afd1052053328/bip-0324/reference.py).\r\n\r\nadded `self.keystream = b''` so that keystream is discarded if there is some keystream left when rekeying happens. this is only needed for `FSCHACHA20_TESTS` and not in BIP 324's usage of FSChaCha20.\r\n\r\nIn BIP 324's usage of FSChaCha20, rekeying happens after 224 messages.\r\n- so 3 bytes message length encrypted each time for 224 messages means 3 bytes * 224 = 10.5 chacha20 blocks get used.\r\n- the remaining 0.5 chach20 block (32 bytes) is used to rekey\r\n\r\nso there would be no keystream left behind and nothing to discard.",
      "commit_id" : "fb462495adcab99c575f49d4d069214aec898779",
      "created_at" : "2023-09-02T04:24:31Z",
      "diff_hunk" : "@@ -55,6 +57,34 @@ def chacha20_block(key, nonce, cnt):\n     # Produce byte output\n     return b''.join(state[i].to_bytes(4, 'little') for i in range(16))\n \n+class FSChaCha20:\n+    \"\"\"Rekeying wrapper stream cipher around ChaCha20.\"\"\"\n+    def __init__(self, initial_key, rekey_interval=REKEY_INTERVAL):\n+        self._key = initial_key\n+        self.rekey_interval = rekey_interval\n+        self.block_counter = 0\n+        self.chunk_counter = 0\n+        self.keystream = b''\n+\n+    def get_keystream_bytes(self, nbytes):\n+        while len(self.keystream) < nbytes:\n+            nonce = ((0).to_bytes(4, 'little') + (self.chunk_counter // self.rekey_interval).to_bytes(8, 'little'))\n+            self.keystream += chacha20_block(self._key, nonce, self.block_counter)\n+            self.block_counter += 1\n+        ret = self.keystream[:nbytes]\n+        self.keystream = self.keystream[nbytes:]\n+        return ret\n+\n+    def crypt(self, chunk):\n+        ks = self.get_keystream_bytes(len(chunk))\n+        ret = bytes([ks[i] ^ chunk[i] for i in range(len(chunk))])\n+        if ((self.chunk_counter + 1) % self.rekey_interval) == 0:\n+            self._key = self.get_keystream_bytes(32)\n+            self.block_counter = 0\n+            self.keystream = b''",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313714417",
      "id" : 1313714417,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585OTbDx",
      "original_commit_id" : "4582b3ef2d85c019247ec4785b2e962328fd20b8",
      "original_line" : 84,
      "original_position" : 46,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/chacha20.py",
      "position" : null,
      "pull_request_review_id" : 1607880254,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313714417/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-02T04:24:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313714417",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/44024636?v=4",
         "events_url" : "https://api.github.com/users/stratospher/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stratospher/followers",
         "following_url" : "https://api.github.com/users/stratospher/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stratospher/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stratospher",
         "id" : 44024636,
         "login" : "stratospher",
         "node_id" : "MDQ6VXNlcjQ0MDI0NjM2",
         "organizations_url" : "https://api.github.com/users/stratospher/orgs",
         "received_events_url" : "https://api.github.com/users/stratospher/received_events",
         "repos_url" : "https://api.github.com/users/stratospher/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stratospher/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stratospher/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stratospher"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1314253965"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1314253965"
         }
      },
      "author_association" : "MEMBER",
      "body" : "What do you think about dropping the length/pad arguments, and dropping the \"Input so far must be a multiple of 16 bytes\" requirement? You can do so by buffering incoming bytes in the object until 16 are reached, and then applying the logic currently in `add`.\r\n\r\nI used this somewhat adhoc interface for the BIP324 reference code because it was less code for that purpose, but it isn't as intuitive as it could be. Perhaps if we're going to have a proper poly1305 module here, it's worth having a more generally usable one.",
      "commit_id" : "fb462495adcab99c575f49d4d069214aec898779",
      "created_at" : "2023-09-03T13:15:48Z",
      "diff_hunk" : "@@ -0,0 +1,100 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Python implementation of Poly1305 authenticator\"\"\"\n+\n+import unittest\n+\n+class Poly1305:\n+    \"\"\"Class representing a running poly1305 computation.\"\"\"\n+    MODULUS = 2**130 - 5\n+\n+    def __init__(self, key):\n+        self.r = int.from_bytes(key[:16], 'little') & 0xffffffc0ffffffc0ffffffc0fffffff\n+        self.s = int.from_bytes(key[16:], 'little')\n+        self.acc = 0\n+\n+    def add(self, msg, length=None, pad=False):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1314253965",
      "id" : 1314253965,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585OVeyN",
      "original_commit_id" : "5db9e9500bd282278e6ee9e666ab7a1f3db7f3b4",
      "original_line" : 18,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/poly1305.py",
      "position" : null,
      "pull_request_review_id" : 1608522032,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1314253965/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-03T13:29:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1314253965",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1314259279"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1314259279"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Makes sense; `FSChaCha20` in the C++ code does the same.",
      "commit_id" : "fb462495adcab99c575f49d4d069214aec898779",
      "created_at" : "2023-09-03T13:27:41Z",
      "diff_hunk" : "@@ -55,6 +57,34 @@ def chacha20_block(key, nonce, cnt):\n     # Produce byte output\n     return b''.join(state[i].to_bytes(4, 'little') for i in range(16))\n \n+class FSChaCha20:\n+    \"\"\"Rekeying wrapper stream cipher around ChaCha20.\"\"\"\n+    def __init__(self, initial_key, rekey_interval=REKEY_INTERVAL):\n+        self._key = initial_key\n+        self.rekey_interval = rekey_interval\n+        self.block_counter = 0\n+        self.chunk_counter = 0\n+        self.keystream = b''\n+\n+    def get_keystream_bytes(self, nbytes):\n+        while len(self.keystream) < nbytes:\n+            nonce = ((0).to_bytes(4, 'little') + (self.chunk_counter // self.rekey_interval).to_bytes(8, 'little'))\n+            self.keystream += chacha20_block(self._key, nonce, self.block_counter)\n+            self.block_counter += 1\n+        ret = self.keystream[:nbytes]\n+        self.keystream = self.keystream[nbytes:]\n+        return ret\n+\n+    def crypt(self, chunk):\n+        ks = self.get_keystream_bytes(len(chunk))\n+        ret = bytes([ks[i] ^ chunk[i] for i in range(len(chunk))])\n+        if ((self.chunk_counter + 1) % self.rekey_interval) == 0:\n+            self._key = self.get_keystream_bytes(32)\n+            self.block_counter = 0\n+            self.keystream = b''",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1314259279",
      "id" : 1314259279,
      "in_reply_to_id" : 1313714417,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585OVgFP",
      "original_commit_id" : "4582b3ef2d85c019247ec4785b2e962328fd20b8",
      "original_line" : 84,
      "original_position" : 46,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/chacha20.py",
      "position" : null,
      "pull_request_review_id" : 1608522032,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1314259279/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-03T13:29:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1314259279",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1314259446"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1314259446"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yeah, I think having HKDF in either `v2_p2p.py` or in a (separate) `crypto/` module would make more sense than in `key.py.`",
      "commit_id" : "fb462495adcab99c575f49d4d069214aec898779",
      "created_at" : "2023-09-03T13:29:11Z",
      "diff_hunk" : "@@ -27,6 +27,22 @@ def TaggedHash(tag, data):\n     ss += data\n     return hashlib.sha256(ss).digest()\n \n+# HKDF-SHA256\n+def hmac_sha256(key, data):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1314259446",
      "id" : 1314259446,
      "in_reply_to_id" : 1313004252,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585OVgH2",
      "original_commit_id" : "21f71c67895c186137cc19b30f26c57b8a8c562e",
      "original_line" : 31,
      "original_position" : 5,
      "original_start_line" : 30,
      "path" : "test/functional/test_framework/key.py",
      "position" : null,
      "pull_request_review_id" : 1608522032,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1314259446/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-09-03T13:29:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1314259446",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1320838221"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320838221"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done. used a separate `crypto/` module.",
      "commit_id" : "fb462495adcab99c575f49d4d069214aec898779",
      "created_at" : "2023-09-10T17:56:35Z",
      "diff_hunk" : "@@ -27,6 +27,22 @@ def TaggedHash(tag, data):\n     ss += data\n     return hashlib.sha256(ss).digest()\n \n+# HKDF-SHA256\n+def hmac_sha256(key, data):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1320838221",
      "id" : 1320838221,
      "in_reply_to_id" : 1313004252,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585OumRN",
      "original_commit_id" : "21f71c67895c186137cc19b30f26c57b8a8c562e",
      "original_line" : 31,
      "original_position" : 5,
      "original_start_line" : 30,
      "path" : "test/functional/test_framework/key.py",
      "position" : null,
      "pull_request_review_id" : 1618892511,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320838221/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-09-10T17:56:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320838221",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/44024636?v=4",
         "events_url" : "https://api.github.com/users/stratospher/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stratospher/followers",
         "following_url" : "https://api.github.com/users/stratospher/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stratospher/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stratospher",
         "id" : 44024636,
         "login" : "stratospher",
         "node_id" : "MDQ6VXNlcjQ0MDI0NjM2",
         "organizations_url" : "https://api.github.com/users/stratospher/orgs",
         "received_events_url" : "https://api.github.com/users/stratospher/received_events",
         "repos_url" : "https://api.github.com/users/stratospher/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stratospher/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stratospher/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stratospher"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1320838236"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320838236"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "true, makes sense to have a general poly1305. used a separate `pad16()` function in the aead to do the padding like in the [RFC](https://datatracker.ietf.org/doc/html/rfc8439#section-2.8.1).",
      "commit_id" : "fb462495adcab99c575f49d4d069214aec898779",
      "created_at" : "2023-09-10T17:56:48Z",
      "diff_hunk" : "@@ -0,0 +1,100 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Python implementation of Poly1305 authenticator\"\"\"\n+\n+import unittest\n+\n+class Poly1305:\n+    \"\"\"Class representing a running poly1305 computation.\"\"\"\n+    MODULUS = 2**130 - 5\n+\n+    def __init__(self, key):\n+        self.r = int.from_bytes(key[:16], 'little') & 0xffffffc0ffffffc0ffffffc0fffffff\n+        self.s = int.from_bytes(key[16:], 'little')\n+        self.acc = 0\n+\n+    def add(self, msg, length=None, pad=False):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1320838236",
      "id" : 1320838236,
      "in_reply_to_id" : 1314253965,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585OumRc",
      "original_commit_id" : "5db9e9500bd282278e6ee9e666ab7a1f3db7f3b4",
      "original_line" : 18,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/poly1305.py",
      "position" : null,
      "pull_request_review_id" : 1618892533,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320838236/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-10T17:56:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320838236",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/44024636?v=4",
         "events_url" : "https://api.github.com/users/stratospher/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stratospher/followers",
         "following_url" : "https://api.github.com/users/stratospher/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stratospher/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stratospher",
         "id" : 44024636,
         "login" : "stratospher",
         "node_id" : "MDQ6VXNlcjQ0MDI0NjM2",
         "organizations_url" : "https://api.github.com/users/stratospher/orgs",
         "received_events_url" : "https://api.github.com/users/stratospher/received_events",
         "repos_url" : "https://api.github.com/users/stratospher/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stratospher/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stratospher/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stratospher"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1320856029"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320856029"
         }
      },
      "author_association" : "MEMBER",
      "body" : "(Here and in other files) Perhaps add a similar warning as `test/functional/test_framework/crypto/secp256k1.py` has (only for tests, slow, vulnerable to side-channel attacks, designed for ease of understanding, ...). I don't think there is much risk that we'd use these files for anything but tests ourselves, but sometimes other projects copy them.",
      "commit_id" : "417eaf84a443967e27219b968be422770739495c",
      "created_at" : "2023-09-10T20:23:43Z",
      "diff_hunk" : "@@ -0,0 +1,103 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Python implementation of ChaCha20 cipher\"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1320856029",
      "id" : 1320856029,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Ouqnd",
      "original_commit_id" : "83bb521593f259305f79388d83afdde3ba6f9d3e",
      "original_line" : 5,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/crypto/chacha20.py",
      "position" : null,
      "pull_request_review_id" : 1618907710,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320856029/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-10T20:29:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320856029",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1320856328"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320856328"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nit: maybe slightly more readable `self.msg[i * 16:min(length, (i + 1) * 16)]`.",
      "commit_id" : "417eaf84a443967e27219b968be422770739495c",
      "created_at" : "2023-09-10T20:26:12Z",
      "diff_hunk" : "@@ -0,0 +1,102 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Python implementation of Poly1305 authenticator\"\"\"\n+\n+import unittest\n+\n+class Poly1305:\n+    \"\"\"Class representing a running poly1305 computation.\"\"\"\n+    MODULUS = 2**130 - 5\n+\n+    def __init__(self, key):\n+        self.r = int.from_bytes(key[:16], 'little') & 0xffffffc0ffffffc0ffffffc0fffffff\n+        self.s = int.from_bytes(key[16:], 'little')\n+        self.acc = 0\n+        self.msg = b\"\"\n+\n+    def add(self, msg):\n+        \"\"\"Add a message of any length.\"\"\"\n+        self.msg += msg\n+        return self\n+\n+    def tag(self):\n+        \"\"\"Compute the poly1305 tag.\"\"\"\n+        length = len(self.msg)\n+        for i in range((length + 15) // 16):\n+            chunk = self.msg[i * 16:i * 16 + min(16, length - i * 16)]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1320856328",
      "id" : 1320856328,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585OuqsI",
      "original_commit_id" : "95c778263f168bd9faa3f9da21fd7b3a63bc8334",
      "original_line" : 28,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/crypto/poly1305.py",
      "position" : null,
      "pull_request_review_id" : 1618907710,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320856328/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-10T20:29:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320856328",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK fb462495adcab99c575f49d4d069214aec898779. Left some nits.",
      "created_at" : "2023-09-10T20:29:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#issuecomment-1712929883",
      "id" : 1712929883,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28374",
      "node_id" : "IC_kwDOABII585mGTxb",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1712929883/reactions"
      },
      "updated_at" : "2023-09-10T20:29:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1712929883",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1320993817"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320993817"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done.",
      "commit_id" : "417eaf84a443967e27219b968be422770739495c",
      "created_at" : "2023-09-11T04:57:04Z",
      "diff_hunk" : "@@ -0,0 +1,103 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Python implementation of ChaCha20 cipher\"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1320993817",
      "id" : 1320993817,
      "in_reply_to_id" : 1320856029,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585OvMQZ",
      "original_commit_id" : "83bb521593f259305f79388d83afdde3ba6f9d3e",
      "original_line" : 5,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/crypto/chacha20.py",
      "position" : null,
      "pull_request_review_id" : 1619123211,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320993817/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-11T04:57:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320993817",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/44024636?v=4",
         "events_url" : "https://api.github.com/users/stratospher/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stratospher/followers",
         "following_url" : "https://api.github.com/users/stratospher/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stratospher/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stratospher",
         "id" : 44024636,
         "login" : "stratospher",
         "node_id" : "MDQ6VXNlcjQ0MDI0NjM2",
         "organizations_url" : "https://api.github.com/users/stratospher/orgs",
         "received_events_url" : "https://api.github.com/users/stratospher/received_events",
         "repos_url" : "https://api.github.com/users/stratospher/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stratospher/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stratospher/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stratospher"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1320993882"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320993882"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nice, done.",
      "commit_id" : "417eaf84a443967e27219b968be422770739495c",
      "created_at" : "2023-09-11T04:57:11Z",
      "diff_hunk" : "@@ -0,0 +1,102 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Python implementation of Poly1305 authenticator\"\"\"\n+\n+import unittest\n+\n+class Poly1305:\n+    \"\"\"Class representing a running poly1305 computation.\"\"\"\n+    MODULUS = 2**130 - 5\n+\n+    def __init__(self, key):\n+        self.r = int.from_bytes(key[:16], 'little') & 0xffffffc0ffffffc0ffffffc0fffffff\n+        self.s = int.from_bytes(key[16:], 'little')\n+        self.acc = 0\n+        self.msg = b\"\"\n+\n+    def add(self, msg):\n+        \"\"\"Add a message of any length.\"\"\"\n+        self.msg += msg\n+        return self\n+\n+    def tag(self):\n+        \"\"\"Compute the poly1305 tag.\"\"\"\n+        length = len(self.msg)\n+        for i in range((length + 15) // 16):\n+            chunk = self.msg[i * 16:i * 16 + min(16, length - i * 16)]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1320993882",
      "id" : 1320993882,
      "in_reply_to_id" : 1320856328,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585OvMRa",
      "original_commit_id" : "95c778263f168bd9faa3f9da21fd7b3a63bc8334",
      "original_line" : 28,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/crypto/poly1305.py",
      "position" : null,
      "pull_request_review_id" : 1619123290,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320993882/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-11T04:57:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320993882",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/44024636?v=4",
         "events_url" : "https://api.github.com/users/stratospher/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stratospher/followers",
         "following_url" : "https://api.github.com/users/stratospher/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stratospher/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stratospher",
         "id" : 44024636,
         "login" : "stratospher",
         "node_id" : "MDQ6VXNlcjQ0MDI0NjM2",
         "organizations_url" : "https://api.github.com/users/stratospher/orgs",
         "received_events_url" : "https://api.github.com/users/stratospher/received_events",
         "repos_url" : "https://api.github.com/users/stratospher/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stratospher/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stratospher/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stratospher"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1321324376"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1321324376"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit:\r\n```suggestion\r\n```\r\nThis doesn't need to be a member variable anymore, could use a local variable `acc` in the `tag` method instead.\r\n\r\nThinking this further, the implementation could even be completely stateless now (as the padding has to be done by the caller anyways), only consisting of a single `poly1305_tag` function. The call-sites would then change from e.g.\r\n```\r\ntag = Poly1305(mykey).add(mymsg_1).add(mymsg_2).add(mymsg_3).tag()\r\n```\r\nto\r\n```\r\ntag = poly1305_tag(key=mykey, msg=mymsg_1+mymsg_2+mymsg_3)\r\n```",
      "commit_id" : "0e6a6ecb7c76d46549078bf8b3d3530364393f6a",
      "created_at" : "2023-09-11T10:18:58Z",
      "diff_hunk" : "@@ -0,0 +1,109 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test-only implementation of Poly1305 authenticator\n+\n+It is designed for ease of understanding, not performance.\n+\n+WARNING: This code is slow and trivially vulnerable to side channel attacks. Do not use for\n+anything but tests.\n+\"\"\"\n+\n+import unittest\n+\n+class Poly1305:\n+    \"\"\"Class representing a running poly1305 computation.\"\"\"\n+    MODULUS = 2**130 - 5\n+\n+    def __init__(self, key):\n+        self.r = int.from_bytes(key[:16], 'little') & 0xffffffc0ffffffc0ffffffc0fffffff\n+        self.s = int.from_bytes(key[16:], 'little')\n+        self.acc = 0",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1321324376",
      "id" : 1321324376,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Owc9Y",
      "original_commit_id" : "f983a0a0c33c50220228cc28772fff3cbe331910",
      "original_line" : 23,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/crypto/poly1305.py",
      "position" : null,
      "pull_request_review_id" : 1619643241,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1321324376/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-11T10:29:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1321324376",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1321332887"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1321332887"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: I think all member variables are not meant to be accessed from the outside and could hence be prefixed with `_` (same for the `get_key_stream_bytes` method).\r\n```suggestion\r\n        self._key = initial_key\r\n        self._rekey_interval = rekey_interval\r\n        self._block_counter = 0\r\n        self._chunk_counter = 0\r\n        self._keystream = b''\r\n```",
      "commit_id" : "0e6a6ecb7c76d46549078bf8b3d3530364393f6a",
      "created_at" : "2023-09-11T10:27:17Z",
      "diff_hunk" : "@@ -62,6 +64,34 @@ def chacha20_block(key, nonce, cnt):\n     # Produce byte output\n     return b''.join(state[i].to_bytes(4, 'little') for i in range(16))\n \n+class FSChaCha20:\n+    \"\"\"Rekeying wrapper stream cipher around ChaCha20.\"\"\"\n+    def __init__(self, initial_key, rekey_interval=REKEY_INTERVAL):\n+        self._key = initial_key\n+        self.rekey_interval = rekey_interval\n+        self.block_counter = 0\n+        self.chunk_counter = 0\n+        self.keystream = b''",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1321332887",
      "id" : 1321332887,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585OwfCX",
      "original_commit_id" : "4c1ab93806ae6a648afa34685701e27f338aa8a2",
      "original_line" : 74,
      "original_position" : 29,
      "original_start_line" : 70,
      "path" : "test/functional/test_framework/crypto/chacha20.py",
      "position" : null,
      "pull_request_review_id" : 1619643241,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1321332887/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-09-11T10:29:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1321332887",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1322381329"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322381329"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "are private functions prefixed with single `_` too? i think i've only come across private functions prefixed with double `_`. so used that here.",
      "commit_id" : "0e6a6ecb7c76d46549078bf8b3d3530364393f6a",
      "created_at" : "2023-09-12T04:53:44Z",
      "diff_hunk" : "@@ -62,6 +64,34 @@ def chacha20_block(key, nonce, cnt):\n     # Produce byte output\n     return b''.join(state[i].to_bytes(4, 'little') for i in range(16))\n \n+class FSChaCha20:\n+    \"\"\"Rekeying wrapper stream cipher around ChaCha20.\"\"\"\n+    def __init__(self, initial_key, rekey_interval=REKEY_INTERVAL):\n+        self._key = initial_key\n+        self.rekey_interval = rekey_interval\n+        self.block_counter = 0\n+        self.chunk_counter = 0\n+        self.keystream = b''",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1322381329",
      "id" : 1322381329,
      "in_reply_to_id" : 1321332887,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585O0fAR",
      "original_commit_id" : "4c1ab93806ae6a648afa34685701e27f338aa8a2",
      "original_line" : 74,
      "original_position" : 29,
      "original_start_line" : 70,
      "path" : "test/functional/test_framework/crypto/chacha20.py",
      "position" : null,
      "pull_request_review_id" : 1621244335,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322381329/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-09-12T05:20:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322381329",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/44024636?v=4",
         "events_url" : "https://api.github.com/users/stratospher/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stratospher/followers",
         "following_url" : "https://api.github.com/users/stratospher/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stratospher/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stratospher",
         "id" : 44024636,
         "login" : "stratospher",
         "node_id" : "MDQ6VXNlcjQ0MDI0NjM2",
         "organizations_url" : "https://api.github.com/users/stratospher/orgs",
         "received_events_url" : "https://api.github.com/users/stratospher/received_events",
         "repos_url" : "https://api.github.com/users/stratospher/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stratospher/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stratospher/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stratospher"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1322399508"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322399508"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "true, made `acc` a local variable in the tag method and removed the `add` function. I kept the class format for Poly1305 since it maybe neater to have the interface.",
      "commit_id" : "0e6a6ecb7c76d46549078bf8b3d3530364393f6a",
      "created_at" : "2023-09-12T05:18:13Z",
      "diff_hunk" : "@@ -0,0 +1,109 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test-only implementation of Poly1305 authenticator\n+\n+It is designed for ease of understanding, not performance.\n+\n+WARNING: This code is slow and trivially vulnerable to side channel attacks. Do not use for\n+anything but tests.\n+\"\"\"\n+\n+import unittest\n+\n+class Poly1305:\n+    \"\"\"Class representing a running poly1305 computation.\"\"\"\n+    MODULUS = 2**130 - 5\n+\n+    def __init__(self, key):\n+        self.r = int.from_bytes(key[:16], 'little') & 0xffffffc0ffffffc0ffffffc0fffffff\n+        self.s = int.from_bytes(key[16:], 'little')\n+        self.acc = 0",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1322399508",
      "id" : 1322399508,
      "in_reply_to_id" : 1321324376,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585O0jcU",
      "original_commit_id" : "f983a0a0c33c50220228cc28772fff3cbe331910",
      "original_line" : 23,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/crypto/poly1305.py",
      "position" : null,
      "pull_request_review_id" : 1621263770,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322399508/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-12T05:18:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322399508",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/44024636?v=4",
         "events_url" : "https://api.github.com/users/stratospher/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stratospher/followers",
         "following_url" : "https://api.github.com/users/stratospher/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stratospher/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stratospher",
         "id" : 44024636,
         "login" : "stratospher",
         "node_id" : "MDQ6VXNlcjQ0MDI0NjM2",
         "organizations_url" : "https://api.github.com/users/stratospher/orgs",
         "received_events_url" : "https://api.github.com/users/stratospher/received_events",
         "repos_url" : "https://api.github.com/users/stratospher/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stratospher/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stratospher/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stratospher"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1322842863"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322842863"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> are private functions prefixed with single _ too?\r\n\r\nI think so, at least that's what we also do for some tests and in the framework, see e.g ```$ git grep \"def _[a-zA-Z]\" ./test``` versus ```$ git grep \"def __[a-zA-Z]\" ./test``` (the latter yields results in the `__foobar__` form for special operations like declaring ctors, dtors, operator overloading etc.). Using two underscores seems to be more than only a convention, triggering name mangling: https://stackoverflow.com/a/1301369",
      "commit_id" : "0e6a6ecb7c76d46549078bf8b3d3530364393f6a",
      "created_at" : "2023-09-12T10:33:25Z",
      "diff_hunk" : "@@ -62,6 +64,34 @@ def chacha20_block(key, nonce, cnt):\n     # Produce byte output\n     return b''.join(state[i].to_bytes(4, 'little') for i in range(16))\n \n+class FSChaCha20:\n+    \"\"\"Rekeying wrapper stream cipher around ChaCha20.\"\"\"\n+    def __init__(self, initial_key, rekey_interval=REKEY_INTERVAL):\n+        self._key = initial_key\n+        self.rekey_interval = rekey_interval\n+        self.block_counter = 0\n+        self.chunk_counter = 0\n+        self.keystream = b''",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1322842863",
      "id" : 1322842863,
      "in_reply_to_id" : 1321332887,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585O2Prv",
      "original_commit_id" : "4c1ab93806ae6a648afa34685701e27f338aa8a2",
      "original_line" : 74,
      "original_position" : 29,
      "original_start_line" : 70,
      "path" : "test/functional/test_framework/crypto/chacha20.py",
      "position" : null,
      "pull_request_review_id" : 1621933334,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322842863/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-09-12T10:33:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322842863",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1323160986"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1323160986"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "interesting! done.",
      "commit_id" : "a10a9b1cadea0a5465573ff5fcac38b1cd3a9864",
      "created_at" : "2023-09-12T14:47:17Z",
      "diff_hunk" : "@@ -62,6 +64,34 @@ def chacha20_block(key, nonce, cnt):\n     # Produce byte output\n     return b''.join(state[i].to_bytes(4, 'little') for i in range(16))\n \n+class FSChaCha20:\n+    \"\"\"Rekeying wrapper stream cipher around ChaCha20.\"\"\"\n+    def __init__(self, initial_key, rekey_interval=REKEY_INTERVAL):\n+        self._key = initial_key\n+        self.rekey_interval = rekey_interval\n+        self.block_counter = 0\n+        self.chunk_counter = 0\n+        self.keystream = b''",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1323160986",
      "id" : 1323160986,
      "in_reply_to_id" : 1321332887,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585O3dWa",
      "original_commit_id" : "4c1ab93806ae6a648afa34685701e27f338aa8a2",
      "original_line" : 74,
      "original_position" : 29,
      "original_start_line" : 70,
      "path" : "test/functional/test_framework/crypto/chacha20.py",
      "position" : null,
      "pull_request_review_id" : 1622442070,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1323160986/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-09-12T14:47:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1323160986",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/44024636?v=4",
         "events_url" : "https://api.github.com/users/stratospher/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stratospher/followers",
         "following_url" : "https://api.github.com/users/stratospher/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stratospher/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stratospher",
         "id" : 44024636,
         "login" : "stratospher",
         "node_id" : "MDQ6VXNlcjQ0MDI0NjM2",
         "organizations_url" : "https://api.github.com/users/stratospher/orgs",
         "received_events_url" : "https://api.github.com/users/stratospher/received_events",
         "repos_url" : "https://api.github.com/users/stratospher/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stratospher/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stratospher/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stratospher"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1331462481"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1331462481"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In b8facb385234ae7a2b69d6cadbb7d795f3c9c6f0: non-blocker, just an idea to simplify it:\r\n```diff\r\ndiff --git a/test/functional/test_framework/crypto/chach\r\na20.py b/test/functional/test_framework/crypto/chacha20.\r\npy\r\nindex b45acd6463..de4d898921 100644\r\n--- a/test/functional/test_framework/crypto/chacha20.py\r\n+++ b/test/functional/test_framework/crypto/chacha20.py\r\n@@ -48,14 +48,11 @@ def chacha20_block(key, nonce, cnt):\r\n     Takes as input a 32-byte key, 12-byte nonce, and 32-bit integer counter.\r\n     \"\"\"\r\n     # Initial state.\r\n-    init = [0 for _ in range(16)]\r\n-    for i in range(4):\r\n-        init[i] = CHACHA20_CONSTANTS[i]\r\n-    for i in range(8):\r\n-        init[4 + i] = int.from_bytes(key[4 * i:4 * (i+1)], 'little')\r\n-    init[12] = cnt\r\n-    for i in range(3):\r\n-        init[13 + i] = int.from_bytes(nonce[4 * i:4 * (i+1)], 'little')\r\n+    init = [0] * 16\r\n+    state[:4] = CHACHA20_CONSTANTS[:4]\r\n+    state[4:12] = [int.from_bytes(key[i:i+4], 'little') for i in range(0, 32, 4)]\r\n+    state[12] = cnt\r\n+    state[13:16] = [int.from_bytes(nonce[i:i+4], 'little') for i in range(0, 12, 4)]\r\n     # Perform 20 rounds.\r\n     state = list(init)\r\n     for _ in range(10):\r\n```",
      "commit_id" : "a10a9b1cadea0a5465573ff5fcac38b1cd3a9864",
      "created_at" : "2023-09-20T11:02:25Z",
      "diff_hunk" : "@@ -0,0 +1,113 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test-only implementation of ChaCha20 cipher\n+\n+It is designed for ease of understanding, not performance.\n+\n+WARNING: This code is slow and trivially vulnerable to side channel attacks. Do not use for\n+anything but tests.\n+\"\"\"\n+\n+import unittest\n+\n+CHACHA20_INDICES = (\n+    (0, 4, 8, 12), (1, 5, 9, 13), (2, 6, 10, 14), (3, 7, 11, 15),\n+    (0, 5, 10, 15), (1, 6, 11, 12), (2, 7, 8, 13), (3, 4, 9, 14)\n+)\n+\n+CHACHA20_CONSTANTS = (0x61707865, 0x3320646e, 0x79622d32, 0x6b206574)\n+\n+\n+def rotl32(v, bits):\n+    \"\"\"Rotate the 32-bit value v left by bits bits.\"\"\"\n+    bits %= 32  # Make sure the term below does not throw an exception\n+    return ((v << bits) & 0xffffffff) | (v >> (32 - bits))\n+\n+\n+def chacha20_doubleround(s):\n+    \"\"\"Apply a ChaCha20 double round to 16-element state array s.\n+    See https://cr.yp.to/chacha/chacha-20080128.pdf and https://tools.ietf.org/html/rfc8439\n+    \"\"\"\n+    for a, b, c, d in CHACHA20_INDICES:\n+        s[a] = (s[a] + s[b]) & 0xffffffff\n+        s[d] = rotl32(s[d] ^ s[a], 16)\n+        s[c] = (s[c] + s[d]) & 0xffffffff\n+        s[b] = rotl32(s[b] ^ s[c], 12)\n+        s[a] = (s[a] + s[b]) & 0xffffffff\n+        s[d] = rotl32(s[d] ^ s[a], 8)\n+        s[c] = (s[c] + s[d]) & 0xffffffff\n+        s[b] = rotl32(s[b] ^ s[c], 7)\n+\n+\n+def chacha20_block(key, nonce, cnt):\n+    \"\"\"Compute the 64-byte output of the ChaCha20 block function.\n+    Takes as input a 32-byte key, 12-byte nonce, and 32-bit integer counter.\n+    \"\"\"\n+    # Initial state.\n+    init = [0 for _ in range(16)]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1331462481",
      "id" : 1331462481,
      "line" : 51,
      "node_id" : "PRRC_kwDOABII585PXIFR",
      "original_commit_id" : "b8facb385234ae7a2b69d6cadbb7d795f3c9c6f0",
      "original_line" : 50,
      "original_position" : 50,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/crypto/chacha20.py",
      "position" : 51,
      "pull_request_review_id" : 1635372182,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1331462481/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-20T11:02:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1331462481",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1341308446"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341308446"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done.",
      "commit_id" : "c534c0871038ded72dc9078cc91e030ceb746196",
      "created_at" : "2023-09-29T12:31:48Z",
      "diff_hunk" : "@@ -0,0 +1,113 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test-only implementation of ChaCha20 cipher\n+\n+It is designed for ease of understanding, not performance.\n+\n+WARNING: This code is slow and trivially vulnerable to side channel attacks. Do not use for\n+anything but tests.\n+\"\"\"\n+\n+import unittest\n+\n+CHACHA20_INDICES = (\n+    (0, 4, 8, 12), (1, 5, 9, 13), (2, 6, 10, 14), (3, 7, 11, 15),\n+    (0, 5, 10, 15), (1, 6, 11, 12), (2, 7, 8, 13), (3, 4, 9, 14)\n+)\n+\n+CHACHA20_CONSTANTS = (0x61707865, 0x3320646e, 0x79622d32, 0x6b206574)\n+\n+\n+def rotl32(v, bits):\n+    \"\"\"Rotate the 32-bit value v left by bits bits.\"\"\"\n+    bits %= 32  # Make sure the term below does not throw an exception\n+    return ((v << bits) & 0xffffffff) | (v >> (32 - bits))\n+\n+\n+def chacha20_doubleround(s):\n+    \"\"\"Apply a ChaCha20 double round to 16-element state array s.\n+    See https://cr.yp.to/chacha/chacha-20080128.pdf and https://tools.ietf.org/html/rfc8439\n+    \"\"\"\n+    for a, b, c, d in CHACHA20_INDICES:\n+        s[a] = (s[a] + s[b]) & 0xffffffff\n+        s[d] = rotl32(s[d] ^ s[a], 16)\n+        s[c] = (s[c] + s[d]) & 0xffffffff\n+        s[b] = rotl32(s[b] ^ s[c], 12)\n+        s[a] = (s[a] + s[b]) & 0xffffffff\n+        s[d] = rotl32(s[d] ^ s[a], 8)\n+        s[c] = (s[c] + s[d]) & 0xffffffff\n+        s[b] = rotl32(s[b] ^ s[c], 7)\n+\n+\n+def chacha20_block(key, nonce, cnt):\n+    \"\"\"Compute the 64-byte output of the ChaCha20 block function.\n+    Takes as input a 32-byte key, 12-byte nonce, and 32-bit integer counter.\n+    \"\"\"\n+    # Initial state.\n+    init = [0 for _ in range(16)]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1341308446",
      "id" : 1341308446,
      "in_reply_to_id" : 1331462481,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585P8r4e",
      "original_commit_id" : "b8facb385234ae7a2b69d6cadbb7d795f3c9c6f0",
      "original_line" : 50,
      "original_position" : 50,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/crypto/chacha20.py",
      "position" : null,
      "pull_request_review_id" : 1650687031,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341308446/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-29T12:31:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341308446",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/44024636?v=4",
         "events_url" : "https://api.github.com/users/stratospher/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stratospher/followers",
         "following_url" : "https://api.github.com/users/stratospher/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stratospher/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stratospher",
         "id" : 44024636,
         "login" : "stratospher",
         "node_id" : "MDQ6VXNlcjQ0MDI0NjM2",
         "organizations_url" : "https://api.github.com/users/stratospher/orgs",
         "received_events_url" : "https://api.github.com/users/stratospher/received_events",
         "repos_url" : "https://api.github.com/users/stratospher/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stratospher/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stratospher/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stratospher"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "cc @real-or-random ",
      "created_at" : "2023-10-02T09:27:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#issuecomment-1742687069",
      "id" : 1742687069,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28374",
      "node_id" : "IC_kwDOABII585n30td",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1742687069/reactions"
      },
      "updated_at" : "2023-10-02T09:27:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1742687069",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK c534c0871038ded72dc9078cc91e030ceb746196",
      "created_at" : "2023-11-07T13:27:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#issuecomment-1798520540",
      "id" : 1798520540,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28374",
      "node_id" : "IC_kwDOABII585rMz7c",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1798520540/reactions"
      },
      "updated_at" : "2023-11-07T13:27:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1798520540",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK c534c0871038ded72dc9078cc91e030ceb746196",
      "created_at" : "2023-11-07T21:43:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#issuecomment-1800222458",
      "id" : 1800222458,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28374",
      "node_id" : "IC_kwDOABII585rTTb6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1800222458/reactions"
      },
      "updated_at" : "2023-11-07T21:43:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1800222458",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   }
]
