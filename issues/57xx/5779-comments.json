[
   {
      "body" : "I believe we should have per-layer flags.\r\n\r\nThat means making the flags exported by libconsensus separate from the ones in the internal implementations, and libconsensus translates them as necessary. That both means implementation detals don't leak out (visibly or invisibly).\r\n\r\nI also don't think libconsensus should be implementing any standardness checks. They're policy, and not part of libconsensus' goal (which is to be policy neutral, and just provide the one thing that is too risky to reimplement).",
      "created_at" : "2015-02-09T23:55:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5779#issuecomment-73617238",
      "id" : 73617238,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5779",
      "updated_at" : "2015-02-09T23:55:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/73617238",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Agree with @sipa",
      "created_at" : "2015-02-09T23:56:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5779#issuecomment-73617362",
      "id" : 73617362,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5779",
      "updated_at" : "2015-02-09T23:56:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/73617362",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "@sipa let's take the scenario I laid out as an example. Say there are 2 versions of libbitcoinconsensus in the wild, one that includes VERIFY_DERSIG externally and one that doesn't (regardless of whether it's a 1:1 flag mapping or not). Dev builds a program against the new version with the flag and releases it. user runs against the older version of the lib without the flag.\r\n\r\nIf I'm understanding correctly, it sounds as though you want an actual mapping function that's hit before feeding the flags into VerifyScript(), so that the passed-in flags are never used directly?\r\n\r\nIn this case, what would happen for the user? The map function sees a VERIFY_DERSIG which is not exposed externally. Does it simply immediately fail?",
      "created_at" : "2015-02-10T00:10:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5779#issuecomment-73619024",
      "id" : 73619024,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5779",
      "updated_at" : "2015-02-10T00:10:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/73619024",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "That's why there is a version number, no, to see whether the library is what they expect to be?\r\n\r\nA possibility is providing a function which takes a bunch of flags, and tells you whether they're all supported. Using an unknown flag is undefined.",
      "created_at" : "2015-02-10T00:11:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5779#issuecomment-73619201",
      "id" : 73619201,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5779",
      "updated_at" : "2015-02-10T00:11:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/73619201",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Yes, the version number could be used I suppose.\r\n\r\nUltimately what scares me is the possibility of a flag being silently eaten and ignored. A flag checker as you suggest would certainly help, though.",
      "created_at" : "2015-02-10T00:21:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5779#issuecomment-73620257",
      "id" : 73620257,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5779",
      "updated_at" : "2015-02-10T00:21:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/73620257",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "If any unrecongised flags are passed, maybe we should abort()",
      "created_at" : "2015-02-10T00:33:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5779#issuecomment-73621599",
      "id" : 73621599,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5779",
      "updated_at" : "2015-02-10T00:33:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/73621599",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   }
]
