[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [RandyMcMillan](https://github.com/bitcoin/bitcoin/pull/27622#issuecomment-1593496143) |\n| Approach ACK | [glozow](https://github.com/bitcoin/bitcoin/pull/27622#pullrequestreview-1434616046) |\n| Stale ACK | [willcl-ark](https://github.com/bitcoin/bitcoin/pull/27622#pullrequestreview-1471390869), [instagibbs](https://github.com/bitcoin/bitcoin/pull/27622#issuecomment-1584534491), [pinheadmz](https://github.com/bitcoin/bitcoin/pull/27622#pullrequestreview-1477862322) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#27859](https://github.com/bitcoin/bitcoin/pull/27859) (Mempool: persist mempoolminfee accross restarts by ismaelsadeeq)\n* [#25380](https://github.com/bitcoin/bitcoin/pull/25380) (Detect and ignore transactions that were CPFP'd in the fee estimator by darosior)\n* [#10443](https://github.com/bitcoin/bitcoin/pull/10443) (Add fee_est tool for debugging fee estimation code by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-05-10T22:17:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#issuecomment-1542881490",
      "id" : 1542881490,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27622",
      "node_id" : "IC_kwDOABII585b9oDS",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1542881490/reactions"
      },
      "updated_at" : "2023-06-15T17:49:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1542881490",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "cc @instagibbs @TheBlueMatt ",
      "created_at" : "2023-05-11T09:27:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#issuecomment-1543653619",
      "id" : 1543653619,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27622",
      "node_id" : "IC_kwDOABII585cAkjz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1543653619/reactions"
      },
      "updated_at" : "2023-05-11T09:27:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1543653619",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1191301314"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191301314"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think it's a bit strange for policy/fees to have a dependency on scheduler. Maybe register `FlushFeeEstimates()` with the scheduler within `AppInitMain()` instead?",
      "commit_id" : "a2ad5e475f318552c50bcc8bb966c4841d7ef8b4",
      "created_at" : "2023-05-11T14:51:02Z",
      "diff_hunk" : "@@ -12,6 +12,7 @@\n #include <policy/feerate.h>\n #include <primitives/transaction.h>\n #include <random.h>\n+#include <scheduler.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1191301314",
      "id" : 1191301314,
      "line" : 15,
      "node_id" : "PRRC_kwDOABII585HAdDC",
      "original_commit_id" : "a2ad5e475f318552c50bcc8bb966c4841d7ef8b4",
      "original_line" : 15,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : 4,
      "pull_request_review_id" : 1422800079,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191301314/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-11T14:52:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191301314",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1191350003"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191350003"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit (feel free to ignore): An alternative to adding a function here would be to call the already existing `Ticks<std::chrono::hours>(a)` over `count_hours(a)`, but either seems fine.",
      "commit_id" : "a2ad5e475f318552c50bcc8bb966c4841d7ef8b4",
      "created_at" : "2023-05-11T15:24:51Z",
      "diff_hunk" : "@@ -53,6 +53,7 @@ constexpr auto TicksSinceEpoch(Timepoint t)\n {\n     return Ticks<Duration>(t.time_since_epoch());\n }\n+constexpr int64_t count_hours(std::chrono::hours t) { return t.count(); }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1191350003",
      "id" : 1191350003,
      "line" : 56,
      "node_id" : "PRRC_kwDOABII585HAo7z",
      "original_commit_id" : "a2ad5e475f318552c50bcc8bb966c4841d7ef8b4",
      "original_line" : 56,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/util/time.h",
      "position" : 4,
      "pull_request_review_id" : 1422877741,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191350003/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-11T15:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191350003",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1191352778"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191352778"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: \r\n\r\n```suggestion\r\n        fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\r\n```",
      "commit_id" : "a2ad5e475f318552c50bcc8bb966c4841d7ef8b4",
      "created_at" : "2023-05-11T15:26:52Z",
      "diff_hunk" : "@@ -290,6 +291,38 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.stop_node(0)\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"feerate\"], fee_rate)\n+\n+        fee_dat = os.path.join(self.nodes[0].datadir, self.chain, \"fee_estimates.dat\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1191352778",
      "id" : 1191352778,
      "line" : 303,
      "node_id" : "PRRC_kwDOABII585HApnK",
      "original_commit_id" : "a2ad5e475f318552c50bcc8bb966c4841d7ef8b4",
      "original_line" : 303,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : 21,
      "pull_request_review_id" : 1422877741,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191352778/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-11T15:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191352778",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1191357213"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191357213"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: I am not a fan of uninterruptible sleep in tests. `assert_debug_log` can be used to wait, if you supply a timeout argument (or rely on the default timeout)",
      "commit_id" : "a2ad5e475f318552c50bcc8bb966c4841d7ef8b4",
      "created_at" : "2023-05-11T15:30:12Z",
      "diff_hunk" : "@@ -290,6 +291,38 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.stop_node(0)\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"feerate\"], fee_rate)\n+\n+        fee_dat = os.path.join(self.nodes[0].datadir, self.chain, \"fee_estimates.dat\")\n+\n+        # Stop the node and backdate the fee_estimates.dat file for 13 hours\n+        self.stop_node(0)\n+        hour = 60 * 60\n+        last_modified_time = time.time() - 13 * hour\n+        os.utime(fee_dat, (last_modified_time, last_modified_time))\n+\n+        # Start node and ensure the fee_estimates.dat file was not read\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"errors\"], [\"Insufficient data or no feerate found\"])\n+\n+\n+    def test_estimate_dat_is_flushed_periodically(self):\n+            # Check if the string \"Flushed fee estimates to fee_estimates.dat.\" is present in the debug log file.\n+            # If it is, it indicates that fee estimates have been successfully flushed to disk.\n+            with self.nodes[0].assert_debug_log(expected_msgs=[\"Flushed fee estimates to fee_estimates.dat.\"]):\n+                # Mock the scheduler for an hour, sleep for a short period to allow the flush to finish\n+                hour = 3600\n+                self.nodes[0].mockscheduler(hour)\n+                time.sleep(1)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1191357213",
      "id" : 1191357213,
      "line" : 323,
      "node_id" : "PRRC_kwDOABII585HAqsd",
      "original_commit_id" : "a2ad5e475f318552c50bcc8bb966c4841d7ef8b4",
      "original_line" : 323,
      "original_position" : 41,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : 41,
      "pull_request_review_id" : 1422877741,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191357213/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-11T15:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191357213",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1191566131"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191566131"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think you forgot to remove the sleep?",
      "commit_id" : "3a9fee21d261f3de560594e58de38641ace5cc34",
      "created_at" : "2023-05-11T18:48:12Z",
      "diff_hunk" : "@@ -290,6 +291,38 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.stop_node(0)\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"feerate\"], fee_rate)\n+\n+        fee_dat = os.path.join(self.nodes[0].datadir, self.chain, \"fee_estimates.dat\")\n+\n+        # Stop the node and backdate the fee_estimates.dat file for 13 hours\n+        self.stop_node(0)\n+        hour = 60 * 60\n+        last_modified_time = time.time() - 13 * hour\n+        os.utime(fee_dat, (last_modified_time, last_modified_time))\n+\n+        # Start node and ensure the fee_estimates.dat file was not read\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"errors\"], [\"Insufficient data or no feerate found\"])\n+\n+\n+    def test_estimate_dat_is_flushed_periodically(self):\n+            # Check if the string \"Flushed fee estimates to fee_estimates.dat.\" is present in the debug log file.\n+            # If it is, it indicates that fee estimates have been successfully flushed to disk.\n+            with self.nodes[0].assert_debug_log(expected_msgs=[\"Flushed fee estimates to fee_estimates.dat.\"]):\n+                # Mock the scheduler for an hour, sleep for a short period to allow the flush to finish\n+                hour = 3600\n+                self.nodes[0].mockscheduler(hour)\n+                time.sleep(1)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1191566131",
      "id" : 1191566131,
      "in_reply_to_id" : 1191357213,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585HBdsz",
      "original_commit_id" : "a2ad5e475f318552c50bcc8bb966c4841d7ef8b4",
      "original_line" : 323,
      "original_position" : 41,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : null,
      "pull_request_review_id" : 1423228771,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191566131/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-11T18:48:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191566131",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1191573164"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191573164"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "My bad, thanks.",
      "commit_id" : "3a9fee21d261f3de560594e58de38641ace5cc34",
      "created_at" : "2023-05-11T18:53:27Z",
      "diff_hunk" : "@@ -290,6 +291,38 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.stop_node(0)\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"feerate\"], fee_rate)\n+\n+        fee_dat = os.path.join(self.nodes[0].datadir, self.chain, \"fee_estimates.dat\")\n+\n+        # Stop the node and backdate the fee_estimates.dat file for 13 hours\n+        self.stop_node(0)\n+        hour = 60 * 60\n+        last_modified_time = time.time() - 13 * hour\n+        os.utime(fee_dat, (last_modified_time, last_modified_time))\n+\n+        # Start node and ensure the fee_estimates.dat file was not read\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"errors\"], [\"Insufficient data or no feerate found\"])\n+\n+\n+    def test_estimate_dat_is_flushed_periodically(self):\n+            # Check if the string \"Flushed fee estimates to fee_estimates.dat.\" is present in the debug log file.\n+            # If it is, it indicates that fee estimates have been successfully flushed to disk.\n+            with self.nodes[0].assert_debug_log(expected_msgs=[\"Flushed fee estimates to fee_estimates.dat.\"]):\n+                # Mock the scheduler for an hour, sleep for a short period to allow the flush to finish\n+                hour = 3600\n+                self.nodes[0].mockscheduler(hour)\n+                time.sleep(1)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1191573164",
      "id" : 1191573164,
      "in_reply_to_id" : 1191357213,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585HBfas",
      "original_commit_id" : "a2ad5e475f318552c50bcc8bb966c4841d7ef8b4",
      "original_line" : 323,
      "original_position" : 41,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : null,
      "pull_request_review_id" : 1423241416,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191573164/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-11T18:53:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191573164",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1191578999"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191578999"
         }
      },
      "author_association" : "MEMBER",
      "body" : "s/FLUSH_INTERVAL/FEE_FLUSH_INTERVAL/ ?",
      "commit_id" : "3a9fee21d261f3de560594e58de38641ace5cc34",
      "created_at" : "2023-05-11T18:59:16Z",
      "diff_hunk" : "@@ -14,12 +14,17 @@\n #include <util/fs.h>\n \n #include <array>\n+#include <chrono>\n #include <map>\n #include <memory>\n #include <set>\n #include <string>\n #include <vector>\n \n+\n+// How often to flush fee estimates to fee_estimates.dat.\n+static constexpr std::chrono::milliseconds FLUSH_INTERVAL{std::chrono::hours{1}};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1191578999",
      "id" : 1191578999,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585HBg13",
      "original_commit_id" : "0d2329aecaa39f328fec84f63f0bebf31e49b070",
      "original_line" : 26,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : null,
      "pull_request_review_id" : 1423253142,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191578999/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-11T18:59:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191578999",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1191584552"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191584552"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "FEE_FLUSH_INTERVAL is better.\r\nI think.\r\n",
      "commit_id" : "3a9fee21d261f3de560594e58de38641ace5cc34",
      "created_at" : "2023-05-11T19:05:37Z",
      "diff_hunk" : "@@ -14,12 +14,17 @@\n #include <util/fs.h>\n \n #include <array>\n+#include <chrono>\n #include <map>\n #include <memory>\n #include <set>\n #include <string>\n #include <vector>\n \n+\n+// How often to flush fee estimates to fee_estimates.dat.\n+static constexpr std::chrono::milliseconds FLUSH_INTERVAL{std::chrono::hours{1}};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1191584552",
      "id" : 1191584552,
      "in_reply_to_id" : 1191578999,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585HBiMo",
      "original_commit_id" : "0d2329aecaa39f328fec84f63f0bebf31e49b070",
      "original_line" : 26,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : null,
      "pull_request_review_id" : 1423262115,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191584552/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-11T19:05:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191584552",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1191715247"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191715247"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Sure :+1: , fixed. ",
      "commit_id" : "3a9fee21d261f3de560594e58de38641ace5cc34",
      "created_at" : "2023-05-11T21:42:02Z",
      "diff_hunk" : "@@ -12,6 +12,7 @@\n #include <policy/feerate.h>\n #include <primitives/transaction.h>\n #include <random.h>\n+#include <scheduler.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1191715247",
      "id" : 1191715247,
      "in_reply_to_id" : 1191301314,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585HCCGv",
      "original_commit_id" : "a2ad5e475f318552c50bcc8bb966c4841d7ef8b4",
      "original_line" : 15,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 1423475651,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191715247/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-11T21:42:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1191715247",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1196990851"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1196990851"
         }
      },
      "author_association" : "MEMBER",
      "body" : "this log line fires even if it actually failed?",
      "commit_id" : "3a9fee21d261f3de560594e58de38641ace5cc34",
      "created_at" : "2023-05-17T19:55:26Z",
      "diff_hunk" : "@@ -903,11 +904,15 @@ CFeeRate CBlockPolicyEstimator::estimateSmartFee(int confTarget, FeeCalculation\n \n void CBlockPolicyEstimator::Flush() {\n     FlushUnconfirmed();\n+    FlushFeeEstimates();\n+}\n \n+void CBlockPolicyEstimator::FlushFeeEstimates() {\n     AutoFile est_file{fsbridge::fopen(m_estimation_filepath, \"wb\")};\n     if (est_file.IsNull() || !Write(est_file)) {\n         LogPrintf(\"Failed to write fee estimates to %s. Continue anyway.\\n\", fs::PathToString(m_estimation_filepath));\n     }\n+    LogPrintf(\"Flushed fee estimates to fee_estimates.dat.\\n\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1196990851",
      "id" : 1196990851,
      "line" : 929,
      "node_id" : "PRRC_kwDOABII585HWKGD",
      "original_commit_id" : "bbb0750bd8bd9dcc8f169f0df7e1351c9da698c9",
      "original_line" : 929,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : 46,
      "pull_request_review_id" : 1431475355,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1196990851/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-17T20:00:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1196990851",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1196993686"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1196993686"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Seems ok, but would have to think about this more. I'd be ok with longer too, to start.",
      "commit_id" : "3a9fee21d261f3de560594e58de38641ace5cc34",
      "created_at" : "2023-05-17T19:58:40Z",
      "diff_hunk" : "@@ -186,6 +186,10 @@ class CBlockPolicyEstimator\n     static constexpr double FEE_SPACING = 1.05;\n \n     const fs::path m_estimation_filepath;\n+\n+    /** Fee estimate.dat must not be more than 12 hours old. */\n+    static constexpr std::chrono::hours MAX_FILE_AGE{12};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1196993686",
      "id" : 1196993686,
      "line" : 191,
      "node_id" : "PRRC_kwDOABII585HWKyW",
      "original_commit_id" : "5a41661a118dc526780c006bdf09abcce92e24e5",
      "original_line" : 191,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : 24,
      "pull_request_review_id" : 1431475355,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1196993686/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-17T20:00:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1196993686",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1196995104"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1196995104"
         }
      },
      "author_association" : "MEMBER",
      "body" : "checking for log is good, but checking it was actually written is better in case there's a bug in the logging logic",
      "commit_id" : "3a9fee21d261f3de560594e58de38641ace5cc34",
      "created_at" : "2023-05-17T20:00:19Z",
      "diff_hunk" : "@@ -290,6 +291,37 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.stop_node(0)\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"feerate\"], fee_rate)\n+\n+        fee_dat = fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+\n+        # Stop the node and backdate the fee_estimates.dat file for 13 hours\n+        self.stop_node(0)\n+        hour = 60 * 60\n+        last_modified_time = time.time() - 13 * hour\n+        os.utime(fee_dat, (last_modified_time, last_modified_time))\n+\n+        # Start node and ensure the fee_estimates.dat file was not read\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"errors\"], [\"Insufficient data or no feerate found\"])\n+\n+\n+    def test_estimate_dat_is_flushed_periodically(self):\n+            # Check if the string \"Flushed fee estimates to fee_estimates.dat.\" is present in the debug log file.\n+            # If it is, it indicates that fee estimates have been successfully flushed to disk.\n+            with self.nodes[0].assert_debug_log(expected_msgs=[\"Flushed fee estimates to fee_estimates.dat.\"], timeout=1):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1196995104",
      "id" : 1196995104,
      "line" : 324,
      "node_id" : "PRRC_kwDOABII585HWLIg",
      "original_commit_id" : "aecd92e8e1ca8be8c76cc9621058614c893c47fc",
      "original_line" : 324,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : 42,
      "pull_request_review_id" : 1431475355,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1196995104/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-17T20:00:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1196995104",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1197686957"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197686957"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, fixed thank you.",
      "commit_id" : "3a9fee21d261f3de560594e58de38641ace5cc34",
      "created_at" : "2023-05-18T11:02:44Z",
      "diff_hunk" : "@@ -903,11 +904,15 @@ CFeeRate CBlockPolicyEstimator::estimateSmartFee(int confTarget, FeeCalculation\n \n void CBlockPolicyEstimator::Flush() {\n     FlushUnconfirmed();\n+    FlushFeeEstimates();\n+}\n \n+void CBlockPolicyEstimator::FlushFeeEstimates() {\n     AutoFile est_file{fsbridge::fopen(m_estimation_filepath, \"wb\")};\n     if (est_file.IsNull() || !Write(est_file)) {\n         LogPrintf(\"Failed to write fee estimates to %s. Continue anyway.\\n\", fs::PathToString(m_estimation_filepath));\n     }\n+    LogPrintf(\"Flushed fee estimates to fee_estimates.dat.\\n\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1197686957",
      "id" : 1197686957,
      "in_reply_to_id" : 1196990851,
      "line" : 929,
      "node_id" : "PRRC_kwDOABII585HY0Ct",
      "original_commit_id" : "bbb0750bd8bd9dcc8f169f0df7e1351c9da698c9",
      "original_line" : 929,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : 46,
      "pull_request_review_id" : 1432491514,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197686957/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-18T11:10:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197686957",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1197688535"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197688535"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes thanks for pointing this out, I added the check.",
      "commit_id" : "b02e3fc91f4214c486da0ff46e187fab017e11bb",
      "created_at" : "2023-05-18T11:04:48Z",
      "diff_hunk" : "@@ -290,6 +291,37 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.stop_node(0)\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"feerate\"], fee_rate)\n+\n+        fee_dat = fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+\n+        # Stop the node and backdate the fee_estimates.dat file for 13 hours\n+        self.stop_node(0)\n+        hour = 60 * 60\n+        last_modified_time = time.time() - 13 * hour\n+        os.utime(fee_dat, (last_modified_time, last_modified_time))\n+\n+        # Start node and ensure the fee_estimates.dat file was not read\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"errors\"], [\"Insufficient data or no feerate found\"])\n+\n+\n+    def test_estimate_dat_is_flushed_periodically(self):\n+            # Check if the string \"Flushed fee estimates to fee_estimates.dat.\" is present in the debug log file.\n+            # If it is, it indicates that fee estimates have been successfully flushed to disk.\n+            with self.nodes[0].assert_debug_log(expected_msgs=[\"Flushed fee estimates to fee_estimates.dat.\"], timeout=1):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1197688535",
      "id" : 1197688535,
      "in_reply_to_id" : 1196995104,
      "line" : 324,
      "node_id" : "PRRC_kwDOABII585HY0bX",
      "original_commit_id" : "aecd92e8e1ca8be8c76cc9621058614c893c47fc",
      "original_line" : 324,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : 42,
      "pull_request_review_id" : 1432491514,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197688535/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-18T13:16:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197688535",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1197693333"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197693333"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah, to enhance flexibility, I can create a follow-up PR to introduce a configuration variable for MAX_FILE_AGE,  This way users can specify the maximum age of estimates they do not want to accept?",
      "commit_id" : "3a9fee21d261f3de560594e58de38641ace5cc34",
      "created_at" : "2023-05-18T11:10:33Z",
      "diff_hunk" : "@@ -186,6 +186,10 @@ class CBlockPolicyEstimator\n     static constexpr double FEE_SPACING = 1.05;\n \n     const fs::path m_estimation_filepath;\n+\n+    /** Fee estimate.dat must not be more than 12 hours old. */\n+    static constexpr std::chrono::hours MAX_FILE_AGE{12};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1197693333",
      "id" : 1197693333,
      "in_reply_to_id" : 1196993686,
      "line" : 191,
      "node_id" : "PRRC_kwDOABII585HY1mV",
      "original_commit_id" : "5a41661a118dc526780c006bdf09abcce92e24e5",
      "original_line" : 191,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : 24,
      "pull_request_review_id" : 1432491514,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197693333/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-18T11:10:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197693333",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1198071636"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198071636"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Mine as well use this constant here for the filename?\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/6cc136bbd36f859a16e469bb5c016d06c19bcd50/src/policy/fees_args.cpp#L10",
      "commit_id" : "b02e3fc91f4214c486da0ff46e187fab017e11bb",
      "created_at" : "2023-05-18T17:09:37Z",
      "diff_hunk" : "@@ -903,11 +904,15 @@ CFeeRate CBlockPolicyEstimator::estimateSmartFee(int confTarget, FeeCalculation\n \n void CBlockPolicyEstimator::Flush() {\n     FlushUnconfirmed();\n+    FlushFeeEstimates();\n+}\n \n+void CBlockPolicyEstimator::FlushFeeEstimates() {\n     AutoFile est_file{fsbridge::fopen(m_estimation_filepath, \"wb\")};\n     if (est_file.IsNull() || !Write(est_file)) {\n         LogPrintf(\"Failed to write fee estimates to %s. Continue anyway.\\n\", fs::PathToString(m_estimation_filepath));\n     }\n+    LogPrintf(\"Flushed fee estimates to fee_estimates.dat.\\n\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1198071636",
      "id" : 1198071636,
      "in_reply_to_id" : 1196990851,
      "line" : 929,
      "node_id" : "PRRC_kwDOABII585HaR9U",
      "original_commit_id" : "bbb0750bd8bd9dcc8f169f0df7e1351c9da698c9",
      "original_line" : 929,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : 46,
      "pull_request_review_id" : 1433103480,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198071636/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-18T18:15:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198071636",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1198122182"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198122182"
         }
      },
      "author_association" : "MEMBER",
      "body" : "could also simplify a bit:\r\n\r\n```cpp\r\n    if (est_file.IsNull() || !Write(est_file))\r\n        LogPrintf(\"Failed to write fee estimates to %s. Continue anyway.\\n\", fs::PathToString(m_estimation_filepath));\r\n    else\r\n        LogPrintf(\"Flushed fee estimates to fee_estimates.dat.\\n\");\r\n```",
      "commit_id" : "b02e3fc91f4214c486da0ff46e187fab017e11bb",
      "created_at" : "2023-05-18T17:59:26Z",
      "diff_hunk" : "@@ -903,11 +904,16 @@ CFeeRate CBlockPolicyEstimator::estimateSmartFee(int confTarget, FeeCalculation\n \n void CBlockPolicyEstimator::Flush() {\n     FlushUnconfirmed();\n+    FlushFeeEstimates();\n+}\n \n+void CBlockPolicyEstimator::FlushFeeEstimates() {\n     AutoFile est_file{fsbridge::fopen(m_estimation_filepath, \"wb\")};\n     if (est_file.IsNull() || !Write(est_file)) {\n         LogPrintf(\"Failed to write fee estimates to %s. Continue anyway.\\n\", fs::PathToString(m_estimation_filepath));\n+        return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1198122182",
      "id" : 1198122182,
      "line" : 927,
      "node_id" : "PRRC_kwDOABII585HaeTG",
      "original_commit_id" : "4614a64bbffd5333cfd9fb78c6530d81c3856901",
      "original_line" : 914,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : 44,
      "pull_request_review_id" : 1433103480,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198122182/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-18T18:15:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198122182",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1198123417"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198123417"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't actually know for sure but couldn't this just be ...?\r\n\r\n```cpp\r\nstatic constexpr std::chrono::hours FEE_FLUSH_INTERVAL{1};\r\n```",
      "commit_id" : "b02e3fc91f4214c486da0ff46e187fab017e11bb",
      "created_at" : "2023-05-18T18:00:48Z",
      "diff_hunk" : "@@ -14,12 +14,17 @@\n #include <util/fs.h>\n \n #include <array>\n+#include <chrono>\n #include <map>\n #include <memory>\n #include <set>\n #include <string>\n #include <vector>\n \n+\n+// How often to flush fee estimates to fee_estimates.dat.\n+static constexpr std::chrono::milliseconds FEE_FLUSH_INTERVAL{std::chrono::hours{1}};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1198123417",
      "id" : 1198123417,
      "line" : 26,
      "node_id" : "PRRC_kwDOABII585HaemZ",
      "original_commit_id" : "4614a64bbffd5333cfd9fb78c6530d81c3856901",
      "original_line" : 26,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : 13,
      "pull_request_review_id" : 1433103480,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198123417/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-18T18:15:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198123417",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1198131760"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198131760"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think you can use `self.restart_node(0)` here",
      "commit_id" : "b02e3fc91f4214c486da0ff46e187fab017e11bb",
      "created_at" : "2023-05-18T18:09:46Z",
      "diff_hunk" : "@@ -290,6 +291,45 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.stop_node(0)\n+        self.start_node(0)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1198131760",
      "id" : 1198131760,
      "line" : 300,
      "node_id" : "PRRC_kwDOABII585Hagow",
      "original_commit_id" : "b02e3fc91f4214c486da0ff46e187fab017e11bb",
      "original_line" : 300,
      "original_position" : 18,
      "original_start_line" : 299,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : 18,
      "pull_request_review_id" : 1433103480,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198131760/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 299,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-05-18T18:15:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198131760",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1198150716"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198150716"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It could also be `constexpr auto FEE_FLUSH_INTERVAL{1h};`",
      "commit_id" : "b02e3fc91f4214c486da0ff46e187fab017e11bb",
      "created_at" : "2023-05-18T18:26:07Z",
      "diff_hunk" : "@@ -14,12 +14,17 @@\n #include <util/fs.h>\n \n #include <array>\n+#include <chrono>\n #include <map>\n #include <memory>\n #include <set>\n #include <string>\n #include <vector>\n \n+\n+// How often to flush fee estimates to fee_estimates.dat.\n+static constexpr std::chrono::milliseconds FEE_FLUSH_INTERVAL{std::chrono::hours{1}};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1198150716",
      "id" : 1198150716,
      "in_reply_to_id" : 1198123417,
      "line" : 26,
      "node_id" : "PRRC_kwDOABII585HalQ8",
      "original_commit_id" : "4614a64bbffd5333cfd9fb78c6530d81c3856901",
      "original_line" : 26,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : 13,
      "pull_request_review_id" : 1433238480,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198150716/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-18T18:26:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198150716",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1198355535"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198355535"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for your review, I have fixed it.",
      "commit_id" : "473946b05e911fca96a1ec077db19910819e8aed",
      "created_at" : "2023-05-18T22:16:00Z",
      "diff_hunk" : "@@ -903,11 +904,16 @@ CFeeRate CBlockPolicyEstimator::estimateSmartFee(int confTarget, FeeCalculation\n \n void CBlockPolicyEstimator::Flush() {\n     FlushUnconfirmed();\n+    FlushFeeEstimates();\n+}\n \n+void CBlockPolicyEstimator::FlushFeeEstimates() {\n     AutoFile est_file{fsbridge::fopen(m_estimation_filepath, \"wb\")};\n     if (est_file.IsNull() || !Write(est_file)) {\n         LogPrintf(\"Failed to write fee estimates to %s. Continue anyway.\\n\", fs::PathToString(m_estimation_filepath));\n+        return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1198355535",
      "id" : 1198355535,
      "in_reply_to_id" : 1198122182,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585HbXRP",
      "original_commit_id" : "4614a64bbffd5333cfd9fb78c6530d81c3856901",
      "original_line" : 914,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 1433525905,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198355535/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-18T22:16:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198355535",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1198379250"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198379250"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Still a nub on cpp,\r\n `constexpr auto FEE_FLUSH_INTERVAL{1h};`  does not compile\r\nI added instead `static constexpr std::chrono::hours FEE_FLUSH_INTERVAL{1};`",
      "commit_id" : "473946b05e911fca96a1ec077db19910819e8aed",
      "created_at" : "2023-05-18T23:02:36Z",
      "diff_hunk" : "@@ -14,12 +14,17 @@\n #include <util/fs.h>\n \n #include <array>\n+#include <chrono>\n #include <map>\n #include <memory>\n #include <set>\n #include <string>\n #include <vector>\n \n+\n+// How often to flush fee estimates to fee_estimates.dat.\n+static constexpr std::chrono::milliseconds FEE_FLUSH_INTERVAL{std::chrono::hours{1}};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1198379250",
      "id" : 1198379250,
      "in_reply_to_id" : 1198123417,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585HbdDy",
      "original_commit_id" : "4614a64bbffd5333cfd9fb78c6530d81c3856901",
      "original_line" : 26,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : null,
      "pull_request_review_id" : 1433560975,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198379250/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-18T23:02:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198379250",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1198379499"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198379499"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks fixed",
      "commit_id" : "473946b05e911fca96a1ec077db19910819e8aed",
      "created_at" : "2023-05-18T23:03:07Z",
      "diff_hunk" : "@@ -290,6 +291,45 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.stop_node(0)\n+        self.start_node(0)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1198379499",
      "id" : 1198379499,
      "in_reply_to_id" : 1198131760,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585HbdHr",
      "original_commit_id" : "b02e3fc91f4214c486da0ff46e187fab017e11bb",
      "original_line" : 300,
      "original_position" : 18,
      "original_start_line" : 299,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : null,
      "pull_request_review_id" : 1433561764,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198379499/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-05-18T23:03:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198379499",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1198388360"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198388360"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : ">Mine as well use this constant here for the filename?\r\n\r\n:thinking: it is an anon namespace, not defined in policy/fees_args.h, \r\nI think it is okay as is,  or else\r\n\r\npolicy/fees_args.h\r\n ```\r\nconst char* GetFeeEstimatesFilename();\r\n```\r\npolicy/fees.args.cpp\r\n```\r\nconst char* GetFeeEstimatesFilename() {\r\n    return FEE_ESTIMATES_FILENAME;\r\n}\r\n```\r\npolicy/fees.cpp\r\n```\r\nLogPrintf(\"Flushed fee estimates to %s.\\n\", GetFeeEstimatesFilename());\r\n```\r\nbut if it's possible another way I will be glad to learn how.",
      "commit_id" : "473946b05e911fca96a1ec077db19910819e8aed",
      "created_at" : "2023-05-18T23:22:05Z",
      "diff_hunk" : "@@ -903,11 +904,16 @@ CFeeRate CBlockPolicyEstimator::estimateSmartFee(int confTarget, FeeCalculation\n \n void CBlockPolicyEstimator::Flush() {\n     FlushUnconfirmed();\n+    FlushFeeEstimates();\n+}\n \n+void CBlockPolicyEstimator::FlushFeeEstimates() {\n     AutoFile est_file{fsbridge::fopen(m_estimation_filepath, \"wb\")};\n     if (est_file.IsNull() || !Write(est_file)) {\n         LogPrintf(\"Failed to write fee estimates to %s. Continue anyway.\\n\", fs::PathToString(m_estimation_filepath));\n+        return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1198388360",
      "id" : 1198388360,
      "in_reply_to_id" : 1198122182,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585HbfSI",
      "original_commit_id" : "4614a64bbffd5333cfd9fb78c6530d81c3856901",
      "original_line" : 914,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 1433575587,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198388360/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-18T23:22:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1198388360",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1199014871"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1199014871"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ok good point I see, well maybe just then...\r\n\r\n\r\n```diff\r\ndiff --git a/src/policy/fees.cpp b/src/policy/fees.cpp\r\nindex 085f938f80..adb0ebc383 100644\r\n--- a/src/policy/fees.cpp\r\n+++ b/src/policy/fees.cpp\r\n@@ -925,7 +925,7 @@ void CBlockPolicyEstimator::FlushFeeEstimates() {\r\n     if (est_file.IsNull() || !Write(est_file)) {\r\n         LogPrintf(\"Failed to write fee estimates to %s. Continue anyway.\\n\", fs::PathToString(m_estimation_filepath));\r\n     } else {\r\n-        LogPrintf(\"Flushed fee estimates to fee_estimates.dat.\\n\");\r\n+        LogPrintf(\"Flushed fee estimates to %s.\", fs::PathToString(m_estimation_filepath));\r\n     }\r\n }\r\n \r\n\r\n```",
      "commit_id" : "473946b05e911fca96a1ec077db19910819e8aed",
      "created_at" : "2023-05-19T14:15:18Z",
      "diff_hunk" : "@@ -903,11 +904,16 @@ CFeeRate CBlockPolicyEstimator::estimateSmartFee(int confTarget, FeeCalculation\n \n void CBlockPolicyEstimator::Flush() {\n     FlushUnconfirmed();\n+    FlushFeeEstimates();\n+}\n \n+void CBlockPolicyEstimator::FlushFeeEstimates() {\n     AutoFile est_file{fsbridge::fopen(m_estimation_filepath, \"wb\")};\n     if (est_file.IsNull() || !Write(est_file)) {\n         LogPrintf(\"Failed to write fee estimates to %s. Continue anyway.\\n\", fs::PathToString(m_estimation_filepath));\n+        return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1199014871",
      "id" : 1199014871,
      "in_reply_to_id" : 1198122182,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Hd4PX",
      "original_commit_id" : "4614a64bbffd5333cfd9fb78c6530d81c3856901",
      "original_line" : 914,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 1434514052,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1199014871/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-19T14:15:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1199014871",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1199078486"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1199078486"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in accf995cf095d7ff3d10c0403e70bdbc1273e852\r\n\r\nSeems like the error message here should be something like \"there is no fee estimates file\" instead of \"failed to read\" ?",
      "commit_id" : "473946b05e911fca96a1ec077db19910819e8aed",
      "created_at" : "2023-05-19T15:11:58Z",
      "diff_hunk" : "@@ -546,9 +546,22 @@ CBlockPolicyEstimator::CBlockPolicyEstimator(const fs::path& estimation_filepath\n     shortStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, SHORT_BLOCK_PERIODS, SHORT_DECAY, SHORT_SCALE));\n     longStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, LONG_BLOCK_PERIODS, LONG_DECAY, LONG_SCALE));\n \n-    // If the fee estimation file is present, read recorded estimations\n     AutoFile est_file{fsbridge::fopen(m_estimation_filepath, \"rb\")};\n-    if (est_file.IsNull() || !Read(est_file)) {\n+\n+    // Whenever the fee estimation file is not present return early\n+    if (est_file.IsNull()) {\n+        LogPrintf(\"Failed to read fee estimates from %s. Continue anyway.\\n\", fs::PathToString(m_estimation_filepath));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1199078486",
      "id" : 1199078486,
      "line" : 553,
      "node_id" : "PRRC_kwDOABII585HeHxW",
      "original_commit_id" : "accf995cf095d7ff3d10c0403e70bdbc1273e852",
      "original_line" : 553,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : 18,
      "pull_request_review_id" : 1434616046,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1199078486/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-19T15:20:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1199078486",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1199085331"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1199085331"
         }
      },
      "author_association" : "MEMBER",
      "body" : "What is the use case for being able to configure the maximum file age?",
      "commit_id" : "473946b05e911fca96a1ec077db19910819e8aed",
      "created_at" : "2023-05-19T15:18:38Z",
      "diff_hunk" : "@@ -186,6 +186,10 @@ class CBlockPolicyEstimator\n     static constexpr double FEE_SPACING = 1.05;\n \n     const fs::path m_estimation_filepath;\n+\n+    /** Fee estimate.dat must not be more than 12 hours old. */\n+    static constexpr std::chrono::hours MAX_FILE_AGE{12};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1199085331",
      "id" : 1199085331,
      "in_reply_to_id" : 1196993686,
      "line" : 191,
      "node_id" : "PRRC_kwDOABII585HeJcT",
      "original_commit_id" : "5a41661a118dc526780c006bdf09abcce92e24e5",
      "original_line" : 191,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : 24,
      "pull_request_review_id" : 1434616046,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1199085331/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-19T15:20:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1199085331",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1199176025"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1199176025"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "thanks fixed with\r\n ```\r\nLogPrintf(\"Flushed fee estimates to %s.\", fs::PathToString(m_estimation_filepath.filename()));\r\n```\r\nso as to get the filename only not the dir",
      "commit_id" : "5f79a92bb901d20b9b6afd089f0e0150a6979c4a",
      "created_at" : "2023-05-19T16:52:48Z",
      "diff_hunk" : "@@ -903,11 +904,16 @@ CFeeRate CBlockPolicyEstimator::estimateSmartFee(int confTarget, FeeCalculation\n \n void CBlockPolicyEstimator::Flush() {\n     FlushUnconfirmed();\n+    FlushFeeEstimates();\n+}\n \n+void CBlockPolicyEstimator::FlushFeeEstimates() {\n     AutoFile est_file{fsbridge::fopen(m_estimation_filepath, \"wb\")};\n     if (est_file.IsNull() || !Write(est_file)) {\n         LogPrintf(\"Failed to write fee estimates to %s. Continue anyway.\\n\", fs::PathToString(m_estimation_filepath));\n+        return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1199176025",
      "id" : 1199176025,
      "in_reply_to_id" : 1198122182,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585HeflZ",
      "original_commit_id" : "4614a64bbffd5333cfd9fb78c6530d81c3856901",
      "original_line" : 914,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 1434774754,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1199176025/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-19T16:52:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1199176025",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1199183106"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1199183106"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks fixed",
      "commit_id" : "5f79a92bb901d20b9b6afd089f0e0150a6979c4a",
      "created_at" : "2023-05-19T17:01:46Z",
      "diff_hunk" : "@@ -546,9 +546,22 @@ CBlockPolicyEstimator::CBlockPolicyEstimator(const fs::path& estimation_filepath\n     shortStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, SHORT_BLOCK_PERIODS, SHORT_DECAY, SHORT_SCALE));\n     longStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, LONG_BLOCK_PERIODS, LONG_DECAY, LONG_SCALE));\n \n-    // If the fee estimation file is present, read recorded estimations\n     AutoFile est_file{fsbridge::fopen(m_estimation_filepath, \"rb\")};\n-    if (est_file.IsNull() || !Read(est_file)) {\n+\n+    // Whenever the fee estimation file is not present return early\n+    if (est_file.IsNull()) {\n+        LogPrintf(\"Failed to read fee estimates from %s. Continue anyway.\\n\", fs::PathToString(m_estimation_filepath));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1199183106",
      "id" : 1199183106,
      "in_reply_to_id" : 1199078486,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585HehUC",
      "original_commit_id" : "accf995cf095d7ff3d10c0403e70bdbc1273e852",
      "original_line" : 553,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 1434785724,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1199183106/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-19T17:01:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1199183106",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1199199343"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1199199343"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I was thinking that introducing flexibility would enable users to define their preferred threshold for considering fee estimates as stale. As @instagibbs suggested extending the default 12 hours further. what is your view on it?",
      "commit_id" : "5f79a92bb901d20b9b6afd089f0e0150a6979c4a",
      "created_at" : "2023-05-19T17:19:51Z",
      "diff_hunk" : "@@ -186,6 +186,10 @@ class CBlockPolicyEstimator\n     static constexpr double FEE_SPACING = 1.05;\n \n     const fs::path m_estimation_filepath;\n+\n+    /** Fee estimate.dat must not be more than 12 hours old. */\n+    static constexpr std::chrono::hours MAX_FILE_AGE{12};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1199199343",
      "id" : 1199199343,
      "in_reply_to_id" : 1196993686,
      "line" : 191,
      "node_id" : "PRRC_kwDOABII585HelRv",
      "original_commit_id" : "5a41661a118dc526780c006bdf09abcce92e24e5",
      "original_line" : 191,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : 24,
      "pull_request_review_id" : 1434810895,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1199199343/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-19T17:19:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1199199343",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1210099908"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210099908"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Another use case could be so that testers can purposefully load (very) old fee estimate files to populate `estimatesmartfee`? https://github.com/bitcoin/bitcoin/issues/27415#issuecomment-1531711091",
      "commit_id" : "948edc9dc5d29798244bb4856fd69cd6f81662b4",
      "created_at" : "2023-05-30T10:56:12Z",
      "diff_hunk" : "@@ -186,6 +186,10 @@ class CBlockPolicyEstimator\n     static constexpr double FEE_SPACING = 1.05;\n \n     const fs::path m_estimation_filepath;\n+\n+    /** Fee estimate.dat must not be more than 12 hours old. */\n+    static constexpr std::chrono::hours MAX_FILE_AGE{12};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1210099908",
      "id" : 1210099908,
      "in_reply_to_id" : 1196993686,
      "line" : 191,
      "node_id" : "PRRC_kwDOABII585IIKjE",
      "original_commit_id" : "5a41661a118dc526780c006bdf09abcce92e24e5",
      "original_line" : 191,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : 24,
      "pull_request_review_id" : 1450663037,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210099908/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-30T10:56:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210099908",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1213443871"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213443871"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Not sure if we should load old (i.e. potentially bad) data as it can skew the fee estimates both at startup and after more data has been collected. For testing, they could mock the time right? Just worried about adding a config option that's a bit footgunny.",
      "commit_id" : "948edc9dc5d29798244bb4856fd69cd6f81662b4",
      "created_at" : "2023-06-01T17:03:41Z",
      "diff_hunk" : "@@ -186,6 +186,10 @@ class CBlockPolicyEstimator\n     static constexpr double FEE_SPACING = 1.05;\n \n     const fs::path m_estimation_filepath;\n+\n+    /** Fee estimate.dat must not be more than 12 hours old. */\n+    static constexpr std::chrono::hours MAX_FILE_AGE{12};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1213443871",
      "id" : 1213443871,
      "in_reply_to_id" : 1196993686,
      "line" : 191,
      "node_id" : "PRRC_kwDOABII585IU68f",
      "original_commit_id" : "5a41661a118dc526780c006bdf09abcce92e24e5",
      "original_line" : 191,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : 24,
      "pull_request_review_id" : 1455935701,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213443871/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-01T17:03:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213443871",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1213739677"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213739677"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, I agree with you. stale estimates should not be read. I have updated the MAX_FILE_AGE to 60 hours, 2.5 days, as @instagibbs suggested that longer would be okay",
      "commit_id" : "8c51cd00fb08143638f6f94b2e05b43f737bc072",
      "created_at" : "2023-06-01T22:24:35Z",
      "diff_hunk" : "@@ -186,6 +186,10 @@ class CBlockPolicyEstimator\n     static constexpr double FEE_SPACING = 1.05;\n \n     const fs::path m_estimation_filepath;\n+\n+    /** Fee estimate.dat must not be more than 12 hours old. */\n+    static constexpr std::chrono::hours MAX_FILE_AGE{12};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1213739677",
      "id" : 1213739677,
      "in_reply_to_id" : 1196993686,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585IWDKd",
      "original_commit_id" : "5a41661a118dc526780c006bdf09abcce92e24e5",
      "original_line" : 191,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : null,
      "pull_request_review_id" : 1456398245,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213739677/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-01T22:28:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213739677",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1214180938"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214180938"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Can you explain the rationale behind the 60 hours chosen? Also perhaps you can update OP as it still mentions 12 hours :)",
      "commit_id" : "8c51cd00fb08143638f6f94b2e05b43f737bc072",
      "created_at" : "2023-06-02T10:05:54Z",
      "diff_hunk" : "@@ -186,6 +186,10 @@ class CBlockPolicyEstimator\n     static constexpr double FEE_SPACING = 1.05;\n \n     const fs::path m_estimation_filepath;\n+\n+    /** Fee estimate.dat must not be more than 12 hours old. */\n+    static constexpr std::chrono::hours MAX_FILE_AGE{12};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1214180938",
      "id" : 1214180938,
      "in_reply_to_id" : 1196993686,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585IXu5K",
      "original_commit_id" : "5a41661a118dc526780c006bdf09abcce92e24e5",
      "original_line" : 191,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : null,
      "pull_request_review_id" : 1457049916,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214180938/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-02T10:05:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214180938",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1214368208"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214368208"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Estimates that are 2.5 days old have nearly half the decay weight of the most recent block.\r\nThank you I updated the PR description.",
      "commit_id" : "8c51cd00fb08143638f6f94b2e05b43f737bc072",
      "created_at" : "2023-06-02T13:21:54Z",
      "diff_hunk" : "@@ -186,6 +186,10 @@ class CBlockPolicyEstimator\n     static constexpr double FEE_SPACING = 1.05;\n \n     const fs::path m_estimation_filepath;\n+\n+    /** Fee estimate.dat must not be more than 12 hours old. */\n+    static constexpr std::chrono::hours MAX_FILE_AGE{12};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1214368208",
      "id" : 1214368208,
      "in_reply_to_id" : 1196993686,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585IYcnQ",
      "original_commit_id" : "5a41661a118dc526780c006bdf09abcce92e24e5",
      "original_line" : 191,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : null,
      "pull_request_review_id" : 1457431731,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214368208/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-02T13:22:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214368208",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1214407758"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214407758"
         }
      },
      "author_association" : "MEMBER",
      "body" : "to make this test less order-dependent, you can attempt to delete the file, then run the test",
      "commit_id" : "8c51cd00fb08143638f6f94b2e05b43f737bc072",
      "created_at" : "2023-06-02T13:49:46Z",
      "diff_hunk" : "@@ -290,6 +291,44 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.restart_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"feerate\"], fee_rate)\n+\n+        fee_dat = fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+\n+        # Stop the node and backdate the fee_estimates.dat file for 61 hours\n+        self.stop_node(0)\n+        hour = 60 * 60\n+        last_modified_time = time.time() - 61 * hour\n+        os.utime(fee_dat, (last_modified_time, last_modified_time))\n+\n+        # Start node and ensure the fee_estimates.dat file was not read\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"errors\"], [\"Insufficient data or no feerate found\"])\n+\n+\n+    def test_estimate_dat_is_flushed_periodically(self):\n+            fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+\n+            # Verify that fee_estimates.dat does not exist\n+            assert_equal(os.path.isfile(fee_dat), False)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1214407758",
      "id" : 1214407758,
      "line" : 319,
      "node_id" : "PRRC_kwDOABII585IYmRO",
      "original_commit_id" : "8c51cd00fb08143638f6f94b2e05b43f737bc072",
      "original_line" : 319,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : 37,
      "pull_request_review_id" : 1457521354,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214407758/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-02T13:58:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214407758",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1214415612"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214415612"
         }
      },
      "author_association" : "MEMBER",
      "body" : "might be good to test that it does it *every hour*, and that the output files should be matching provided we don't see blocks in the interim, also, check that what is written on node shutdown also matches?\r\n\r\nThat way we can have higher assurance on the timing of the flushing and the contents matching what we already do.",
      "commit_id" : "8c51cd00fb08143638f6f94b2e05b43f737bc072",
      "created_at" : "2023-06-02T13:56:09Z",
      "diff_hunk" : "@@ -290,6 +291,44 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.restart_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"feerate\"], fee_rate)\n+\n+        fee_dat = fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+\n+        # Stop the node and backdate the fee_estimates.dat file for 61 hours\n+        self.stop_node(0)\n+        hour = 60 * 60\n+        last_modified_time = time.time() - 61 * hour\n+        os.utime(fee_dat, (last_modified_time, last_modified_time))\n+\n+        # Start node and ensure the fee_estimates.dat file was not read\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"errors\"], [\"Insufficient data or no feerate found\"])\n+\n+\n+    def test_estimate_dat_is_flushed_periodically(self):\n+            fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+\n+            # Verify that fee_estimates.dat does not exist\n+            assert_equal(os.path.isfile(fee_dat), False)\n+\n+            # Check if the string \"Flushed fee estimates to fee_estimates.dat.\" is present in the debug log file.\n+            # If it is, it indicates that fee estimates have been successfully flushed to disk.\n+            with self.nodes[0].assert_debug_log(expected_msgs=[\"Flushed fee estimates to fee_estimates.dat.\"], timeout=1):\n+                # Mock the scheduler for an hour, fee estimates will be flushed to fee_estimate.dat\n+                hour = 3600\n+                self.nodes[0].mockscheduler(hour)\n+\n+            # Verify that fee estimates were flushed and fee_estimates.dat file is created\n+            assert_equal(os.path.isfile(fee_dat), True)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1214415612",
      "id" : 1214415612,
      "line" : 329,
      "node_id" : "PRRC_kwDOABII585IYoL8",
      "original_commit_id" : "8c51cd00fb08143638f6f94b2e05b43f737bc072",
      "original_line" : 329,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : 47,
      "pull_request_review_id" : 1457521354,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214415612/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-02T13:58:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214415612",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Also wondering if we should include a hidden argument to allow older files for testing reasons, re: #27415\r\n> \r\n> I've used it for systems I've built for integration testing, and not having to touch a file during testing to refresh it would be a simplification.\r\n> \r\n> > For testing, they could mock the time right?\r\n> \r\n> Depends on your test setup, really. It might interfere during integration tests which require a realistic clock?\r\n\r\nMakes sense, seems fine as a regtest-only option for testing.",
      "created_at" : "2023-06-02T14:38:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#issuecomment-1573845849",
      "id" : 1573845849,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27622",
      "node_id" : "IC_kwDOABII585dzvtZ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1573845849/reactions"
      },
      "updated_at" : "2023-06-02T14:38:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1573845849",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1214935160"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214935160"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thank you, I added the delete attempt",
      "commit_id" : "451ab8b513f88f2bf21a96ff1cf98d17fa82362f",
      "created_at" : "2023-06-02T23:02:53Z",
      "diff_hunk" : "@@ -290,6 +291,44 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.restart_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"feerate\"], fee_rate)\n+\n+        fee_dat = fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+\n+        # Stop the node and backdate the fee_estimates.dat file for 61 hours\n+        self.stop_node(0)\n+        hour = 60 * 60\n+        last_modified_time = time.time() - 61 * hour\n+        os.utime(fee_dat, (last_modified_time, last_modified_time))\n+\n+        # Start node and ensure the fee_estimates.dat file was not read\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"errors\"], [\"Insufficient data or no feerate found\"])\n+\n+\n+    def test_estimate_dat_is_flushed_periodically(self):\n+            fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+\n+            # Verify that fee_estimates.dat does not exist\n+            assert_equal(os.path.isfile(fee_dat), False)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1214935160",
      "id" : 1214935160,
      "in_reply_to_id" : 1214407758,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585IanB4",
      "original_commit_id" : "8c51cd00fb08143638f6f94b2e05b43f737bc072",
      "original_line" : 319,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : null,
      "pull_request_review_id" : 1458574145,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214935160/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-02T23:02:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214935160",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1214936512"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214936512"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Sure, thank you, I updated the test.",
      "commit_id" : "451ab8b513f88f2bf21a96ff1cf98d17fa82362f",
      "created_at" : "2023-06-02T23:03:40Z",
      "diff_hunk" : "@@ -290,6 +291,44 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.restart_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"feerate\"], fee_rate)\n+\n+        fee_dat = fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+\n+        # Stop the node and backdate the fee_estimates.dat file for 61 hours\n+        self.stop_node(0)\n+        hour = 60 * 60\n+        last_modified_time = time.time() - 61 * hour\n+        os.utime(fee_dat, (last_modified_time, last_modified_time))\n+\n+        # Start node and ensure the fee_estimates.dat file was not read\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"errors\"], [\"Insufficient data or no feerate found\"])\n+\n+\n+    def test_estimate_dat_is_flushed_periodically(self):\n+            fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+\n+            # Verify that fee_estimates.dat does not exist\n+            assert_equal(os.path.isfile(fee_dat), False)\n+\n+            # Check if the string \"Flushed fee estimates to fee_estimates.dat.\" is present in the debug log file.\n+            # If it is, it indicates that fee estimates have been successfully flushed to disk.\n+            with self.nodes[0].assert_debug_log(expected_msgs=[\"Flushed fee estimates to fee_estimates.dat.\"], timeout=1):\n+                # Mock the scheduler for an hour, fee estimates will be flushed to fee_estimate.dat\n+                hour = 3600\n+                self.nodes[0].mockscheduler(hour)\n+\n+            # Verify that fee estimates were flushed and fee_estimates.dat file is created\n+            assert_equal(os.path.isfile(fee_dat), True)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1214936512",
      "id" : 1214936512,
      "in_reply_to_id" : 1214415612,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585IanXA",
      "original_commit_id" : "8c51cd00fb08143638f6f94b2e05b43f737bc072",
      "original_line" : 329,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : null,
      "pull_request_review_id" : 1458575525,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214936512/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-02T23:03:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1214936512",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Also wondering if we should include a hidden argument to allow older files for testing reasons, re: #27415\r\n> I've used it for systems I've built for integration testing, and not having to touch a file during testing to refresh it would be a simplification.\r\n> \r\n> > For testing, they could mock the time right?\r\n> \r\n> Depends on your test setup, really. It might interfere during integration tests which require a realistic clock?\r\n>\r\n> Makes sense, seems fine as a regtest-only option for testing.\r\n\r\nSure I will follow up on that.",
      "created_at" : "2023-06-02T23:12:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#issuecomment-1574425436",
      "id" : 1574425436,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27622",
      "node_id" : "IC_kwDOABII585d19Nc",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1574425436/reactions"
      },
      "updated_at" : "2023-06-02T23:30:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1574425436",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1219177648"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219177648"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I know we only use it once in the test, but if you re-touch this file it could be nice to use a named variable for the 60 hours, to make it clear where it comes from? (e.g. `MAX_FILE_AGE` would shadow the name used in _fees.h_)",
      "commit_id" : "451ab8b513f88f2bf21a96ff1cf98d17fa82362f",
      "created_at" : "2023-06-06T08:33:06Z",
      "diff_hunk" : "@@ -290,6 +291,77 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.restart_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"feerate\"], fee_rate)\n+\n+        fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+\n+        # Stop the node and backdate the fee_estimates.dat file for 61 hours\n+        self.stop_node(0)\n+        hour = 60 * 60\n+        last_modified_time = time.time() - 61 * hour",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1219177648",
      "id" : 1219177648,
      "line" : 307,
      "node_id" : "PRRC_kwDOABII585Iqyyw",
      "original_commit_id" : "451ab8b513f88f2bf21a96ff1cf98d17fa82362f",
      "original_line" : 307,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : 25,
      "pull_request_review_id" : 1464599043,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219177648/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-06T08:39:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219177648",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1219184270"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219184270"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "```suggestion\r\n        # Verify that the estimates are not the same if new blocks were produced in the flush interval\r\n```",
      "commit_id" : "451ab8b513f88f2bf21a96ff1cf98d17fa82362f",
      "created_at" : "2023-06-06T08:37:50Z",
      "diff_hunk" : "@@ -290,6 +291,77 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.restart_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"feerate\"], fee_rate)\n+\n+        fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+\n+        # Stop the node and backdate the fee_estimates.dat file for 61 hours\n+        self.stop_node(0)\n+        hour = 60 * 60\n+        last_modified_time = time.time() - 61 * hour\n+        os.utime(fee_dat, (last_modified_time, last_modified_time))\n+\n+        # Start node and ensure the fee_estimates.dat file was not read\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"errors\"], [\"Insufficient data or no feerate found\"])\n+\n+\n+    def test_estimate_dat_is_flushed_periodically(self):\n+        fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+        hour = 3600\n+\n+        os.remove(fee_dat) if os.path.exists(fee_dat) else None\n+\n+        # Verify that fee_estimates.dat does not exist\n+        assert_equal(os.path.isfile(fee_dat), False)\n+\n+        # Verify if the string \"Flushed fee estimates to fee_estimates.dat.\" is present in the debug log file.\n+        # If present, it indicates that fee estimates have been successfully flushed to disk.\n+        with self.nodes[0].assert_debug_log(expected_msgs=[\"Flushed fee estimates to fee_estimates.dat.\"], timeout=1):\n+            # Mock the scheduler for an hour to flush fee estimates to fee_estimates.dat\n+            self.nodes[0].mockscheduler(hour)\n+\n+        # Verify that fee estimates were flushed and fee_estimates.dat file is created\n+        assert_equal(os.path.isfile(fee_dat), True)\n+\n+        # Verify that the estimates remain the same if there are no blocks in the flush interval\n+        fee_dat_initial_content = open(fee_dat, \"rb\").read()\n+        with self.nodes[0].assert_debug_log(expected_msgs=[\"Flushed fee estimates to fee_estimates.dat.\"], timeout=1):\n+            # Mock the scheduler for an hour to flush fee estimates to fee_estimates.dat\n+            self.nodes[0].mockscheduler(hour)\n+\n+        fee_dat_current_content = open(fee_dat, \"rb\").read()\n+        assert_equal(fee_dat_current_content, fee_dat_initial_content)\n+\n+        # Verify that the estimates remain the same after shutdown with no blocks before shutdown\n+        self.restart_node(0)\n+        fee_dat_current_content = open(fee_dat, \"rb\").read()\n+        assert_equal(fee_dat_current_content, fee_dat_initial_content)\n+\n+        # Verify that the estimates are not the same if there are no blocks in the flush interval",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1219184270",
      "id" : 1219184270,
      "line" : 347,
      "node_id" : "PRRC_kwDOABII585Iq0aO",
      "original_commit_id" : "451ab8b513f88f2bf21a96ff1cf98d17fa82362f",
      "original_line" : 347,
      "original_position" : 65,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : 65,
      "pull_request_review_id" : 1464599043,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219184270/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-06T08:39:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219184270",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1219595571"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219595571"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I agree it's better than the magic number, I have updated it.",
      "commit_id" : "6d36f3edbe7549cfaadc48b43c09dd3e581e92ff",
      "created_at" : "2023-06-06T12:53:33Z",
      "diff_hunk" : "@@ -290,6 +291,77 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.restart_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"feerate\"], fee_rate)\n+\n+        fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+\n+        # Stop the node and backdate the fee_estimates.dat file for 61 hours\n+        self.stop_node(0)\n+        hour = 60 * 60\n+        last_modified_time = time.time() - 61 * hour",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1219595571",
      "id" : 1219595571,
      "in_reply_to_id" : 1219177648,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585IsY0z",
      "original_commit_id" : "451ab8b513f88f2bf21a96ff1cf98d17fa82362f",
      "original_line" : 307,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : null,
      "pull_request_review_id" : 1465135361,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219595571/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-06T12:53:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219595571",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1219596235"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219596235"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Fixed Thank you.",
      "commit_id" : "6d36f3edbe7549cfaadc48b43c09dd3e581e92ff",
      "created_at" : "2023-06-06T12:54:00Z",
      "diff_hunk" : "@@ -290,6 +291,77 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.restart_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"feerate\"], fee_rate)\n+\n+        fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+\n+        # Stop the node and backdate the fee_estimates.dat file for 61 hours\n+        self.stop_node(0)\n+        hour = 60 * 60\n+        last_modified_time = time.time() - 61 * hour\n+        os.utime(fee_dat, (last_modified_time, last_modified_time))\n+\n+        # Start node and ensure the fee_estimates.dat file was not read\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"errors\"], [\"Insufficient data or no feerate found\"])\n+\n+\n+    def test_estimate_dat_is_flushed_periodically(self):\n+        fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+        hour = 3600\n+\n+        os.remove(fee_dat) if os.path.exists(fee_dat) else None\n+\n+        # Verify that fee_estimates.dat does not exist\n+        assert_equal(os.path.isfile(fee_dat), False)\n+\n+        # Verify if the string \"Flushed fee estimates to fee_estimates.dat.\" is present in the debug log file.\n+        # If present, it indicates that fee estimates have been successfully flushed to disk.\n+        with self.nodes[0].assert_debug_log(expected_msgs=[\"Flushed fee estimates to fee_estimates.dat.\"], timeout=1):\n+            # Mock the scheduler for an hour to flush fee estimates to fee_estimates.dat\n+            self.nodes[0].mockscheduler(hour)\n+\n+        # Verify that fee estimates were flushed and fee_estimates.dat file is created\n+        assert_equal(os.path.isfile(fee_dat), True)\n+\n+        # Verify that the estimates remain the same if there are no blocks in the flush interval\n+        fee_dat_initial_content = open(fee_dat, \"rb\").read()\n+        with self.nodes[0].assert_debug_log(expected_msgs=[\"Flushed fee estimates to fee_estimates.dat.\"], timeout=1):\n+            # Mock the scheduler for an hour to flush fee estimates to fee_estimates.dat\n+            self.nodes[0].mockscheduler(hour)\n+\n+        fee_dat_current_content = open(fee_dat, \"rb\").read()\n+        assert_equal(fee_dat_current_content, fee_dat_initial_content)\n+\n+        # Verify that the estimates remain the same after shutdown with no blocks before shutdown\n+        self.restart_node(0)\n+        fee_dat_current_content = open(fee_dat, \"rb\").read()\n+        assert_equal(fee_dat_current_content, fee_dat_initial_content)\n+\n+        # Verify that the estimates are not the same if there are no blocks in the flush interval",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1219596235",
      "id" : 1219596235,
      "in_reply_to_id" : 1219184270,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585IsY_L",
      "original_commit_id" : "451ab8b513f88f2bf21a96ff1cf98d17fa82362f",
      "original_line" : 347,
      "original_position" : 65,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : null,
      "pull_request_review_id" : 1465136578,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219596235/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-06T12:54:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1219596235",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "\r\n> I'd really prefer we have a regtest-only option to skip the check to impact integration tests the least.\r\n\r\nI added a support for skipping the check only on regtest in 2fec7f362d8540cda5ff7e3e4dfb2cb751364e06 by passing -acceptstaleestimates option and it's tested in dea3accb1f2eeef74f293262c168d68c0ec444cb",
      "created_at" : "2023-06-08T08:52:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#issuecomment-1582165674",
      "id" : 1582165674,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27622",
      "node_id" : "IC_kwDOABII585eTe6q",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1582165674/reactions"
      },
      "updated_at" : "2023-06-08T08:52:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1582165674",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1222723313"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222723313"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in 2fec7f362d8540cda5ff7e3e4dfb2cb751364e06:\r\n\r\nprefix with `DEFAULT_`, make doxygen compatible, use braced initialization. Documentation about where the option can be used belongs where that code lives, not here.\r\n\r\n```suggestion\r\n/** Whether we allow importing a fee_estimates file older than MAX_FILE_AGE. */\r\nstatic constexpr bool DEFAULT_ACCEPT_STALE_FEE_ESTIMATES{false};\r\n```",
      "commit_id" : "f91d089a7613c8ff43a73c692ee0432c82354ef3",
      "created_at" : "2023-06-08T09:36:52Z",
      "diff_hunk" : "@@ -25,6 +25,9 @@\n // How often to flush fee estimates to fee_estimates.dat.\n static constexpr std::chrono::hours FEE_FLUSH_INTERVAL{1};\n \n+// Stale fee estimates are not going to be read on mainnet\n+static constexpr bool ACCEPT_STALE_FEE_ESTIMATES = false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1222723313",
      "id" : 1222723313,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585I4Ubx",
      "original_commit_id" : "2fec7f362d8540cda5ff7e3e4dfb2cb751364e06",
      "original_line" : 29,
      "original_position" : 5,
      "original_start_line" : 28,
      "path" : "src/policy/fees.h",
      "position" : null,
      "pull_request_review_id" : 1469429394,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222723313/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-06-08T09:56:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222723313",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1222736738"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222736738"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in 2fec7f362d8540cda5ff7e3e4dfb2cb751364e06\r\nPlease also include here (1) the default value (2) how old \"stale\" is specifically, using the constants.",
      "commit_id" : "f91d089a7613c8ff43a73c692ee0432c82354ef3",
      "created_at" : "2023-06-08T09:49:15Z",
      "diff_hunk" : "@@ -586,6 +586,7 @@ void SetupServerArgs(ArgsManager& argsman)\n     argsman.AddArg(\"-acceptnonstdtxn\", strprintf(\"Relay and mine \\\"non-standard\\\" transactions (%sdefault: %u)\", \"testnet/regtest only; \", !testnetChainParams->RequireStandard()), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::NODE_RELAY);\n     argsman.AddArg(\"-incrementalrelayfee=<amt>\", strprintf(\"Fee rate (in %s/kvB) used to define cost of relay, used for mempool limiting and replacement policy. (default: %s)\", CURRENCY_UNIT, FormatMoney(DEFAULT_INCREMENTAL_RELAY_FEE)), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::NODE_RELAY);\n     argsman.AddArg(\"-dustrelayfee=<amt>\", strprintf(\"Fee rate (in %s/kvB) used to define dust, the value of an output such that it will cost more than its value in fees at this fee rate to spend it. (default: %s)\", CURRENCY_UNIT, FormatMoney(DUST_RELAY_TX_FEE)), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::NODE_RELAY);\n+    argsman.AddArg(\"-acceptstalefeeestimates\", \"Read fee estimates even if they are stale supported only in regtest\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1222736738",
      "id" : 1222736738,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585I4Xti",
      "original_commit_id" : "dea3accb1f2eeef74f293262c168d68c0ec444cb",
      "original_line" : 589,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 1469429394,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222736738/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-08T09:56:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222736738",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1222738052"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222738052"
         }
      },
      "author_association" : "MEMBER",
      "body" : "2fec7f362d8540cda5ff7e3e4dfb2cb751364e06\r\n\r\nthis should be const",
      "commit_id" : "f91d089a7613c8ff43a73c692ee0432c82354ef3",
      "created_at" : "2023-06-08T09:50:27Z",
      "diff_hunk" : "@@ -192,9 +195,11 @@ class CBlockPolicyEstimator\n      */\n     static constexpr std::chrono::hours MAX_FILE_AGE{60};\n \n+    bool m_read_stale_estimates;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1222738052",
      "id" : 1222738052,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585I4YCE",
      "original_commit_id" : "2fec7f362d8540cda5ff7e3e4dfb2cb751364e06",
      "original_line" : 198,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : null,
      "pull_request_review_id" : 1469429394,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222738052/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-08T09:56:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222738052",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1222741414"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222741414"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit in dea3accb1f2eeef74f293262c168d68c0ec444cb\r\n\r\nmaybe replace this `hour` and the one in the other tests with a constant at the top of the file, `SECONDS_PER_HOUR`",
      "commit_id" : "f91d089a7613c8ff43a73c692ee0432c82354ef3",
      "created_at" : "2023-06-08T09:53:39Z",
      "diff_hunk" : "@@ -290,6 +292,95 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.restart_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"feerate\"], fee_rate)\n+\n+        fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+\n+        # Stop the node and backdate the fee_estimates.dat file more than MAX_FILE_AGE\n+        self.stop_node(0)\n+        hour = 60 * 60\n+        last_modified_time = time.time() - (MAX_FILE_AGE + 1) * hour\n+        os.utime(fee_dat, (last_modified_time, last_modified_time))\n+\n+        # Start node and ensure the fee_estimates.dat file was not read\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"errors\"], [\"Insufficient data or no feerate found\"])\n+\n+\n+    def test_estimate_dat_is_flushed_periodically(self):\n+        fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+        hour = 3600",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1222741414",
      "id" : 1222741414,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585I4Y2m",
      "original_commit_id" : "dea3accb1f2eeef74f293262c168d68c0ec444cb",
      "original_line" : 318,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : null,
      "pull_request_review_id" : 1469429394,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222741414/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-08T09:56:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222741414",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1222742962"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222742962"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in dea3accb1f2eeef74f293262c168d68c0ec444cb\r\n\r\nGiven that you comment \"there are no blocks\" you should probably also assert that is true, e.g. `assert_equal` the result from `getbestblockhash` before and after",
      "commit_id" : "f91d089a7613c8ff43a73c692ee0432c82354ef3",
      "created_at" : "2023-06-08T09:55:07Z",
      "diff_hunk" : "@@ -290,6 +292,95 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.restart_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"feerate\"], fee_rate)\n+\n+        fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+\n+        # Stop the node and backdate the fee_estimates.dat file more than MAX_FILE_AGE\n+        self.stop_node(0)\n+        hour = 60 * 60\n+        last_modified_time = time.time() - (MAX_FILE_AGE + 1) * hour\n+        os.utime(fee_dat, (last_modified_time, last_modified_time))\n+\n+        # Start node and ensure the fee_estimates.dat file was not read\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"errors\"], [\"Insufficient data or no feerate found\"])\n+\n+\n+    def test_estimate_dat_is_flushed_periodically(self):\n+        fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+        hour = 3600\n+\n+        os.remove(fee_dat) if os.path.exists(fee_dat) else None\n+\n+        # Verify that fee_estimates.dat does not exist\n+        assert_equal(os.path.isfile(fee_dat), False)\n+\n+        # Verify if the string \"Flushed fee estimates to fee_estimates.dat.\" is present in the debug log file.\n+        # If present, it indicates that fee estimates have been successfully flushed to disk.\n+        with self.nodes[0].assert_debug_log(expected_msgs=[\"Flushed fee estimates to fee_estimates.dat.\"], timeout=1):\n+            # Mock the scheduler for an hour to flush fee estimates to fee_estimates.dat\n+            self.nodes[0].mockscheduler(hour)\n+\n+        # Verify that fee estimates were flushed and fee_estimates.dat file is created\n+        assert_equal(os.path.isfile(fee_dat), True)\n+\n+        # Verify that the estimates remain the same if there are no blocks in the flush interval",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1222742962",
      "id" : 1222742962,
      "line" : 332,
      "node_id" : "PRRC_kwDOABII585I4ZOy",
      "original_commit_id" : "dea3accb1f2eeef74f293262c168d68c0ec444cb",
      "original_line" : 332,
      "original_position" : 59,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : 57,
      "pull_request_review_id" : 1469429394,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222742962/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-08T09:56:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222742962",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1222989539"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222989539"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thank you, I updated it.",
      "commit_id" : "f91d089a7613c8ff43a73c692ee0432c82354ef3",
      "created_at" : "2023-06-08T12:46:20Z",
      "diff_hunk" : "@@ -25,6 +25,9 @@\n // How often to flush fee estimates to fee_estimates.dat.\n static constexpr std::chrono::hours FEE_FLUSH_INTERVAL{1};\n \n+// Stale fee estimates are not going to be read on mainnet\n+static constexpr bool ACCEPT_STALE_FEE_ESTIMATES = false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1222989539",
      "id" : 1222989539,
      "in_reply_to_id" : 1222723313,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585I5Vbj",
      "original_commit_id" : "2fec7f362d8540cda5ff7e3e4dfb2cb751364e06",
      "original_line" : 29,
      "original_position" : 5,
      "original_start_line" : 28,
      "path" : "src/policy/fees.h",
      "position" : null,
      "pull_request_review_id" : 1469839674,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222989539/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-06-08T12:46:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222989539",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1222991211"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222991211"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I modify as you suggested ðð¾ ",
      "commit_id" : "f91d089a7613c8ff43a73c692ee0432c82354ef3",
      "created_at" : "2023-06-08T12:47:41Z",
      "diff_hunk" : "@@ -586,6 +586,7 @@ void SetupServerArgs(ArgsManager& argsman)\n     argsman.AddArg(\"-acceptnonstdtxn\", strprintf(\"Relay and mine \\\"non-standard\\\" transactions (%sdefault: %u)\", \"testnet/regtest only; \", !testnetChainParams->RequireStandard()), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::NODE_RELAY);\n     argsman.AddArg(\"-incrementalrelayfee=<amt>\", strprintf(\"Fee rate (in %s/kvB) used to define cost of relay, used for mempool limiting and replacement policy. (default: %s)\", CURRENCY_UNIT, FormatMoney(DEFAULT_INCREMENTAL_RELAY_FEE)), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::NODE_RELAY);\n     argsman.AddArg(\"-dustrelayfee=<amt>\", strprintf(\"Fee rate (in %s/kvB) used to define dust, the value of an output such that it will cost more than its value in fees at this fee rate to spend it. (default: %s)\", CURRENCY_UNIT, FormatMoney(DUST_RELAY_TX_FEE)), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::NODE_RELAY);\n+    argsman.AddArg(\"-acceptstalefeeestimates\", \"Read fee estimates even if they are stale supported only in regtest\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1222991211",
      "id" : 1222991211,
      "in_reply_to_id" : 1222736738,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585I5V1r",
      "original_commit_id" : "dea3accb1f2eeef74f293262c168d68c0ec444cb",
      "original_line" : 589,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 1469843114,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222991211/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-08T12:47:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222991211",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1222991573"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222991573"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thank you",
      "commit_id" : "f91d089a7613c8ff43a73c692ee0432c82354ef3",
      "created_at" : "2023-06-08T12:48:00Z",
      "diff_hunk" : "@@ -192,9 +195,11 @@ class CBlockPolicyEstimator\n      */\n     static constexpr std::chrono::hours MAX_FILE_AGE{60};\n \n+    bool m_read_stale_estimates;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1222991573",
      "id" : 1222991573,
      "in_reply_to_id" : 1222738052,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585I5V7V",
      "original_commit_id" : "2fec7f362d8540cda5ff7e3e4dfb2cb751364e06",
      "original_line" : 198,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : null,
      "pull_request_review_id" : 1469843935,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222991573/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-08T12:48:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222991573",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1222991937"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222991937"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "sure fixed",
      "commit_id" : "f91d089a7613c8ff43a73c692ee0432c82354ef3",
      "created_at" : "2023-06-08T12:48:19Z",
      "diff_hunk" : "@@ -290,6 +292,95 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.restart_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"feerate\"], fee_rate)\n+\n+        fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+\n+        # Stop the node and backdate the fee_estimates.dat file more than MAX_FILE_AGE\n+        self.stop_node(0)\n+        hour = 60 * 60\n+        last_modified_time = time.time() - (MAX_FILE_AGE + 1) * hour\n+        os.utime(fee_dat, (last_modified_time, last_modified_time))\n+\n+        # Start node and ensure the fee_estimates.dat file was not read\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"errors\"], [\"Insufficient data or no feerate found\"])\n+\n+\n+    def test_estimate_dat_is_flushed_periodically(self):\n+        fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+        hour = 3600\n+\n+        os.remove(fee_dat) if os.path.exists(fee_dat) else None\n+\n+        # Verify that fee_estimates.dat does not exist\n+        assert_equal(os.path.isfile(fee_dat), False)\n+\n+        # Verify if the string \"Flushed fee estimates to fee_estimates.dat.\" is present in the debug log file.\n+        # If present, it indicates that fee estimates have been successfully flushed to disk.\n+        with self.nodes[0].assert_debug_log(expected_msgs=[\"Flushed fee estimates to fee_estimates.dat.\"], timeout=1):\n+            # Mock the scheduler for an hour to flush fee estimates to fee_estimates.dat\n+            self.nodes[0].mockscheduler(hour)\n+\n+        # Verify that fee estimates were flushed and fee_estimates.dat file is created\n+        assert_equal(os.path.isfile(fee_dat), True)\n+\n+        # Verify that the estimates remain the same if there are no blocks in the flush interval",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1222991937",
      "id" : 1222991937,
      "in_reply_to_id" : 1222742962,
      "line" : 332,
      "node_id" : "PRRC_kwDOABII585I5WBB",
      "original_commit_id" : "dea3accb1f2eeef74f293262c168d68c0ec444cb",
      "original_line" : 332,
      "original_position" : 59,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : 57,
      "pull_request_review_id" : 1469844723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222991937/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-08T12:48:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1222991937",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "tsan failure looks unrelated: https://cirrus-ci.com/task/5970681108627456",
      "created_at" : "2023-06-08T13:16:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#issuecomment-1582565180",
      "id" : 1582565180,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27622",
      "node_id" : "IC_kwDOABII585eVAc8",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1582565180/reactions"
      },
      "updated_at" : "2023-06-08T13:16:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1582565180",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1223049862"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1223049862"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think this should fail rather than being ignored?",
      "commit_id" : "f91d089a7613c8ff43a73c692ee0432c82354ef3",
      "created_at" : "2023-06-08T13:32:18Z",
      "diff_hunk" : "@@ -1253,7 +1255,18 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     assert(!node.fee_estimator);\n     // Don't initialize fee estimation with old data if we don't relay transactions,\n     // as they would never get updated.\n-    if (!ignores_incoming_txs) node.fee_estimator = std::make_unique<CBlockPolicyEstimator>(FeeestPath(args));\n+    if (!ignores_incoming_txs) {\n+        bool read_stale_estimates = args.GetBoolArg(\"-acceptstalefeeestimates\", DEFAULT_ACCEPT_STALE_FEE_ESTIMATES);\n+        if (read_stale_estimates && (chainparams.GetChainType() != ChainType::REGTEST)) {\n+            LogPrintf(\"Reading stale fee estimates is only supported in regtest \\n\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1223049862",
      "id" : 1223049862,
      "line" : 1261,
      "node_id" : "PRRC_kwDOABII585I5kKG",
      "original_commit_id" : "f91d089a7613c8ff43a73c692ee0432c82354ef3",
      "original_line" : 1261,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 24,
      "pull_request_review_id" : 1469928526,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1223049862/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-08T13:32:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1223049862",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1223602575"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1223602575"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I agree, fixed it.",
      "commit_id" : "efe5f373e12329104f1c706145eee75c2d2079a7",
      "created_at" : "2023-06-08T22:18:27Z",
      "diff_hunk" : "@@ -1253,7 +1255,18 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     assert(!node.fee_estimator);\n     // Don't initialize fee estimation with old data if we don't relay transactions,\n     // as they would never get updated.\n-    if (!ignores_incoming_txs) node.fee_estimator = std::make_unique<CBlockPolicyEstimator>(FeeestPath(args));\n+    if (!ignores_incoming_txs) {\n+        bool read_stale_estimates = args.GetBoolArg(\"-acceptstalefeeestimates\", DEFAULT_ACCEPT_STALE_FEE_ESTIMATES);\n+        if (read_stale_estimates && (chainparams.GetChainType() != ChainType::REGTEST)) {\n+            LogPrintf(\"Reading stale fee estimates is only supported in regtest \\n\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1223602575",
      "id" : 1223602575,
      "in_reply_to_id" : 1223049862,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585I7rGP",
      "original_commit_id" : "f91d089a7613c8ff43a73c692ee0432c82354ef3",
      "original_line" : 1261,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 1470846487,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1223602575/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-08T22:18:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1223602575",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1223942269"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1223942269"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "clarity nit:\r\n\r\n```suggestion\r\n/** fee_estimates.dat that are more than 60 hours (2.5 days) will not be read,\r\n```",
      "commit_id" : "efe5f373e12329104f1c706145eee75c2d2079a7",
      "created_at" : "2023-06-09T07:24:10Z",
      "diff_hunk" : "@@ -14,12 +14,25 @@\n #include <util/fs.h>\n \n #include <array>\n+#include <chrono>\n #include <map>\n #include <memory>\n #include <set>\n #include <string>\n #include <vector>\n \n+\n+// How often to flush fee estimates to fee_estimates.dat.\n+static constexpr std::chrono::hours FEE_FLUSH_INTERVAL{1};\n+\n+/** fee_estimates.dat that are more than 60 hours old, 2 and half days will not be read,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1223942269",
      "id" : 1223942269,
      "line" : 28,
      "node_id" : "PRRC_kwDOABII585I8-B9",
      "original_commit_id" : "efe5f373e12329104f1c706145eee75c2d2079a7",
      "original_line" : 28,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : 15,
      "pull_request_review_id" : 1471390869,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1223942269/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-09T07:44:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1223942269",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK https://github.com/bitcoin/bitcoin/pull/27622/commits/efe5f373e12329104f1c706145eee75c2d2079a7",
      "created_at" : "2023-06-09T12:56:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#issuecomment-1584534491",
      "id" : 1584534491,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27622",
      "node_id" : "IC_kwDOABII585echPb",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1584534491/reactions"
      },
      "updated_at" : "2023-06-09T12:56:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1584534491",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1225923606"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1225923606"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in 29814149f29ce1858ee3f6ea2fbd37ec411070d6: for primitive types like bools, it makes more sense to pass by value",
      "commit_id" : "d2b39e09bc6a5982fc5cf4b538b7fdb0e3cae576",
      "created_at" : "2023-06-11T20:56:25Z",
      "diff_hunk" : "@@ -191,9 +194,12 @@ class CBlockPolicyEstimator\n     static constexpr double FEE_SPACING = 1.05;\n \n     const fs::path m_estimation_filepath;\n+\n+    const bool m_read_stale_estimates;\n+\n public:\n     /** Create new BlockPolicyEstimator and initialize stats tracking classes with default values */\n-    CBlockPolicyEstimator(const fs::path& estimation_filepath);\n+    CBlockPolicyEstimator(const fs::path& estimation_filepath, const bool& read_stale_estimates);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1225923606",
      "id" : 1225923606,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585JEhwW",
      "original_commit_id" : "29814149f29ce1858ee3f6ea2fbd37ec411070d6",
      "original_line" : 202,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : null,
      "pull_request_review_id" : 1473820940,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1225923606/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-13T20:10:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1225923606",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1225926128"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1225926128"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in efe5f373e12329104f1c706145eee75c2d2079a7\r\n\r\nIs this 61 hours? Or 1 second past the 60hour mark?",
      "commit_id" : "d2b39e09bc6a5982fc5cf4b538b7fdb0e3cae576",
      "created_at" : "2023-06-11T21:13:43Z",
      "diff_hunk" : "@@ -290,6 +293,95 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.restart_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"feerate\"], fee_rate)\n+\n+        fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+\n+        # Stop the node and backdate the fee_estimates.dat file more than MAX_FILE_AGE\n+        self.stop_node(0)\n+        last_modified_time = time.time() - (MAX_FILE_AGE + 1) * SECONDS_PER_HOUR",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1225926128",
      "id" : 1225926128,
      "line" : 308,
      "node_id" : "PRRC_kwDOABII585JEiXw",
      "original_commit_id" : "efe5f373e12329104f1c706145eee75c2d2079a7",
      "original_line" : 308,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : 33,
      "pull_request_review_id" : 1473820940,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1225926128/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-13T20:10:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1225926128",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1228568682"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1228568682"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think if you retouch there is some style nit too:\r\n\r\n```diff\r\n- /** fee_estimates.dat that are more than 60 hours (2.5 days) will not be read,\r\n+ /**\r\n+  * fee_estimates.dat that are more than 60 hours (2.5 days) will not be read,\r\n```",
      "commit_id" : "d2b39e09bc6a5982fc5cf4b538b7fdb0e3cae576",
      "created_at" : "2023-06-13T18:51:53Z",
      "diff_hunk" : "@@ -14,12 +14,25 @@\n #include <util/fs.h>\n \n #include <array>\n+#include <chrono>\n #include <map>\n #include <memory>\n #include <set>\n #include <string>\n #include <vector>\n \n+\n+// How often to flush fee estimates to fee_estimates.dat.\n+static constexpr std::chrono::hours FEE_FLUSH_INTERVAL{1};\n+\n+/** fee_estimates.dat that are more than 60 hours old, 2 and half days will not be read,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1228568682",
      "id" : 1228568682,
      "in_reply_to_id" : 1223942269,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585JOnhq",
      "original_commit_id" : "efe5f373e12329104f1c706145eee75c2d2079a7",
      "original_line" : 28,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : null,
      "pull_request_review_id" : 1477862322,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1228568682/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-13T19:13:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1228568682",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1228571577"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1228571577"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Question: isn't `bool` small enough to pass by value instead of reference? (i.e. remove the `&` ?)",
      "commit_id" : "d2b39e09bc6a5982fc5cf4b538b7fdb0e3cae576",
      "created_at" : "2023-06-13T18:54:36Z",
      "diff_hunk" : "@@ -528,8 +528,9 @@ bool CBlockPolicyEstimator::_removeTx(const uint256& hash, bool inBlock)\n     }\n }\n \n-CBlockPolicyEstimator::CBlockPolicyEstimator(const fs::path& estimation_filepath)\n-    : m_estimation_filepath{estimation_filepath}\n+CBlockPolicyEstimator::CBlockPolicyEstimator(const fs::path& estimation_filepath, const bool& read_stale_estimates)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1228571577",
      "id" : 1228571577,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585JOoO5",
      "original_commit_id" : "29814149f29ce1858ee3f6ea2fbd37ec411070d6",
      "original_line" : 531,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 1477862322,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 2,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 2,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1228571577/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-13T19:13:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1228571577",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1228573519"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1228573519"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Does this need to be a class property since we only use it one time, during object construction?",
      "commit_id" : "d2b39e09bc6a5982fc5cf4b538b7fdb0e3cae576",
      "created_at" : "2023-06-13T18:56:44Z",
      "diff_hunk" : "@@ -191,9 +194,12 @@ class CBlockPolicyEstimator\n     static constexpr double FEE_SPACING = 1.05;\n \n     const fs::path m_estimation_filepath;\n+\n+    const bool m_read_stale_estimates;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1228573519",
      "id" : 1228573519,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585JOotP",
      "original_commit_id" : "29814149f29ce1858ee3f6ea2fbd37ec411070d6",
      "original_line" : 198,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : null,
      "pull_request_review_id" : 1477862322,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1228573519/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-13T19:13:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1228573519",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1229463323"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1229463323"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "61 hours.",
      "commit_id" : "d2b39e09bc6a5982fc5cf4b538b7fdb0e3cae576",
      "created_at" : "2023-06-14T11:45:58Z",
      "diff_hunk" : "@@ -290,6 +293,95 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.restart_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"feerate\"], fee_rate)\n+\n+        fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+\n+        # Stop the node and backdate the fee_estimates.dat file more than MAX_FILE_AGE\n+        self.stop_node(0)\n+        last_modified_time = time.time() - (MAX_FILE_AGE + 1) * SECONDS_PER_HOUR",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1229463323",
      "id" : 1229463323,
      "in_reply_to_id" : 1225926128,
      "line" : 308,
      "node_id" : "PRRC_kwDOABII585JSB8b",
      "original_commit_id" : "efe5f373e12329104f1c706145eee75c2d2079a7",
      "original_line" : 308,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : 33,
      "pull_request_review_id" : 1479206611,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1229463323/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-14T11:45:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1229463323",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@ismaelsadeeq Are you planning on making any further changes here?",
      "created_at" : "2023-06-14T19:33:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#issuecomment-1591863442",
      "id" : 1591863442,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27622",
      "node_id" : "IC_kwDOABII585e4eiS",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591863442/reactions"
      },
      "updated_at" : "2023-06-14T19:33:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591863442",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @ismaelsadeeq Are you planning on making any further changes here?\r\n\r\nYes I will add all recent feedbacks in next push.",
      "created_at" : "2023-06-14T20:34:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#issuecomment-1591941957",
      "id" : 1591941957,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27622",
      "node_id" : "IC_kwDOABII585e4xtF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591941957/reactions"
      },
      "updated_at" : "2023-06-14T20:34:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591941957",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1230672585"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1230672585"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated, thank you @willcl-ark ",
      "commit_id" : "d2b39e09bc6a5982fc5cf4b538b7fdb0e3cae576",
      "created_at" : "2023-06-15T08:51:59Z",
      "diff_hunk" : "@@ -14,12 +14,25 @@\n #include <util/fs.h>\n \n #include <array>\n+#include <chrono>\n #include <map>\n #include <memory>\n #include <set>\n #include <string>\n #include <vector>\n \n+\n+// How often to flush fee estimates to fee_estimates.dat.\n+static constexpr std::chrono::hours FEE_FLUSH_INTERVAL{1};\n+\n+/** fee_estimates.dat that are more than 60 hours old, 2 and half days will not be read,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1230672585",
      "id" : 1230672585,
      "in_reply_to_id" : 1223942269,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585JWpLJ",
      "original_commit_id" : "efe5f373e12329104f1c706145eee75c2d2079a7",
      "original_line" : 28,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : null,
      "pull_request_review_id" : 1481047373,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1230672585/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-15T08:52:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1230672585",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1230673519"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1230673519"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, thank you. I updated it",
      "commit_id" : "d2b39e09bc6a5982fc5cf4b538b7fdb0e3cae576",
      "created_at" : "2023-06-15T08:52:41Z",
      "diff_hunk" : "@@ -528,8 +528,9 @@ bool CBlockPolicyEstimator::_removeTx(const uint256& hash, bool inBlock)\n     }\n }\n \n-CBlockPolicyEstimator::CBlockPolicyEstimator(const fs::path& estimation_filepath)\n-    : m_estimation_filepath{estimation_filepath}\n+CBlockPolicyEstimator::CBlockPolicyEstimator(const fs::path& estimation_filepath, const bool& read_stale_estimates)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1230673519",
      "id" : 1230673519,
      "in_reply_to_id" : 1228571577,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585JWpZv",
      "original_commit_id" : "29814149f29ce1858ee3f6ea2fbd37ec411070d6",
      "original_line" : 531,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 1481048663,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1230673519/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-15T08:52:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1230673519",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1230674245"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1230674245"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "No, It does not thank you.",
      "commit_id" : "d2b39e09bc6a5982fc5cf4b538b7fdb0e3cae576",
      "created_at" : "2023-06-15T08:53:14Z",
      "diff_hunk" : "@@ -191,9 +194,12 @@ class CBlockPolicyEstimator\n     static constexpr double FEE_SPACING = 1.05;\n \n     const fs::path m_estimation_filepath;\n+\n+    const bool m_read_stale_estimates;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1230674245",
      "id" : 1230674245,
      "in_reply_to_id" : 1228573519,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585JWplF",
      "original_commit_id" : "29814149f29ce1858ee3f6ea2fbd37ec411070d6",
      "original_line" : 198,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : null,
      "pull_request_review_id" : 1481049724,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1230674245/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-15T08:53:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1230674245",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1230675133"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1230675133"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated ð¯ ",
      "commit_id" : "d2b39e09bc6a5982fc5cf4b538b7fdb0e3cae576",
      "created_at" : "2023-06-15T08:53:56Z",
      "diff_hunk" : "@@ -191,9 +194,12 @@ class CBlockPolicyEstimator\n     static constexpr double FEE_SPACING = 1.05;\n \n     const fs::path m_estimation_filepath;\n+\n+    const bool m_read_stale_estimates;\n+\n public:\n     /** Create new BlockPolicyEstimator and initialize stats tracking classes with default values */\n-    CBlockPolicyEstimator(const fs::path& estimation_filepath);\n+    CBlockPolicyEstimator(const fs::path& estimation_filepath, const bool& read_stale_estimates);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1230675133",
      "id" : 1230675133,
      "in_reply_to_id" : 1225923606,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585JWpy9",
      "original_commit_id" : "29814149f29ce1858ee3f6ea2fbd37ec411070d6",
      "original_line" : 202,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/policy/fees.h",
      "position" : null,
      "pull_request_review_id" : 1481051017,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1230675133/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-15T08:53:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1230675133",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@ismaelsadeeq just FYI if you don't have to rebase on master due to a conflict, don't. It's extra review burden and makes getting re-ACKs harder.",
      "created_at" : "2023-06-15T10:33:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#issuecomment-1592790354",
      "id" : 1592790354,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27622",
      "node_id" : "IC_kwDOABII585e8A1S",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1592790354/reactions"
      },
      "updated_at" : "2023-06-15T10:33:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1592790354",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @ismaelsadeeq just FYI if you don't have to rebase on master due to a conflict, don't. It's extra review burden and makes getting re-ACKs harder.\r\n\r\nOhh Sorry, Thank you for pointing this out.\r\nIts okay now I think and any further nit changes I would address in a follow-up.",
      "created_at" : "2023-06-15T10:53:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#issuecomment-1592814535",
      "id" : 1592814535,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27622",
      "node_id" : "IC_kwDOABII585e8GvH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1592814535/reactions"
      },
      "updated_at" : "2023-06-15T10:53:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1592814535",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Just noting my understanding of this and the followup [pull](https://github.com/bitcoin/bitcoin/pull/27859) and how they work together.\r\n\r\nIn this PR we will regularly persist fee estimations to _fee_estimates.dat_, providing more protection in an unclean shutdown scenario. We then reload these on startup, under then new condition that they are less than 2.5 days old.\r\n\r\n1. In the case where the restart is instant/very fast this let's us keep accurate fee estimation after a crash.\r\n2. In the case where the restart is > 60 hours then we are improved in that we don't serve known stale data.\r\n3. In the case where fees start high (or low), and remain high (or low), this will help us with more accurate fee estimation after restart.\r\n4. If fees start high and descrease then we may have too-high fee estimation, which still helps us avoid unwated stuck transactions.\r\n5. If fees start low and increased then our fee estimation may report too-low. Although this pull doesn't help directly in this case, it's not worse than current behaviour and the expiry should make it strictly better.\r\n\r\nIn the followup pull, persisting mempool_min_fee to disk is much more sensitive than fee estimation data. If we used outdated rates here we may start rejecting valid tx from the p2p network from our mempool which may be undesirable. Therefore IMO it makes sense there to be much more strict about the lifetime of mempool_min_fee rates read from disk at startup; perhaps something more in the order of 1 hour?",
      "created_at" : "2023-06-15T11:18:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#issuecomment-1592855916",
      "id" : 1592855916,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27622",
      "node_id" : "IC_kwDOABII585e8Q1s",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1592855916/reactions"
      },
      "updated_at" : "2023-06-15T11:18:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1592855916",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "concept ACK\r\n",
      "created_at" : "2023-06-15T17:49:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#issuecomment-1593496143",
      "id" : 1593496143,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27622",
      "node_id" : "IC_kwDOABII585e-tJP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1593496143/reactions"
      },
      "updated_at" : "2023-06-15T18:08:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1593496143",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/152159?v=4",
         "events_url" : "https://api.github.com/users/RandyMcMillan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/RandyMcMillan/followers",
         "following_url" : "https://api.github.com/users/RandyMcMillan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/RandyMcMillan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/RandyMcMillan",
         "id" : 152159,
         "login" : "RandyMcMillan",
         "node_id" : "MDQ6VXNlcjE1MjE1OQ==",
         "organizations_url" : "https://api.github.com/users/RandyMcMillan/orgs",
         "received_events_url" : "https://api.github.com/users/RandyMcMillan/received_events",
         "repos_url" : "https://api.github.com/users/RandyMcMillan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/RandyMcMillan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/RandyMcMillan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/RandyMcMillan"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "In this scenario - the node is going to have to sync - whether it was shut down for 1 hour or 60+ hours. IMO it would be ideal to not have **one more thing** dependent upon system time when booting up the node (*There are other issues related to system time when booting up the node). Since we know that the node must connect and sync - I think the ideal is to delay the file age check later into the life cycle of the node.\r\n\r\n*In the scenario where system time has been skewed - off by many hours - there is a possibility that the file age is \"in the future\". You may want to use absolute value in the file age check... this will remove the possibility of a negative value for file age.",
      "created_at" : "2023-06-15T19:02:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#issuecomment-1593580088",
      "id" : 1593580088,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27622",
      "node_id" : "IC_kwDOABII585e_Bo4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1593580088/reactions"
      },
      "updated_at" : "2023-06-15T19:02:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1593580088",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/152159?v=4",
         "events_url" : "https://api.github.com/users/RandyMcMillan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/RandyMcMillan/followers",
         "following_url" : "https://api.github.com/users/RandyMcMillan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/RandyMcMillan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/RandyMcMillan",
         "id" : 152159,
         "login" : "RandyMcMillan",
         "node_id" : "MDQ6VXNlcjE1MjE1OQ==",
         "organizations_url" : "https://api.github.com/users/RandyMcMillan/orgs",
         "received_events_url" : "https://api.github.com/users/RandyMcMillan/received_events",
         "repos_url" : "https://api.github.com/users/RandyMcMillan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/RandyMcMillan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/RandyMcMillan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/RandyMcMillan"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Since we know that the node must connect and sync - I think the ideal is to delay the file age check later into the life cycle of the node.\r\n\r\nNot sure what the suggestion is. Can you be specific?",
      "created_at" : "2023-06-15T19:06:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#issuecomment-1593585369",
      "id" : 1593585369,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27622",
      "node_id" : "IC_kwDOABII585e_C7Z",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1593585369/reactions"
      },
      "updated_at" : "2023-06-15T19:06:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1593585369",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> In this scenario - the node is going to have to sync - whether it was shut down for 1 hour or 60+ hours. IMO it would be ideal to not have **one more thing** dependent upon system time when booting up the node\r\n\r\nI don't see how this is very problematic - we are checking the timestamp we put on our own file, which is only used for fee estimation.\r\n\r\n> *In the scenario where system time has been skewed - off by many hours - there is a possibility that the file age is \"in the future\". You may want to use absolute value in the file age check... this will remove the possibility of a negative value for file age.\r\n\r\nIf you manage to be off by more than 60 hours, your node will have much worse problems. We reject blocks if they are `MAX_FUTURE_BLOCK_TIME` i.e. 2 hours into the future. Clocks don't need to be completely synced, but they're not supposed to be wildly off.",
      "created_at" : "2023-06-19T12:31:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#issuecomment-1597103914",
      "id" : 1597103914,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27622",
      "node_id" : "IC_kwDOABII585fMd8q",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1597103914/reactions"
      },
      "updated_at" : "2023-06-19T12:31:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1597103914",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1235204323"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1235204323"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: Personally I don't think comments like this are particularly needed/useful, as they are just describing exactly the code below. I ususally try and save them for when something reads as unexpected or I want to add a reason _why_ I am doing something.\r\n\r\nIn the comment 7 lines below it could be a useful comment (in my opinion) if it read something like: \"serving stale fee estimates can cause transactions to become stuck in the bottom of the mempool in the worst case. Don't do that.\" As this explains _why_ we expire fee estimates.",
      "commit_id" : "d2b39e09bc6a5982fc5cf4b538b7fdb0e3cae576",
      "created_at" : "2023-06-20T12:37:50Z",
      "diff_hunk" : "@@ -545,9 +546,22 @@ CBlockPolicyEstimator::CBlockPolicyEstimator(const fs::path& estimation_filepath\n     shortStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, SHORT_BLOCK_PERIODS, SHORT_DECAY, SHORT_SCALE));\n     longStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, LONG_BLOCK_PERIODS, LONG_DECAY, LONG_SCALE));\n \n-    // If the fee estimation file is present, read recorded estimations\n     AutoFile est_file{fsbridge::fopen(m_estimation_filepath, \"rb\")};\n-    if (est_file.IsNull() || !Read(est_file)) {\n+\n+    // Whenever the fee estimation file is not present return early",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1235204323",
      "id" : 1235204323,
      "line" : 551,
      "node_id" : "PRRC_kwDOABII585Jn7jj",
      "original_commit_id" : "3eb241a141defa564c94cb95c5bbaf4c5bd9682e",
      "original_line" : 551,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : 25,
      "pull_request_review_id" : 1488054498,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1235204323/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-20T12:55:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1235204323",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1235218268"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1235218268"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: There's no test to ensure that stale estimates _aren't_ accepted on non-regtest networks, and I'm not sure there particularly needs to be. But I verified manually that this was the case:\r\n\r\n```log\r\n$./src/bitcoind -testnet -acceptstalefeeestimates\r\n2023-06-20T12:47:07Z Error: acceptstalefeeestimates is not supported on test chain.\r\n2023-06-20T12:47:07Z Shutdown: In progress...\r\n2023-06-20T12:47:07Z scheduler thread exit\r\n2023-06-20T12:47:07Z Shutdown: done\r\n```",
      "commit_id" : "d2b39e09bc6a5982fc5cf4b538b7fdb0e3cae576",
      "created_at" : "2023-06-20T12:49:01Z",
      "diff_hunk" : "@@ -290,6 +293,95 @@ def sanity_check_rbf_estimates(self, utxos):\n         est_feerate = node.estimatesmartfee(2)[\"feerate\"]\n         assert_equal(est_feerate, high_feerate_kvb)\n \n+    def test_old_fee_estimate_file(self):\n+        # Get the initial fee rate while node is running\n+        fee_rate = self.nodes[0].estimatesmartfee(1)[\"feerate\"]\n+\n+        # Restart node to ensure fee_estimate.dat file is read\n+        self.restart_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"feerate\"], fee_rate)\n+\n+        fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+\n+        # Stop the node and backdate the fee_estimates.dat file more than MAX_FILE_AGE\n+        self.stop_node(0)\n+        last_modified_time = time.time() - (MAX_FILE_AGE + 1) * SECONDS_PER_HOUR\n+        os.utime(fee_dat, (last_modified_time, last_modified_time))\n+\n+        # Start node and ensure the fee_estimates.dat file was not read\n+        self.start_node(0)\n+        assert_equal(self.nodes[0].estimatesmartfee(1)[\"errors\"], [\"Insufficient data or no feerate found\"])\n+\n+\n+    def test_estimate_dat_is_flushed_periodically(self):\n+        fee_dat = self.nodes[0].chain_path / \"fee_estimates.dat\"\n+        os.remove(fee_dat) if os.path.exists(fee_dat) else None\n+\n+        # Verify that fee_estimates.dat does not exist\n+        assert_equal(os.path.isfile(fee_dat), False)\n+\n+        # Verify if the string \"Flushed fee estimates to fee_estimates.dat.\" is present in the debug log file.\n+        # If present, it indicates that fee estimates have been successfully flushed to disk.\n+        with self.nodes[0].assert_debug_log(expected_msgs=[\"Flushed fee estimates to fee_estimates.dat.\"], timeout=1):\n+            # Mock the scheduler for an hour to flush fee estimates to fee_estimates.dat\n+            self.nodes[0].mockscheduler(SECONDS_PER_HOUR)\n+\n+        # Verify that fee estimates were flushed and fee_estimates.dat file is created\n+        assert_equal(os.path.isfile(fee_dat), True)\n+\n+        # Verify that the estimates remain the same if there are no blocks in the flush interval\n+        block_hash_before = self.nodes[0].getbestblockhash()\n+        fee_dat_initial_content = open(fee_dat, \"rb\").read()\n+        with self.nodes[0].assert_debug_log(expected_msgs=[\"Flushed fee estimates to fee_estimates.dat.\"], timeout=1):\n+            # Mock the scheduler for an hour to flush fee estimates to fee_estimates.dat\n+            self.nodes[0].mockscheduler(SECONDS_PER_HOUR)\n+\n+        # Verify that there were no blocks in between the flush interval\n+        assert_equal(block_hash_before, self.nodes[0].getbestblockhash())\n+\n+        fee_dat_current_content = open(fee_dat, \"rb\").read()\n+        assert_equal(fee_dat_current_content, fee_dat_initial_content)\n+\n+        # Verify that the estimates remain the same after shutdown with no blocks before shutdown\n+        self.restart_node(0)\n+        fee_dat_current_content = open(fee_dat, \"rb\").read()\n+        assert_equal(fee_dat_current_content, fee_dat_initial_content)\n+\n+        # Verify that the estimates are not the same if new blocks were produced in the flush interval\n+        with self.nodes[0].assert_debug_log(expected_msgs=[\"Flushed fee estimates to fee_estimates.dat.\"], timeout=1):\n+            # Mock the scheduler for an hour to flush fee estimates to fee_estimates.dat\n+            self.generate(self.nodes[0], 5, sync_fun=self.no_op)\n+            self.nodes[0].mockscheduler(SECONDS_PER_HOUR)\n+\n+        fee_dat_current_content = open(fee_dat, \"rb\").read()\n+        assert fee_dat_current_content != fee_dat_initial_content\n+\n+        fee_dat_initial_content = fee_dat_current_content\n+\n+        # Generate blocks before shutdown and verify that the fee estimates are not the same\n+        self.generate(self.nodes[0], 5, sync_fun=self.no_op)\n+        self.restart_node(0)\n+        fee_dat_current_content = open(fee_dat, \"rb\").read()\n+        assert fee_dat_current_content != fee_dat_initial_content\n+\n+\n+    def test_acceptstalefeeestimates_option(self):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1235218268",
      "id" : 1235218268,
      "line" : 368,
      "node_id" : "PRRC_kwDOABII585Jn-9c",
      "original_commit_id" : "d2b39e09bc6a5982fc5cf4b538b7fdb0e3cae576",
      "original_line" : 368,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : 93,
      "pull_request_review_id" : 1488054498,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 2,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 2,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1235218268/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-20T12:55:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1235218268",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1235266409"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1235266409"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Not blocking, but I agree. Comments are generally required when the code fails to self-document. This whole section is self-explanatory, which is good, meaning comments aren't really required.",
      "commit_id" : "d2b39e09bc6a5982fc5cf4b538b7fdb0e3cae576",
      "created_at" : "2023-06-20T13:25:40Z",
      "diff_hunk" : "@@ -545,9 +546,22 @@ CBlockPolicyEstimator::CBlockPolicyEstimator(const fs::path& estimation_filepath\n     shortStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, SHORT_BLOCK_PERIODS, SHORT_DECAY, SHORT_SCALE));\n     longStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, LONG_BLOCK_PERIODS, LONG_DECAY, LONG_SCALE));\n \n-    // If the fee estimation file is present, read recorded estimations\n     AutoFile est_file{fsbridge::fopen(m_estimation_filepath, \"rb\")};\n-    if (est_file.IsNull() || !Read(est_file)) {\n+\n+    // Whenever the fee estimation file is not present return early",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27622#discussion_r1235266409",
      "id" : 1235266409,
      "in_reply_to_id" : 1235204323,
      "line" : 551,
      "node_id" : "PRRC_kwDOABII585JoKtp",
      "original_commit_id" : "3eb241a141defa564c94cb95c5bbaf4c5bd9682e",
      "original_line" : 551,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : 25,
      "pull_request_review_id" : 1488151061,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27622",
      "reactions" : {
         "+1" : 2,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 2,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1235266409/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-20T13:25:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1235266409",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   }
]
