[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26289](https://github.com/bitcoin/bitcoin/pull/26289) (Use util::Result in for calculating mempool ancestors by stickies-v)\n* [#26286](https://github.com/bitcoin/bitcoin/pull/26286) (test: Remove unused txmempool include from tests by MarcoFalke)\n* [#26140](https://github.com/bitcoin/bitcoin/pull/26140) (refactor: Move CNodeState members guarded by g_msgproc_mutex to Peer by dergoegge)\n* [#25862](https://github.com/bitcoin/bitcoin/pull/25862) (refactor, kernel: Remove gArgs accesses from dbwrapper and txdb by ryanofsky)\n* [#25704](https://github.com/bitcoin/bitcoin/pull/25704) (refactor: Remove almost all validation option globals by MarcoFalke)\n* [#25152](https://github.com/bitcoin/bitcoin/pull/25152) (refactor: Split util/system into exception, shell, and fs-specific files by Empact)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-08-23T15:30:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25908#issuecomment-1224238085",
      "id" : 1224238085,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25908",
      "node_id" : "IC_kwDOABII585I-GQF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1224238085/reactions"
      },
      "updated_at" : "2022-10-19T04:57:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1224238085",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, light code review ACK.",
      "created_at" : "2022-08-24T07:31:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25908#issuecomment-1225311231",
      "id" : 1225311231,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25908",
      "node_id" : "IC_kwDOABII585JCMP_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1225311231/reactions"
      },
      "updated_at" : "2022-08-24T07:31:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1225311231",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25908#discussion_r953467821"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25908"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/953467821"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe keep this field and instead return the  median offset of the currently connected outbounds or so? See also https://github.com/bitcoin/bitcoin/pull/24606#issuecomment-1107815177",
      "commit_id" : "6a860cdd4a434432369fcdde6d369c84205568c3",
      "created_at" : "2022-08-24T07:50:30Z",
      "diff_hunk" : "@@ -638,7 +636,6 @@ static RPCHelpMan getnetworkinfo()\n     if (node.peerman) {\n         obj.pushKV(\"localrelay\", !node.peerman->IgnoresIncomingTxs());\n     }\n-    obj.pushKV(\"timeoffset\",    GetTimeOffset());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25908#discussion_r953467821",
      "id" : 953467821,
      "line" : 641,
      "node_id" : "PRRC_kwDOABII58441MOt",
      "original_commit_id" : "6a860cdd4a434432369fcdde6d369c84205568c3",
      "original_line" : 641,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : 20,
      "pull_request_review_id" : 1083324659,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25908",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/953467821/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-24T07:50:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/953467821",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25908#discussion_r955786593"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25908"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/955786593"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Perhaps:\r\n\r\n```c++\r\nif (!pfrom.IsInboundConn() && std::abs(pfrom.nTimeOffset) >= 1800) {\r\n    ++m_bad_non_inbound_time_offset;\r\n    if (m_bad_non_inbound_time_offset == 3) {\r\n        SetMiscWarning(\"Please check your computer's date and time are correct\");\r\n    }\r\n}\r\n``` \r\n\r\n(ie, add a counter to `PeerManagerImpl`, and on the third outbound connection that has a time offset of 30mins or more, set a warning that will show up in `getblockchaininfo`, `getnetworkinfo`, `getmininginfo` until restart)",
      "commit_id" : "6a860cdd4a434432369fcdde6d369c84205568c3",
      "created_at" : "2022-08-26T08:19:40Z",
      "diff_hunk" : "@@ -2988,13 +2987,7 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                   peer->m_starting_height, addrMe.ToString(), fRelay, pfrom.GetId(),\n                   remoteAddr);\n \n-        int64_t nTimeOffset = nTime - GetTime();\n-        pfrom.nTimeOffset = nTimeOffset;\n-        if (!pfrom.IsInboundConn()) {\n-            // Don't use timedata samples from inbound peers to make it\n-            // harder for others to tamper with our adjusted time.\n-            AddTimeData(pfrom.addr, nTimeOffset);\n-        }\n+        pfrom.nTimeOffset = nTime - GetTime();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25908#discussion_r955786593",
      "id" : 955786593,
      "line" : 2990,
      "node_id" : "PRRC_kwDOABII5844-CVh",
      "original_commit_id" : "6a860cdd4a434432369fcdde6d369c84205568c3",
      "original_line" : 2990,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 28,
      "pull_request_review_id" : 1086590902,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25908",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/955786593/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-26T08:19:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/955786593",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2022-09-26T10:44:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25908#issuecomment-1257840725",
      "id" : 1257840725,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25908",
      "node_id" : "IC_kwDOABII585K-SBV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1257840725/reactions"
      },
      "updated_at" : "2022-09-26T10:44:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1257840725",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
         "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dergoegge/followers",
         "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dergoegge",
         "id" : 8077169,
         "login" : "dergoegge",
         "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
         "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
         "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
         "repos_url" : "https://api.github.com/users/dergoegge/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dergoegge"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Before, this change even if the clock drifts, it's at least corrected in the bound of DEFAULT_MAX_TIME_ADJUSTEMENT.\r\n\r\nNo correction will happen if your time drifts and you only ever cycle through at most 4 distinct honest outbound connections. Also, no correction will happen if your time drifts after you made more than `BITCOIN_TIMEDATA_MAX_SAMPLES/2+1` distinct honest outbound connections. Instead of a false promise that adjusted time will correct an incorrect system clock, it would be better for the system operator to correct the system clock.\r\n\r\nI don't see a way that adjusted time can be helping some without also harming others. Every instance where it provides a \"fix\" for some users, it opens the attack surface for users that are not affected by the problem. For example, if an attacker can influence enough (not all) outgoing connections of your node, they can likely get you out of consensus with a perfectly synced system clock. This also breaks the assumption that a single honest connection would be sufficient for you to stay in consensus.\r\n\r\n",
      "created_at" : "2022-10-02T12:30:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25908#issuecomment-1264632475",
      "id" : 1264632475,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25908",
      "node_id" : "IC_kwDOABII585LYMKb",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1264632475/reactions"
      },
      "updated_at" : "2022-10-02T12:30:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1264632475",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> No correction will happen if your time drifts and you only ever cycle through at most 4 distinct honest outbound connections. Also, no correction will happen if your time drifts after you made more than BITCOIN_TIMEDATA_MAX_SAMPLES/2+1 distinct honest outbound connections. Instead of a false promise that adjusted time will correct an incorrect system clock, it would be better for the system operator to correct the system clock.\r\n\r\nFrom my understanding, there is at least a correction brought to your system clock once you have at most 4 distinct honest outbound connections and before you have made more than BITCOIN_TIMEDATA_MAX_SAMPLES/2+1, which I think made my point correct that the existence of a correction hardens the attack game for an adversary targeting your NTP syncing, even minimally. Noting this correction is featherweight if you're facing an adversary with BGP capabilities, I don't deny it.\r\n\r\nI would agree a better protection would be effectively for the system operator to correct the system clock, a good question being if we can achieve this at the bitcoind-level with a warning system potentially based on peers clocks, or we should recommend high-stakes users to be their own stratum 0 servers, and directly get time from GPS or a non-Internet time source.\r\n\r\n> For example, if an attacker can influence enough (not all) outgoing connections of your node, they can likely get you out of consensus with a perfectly synced system clock. \r\n\r\nAssuming you're starting with a perfectly synced system clock, as we're bounded with `DEFAULT_MAX_TIME_ADJUSTEMENT`, of an effective value of 70min, the attacker won't be able to make you reject block due to seen timestamp being too far in the future. From my comprehension, current adjusted time does not break the assumption that a single honest connection would be sufficient to stay in consensus.  ",
      "created_at" : "2022-10-07T00:49:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25908#issuecomment-1270930577",
      "id" : 1270930577,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25908",
      "node_id" : "IC_kwDOABII585LwNyR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1270930577/reactions"
      },
      "updated_at" : "2022-10-07T00:49:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1270930577",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "They could delay your time by 70min and then mine blocks 2h ahead (or advance the time of another miner by 70min), which would make you lag on consensus and throw away your hashrate (if you have any) for as long as the latest block is too far ahead.",
      "created_at" : "2022-10-07T07:49:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25908#issuecomment-1271239626",
      "id" : 1271239626,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25908",
      "node_id" : "IC_kwDOABII585LxZPK",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1271239626/reactions"
      },
      "updated_at" : "2022-10-07T07:49:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1271239626",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25908#discussion_r989832852"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25908"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/989832852"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Alternatively, we regularly do new feeler and blocks-only connections, perhaps we could keep a rolling average of `abs(peer.nTimeOffset)` and report that in `getnetworkinfo`?",
      "commit_id" : "6a860cdd4a434432369fcdde6d369c84205568c3",
      "created_at" : "2022-10-07T08:29:28Z",
      "diff_hunk" : "@@ -2988,13 +2987,7 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                   peer->m_starting_height, addrMe.ToString(), fRelay, pfrom.GetId(),\n                   remoteAddr);\n \n-        int64_t nTimeOffset = nTime - GetTime();\n-        pfrom.nTimeOffset = nTimeOffset;\n-        if (!pfrom.IsInboundConn()) {\n-            // Don't use timedata samples from inbound peers to make it\n-            // harder for others to tamper with our adjusted time.\n-            AddTimeData(pfrom.addr, nTimeOffset);\n-        }\n+        pfrom.nTimeOffset = nTime - GetTime();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25908#discussion_r989832852",
      "id" : 989832852,
      "in_reply_to_id" : 955786593,
      "line" : 2990,
      "node_id" : "PRRC_kwDOABII5846_6aU",
      "original_commit_id" : "6a860cdd4a434432369fcdde6d369c84205568c3",
      "original_line" : 2990,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 28,
      "pull_request_review_id" : 1134108622,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25908",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/989832852/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-10-07T08:29:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/989832852",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-10-19T09:30:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25908#issuecomment-1283706928",
      "id" : 1283706928,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25908",
      "node_id" : "IC_kwDOABII585Mg9Aw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1283706928/reactions"
      },
      "updated_at" : "2022-10-19T09:30:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1283706928",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   }
]
