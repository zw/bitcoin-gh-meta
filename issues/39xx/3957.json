{
   "assignee" : null,
   "body" : "Using bitcoind v0.9.0rc2-17-gd33f69a-beta (64-bit).  When using bitcoinj as a client to  to retrieve blocks from bitcoind with the wire protocol recent blocks were able to be retrieved as normal but when starting at the genesis block invalid blocks were being returned.\r\n\r\nThe following steps were taken:\r\n1/ complete ver/verack handshake\r\n2/ send getblocks message using genesis block hash as the locator\r\n3/ receive inv message with 500 block hashes.  The first 5 were manually validated as correct by checking blockchain.info\r\n4/ send getblocks message using the same inventory items from the previous inv message.\r\n5/ 500 block messages returned by bitcoind.  However every block 81 bytes long.  First byte was 0x02 (which is the wrong version for the genesis block) followed by 80 0x00 bytes.\r\n\r\nAfter much investigating it turns out blk00000.dat was missing.  Apparently rather than failing when unable to locate the block in the blockchain bitcoind was returning zeroed arrays of bytes.  Whilst a peer could probably recover from connecting to a bitcoind in this state as it will simply ignore the obviously invalid blocks it's not quite the behaviour you'd expect.  The client behaved completely normally as a client.  Guessing it would have continued to do so unless the wallet contained outputs from the missing blkxxxxx.dat.\r\n\r\nUnable to pinpoint when the file was deleted but likely it was several weeks ago and the client has been running happilly without it.\r\n\r\nPresumably the indexes where still present as the bitcoind was able to produce a valid inv response to getblocks.\r\n\r\n",
   "closed_at" : "2014-06-01T15:48:45Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
      "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
      "followers_url" : "https://api.github.com/users/laanwj/followers",
      "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/laanwj",
      "id" : 126646,
      "login" : "laanwj",
      "organizations_url" : "https://api.github.com/users/laanwj/orgs",
      "received_events_url" : "https://api.github.com/users/laanwj/received_events",
      "repos_url" : "https://api.github.com/users/laanwj/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/laanwj"
   },
   "comments" : 2,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3957/comments",
   "created_at" : "2014-03-25T09:39:34Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3957/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/3957",
   "id" : 30108431,
   "labels" : [
      {
         "color" : "FBBAAB",
         "name" : "Bug",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3957/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 3957,
   "state" : "closed",
   "title" : "Missing blk00000.dat doesn't cause failure when retrieving blocks.",
   "updated_at" : "2014-06-01T15:48:45Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3957",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/947848?v=3",
      "events_url" : "https://api.github.com/users/shadders/events{/privacy}",
      "followers_url" : "https://api.github.com/users/shadders/followers",
      "following_url" : "https://api.github.com/users/shadders/following{/other_user}",
      "gists_url" : "https://api.github.com/users/shadders/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/shadders",
      "id" : 947848,
      "login" : "shadders",
      "organizations_url" : "https://api.github.com/users/shadders/orgs",
      "received_events_url" : "https://api.github.com/users/shadders/received_events",
      "repos_url" : "https://api.github.com/users/shadders/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/shadders/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/shadders/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/shadders"
   }
}
