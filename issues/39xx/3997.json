{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "I've been running bitcoin-qt inside gdb for over a year now, because it used to crash pretty often.  It just crashed for the first time in over 6 months, a week or two after upgrading to the recent release.  I would guess this is a new issue introduced in 0.9.\n\nI built the code myself, from the git v0.9.0 tag, on a 64 bit Linux system.\n\nHere's what gdb said:\n\n```\nProgram received signal SIGSEGV, Segmentation fault.\nCMerkleTx::GetDepthInMainChainINTERNAL (this=this@entry=0x7fffb77d7ac0, \n    pindexRet=@0x7fffffffd148: 0x555556ca0120) at main.cpp:884\n884     if (!pindex || !chainActive.Contains(pindex))\n(gdb) where\n#0  CMerkleTx::GetDepthInMainChainINTERNAL (this=this@entry=0x7fffb77d7ac0, \n    pindexRet=@0x7fffffffd148: 0x555556ca0120) at main.cpp:884\n#1  0x000055555571dca6 in CMerkleTx::GetDepthInMainChain (\n    this=this@entry=0x7fffb77d7ac0, pindexRet=@0x7fffffffd148: 0x555556ca0120)\n    at main.cpp:901\n#2  0x00005555556b632d in GetDepthInMainChain (this=0x7fffb77d7ac0)\n    at ../../src/main.h:466\n#3  CWalletTx::IsTrusted (this=this@entry=0x7fffb77d7ac0)\n    at ../../src/wallet.h:665\n#4  0x00005555556b40cd in TransactionRecord::updateStatus (\n    this=this@entry=0x555556c00ca0, wtx=...) at transactionrecord.cpp:167\n#5  0x00005555556933cd in TransactionTablePriv::index (this=<optimized out>, \n    idx=idx@entry=6314) at transactiontablemodel.cpp:201\n#6  0x000055555569231e in TransactionTableModel::index (this=0x555556a5b340, \n    row=6314, column=0, parent=...) at transactiontablemodel.cpp:615\n#7  0x000055555568f398 in TransactionFilterProxy::filterAcceptsRow (this=\n    0x55555625ee30, sourceRow=6314, sourceParent=...)\n    at transactionfilterproxy.cpp:33\n```\n\nand here's debug.log (it looks like bitcoin-qt was only just getting started):\n\n```\n2014-03-31 04:41:51 Bitcoin version v0.9.0-1-gd824858-beta (2014-03-20 09:19:05 -0700)\n2014-03-31 04:41:51 Using OpenSSL version OpenSSL 1.0.1c 10 May 2012\n2014-03-31 04:41:51 Default data directory /home/chris/.bitcoin\n2014-03-31 04:41:51 Using data directory /home/chris/.bitcoin\n2014-03-31 04:41:51 Using at most 125 connections (1024 file descriptors available)\n2014-03-31 04:41:51 Using 2 threads for script verification\n2014-03-31 04:41:51 Using wallet wallet.dat\n2014-03-31 04:41:51 init message: Verifying wallet...\n2014-03-31 04:41:51 dbenv.open LogDir=/home/chris/.bitcoin/database ErrorFile=/home/chris/.bitcoin/db.log\n2014-03-31 04:42:16 Bound to [::]:8333\n2014-03-31 04:42:16 Bound to 0.0.0.0:8333\n2014-03-31 04:42:16 init message: Loading block index...\n2014-03-31 04:42:16 Opening LevelDB in /home/chris/.bitcoin/blocks/index\n2014-03-31 04:42:17 Opened LevelDB successfully\n2014-03-31 04:42:17 Opening LevelDB in /home/chris/.bitcoin/chainstate\n2014-03-31 04:42:18 Opened LevelDB successfully\n2014-03-31 04:42:36 LoadBlockIndexDB(): last block file = 89\n2014-03-31 04:42:36 LoadBlockIndexDB(): last block file info: CBlockFileInfo(blocks=338, size=67010312, heights=292948...293280, time=2014-03-28...2014-03-30)\n2014-03-31 04:42:36 LoadBlockIndexDB(): transaction index disabled\n2014-03-31 04:42:36 LoadBlockIndexDB(): hashBestChain=000000000000000052d11e4b468cf8e66152f4687ccf6f7b24a4eb8c7c183bbb height=293280 date=2014-03-30 20:05:47 progress=0.998126\n2014-03-31 04:42:36 init message: Verifying blocks...\n2014-03-31 04:42:36 Verifying last 288 blocks at level 2\n2014-03-31 04:43:30 No coin database inconsistencies in last 0 blocks (0 transactions)\n2014-03-31 04:43:30  block index           74479ms\n2014-03-31 04:43:30 init message: Loading wallet...\n2014-03-31 04:44:50 nFileVersion = 90000\n2014-03-31 04:44:50 Keys: 36667 plaintext, 0 encrypted, 0 w/ metadata, 36667 total\n2014-03-31 04:44:50  wallet                80181ms\n2014-03-31 04:44:50 init message: Loading addresses...\n2014-03-31 04:44:50 Loaded 18722 addresses from peers.dat  118ms\n2014-03-31 04:44:50 mapBlockIndex.size() = 293606\n2014-03-31 04:44:50 nBestHeight = 293280\n2014-03-31 04:44:50 setKeyPool.size() = 4996\n2014-03-31 04:44:50 mapWallet.size() = 30432\n2014-03-31 04:44:50 mapAddressBook.size() = 19485\n2014-03-31 04:44:50 ext-ip thread start\n2014-03-31 04:44:50 dnsseed thread start\n2014-03-31 04:44:50 net thread start\n2014-03-31 04:44:50 Loading addresses from DNS seeds (could take a while)\n2014-03-31 04:44:50 addcon thread start\n2014-03-31 04:44:50 msghand thread start\n2014-03-31 04:44:50 opencon thread start\n2014-03-31 04:44:50 dumpaddr thread start\n2014-03-31 04:44:50 init message: Done loading\n2014-03-31 04:44:51 ERROR: AcceptToMemoryPool : nonstandard transaction: dust\n2014-03-31 04:44:51 GetMyExternalIP() received [a.b.c.d] a.b.c.d:0\n2014-03-31 04:44:51 GetMyExternalIP() returned a.b.c.d\n2014-03-31 04:44:51 AddLocal(a.b.c.d:8333,4)\n2014-03-31 04:44:51 ext-ip thread exit\n2014-03-31 04:44:51 ERROR: AcceptToMemoryPool : nonstandard transaction: dust\n2014-03-31 04:44:51 ERROR: AcceptToMemoryPool : nonstandard transaction: dust\n2014-03-31 04:44:51 ERROR: AcceptToMemoryPool : nonstandard transaction: dust\n2014-03-31 04:44:51 receive version message: /Satoshi:0.8.6/: version 70001, blocks=293333, us=a.b.c.d:9089, them=e.f.g.h:8333, peer=e.f.g.h:8333\n2014-03-31 04:44:51 Added time data, samples 2, offset -7 (+0 minutes)\n2014-03-31 04:44:51 ERROR: AcceptToMemoryPool : nonstandard transaction: dust\n2014-03-31 04:44:51 Initialization result: 1\n2014-03-31 04:44:53 Pre-allocating up to position 0x5000000 in blk00089.dat\n2014-03-31 04:45:08 118 addresses found from DNS seeds\n2014-03-31 04:45:08 dnsseed thread exit\n```\n",
   "closed_at" : "2014-04-22T11:35:47Z",
   "closed_by" : {
      "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
      "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
      "followers_url" : "https://api.github.com/users/laanwj/followers",
      "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/laanwj",
      "id" : 126646,
      "login" : "laanwj",
      "organizations_url" : "https://api.github.com/users/laanwj/orgs",
      "received_events_url" : "https://api.github.com/users/laanwj/received_events",
      "repos_url" : "https://api.github.com/users/laanwj/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/laanwj"
   },
   "comments" : 32,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3997/comments",
   "created_at" : "2014-04-02T20:16:29Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3997/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/3997",
   "id" : 30721356,
   "labels" : [
      {
         "color" : "FBBAAB",
         "default" : false,
         "id" : 64585,
         "name" : "Bug",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3997/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 3997,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "crash in CMerkleTx::GetDepthInMainChainINTERNAL()",
   "updated_at" : "2018-04-13T11:01:27Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3997",
   "user" : {
      "avatar_url" : "https://avatars3.githubusercontent.com/u/573356?v=4",
      "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
      "followers_url" : "https://api.github.com/users/dooglus/followers",
      "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
      "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/dooglus",
      "id" : 573356,
      "login" : "dooglus",
      "organizations_url" : "https://api.github.com/users/dooglus/orgs",
      "received_events_url" : "https://api.github.com/users/dooglus/received_events",
      "repos_url" : "https://api.github.com/users/dooglus/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/dooglus"
   }
}
