[
   {
      "body" : "@jnewbery Sorry for taking so long. Assuming there is a race condition where your side ends up scanning the chain before the abort makes it through, this should definitely fix it, I think. The tests take ~4 mins on my machine, but they're already in extended tests.\r\nIf this still shows intermittent failures on your end, I will need to go back to the drawing board, as it has to be something other than the above.",
      "created_at" : "2017-08-10T09:27:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-321500351",
      "id" : 321500351,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-08-10T09:27:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/321500351",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "body" : "This may be specific to my local environment, but if I try to run this test multiple times in parallel, I get failures:\r\n\r\n```\r\nÃ¢ÂÂ ./test_runner.py $(for i in {1..40}; do echo -n 'import-abort-rescan '; done)\r\nTemporary test directory at /tmp/user/1000/bitcoin_test_runner_20170814_134812\r\nWARNING! The following scripts are not being run: ['test_bitcoincli.py', 'bip65-cltv.py', 'wallet-labels.py', 'p2p-fullblocktest2.py', 'bitcoin_cli.py', 'keypool-topup.py', 'wallet-hd-restore.py', 'disablehot.py', 'blocknotify.py', 'getblocktemplate_proposals.py', 'resendwallettransactions.py', 'minchainwork.py', 'walletnotify.py', 'bipdersig.py', 'datalogging.py']. Check the test lists in test_runner.py.\r\n.......................................................................................................................................................................................\r\nimport-abort-rescan.py failed, Duration: 97 s\r\n\r\nstdout:\r\n2017-08-14 13:48:33.367000 TestFramework (INFO): Initializing test directory /tmp/user/1000/bitcoin_test_runner_20170814_134812/import-abort-rescan_118\r\n2017-08-14 13:48:38.719000 TestFramework (INFO): Creating blocks with transactions ...\r\n2017-08-14 13:48:38.720000 TestFramework (INFO): ...  0%\r\n2017-08-14 13:49:10.376000 TestFramework (ERROR): JSONRPC error\r\nTraceback (most recent call last):\r\n  File \"/home/ubuntu/bitcoin/test/functional/test_framework/authproxy.py\", line 169, in _get_response\r\n    http_response = self.__conn.getresponse()\r\n  File \"/usr/lib/python3.5/http/client.py\", line 1197, in getresponse\r\n    response.begin()\r\n  File \"/usr/lib/python3.5/http/client.py\", line 297, in begin\r\n    version, status, reason = self._read_status()\r\n  File \"/usr/lib/python3.5/http/client.py\", line 258, in _read_status\r\n    line = str(self.fp.readline(_MAXLINE + 1), \"iso-8859-1\")\r\n  File \"/usr/lib/python3.5/socket.py\", line 575, in readinto\r\n    return self._sock.recv_into(b)\r\nsocket.timeout: timed out\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/ubuntu/bitcoin/test/functional/test_framework/test_framework.py\", line 149, in main\r\n    self.run_test()\r\n  File \"/home/ubuntu/bitcoin/test/functional/import-abort-rescan.py\", line 32, in run_test\r\n    self.nodes[0].sendtoaddress(addr, 0.1)\r\n  File \"/home/ubuntu/bitcoin/test/functional/test_framework/coverage.py\", line 46, in __call__\r\n    return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\r\n  File \"/home/ubuntu/bitcoin/test/functional/test_framework/authproxy.py\", line 152, in __call__\r\n    response = self._request('POST', self.__url.path, postdata.encode('utf-8'))\r\n  File \"/home/ubuntu/bitcoin/test/functional/test_framework/authproxy.py\", line 126, in _request\r\n    return self._get_response()\r\n  File \"/home/ubuntu/bitcoin/test/functional/test_framework/authproxy.py\", line 176, in _get_response\r\n    self.__conn.timeout)})\r\ntest_framework.authproxy.JSONRPCException: 'sendtoaddress' RPC took longer than 30.000000 seconds. Consider using larger timeout for calls that take longer to return. (-344)\r\n2017-08-14 13:49:10.377000 TestFramework (INFO): Stopping nodes\r\n2017-08-14 13:49:10.377000 TestFramework (ERROR): Unable to stop node\r\nTraceback (most recent call last):\r\n  File \"/home/ubuntu/bitcoin/test/functional/test_framework/test_framework.py\", line 254, in stop_node\r\n    self.nodes[i].stop()\r\n  File \"/home/ubuntu/bitcoin/test/functional/test_framework/coverage.py\", line 46, in __call__\r\n    return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\r\n  File \"/home/ubuntu/bitcoin/test/functional/test_framework/authproxy.py\", line 152, in __call__\r\n    response = self._request('POST', self.__url.path, postdata.encode('utf-8'))\r\n  File \"/home/ubuntu/bitcoin/test/functional/test_framework/authproxy.py\", line 125, in _request\r\n    self.__conn.request(method, path, postdata, headers)\r\n  File \"/usr/lib/python3.5/http/client.py\", line 1106, in request\r\n    self._send_request(method, url, body, headers)\r\n  File \"/usr/lib/python3.5/http/client.py\", line 1141, in _send_request\r\n    self.putrequest(method, url, **skips)\r\n  File \"/usr/lib/python3.5/http/client.py\", line 974, in putrequest\r\n    raise CannotSendRequest(self.__state)\r\nhttp.client.CannotSendRequest: Request-sent\r\n```\r\n\r\nI'm running this in an ubuntu VM with quite slow spinning disk i/o.\r\n\r\n@kallewoof - if you run `./test_runner.py $(for i in {1..40}; do echo -n 'import-abort-rescan '; done)` do you get all success?",
      "created_at" : "2017-08-14T13:55:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-322196718",
      "id" : 322196718,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-08-14T13:55:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322196718",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "Just fyi\r\n\r\n```sh\r\n./test_runner.py $(for i in {1..40}; do echo -n 'import-abort-rescan '; done)\r\n```\r\n\r\nis passing for me on an ssd.",
      "created_at" : "2017-08-14T14:14:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-322201496",
      "id" : 322201496,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-08-14T14:14:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322201496",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "Thanks @MarcoFalke - probably caused by my slow disk in that case.",
      "created_at" : "2017-08-14T15:01:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-322214745",
      "id" : 322214745,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-08-14T15:01:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322214745",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "Yeah. Though, I think tests should run and pass on all platforms that are capable of running Bitcoin Core.",
      "created_at" : "2017-08-14T15:06:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-322215953",
      "id" : 322215953,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-08-14T15:06:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322215953",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r133007116"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133007116"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: prefer imports to be in PEP-8 ordering (standard libraries first)",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-08-14T17:14:27Z",
      "diff_hunk" : "@@ -0,0 +1,72 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test wallet import RPCs.\n+\n+Test rescan behavior of importprivkey when aborted. The test ensures that:\n+1. The abortrescan command indeed stops the rescan process.\n+2. Subsequent rescan catches the aborted address UTXO\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (assert_equal, get_rpc_proxy)\n+from decimal import Decimal",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r133007116",
      "id" : 133007116,
      "original_commit_id" : "4eb87c27ee6918f03141264957d0c62b60efc9db",
      "original_position" : 14,
      "path" : "test/functional/import-abort-rescan.py",
      "position" : null,
      "pull_request_review_id" : 56141828,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-18T05:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133007116",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r133007202"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133007202"
         }
      },
      "author_association" : "MEMBER",
      "body" : "No need to override method if you're just calling into `super()`",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-08-14T17:14:49Z",
      "diff_hunk" : "@@ -0,0 +1,72 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test wallet import RPCs.\n+\n+Test rescan behavior of importprivkey when aborted. The test ensures that:\n+1. The abortrescan command indeed stops the rescan process.\n+2. Subsequent rescan catches the aborted address UTXO\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (assert_equal, get_rpc_proxy)\n+from decimal import Decimal\n+import threading # for bg importprivkey\n+import time      # for sleep\n+\n+class ImportAbortRescanTest(BitcoinTestFramework):\n+    def __init__(self):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r133007202",
      "id" : 133007202,
      "original_commit_id" : "4eb87c27ee6918f03141264957d0c62b60efc9db",
      "original_position" : 19,
      "path" : "test/functional/import-abort-rescan.py",
      "position" : null,
      "pull_request_review_id" : 56141828,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-18T05:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133007202",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r133007555"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133007555"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: if block should appear on the next line. Same for the `if xxxxx: break` lines below",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-08-14T17:16:04Z",
      "diff_hunk" : "@@ -0,0 +1,72 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test wallet import RPCs.\n+\n+Test rescan behavior of importprivkey when aborted. The test ensures that:\n+1. The abortrescan command indeed stops the rescan process.\n+2. Subsequent rescan catches the aborted address UTXO\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (assert_equal, get_rpc_proxy)\n+from decimal import Decimal\n+import threading # for bg importprivkey\n+import time      # for sleep\n+\n+class ImportAbortRescanTest(BitcoinTestFramework):\n+    def __init__(self):\n+        super().__init__()\n+        # self.setup_clean_chain = False\n+\n+    def run_test(self):\n+        # Generate for BTC\n+        self.nodes[0].generate(300)\n+        self.log.info(\"Creating blocks with transactions ...\")\n+        # Make blocks with spam to cause rescan delay\n+        for i in range(200):\n+            if i % 50 == 0: self.log.info(\"... %2.f%%\", 100.0 / 200.0 * i)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r133007555",
      "id" : 133007555,
      "original_commit_id" : "4eb87c27ee6918f03141264957d0c62b60efc9db",
      "original_position" : 29,
      "path" : "test/functional/import-abort-rescan.py",
      "position" : null,
      "pull_request_review_id" : 56141828,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-18T05:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133007555",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r133008105"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133008105"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: prefer `assert deadres, \"importthread did not die soon enough\"` (so the error message is delivered to the user)",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-08-14T17:18:19Z",
      "diff_hunk" : "@@ -0,0 +1,72 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test wallet import RPCs.\n+\n+Test rescan behavior of importprivkey when aborted. The test ensures that:\n+1. The abortrescan command indeed stops the rescan process.\n+2. Subsequent rescan catches the aborted address UTXO\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (assert_equal, get_rpc_proxy)\n+from decimal import Decimal\n+import threading # for bg importprivkey\n+import time      # for sleep\n+\n+class ImportAbortRescanTest(BitcoinTestFramework):\n+    def __init__(self):\n+        super().__init__()\n+        # self.setup_clean_chain = False\n+\n+    def run_test(self):\n+        # Generate for BTC\n+        self.nodes[0].generate(300)\n+        self.log.info(\"Creating blocks with transactions ...\")\n+        # Make blocks with spam to cause rescan delay\n+        for i in range(200):\n+            if i % 50 == 0: self.log.info(\"... %2.f%%\", 100.0 / 200.0 * i)\n+            addr = self.nodes[0].getnewaddress()\n+            for j in range(10):\n+                self.nodes[0].sendtoaddress(addr, 0.1)\n+            self.nodes[0].generate(1)\n+        self.log.info(\"Sending to shared address ...\")\n+        addr = self.nodes[0].getnewaddress()\n+        privkey = self.nodes[0].dumpprivkey(addr)\n+        self.nodes[0].sendtoaddress(addr, 0.123)\n+        self.nodes[0].generate(10) # mature tx\n+        self.sync_all()\n+        balances = [n.getbalance() for n in self.nodes]\n+\n+        # Import this address in the background ...\n+        self.log.info(\"Importing address in background thread ...\")\n+        node1ref = get_rpc_proxy(self.nodes[1].url, 1, timeout=600)\n+        importthread = threading.Thread(target=node1ref.importprivkey, args=[privkey])\n+        importthread.start()\n+        # ... then abort rescan; try a bunch until abortres becomes true,\n+        # because we will start checking before above thread starts processing\n+        self.log.info(\"Attempting to abort scan ...\")\n+        for i in range(2000):\n+            time.sleep(0.001)\n+            abortres = self.nodes[1].abortrescan()\n+            if abortres: break\n+        assert abortres # if false, we failed to abort\n+        self.log.info(\"Waiting for import thread to die ...\")\n+        # import should die soon\n+        for i in range(10):\n+            time.sleep(0.1)\n+            deadres = not importthread.isAlive()\n+            if deadres: break\n+\n+        assert deadres # if false, importthread did not die soon enough",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r133008105",
      "id" : 133008105,
      "original_commit_id" : "4eb87c27ee6918f03141264957d0c62b60efc9db",
      "original_position" : 62,
      "path" : "test/functional/import-abort-rescan.py",
      "position" : null,
      "pull_request_review_id" : 56141828,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-18T05:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133008105",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r133106360"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133106360"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I put `decimal`, `threading`, and `time` imports at top. ",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-08-15T02:33:11Z",
      "diff_hunk" : "@@ -0,0 +1,72 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test wallet import RPCs.\n+\n+Test rescan behavior of importprivkey when aborted. The test ensures that:\n+1. The abortrescan command indeed stops the rescan process.\n+2. Subsequent rescan catches the aborted address UTXO\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (assert_equal, get_rpc_proxy)\n+from decimal import Decimal",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r133106360",
      "id" : 133106360,
      "in_reply_to_id" : 133007116,
      "original_commit_id" : "4eb87c27ee6918f03141264957d0c62b60efc9db",
      "original_position" : 14,
      "path" : "test/functional/import-abort-rescan.py",
      "position" : null,
      "pull_request_review_id" : 56251277,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-18T05:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133106360",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r133106438"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133106438"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nice.. I didn't know you could do that.",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-08-15T02:34:03Z",
      "diff_hunk" : "@@ -0,0 +1,72 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test wallet import RPCs.\n+\n+Test rescan behavior of importprivkey when aborted. The test ensures that:\n+1. The abortrescan command indeed stops the rescan process.\n+2. Subsequent rescan catches the aborted address UTXO\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (assert_equal, get_rpc_proxy)\n+from decimal import Decimal\n+import threading # for bg importprivkey\n+import time      # for sleep\n+\n+class ImportAbortRescanTest(BitcoinTestFramework):\n+    def __init__(self):\n+        super().__init__()\n+        # self.setup_clean_chain = False\n+\n+    def run_test(self):\n+        # Generate for BTC\n+        self.nodes[0].generate(300)\n+        self.log.info(\"Creating blocks with transactions ...\")\n+        # Make blocks with spam to cause rescan delay\n+        for i in range(200):\n+            if i % 50 == 0: self.log.info(\"... %2.f%%\", 100.0 / 200.0 * i)\n+            addr = self.nodes[0].getnewaddress()\n+            for j in range(10):\n+                self.nodes[0].sendtoaddress(addr, 0.1)\n+            self.nodes[0].generate(1)\n+        self.log.info(\"Sending to shared address ...\")\n+        addr = self.nodes[0].getnewaddress()\n+        privkey = self.nodes[0].dumpprivkey(addr)\n+        self.nodes[0].sendtoaddress(addr, 0.123)\n+        self.nodes[0].generate(10) # mature tx\n+        self.sync_all()\n+        balances = [n.getbalance() for n in self.nodes]\n+\n+        # Import this address in the background ...\n+        self.log.info(\"Importing address in background thread ...\")\n+        node1ref = get_rpc_proxy(self.nodes[1].url, 1, timeout=600)\n+        importthread = threading.Thread(target=node1ref.importprivkey, args=[privkey])\n+        importthread.start()\n+        # ... then abort rescan; try a bunch until abortres becomes true,\n+        # because we will start checking before above thread starts processing\n+        self.log.info(\"Attempting to abort scan ...\")\n+        for i in range(2000):\n+            time.sleep(0.001)\n+            abortres = self.nodes[1].abortrescan()\n+            if abortres: break\n+        assert abortres # if false, we failed to abort\n+        self.log.info(\"Waiting for import thread to die ...\")\n+        # import should die soon\n+        for i in range(10):\n+            time.sleep(0.1)\n+            deadres = not importthread.isAlive()\n+            if deadres: break\n+\n+        assert deadres # if false, importthread did not die soon enough",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r133106438",
      "id" : 133106438,
      "in_reply_to_id" : 133008105,
      "original_commit_id" : "4eb87c27ee6918f03141264957d0c62b60efc9db",
      "original_position" : 62,
      "path" : "test/functional/import-abort-rescan.py",
      "position" : null,
      "pull_request_review_id" : 56251358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-18T05:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133106438",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "body" : "@jnewbery your bash line runs fine on my end.\r\n\r\n`socket.timeout: timed out`? Hum.. any ideas on how to fix that one?",
      "created_at" : "2017-08-15T02:57:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-322364458",
      "id" : 322364458,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-08-15T02:57:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322364458",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r133135164"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133135164"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It seems you are not specifying the constructor (`__init__`). Thus 2 additional nodes are spun up and remain unused.",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-08-15T07:58:57Z",
      "diff_hunk" : "@@ -0,0 +1,71 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test wallet import RPCs.\n+\n+Test rescan behavior of importprivkey when aborted. The test ensures that:\n+1. The abortrescan command indeed stops the rescan process.\n+2. Subsequent rescan catches the aborted address UTXO\n+\"\"\"\n+\n+from decimal import Decimal\n+import threading # for bg importprivkey\n+import time      # for sleep\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (assert_equal, get_rpc_proxy)\n+\n+class ImportAbortRescanTest(BitcoinTestFramework):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r133135164",
      "id" : 133135164,
      "original_commit_id" : "7da6e01bdf10a293a335cccf0389b135d4f6074a",
      "original_position" : 18,
      "path" : "test/functional/import-abort-rescan.py",
      "position" : null,
      "pull_request_review_id" : 56281647,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-18T05:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133135164",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r133138904"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133138904"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good point. Fixed.",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-08-15T08:21:53Z",
      "diff_hunk" : "@@ -0,0 +1,71 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test wallet import RPCs.\n+\n+Test rescan behavior of importprivkey when aborted. The test ensures that:\n+1. The abortrescan command indeed stops the rescan process.\n+2. Subsequent rescan catches the aborted address UTXO\n+\"\"\"\n+\n+from decimal import Decimal\n+import threading # for bg importprivkey\n+import time      # for sleep\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (assert_equal, get_rpc_proxy)\n+\n+class ImportAbortRescanTest(BitcoinTestFramework):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r133138904",
      "id" : 133138904,
      "in_reply_to_id" : 133135164,
      "original_commit_id" : "7da6e01bdf10a293a335cccf0389b135d4f6074a",
      "original_position" : 18,
      "path" : "test/functional/import-abort-rescan.py",
      "position" : null,
      "pull_request_review_id" : 56285619,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-18T05:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133138904",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "body" : "`socket.timeout: timed out` probably means that running this test 4 times in parallel is too much for my VM, and one of the rpc calls timed out.",
      "created_at" : "2017-08-15T13:18:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-322463350",
      "id" : 322463350,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-08-15T13:18:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322463350",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r133187270"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133187270"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: could change this to:\r\n\r\n```\r\nassert abortres, \"abortrescan call failed\"\r\n```",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-08-15T13:21:12Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test wallet import RPCs.\n+\n+Test rescan behavior of importprivkey when aborted. The test ensures that:\n+1. The abortrescan command indeed stops the rescan process.\n+2. Subsequent rescan catches the aborted address UTXO\n+\"\"\"\n+\n+from decimal import Decimal\n+import threading # for bg importprivkey\n+import time      # for sleep\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (assert_equal, get_rpc_proxy)\n+\n+class ImportAbortRescanTest(BitcoinTestFramework):\n+    def __init__(self):\n+        super().__init__()\n+        self.num_nodes = 2\n+\n+    def run_test(self):\n+        # Generate for BTC\n+        self.nodes[0].generate(300)\n+        self.log.info(\"Creating blocks with transactions ...\")\n+        # Make blocks with spam to cause rescan delay\n+        for i in range(200):\n+            if i % 50 == 0:\n+                self.log.info(\"... %2.f%%\", 100.0 / 200.0 * i)\n+            addr = self.nodes[0].getnewaddress()\n+            for j in range(10):\n+                self.nodes[0].sendtoaddress(addr, 0.1)\n+            self.nodes[0].generate(1)\n+        self.log.info(\"Sending to shared address ...\")\n+        addr = self.nodes[0].getnewaddress()\n+        privkey = self.nodes[0].dumpprivkey(addr)\n+        self.nodes[0].sendtoaddress(addr, 0.123)\n+        self.nodes[0].generate(10) # mature tx\n+        self.sync_all()\n+        balances = [n.getbalance() for n in self.nodes]\n+\n+        # Import this address in the background ...\n+        self.log.info(\"Importing address in background thread ...\")\n+        node1ref = get_rpc_proxy(self.nodes[1].url, 1, timeout=600)\n+        importthread = threading.Thread(target=node1ref.importprivkey, args=[privkey])\n+        importthread.start()\n+        # ... then abort rescan; try a bunch until abortres becomes true,\n+        # because we will start checking before above thread starts processing\n+        self.log.info(\"Attempting to abort scan ...\")\n+        for i in range(2000):\n+            time.sleep(0.001)\n+            abortres = self.nodes[1].abortrescan()\n+            if abortres:\n+                break\n+        assert abortres # if false, we failed to abort",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r133187270",
      "id" : 133187270,
      "original_commit_id" : "e90d996420aaec797b65e4943878124e29d877a0",
      "original_position" : 56,
      "path" : "test/functional/import-abort-rescan.py",
      "position" : null,
      "pull_request_review_id" : 56337961,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-18T05:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133187270",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "Please squash your commits if this is no longer WIP",
      "created_at" : "2017-08-15T15:05:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-322495124",
      "id" : 322495124,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-08-15T15:05:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322495124",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r133360492"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133360492"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed, thanks!",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-08-16T05:17:15Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test wallet import RPCs.\n+\n+Test rescan behavior of importprivkey when aborted. The test ensures that:\n+1. The abortrescan command indeed stops the rescan process.\n+2. Subsequent rescan catches the aborted address UTXO\n+\"\"\"\n+\n+from decimal import Decimal\n+import threading # for bg importprivkey\n+import time      # for sleep\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (assert_equal, get_rpc_proxy)\n+\n+class ImportAbortRescanTest(BitcoinTestFramework):\n+    def __init__(self):\n+        super().__init__()\n+        self.num_nodes = 2\n+\n+    def run_test(self):\n+        # Generate for BTC\n+        self.nodes[0].generate(300)\n+        self.log.info(\"Creating blocks with transactions ...\")\n+        # Make blocks with spam to cause rescan delay\n+        for i in range(200):\n+            if i % 50 == 0:\n+                self.log.info(\"... %2.f%%\", 100.0 / 200.0 * i)\n+            addr = self.nodes[0].getnewaddress()\n+            for j in range(10):\n+                self.nodes[0].sendtoaddress(addr, 0.1)\n+            self.nodes[0].generate(1)\n+        self.log.info(\"Sending to shared address ...\")\n+        addr = self.nodes[0].getnewaddress()\n+        privkey = self.nodes[0].dumpprivkey(addr)\n+        self.nodes[0].sendtoaddress(addr, 0.123)\n+        self.nodes[0].generate(10) # mature tx\n+        self.sync_all()\n+        balances = [n.getbalance() for n in self.nodes]\n+\n+        # Import this address in the background ...\n+        self.log.info(\"Importing address in background thread ...\")\n+        node1ref = get_rpc_proxy(self.nodes[1].url, 1, timeout=600)\n+        importthread = threading.Thread(target=node1ref.importprivkey, args=[privkey])\n+        importthread.start()\n+        # ... then abort rescan; try a bunch until abortres becomes true,\n+        # because we will start checking before above thread starts processing\n+        self.log.info(\"Attempting to abort scan ...\")\n+        for i in range(2000):\n+            time.sleep(0.001)\n+            abortres = self.nodes[1].abortrescan()\n+            if abortres:\n+                break\n+        assert abortres # if false, we failed to abort",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r133360492",
      "id" : 133360492,
      "in_reply_to_id" : 133187270,
      "original_commit_id" : "e90d996420aaec797b65e4943878124e29d877a0",
      "original_position" : 56,
      "path" : "test/functional/import-abort-rescan.py",
      "position" : null,
      "pull_request_review_id" : 56531152,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-18T05:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/133360492",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "body" : "@MarcoFalke Squashed & removed '[WIP]' from title.",
      "created_at" : "2017-08-16T05:17:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-322668684",
      "id" : 322668684,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-08-16T05:17:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322668684",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r138625410"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/138625410"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Replace with\r\n```py\r\n    def set_test_params(self):\r\n        self.num_nodes = 2\r\n```",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-09-13T13:52:02Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test wallet import RPCs.\n+\n+Test rescan behavior of importprivkey when aborted. The test ensures that:\n+1. The abortrescan command indeed stops the rescan process.\n+2. Subsequent rescan catches the aborted address UTXO\n+\"\"\"\n+\n+from decimal import Decimal\n+import threading # for bg importprivkey\n+import time      # for sleep\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (assert_equal, get_rpc_proxy)\n+\n+class ImportAbortRescanTest(BitcoinTestFramework):\n+    def __init__(self):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r138625410",
      "id" : 138625410,
      "original_commit_id" : "fef5ec5f842a221905591002dd56bbdd4de78d88",
      "original_position" : 19,
      "path" : "test/functional/import-abort-rescan.py",
      "position" : null,
      "pull_request_review_id" : 62444427,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-18T05:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/138625410",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r138625776"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/138625776"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Change and remove comment:\r\n```py\r\nfrom time import sleep\r\n```\r\nThe same above.",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-09-13T13:53:14Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test wallet import RPCs.\n+\n+Test rescan behavior of importprivkey when aborted. The test ensures that:\n+1. The abortrescan command indeed stops the rescan process.\n+2. Subsequent rescan catches the aborted address UTXO\n+\"\"\"\n+\n+from decimal import Decimal\n+import threading # for bg importprivkey\n+import time      # for sleep",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r138625776",
      "id" : 138625776,
      "original_commit_id" : "fef5ec5f842a221905591002dd56bbdd4de78d88",
      "original_position" : 14,
      "path" : "test/functional/import-abort-rescan.py",
      "position" : null,
      "pull_request_review_id" : 62444427,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-18T05:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/138625776",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r138625829"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/138625829"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nit, missing period.",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-09-13T13:53:25Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test wallet import RPCs.\n+\n+Test rescan behavior of importprivkey when aborted. The test ensures that:\n+1. The abortrescan command indeed stops the rescan process.\n+2. Subsequent rescan catches the aborted address UTXO",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r138625829",
      "id" : 138625829,
      "original_commit_id" : "fef5ec5f842a221905591002dd56bbdd4de78d88",
      "original_position" : 9,
      "path" : "test/functional/import-abort-rescan.py",
      "position" : null,
      "pull_request_review_id" : 62444427,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-18T05:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/138625829",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r138626059"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/138626059"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nit, use unordered, ie, `- The abortrescan ... `.",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-09-13T13:54:15Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test wallet import RPCs.\n+\n+Test rescan behavior of importprivkey when aborted. The test ensures that:\n+1. The abortrescan command indeed stops the rescan process.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r138626059",
      "id" : 138626059,
      "original_commit_id" : "fef5ec5f842a221905591002dd56bbdd4de78d88",
      "original_position" : 8,
      "path" : "test/functional/import-abort-rescan.py",
      "position" : 8,
      "pull_request_review_id" : 62444427,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-18T05:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/138626059",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r138631285"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/138631285"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "@jnewbery wdyt about moving this to `util.py`, like `def generate_load(node, blocks, transactions):` or whatever?",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-09-13T14:11:43Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test wallet import RPCs.\n+\n+Test rescan behavior of importprivkey when aborted. The test ensures that:\n+1. The abortrescan command indeed stops the rescan process.\n+2. Subsequent rescan catches the aborted address UTXO\n+\"\"\"\n+\n+from decimal import Decimal\n+import threading # for bg importprivkey\n+import time      # for sleep\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (assert_equal, get_rpc_proxy)\n+\n+class ImportAbortRescanTest(BitcoinTestFramework):\n+    def __init__(self):\n+        super().__init__()\n+        self.num_nodes = 2\n+\n+    def run_test(self):\n+        # Generate for BTC\n+        self.nodes[0].generate(300)\n+        self.log.info(\"Creating blocks with transactions ...\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r138631285",
      "id" : 138631285,
      "original_commit_id" : "fef5ec5f842a221905591002dd56bbdd4de78d88",
      "original_position" : 26,
      "path" : "test/functional/import-abort-rescan.py",
      "position" : 25,
      "pull_request_review_id" : 62444427,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-18T05:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/138631285",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r139586768"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/139586768"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm not sure what the reason for this is. It is easier to refer to a point by number, e.g. \"this test is no longer checking the 3rd point mentioned in the comment\".",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-09-19T02:51:50Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test wallet import RPCs.\n+\n+Test rescan behavior of importprivkey when aborted. The test ensures that:\n+1. The abortrescan command indeed stops the rescan process.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r139586768",
      "id" : 139586768,
      "in_reply_to_id" : 138626059,
      "original_commit_id" : "fef5ec5f842a221905591002dd56bbdd4de78d88",
      "original_position" : 8,
      "path" : "test/functional/import-abort-rescan.py",
      "position" : 8,
      "pull_request_review_id" : 63539010,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-18T05:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/139586768",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r139774977"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/139774977"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't think it makes sense to move code up into the `test_framework` directory unless it's being used by more than one test script. I don't see the need here (unless you think you can refactor other test scripts to use this and reduce LOC)",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-09-19T18:18:59Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test wallet import RPCs.\n+\n+Test rescan behavior of importprivkey when aborted. The test ensures that:\n+1. The abortrescan command indeed stops the rescan process.\n+2. Subsequent rescan catches the aborted address UTXO\n+\"\"\"\n+\n+from decimal import Decimal\n+import threading # for bg importprivkey\n+import time      # for sleep\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (assert_equal, get_rpc_proxy)\n+\n+class ImportAbortRescanTest(BitcoinTestFramework):\n+    def __init__(self):\n+        super().__init__()\n+        self.num_nodes = 2\n+\n+    def run_test(self):\n+        # Generate for BTC\n+        self.nodes[0].generate(300)\n+        self.log.info(\"Creating blocks with transactions ...\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r139774977",
      "id" : 139774977,
      "in_reply_to_id" : 138631285,
      "original_commit_id" : "fef5ec5f842a221905591002dd56bbdd4de78d88",
      "original_position" : 26,
      "path" : "test/functional/import-abort-rescan.py",
      "position" : 25,
      "pull_request_review_id" : 63754885,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-18T05:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/139774977",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r139779292"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/139779292"
         }
      },
      "author_association" : "MEMBER",
      "body" : "invalid syntax. Should be `from time import sleep`",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-09-19T18:36:10Z",
      "diff_hunk" : "@@ -0,0 +1,74 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test wallet import RPCs.\n+\n+Test rescan behavior of importprivkey when aborted. The test ensures that:\n+1. The abortrescan command indeed stops the rescan process.\n+2. Subsequent rescan catches the aborted address UTXO.\n+\"\"\"\n+\n+from decimal import Decimal\n+import threading # for bg importprivkey\n+import sleep from time",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r139779292",
      "id" : 139779292,
      "original_commit_id" : "adc27e086d081c7e5f8d35b72193c509f37d0b35",
      "original_position" : 14,
      "path" : "test/functional/import-abort-rescan.py",
      "position" : null,
      "pull_request_review_id" : 63760042,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-18T05:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/139779292",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I was able to get most of the tests to pass running in parallel on the following:\r\n\r\n- [x] **Ubuntu 16.04.2 LTS x86_64**\r\n1 Core\r\n2.50GHz CPU\r\n1GB RAM\r\nHDD\r\n\r\n- [x] **Debian GNU/Linux 8.9 x86_64**\r\n1 Core\r\n2.80 GHz CPU\r\n2GB RAM\r\nHDD\r\n\r\n- [ ] **MacOS High Sierra x86_64**\r\n2 Cores\r\n3.3 GHz CPU\r\n16GB RAM\r\nSSD\r\n39/40 tests passed successfully\r\n\r\nError:\r\n```\r\nstdout:\r\n2017-12-09 22:59:54.102000 TestFramework (INFO): Initializing test directory /var/folders/db/5xcqh4b57l7380mcv8c0kj8r0000gn/T/bitcoin_test_runner_20171209_170923/import-abort-rescan_85\r\n2017-12-09 23:00:20.768000 TestFramework (INFO): Creating blocks with transactions ...\r\n2017-12-09 23:00:20.782000 TestFramework (INFO): ...  0%\r\n2017-12-09 23:02:37.124000 TestFramework (INFO): ... 25%\r\n2017-12-09 23:04:59.728000 TestFramework (INFO): ... 50%\r\n2017-12-09 23:07:31.909000 TestFramework (INFO): ... 75%\r\n2017-12-09 23:10:03.214000 TestFramework (INFO): Sending to shared address ...\r\n2017-12-09 23:10:04.581000 TestFramework (ERROR): Unexpected exception caught during testing\r\nTraceback (most recent call last):\r\n  File \"/bitcoin/test/functional/test_framework/test_framework.py\", line 120, in main\r\n    self.run_test()\r\n  File \"/bitcoin/test/functional/import-abort-rescan.py\", line 40, in run_test\r\n    self.sync_all()\r\n  File \"/bitcoin/test/functional/test_framework/test_framework.py\", line 328, in sync_all\r\n    sync_blocks(group)\r\n  File \"/bitcoin/test/functional/test_framework/util.py\", line 368, in sync_blocks\r\n    maxheight = max(x.getblockcount() for x in rpc_connections)\r\n  File \"/bitcoin/test/functional/test_framework/util.py\", line 368, in <genexpr>\r\n    maxheight = max(x.getblockcount() for x in rpc_connections)\r\n  File \"/bitcoin/test/functional/test_framework/coverage.py\", line 47, in __call__\r\n    return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\r\n  File \"/bitcoin/test/functional/test_framework/authproxy.py\", line 136, in __call__\r\n    response = self._request('POST', self.__url.path, postdata.encode('utf-8'))\r\n  File \"/bitcoin/test/functional/test_framework/authproxy.py\", line 106, in _request\r\n    self.__conn.request(method, path, postdata, headers)\r\n  File \"/usr/local/Cellar/python3/3.6.3/Frameworks/Python.framework/Versions/3.6/lib/python3.6/http/client.py\", line 1239, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/local/Cellar/python3/3.6.3/Frameworks/Python.framework/Versions/3.6/lib/python3.6/http/client.py\", line 1285, in _send_request\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n  File \"/usr/local/Cellar/python3/3.6.3/Frameworks/Python.framework/Versions/3.6/lib/python3.6/http/client.py\", line 1234, in endheaders\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n  File \"/usr/local/Cellar/python3/3.6.3/Frameworks/Python.framework/Versions/3.6/lib/python3.6/http/client.py\", line 1065, in _send_output\r\n    self.send(chunk)\r\n  File \"/usr/local/Cellar/python3/3.6.3/Frameworks/Python.framework/Versions/3.6/lib/python3.6/http/client.py\", line 986, in send\r\n    self.sock.sendall(data)\r\nOSError: [Errno 41] Protocol wrong type for socket\r\n2017-12-09 23:10:04.605000 TestFramework (INFO): Stopping nodes\r\n2017-12-09 23:10:04.623000 TestFramework.node1 (ERROR): Unable to stop node.\r\nTraceback (most recent call last):\r\n  File \"/bitcoin/test/functional/test_framework/test_node.py\", line 125, in stop_node\r\n    self.stop()\r\n  File \"/bitcoin/test/functional/test_framework/coverage.py\", line 47, in __call__\r\n    return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\r\n  File \"/bitcoin/test/functional/test_framework/authproxy.py\", line 136, in __call__\r\n    response = self._request('POST', self.__url.path, postdata.encode('utf-8'))\r\n  File \"/bitcoin/test/functional/test_framework/authproxy.py\", line 106, in _request\r\n    self.__conn.request(method, path, postdata, headers)\r\n  File \"/usr/local/Cellar/python3/3.6.3/Frameworks/Python.framework/Versions/3.6/lib/python3.6/http/client.py\", line 1239, in request\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n  File \"/usr/local/Cellar/python3/3.6.3/Frameworks/Python.framework/Versions/3.6/lib/python3.6/http/client.py\", line 1250, in _send_request\r\n    self.putrequest(method, url, **skips)\r\n  File \"/usr/local/Cellar/python3/3.6.3/Frameworks/Python.framework/Versions/3.6/lib/python3.6/http/client.py\", line 1108, in putrequest\r\n    raise CannotSendRequest(self.__state)\r\nhttp.client.CannotSendRequest: Request-sent\r\n\r\nstderr:\r\nTraceback (most recent call last):\r\n  File \"/bitcoin/test/functional/import-abort-rescan.py\", line 77, in <module>\r\n    ImportAbortRescanTest().main()\r\n  File \"/bitcoin/test/functional/test_framework/test_framework.py\", line 143, in main\r\n    self.stop_nodes()\r\n  File \"/bitcoin/test/functional/test_framework/test_framework.py\", line 277, in stop_nodes\r\n    node.wait_until_stopped()\r\n  File \"/bitcoin/test/functional/test_framework/test_node.py\", line 151, in wait_until_stopped\r\n    wait_until(self.is_node_stopped, timeout=timeout)\r\n  File \"/bitcoin/test/functional/test_framework/util.py\", line 222, in wait_until\r\n    assert_greater_than(timeout, time.time())\r\n  File \"/bitcoin/test/functional/test_framework/util.py\", line 42, in assert_greater_than\r\n    raise AssertionError(\"%s <= %s\" % (str(thing1), str(thing2)))\r\nAssertionError: 1512861065.40589 <= 1512861065.4063418\r\n```",
      "created_at" : "2017-12-10T00:14:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-350515238",
      "id" : 350515238,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-12-10T00:16:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/350515238",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/4913413?v=4",
         "events_url" : "https://api.github.com/users/maxgiraldo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maxgiraldo/followers",
         "following_url" : "https://api.github.com/users/maxgiraldo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maxgiraldo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maxgiraldo",
         "id" : 4913413,
         "login" : "maxgiraldo",
         "organizations_url" : "https://api.github.com/users/maxgiraldo/orgs",
         "received_events_url" : "https://api.github.com/users/maxgiraldo/received_events",
         "repos_url" : "https://api.github.com/users/maxgiraldo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maxgiraldo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maxgiraldo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maxgiraldo"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@maxgiraldo Thanks for testing! I tried on same mac set up (except more cores) doing\r\n```Bash\r\n./test_runner.py $(for i in {1..40}; do echo -n 'import-abort-rescan '; done)\r\n```\r\nand it is working on my end. What command are you using to run the tests?",
      "created_at" : "2017-12-11T03:38:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-350614915",
      "id" : 350614915,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-12-11T03:38:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/350614915",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@kallewoof No problem! I'm using `./test_runner.py $(for i in {1..40}; do echo -n 'import-abort-rescan '; done)` as well. I ran the tests again on Mac about three more times and got the same error, but only on the last run. ",
      "created_at" : "2017-12-11T15:21:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-350755216",
      "id" : 350755216,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-12-11T15:21:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/350755216",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/4913413?v=4",
         "events_url" : "https://api.github.com/users/maxgiraldo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maxgiraldo/followers",
         "following_url" : "https://api.github.com/users/maxgiraldo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maxgiraldo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maxgiraldo",
         "id" : 4913413,
         "login" : "maxgiraldo",
         "organizations_url" : "https://api.github.com/users/maxgiraldo/orgs",
         "received_events_url" : "https://api.github.com/users/maxgiraldo/received_events",
         "repos_url" : "https://api.github.com/users/maxgiraldo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maxgiraldo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maxgiraldo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maxgiraldo"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@maxgiraldo After running it for a long time I managed to reproduce. Looking into it now.",
      "created_at" : "2017-12-12T04:09:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-350939715",
      "id" : 350939715,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-12-12T04:09:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/350939715",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r156425151"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156425151"
         }
      },
      "author_association" : "NONE",
      "body" : "Would it make sense to take advantage of `mine_large_block` or is that overkill in this context? Might make this test more concise.",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-12-12T16:44:48Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test wallet import RPCs.\n+\n+Test rescan behavior of importprivkey when aborted. The test ensures that:\n+1. The abortrescan command indeed stops the rescan process.\n+2. Subsequent rescan catches the aborted address UTXO\n+\"\"\"\n+\n+from decimal import Decimal\n+import threading # for bg importprivkey\n+import time      # for sleep\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (assert_equal, get_rpc_proxy)\n+\n+class ImportAbortRescanTest(BitcoinTestFramework):\n+    def __init__(self):\n+        super().__init__()\n+        self.num_nodes = 2\n+\n+    def run_test(self):\n+        # Generate for BTC\n+        self.nodes[0].generate(300)\n+        self.log.info(\"Creating blocks with transactions ...\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r156425151",
      "id" : 156425151,
      "in_reply_to_id" : 138631285,
      "original_commit_id" : "fef5ec5f842a221905591002dd56bbdd4de78d88",
      "original_position" : 26,
      "path" : "test/functional/import-abort-rescan.py",
      "position" : 25,
      "pull_request_review_id" : 82899691,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-18T05:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156425151",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/4913413?v=4",
         "events_url" : "https://api.github.com/users/maxgiraldo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maxgiraldo/followers",
         "following_url" : "https://api.github.com/users/maxgiraldo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maxgiraldo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maxgiraldo",
         "id" : 4913413,
         "login" : "maxgiraldo",
         "organizations_url" : "https://api.github.com/users/maxgiraldo/orgs",
         "received_events_url" : "https://api.github.com/users/maxgiraldo/received_events",
         "repos_url" : "https://api.github.com/users/maxgiraldo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maxgiraldo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maxgiraldo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maxgiraldo"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Hum. I can't reproduce this without running for hours. It feels like something is being exhausted, triggering the issue, but even after running for several hours I don't see any spikes in resource usage and drive has 100 GB free. @jnewbery any thoughts on why \"OSError: [Errno 41] Protocol wrong type for socket\" would happen occasionally for \r\n```\r\n    return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\r\n```\r\n(`test_framework/coverage.py#46`)?",
      "created_at" : "2017-12-13T03:44:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-351273712",
      "id" : 351273712,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-12-13T03:44:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/351273712",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@kallewoof Seems to be a MacOS/OS X-specific kernel issue, which throws the error code `EPROTOTYPE` when you attempt to do a TCP `send` syscall while a socket is not yet connected or is in the process of being torn down.*\r\n\r\n[Source Code](https://github.com/opensource-apple/xnu/blob/0a798f6738bc1db01281fc08ae024145e84df927/bsd/netinet/tcp_usrreq.c#L961)\r\n*[Source](http://erickt.github.io/blog/2014/11/19/adventures-in-debugging-a-potential-osx-kernel-bug/)",
      "created_at" : "2017-12-13T15:06:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-351417956",
      "id" : 351417956,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-12-13T15:11:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/351417956",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/4913413?v=4",
         "events_url" : "https://api.github.com/users/maxgiraldo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maxgiraldo/followers",
         "following_url" : "https://api.github.com/users/maxgiraldo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maxgiraldo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maxgiraldo",
         "id" : 4913413,
         "login" : "maxgiraldo",
         "organizations_url" : "https://api.github.com/users/maxgiraldo/orgs",
         "received_events_url" : "https://api.github.com/users/maxgiraldo/received_events",
         "repos_url" : "https://api.github.com/users/maxgiraldo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maxgiraldo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maxgiraldo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maxgiraldo"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Hmmm, I've definitely read that blog post before, but I can't remember what exactly the context was!\r\n\r\n@maxgiraldo - perhaps you could add additional exception handling here: https://github.com/bitcoin/bitcoin/blob/d4991c0cbb8a5464add1b64268eccdbfd3026d6e/test/functional/test_framework/authproxy.py#L108\r\n\r\nSomething like:\r\n\r\n```\r\n        except OSError as e:\r\n            if e.errno == 42:\r\n                # EPROTOTYPE - OS X issue: a TCP send syscall while a socket is\r\n                # not yet connected or is in the process of being torn down.\r\n                self.__conn.close()\r\n                self.__conn.request(method, path, postdata, headers)\r\n                return self._get_response()\r\n            else:\r\n                raise\r\n```\r\n\r\nYou could add a print statement or pdb breakpoint in there to confirm that you can reproduce and that this fixes this:\r\n\r\n```\r\n        except OSError as e:\r\n            if e.errno == 42:\r\n                # EPROTOTYPE - OS X issue: a TCP send syscall while a socket is\r\n                import pdb; pbd.set_trace()\r\n```\r\n\r\nDo you think this error is specific to this new test, or are you able to reproduce it on other tests? If it's not specific to this test, perhaps you can open a new issue or PR to track it.",
      "created_at" : "2017-12-13T21:35:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-351532370",
      "id" : 351532370,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-12-13T21:35:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/351532370",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I can reproduce as well, but it sometimes takes hours. Will try your patch in a couple hours on my end. I'll push a commit so @maxgiraldo can test it too if he hasn't tried it manually already.",
      "created_at" : "2017-12-14T00:40:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-351571655",
      "id" : 351571655,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-12-14T00:40:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/351571655",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I ran into other errors. Will investigate next week. Sorry for delay.",
      "created_at" : "2017-12-16T09:23:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-352171913",
      "id" : 352171913,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-12-16T09:23:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/352171913",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Different error now. Something very weird is going on with networking here.\r\n```\r\n2017-12-18 03:53:15.458000 TestFramework (INFO): Initializing test directory /var/folders/b8/znqr8hj918772gfmd875gzgdd3ypz1/T/bitcoin_test_runner_20171218_125257/import-abort-rescan_635\r\n2017-12-18 03:53:21.588000 TestFramework (INFO): Creating blocks with transactions ...\r\n2017-12-18 03:53:21.592000 TestFramework (INFO): ...  0%\r\n2017-12-18 03:54:49.215000 TestFramework (INFO): ... 25%\r\n2017-12-18 03:56:23.323000 TestFramework (INFO): ... 50%\r\n2017-12-18 03:57:56.488000 TestFramework (INFO): ... 75%\r\n2017-12-18 03:59:29.920000 TestFramework (INFO): Sending to shared address ...\r\n2017-12-18 03:59:30.218000 TestFramework (ERROR): Unexpected exception caught during testing\r\nTraceback (most recent call last):\r\n  File \"<dir>/bitcoin/test/functional/test_framework/test_framework.py\", line 117, in main\r\n    self.run_test()\r\n  File \"<dir>/bitcoin/test/functional/import-abort-rescan.py\", line 39, in run_test\r\n    self.sync_all()\r\n  File \"<dir>/bitcoin/test/functional/test_framework/test_framework.py\", line 320, in sync_all\r\n    sync_blocks(group)\r\n  File \"<dir>/bitcoin/test/functional/test_framework/util.py\", line 350, in sync_blocks\r\n    maxheight = max(x.getblockcount() for x in rpc_connections)\r\n  File \"<dir>/bitcoin/test/functional/test_framework/util.py\", line 350, in <genexpr>\r\n    maxheight = max(x.getblockcount() for x in rpc_connections)\r\n  File \"<dir>/bitcoin/test/functional/test_framework/coverage.py\", line 46, in __call__\r\n    return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\r\n  File \"<dir>/bitcoin/test/functional/test_framework/authproxy.py\", line 162, in __call__\r\n    response = self._request('POST', self.__url.path, postdata.encode('utf-8'))\r\n  File \"<dir>/bitcoin/test/functional/test_framework/authproxy.py\", line 126, in _request\r\n    return self._get_response()\r\n  File \"<dir>/bitcoin/test/functional/test_framework/authproxy.py\", line 179, in _get_response\r\n    http_response = self.__conn.getresponse()\r\n  File \"/usr/local/Cellar/python3/3.6.3/Frameworks/Python.framework/Versions/3.6/lib/python3.6/http/client.py\", line 1331, in getresponse\r\n    response.begin()\r\n  File \"/usr/local/Cellar/python3/3.6.3/Frameworks/Python.framework/Versions/3.6/lib/python3.6/http/client.py\", line 297, in begin\r\n    version, status, reason = self._read_status()\r\n  File \"/usr/local/Cellar/python3/3.6.3/Frameworks/Python.framework/Versions/3.6/lib/python3.6/http/client.py\", line 258, in _read_status\r\n    line = str(self.fp.readline(_MAXLINE + 1), \"iso-8859-1\")\r\n  File \"/usr/local/Cellar/python3/3.6.3/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py\", line 586, in readinto\r\n    return self._sock.recv_into(b)\r\nConnectionResetError: [Errno 54] Connection reset by peer\r\n2017-12-18 03:59:30.332000 TestFramework (INFO): Stopping nodes\r\n2017-12-18 03:59:32.775000 TestFramework (WARNING): Not cleaning up dir /var/folders/b8/znqr8hj918772gfmd875gzgdd3ypz1/T/bitcoin_test_runner_20171218_125257/import-abort-rescan_635\r\n2017-12-18 03:59:32.775000 TestFramework (ERROR): Test failed. Test logging available at /var/folders/b8/znqr8hj918772gfmd875gzgdd3ypz1/T/bitcoin_test_runner_20171218_125257/import-abort-rescan_635/test_framework.log\r\n```",
      "created_at" : "2017-12-18T05:22:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-352329054",
      "id" : 352329054,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-12-18T05:22:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/352329054",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Pushed commit with fix in it. This still breaks on my end after running for awhile.",
      "created_at" : "2017-12-18T05:25:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-352329321",
      "id" : 352329321,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-12-18T05:25:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/352329321",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r157512809"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157512809"
         }
      },
      "author_association" : "NONE",
      "body" : "The errno is actually 41; to avoid hardcoding the value, I would use `from errno import EPROTOTYPE` and then:\r\n```\r\nif e.errno == EPROTOTYPE:\r\n   ...\r\n```",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-12-18T15:21:11Z",
      "diff_hunk" : "@@ -112,6 +112,16 @@ def _request(self, method, path, postdata):\n                 return self._get_response()\n             else:\n                 raise\n+        except OSError as e:\n+            if e.errno == 42:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r157512809",
      "id" : 157512809,
      "original_commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "original_position" : 5,
      "path" : "test/functional/test_framework/authproxy.py",
      "position" : 5,
      "pull_request_review_id" : 84166205,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-18T15:21:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157512809",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/4913413?v=4",
         "events_url" : "https://api.github.com/users/maxgiraldo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maxgiraldo/followers",
         "following_url" : "https://api.github.com/users/maxgiraldo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maxgiraldo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maxgiraldo",
         "id" : 4913413,
         "login" : "maxgiraldo",
         "organizations_url" : "https://api.github.com/users/maxgiraldo/orgs",
         "received_events_url" : "https://api.github.com/users/maxgiraldo/received_events",
         "repos_url" : "https://api.github.com/users/maxgiraldo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maxgiraldo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maxgiraldo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maxgiraldo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r157925706"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157925706"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oops, good catch.",
      "commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "created_at" : "2017-12-20T02:33:33Z",
      "diff_hunk" : "@@ -112,6 +112,16 @@ def _request(self, method, path, postdata):\n                 return self._get_response()\n             else:\n                 raise\n+        except OSError as e:\n+            if e.errno == 42:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#discussion_r157925706",
      "id" : 157925706,
      "in_reply_to_id" : 157512809,
      "original_commit_id" : "da91c46f621327879effbd5cb2d7bca04a0f20db",
      "original_position" : 5,
      "path" : "test/functional/test_framework/authproxy.py",
      "position" : 5,
      "pull_request_review_id" : 84649833,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10367",
      "updated_at" : "2017-12-20T02:33:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157925706",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Connection reset by peer after a shortish while. Very curious.\r\n\r\n```\r\n2017-12-21 01:10:24.464000 TestFramework (INFO): Initializing test directory /var/folders/b8/znqr8hj918772gfmd875gzgdd3ypz1/T/bitcoin_test_runner_20171221_100356/import-abort-rescan_961\r\n2017-12-21 01:10:40.349000 TestFramework (INFO): Creating blocks with transactions ...\r\n2017-12-21 01:10:40.352000 TestFramework (INFO): ...  0%\r\n2017-12-21 01:11:50.257000 TestFramework (INFO): ... 25%\r\n2017-12-21 01:13:02.097000 TestFramework (INFO): ... 50%\r\n2017-12-21 01:14:12.874000 TestFramework (INFO): ... 75%\r\n2017-12-21 01:15:22.978000 TestFramework (INFO): Sending to shared address ...\r\n2017-12-21 01:15:23.566000 TestFramework (ERROR): Unexpected exception caught during testing\r\nTraceback (most recent call last):\r\n  File \"/Users/karljohan-alm/workspace/bitcoin-kw/test/functional/test_framework/test_framework.py\", line 118, in main\r\n    self.run_test()\r\n  File \"/Users/karljohan-alm/workspace/bitcoin-kw/test/functional/import-abort-rescan.py\", line 39, in run_test\r\n    self.sync_all()\r\n  File \"/Users/karljohan-alm/workspace/bitcoin-kw/test/functional/test_framework/test_framework.py\", line 313, in sync_all\r\n    sync_blocks(group)\r\n  File \"/Users/karljohan-alm/workspace/bitcoin-kw/test/functional/test_framework/util.py\", line 368, in sync_blocks\r\n    maxheight = max(x.getblockcount() for x in rpc_connections)\r\n  File \"/Users/karljohan-alm/workspace/bitcoin-kw/test/functional/test_framework/util.py\", line 368, in <genexpr>\r\n    maxheight = max(x.getblockcount() for x in rpc_connections)\r\n  File \"/Users/karljohan-alm/workspace/bitcoin-kw/test/functional/test_framework/coverage.py\", line 47, in __call__\r\n    return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\r\n  File \"/Users/karljohan-alm/workspace/bitcoin-kw/test/functional/test_framework/authproxy.py\", line 147, in __call__\r\n    response = self._request('POST', self.__url.path, postdata.encode('utf-8'))\r\n  File \"/Users/karljohan-alm/workspace/bitcoin-kw/test/functional/test_framework/authproxy.py\", line 108, in _request\r\n    return self._get_response()\r\n  File \"/Users/karljohan-alm/workspace/bitcoin-kw/test/functional/test_framework/authproxy.py\", line 164, in _get_response\r\n    http_response = self.__conn.getresponse()\r\n  File \"/usr/local/Cellar/python3/3.6.3/Frameworks/Python.framework/Versions/3.6/lib/python3.6/http/client.py\", line 1331, in getresponse\r\n    response.begin()\r\n  File \"/usr/local/Cellar/python3/3.6.3/Frameworks/Python.framework/Versions/3.6/lib/python3.6/http/client.py\", line 297, in begin\r\n    version, status, reason = self._read_status()\r\n  File \"/usr/local/Cellar/python3/3.6.3/Frameworks/Python.framework/Versions/3.6/lib/python3.6/http/client.py\", line 258, in _read_status\r\n    line = str(self.fp.readline(_MAXLINE + 1), \"iso-8859-1\")\r\n  File \"/usr/local/Cellar/python3/3.6.3/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py\", line 586, in readinto\r\n    return self._sock.recv_into(b)\r\nConnectionResetError: [Errno 54] Connection reset by peer\r\n2017-12-21 01:15:23.570000 TestFramework (INFO): Stopping nodes\r\n2017-12-21 01:15:24.265000 TestFramework (WARNING): Not cleaning up dir /var/folders/b8/znqr8hj918772gfmd875gzgdd3ypz1/T/bitcoin_test_runner_20171221_100356/import-abort-rescan_961\r\n2017-12-21 01:15:24.269000 TestFramework (ERROR): Test failed. Test logging available at /var/folders/b8/znqr8hj918772gfmd875gzgdd3ypz1/T/bitcoin_test_runner_20171221_100356/import-abort-rescan_961/test_framework.log\r\n2017-12-21 01:15:24.270000 TestFramework (ERROR): Hint: Call /Users/karljohan-alm/workspace/bitcoin-kw/test/functional/combine_logs.py '/var/folders/b8/znqr8hj918772gfmd875gzgdd3ypz1/T/bitcoin_test_runner_20171221_100356/import-abort-rescan_961' to consolidate all logs\r\n```\r\n",
      "created_at" : "2017-12-21T01:20:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-353230401",
      "id" : 353230401,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2017-12-21T01:20:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/353230401",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "Closing for now, as this PR seems to be dormant, let me know when you want to pick it up again and I'll reopen.",
      "created_at" : "2018-03-07T18:59:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10367#issuecomment-371246210",
      "id" : 371246210,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10367",
      "updated_at" : "2018-03-07T18:59:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/371246210",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
