[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/27101).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [ajtowns](https://github.com/bitcoin/bitcoin/pull/27101#pullrequestreview-1299171355), [fanquake](https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1437361943), [sipa](https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1447126690), [stickies-v](https://github.com/bitcoin/bitcoin/pull/27101#pullrequestreview-1321541037), [vincenzopalazzo](https://github.com/bitcoin/bitcoin/pull/27101#pullrequestreview-1627573915), [tdb3](https://github.com/bitcoin/bitcoin/pull/27101#pullrequestreview-1847563884) |\n| Stale ACK | [willcl-ark](https://github.com/bitcoin/bitcoin/pull/27101#pullrequestreview-1511661787), [ryanofsky](https://github.com/bitcoin/bitcoin/pull/27101#pullrequestreview-1782332723) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.\n",
      "created_at" : "2023-02-14T19:13:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1430251726",
      "id" : 1430251726,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27101",
      "node_id" : "IC_kwDOABII585VP-jO",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1430251726/reactions"
      },
      "updated_at" : "2024-01-28T16:20:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1430251726",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1106907468"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1106907468"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Rather than `bool is20`, `enum JSONVersion { JSON_1_BTC, JSON_2_0 }` might be clearer?",
      "commit_id" : "5f9179a339b79f4a3eca6200bab76bef62217ca5",
      "created_at" : "2023-02-15T09:59:41Z",
      "diff_hunk" : "@@ -36,8 +22,23 @@ class JSONRPCRequest\n     std::string authUser;\n     std::string peerAddr;\n     std::any context;\n+    bool m_is20 = false;\n \n     void parse(const UniValue& valRequest);\n };\n \n+UniValue JSONRPCRequestObj(const std::string& strMethod, const UniValue& params, const UniValue& id);\n+UniValue JSONRPCReplyObj(const UniValue& result, const UniValue& error, const UniValue& id, bool is20);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1106907468",
      "id" : 1106907468,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585B-hFM",
      "original_commit_id" : "440d6a2e07810a24bc0951d1d2914a852f8f21c7",
      "original_line" : 31,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "src/rpc/request.h",
      "position" : null,
      "pull_request_review_id" : 1299171355,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1106907468/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-02-16T19:06:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1106907468",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2023-02-20T17:41:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1437361943",
      "id" : 1437361943,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27101",
      "node_id" : "IC_kwDOABII585VrGcX",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1437361943/reactions"
      },
      "updated_at" : "2023-02-20T17:41:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1437361943",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. Migrating to strict JSON-RPC 2.0 for `bitcoin-cli` and whatever opts into 2.0 is cool, even if it means keeping support for kinda-sorta-JSON-RPC 1.0 around on the server side.",
      "created_at" : "2023-02-27T21:33:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1447126690",
      "id" : 1447126690,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27101",
      "node_id" : "IC_kwDOABII585WQWai",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1447126690/reactions"
      },
      "updated_at" : "2023-02-27T21:33:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1447126690",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK.\r\n\r\nMight be worth updating a few other things at the same time if you continue to move ahead:\r\n\r\n* This comment: https://github.com/bitcoin/bitcoin/pull/27101/files#diff-188b88992c9e08a108e852e7f69a2c2c6569d4b1212c9d05c46fdfd7fcb778d7R21-R27\r\n* [HelpExampleRPC()](https://github.com/bitcoin/bitcoin/blob/master/src/rpc/util.cpp#L157-L161) to json 2.0\r\n* Could warrant a release note to document new behaviours when using json 2.0",
      "created_at" : "2023-02-28T12:31:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1448101737",
      "id" : 1448101737,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27101",
      "node_id" : "IC_kwDOABII585WUEdp",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1448101737/reactions"
      },
      "updated_at" : "2023-02-28T12:31:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1448101737",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@willcl-ark thanks, I added comments and release notes.\r\n\r\nI also wrote a tiny testing package using [libjson-rpc-cpp](https://github.com/cinemast/libjson-rpc-cpp) to check against an \"outside\" JSON-RPC 2.0 implementation. The package is https://github.com/pinheadmz/jsonrpc-bitcoin and [seems to like the 2.0 implementation so far.](https://github.com/pinheadmz/jsonrpc-bitcoin#examples)",
      "created_at" : "2023-03-01T19:08:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1450711073",
      "id" : 1450711073,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27101",
      "node_id" : "IC_kwDOABII585WeBgh",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1450711073/reactions"
      },
      "updated_at" : "2023-03-01T19:08:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1450711073",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This PR is ready for code review if any of you fine handsome concept-ACKers have the time â¤ï¸",
      "created_at" : "2023-03-20T15:04:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1476400553",
      "id" : 1476400553,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27101",
      "node_id" : "IC_kwDOABII585YABWp",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1476400553/reactions"
      },
      "updated_at" : "2023-03-20T15:04:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1476400553",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1142690986"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142690986"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Should this not be a `status: 200, error: -32602` under json 2.0?",
      "commit_id" : "5f9179a339b79f4a3eca6200bab76bef62217ca5",
      "created_at" : "2023-03-20T21:22:53Z",
      "diff_hunk" : "@@ -91,6 +122,17 @@ def test_http_status_codes(self):\n         assert_equal(response['error']['code'], -32700)                 # RPC_PARSE_ERROR\n         assert_equal(status, 500)\n \n+        self.log.info(\"Testing HTTP status codes for JSON-RPC 2.0 requests...\")\n+        AuthServiceProxy.jsonrpc20 = True\n+        # All 200!\n+        expect_http_status(200, -32601, self.nodes[0].invalidmethod)    # RPC_METHOD_NOT_FOUND\n+        expect_http_status(200, -8,     self.nodes[0].getblockhash, 42) # RPC_INVALID_PARAMETER",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1142690986",
      "id" : 1142690986,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EHBSq",
      "original_commit_id" : "277727714e8eb9ed34749a469c02f0f6f02b80e5",
      "original_line" : 135,
      "original_position" : 83,
      "original_start_line" : null,
      "path" : "test/functional/interface_rpc.py",
      "position" : null,
      "pull_request_review_id" : 1349388347,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142690986/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-21T10:57:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142690986",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1142695923"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142695923"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Were we not using the out-of-spec `\"jsonrpc\": \"1.0\"` here previously?\r\n\r\nedit: It seems it doesn't make any difference as was not being validated? ð¤·ð¼ââï¸ ",
      "commit_id" : "5f9179a339b79f4a3eca6200bab76bef62217ca5",
      "created_at" : "2023-03-20T21:29:22Z",
      "diff_hunk" : "@@ -50,17 +50,16 @@ def test_getrpcinfo(self):\n         assert_equal(info['logpath'], os.path.join(self.nodes[0].datadir, self.chain, 'debug.log'))\n \n     def test_batch_request(self):\n-        self.log.info(\"Testing basic JSON-RPC batch request...\")\n-\n+        self.log.info(\"Testing basic JSON-RPC 1.1 batch request...\")\n         results = self.nodes[0].batch([\n             # A basic request that will work fine.\n-            {\"method\": \"getblockcount\", \"id\": 1},\n+            {\"version\": \"1.1\", \"method\": \"getblockcount\", \"id\": 1},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1142695923",
      "id" : 1142695923,
      "line" : 56,
      "node_id" : "PRRC_kwDOABII585EHCfz",
      "original_commit_id" : "277727714e8eb9ed34749a469c02f0f6f02b80e5",
      "original_line" : 56,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "test/functional/interface_rpc.py",
      "position" : 32,
      "pull_request_review_id" : 1349388347,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142695923/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-21T10:57:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142695923",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1143113513"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143113513"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Note that we do actually test json-rpc error code `-32602` in a different test, which might be worth documenting here?\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/1cc1c7210696e3ea758ea5e390eafe824cd06a9e/test/functional/p2p_disconnect_ban.py#L111\r\n\r\nSimilarly `-32603` is tested here:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/1cc1c7210696e3ea758ea5e390eafe824cd06a9e/test/functional/feature_fee_estimation.py#L335",
      "commit_id" : "5f9179a339b79f4a3eca6200bab76bef62217ca5",
      "created_at" : "2023-03-21T09:46:09Z",
      "diff_hunk" : "@@ -79,9 +78,41 @@ def test_batch_request(self):\n \n         assert_equal(result_by_id[4]['error']['code'], -32600)          # RPC_INVALID_REQUEST\n         assert_equal(result_by_id[4]['error']['message'], \"Missing method\")\n+        assert_equal(result_by_id[2]['result'], None)\n+\n+        self.log.info(\"Testing basic JSON-RPC 2.0 batch request...\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1143113513",
      "id" : 1143113513,
      "line" : 83,
      "node_id" : "PRRC_kwDOABII585EIocp",
      "original_commit_id" : "277727714e8eb9ed34749a469c02f0f6f02b80e5",
      "original_line" : 83,
      "original_position" : 38,
      "original_start_line" : null,
      "path" : "test/functional/interface_rpc.py",
      "position" : 61,
      "pull_request_review_id" : 1349388347,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143113513/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-21T10:57:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143113513",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1143114171"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143114171"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Why do we choose `status: 500, error: -32700` here vs `status: 200, error: -32700`? I feel inclined to argue that we didn't experience an http server error, this is just a parsing error.",
      "commit_id" : "5f9179a339b79f4a3eca6200bab76bef62217ca5",
      "created_at" : "2023-03-21T09:46:38Z",
      "diff_hunk" : "@@ -91,6 +122,17 @@ def test_http_status_codes(self):\n         assert_equal(response['error']['code'], -32700)                 # RPC_PARSE_ERROR\n         assert_equal(status, 500)\n \n+        self.log.info(\"Testing HTTP status codes for JSON-RPC 2.0 requests...\")\n+        AuthServiceProxy.jsonrpc20 = True\n+        # All 200!\n+        expect_http_status(200, -32601, self.nodes[0].invalidmethod)    # RPC_METHOD_NOT_FOUND\n+        expect_http_status(200, -8,     self.nodes[0].getblockhash, 42) # RPC_INVALID_PARAMETER\n+        expect_http_status(200, None,   self.nodes[0].getblockhash, 0)\n+        # force-send invalidly formatted request\n+        response, status = self.nodes[0]._request('POST', \"/\", b'this is bad')\n+        assert_equal(response['error']['code'], -32700)                 # RPC_PARSE_ERROR\n+        assert_equal(status, 500)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1143114171",
      "id" : 1143114171,
      "line" : 140,
      "node_id" : "PRRC_kwDOABII585EIom7",
      "original_commit_id" : "277727714e8eb9ed34749a469c02f0f6f02b80e5",
      "original_line" : 140,
      "original_position" : 88,
      "original_start_line" : null,
      "path" : "test/functional/interface_rpc.py",
      "position" : 120,
      "pull_request_review_id" : 1349388347,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143114171/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-21T10:57:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143114171",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1143119006"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143119006"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Perhaps in demonstrating best-practice it could be nice to not use a `null` value for `id` in the request, so we can avoid the `null` response. Per json-rpc 2.0 an `id: null` request is _supposed_ to be a \"notification\", which does not get responded to (although I think we should ignore actually parsing them like this interally, and respond to all requests).",
      "commit_id" : "5f9179a339b79f4a3eca6200bab76bef62217ca5",
      "created_at" : "2023-03-21T09:50:11Z",
      "diff_hunk" : "@@ -0,0 +1,41 @@\n+JSON-RPC\n+--------\n+\n+The JSON-RPC server will behave and respond to JSON-RPC 2.0 requests with\n+strict adherence to the specification (https://www.jsonrpc.org/specification).\n+\n+Examples including HTTP response codes:\n+\n+```sh\n+$ curl u:p@127.0.0.1:18443/ -i --data '{\"method\": \"doesnotexist\"}'\n+HTTP/1.1 404 Not Found\n+Content-Type: application/json\n+Date: Wed, 01 Mar 2023 19:01:16 GMT\n+Content-Length: 79\n+\n+{\"result\":null,\"error\":{\"code\":-32601,\"message\":\"Method not found\"},\"id\":null}\n+\n+$ curl u:p@127.0.0.1:18443/ -i --data '{\"jsonrpc\": \"2.0\", \"method\": \"doesnotexist\"}'\n+HTTP/1.1 200 OK\n+Content-Type: application/json\n+Date: Wed, 01 Mar 2023 19:01:19 GMT\n+Content-Length: 81\n+\n+{\"jsonrpc\":\"2.0\",\"error\":{\"code\":-32601,\"message\":\"Method not found\"},\"id\":null}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1143119006",
      "id" : 1143119006,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EIpye",
      "original_commit_id" : "2da823199b8d822f8c3350145ee6f21132b4eec0",
      "original_line" : 24,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "doc/release-notes-27101.md",
      "position" : null,
      "pull_request_review_id" : 1349388347,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143119006/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-21T10:57:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143119006",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1143200285"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143200285"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Just a behaviour quirk I noticed in mutating these a little for testing: we can actually service batch requests which consist of a mixture of 1.0 and 2.0 requests. This test itself will fail, as it's asserting that `error` is not present (which if one is changed to 1.0 it is), but the server can handle it. Not that I think it's a particularly realistic or common situation...",
      "commit_id" : "5f9179a339b79f4a3eca6200bab76bef62217ca5",
      "created_at" : "2023-03-21T10:55:27Z",
      "diff_hunk" : "@@ -68,17 +69,69 @@ def test_batch_request(self):\n         assert_equal(result_by_id[1]['error'], None)\n         assert_equal(result_by_id[1]['result'], 0)\n \n-        assert_equal(result_by_id[2]['error']['code'], -32601)\n+        assert_equal(result_by_id[2]['error']['code'], -32601)          # RPC_METHOD_NOT_FOUND\n+        assert_equal(result_by_id[2]['error']['message'], \"Method not found\")\n         assert_equal(result_by_id[2]['result'], None)\n \n         assert_equal(result_by_id[3]['error'], None)\n         assert result_by_id[3]['result'] is not None\n \n-    def test_http_status_codes(self):\n-        self.log.info(\"Testing HTTP status codes for JSON-RPC requests...\")\n+        assert_equal(result_by_id[4]['error']['code'], -32600)          # RPC_INVALID_REQUEST\n+        assert_equal(result_by_id[4]['error']['message'], \"Missing method\")\n+        assert_equal(result_by_id[2]['result'], None)\n \n-        expect_http_status(404, -32601, self.nodes[0].invalidmethod)\n-        expect_http_status(500, -8, self.nodes[0].getblockhash, 42)\n+        self.log.info(\"Testing basic JSON-RPC 2.0 batch request...\")\n+        results = self.nodes[0].batch([\n+            # A basic request that will work fine.\n+            {\"jsonrpc\": \"2.0\", \"method\": \"getblockcount\", \"id\": 5},\n+            # Request that will fail.  The whole batch request should still work fine.\n+            {\"jsonrpc\": \"2.0\", \"method\": \"invalidmethod\", \"id\": 6},\n+            # Another call that should succeed.\n+            {\"jsonrpc\": \"2.0\", \"method\": \"getblockhash\", \"id\": 7, \"params\": [0]},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1143200285",
      "id" : 1143200285,
      "line" : 90,
      "node_id" : "PRRC_kwDOABII585EI9od",
      "original_commit_id" : "2da823199b8d822f8c3350145ee6f21132b4eec0",
      "original_line" : 90,
      "original_position" : 70,
      "original_start_line" : null,
      "path" : "test/functional/interface_rpc.py",
      "position" : 68,
      "pull_request_review_id" : 1349388347,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143200285/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-21T10:57:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143200285",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1145223127"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145223127"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Hm yeah good point, a few error codes like this [are specified](https://www.jsonrpc.org/specification#error_object). One problem with this is that our application error `RPC_INVALID_PARAMETER` (`-8`) is coded ~186 times in RPC functions everywhere. I suppose we could re-map those error codes back to the jsonrpc 2.0 spec in `JSONRPCExecOne()`? Only when the request indicates jsonrpc 2.0\r\n\r\n",
      "commit_id" : "5f9179a339b79f4a3eca6200bab76bef62217ca5",
      "created_at" : "2023-03-22T18:05:49Z",
      "diff_hunk" : "@@ -91,6 +122,17 @@ def test_http_status_codes(self):\n         assert_equal(response['error']['code'], -32700)                 # RPC_PARSE_ERROR\n         assert_equal(status, 500)\n \n+        self.log.info(\"Testing HTTP status codes for JSON-RPC 2.0 requests...\")\n+        AuthServiceProxy.jsonrpc20 = True\n+        # All 200!\n+        expect_http_status(200, -32601, self.nodes[0].invalidmethod)    # RPC_METHOD_NOT_FOUND\n+        expect_http_status(200, -8,     self.nodes[0].getblockhash, 42) # RPC_INVALID_PARAMETER",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1145223127",
      "id" : 1145223127,
      "in_reply_to_id" : 1142690986,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EQrfX",
      "original_commit_id" : "277727714e8eb9ed34749a469c02f0f6f02b80e5",
      "original_line" : 135,
      "original_position" : 83,
      "original_start_line" : null,
      "path" : "test/functional/interface_rpc.py",
      "position" : null,
      "pull_request_review_id" : 1353203147,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145223127/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-22T18:05:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145223127",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1145229348"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145229348"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In the tests at least it was originally `version: \"1.1\"` as seen in [authproxy.py](https://github.com/bitcoin/bitcoin/pull/27101/files#diff-6e2d6b181408a11452bcf83c79b299ba195524165e8a46e746b9d712961cc6fb) which is actually [in the 1.1 spec](https://www.jsonrpc.org/historical/json-rpc-1-1-wd.html#ProcedureCall). I'm not sure if `\"jsonrpc\": \"1.0\"` was part of an older spec or if thats a mistake [here](https://github.com/bitcoin/bitcoin/pull/27101/files#diff-fc0f86b6c3bb23b0e983bcf79d7546d1c9eaa15d6e4d8a7b03b5b85955f585abL526)",
      "commit_id" : "5f9179a339b79f4a3eca6200bab76bef62217ca5",
      "created_at" : "2023-03-22T18:11:39Z",
      "diff_hunk" : "@@ -50,17 +50,16 @@ def test_getrpcinfo(self):\n         assert_equal(info['logpath'], os.path.join(self.nodes[0].datadir, self.chain, 'debug.log'))\n \n     def test_batch_request(self):\n-        self.log.info(\"Testing basic JSON-RPC batch request...\")\n-\n+        self.log.info(\"Testing basic JSON-RPC 1.1 batch request...\")\n         results = self.nodes[0].batch([\n             # A basic request that will work fine.\n-            {\"method\": \"getblockcount\", \"id\": 1},\n+            {\"version\": \"1.1\", \"method\": \"getblockcount\", \"id\": 1},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1145229348",
      "id" : 1145229348,
      "in_reply_to_id" : 1142695923,
      "line" : 56,
      "node_id" : "PRRC_kwDOABII585EQtAk",
      "original_commit_id" : "277727714e8eb9ed34749a469c02f0f6f02b80e5",
      "original_line" : 56,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "test/functional/interface_rpc.py",
      "position" : 32,
      "pull_request_review_id" : 1353212247,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145229348/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-22T18:11:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145229348",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1145232671"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145232671"
         }
      },
      "author_association" : "MEMBER",
      "body" : "aw geez. Well, ok so it looks like `disconnectnode` is the only RPC that throws the (correct?) error code for invalid params, while the rest throw `RPC_INVALID_PARAMETER` (`-8`). Maybe it does make sense to use a scripted diff to replace all the `-8`s with `-32602`. Nice catch!",
      "commit_id" : "5f9179a339b79f4a3eca6200bab76bef62217ca5",
      "created_at" : "2023-03-22T18:14:40Z",
      "diff_hunk" : "@@ -79,9 +78,41 @@ def test_batch_request(self):\n \n         assert_equal(result_by_id[4]['error']['code'], -32600)          # RPC_INVALID_REQUEST\n         assert_equal(result_by_id[4]['error']['message'], \"Missing method\")\n+        assert_equal(result_by_id[2]['result'], None)\n+\n+        self.log.info(\"Testing basic JSON-RPC 2.0 batch request...\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1145232671",
      "id" : 1145232671,
      "in_reply_to_id" : 1143113513,
      "line" : 83,
      "node_id" : "PRRC_kwDOABII585EQt0f",
      "original_commit_id" : "277727714e8eb9ed34749a469c02f0f6f02b80e5",
      "original_line" : 83,
      "original_position" : 38,
      "original_start_line" : null,
      "path" : "test/functional/interface_rpc.py",
      "position" : 61,
      "pull_request_review_id" : 1353216966,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145232671/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-22T18:14:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145232671",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1145235420"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145235420"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Not sure if `RPC_INTERNAL_ERROR` (`-32603`) is totally correct for estimating fee from a blocksonly node. It's more of a bad request ...",
      "commit_id" : "5f9179a339b79f4a3eca6200bab76bef62217ca5",
      "created_at" : "2023-03-22T18:17:10Z",
      "diff_hunk" : "@@ -79,9 +78,41 @@ def test_batch_request(self):\n \n         assert_equal(result_by_id[4]['error']['code'], -32600)          # RPC_INVALID_REQUEST\n         assert_equal(result_by_id[4]['error']['message'], \"Missing method\")\n+        assert_equal(result_by_id[2]['result'], None)\n+\n+        self.log.info(\"Testing basic JSON-RPC 2.0 batch request...\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1145235420",
      "id" : 1145235420,
      "in_reply_to_id" : 1143113513,
      "line" : 83,
      "node_id" : "PRRC_kwDOABII585EQufc",
      "original_commit_id" : "277727714e8eb9ed34749a469c02f0f6f02b80e5",
      "original_line" : 83,
      "original_position" : 38,
      "original_start_line" : null,
      "path" : "test/functional/interface_rpc.py",
      "position" : 61,
      "pull_request_review_id" : 1353220773,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145235420/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-22T18:17:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145235420",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1145246067"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145246067"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This error is caused by a failure to parse JSON in `ReadBody()` so theoretically we also can't read the `\"jsonrpc\": \"2.0\"` pair either. I agree with you though, the HTTP transport is fine and should be 200, because the error is coming from the json parser. I guess the options are:\r\n1. always send 200 [here](https://github.com/bitcoin/bitcoin/blob/master/src/httprpc.cpp#L77) and kinda break backwards compat\r\n2. attempt to parse the `\"jsonrpc\"` string and only send 200 if we can detect the \"2.0\" value\r\n3. leave as-is, meaning invalid requests will get 500 even if they otherwise intended to be \"2.0\"",
      "commit_id" : "5f9179a339b79f4a3eca6200bab76bef62217ca5",
      "created_at" : "2023-03-22T18:27:17Z",
      "diff_hunk" : "@@ -91,6 +122,17 @@ def test_http_status_codes(self):\n         assert_equal(response['error']['code'], -32700)                 # RPC_PARSE_ERROR\n         assert_equal(status, 500)\n \n+        self.log.info(\"Testing HTTP status codes for JSON-RPC 2.0 requests...\")\n+        AuthServiceProxy.jsonrpc20 = True\n+        # All 200!\n+        expect_http_status(200, -32601, self.nodes[0].invalidmethod)    # RPC_METHOD_NOT_FOUND\n+        expect_http_status(200, -8,     self.nodes[0].getblockhash, 42) # RPC_INVALID_PARAMETER\n+        expect_http_status(200, None,   self.nodes[0].getblockhash, 0)\n+        # force-send invalidly formatted request\n+        response, status = self.nodes[0]._request('POST', \"/\", b'this is bad')\n+        assert_equal(response['error']['code'], -32700)                 # RPC_PARSE_ERROR\n+        assert_equal(status, 500)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1145246067",
      "id" : 1145246067,
      "in_reply_to_id" : 1143114171,
      "line" : 140,
      "node_id" : "PRRC_kwDOABII585EQxFz",
      "original_commit_id" : "277727714e8eb9ed34749a469c02f0f6f02b80e5",
      "original_line" : 140,
      "original_position" : 88,
      "original_start_line" : null,
      "path" : "test/functional/interface_rpc.py",
      "position" : 120,
      "pull_request_review_id" : 1353235877,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145246067/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-22T18:27:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145246067",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1145250554"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145250554"
         }
      },
      "author_association" : "MEMBER",
      "body" : "yep thanks, will update",
      "commit_id" : "5f9179a339b79f4a3eca6200bab76bef62217ca5",
      "created_at" : "2023-03-22T18:31:38Z",
      "diff_hunk" : "@@ -0,0 +1,41 @@\n+JSON-RPC\n+--------\n+\n+The JSON-RPC server will behave and respond to JSON-RPC 2.0 requests with\n+strict adherence to the specification (https://www.jsonrpc.org/specification).\n+\n+Examples including HTTP response codes:\n+\n+```sh\n+$ curl u:p@127.0.0.1:18443/ -i --data '{\"method\": \"doesnotexist\"}'\n+HTTP/1.1 404 Not Found\n+Content-Type: application/json\n+Date: Wed, 01 Mar 2023 19:01:16 GMT\n+Content-Length: 79\n+\n+{\"result\":null,\"error\":{\"code\":-32601,\"message\":\"Method not found\"},\"id\":null}\n+\n+$ curl u:p@127.0.0.1:18443/ -i --data '{\"jsonrpc\": \"2.0\", \"method\": \"doesnotexist\"}'\n+HTTP/1.1 200 OK\n+Content-Type: application/json\n+Date: Wed, 01 Mar 2023 19:01:19 GMT\n+Content-Length: 81\n+\n+{\"jsonrpc\":\"2.0\",\"error\":{\"code\":-32601,\"message\":\"Method not found\"},\"id\":null}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1145250554",
      "id" : 1145250554,
      "in_reply_to_id" : 1143119006,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EQyL6",
      "original_commit_id" : "2da823199b8d822f8c3350145ee6f21132b4eec0",
      "original_line" : 24,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "doc/release-notes-27101.md",
      "position" : null,
      "pull_request_review_id" : 1353242220,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145250554/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-22T18:31:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145250554",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1145263307"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145263307"
         }
      },
      "author_association" : "MEMBER",
      "body" : "another good call, thats a bug. I force-pushed with a fix and added a mixed 1.1 + 2.0 in the batch test",
      "commit_id" : "5f9179a339b79f4a3eca6200bab76bef62217ca5",
      "created_at" : "2023-03-22T18:44:13Z",
      "diff_hunk" : "@@ -68,17 +69,69 @@ def test_batch_request(self):\n         assert_equal(result_by_id[1]['error'], None)\n         assert_equal(result_by_id[1]['result'], 0)\n \n-        assert_equal(result_by_id[2]['error']['code'], -32601)\n+        assert_equal(result_by_id[2]['error']['code'], -32601)          # RPC_METHOD_NOT_FOUND\n+        assert_equal(result_by_id[2]['error']['message'], \"Method not found\")\n         assert_equal(result_by_id[2]['result'], None)\n \n         assert_equal(result_by_id[3]['error'], None)\n         assert result_by_id[3]['result'] is not None\n \n-    def test_http_status_codes(self):\n-        self.log.info(\"Testing HTTP status codes for JSON-RPC requests...\")\n+        assert_equal(result_by_id[4]['error']['code'], -32600)          # RPC_INVALID_REQUEST\n+        assert_equal(result_by_id[4]['error']['message'], \"Missing method\")\n+        assert_equal(result_by_id[2]['result'], None)\n \n-        expect_http_status(404, -32601, self.nodes[0].invalidmethod)\n-        expect_http_status(500, -8, self.nodes[0].getblockhash, 42)\n+        self.log.info(\"Testing basic JSON-RPC 2.0 batch request...\")\n+        results = self.nodes[0].batch([\n+            # A basic request that will work fine.\n+            {\"jsonrpc\": \"2.0\", \"method\": \"getblockcount\", \"id\": 5},\n+            # Request that will fail.  The whole batch request should still work fine.\n+            {\"jsonrpc\": \"2.0\", \"method\": \"invalidmethod\", \"id\": 6},\n+            # Another call that should succeed.\n+            {\"jsonrpc\": \"2.0\", \"method\": \"getblockhash\", \"id\": 7, \"params\": [0]},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1145263307",
      "id" : 1145263307,
      "in_reply_to_id" : 1143200285,
      "line" : 90,
      "node_id" : "PRRC_kwDOABII585EQ1TL",
      "original_commit_id" : "2da823199b8d822f8c3350145ee6f21132b4eec0",
      "original_line" : 90,
      "original_position" : 70,
      "original_start_line" : null,
      "path" : "test/functional/interface_rpc.py",
      "position" : 68,
      "pull_request_review_id" : 1353260532,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145263307/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-22T18:44:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145263307",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1145426398"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145426398"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think I'd lean here towards option 3, not breaking backwards-compatibility and just let json2.0 users \"suffer\" a `status: 500, error: -32700` :)",
      "commit_id" : "5f9179a339b79f4a3eca6200bab76bef62217ca5",
      "created_at" : "2023-03-22T21:26:44Z",
      "diff_hunk" : "@@ -91,6 +122,17 @@ def test_http_status_codes(self):\n         assert_equal(response['error']['code'], -32700)                 # RPC_PARSE_ERROR\n         assert_equal(status, 500)\n \n+        self.log.info(\"Testing HTTP status codes for JSON-RPC 2.0 requests...\")\n+        AuthServiceProxy.jsonrpc20 = True\n+        # All 200!\n+        expect_http_status(200, -32601, self.nodes[0].invalidmethod)    # RPC_METHOD_NOT_FOUND\n+        expect_http_status(200, -8,     self.nodes[0].getblockhash, 42) # RPC_INVALID_PARAMETER\n+        expect_http_status(200, None,   self.nodes[0].getblockhash, 0)\n+        # force-send invalidly formatted request\n+        response, status = self.nodes[0]._request('POST', \"/\", b'this is bad')\n+        assert_equal(response['error']['code'], -32700)                 # RPC_PARSE_ERROR\n+        assert_equal(status, 500)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1145426398",
      "id" : 1145426398,
      "in_reply_to_id" : 1143114171,
      "line" : 140,
      "node_id" : "PRRC_kwDOABII585ERdHe",
      "original_commit_id" : "277727714e8eb9ed34749a469c02f0f6f02b80e5",
      "original_line" : 140,
      "original_position" : 88,
      "original_start_line" : null,
      "path" : "test/functional/interface_rpc.py",
      "position" : 120,
      "pull_request_review_id" : 1353502224,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145426398/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-22T21:26:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1145426398",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Added a scripted-diff to completely replace all occurrences of the application-defined `RPC_INVALID_PARAMETER` (-8) with the JSONRPC 2.0 spec-defined `RPC_INVALID_PARAMS` (-32602)",
      "created_at" : "2023-03-28T18:17:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1487397883",
      "id" : 1487397883,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27101",
      "node_id" : "IC_kwDOABII585Yp-P7",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1487397883/reactions"
      },
      "updated_at" : "2023-03-28T18:17:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1487397883",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Looks like CI fails? :eyes: ",
      "created_at" : "2023-04-27T10:44:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1525447572",
      "id" : 1525447572,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27101",
      "node_id" : "IC_kwDOABII585a7HuU",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 1,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1525447572/reactions"
      },
      "updated_at" : "2023-04-27T10:44:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1525447572",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "reACK af86462\r\n\r\nNow using const reference in `parse()`.",
      "created_at" : "2023-05-12T08:48:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1545399521",
      "id" : 1545399521,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27101",
      "node_id" : "IC_kwDOABII585cHOzh",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1545399521/reactions"
      },
      "updated_at" : "2023-05-12T08:48:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1545399521",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-06-01T20:03:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1572698875",
      "id" : 1572698875,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27101",
      "node_id" : "IC_kwDOABII585dvXr7",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1572698875/reactions"
      },
      "updated_at" : "2023-06-01T20:03:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1572698875",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> ð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\r\n\r\ndone, very easy with scripted diff!",
      "created_at" : "2023-06-02T15:22:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1573916898",
      "id" : 1573916898,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27101",
      "node_id" : "IC_kwDOABII585d0BDi",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1573916898/reactions"
      },
      "updated_at" : "2023-06-02T15:22:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1573916898",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-06-29T09:12:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1612682853",
      "id" : 1612682853,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27101",
      "node_id" : "IC_kwDOABII585gH5Zl",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1612682853/reactions"
      },
      "updated_at" : "2023-06-29T09:12:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1612682853",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> ð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\r\n\r\nð ",
      "created_at" : "2023-07-03T17:18:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1618910236",
      "id" : 1618910236,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27101",
      "node_id" : "IC_kwDOABII585gfpwc",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1618910236/reactions"
      },
      "updated_at" : "2023-07-03T17:18:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1618910236",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1251203825"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1251203825"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Just thinking out loud here; we use a code comment to indicate what the error code represents but in many of the other tests it appears we don't (admittedly here it is the point of the test, and in the other locations it's not). I wonder whether it might be clearer to have these enumerated in a single location, e.g. _util.py_, and then they could be used by name here and elsewhere? (this might be a change someone else will just make in the future otherwise, too).\r\n\r\nI think it's probably better left for a followup though, if at all.",
      "commit_id" : "5f9179a339b79f4a3eca6200bab76bef62217ca5",
      "created_at" : "2023-07-03T19:04:28Z",
      "diff_hunk" : "@@ -68,17 +69,75 @@ def test_batch_request(self):\n         assert_equal(result_by_id[1]['error'], None)\n         assert_equal(result_by_id[1]['result'], 0)\n \n-        assert_equal(result_by_id[2]['error']['code'], -32601)\n+        assert_equal(result_by_id[2]['error']['code'], -32601)          # RPC_METHOD_NOT_FOUND",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1251203825",
      "id" : 1251203825,
      "line" : 72,
      "node_id" : "PRRC_kwDOABII585Kk9rx",
      "original_commit_id" : "5f9179a339b79f4a3eca6200bab76bef62217ca5",
      "original_line" : 72,
      "original_position" : 48,
      "original_start_line" : null,
      "path" : "test/functional/interface_rpc.py",
      "position" : 48,
      "pull_request_review_id" : 1511661787,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1251203825/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-04T09:28:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1251203825",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Successfully tested against Sparrow Wallet's internal RPC client, Cormorant. By way of context I need this PR to make batch JSON-RPC requests as the Java client I am using requires JSON-RPC 2.0 formatted responses when a batched call is made.",
      "created_at" : "2023-07-05T10:19:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1621466705",
      "id" : 1621466705,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27101",
      "node_id" : "IC_kwDOABII585gpZ5R",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1621466705/reactions"
      },
      "updated_at" : "2023-07-05T10:19:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1621466705",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/862166?v=4",
         "events_url" : "https://api.github.com/users/craigraw/events{/privacy}",
         "followers_url" : "https://api.github.com/users/craigraw/followers",
         "following_url" : "https://api.github.com/users/craigraw/following{/other_user}",
         "gists_url" : "https://api.github.com/users/craigraw/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/craigraw",
         "id" : 862166,
         "login" : "craigraw",
         "node_id" : "MDQ6VXNlcjg2MjE2Ng==",
         "organizations_url" : "https://api.github.com/users/craigraw/orgs",
         "received_events_url" : "https://api.github.com/users/craigraw/received_events",
         "repos_url" : "https://api.github.com/users/craigraw/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/craigraw/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/craigraw/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/craigraw"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1253614618"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1253614618"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In d11fb70b3fea7c1be5f48e32837d2c81dc7cbd10 \"test: cover more HTTP error codes in interface_rpc.py\"\r\n\r\nThis seems unnecessary?",
      "commit_id" : "5f9179a339b79f4a3eca6200bab76bef62217ca5",
      "created_at" : "2023-07-05T20:30:51Z",
      "diff_hunk" : "@@ -16,7 +16,8 @@ def expect_http_status(expected_http_status, expected_rpc_code,\n                        fcn, *args):\n     try:\n         fcn(*args)\n-        raise AssertionError(f\"Expected RPC error {expected_rpc_code}, got none\")\n+        if expected_rpc_code is not None:\n+            raise AssertionError(f\"Expected RPC error {expected_rpc_code}, got none\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1253614618",
      "id" : 1253614618,
      "line" : 20,
      "node_id" : "PRRC_kwDOABII585KuKQa",
      "original_commit_id" : "d11fb70b3fea7c1be5f48e32837d2c81dc7cbd10",
      "original_line" : 20,
      "original_position" : 6,
      "original_start_line" : 19,
      "path" : "test/functional/interface_rpc.py",
      "position" : 15,
      "pull_request_review_id" : 1515315141,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1253614618/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 19,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-07-05T20:51:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1253614618",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1256035908"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1256035908"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Reverting this change fails the test because we are divorcing HTTP status from RPC error, so you can have an HTTP OK with RPC error and some test cases now also ensure both are OK.\r\n\r\n```\r\n2023-07-07T15:44:27.147000Z TestFramework (ERROR): Assertion failed\r\nTraceback (most recent call last):\r\n  File \"/Users/matthewzipkin/Desktop/work/bitcoin/test/functional/test_framework/test_framework.py\", line 131, in main\r\n    self.run_test()\r\n  File \"/Users/matthewzipkin/Desktop/work/bitcoin/test/functional/interface_rpc.py\", line 157, in run_test\r\n    self.test_http_status_codes()\r\n  File \"/Users/matthewzipkin/Desktop/work/bitcoin/test/functional/interface_rpc.py\", line 125, in test_http_status_codes\r\n    expect_http_status(200, None,   self.nodes[0].getblockhash, 0)\r\n  File \"/Users/matthewzipkin/Desktop/work/bitcoin/test/functional/interface_rpc.py\", line 19, in expect_http_status\r\n    raise AssertionError(f\"Expected RPC error {expected_rpc_code}, got none\")\r\nAssertionError: Expected RPC error None, got none\r\n```",
      "commit_id" : "5f9179a339b79f4a3eca6200bab76bef62217ca5",
      "created_at" : "2023-07-07T15:47:25Z",
      "diff_hunk" : "@@ -16,7 +16,8 @@ def expect_http_status(expected_http_status, expected_rpc_code,\n                        fcn, *args):\n     try:\n         fcn(*args)\n-        raise AssertionError(f\"Expected RPC error {expected_rpc_code}, got none\")\n+        if expected_rpc_code is not None:\n+            raise AssertionError(f\"Expected RPC error {expected_rpc_code}, got none\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1256035908",
      "id" : 1256035908,
      "in_reply_to_id" : 1253614618,
      "line" : 20,
      "node_id" : "PRRC_kwDOABII585K3ZZE",
      "original_commit_id" : "d11fb70b3fea7c1be5f48e32837d2c81dc7cbd10",
      "original_line" : 20,
      "original_position" : 6,
      "original_start_line" : 19,
      "path" : "test/functional/interface_rpc.py",
      "position" : 15,
      "pull_request_review_id" : 1519197674,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1256035908/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 19,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-07-07T15:47:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1256035908",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1256091925"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1256091925"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Hmm, the tests still seemed to work when I had run it without this change..",
      "commit_id" : "5f9179a339b79f4a3eca6200bab76bef62217ca5",
      "created_at" : "2023-07-07T16:22:21Z",
      "diff_hunk" : "@@ -16,7 +16,8 @@ def expect_http_status(expected_http_status, expected_rpc_code,\n                        fcn, *args):\n     try:\n         fcn(*args)\n-        raise AssertionError(f\"Expected RPC error {expected_rpc_code}, got none\")\n+        if expected_rpc_code is not None:\n+            raise AssertionError(f\"Expected RPC error {expected_rpc_code}, got none\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1256091925",
      "id" : 1256091925,
      "in_reply_to_id" : 1253614618,
      "line" : 20,
      "node_id" : "PRRC_kwDOABII585K3nEV",
      "original_commit_id" : "d11fb70b3fea7c1be5f48e32837d2c81dc7cbd10",
      "original_line" : 20,
      "original_position" : 6,
      "original_start_line" : 19,
      "path" : "test/functional/interface_rpc.py",
      "position" : 15,
      "pull_request_review_id" : 1519260947,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1256091925/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 19,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-07-07T16:22:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1256091925",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@achow101 I added `IsNotification()` and a test. Also rebased the PR with more atomic commits for hopefully easier reviewing. As far as 500, that should only be returned by a \"legacy\" json rpc request. The legacy protocol should be unchanged by this PR. Unfortunately if the request is unparseable we can not read the `jsonrpc:\"2.0\"` identifier so the default is to assume legacy.",
      "created_at" : "2023-07-08T12:25:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1627212544",
      "id" : 1627212544,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27101",
      "node_id" : "IC_kwDOABII585g_UsA",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1627212544/reactions"
      },
      "updated_at" : "2023-07-08T12:25:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1627212544",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1260253320"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1260253320"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 94d02376c853aa4835de413d3f75b8b06bcb5193 \"rpc: JSON-RPC 2.0 should not respond to \"notifications\"\"\r\n\r\nThis results in 500 and a response body of \"Unhandled request\". I think it should actually be a 200 with no response body.\r\n\r\n```suggestion\r\n            if (jreq.IsNotification()) {\r\n                req->WriteReply(HTTP_OK);\r\n                return true;\r\n            }\r\n```",
      "commit_id" : "797deaed0904a1982ba3163dc5dbe061b5288167",
      "created_at" : "2023-07-11T20:35:50Z",
      "diff_hunk" : "@@ -204,6 +204,7 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n             }\n \n             jreq.parse(valRequest);\n+            if (jreq.IsNotification()) return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1260253320",
      "id" : 1260253320,
      "line" : 207,
      "node_id" : "PRRC_kwDOABII585LHfCI",
      "original_commit_id" : "94d02376c853aa4835de413d3f75b8b06bcb5193",
      "original_line" : 207,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : 40,
      "pull_request_review_id" : 1525118387,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1260253320/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-11T20:35:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1260253320",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1265886880"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265886880"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm looking into this, the [spec](https://www.jsonrpc.org/specification#notification) repeats no response to notifications but it doesn't indicate whether an HTTP OK is reasonable or whether the request should be completely ignored. I'm having some trouble getting libevent to completely cancel a request without sending anything back (and still letting bitcoind shutdown without hanging!) so maybe a 200 OK is best",
      "commit_id" : "797deaed0904a1982ba3163dc5dbe061b5288167",
      "created_at" : "2023-07-17T20:46:24Z",
      "diff_hunk" : "@@ -204,6 +204,7 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n             }\n \n             jreq.parse(valRequest);\n+            if (jreq.IsNotification()) return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1265886880",
      "id" : 1265886880,
      "in_reply_to_id" : 1260253320,
      "line" : 207,
      "node_id" : "PRRC_kwDOABII585Lc-ag",
      "original_commit_id" : "94d02376c853aa4835de413d3f75b8b06bcb5193",
      "original_line" : 207,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : 40,
      "pull_request_review_id" : 1533673645,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265886880/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-17T20:46:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265886880",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1266207614"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266207614"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "There's https://www.simple-is-better.org/json-rpc/transport_http.html  (linked from the wikipedia page) which says 202 or 204; there's also https://www.simple-is-better.org/json-rpc/extension_transport.html by the same author but dated two months earlier, which suggests 200 or 204.",
      "commit_id" : "797deaed0904a1982ba3163dc5dbe061b5288167",
      "created_at" : "2023-07-18T04:40:02Z",
      "diff_hunk" : "@@ -204,6 +204,7 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n             }\n \n             jreq.parse(valRequest);\n+            if (jreq.IsNotification()) return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1266207614",
      "id" : 1266207614,
      "in_reply_to_id" : 1260253320,
      "line" : 207,
      "node_id" : "PRRC_kwDOABII585LeMt-",
      "original_commit_id" : "94d02376c853aa4835de413d3f75b8b06bcb5193",
      "original_line" : 207,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : 40,
      "pull_request_review_id" : 1534145436,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266207614/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-18T04:40:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266207614",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1266817621"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266817621"
         }
      },
      "author_association" : "MEMBER",
      "body" : "ah awesome thank you, I'll go with `204 No Response` ",
      "commit_id" : "35c516c75d4110f7d651f05228512bd3794f643d",
      "created_at" : "2023-07-18T13:57:29Z",
      "diff_hunk" : "@@ -204,6 +204,7 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n             }\n \n             jreq.parse(valRequest);\n+            if (jreq.IsNotification()) return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1266817621",
      "id" : 1266817621,
      "in_reply_to_id" : 1260253320,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585LghpV",
      "original_commit_id" : "94d02376c853aa4835de413d3f75b8b06bcb5193",
      "original_line" : 207,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : null,
      "pull_request_review_id" : 1535107355,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266817621/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-18T13:57:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266817621",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1267073906"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267073906"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Added in push to 26dcb359acf421dc3f448b49e0b564e714c54792. Also had to tweak `authproxy.py` to accommodate code 204",
      "commit_id" : "35c516c75d4110f7d651f05228512bd3794f643d",
      "created_at" : "2023-07-18T17:02:25Z",
      "diff_hunk" : "@@ -204,6 +204,7 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n             }\n \n             jreq.parse(valRequest);\n+            if (jreq.IsNotification()) return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1267073906",
      "id" : 1267073906,
      "in_reply_to_id" : 1260253320,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585LhgNy",
      "original_commit_id" : "94d02376c853aa4835de413d3f75b8b06bcb5193",
      "original_line" : 207,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : null,
      "pull_request_review_id" : 1535533233,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267073906/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-18T17:02:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267073906",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased on master to re-apply scripted diff",
      "created_at" : "2023-07-24T16:30:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1648237927",
      "id" : 1648237927,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27101",
      "node_id" : "IC_kwDOABII585iPh1n",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1648237927/reactions"
      },
      "updated_at" : "2023-07-24T16:30:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1648237927",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1276717254"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1276717254"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Shouldn't we still execute the notification? While it's not possible for the client to confirm it worked, it should still execute...",
      "commit_id" : "35c516c75d4110f7d651f05228512bd3794f643d",
      "created_at" : "2023-07-27T19:08:53Z",
      "diff_hunk" : "@@ -199,10 +202,13 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n                 req->WriteReply(HTTP_FORBIDDEN);\n                 return false;\n             }\n-            UniValue result = tableRPC.execute(jreq);\n \n-            // Send reply\n-            strReply = JSONRPCReply(result, NullUniValue, jreq.id);\n+            jreq.parse(valRequest);\n+            if (jreq.IsNotification()) {\n+                req->WriteReply(HTTP_NO_CONTENT);\n+                return true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1276717254",
      "id" : 1276717254,
      "line" : 209,
      "node_id" : "PRRC_kwDOABII585MGSjG",
      "original_commit_id" : "35c516c75d4110f7d651f05228512bd3794f643d",
      "original_line" : 209,
      "original_position" : 42,
      "original_start_line" : 207,
      "path" : "src/httprpc.cpp",
      "position" : 42,
      "pull_request_review_id" : 1550578763,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1276717254/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 207,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-07-27T19:11:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1276717254",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1276726382"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1276726382"
         }
      },
      "author_association" : "MEMBER",
      "body" : "My thinking was that since our RPC API does not have any notifications defined yet we could discard them for now. Like, our RPCs and responses are a separate category from notifications.  But you have an interesting point, a user could send a notification with a method like `generatetoaddress` and just not want to wait for a reply. There would be plenty of \"getter\" RPCs that would make no sense in a notification however and just waste time on the server. Maybe this is best suited for a follow-up PR that establishes a notification interface for bitcoind and specifies which commands are allowed there?",
      "commit_id" : "35c516c75d4110f7d651f05228512bd3794f643d",
      "created_at" : "2023-07-27T19:18:18Z",
      "diff_hunk" : "@@ -199,10 +202,13 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n                 req->WriteReply(HTTP_FORBIDDEN);\n                 return false;\n             }\n-            UniValue result = tableRPC.execute(jreq);\n \n-            // Send reply\n-            strReply = JSONRPCReply(result, NullUniValue, jreq.id);\n+            jreq.parse(valRequest);\n+            if (jreq.IsNotification()) {\n+                req->WriteReply(HTTP_NO_CONTENT);\n+                return true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1276726382",
      "id" : 1276726382,
      "in_reply_to_id" : 1276717254,
      "line" : 209,
      "node_id" : "PRRC_kwDOABII585MGUxu",
      "original_commit_id" : "35c516c75d4110f7d651f05228512bd3794f643d",
      "original_line" : 209,
      "original_position" : 42,
      "original_start_line" : 207,
      "path" : "src/httprpc.cpp",
      "position" : 42,
      "pull_request_review_id" : 1550595764,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1276726382/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 207,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-07-27T19:18:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1276726382",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1302098516"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1302098516"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yep good call after doing some more reading about this in other implementations, I updated this branch to match and tested it. So now notifications are executed but send no response.",
      "commit_id" : "576ec3e2debdb63e142eee2c2fa00af995542f42",
      "created_at" : "2023-08-22T19:26:44Z",
      "diff_hunk" : "@@ -199,10 +202,13 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n                 req->WriteReply(HTTP_FORBIDDEN);\n                 return false;\n             }\n-            UniValue result = tableRPC.execute(jreq);\n \n-            // Send reply\n-            strReply = JSONRPCReply(result, NullUniValue, jreq.id);\n+            jreq.parse(valRequest);\n+            if (jreq.IsNotification()) {\n+                req->WriteReply(HTTP_NO_CONTENT);\n+                return true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1302098516",
      "id" : 1302098516,
      "in_reply_to_id" : 1276717254,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585NnHJU",
      "original_commit_id" : "35c516c75d4110f7d651f05228512bd3794f643d",
      "original_line" : 211,
      "original_position" : 42,
      "original_start_line" : 207,
      "path" : "src/httprpc.cpp",
      "position" : null,
      "pull_request_review_id" : 1590176540,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1302098516/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-08-22T19:26:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1302098516",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "also rebased on master again to apply scripted diff",
      "created_at" : "2023-08-22T19:26:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1688798517",
      "id" : 1688798517,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27101",
      "node_id" : "IC_kwDOABII585kqQU1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1688798517/reactions"
      },
      "updated_at" : "2023-08-22T19:26:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1688798517",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@vincenzopalazzo great point thanks, I'll chop off the scripted diff and rebase on master. It has been annoying to keep that scripted diff up to date anyway",
      "created_at" : "2023-10-17T19:40:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1767053292",
      "id" : 1767053292,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27101",
      "node_id" : "IC_kwDOABII585pUxfs",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1767053292/reactions"
      },
      "updated_at" : "2023-10-17T19:40:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1767053292",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1414516901"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414516901"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"rpc: refactor single/batch requests\" (125ef7a61885d2ffc0d32b66cdfb3dced2a4417b)\r\n\r\nThis change doesn't seem right because `jreq.parse` was just called above on line 196, and now the request is going to be parsed for a second time inside `JSONRPCExecOne` for no reason. I think this could be fixed by just dropping the `jreq.parse` call inside `JSONRPCExecOne`. It looks like later commit 4f22286c4aa65a113c44153847c857075a4225d6 does this anyway, so would be better to drop it up front and not change semantics multiple times. It would also be good to make the `ExecOne` `jreq` parameter const at that point since it should no longer be modifying the request. I would also rename `ExecOne` and `ExecBatch` functions to avoid giving the misleading impression that they are alternatives to each other, when actually they are operating at different levels and do not do the same things. ExecBatch handles errors, ExecOne does not. ExecBatch parses and executes, ExecOne should only execute requests without parsing them. Actually, I would probably just drop the ExecBatch function entirely since it is short and only called in one place. It would be clearer to just inline it, IMO.",
      "commit_id" : "576ec3e2debdb63e142eee2c2fa00af995542f42",
      "created_at" : "2023-12-04T21:24:23Z",
      "diff_hunk" : "@@ -199,10 +199,8 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n                 req->WriteReply(HTTP_FORBIDDEN);\n                 return false;\n             }\n-            UniValue result = tableRPC.execute(jreq);\n \n-            // Send reply\n-            strReply = JSONRPCReply(result, NullUniValue, jreq.id);\n+            reply = JSONRPCExecOne(jreq, valRequest);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1414516901",
      "id" : 1414516901,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585UT9Cl",
      "original_commit_id" : "125ef7a61885d2ffc0d32b66cdfb3dced2a4417b",
      "original_line" : 203,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : null,
      "pull_request_review_id" : 1763446892,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414516901/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-04T21:49:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1414516901",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1420979726"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1420979726"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Great review, thank you! I cleaned up the commit history in a rebase. The [diff is minimal](https://github.com/bitcoin/bitcoin/compare/576ec3e2debdb63e142eee2c2fa00af995542f42..5d5e8cbca785db851747c5143dc1d651a1ea11e6) but in the range diff you can see the rebasing removed a commit: \r\n\r\n`git range-diff fbcf1029a7ba47d07a4566cf1f9d2e7b4870304a 576ec3e2debdb63e142eee2c2fa00af995542f42 5d5e8cbca785db851747c5143dc1d651a1ea11e6`\r\n\r\nRegarding naming and in-lining, I could see the two functions being named `JSONRPCParseBatch()` and `JSONRPCExec()`? I still like both of those definitions in server.cpp but if you think the \"parse batch\" logic can live happily ever after in `HTTPReq_JSONRPC()` I won't protest. Either way would these 1 or 2 changes make more sense as a nice easy commit on top? Or should be rebased into the branch.",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-08T20:02:29Z",
      "diff_hunk" : "@@ -199,10 +199,8 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n                 req->WriteReply(HTTP_FORBIDDEN);\n                 return false;\n             }\n-            UniValue result = tableRPC.execute(jreq);\n \n-            // Send reply\n-            strReply = JSONRPCReply(result, NullUniValue, jreq.id);\n+            reply = JSONRPCExecOne(jreq, valRequest);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1420979726",
      "id" : 1420979726,
      "in_reply_to_id" : 1414516901,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Usm4O",
      "original_commit_id" : "125ef7a61885d2ffc0d32b66cdfb3dced2a4417b",
      "original_line" : 203,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : null,
      "pull_request_review_id" : 1773099799,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1420979726/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-08T20:02:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1420979726",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1427031318"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427031318"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"rpc: refactor single/batch requests\" (fcc8cd08dbed9a44bab277ad267306dd2a9f5199)\r\n\r\nWould be clearer if jreq were a const reference, since it is not modified",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-14T17:34:30Z",
      "diff_hunk" : "@@ -356,36 +356,32 @@ bool IsDeprecatedRPCEnabled(const std::string& method)\n     return find(enabled_methods.begin(), enabled_methods.end(), method) != enabled_methods.end();\n }\n \n-static UniValue JSONRPCExecOne(JSONRPCRequest jreq, const UniValue& req)\n+UniValue JSONRPCExecOne(JSONRPCRequest& jreq)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1427031318",
      "id" : 1427031318,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585VDsUW",
      "original_commit_id" : "fcc8cd08dbed9a44bab277ad267306dd2a9f5199",
      "original_line" : 359,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/rpc/server.cpp",
      "position" : null,
      "pull_request_review_id" : 1782332723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427031318/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-18T15:10:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427031318",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1427062419"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427062419"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"rpc: refactor single/batch requests\" (fcc8cd08dbed9a44bab277ad267306dd2a9f5199)\r\n\r\nre: https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1414516901\r\n\r\nI'd specifically suggest deleting the `JSONRPCExecBatch` function in this commit and moving the code it contains to `httprpc.cpp` (the only place it's called). Also would rename `JSONRPCExecOne` to `JSONRPCExec`. Reasons:\r\n\r\n- It would make division of responsibilities of httprpc and rpc/server.cpp clear. Instead of both of these files iterating over the batch object (former for method whitelisting, latter for method execution), the batch iterating code would live in one place and the server.cpp would not need to be concerned with batching.\r\n- It would avoid giving false impression in `httprpc.cpp` that `JSONRPCExecBatch` and `JSONRPCExecOne` functions are alternatives to each other, when they aren't because they don't handle errors the same way, and one modifies the request while the other doesn't.\r\n- It would make error handling more straightforward. The fact that ExecBatch function catches exceptions internally, while ExecOne throws them up to the caller is a footgun.\r\n- It would reduce the size of the code and as well as the size of the commit diff.",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-14T17:45:44Z",
      "diff_hunk" : "@@ -199,10 +199,8 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n                 req->WriteReply(HTTP_FORBIDDEN);\n                 return false;\n             }\n-            UniValue result = tableRPC.execute(jreq);\n \n-            // Send reply\n-            strReply = JSONRPCReply(result, NullUniValue, jreq.id);\n+            reply = JSONRPCExecOne(jreq, valRequest);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1427062419",
      "id" : 1427062419,
      "in_reply_to_id" : 1414516901,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585VDz6T",
      "original_commit_id" : "125ef7a61885d2ffc0d32b66cdfb3dced2a4417b",
      "original_line" : 203,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : null,
      "pull_request_review_id" : 1782332723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427062419/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-18T15:10:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427062419",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1427085941"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427085941"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"MOVEONLY: define class before functions in request.h\" (bcf90ae6b7fd4685755c3f2e1e736053e613e0f6)\r\n\r\nIt seems ok to move these functions, but for future reference, there should be no need to do this because you can forward declare the class with `class JSONRPCRequest;` at the top of the file. I do think it would be slightly preferable to do that instead of moving code, but it's not important.",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-14T18:08:37Z",
      "diff_hunk" : "@@ -40,4 +26,18 @@ class JSONRPCRequest\n     void parse(const UniValue& valRequest);\n };\n \n+UniValue JSONRPCRequestObj(const std::string& strMethod, const UniValue& params, const UniValue& id);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1427085941",
      "id" : 1427085941,
      "line" : 36,
      "node_id" : "PRRC_kwDOABII585VD5p1",
      "original_commit_id" : "bcf90ae6b7fd4685755c3f2e1e736053e613e0f6",
      "original_line" : 29,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/rpc/request.h",
      "position" : 34,
      "pull_request_review_id" : 1782332723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427085941/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-18T15:10:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427085941",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1427089580"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427089580"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"MOVEONLY: define class before functions in request.h\" (bcf90ae6b7fd4685755c3f2e1e736053e613e0f6)\r\n\r\nNot important, but I think the developer guide suggests braces around multiline if statements because it can prevent subtle bugs from sneaking in. Generally only older code in bitcoin core omits the braces on multiline if statements.",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-14T18:12:31Z",
      "diff_hunk" : "@@ -188,4 +188,16 @@ void JSONRPCRequest::parse(const UniValue& valRequest)\n         params = UniValue(UniValue::VARR);\n     else\n         throw JSONRPCError(RPC_INVALID_REQUEST, \"Params must be an array or object\");\n+\n+    // Default\n+    m_json_version = JSONVersion::JSON_1_BTC;\n+\n+    // Check for JSON-RPC 2.0\n+    const UniValue& valJsonRPC = request.find_value(\"jsonrpc\");\n+    if (!valJsonRPC.isNull()) {\n+        if (!valJsonRPC.isStr())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1427089580",
      "id" : 1427089580,
      "line" : 216,
      "node_id" : "PRRC_kwDOABII585VD6is",
      "original_commit_id" : "8c619f70ba0021265041493b25a98f77afa96c55",
      "original_line" : 198,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/rpc/request.cpp",
      "position" : 66,
      "pull_request_review_id" : 1782332723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427089580/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-18T15:10:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427089580",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1427171338"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427171338"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"rpc: make error and result mutually exclusive in JSON-RPC 2.0 replies\" (55dae852d88cdc6a4ad7e4a5cd3ba1988af9872c)\r\n\r\nThis comment is confusing because result and error _values_ are mutually exclusive in both cases.\r\n\r\nYou could clarify the comment saying \"error and result _keys_ are mutually exclusive, to clarify that the comment is referring to keys not values. But I think the way this is written with duplicated logic is unnecessarily confusing anyway. Would suggest just writing the logic once and explaining what it is doing:\r\n\r\n```c++\r\n// Add JSON-RPC version number field in v2 only.\r\nif (json_version == JSONVersion::JSON_2_0) reply.pushKV(\"jsonrpc\", \"2.0\");\r\n\r\n// Add both result and error fields in v1, even though one will be null.\r\n// Omit the null field in v2.\r\nif (error.isNull()) {\r\n    reply.pushKV(\"result\", result);\r\n    if (json_version == JSONVersion::JSON_1_BTC) reply.pushKV(\"error\", NullUniValue);\r\n} else {\r\n    if (json_version == JSONVersion::JSON_1_BTC) reply.pushKV(\"result\", NullUniValue);\r\n    reply.pushKV(\"error\", error);\r\n}\r\n```",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-14T19:22:20Z",
      "diff_hunk" : "@@ -37,21 +37,31 @@ UniValue JSONRPCRequestObj(const std::string& strMethod, const UniValue& params,\n     return request;\n }\n \n-UniValue JSONRPCReplyObj(const UniValue& result, const UniValue& error, const UniValue& id)\n+UniValue JSONRPCReplyObj(const UniValue& result, const UniValue& error, const UniValue& id, JSONVersion json_version)\n {\n     UniValue reply(UniValue::VOBJ);\n-    if (!error.isNull())\n-        reply.pushKV(\"result\", NullUniValue);\n-    else\n-        reply.pushKV(\"result\", result);\n-    reply.pushKV(\"error\", error);\n+    if (json_version == JSONVersion::JSON_2_0) {\n+        reply.pushKV(\"jsonrpc\", \"2.0\");\n+        // JSON-RPC 2.0: error and result are mutually exclusive",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1427171338",
      "id" : 1427171338,
      "line" : 53,
      "node_id" : "PRRC_kwDOABII585VEOgK",
      "original_commit_id" : "55dae852d88cdc6a4ad7e4a5cd3ba1988af9872c",
      "original_line" : 45,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/rpc/request.cpp",
      "position" : 30,
      "pull_request_review_id" : 1782332723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427171338/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-18T15:10:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427171338",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1427179998"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427179998"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"rpc: JSON-RPC 2.0 should not respond to \"notifications\"\" (28e4d9e7dd1604f1504f191d258a32f495c2fb4f)\r\n\r\nWould suggest `reply = std::move(*maybe_result);` to avoid copying the result object",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-14T19:31:13Z",
      "diff_hunk" : "@@ -203,7 +203,14 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n                 return false;\n             }\n \n-            reply = JSONRPCExecOne(jreq);\n+            auto maybe_result = JSONRPCExecOne(jreq);\n+            if (!maybe_result) {\n+                // Even though we do execute notifications, we do not respond to them\n+                req->WriteReply(HTTP_NO_CONTENT);\n+                return true;\n+            } else {\n+                reply = maybe_result.value();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1427179998",
      "id" : 1427179998,
      "line" : 212,
      "node_id" : "PRRC_kwDOABII585VEQne",
      "original_commit_id" : "28e4d9e7dd1604f1504f191d258a32f495c2fb4f",
      "original_line" : 212,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : 45,
      "pull_request_review_id" : 1782332723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427179998/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-18T15:10:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427179998",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1427214586"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427214586"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"rpc: JSON-RPC 2.0 should not respond to \"notifications\"\" (28e4d9e7dd1604f1504f191d258a32f495c2fb4f)\r\n\r\nWould suggest std::move(*maybe_result) here as well to avoid copying",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-14T20:01:19Z",
      "diff_hunk" : "@@ -386,7 +390,9 @@ UniValue JSONRPCExecBatch(JSONRPCRequest& jreq, const UniValue& vReq)\n         // in \"HTTP OK\" responses.\n         try {\n             jreq.parse(vReq[reqIdx]);\n-            ret.push_back(JSONRPCExecOne(jreq));\n+            auto maybe_result = JSONRPCExecOne(jreq);\n+            if (maybe_result)\n+                ret.push_back(maybe_result.value());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1427214586",
      "id" : 1427214586,
      "line" : 395,
      "node_id" : "PRRC_kwDOABII585VEZD6",
      "original_commit_id" : "28e4d9e7dd1604f1504f191d258a32f495c2fb4f",
      "original_line" : 395,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/rpc/server.cpp",
      "position" : 62,
      "pull_request_review_id" : 1782332723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427214586/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-18T15:10:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1427214586",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1429362278"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1429362278"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"rpc: JSON-RPC 2.0 should not respond to \"notifications\"\" (28e4d9e7dd1604f1504f191d258a32f495c2fb4f)\r\n\r\nThe implementation of this notification feature seems unnecessarily complicated. If you take earlier suggestion to delete the JSONRPCExecBatch function, support for notifications could be implemented entirely in the `HTTPReq_JSONRPC` function without sprawl across multiple files and extra complexity in rpc/server.cpp. rpc/server.cpp could just generate replies, not worry about what happens to replies after they are returned, and not have to deal with notifications or batching.",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-18T01:30:40Z",
      "diff_hunk" : "@@ -375,7 +375,11 @@ UniValue JSONRPCExecOne(JSONRPCRequest& jreq)\n         result = tableRPC.execute(jreq);\n     }\n \n-    return JSONRPCReplyObj(result, NullUniValue, jreq.id, jreq.m_json_version);\n+    if (jreq.IsNotification()) {\n+        return std::nullopt;\n+    } else {\n+        return JSONRPCReplyObj(result, NullUniValue, jreq.id, jreq.m_json_version);;\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1429362278",
      "id" : 1429362278,
      "line" : 382,
      "node_id" : "PRRC_kwDOABII585VMlZm",
      "original_commit_id" : "28e4d9e7dd1604f1504f191d258a32f495c2fb4f",
      "original_line" : 382,
      "original_position" : 18,
      "original_start_line" : 378,
      "path" : "src/rpc/server.cpp",
      "position" : 46,
      "pull_request_review_id" : 1782332723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1429362278/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 378,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-12-18T15:10:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1429362278",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1429384897"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1429384897"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"test: cover more HTTP error codes in interface_rpc.py\" (b41f09cbc09a6f5d75636eb2f7ba8bc6d8802942)\r\n\r\nI also don't see why this should be necessary, and the change doesn't make sense logically because now an http status code integer is passed to the expect_http_status function but the value is ignored in this case. Would suggest reverting this change and, if necessary, just writing a new expect_ function instead of trying to extend `expect_http_status` in a way where it appears to be checking things it's not.",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-18T02:09:15Z",
      "diff_hunk" : "@@ -16,7 +16,8 @@ def expect_http_status(expected_http_status, expected_rpc_code,\n                        fcn, *args):\n     try:\n         fcn(*args)\n-        raise AssertionError(f\"Expected RPC error {expected_rpc_code}, got none\")\n+        if expected_rpc_code is not None:\n+            raise AssertionError(f\"Expected RPC error {expected_rpc_code}, got none\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1429384897",
      "id" : 1429384897,
      "in_reply_to_id" : 1253614618,
      "line" : 20,
      "node_id" : "PRRC_kwDOABII585VMq7B",
      "original_commit_id" : "d11fb70b3fea7c1be5f48e32837d2c81dc7cbd10",
      "original_line" : 20,
      "original_position" : 6,
      "original_start_line" : 19,
      "path" : "test/functional/interface_rpc.py",
      "position" : 15,
      "pull_request_review_id" : 1782332723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1429384897/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 19,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-12-18T15:10:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1429384897",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1429389378"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1429389378"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"test: cover more HTTP error codes in interface_rpc.py\" (b41f09cbc09a6f5d75636eb2f7ba8bc6d8802942)\r\n\r\nIs this new line just expanding test coverage and not testing new behavior? Not critical, but in general it helps reviewing if test coverage is expanded first, before commits making code changes. Then it is a lot easier to review the code changes, because you can see how they affect tests. And it is easier to identify gaps in test coverage. An initial commit expanding test coverage before making any code changes is an ideal way to clarify current behavior before changing it.",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-18T02:17:02Z",
      "diff_hunk" : "@@ -54,11 +55,12 @@ def test_batch_request(self):\n         results = self.nodes[0].batch([\n             # A basic request that will work fine.\n             {\"method\": \"getblockcount\", \"id\": 1},\n-            # Request that will fail.  The whole batch request should still\n-            # work fine.\n+            # Request that will fail.  The whole batch request should still work fine.\n             {\"method\": \"invalidmethod\", \"id\": 2},\n             # Another call that should succeed.\n             {\"method\": \"getblockhash\", \"id\": 3, \"params\": [0]},\n+            # Invalid request format\n+            {\"pizza\": \"sausage\", \"id\": 4},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1429389378",
      "id" : 1429389378,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585VMsBC",
      "original_commit_id" : "b41f09cbc09a6f5d75636eb2f7ba8bc6d8802942",
      "original_line" : 63,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "test/functional/interface_rpc.py",
      "position" : null,
      "pull_request_review_id" : 1782332723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1429389378/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-18T15:10:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1429389378",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1429391032"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1429391032"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"test: cover more HTTP error codes in interface_rpc.py\" (b41f09cbc09a6f5d75636eb2f7ba8bc6d8802942)\r\n\r\nAs noted above, 200 status code appears to be ignored here and not checked. Would suggest just dropping this line or finding a different way to test this code path, if it's important.",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-18T02:20:33Z",
      "diff_hunk" : "@@ -68,17 +70,26 @@ def test_batch_request(self):\n         assert_equal(result_by_id[1]['error'], None)\n         assert_equal(result_by_id[1]['result'], 0)\n \n-        assert_equal(result_by_id[2]['error']['code'], -32601)\n+        assert_equal(result_by_id[2]['error']['code'], -32601)          # RPC_METHOD_NOT_FOUND\n+        assert_equal(result_by_id[2]['error']['message'], \"Method not found\")\n         assert_equal(result_by_id[2]['result'], None)\n \n         assert_equal(result_by_id[3]['error'], None)\n         assert result_by_id[3]['result'] is not None\n \n+        assert_equal(result_by_id[4]['error']['code'], -32600)          # RPC_INVALID_REQUEST\n+        assert_equal(result_by_id[4]['error']['message'], \"Missing method\")\n+\n     def test_http_status_codes(self):\n         self.log.info(\"Testing HTTP status codes for JSON-RPC requests...\")\n \n-        expect_http_status(404, -32601, self.nodes[0].invalidmethod)\n-        expect_http_status(500, -8, self.nodes[0].getblockhash, 42)\n+        expect_http_status(404, -32601, self.nodes[0].invalidmethod)    # RPC_METHOD_NOT_FOUND\n+        expect_http_status(500, -8,     self.nodes[0].getblockhash, 42) # RPC_INVALID_PARAMETER\n+        expect_http_status(200, None,   self.nodes[0].getblockhash, 0)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1429391032",
      "id" : 1429391032,
      "line" : 131,
      "node_id" : "PRRC_kwDOABII585VMsa4",
      "original_commit_id" : "b41f09cbc09a6f5d75636eb2f7ba8bc6d8802942",
      "original_line" : 88,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "test/functional/interface_rpc.py",
      "position" : 108,
      "pull_request_review_id" : 1782332723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1429391032/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-18T15:10:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1429391032",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1429401422"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1429401422"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"test: handle 204 NO_CONTENT correctly in authproxy\" (c85c9998dc98d15a7e42a0d2eb142cb516126243)\r\n\r\nThe logic in this function seems too permissive:\r\n- If an empty \"application/json\" response is returned, now it returns None instead of treating the missing JSON as an error\r\n- It does not treat responses that have NO_CONTENT status code but do have content as errors. It will even parse json and return from NO_CONTENT responses and ignore the content_type value.\r\n\r\nThe code is also more confusing now that these cases are mixed together instead of being handled separately. Would suggest just checking for the NO_CONTENT status up front, actually verifying that no content is present, and not mixing up the no content code with the json parsing code.",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-18T02:34:02Z",
      "diff_hunk" : "@@ -161,12 +161,14 @@ def _get_response(self):\n                 'code': -342, 'message': 'missing HTTP response from server'})\n \n         content_type = http_response.getheader('Content-Type')\n-        if content_type != 'application/json':\n+        if content_type != 'application/json' and http_response.status != HTTPStatus.NO_CONTENT:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1429401422",
      "id" : 1429401422,
      "line" : 169,
      "node_id" : "PRRC_kwDOABII585VMu9O",
      "original_commit_id" : "c85c9998dc98d15a7e42a0d2eb142cb516126243",
      "original_line" : 164,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/authproxy.py",
      "position" : 38,
      "pull_request_review_id" : 1782332723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1429401422/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-18T15:10:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1429401422",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1430137654"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430137654"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"test: enable JSON-RPC 2.0 calls in tests and verify expected behavior\" (65c2f4448dc556e7a922ebac4abed7ddfc8d7745)\r\n\r\nThis test code is broken because the requests do not have unique ids. So when the responses come back, the later responses override earlier ones in the `result_by_id` array, the existing test cases without a version fields will not be checked, and any result they return will be treated as valid.\r\n\r\nI also think copying and pasting existing test cases for version 1.1 and version 2.0 makes this code harder to understand and less maintainable. The differences between versions should be small so IMO it would be better to just add a version argument (or version options like https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1430169572) to the test_batch_request method and call it 3 times. The other advantage of making the version variable is that it will make it more obvious what the differences between versions actually are. For example it is easy to miss the fact that 1.1 and 2.0 test cases are actually passing the version number in two different fields.",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-18T13:22:00Z",
      "diff_hunk" : "@@ -50,17 +50,16 @@ def test_getrpcinfo(self):\n         assert_equal(info['logpath'], os.path.join(self.nodes[0].chain_path, 'debug.log'))\n \n     def test_batch_request(self):\n-        self.log.info(\"Testing basic JSON-RPC batch request...\")\n-\n+        self.log.info(\"Testing basic JSON-RPC 1.1 batch request...\")\n         results = self.nodes[0].batch([\n             # A basic request that will work fine.\n-            {\"method\": \"getblockcount\", \"id\": 1},\n+            {\"version\": \"1.1\", \"method\": \"getblockcount\", \"id\": 1},\n             # Request that will fail.  The whole batch request should still work fine.\n-            {\"method\": \"invalidmethod\", \"id\": 2},\n+            {\"version\": \"1.1\", \"method\": \"invalidmethod\", \"id\": 2},\n             # Another call that should succeed.\n-            {\"method\": \"getblockhash\", \"id\": 3, \"params\": [0]},\n+            {\"version\": \"1.1\", \"method\": \"getblockhash\", \"id\": 3, \"params\": [0]},\n             # Invalid request format\n-            {\"pizza\": \"sausage\", \"id\": 4},\n+            {\"version\": \"1.1\", \"pizza\": \"sausage\", \"id\": 4},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1430137654",
      "id" : 1430137654,
      "line" : 62,
      "node_id" : "PRRC_kwDOABII585VPis2",
      "original_commit_id" : "65c2f4448dc556e7a922ebac4abed7ddfc8d7745",
      "original_line" : 62,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "test/functional/interface_rpc.py",
      "position" : 39,
      "pull_request_review_id" : 1782332723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430137654/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-18T15:13:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430137654",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1430169572"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430169572"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"test: enable JSON-RPC 2.0 calls in tests and verify expected behavior\" (65c2f4448dc556e7a922ebac4abed7ddfc8d7745)\r\n\r\nI think instead of hardcoding this logic in this AuthServiceProxy method and not allowing it to be reused for batch requests, it would be better to define a simple utility function that could be used both here and in the test_batch_request test case, and by any other code that needs to send batch requests. Something like:\r\n\r\n```python\r\ndef format_rpc_request(req, v1=False, v2=False):\r\n    if v1: req[\"version\"] = \"1.1\"\r\n    if v2: req[\"jsonrpc\"] = \"2.0\"\r\n    return req\r\n```\r\n",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-18T13:51:54Z",
      "diff_hunk" : "@@ -117,15 +118,19 @@ def get_request(self, *args, **argsn):\n             params = dict(args=args, **argsn)\n         else:\n             params = args or argsn\n-        return {'version': '1.1',\n-                'method': self._service_name,\n-                'params': params,\n-                'id': AuthServiceProxy.__id_count}\n+        ret = {'method': self._service_name,\n+               'params': params,\n+               'id': AuthServiceProxy.__id_count}\n+        if AuthServiceProxy.jsonrpc20:\n+            ret[\"jsonrpc\"] = \"2.0\"\n+        else:\n+            ret[\"version\"] = \"1.1\"\n+        return ret",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1430169572",
      "id" : 1430169572,
      "line" : 128,
      "node_id" : "PRRC_kwDOABII585VPqfk",
      "original_commit_id" : "65c2f4448dc556e7a922ebac4abed7ddfc8d7745",
      "original_line" : 128,
      "original_position" : 23,
      "original_start_line" : 124,
      "path" : "test/functional/test_framework/authproxy.py",
      "position" : 23,
      "pull_request_review_id" : 1782332723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430169572/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 124,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-12-18T15:13:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430169572",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1430194117"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430194117"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"doc: add comments and release-notes for JSON-RPC 2.0\" (5d5e8cbca785db851747c5143dc1d651a1ea11e6)\r\n\r\nThis is vague and doesn't say what's changing. Would suggest something more like \"The server now recognizes JSON-RPC 2.0 requests and treats them differently. Previously the JSON-RPC version was ignored, now JSON-RPC 2.0 requests follow the specification by:\r\n\r\n- Returning HTTP \"204 No Content\" responses to JSON-RPC 2.0 notifications instead of full responses.\r\n- Returning HTTP \"200 OK\" responses in all other cases, rather than 404 responses for unknown methods, 500 responses for invalid parameters, etc.\r\n- Returning either \"result\" fields or \"error\" fields in JSON-RPC responses, rather than returning both fields with one field set to null.\"",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-18T14:11:59Z",
      "diff_hunk" : "@@ -0,0 +1,41 @@\n+JSON-RPC\n+--------\n+\n+The JSON-RPC server will behave and respond to JSON-RPC 2.0 requests with\n+strict adherence to the specification (https://www.jsonrpc.org/specification).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1430194117",
      "id" : 1430194117,
      "line" : 5,
      "node_id" : "PRRC_kwDOABII585VPwfF",
      "original_commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "original_line" : 5,
      "original_position" : 5,
      "original_start_line" : 4,
      "path" : "doc/release-notes-27101.md",
      "position" : 5,
      "pull_request_review_id" : 1782332723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430194117/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 4,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-12-18T15:14:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430194117",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1430211775"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430211775"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"doc: add comments and release-notes for JSON-RPC 2.0\" (5d5e8cbca785db851747c5143dc1d651a1ea11e6)\r\n\r\nReview note: The only thing actually changing here is the number 1 to the number 2. The new quotes and line breaks have no affect on the program.",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-18T14:27:06Z",
      "diff_hunk" : "@@ -160,8 +160,9 @@ std::string HelpExampleCliNamed(const std::string& methodname, const RPCArgList&\n \n std::string HelpExampleRpc(const std::string& methodname, const std::string& args)\n {\n-    return \"> curl --user myusername --data-binary '{\\\"jsonrpc\\\": \\\"1.0\\\", \\\"id\\\": \\\"curltest\\\", \"\n-        \"\\\"method\\\": \\\"\" + methodname + \"\\\", \\\"params\\\": [\" + args + \"]}' -H 'content-type: text/plain;' http://127.0.0.1:8332/\\n\";\n+    return \"> curl --user myusername --data-binary \"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1430211775",
      "id" : 1430211775,
      "line" : 163,
      "node_id" : "PRRC_kwDOABII585VP0y_",
      "original_commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "original_line" : 163,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/rpc/util.cpp",
      "position" : 6,
      "pull_request_review_id" : 1782332723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430211775/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-18T15:10:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430211775",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1430214176"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430214176"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"doc: add comments and release-notes for JSON-RPC 2.0\" (5d5e8cbca785db851747c5143dc1d651a1ea11e6)\r\n\r\nMaybe say \"invalidly formatted\" rather than just \"invalid\" because otherwise it's not obvious what types of requests would or wouldn't cause http errors.\r\n",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-18T14:29:07Z",
      "diff_hunk" : "@@ -26,6 +26,14 @@\n  *\n  * 1.0 spec: http://json-rpc.org/wiki/specification\n  * 1.2 spec: http://jsonrpc.org/historical/json-rpc-over-http.html\n+ *\n+ * If the server receives a request with the JSON-RPC 2.0 marker `{\"jsonrpc\": \"2.0\"}`\n+ * then Bitcoin will respond with a strictly specified response, and without\n+ * HTTP errors (unless there actually is a server error or invalid request).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1430214176",
      "id" : 1430214176,
      "line" : 32,
      "node_id" : "PRRC_kwDOABII585VP1Yg",
      "original_commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "original_line" : 32,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/rpc/request.cpp",
      "position" : 7,
      "pull_request_review_id" : 1782332723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430214176/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-18T15:10:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430214176",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1430220897"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430220897"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"doc: add comments and release-notes for JSON-RPC 2.0\" (5d5e8cbca785db851747c5143dc1d651a1ea11e6)\r\n\r\nInstead of including these examples here where it's less they will be seen after next release, would suggest adding a JSON-RPC 2.0 section to the https://github.com/bitcoin/bitcoin/blob/master/doc/JSON-RPC-interface.md doc and incorporating these examples in that documentation",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-18T14:34:34Z",
      "diff_hunk" : "@@ -0,0 +1,41 @@\n+JSON-RPC\n+--------\n+\n+The JSON-RPC server will behave and respond to JSON-RPC 2.0 requests with\n+strict adherence to the specification (https://www.jsonrpc.org/specification).\n+\n+Examples including HTTP response codes:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1430220897",
      "id" : 1430220897,
      "line" : 7,
      "node_id" : "PRRC_kwDOABII585VP3Bh",
      "original_commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "original_line" : 7,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "doc/release-notes-27101.md",
      "position" : 7,
      "pull_request_review_id" : 1782332723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430220897/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-18T15:10:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430220897",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1430222681"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430222681"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"rpc: identify JSON-RPC 2.0 requests\" (8c619f70ba0021265041493b25a98f77afa96c55)\r\n\r\nI might have missed it, but I don't think I noticed a test case for this condition. Could consider adding one",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-18T14:36:06Z",
      "diff_hunk" : "@@ -188,4 +188,16 @@ void JSONRPCRequest::parse(const UniValue& valRequest)\n         params = UniValue(UniValue::VARR);\n     else\n         throw JSONRPCError(RPC_INVALID_REQUEST, \"Params must be an array or object\");\n+\n+    // Default\n+    m_json_version = JSONVersion::JSON_1_BTC;\n+\n+    // Check for JSON-RPC 2.0\n+    const UniValue& valJsonRPC = request.find_value(\"jsonrpc\");\n+    if (!valJsonRPC.isNull()) {\n+        if (!valJsonRPC.isStr())\n+            throw JSONRPCError(RPC_INVALID_REQUEST, \"jsonrpc field must be a string\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1430222681",
      "id" : 1430222681,
      "line" : 217,
      "node_id" : "PRRC_kwDOABII585VP3dZ",
      "original_commit_id" : "8c619f70ba0021265041493b25a98f77afa96c55",
      "original_line" : 199,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/rpc/request.cpp",
      "position" : 67,
      "pull_request_review_id" : 1782332723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430222681/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-18T15:10:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430222681",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1430288696"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430288696"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yea, I think that's better, as we don't really want to copy-paste these big blocks of curl output into the middle of our release notes.",
      "commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "created_at" : "2023-12-18T15:13:56Z",
      "diff_hunk" : "@@ -0,0 +1,41 @@\n+JSON-RPC\n+--------\n+\n+The JSON-RPC server will behave and respond to JSON-RPC 2.0 requests with\n+strict adherence to the specification (https://www.jsonrpc.org/specification).\n+\n+Examples including HTTP response codes:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1430288696",
      "id" : 1430288696,
      "in_reply_to_id" : 1430220897,
      "line" : 7,
      "node_id" : "PRRC_kwDOABII585VQHk4",
      "original_commit_id" : "5d5e8cbca785db851747c5143dc1d651a1ea11e6",
      "original_line" : 7,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "doc/release-notes-27101.md",
      "position" : 7,
      "pull_request_review_id" : 1787134656,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430288696/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-18T15:15:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1430288696",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks @ryanofsky for the thorough review. I was misunderstanding the different roles of `httprpc` and `server` and I think tiptoeing around minimal commits when more changes were needed to really clean everything up.\r\n\r\n`JSONRPCExec`: the only function now that executes calls, batches are just handled in `HTTPReq_JSONRPC` as you suggested.\r\n\r\nTests: additional coverage is now the first commit, and new tests are in the last commits. I replaced the helper functions in interface_rpc.py to provide lower level control over the requests and responses than provided by the authproxy module which I was trying to hack in previous versions of this branch. In a future PR we can update authproxy to use jsonrpc 2.0 without having to change this (or I think, any) existing test\r\n\r\nDocs: I moved the more verbose explanation to JSON-RPC-interface.md as suggested by you and @fanquake and cut down the release note to a brief summary.\r\n\r\nPR description: updated for the code changes.",
      "created_at" : "2024-01-02T16:13:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1874230644",
      "id" : 1874230644,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27101",
      "node_id" : "IC_kwDOABII585vtn10",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1874230644/reactions"
      },
      "updated_at" : "2024-01-02T16:13:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1874230644",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1446812606"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446812606"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"rpc: refactor single/batch requests\" (27afe01560b1d930c3b072a180cab95c857eff24)\r\n\r\nThis ret variable seems unnecessary. Can this just say `reply = UniValue{UniValue::VARR}` and use the `reply` variable instead of `ret` below?\r\n\r\nThe name is also confusing because `ret` normally refers to a return value, which this is not what this is.",
      "commit_id" : "756da6d1e67fba65a992dc0090ee8c0cfa26abe3",
      "created_at" : "2024-01-10T02:22:11Z",
      "diff_hunk" : "@@ -223,13 +222,27 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n                     }\n                 }\n             }\n-            strReply = JSONRPCExecBatch(jreq, valRequest.get_array());\n+\n+            // Execute each request\n+            UniValue ret(UniValue::VARR);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1446812606",
      "id" : 1446812606,
      "line" : 235,
      "node_id" : "PRRC_kwDOABII585WPJu-",
      "original_commit_id" : "27afe01560b1d930c3b072a180cab95c857eff24",
      "original_line" : 227,
      "original_position" : 32,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : 59,
      "pull_request_review_id" : 1812307340,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446812606/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-10T03:47:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446812606",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1446816704"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446816704"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"rpc: refactor single/batch requests\" (27afe01560b1d930c3b072a180cab95c857eff24)\r\n\r\nNot new behavior but the result object, which is potentially large, is copied for no reason here. It would be nice in a separate commit to change `JSONRPCReplyObj` to accept a plain `UniValue` parameter instead of `const UniValue&` so `std::move(result)` could be passed here, and the result wouldn't be copied unnecessarily.",
      "commit_id" : "756da6d1e67fba65a992dc0090ee8c0cfa26abe3",
      "created_at" : "2024-01-10T02:30:48Z",
      "diff_hunk" : "@@ -358,36 +358,13 @@ bool IsDeprecatedRPCEnabled(const std::string& method)\n     return find(enabled_methods.begin(), enabled_methods.end(), method) != enabled_methods.end();\n }\n \n-static UniValue JSONRPCExecOne(JSONRPCRequest jreq, const UniValue& req)\n+UniValue JSONRPCExec(const JSONRPCRequest& jreq)\n {\n-    UniValue rpc_result(UniValue::VOBJ);\n+    // Might throw exception. Single requests will throw and send HTTP error codes\n+    // but inside a batch, we just include the error object and return HTTP 200\n+    UniValue result = tableRPC.execute(jreq);\n \n-    try {\n-        jreq.parse(req);\n-\n-        UniValue result = tableRPC.execute(jreq);\n-        rpc_result = JSONRPCReplyObj(result, NullUniValue, jreq.id);\n-    }\n-    catch (const UniValue& objError)\n-    {\n-        rpc_result = JSONRPCReplyObj(NullUniValue, objError, jreq.id);\n-    }\n-    catch (const std::exception& e)\n-    {\n-        rpc_result = JSONRPCReplyObj(NullUniValue,\n-                                     JSONRPCError(RPC_PARSE_ERROR, e.what()), jreq.id);\n-    }\n-\n-    return rpc_result;\n-}\n-\n-std::string JSONRPCExecBatch(const JSONRPCRequest& jreq, const UniValue& vReq)\n-{\n-    UniValue ret(UniValue::VARR);\n-    for (unsigned int reqIdx = 0; reqIdx < vReq.size(); reqIdx++)\n-        ret.push_back(JSONRPCExecOne(jreq, vReq[reqIdx]));\n-\n-    return ret.write() + \"\\n\";\n+    return JSONRPCReplyObj(result, NullUniValue, jreq.id);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1446816704",
      "id" : 1446816704,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585WPKvA",
      "original_commit_id" : "27afe01560b1d930c3b072a180cab95c857eff24",
      "original_line" : 367,
      "original_position" : 38,
      "original_start_line" : null,
      "path" : "src/rpc/server.cpp",
      "position" : null,
      "pull_request_review_id" : 1812307340,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446816704/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-10T03:47:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446816704",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1446841611"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446841611"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"rpc: identify JSON-RPC 2.0 requests\" (9e1c6fa84eef606d5504ebcbbd2a2ca7a4f748dc)\r\n\r\nThe spec says this field 'MUST be exactly \"2.0\"' (https://www.jsonrpc.org/specification#request_object), so maybe it should be an error if the field is set and contains any other value. This way if there is ever a JSON-RPC 2.1 or 3.0 protocol, clients can easily check for support without getting back a strange JSON 1.1 response. FWIW, chatgpt suggestd the following response:\r\n\r\n```json\r\n{\r\n    \"jsonrpc\": \"2.0\",\r\n    \"error\": {\r\n        \"code\": -32600,\r\n        \"message\": \"Invalid Request\",\r\n        \"data\": \"JSON-RPC version not supported.\"\r\n    },\r\n    \"id\": null\r\n}\r\n```\r\n\r\nAnd setting the id field to the actual request ID if possible to determine",
      "commit_id" : "756da6d1e67fba65a992dc0090ee8c0cfa26abe3",
      "created_at" : "2024-01-10T03:27:17Z",
      "diff_hunk" : "@@ -173,6 +173,18 @@ void JSONRPCRequest::parse(const UniValue& valRequest)\n     // Parse id now so errors from here on will have the id\n     id = request.find_value(\"id\");\n \n+    // Check for JSON-RPC 2.0 (default 1.1)\n+    m_json_version = JSONVersion::JSON_1_BTC;\n+    const UniValue& valJsonRPC = request.find_value(\"jsonrpc\");\n+    if (!valJsonRPC.isNull()) {\n+        if (!valJsonRPC.isStr()) {\n+            throw JSONRPCError(RPC_INVALID_REQUEST, \"jsonrpc field must be a string\");\n+        }\n+        if (valJsonRPC.get_str() == \"2.0\") {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1446841611",
      "id" : 1446841611,
      "line" : 201,
      "node_id" : "PRRC_kwDOABII585WPQ0L",
      "original_commit_id" : "9e1c6fa84eef606d5504ebcbbd2a2ca7a4f748dc",
      "original_line" : 183,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/rpc/request.cpp",
      "position" : 65,
      "pull_request_review_id" : 1812307340,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446841611/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-10T03:47:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446841611",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1446844876"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446844876"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"rpc: make error and result mutually exclusive in JSON-RPC 2.0 replies\" (c9196a2e5b747753e0d5ee59e1bcb987943eedbf)\r\n\r\nI think these two lines should be switched to always return the result field before the error field. This would make responses look more consistent and avoid changing previous behavior.",
      "commit_id" : "756da6d1e67fba65a992dc0090ee8c0cfa26abe3",
      "created_at" : "2024-01-10T03:35:31Z",
      "diff_hunk" : "@@ -37,21 +37,28 @@ UniValue JSONRPCRequestObj(const std::string& strMethod, const UniValue& params,\n     return request;\n }\n \n-UniValue JSONRPCReplyObj(const UniValue& result, const UniValue& error, const UniValue& id)\n+UniValue JSONRPCReplyObj(const UniValue& result, const UniValue& error, const UniValue& id, JSONVersion json_version)\n {\n     UniValue reply(UniValue::VOBJ);\n-    if (!error.isNull())\n-        reply.pushKV(\"result\", NullUniValue);\n-    else\n+    // Add JSON-RPC version number field in v2 only.\n+    if (json_version == JSONVersion::JSON_2_0) reply.pushKV(\"jsonrpc\", \"2.0\");\n+\n+    // Add both result and error fields in v1, even though one will be null.\n+    // Omit the null field in v2.\n+    if (error.isNull()) {\n         reply.pushKV(\"result\", result);\n-    reply.pushKV(\"error\", error);\n+        if (json_version == JSONVersion::JSON_1_BTC) reply.pushKV(\"error\", NullUniValue);\n+    } else {\n+        reply.pushKV(\"error\", error);\n+        if (json_version == JSONVersion::JSON_1_BTC) reply.pushKV(\"result\", NullUniValue);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1446844876",
      "id" : 1446844876,
      "line" : 64,
      "node_id" : "PRRC_kwDOABII585WPRnM",
      "original_commit_id" : "c9196a2e5b747753e0d5ee59e1bcb987943eedbf",
      "original_line" : 53,
      "original_position" : 22,
      "original_start_line" : 52,
      "path" : "src/rpc/request.cpp",
      "position" : 40,
      "pull_request_review_id" : 1812307340,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446844876/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 63,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-01-10T03:47:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446844876",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1446847073"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446847073"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"rpc: make error and result mutually exclusive in JSON-RPC 2.0 replies\" (c9196a2e5b747753e0d5ee59e1bcb987943eedbf)\r\n\r\nAgain suggestion for an separate earlier commit, but it would be good if JSONRPCReplyObj took a `UniValue error` parameter instead of `const UniValue& error` so the error object could be moved instead of copied.",
      "commit_id" : "756da6d1e67fba65a992dc0090ee8c0cfa26abe3",
      "created_at" : "2024-01-10T03:41:16Z",
      "diff_hunk" : "@@ -360,11 +360,24 @@ bool IsDeprecatedRPCEnabled(const std::string& method)\n \n UniValue JSONRPCExec(const JSONRPCRequest& jreq)\n {\n-    // Might throw exception. Single requests will throw and send HTTP error codes\n-    // but inside a batch, we just include the error object and return HTTP 200\n-    UniValue result = tableRPC.execute(jreq);\n+    UniValue result;\n+    if (jreq.m_json_version == JSONVersion::JSON_2_0) {\n+        // JSONRPC 2.0 behavior: only throw HTTP error if the server is actually\n+        // broken. Otherwise errors are sent back in \"HTTP OK\" responses.\n+        try {\n+            result = tableRPC.execute(jreq);\n+        } catch (const UniValue& objError) {\n+            return JSONRPCReplyObj(NullUniValue, objError, jreq.id, jreq.m_json_version);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1446847073",
      "id" : 1446847073,
      "line" : 370,
      "node_id" : "PRRC_kwDOABII585WPSJh",
      "original_commit_id" : "c9196a2e5b747753e0d5ee59e1bcb987943eedbf",
      "original_line" : 370,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/rpc/server.cpp",
      "position" : 31,
      "pull_request_review_id" : 1812307340,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446847073/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-10T03:47:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446847073",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1446851259"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446851259"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"rpc: JSON-RPC 2.0 should not respond to \"notifications\"\" (bc2d55898b315d1ee80a70377d65f79c829246ed)\r\n\r\nWould be good to `std::move(response)` here to avoid a copy",
      "commit_id" : "756da6d1e67fba65a992dc0090ee8c0cfa26abe3",
      "created_at" : "2024-01-10T03:44:21Z",
      "diff_hunk" : "@@ -230,15 +235,17 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n             UniValue ret(UniValue::VARR);\n             for (unsigned int reqIdx = 0; reqIdx < valRequest.size(); reqIdx++) {\n                 // Batches never throw HTTP errors, they are always just included\n-                // in \"HTTP OK\" responses.\n+                // in \"HTTP OK\" responses. Notifications never get any response.\n+                UniValue response;\n                 try {\n                     jreq.parse(valRequest[reqIdx]);\n-                    ret.push_back(JSONRPCExec(jreq));\n+                    response = JSONRPCExec(jreq);\n                 } catch (const UniValue& objError) {\n-                    ret.push_back(JSONRPCReplyObj(NullUniValue, objError, jreq.id, jreq.m_json_version));\n+                    response = JSONRPCReplyObj(NullUniValue, objError, jreq.id, jreq.m_json_version);\n                 } catch (const std::exception& e) {\n-                    ret.push_back(JSONRPCReplyObj(NullUniValue, JSONRPCError(RPC_PARSE_ERROR, e.what()), jreq.id, jreq.m_json_version));\n+                    response = JSONRPCReplyObj(NullUniValue, JSONRPCError(RPC_PARSE_ERROR, e.what()), jreq.id, jreq.m_json_version);\n                 }\n+                if (!jreq.IsNotification()) ret.push_back(response);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1446851259",
      "id" : 1446851259,
      "line" : 248,
      "node_id" : "PRRC_kwDOABII585WPTK7",
      "original_commit_id" : "bc2d55898b315d1ee80a70377d65f79c829246ed",
      "original_line" : 248,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : 72,
      "pull_request_review_id" : 1812307340,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446851259/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-10T03:47:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446851259",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1447586115"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447586115"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"test: cover JSONRPC 2.0 requests, batches, and notifications\" (d61e469179dae4e94fd00f47c2eeb8533d19e13c)\r\n\r\nIt's not great to make this a static method and use a global variable, because now tests are no longer independent of each other and can potentially interfere with each other. Also using deep copy is unnecessary here because only the top level dictionary is modified. Also the name of the class \"Format\" is not very descriptive. Would suggest cleaning all this up:\r\n\r\n```diff\r\n--- a/test/functional/interface_rpc.py\r\n+++ b/test/functional/interface_rpc.py\r\n@@ -6,7 +6,6 @@\r\n \r\n import json\r\n import os\r\n-from copy import deepcopy\r\n from test_framework.test_framework import BitcoinTestFramework\r\n from test_framework.util import assert_equal, assert_greater_than_or_equal\r\n from threading import Thread\r\n@@ -19,19 +18,19 @@ RPC_INVALID_REQUEST        = -32600\r\n RPC_PARSE_ERROR            = -32700\r\n \r\n \r\n-class Format:\r\n-    ID_COUNT = 0\r\n+class RequestBuilder:\r\n+    def __init__(self):\r\n+        self.id_count = 0\r\n \r\n-    @staticmethod\r\n-    def rpc_request(body, version=1, notification=False):\r\n-        req = deepcopy(body)\r\n+    def rpc_request(self, fields, version=1, notification=False):\r\n+        req = dict(**fields)\r\n         if version == 1:\r\n             req[\"version\"] = \"1.1\"\r\n         if version == 2:\r\n             req[\"jsonrpc\"] = \"2.0\"\r\n         if not notification:\r\n-            req[\"id\"] = Format.ID_COUNT\r\n-            Format.ID_COUNT += 1\r\n+            req[\"id\"] = self.id_count\r\n+            self.id_count += 1\r\n         return req\r\n \r\n \r\n@@ -45,7 +44,7 @@ def send_json_rpc(node, body: object) -> tuple[object, int]:\r\n \r\n \r\n def expect_http_rpc_status(expected_http_status, expected_rpc_error_code, node, method, params=None, version=1, notification=False):\r\n-    req = Format.rpc_request({\"method\": method, \"params\": params}, version, notification)\r\n+    req = RequestBuilder().rpc_request({\"method\": method, \"params\": params}, version, notification)\r\n     response, status = send_json_rpc(node, req)\r\n \r\n     if expected_rpc_error_code is not None:\r\n@@ -91,11 +90,12 @@ class RPCInterfaceTest(BitcoinTestFramework):\r\n             # Invalid request format\r\n             {\"pizza\": \"sausage\"}\r\n         ]\r\n+        builder = RequestBuilder()\r\n \r\n         self.log.info(\"Testing basic JSON-RPC 1.1 batch request...\")\r\n         body = []\r\n         for cmd in commands:\r\n-            body.append(Format.rpc_request(cmd))\r\n+            body.append(builder.rpc_request(cmd))\r\n         response, status = send_json_rpc(self.nodes[0], body)\r\n         assert_equal(status, 200)\r\n         # JSON 1.1: Every response has a \"result\" and an \"error\"\r\n@@ -112,7 +112,7 @@ class RPCInterfaceTest(BitcoinTestFramework):\r\n         self.log.info(\"Testing basic JSON-RPC 2.0 batch request...\")\r\n         body = []\r\n         for cmd in commands:\r\n-            body.append(Format.rpc_request(cmd, version=2))\r\n+            body.append(builder.rpc_request(cmd, version=2))\r\n         response, status = send_json_rpc(self.nodes[0], body)\r\n         assert_equal(status, 200)\r\n         # JSON 2.0: Each response has either a \"result\" or an \"error\"\r\n@@ -130,7 +130,7 @@ class RPCInterfaceTest(BitcoinTestFramework):\r\n         body = []\r\n         version = 1\r\n         for cmd in commands:\r\n-            body.append(Format.rpc_request(cmd, version=version))\r\n+            body.append(builder.rpc_request(cmd, version=version))\r\n             version = 2 if version == 1 else 1\r\n         response, status = send_json_rpc(self.nodes[0], body)\r\n         assert_equal(status, 200)\r\n@@ -149,7 +149,7 @@ class RPCInterfaceTest(BitcoinTestFramework):\r\n         body = []\r\n         notification = False\r\n         for cmd in commands:\r\n-            body.append(Format.rpc_request(cmd, version=2, notification=notification))\r\n+            body.append(builder.rpc_request(cmd, version=2, notification=notification))\r\n             notification = True\r\n         response, status = send_json_rpc(self.nodes[0], body)\r\n         assert_equal(status, 200)\r\n\r\n```",
      "commit_id" : "756da6d1e67fba65a992dc0090ee8c0cfa26abe3",
      "created_at" : "2024-01-10T15:56:56Z",
      "diff_hunk" : "@@ -6,26 +6,32 @@\n \n import json\n import os\n+from copy import deepcopy\n from test_framework.test_framework import BitcoinTestFramework\n from test_framework.util import assert_equal, assert_greater_than_or_equal\n from threading import Thread\n import subprocess\n \n-RPC_INVALID_PARAMETER = -8\n-RPC_METHOD_NOT_FOUND  = -32601\n-RPC_INVALID_REQUEST   = -32600\n-RPC_PARSE_ERROR       = -32700\n+RPC_INVALID_ADDRESS_OR_KEY = -5\n+RPC_INVALID_PARAMETER      = -8\n+RPC_METHOD_NOT_FOUND       = -32601\n+RPC_INVALID_REQUEST        = -32600\n+RPC_PARSE_ERROR            = -32700\n \n \n class Format:\n     ID_COUNT = 0\n \n     @staticmethod\n-    def rpc_request(body):\n-        req = body\n-        req[\"version\"] = \"1.1\"\n-        req[\"id\"] = Format.ID_COUNT\n-        Format.ID_COUNT += 1\n+    def rpc_request(body, version=1, notification=False):\n+        req = deepcopy(body)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1447586115",
      "id" : 1447586115,
      "line" : 27,
      "node_id" : "PRRC_kwDOABII585WSGlD",
      "original_commit_id" : "d61e469179dae4e94fd00f47c2eeb8533d19e13c",
      "original_line" : 27,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "test/functional/interface_rpc.py",
      "position" : 33,
      "pull_request_review_id" : 1813562575,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447586115/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-10T17:19:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447586115",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1447616571"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447616571"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"test: cover more HTTP error codes in interface_rpc.py\" (29ebb0d7774ee2d10aa274086e8ff4b2395f7047)\r\n\r\nSetting params to None seems like a bug because it means a `\"params\": null` JSON field will be sent, when previously authproxy would send an empty params object. Would suggest changing this to `params={}` to avoid a change in behavior.\r\n\r\nAlso, I'm not sure if it is a bug for our server to accept null params. The spec says \"If present, parameters for the rpc call MUST be provided as a Structured value\" and \"params MUST be an Array\" or \"params MUST be an Object\", so it seems like null is not supposed to be allowed, and probably should trigger a server error.",
      "commit_id" : "756da6d1e67fba65a992dc0090ee8c0cfa26abe3",
      "created_at" : "2024-01-10T16:20:12Z",
      "diff_hunk" : "@@ -4,22 +4,48 @@\n # file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \"\"\"Tests some generic aspects of the RPC interface.\"\"\"\n \n+import json\n import os\n-from test_framework.authproxy import JSONRPCException\n from test_framework.test_framework import BitcoinTestFramework\n from test_framework.util import assert_equal, assert_greater_than_or_equal\n from threading import Thread\n import subprocess\n \n+RPC_INVALID_PARAMETER = -8\n+RPC_METHOD_NOT_FOUND  = -32601\n+RPC_INVALID_REQUEST   = -32600\n+RPC_PARSE_ERROR       = -32700\n \n-def expect_http_status(expected_http_status, expected_rpc_code,\n-                       fcn, *args):\n-    try:\n-        fcn(*args)\n-        raise AssertionError(f\"Expected RPC error {expected_rpc_code}, got none\")\n-    except JSONRPCException as exc:\n-        assert_equal(exc.error[\"code\"], expected_rpc_code)\n-        assert_equal(exc.http_status, expected_http_status)\n+\n+class Format:\n+    ID_COUNT = 0\n+\n+    @staticmethod\n+    def rpc_request(body):\n+        req = body\n+        req[\"version\"] = \"1.1\"\n+        req[\"id\"] = Format.ID_COUNT\n+        Format.ID_COUNT += 1\n+        return req\n+\n+\n+def send_raw_rpc(node, raw_body: bytes) -> tuple[object, int]:\n+    return node._request(\"POST\", \"/\", raw_body)\n+\n+\n+def send_json_rpc(node, body: object) -> tuple[object, int]:\n+    raw = json.dumps(body).encode(\"utf-8\")\n+    return send_raw_rpc(node, raw)\n+\n+\n+def expect_http_rpc_status(expected_http_status, expected_rpc_error_code, node, method, params=None):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1447616571",
      "id" : 1447616571,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585WSOA7",
      "original_commit_id" : "29ebb0d7774ee2d10aa274086e8ff4b2395f7047",
      "original_line" : 41,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "test/functional/interface_rpc.py",
      "position" : null,
      "pull_request_review_id" : 1813562575,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447616571/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-10T17:19:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447616571",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1447645890"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447645890"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"doc: add comments and release-notes for JSON-RPC 2.0\" (756da6d1e67fba65a992dc0090ee8c0cfa26abe3)\r\n\r\nWould drop \"Protocols can be mixed in a batch request.\" It seems ok, but not a good thing to encourage, and unless it's required by the specs, I don't think we should commit to this behavior by adding it to our documentation.",
      "commit_id" : "756da6d1e67fba65a992dc0090ee8c0cfa26abe3",
      "created_at" : "2024-01-10T16:42:20Z",
      "diff_hunk" : "@@ -74,6 +74,21 @@ major version via the `-deprecatedrpc=` command line option. The release notes\n of a new major release come with detailed instructions on what RPC features\n were deprecated and how to re-enable them temporarily.\n \n+## JSON-RPC 1.1 vs 2.0\n+\n+The server recognizes [JSON-RPC v2.0](https://www.jsonrpc.org/specification) requests\n+and responds accordingly. A 2.0 request is identified by the presence of\n+`\"jsonrpc\": \"2.0\"` in the request body. If that key + value is not present in a request,\n+the legacy JSON-RPC v1.1 protocol is followed instead, which was the only available\n+protocol in previous releases. Protocols can be mixed in a batch request.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1447645890",
      "id" : 1447645890,
      "line" : 83,
      "node_id" : "PRRC_kwDOABII585WSVLC",
      "original_commit_id" : "756da6d1e67fba65a992dc0090ee8c0cfa26abe3",
      "original_line" : 83,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "doc/JSON-RPC-interface.md",
      "position" : 10,
      "pull_request_review_id" : 1813562575,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447645890/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-10T17:19:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447645890",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1447648863"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447648863"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"doc: add comments and release-notes for JSON-RPC 2.0\" (756da6d1e67fba65a992dc0090ee8c0cfa26abe3)\r\n\r\nThink this should also mention that responses contain \"jsonrpc\": \"2.0\" field. Or this could be an additional row in the table.",
      "commit_id" : "756da6d1e67fba65a992dc0090ee8c0cfa26abe3",
      "created_at" : "2024-01-10T16:44:48Z",
      "diff_hunk" : "@@ -74,6 +74,21 @@ major version via the `-deprecatedrpc=` command line option. The release notes\n of a new major release come with detailed instructions on what RPC features\n were deprecated and how to re-enable them temporarily.\n \n+## JSON-RPC 1.1 vs 2.0\n+\n+The server recognizes [JSON-RPC v2.0](https://www.jsonrpc.org/specification) requests\n+and responds accordingly. A 2.0 request is identified by the presence of\n+`\"jsonrpc\": \"2.0\"` in the request body. If that key + value is not present in a request,\n+the legacy JSON-RPC v1.1 protocol is followed instead, which was the only available\n+protocol in previous releases. Protocols can be mixed in a batch request.\n+\n+|| 1.1 | 2.0 |\n+|-|-|-|\n+| Request marker | `\"version\": \"1.1\"` (or none) | `\"jsonrpc\": \"2.0\"` |\n+| `\"error\"` and `\"result\"` fields in response | both present | only one is present |",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1447648863",
      "id" : 1447648863,
      "line" : 88,
      "node_id" : "PRRC_kwDOABII585WSV5f",
      "original_commit_id" : "756da6d1e67fba65a992dc0090ee8c0cfa26abe3",
      "original_line" : 88,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "doc/JSON-RPC-interface.md",
      "position" : 15,
      "pull_request_review_id" : 1813562575,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447648863/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-10T17:19:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447648863",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1447662808"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447662808"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"rpc: JSON-RPC 2.0 should not respond to \"notifications\"\" (bc2d55898b315d1ee80a70377d65f79c829246ed)\r\n\r\nThis does not seem correct. According to https://www.jsonrpc.org/specification#notification a notification is a 'Request object without an \"id\" member', not a request object with a `null` id member. It also explicitly says requests that have \"Null as a value for the id member\" are treated as \"Responses with an unknown id\" not notifications.\r\n\r\nProbably a reasonable way to fix this would be to change the `JSONRPCRequest::id` type from `UniValue` to `std::optional<UniValue>` to distinction between a null id and a missing id.",
      "commit_id" : "756da6d1e67fba65a992dc0090ee8c0cfa26abe3",
      "created_at" : "2024-01-10T16:56:21Z",
      "diff_hunk" : "@@ -45,6 +45,7 @@ class JSONRPCRequest\n     JSONVersion m_json_version = JSONVersion::JSON_1_BTC;\n \n     void parse(const UniValue& valRequest);\n+    [[nodiscard]] bool IsNotification() const { return id.isNull() && m_json_version == JSONVersion::JSON_2_0; };",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1447662808",
      "id" : 1447662808,
      "line" : 48,
      "node_id" : "PRRC_kwDOABII585WSZTY",
      "original_commit_id" : "bc2d55898b315d1ee80a70377d65f79c829246ed",
      "original_line" : 48,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/rpc/request.h",
      "position" : 25,
      "pull_request_review_id" : 1813562575,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447662808/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-10T17:19:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447662808",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1447679340"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447679340"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"doc: add comments and release-notes for JSON-RPC 2.0\" (756da6d1e67fba65a992dc0090ee8c0cfa26abe3)\r\n\r\nMaybe replace \"errors like if...\" with \"errors in cases like the endpoint not being found (404) or the RPC request not being formatted correctly (500).\" Grammar sounds a little off the way it is written now.",
      "commit_id" : "756da6d1e67fba65a992dc0090ee8c0cfa26abe3",
      "created_at" : "2024-01-10T17:09:22Z",
      "diff_hunk" : "@@ -26,6 +26,17 @@\n  *\n  * 1.0 spec: http://json-rpc.org/wiki/specification\n  * 1.2 spec: http://jsonrpc.org/historical/json-rpc-over-http.html\n+ *\n+ * If the server receives a request with the JSON-RPC 2.0 marker `{\"jsonrpc\": \"2.0\"}`\n+ * then Bitcoin will respond with a strictly specified response.\n+ * It will only return an HTTP error code in response to HTTP errors like if",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1447679340",
      "id" : 1447679340,
      "line" : 32,
      "node_id" : "PRRC_kwDOABII585WSdVs",
      "original_commit_id" : "756da6d1e67fba65a992dc0090ee8c0cfa26abe3",
      "original_line" : 32,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/rpc/request.cpp",
      "position" : 7,
      "pull_request_review_id" : 1813562575,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447679340/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-10T17:19:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447679340",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1447684268"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447684268"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"test: handle 204 NO_CONTENT correctly in authproxy\" (174a995edf594dccf745d2593c281d3e4a1ff7f7)\r\n\r\nIt would be good to have a comment that explains why this block of code is needed, because it seems like an impossible case to hit through normal usage of authproxy. Maybe: \"# Check for no-content HTTP status code, which can be returned when an RPC client requests a JSON-RPC 2.0 \"notification\" with no response. Currently this is only possible if clients call the _request() method directly to send a raw request.\"",
      "commit_id" : "756da6d1e67fba65a992dc0090ee8c0cfa26abe3",
      "created_at" : "2024-01-10T17:13:49Z",
      "diff_hunk" : "@@ -160,6 +160,11 @@ def _get_response(self):\n             raise JSONRPCException({\n                 'code': -342, 'message': 'missing HTTP response from server'})\n \n+        if http_response.status == HTTPStatus.NO_CONTENT:\n+            if len(http_response.read()) != 0:\n+                raise JSONRPCException({'code': -342, 'message': 'Content received with NO CONTENT status code'})\n+            return None, http_response.status\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1447684268",
      "id" : 1447684268,
      "line" : 167,
      "node_id" : "PRRC_kwDOABII585WSeis",
      "original_commit_id" : "174a995edf594dccf745d2593c281d3e4a1ff7f7",
      "original_line" : 167,
      "original_position" : 8,
      "original_start_line" : 163,
      "path" : "test/functional/test_framework/authproxy.py",
      "position" : 8,
      "pull_request_review_id" : 1813562575,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447684268/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 163,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-01-10T17:19:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447684268",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1462248344"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1462248344"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I actually had this as `params=[]` a few updates ago but that fails lint (see below) but I'll clean it up with a different work-around:\r\n\r\n```\r\nA mutable list or dict seems to be used as default parameter value:\r\n\r\ntest/functional/interface_rpc.py:41:def expect_http_rpc_status(expected_http_status, expected_rpc_error_code, node, method, params={}):\r\n\r\nThis is how mutable list and dict default parameter values behave:\r\n\r\n>>> def f(i, j=[], k={}):\r\n...     j.append(i)\r\n...     k[i] = True\r\n...     return j, k\r\n...\r\n>>> f(1)\r\n([1], {1: True})\r\n>>> f(1)\r\n([1, 1], {1: True})\r\n>>> f(2)\r\n([1, 1, 2], {1: True, 2: True})\r\n\r\nThe intended behaviour was likely:\r\n\r\n>>> def f(i, j=None, k=None):\r\n...     if j is None:\r\n...         j = []\r\n...     if k is None:\r\n...         k = {}\r\n...     j.append(i)\r\n...     k[i] = True\r\n...     return j, k\r\n...\r\n>>> f(1)\r\n([1], {1: True})\r\n>>> f(1)\r\n([1], {1: True})\r\n>>> f(2)\r\n([2], {2: True})\r\n^---- failure generated from lint-python-mutable-default-parameters.py\r\n```",
      "commit_id" : "756da6d1e67fba65a992dc0090ee8c0cfa26abe3",
      "created_at" : "2024-01-22T18:27:44Z",
      "diff_hunk" : "@@ -4,22 +4,48 @@\n # file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \"\"\"Tests some generic aspects of the RPC interface.\"\"\"\n \n+import json\n import os\n-from test_framework.authproxy import JSONRPCException\n from test_framework.test_framework import BitcoinTestFramework\n from test_framework.util import assert_equal, assert_greater_than_or_equal\n from threading import Thread\n import subprocess\n \n+RPC_INVALID_PARAMETER = -8\n+RPC_METHOD_NOT_FOUND  = -32601\n+RPC_INVALID_REQUEST   = -32600\n+RPC_PARSE_ERROR       = -32700\n \n-def expect_http_status(expected_http_status, expected_rpc_code,\n-                       fcn, *args):\n-    try:\n-        fcn(*args)\n-        raise AssertionError(f\"Expected RPC error {expected_rpc_code}, got none\")\n-    except JSONRPCException as exc:\n-        assert_equal(exc.error[\"code\"], expected_rpc_code)\n-        assert_equal(exc.http_status, expected_http_status)\n+\n+class Format:\n+    ID_COUNT = 0\n+\n+    @staticmethod\n+    def rpc_request(body):\n+        req = body\n+        req[\"version\"] = \"1.1\"\n+        req[\"id\"] = Format.ID_COUNT\n+        Format.ID_COUNT += 1\n+        return req\n+\n+\n+def send_raw_rpc(node, raw_body: bytes) -> tuple[object, int]:\n+    return node._request(\"POST\", \"/\", raw_body)\n+\n+\n+def send_json_rpc(node, body: object) -> tuple[object, int]:\n+    raw = json.dumps(body).encode(\"utf-8\")\n+    return send_raw_rpc(node, raw)\n+\n+\n+def expect_http_rpc_status(expected_http_status, expected_rpc_error_code, node, method, params=None):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1462248344",
      "id" : 1462248344,
      "in_reply_to_id" : 1447616571,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585XKCOY",
      "original_commit_id" : "29ebb0d7774ee2d10aa274086e8ff4b2395f7047",
      "original_line" : 41,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "test/functional/interface_rpc.py",
      "position" : null,
      "pull_request_review_id" : 1837095302,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1462248344/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-22T18:27:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1462248344",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1462363162"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1462363162"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ok I understand. I'm taking this suggestion and also using `std::move` a few places in `bitcoin-cli` where potentially large result objects are being passed. I am leaving as-is however when the argument is `NullUniValue`, I think that's correct but please let me know if I should use `std::move` at the other call sites as well.",
      "commit_id" : "756da6d1e67fba65a992dc0090ee8c0cfa26abe3",
      "created_at" : "2024-01-22T20:10:12Z",
      "diff_hunk" : "@@ -358,36 +358,13 @@ bool IsDeprecatedRPCEnabled(const std::string& method)\n     return find(enabled_methods.begin(), enabled_methods.end(), method) != enabled_methods.end();\n }\n \n-static UniValue JSONRPCExecOne(JSONRPCRequest jreq, const UniValue& req)\n+UniValue JSONRPCExec(const JSONRPCRequest& jreq)\n {\n-    UniValue rpc_result(UniValue::VOBJ);\n+    // Might throw exception. Single requests will throw and send HTTP error codes\n+    // but inside a batch, we just include the error object and return HTTP 200\n+    UniValue result = tableRPC.execute(jreq);\n \n-    try {\n-        jreq.parse(req);\n-\n-        UniValue result = tableRPC.execute(jreq);\n-        rpc_result = JSONRPCReplyObj(result, NullUniValue, jreq.id);\n-    }\n-    catch (const UniValue& objError)\n-    {\n-        rpc_result = JSONRPCReplyObj(NullUniValue, objError, jreq.id);\n-    }\n-    catch (const std::exception& e)\n-    {\n-        rpc_result = JSONRPCReplyObj(NullUniValue,\n-                                     JSONRPCError(RPC_PARSE_ERROR, e.what()), jreq.id);\n-    }\n-\n-    return rpc_result;\n-}\n-\n-std::string JSONRPCExecBatch(const JSONRPCRequest& jreq, const UniValue& vReq)\n-{\n-    UniValue ret(UniValue::VARR);\n-    for (unsigned int reqIdx = 0; reqIdx < vReq.size(); reqIdx++)\n-        ret.push_back(JSONRPCExecOne(jreq, vReq[reqIdx]));\n-\n-    return ret.write() + \"\\n\";\n+    return JSONRPCReplyObj(result, NullUniValue, jreq.id);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1462363162",
      "id" : 1462363162,
      "in_reply_to_id" : 1446816704,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585XKeQa",
      "original_commit_id" : "27afe01560b1d930c3b072a180cab95c857eff24",
      "original_line" : 367,
      "original_position" : 38,
      "original_start_line" : null,
      "path" : "src/rpc/server.cpp",
      "position" : null,
      "pull_request_review_id" : 1837276402,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1462363162/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-22T20:10:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1462363162",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@ryanofsky thanks again for thorough review. I addressed all your comments.\r\n\r\n The one commit I am not fully confident in is 50debf781dbc4ac73cd1c0138ed9d405ea60eacb \"rpc: use move semantics in JSONRPCReplyObj()\" which is the commit I added to address \r\n\r\nhttps://github.com/bitcoin/bitcoin/pull/27101#discussion_r1446816704\r\nand\r\nhttps://github.com/bitcoin/bitcoin/pull/27101#discussion_r1446847073",
      "created_at" : "2024-01-24T19:31:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#issuecomment-1908785694",
      "id" : 1908785694,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27101",
      "node_id" : "IC_kwDOABII585xxcIe",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1908785694/reactions"
      },
      "updated_at" : "2024-01-24T20:16:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1908785694",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1465515386"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465515386"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I updated the function `JSONRPCReplyObj` to expect plain ol' `UniValue` for both response and error, and added `std::move()` where it seemed applicable. Tidy didn't like `std::move()` here because `objError` is already a `const`, so my understanding is that the error message will continue to be passed by reference through the end of `JSONRPCReplyObj` but my understanding is limited",
      "commit_id" : "98031401c744ea3c2b62927fabf27c22b639c3cf",
      "created_at" : "2024-01-24T20:43:26Z",
      "diff_hunk" : "@@ -360,11 +360,24 @@ bool IsDeprecatedRPCEnabled(const std::string& method)\n \n UniValue JSONRPCExec(const JSONRPCRequest& jreq)\n {\n-    // Might throw exception. Single requests will throw and send HTTP error codes\n-    // but inside a batch, we just include the error object and return HTTP 200\n-    UniValue result = tableRPC.execute(jreq);\n+    UniValue result;\n+    if (jreq.m_json_version == JSONVersion::JSON_2_0) {\n+        // JSONRPC 2.0 behavior: only throw HTTP error if the server is actually\n+        // broken. Otherwise errors are sent back in \"HTTP OK\" responses.\n+        try {\n+            result = tableRPC.execute(jreq);\n+        } catch (const UniValue& objError) {\n+            return JSONRPCReplyObj(NullUniValue, objError, jreq.id, jreq.m_json_version);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1465515386",
      "id" : 1465515386,
      "in_reply_to_id" : 1446847073,
      "line" : 370,
      "node_id" : "PRRC_kwDOABII585XWf16",
      "original_commit_id" : "c9196a2e5b747753e0d5ee59e1bcb987943eedbf",
      "original_line" : 370,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/rpc/server.cpp",
      "position" : 31,
      "pull_request_review_id" : 1842336271,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465515386/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-24T20:43:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465515386",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1468881262"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1468881262"
         }
      },
      "author_association" : "NONE",
      "body" : "nit:  Author's choice on whether this is addressed or not.\r\n\r\nMinor non-compliance to the JSON RPC 2.0 spec (`rpc call with an empty Array` in https://www.jsonrpc.org/specification#examples).  Providing an empty array results in an empty array provided in the response, but should result in a single error response (e.g. `\"jsonrpc\": \"2.0\", \"error\": {\"code\": -32600, \"message\": \"Invalid Request\"}, \"id\": null}`).  \r\n\r\nA check for `valRequest.size() == 0` before entering the for loop in 236 could enable error response (rather than empty response array).  Perhaps this is best handled when future updates attempt more strict compliance to 2.0?",
      "commit_id" : "98031401c744ea3c2b62927fabf27c22b639c3cf",
      "created_at" : "2024-01-28T15:07:25Z",
      "diff_hunk" : "@@ -200,13 +203,17 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n                 req->WriteReply(HTTP_FORBIDDEN);\n                 return false;\n             }\n-            UniValue result = tableRPC.execute(jreq);\n \n-            // Send reply\n-            strReply = JSONRPCReply(result, NullUniValue, jreq.id);\n+            reply = JSONRPCExec(jreq);\n+            if (jreq.IsNotification()) {\n+                // Even though we do execute notifications, we do not respond to them\n+                req->WriteReply(HTTP_NO_CONTENT);\n+                return true;\n+            }\n \n         // array of requests\n         } else if (valRequest.isArray()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1468881262",
      "id" : 1468881262,
      "line" : 215,
      "node_id" : "PRRC_kwDOABII585XjVlu",
      "original_commit_id" : "98031401c744ea3c2b62927fabf27c22b639c3cf",
      "original_line" : 215,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : 47,
      "pull_request_review_id" : 1847563884,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1468881262/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-28T17:03:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1468881262",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106488469?v=4",
         "events_url" : "https://api.github.com/users/tdb3/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tdb3/followers",
         "following_url" : "https://api.github.com/users/tdb3/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tdb3/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tdb3",
         "id" : 106488469,
         "login" : "tdb3",
         "node_id" : "U_kgDOBljilQ",
         "organizations_url" : "https://api.github.com/users/tdb3/orgs",
         "received_events_url" : "https://api.github.com/users/tdb3/received_events",
         "repos_url" : "https://api.github.com/users/tdb3/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tdb3/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tdb3/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tdb3"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1468881540"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1468881540"
         }
      },
      "author_association" : "NONE",
      "body" : "Issuing an example command from https://developer.bitcoin.org/reference/rpc/getblockchaininfo.html resulted in error response `{\"result\":null,\"error\":{\"code\":-32600,\"message\":\"JSON-RPC version not supported\"}}` due to the example's use of `\"jsonrpc\":\"1.0\"`.  It looks like JSON RPC spec for 1.0 had no version field in the spec, 1.1 (WD/ALT) had the \"version\" field to specify version, and 2.0 spec has \"jsonrpc\" (must be set to \"2.0\").  \r\n\r\nIf a client uses a \"jsonrpc\" field other than \"2.0\" it will receive the error (from exception thrown in line 202), whereas in the previous implementation the request would be processed successfully.  This does seem to affect backwards compatibility with 1.x implementations, although I'm unsure how widespread the usage of the jsonrpc field is in existing client implementations.  The original issue #2960 claims 61/70 implementions work only with 2.0 (so likely to use 2.0 as the value in the jsonrpc field and not encounter the error response).  At the very least, the developer.bitcoin.org examples seem to be non-comformant to the JSON-RPC specs (1.0 doesn't define the \"jsonrpc\" field, 1.1 requires \"version\", and 2.0 requires \"jsonrpc\").\r\n\r\nIncreased backwards compatibility at the expense of strict compliance to 2.0 could be achieved by adding else if clauses to fallback to 1.x handling if the jsonrpc field is \"1.0\" (example below).  Author's choice.  I'd support either way (not continuing to enable non-conformant requests, or enabling non-comformant requests with future notification of 1.x deprecation).\r\n\r\n```\r\n} else if(valJsonRPC.get_str() == \"1.0\") {\r\n    /* m_json_version is JSONVersion::JSON_1_BTC */\r\n}\r\n```\r\n",
      "commit_id" : "98031401c744ea3c2b62927fabf27c22b639c3cf",
      "created_at" : "2024-01-28T15:09:02Z",
      "diff_hunk" : "@@ -170,8 +188,31 @@ void JSONRPCRequest::parse(const UniValue& valRequest)\n         throw JSONRPCError(RPC_INVALID_REQUEST, \"Invalid Request object\");\n     const UniValue& request = valRequest.get_obj();\n \n-    // Parse id now so errors from here on will have the id\n-    id = request.find_value(\"id\");\n+    // Check for JSON-RPC 2.0 (default 1.1)\n+    // We must do this before looking for the id field\n+    m_json_version = JSONVersion::JSON_1_BTC;\n+    const UniValue& valJsonRPC = request.find_value(\"jsonrpc\");\n+    if (!valJsonRPC.isNull()) {\n+        if (!valJsonRPC.isStr()) {\n+            throw JSONRPCError(RPC_INVALID_REQUEST, \"jsonrpc field must be a string\");\n+        }\n+        if (valJsonRPC.get_str() == \"2.0\") {\n+            m_json_version = JSONVersion::JSON_2_0;\n+        } else {\n+            throw JSONRPCError(RPC_INVALID_REQUEST, \"JSON-RPC version not supported\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1468881540",
      "id" : 1468881540,
      "line" : 202,
      "node_id" : "PRRC_kwDOABII585XjVqE",
      "original_commit_id" : "98031401c744ea3c2b62927fabf27c22b639c3cf",
      "original_line" : 202,
      "original_position" : 72,
      "original_start_line" : null,
      "path" : "src/rpc/request.cpp",
      "position" : 72,
      "pull_request_review_id" : 1847563884,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1468881540/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-28T16:20:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1468881540",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106488469?v=4",
         "events_url" : "https://api.github.com/users/tdb3/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tdb3/followers",
         "following_url" : "https://api.github.com/users/tdb3/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tdb3/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tdb3",
         "id" : 106488469,
         "login" : "tdb3",
         "node_id" : "U_kgDOBljilQ",
         "organizations_url" : "https://api.github.com/users/tdb3/orgs",
         "received_events_url" : "https://api.github.com/users/tdb3/received_events",
         "repos_url" : "https://api.github.com/users/tdb3/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tdb3/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tdb3/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tdb3"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1470044262"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1470044262"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Hm this is a bit of a mess, you're right. The behavior in this PR makes sense in response to @ryanofsky comment: https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1446841611\r\n\r\nThe help text has also been modified in `src/rpc/util.cpp` (98031401c744ea3c2b62927fabf27c22b639c3cf) to always recommend `\"jsonrpc\":\"2.0\"` \r\n\r\nI think you are illustrating an important issue though -- anyone who has used `bitcoin-cli help` (for ANY RPC command!) would have seen instructions to include `\"jsonrpc\":\"1.0\"` in their raw curl request. That was not only unnecessary, but also wrong.\r\n\r\nSo even though I'm trying to maintain complete backwards compatibility, there is a likelihood that users have copied this old help text verbatim and will encounter errors when upgrading.\r\n\r\nI'm not sure how to proceed on this, might need input from other reviewers. `\"jsonrpc\":\"1.0\"` is not a standard anywhere, not even in Bitcoin... but it has been in the RPC help text for a looooong time ð­ ",
      "commit_id" : "98031401c744ea3c2b62927fabf27c22b639c3cf",
      "created_at" : "2024-01-29T18:43:37Z",
      "diff_hunk" : "@@ -170,8 +188,31 @@ void JSONRPCRequest::parse(const UniValue& valRequest)\n         throw JSONRPCError(RPC_INVALID_REQUEST, \"Invalid Request object\");\n     const UniValue& request = valRequest.get_obj();\n \n-    // Parse id now so errors from here on will have the id\n-    id = request.find_value(\"id\");\n+    // Check for JSON-RPC 2.0 (default 1.1)\n+    // We must do this before looking for the id field\n+    m_json_version = JSONVersion::JSON_1_BTC;\n+    const UniValue& valJsonRPC = request.find_value(\"jsonrpc\");\n+    if (!valJsonRPC.isNull()) {\n+        if (!valJsonRPC.isStr()) {\n+            throw JSONRPCError(RPC_INVALID_REQUEST, \"jsonrpc field must be a string\");\n+        }\n+        if (valJsonRPC.get_str() == \"2.0\") {\n+            m_json_version = JSONVersion::JSON_2_0;\n+        } else {\n+            throw JSONRPCError(RPC_INVALID_REQUEST, \"JSON-RPC version not supported\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1470044262",
      "id" : 1470044262,
      "in_reply_to_id" : 1468881540,
      "line" : 202,
      "node_id" : "PRRC_kwDOABII585Xnxhm",
      "original_commit_id" : "98031401c744ea3c2b62927fabf27c22b639c3cf",
      "original_line" : 202,
      "original_position" : 72,
      "original_start_line" : null,
      "path" : "src/rpc/request.cpp",
      "position" : 72,
      "pull_request_review_id" : 1849525247,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1470044262/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-29T18:43:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1470044262",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1470059890"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1470059890"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is a good catch but unfortunately I think we need to stick with this behavior for backwards compatibility. If we get a request that does not have the exact key-value pair `\"jsonrpc\":\"2.0\"` we have to resort to legacy behavior. In that case, the user has submitted an empty batch and what they get back is an empty vector.\r\n\r\nThe closest 2.0 example I can think of is this:\r\n\r\n```\r\n--> [{\"jsonrpc\":\"2.0\", \"id\":\"\"}]\r\n<-- [{'jsonrpc': '2.0', 'error': {'code': -32600, 'message': 'Missing method'}, 'id': ''}]\r\n```\r\n\r\nif `\"jsonrpc\"` is removed, we revert to legacy behavior and if `\"id\"` is removed we get no response at all since that is a notification:\r\n\r\n```\r\n--> [{\"jsonrpc\":\"2.0\"}]\r\n<-- []\r\n```\r\n\r\nThis last example actually does look non-compliant according to the last example with an all-notification batch. So I think I will address that",
      "commit_id" : "98031401c744ea3c2b62927fabf27c22b639c3cf",
      "created_at" : "2024-01-29T18:55:42Z",
      "diff_hunk" : "@@ -200,13 +203,17 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\n                 req->WriteReply(HTTP_FORBIDDEN);\n                 return false;\n             }\n-            UniValue result = tableRPC.execute(jreq);\n \n-            // Send reply\n-            strReply = JSONRPCReply(result, NullUniValue, jreq.id);\n+            reply = JSONRPCExec(jreq);\n+            if (jreq.IsNotification()) {\n+                // Even though we do execute notifications, we do not respond to them\n+                req->WriteReply(HTTP_NO_CONTENT);\n+                return true;\n+            }\n \n         // array of requests\n         } else if (valRequest.isArray()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27101#discussion_r1470059890",
      "id" : 1470059890,
      "in_reply_to_id" : 1468881262,
      "line" : 215,
      "node_id" : "PRRC_kwDOABII585Xn1Vy",
      "original_commit_id" : "98031401c744ea3c2b62927fabf27c22b639c3cf",
      "original_line" : 215,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : 47,
      "pull_request_review_id" : 1849547957,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27101",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1470059890/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-29T18:57:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1470059890",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   }
]
