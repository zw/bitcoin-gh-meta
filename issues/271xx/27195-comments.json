[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n",
      "created_at" : "2023-03-03T15:13:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27195#issuecomment-1453678734",
      "id" : 1453678734,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27195",
      "node_id" : "IC_kwDOABII585WpWCO",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1453678734/reactions"
      },
      "updated_at" : "2023-03-03T15:13:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1453678734",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Not the scope of this PR, but related - in GUI this should be implemented as another context menu item \"Cancel transaction\".",
      "created_at" : "2023-03-03T15:31:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27195#issuecomment-1453704911",
      "id" : 1453704911,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27195",
      "node_id" : "IC_kwDOABII585WpcbP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 2,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 2,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1453704911/reactions"
      },
      "updated_at" : "2023-03-03T15:31:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1453704911",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4500994?v=4",
         "events_url" : "https://api.github.com/users/kristapsk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kristapsk/followers",
         "following_url" : "https://api.github.com/users/kristapsk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kristapsk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kristapsk",
         "id" : 4500994,
         "login" : "kristapsk",
         "node_id" : "MDQ6VXNlcjQ1MDA5OTQ=",
         "organizations_url" : "https://api.github.com/users/kristapsk/orgs",
         "received_events_url" : "https://api.github.com/users/kristapsk/received_events",
         "repos_url" : "https://api.github.com/users/kristapsk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kristapsk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kristapsk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kristapsk"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "We will need approval from @achow101 and @murch",
      "created_at" : "2023-03-03T17:24:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27195#issuecomment-1453858419",
      "id" : 1453858419,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27195",
      "node_id" : "IC_kwDOABII585WqB5z",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1453858419/reactions"
      },
      "updated_at" : "2023-03-03T17:24:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1453858419",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/94559964?v=4",
         "events_url" : "https://api.github.com/users/1440000bytes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/1440000bytes/followers",
         "following_url" : "https://api.github.com/users/1440000bytes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/1440000bytes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/1440000bytes",
         "id" : 94559964,
         "login" : "1440000bytes",
         "node_id" : "U_kgDOBaLe3A",
         "organizations_url" : "https://api.github.com/users/1440000bytes/orgs",
         "received_events_url" : "https://api.github.com/users/1440000bytes/received_events",
         "repos_url" : "https://api.github.com/users/1440000bytes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/1440000bytes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/1440000bytes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/1440000bytes"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27195#discussion_r1137912817"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27195"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1137912817"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In 7cb4dc157a711210e18f3c9b492150b6eb984b30 \" bumpfee: enable send coins back to yourself \" \r\n\r\nWhile this certainly looks correct, I think there is more concise way of doing this within the outputs loop before this one. I've implemented it here if you would like to take a look: https://github.com/ishaanam/bitcoin/commit/5b1017c1ea11c8fe2351a9110e4c6ddad6e77f8a. The advantage of this would be that the sanity check would not be required and imo it would be a bit more readable.",
      "commit_id" : "c707bac6b7ecbb113fdeea46c5486364e2289f55",
      "created_at" : "2023-03-16T00:18:35Z",
      "diff_hunk" : "@@ -245,6 +245,19 @@ Result CreateRateBumpTransaction(CWallet& wallet, const uint256& txid, const CCo\n         }\n     }\n \n+    // If no recipients, means that we are sending coins to a change address\n+    if (recipients.empty()) {\n+        // Just as a sanity check, ensure that the change address exist\n+        if (std::get_if<CNoDestination>(&new_coin_control.destChange)) {\n+            errors.emplace_back(Untranslated(\"Unable to create transaction. Transaction must have at least one recipient\"));\n+            return Result::INVALID_PARAMETER;\n+        }\n+\n+        // Add change as recipient with SFFO flag enabled, so fees are deduced from it and no other output is created.\n+        recipients.emplace_back(CRecipient{GetScriptForDestination(new_coin_control.destChange), output_value, /*fSubtractFeeFromAmount=*/true});\n+        new_coin_control.destChange = CNoDestination();\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27195#discussion_r1137912817",
      "id" : 1137912817,
      "line" : 259,
      "node_id" : "PRRC_kwDOABII585D0yvx",
      "original_commit_id" : "c707bac6b7ecbb113fdeea46c5486364e2289f55",
      "original_line" : 259,
      "original_position" : 15,
      "original_start_line" : 248,
      "path" : "src/wallet/feebumper.cpp",
      "position" : 15,
      "pull_request_review_id" : 1342628092,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27195",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1137912817/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 248,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-03-16T00:19:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1137912817",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/75942586?v=4",
         "events_url" : "https://api.github.com/users/ishaanam/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ishaanam/followers",
         "following_url" : "https://api.github.com/users/ishaanam/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ishaanam/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ishaanam",
         "id" : 75942586,
         "login" : "ishaanam",
         "node_id" : "MDQ6VXNlcjc1OTQyNTg2",
         "organizations_url" : "https://api.github.com/users/ishaanam/orgs",
         "received_events_url" : "https://api.github.com/users/ishaanam/received_events",
         "repos_url" : "https://api.github.com/users/ishaanam/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ishaanam/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ishaanam/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ishaanam"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27195#discussion_r1140814055"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27195"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1140814055"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 7cb4dc157a711210e18f3c9b492150b6eb984b30 \"bumpfee: enable send coins back to yourself\"\r\n\r\n`output_value` is not guaranteed to match what the user had actually specified for the single output.",
      "commit_id" : "c707bac6b7ecbb113fdeea46c5486364e2289f55",
      "created_at" : "2023-03-17T23:22:29Z",
      "diff_hunk" : "@@ -245,6 +245,19 @@ Result CreateRateBumpTransaction(CWallet& wallet, const uint256& txid, const CCo\n         }\n     }\n \n+    // If no recipients, means that we are sending coins to a change address\n+    if (recipients.empty()) {\n+        // Just as a sanity check, ensure that the change address exist\n+        if (std::get_if<CNoDestination>(&new_coin_control.destChange)) {\n+            errors.emplace_back(Untranslated(\"Unable to create transaction. Transaction must have at least one recipient\"));\n+            return Result::INVALID_PARAMETER;\n+        }\n+\n+        // Add change as recipient with SFFO flag enabled, so fees are deduced from it and no other output is created.\n+        recipients.emplace_back(CRecipient{GetScriptForDestination(new_coin_control.destChange), output_value, /*fSubtractFeeFromAmount=*/true});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27195#discussion_r1140814055",
      "id" : 1140814055,
      "line" : 257,
      "node_id" : "PRRC_kwDOABII585D_3Dn",
      "original_commit_id" : "7cb4dc157a711210e18f3c9b492150b6eb984b30",
      "original_line" : 257,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/wallet/feebumper.cpp",
      "position" : 13,
      "pull_request_review_id" : 1346827347,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27195",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1140814055/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-17T23:22:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1140814055",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27195#discussion_r1143775844"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27195"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143775844"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks ishaanam.\r\nAt least for me, it doesn't look right to check the vector size while we loop over it. It is also not correct to use `outputs.size()` as `outputs` will be empty if the user didn't customize them.",
      "commit_id" : "c260d3fbf4cf8be07176840f39125abcb3d59c1b",
      "created_at" : "2023-03-21T17:35:42Z",
      "diff_hunk" : "@@ -245,6 +245,19 @@ Result CreateRateBumpTransaction(CWallet& wallet, const uint256& txid, const CCo\n         }\n     }\n \n+    // If no recipients, means that we are sending coins to a change address\n+    if (recipients.empty()) {\n+        // Just as a sanity check, ensure that the change address exist\n+        if (std::get_if<CNoDestination>(&new_coin_control.destChange)) {\n+            errors.emplace_back(Untranslated(\"Unable to create transaction. Transaction must have at least one recipient\"));\n+            return Result::INVALID_PARAMETER;\n+        }\n+\n+        // Add change as recipient with SFFO flag enabled, so fees are deduced from it and no other output is created.\n+        recipients.emplace_back(CRecipient{GetScriptForDestination(new_coin_control.destChange), output_value, /*fSubtractFeeFromAmount=*/true});\n+        new_coin_control.destChange = CNoDestination();\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27195#discussion_r1143775844",
      "id" : 1143775844,
      "in_reply_to_id" : 1137912817,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585ELKJk",
      "original_commit_id" : "c707bac6b7ecbb113fdeea46c5486364e2289f55",
      "original_line" : 262,
      "original_position" : 15,
      "original_start_line" : 248,
      "path" : "src/wallet/feebumper.cpp",
      "position" : null,
      "pull_request_review_id" : 1351069109,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27195",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143775844/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-03-21T17:35:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143775844",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27195#discussion_r1143819895"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27195"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143819895"
         }
      },
      "author_association" : "MEMBER",
      "body" : "oops, fixed. And added coverage for it.",
      "commit_id" : "c260d3fbf4cf8be07176840f39125abcb3d59c1b",
      "created_at" : "2023-03-21T18:13:40Z",
      "diff_hunk" : "@@ -245,6 +245,19 @@ Result CreateRateBumpTransaction(CWallet& wallet, const uint256& txid, const CCo\n         }\n     }\n \n+    // If no recipients, means that we are sending coins to a change address\n+    if (recipients.empty()) {\n+        // Just as a sanity check, ensure that the change address exist\n+        if (std::get_if<CNoDestination>(&new_coin_control.destChange)) {\n+            errors.emplace_back(Untranslated(\"Unable to create transaction. Transaction must have at least one recipient\"));\n+            return Result::INVALID_PARAMETER;\n+        }\n+\n+        // Add change as recipient with SFFO flag enabled, so fees are deduced from it and no other output is created.\n+        recipients.emplace_back(CRecipient{GetScriptForDestination(new_coin_control.destChange), output_value, /*fSubtractFeeFromAmount=*/true});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27195#discussion_r1143819895",
      "id" : 1143819895,
      "in_reply_to_id" : 1140814055,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585ELU53",
      "original_commit_id" : "7cb4dc157a711210e18f3c9b492150b6eb984b30",
      "original_line" : 257,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/wallet/feebumper.cpp",
      "position" : null,
      "pull_request_review_id" : 1351133952,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27195",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143819895/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-21T18:13:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143819895",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27195#discussion_r1143830313"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27195"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143830313"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> It is also not correct to use outputs.size() as outputs will be empty if the user didn't customize them.\r\n\r\nIn what scenario would we need to make the change output the sole recipient if the user didn't customize the outputs? My understanding was that this is only an issue because of the addition of the \"outputs\" vector.\r\n",
      "commit_id" : "c260d3fbf4cf8be07176840f39125abcb3d59c1b",
      "created_at" : "2023-03-21T18:22:28Z",
      "diff_hunk" : "@@ -245,6 +245,19 @@ Result CreateRateBumpTransaction(CWallet& wallet, const uint256& txid, const CCo\n         }\n     }\n \n+    // If no recipients, means that we are sending coins to a change address\n+    if (recipients.empty()) {\n+        // Just as a sanity check, ensure that the change address exist\n+        if (std::get_if<CNoDestination>(&new_coin_control.destChange)) {\n+            errors.emplace_back(Untranslated(\"Unable to create transaction. Transaction must have at least one recipient\"));\n+            return Result::INVALID_PARAMETER;\n+        }\n+\n+        // Add change as recipient with SFFO flag enabled, so fees are deduced from it and no other output is created.\n+        recipients.emplace_back(CRecipient{GetScriptForDestination(new_coin_control.destChange), output_value, /*fSubtractFeeFromAmount=*/true});\n+        new_coin_control.destChange = CNoDestination();\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27195#discussion_r1143830313",
      "id" : 1143830313,
      "in_reply_to_id" : 1137912817,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585ELXcp",
      "original_commit_id" : "c707bac6b7ecbb113fdeea46c5486364e2289f55",
      "original_line" : 262,
      "original_position" : 15,
      "original_start_line" : 248,
      "path" : "src/wallet/feebumper.cpp",
      "position" : null,
      "pull_request_review_id" : 1351150081,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27195",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143830313/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-03-21T18:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143830313",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/75942586?v=4",
         "events_url" : "https://api.github.com/users/ishaanam/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ishaanam/followers",
         "following_url" : "https://api.github.com/users/ishaanam/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ishaanam/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ishaanam",
         "id" : 75942586,
         "login" : "ishaanam",
         "node_id" : "MDQ6VXNlcjc1OTQyNTg2",
         "organizations_url" : "https://api.github.com/users/ishaanam/orgs",
         "received_events_url" : "https://api.github.com/users/ishaanam/received_events",
         "repos_url" : "https://api.github.com/users/ishaanam/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ishaanam/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ishaanam/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ishaanam"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27195#discussion_r1143834924"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27195"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143834924"
         }
      },
      "author_association" : "MEMBER",
      "body" : "a send-to-self, single change output tx that is bumped.",
      "commit_id" : "c260d3fbf4cf8be07176840f39125abcb3d59c1b",
      "created_at" : "2023-03-21T18:25:37Z",
      "diff_hunk" : "@@ -245,6 +245,19 @@ Result CreateRateBumpTransaction(CWallet& wallet, const uint256& txid, const CCo\n         }\n     }\n \n+    // If no recipients, means that we are sending coins to a change address\n+    if (recipients.empty()) {\n+        // Just as a sanity check, ensure that the change address exist\n+        if (std::get_if<CNoDestination>(&new_coin_control.destChange)) {\n+            errors.emplace_back(Untranslated(\"Unable to create transaction. Transaction must have at least one recipient\"));\n+            return Result::INVALID_PARAMETER;\n+        }\n+\n+        // Add change as recipient with SFFO flag enabled, so fees are deduced from it and no other output is created.\n+        recipients.emplace_back(CRecipient{GetScriptForDestination(new_coin_control.destChange), output_value, /*fSubtractFeeFromAmount=*/true});\n+        new_coin_control.destChange = CNoDestination();\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27195#discussion_r1143834924",
      "id" : 1143834924,
      "in_reply_to_id" : 1137912817,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585ELYks",
      "original_commit_id" : "c707bac6b7ecbb113fdeea46c5486364e2289f55",
      "original_line" : 262,
      "original_position" : 15,
      "original_start_line" : 248,
      "path" : "src/wallet/feebumper.cpp",
      "position" : null,
      "pull_request_review_id" : 1351155147,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27195",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143834924/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-03-21T18:25:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143834924",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27195#discussion_r1154926275"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27195"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154926275"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "If I'm understanding this correctly, this means that this could result in the creation of a transaction with 2 outputs that our wallet would identify as change. What would happen if we wanted to bump this transaction again, but keep the outputs the same? Though I haven't tested this, I think that the following will happen:\r\n\r\n1. The first output is added as `new_coin_control.destChange`\r\n2. Then we find the second output is also change and over-write the original `destChange` with the second output\r\n3. `recipients` is empty, so we make recipient the current `destChange`\r\n4. `destChange` is now nothing, so we have lost the first output address.\r\n\r\nI suppose it doesn't really matter, because the money is still going to the same wallet, but usually it is expected for the outputs to be preserved unless `outputs` is used.",
      "commit_id" : "c260d3fbf4cf8be07176840f39125abcb3d59c1b",
      "created_at" : "2023-03-31T21:35:57Z",
      "diff_hunk" : "@@ -243,6 +244,21 @@ Result CreateRateBumpTransaction(CWallet& wallet, const uint256& txid, const CCo\n             ExtractDestination(output.scriptPubKey, change_dest);\n             new_coin_control.destChange = change_dest;\n         }\n+        new_outputs_value += output.nValue;\n+    }\n+\n+    // If no recipients, means that we are sending coins to a change address\n+    if (recipients.empty()) {\n+        // Just as a sanity check, ensure that the change address exist\n+        if (std::get_if<CNoDestination>(&new_coin_control.destChange)) {\n+            errors.emplace_back(Untranslated(\"Unable to create transaction. Transaction must have at least one recipient\"));\n+            return Result::INVALID_PARAMETER;\n+        }\n+\n+        // Add change as recipient with SFFO flag enabled, so fees are deduced from it.\n+        // If the output differs from the original tx output (because the user customized it) a new change output will be created.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27195#discussion_r1154926275",
      "id" : 1154926275,
      "line" : 259,
      "node_id" : "PRRC_kwDOABII585E1sbD",
      "original_commit_id" : "15ecc354a4de223183994aa1cff87e960ce483fa",
      "original_line" : 259,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/wallet/feebumper.cpp",
      "position" : 24,
      "pull_request_review_id" : 1367649953,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27195",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154926275/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-31T21:36:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154926275",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/75942586?v=4",
         "events_url" : "https://api.github.com/users/ishaanam/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ishaanam/followers",
         "following_url" : "https://api.github.com/users/ishaanam/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ishaanam/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ishaanam",
         "id" : 75942586,
         "login" : "ishaanam",
         "node_id" : "MDQ6VXNlcjc1OTQyNTg2",
         "organizations_url" : "https://api.github.com/users/ishaanam/orgs",
         "received_events_url" : "https://api.github.com/users/ishaanam/received_events",
         "repos_url" : "https://api.github.com/users/ishaanam/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ishaanam/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ishaanam/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ishaanam"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27195#discussion_r1155119661"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27195"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1155119661"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yeah, I started working on it here but ended up moving the work to another branch because it's not a problem introduced in this PR.\r\n\r\nThis PR enables the bump of single output transactions that were previously not possible. It's not changing how we decide which output becomes change.\r\n\r\nAnyone can craft a transaction with two outputs sending to change addresses already (just need to call `getrawchangeaddress` twice) and bump it.\r\n\r\nThat issue is inside the `outputs` loop that is above this code that doesn't check `destChange` existence prior set.\r\nWhich well, in the future PR, we will need to decide which change address use if there are many of them.",
      "commit_id" : "c260d3fbf4cf8be07176840f39125abcb3d59c1b",
      "created_at" : "2023-04-01T14:39:06Z",
      "diff_hunk" : "@@ -243,6 +244,21 @@ Result CreateRateBumpTransaction(CWallet& wallet, const uint256& txid, const CCo\n             ExtractDestination(output.scriptPubKey, change_dest);\n             new_coin_control.destChange = change_dest;\n         }\n+        new_outputs_value += output.nValue;\n+    }\n+\n+    // If no recipients, means that we are sending coins to a change address\n+    if (recipients.empty()) {\n+        // Just as a sanity check, ensure that the change address exist\n+        if (std::get_if<CNoDestination>(&new_coin_control.destChange)) {\n+            errors.emplace_back(Untranslated(\"Unable to create transaction. Transaction must have at least one recipient\"));\n+            return Result::INVALID_PARAMETER;\n+        }\n+\n+        // Add change as recipient with SFFO flag enabled, so fees are deduced from it.\n+        // If the output differs from the original tx output (because the user customized it) a new change output will be created.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27195#discussion_r1155119661",
      "id" : 1155119661,
      "in_reply_to_id" : 1154926275,
      "line" : 259,
      "node_id" : "PRRC_kwDOABII585E2bot",
      "original_commit_id" : "15ecc354a4de223183994aa1cff87e960ce483fa",
      "original_line" : 259,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/wallet/feebumper.cpp",
      "position" : 24,
      "pull_request_review_id" : 1367870063,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27195",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1155119661/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-01T14:39:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1155119661",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   }
]
