{
   "assignee" : null,
   "body" : "I've been seeing a peer at IP 45.59.67.242 appear to repeatedly freeze incoming block downloads. \r\nThis appears to be timeout related as nearly exactly 20 minutes pass between the inv(2016-02-25 03:52:02.639084) and the download timeout(2016-02-25 04:12:02.649818).\r\n\r\nI'm not seeing a \"Requesting block\" before the timeout on the block download that freezes however.\r\n\r\nBest I can tell bitcoind thinks it's downloading a block starting at the inv but actually isn't at all.\r\n\r\nI enabled debug=net and got the following log for that particular ip address and got logs for two peers:\r\n\r\n2016-02-25 03:27:26.584941 Added connection to 45.59.67.242:23938 peer=5\r\n2016-02-25 03:27:26.594339 received: version (102 bytes) peer=5\r\n2016-02-25 03:27:26.594365 send version message: version 70012, blocks=399909, us=0.0.0.0:8333, them=45.59.67.242:23938, peer=5\r\n2016-02-25 03:27:26.594381 sending: version (102 bytes) peer=5\r\n2016-02-25 03:27:26.594420 sending: verack (0 bytes) peer=5\r\n2016-02-25 03:27:26.594456 receive version message: /Satoshi:0.11.2/: version 70002, blocks=398961, us=0.0.0.0:0, peer=5, peeraddr=45.59.67.242:23938\r\n2016-02-25 03:27:26.594492 sending: ping (8 bytes) peer=5\r\n2016-02-25 03:27:26.594531 initial getheaders (399908) to peer=5 (startheight:398961)\r\n2016-02-25 03:27:26.594557 sending: getheaders (997 bytes) peer=5\r\n2016-02-25 03:27:26.670222 received: verack (0 bytes) peer=5\r\n2016-02-25 03:27:26.745767 received: sendheaders (0 bytes) peer=5\r\n2016-02-25 03:27:26.745816 received: pong (8 bytes) peer=5\r\n2016-02-25 03:27:40.548265 SendMessages: sending inv peer=5 hash=0000000000000000055a8d660c231dc279ad443f9b9b4c0ce7871ca76fc2a26a\r\n2016-02-25 03:27:40.548399 sending: inv (37 bytes) peer=5\r\n2016-02-25 03:27:40.624387 received: getheaders (37 bytes) peer=5\r\n2016-02-25 03:27:40.624421 getheaders 399910 to 0000000000000000055a8d660c231dc279ad443f9b9b4c0ce7871ca76fc2a26a from peer=5\r\n2016-02-25 03:27:40.624443 sending: headers (82 bytes) peer=5\r\n2016-02-25 03:29:26.638425 sending: ping (8 bytes) peer=5\r\n2016-02-25 03:29:26.714478 received: pong (8 bytes) peer=5\r\n2016-02-25 03:31:26.670357 sending: ping (8 bytes) peer=5\r\n2016-02-25 03:31:26.746327 received: pong (8 bytes) peer=5\r\n2016-02-25 03:33:26.719860 sending: ping (8 bytes) peer=5\r\n2016-02-25 03:33:26.795763 received: pong (8 bytes) peer=5\r\n2016-02-25 03:35:26.735255 sending: ping (8 bytes) peer=5\r\n2016-02-25 03:35:26.811319 received: pong (8 bytes) peer=5\r\n2016-02-25 03:35:44.727049 received: inv (37 bytes) peer=5\r\n2016-02-25 03:35:44.727108 got inv: block 000000000000000005a43f5f8e3ba24d0c883f52c50fe1516d388c0beb82092e  have peer=5\r\n2016-02-25 03:37:26.768606 sending: ping (8 bytes) peer=5\r\n2016-02-25 03:37:26.844447 received: pong (8 bytes) peer=5\r\n2016-02-25 03:38:40.726377 received: inv (37 bytes) peer=5\r\n2016-02-25 03:38:40.726424 got inv: block 000000000000000003863fc0e1f681ee116bc1969d83c6fd79b7236f461b3dc8  have peer=5\r\n2016-02-25 03:39:26.852340 sending: ping (8 bytes) peer=5\r\n2016-02-25 03:39:26.928320 received: pong (8 bytes) peer=5\r\n2016-02-25 03:39:52.833825 received: inv (37 bytes) peer=5\r\n2016-02-25 03:39:52.833875 got inv: block 0000000000000000048d37e2e2ee7cc251a55c6db98f93d30d9514fccb1e05b2  have peer=5\r\n2016-02-25 03:39:52.909224 received: inv (37 bytes) peer=5\r\n2016-02-25 03:39:52.909267 got inv: block 000000000000000006a553939f586b491f63d3158b3baee1fbdf06bd3c41becc  have peer=5\r\n2016-02-25 03:39:52.909498 received: inv (37 bytes) peer=5\r\n2016-02-25 03:39:52.909532 got inv: block 0000000000000000040a1634cb04b7fc15fcbd497861f8c1e8ba2702aa0e5102  have peer=5\r\n2016-02-25 03:40:29.195452 received: inv (37 bytes) peer=5\r\n2016-02-25 03:40:29.195493 got inv: block 000000000000000006a553939f586b491f63d3158b3baee1fbdf06bd3c41becc  have peer=5\r\n2016-02-25 03:40:42.916763 sending: addr (31 bytes) peer=5\r\n2016-02-25 03:41:26.872496 sending: ping (8 bytes) peer=5\r\n2016-02-25 03:41:26.948482 received: pong (8 bytes) peer=5\r\n2016-02-25 03:41:32.723481 SendMessages: sending header 0000000000000000045c976c3bf82c2799c71e6ea68906421d21919aec653ba1 to peer=5\r\n2016-02-25 03:41:32.723507 sending: headers (82 bytes) peer=5\r\n2016-02-25 03:42:27.600880 SendMessages: sending header 0000000000000000004b4641818e1a05201a590172e96827e331810e6f7ef285 to peer=5\r\n2016-02-25 03:42:27.600899 sending: headers (82 bytes) peer=5\r\n2016-02-25 03:43:26.905505 sending: ping (8 bytes) peer=5\r\n2016-02-25 03:43:26.981511 received: pong (8 bytes) peer=5\r\n2016-02-25 03:44:13.689181 SendMessages: sending header 000000000000000001293c1a8c0496976d5df54e880cbf2137696e0f0f289f3b to peer=5\r\n2016-02-25 03:44:13.689209 sending: headers (82 bytes) peer=5\r\n2016-02-25 03:44:31.887382 received: inv (37 bytes) peer=5\r\n2016-02-25 03:44:31.887454 got inv: block 000000000000000006acbd2f1a0e688c5f88b9d6542f3168d709e7e0209c8776  have peer=5\r\n2016-02-25 03:45:26.988531 sending: ping (8 bytes) peer=5\r\n2016-02-25 03:45:27.064530 received: pong (8 bytes) peer=5\r\n2016-02-25 03:47:27.015442 sending: ping (8 bytes) peer=5\r\n2016-02-25 03:47:27.091397 received: pong (8 bytes) peer=5\r\n2016-02-25 03:47:57.151362 received: inv (37 bytes) peer=5\r\n2016-02-25 03:47:57.151426 got inv: block 000000000000000003863fc0e1f681ee116bc1969d83c6fd79b7236f461b3dc8  have peer=5\r\n2016-02-25 03:49:27.023873 sending: ping (8 bytes) peer=5\r\n2016-02-25 03:49:27.126229 received: pong (8 bytes) peer=5\r\n2016-02-25 03:51:27.063346 sending: ping (8 bytes) peer=5\r\n2016-02-25 03:51:27.139456 received: pong (8 bytes) peer=5\r\n2016-02-25 03:52:02.639023 received: inv (37 bytes) peer=5\r\n2016-02-25 03:52:02.639084 got inv: block 000000000000000005d165e5f2f5e1755c5beacdb577516badddb70f735d8abf  new peer=5\r\n2016-02-25 03:52:02.639110 sending: getheaders (997 bytes) peer=5\r\n2016-02-25 03:52:02.639167 getheaders (399913) 000000000000000005d165e5f2f5e1755c5beacdb577516badddb70f735d8abf to peer=5\r\n2016-02-25 03:52:02.639189 sending: getdata (37 bytes) peer=5\r\n2016-02-25 03:52:20.407013 received: inv (37 bytes) peer=5\r\n2016-02-25 03:52:20.407065 got inv: block 000000000000000005d165e5f2f5e1755c5beacdb577516badddb70f735d8abf  have peer=5\r\n2016-02-25 03:53:27.078588 sending: ping (8 bytes) peer=5\r\n2016-02-25 03:53:27.155332 received: pong (8 bytes) peer=5\r\n2016-02-25 03:55:27.094616 sending: ping (8 bytes) peer=5\r\n2016-02-25 03:55:27.170600 received: pong (8 bytes) peer=5\r\n2016-02-25 03:56:09.845746 received: inv (37 bytes) peer=5\r\n2016-02-25 03:56:09.845785 got inv: block 000000000000000005d165e5f2f5e1755c5beacdb577516badddb70f735d8abf  have peer=5\r\n2016-02-25 03:57:22.595017 received: inv (37 bytes) peer=5\r\n2016-02-25 03:57:22.595051 got inv: block 000000000000000005d165e5f2f5e1755c5beacdb577516badddb70f735d8abf  have peer=5\r\n2016-02-25 03:57:27.095494 sending: ping (8 bytes) peer=5\r\n2016-02-25 03:57:27.175737 received: pong (8 bytes) peer=5\r\n2016-02-25 03:57:59.312015 received: inv (37 bytes) peer=5\r\n2016-02-25 03:57:59.312060 got inv: block 000000000000000005d165e5f2f5e1755c5beacdb577516badddb70f735d8abf  have peer=5\r\n2016-02-25 03:59:27.181473 sending: ping (8 bytes) peer=5\r\n2016-02-25 03:59:27.257374 received: pong (8 bytes) peer=5\r\n2016-02-25 04:01:27.190789 sending: ping (8 bytes) peer=5\r\n2016-02-25 04:01:27.290189 received: pong (8 bytes) peer=5\r\n2016-02-25 04:02:20.607148 received: inv (37 bytes) peer=5\r\n2016-02-25 04:02:20.607200 got inv: block 000000000000000005d165e5f2f5e1755c5beacdb577516badddb70f735d8abf  have peer=5\r\n2016-02-25 04:02:34.403450 sending: addr (31 bytes) peer=5\r\n2016-02-25 04:03:27.639512 sending: ping (8 bytes) peer=5\r\n2016-02-25 04:03:27.715490 received: pong (8 bytes) peer=5\r\n2016-02-25 04:03:57.964562 received: inv (37 bytes) peer=5\r\n2016-02-25 04:03:57.964628 got inv: block 000000000000000006968c648240001fd7d856f9732646763225b084f72404eb  have peer=5\r\n2016-02-25 04:04:15.959001 received: inv (37 bytes) peer=5\r\n2016-02-25 04:04:15.959043 got inv: block 000000000000000005d165e5f2f5e1755c5beacdb577516badddb70f735d8abf  have peer=5\r\n2016-02-25 04:05:27.663258 sending: ping (8 bytes) peer=5\r\n2016-02-25 04:05:27.739294 received: pong (8 bytes) peer=5\r\n2016-02-25 04:07:27.701216 sending: ping (8 bytes) peer=5\r\n2016-02-25 04:07:27.777073 received: pong (8 bytes) peer=5\r\n2016-02-25 04:08:26.259859 received: inv (37 bytes) peer=5\r\n2016-02-25 04:08:26.259903 got inv: block 000000000000000005d165e5f2f5e1755c5beacdb577516badddb70f735d8abf  have peer=5\r\n2016-02-25 04:09:27.719881 sending: ping (8 bytes) peer=5\r\n2016-02-25 04:09:27.795892 received: pong (8 bytes) peer=5\r\n2016-02-25 04:10:21.115286 received: inv (37 bytes) peer=5\r\n2016-02-25 04:10:21.115329 got inv: block 000000000000000005d165e5f2f5e1755c5beacdb577516badddb70f735d8abf  have peer=5\r\n2016-02-25 04:10:41.128117 received: inv (37 bytes) peer=5\r\n2016-02-25 04:10:41.128176 got inv: block 000000000000000006a553939f586b491f63d3158b3baee1fbdf06bd3c41becc  have peer=5\r\n2016-02-25 04:10:47.314680 received: inv (37 bytes) peer=5\r\n2016-02-25 04:10:47.314724 got inv: block 000000000000000003863fc0e1f681ee116bc1969d83c6fd79b7236f461b3dc8  have peer=5\r\n2016-02-25 04:10:47.891925 received: inv (37 bytes) peer=5\r\n2016-02-25 04:10:47.891975 got inv: block 000000000000000005d165e5f2f5e1755c5beacdb577516badddb70f735d8abf  have peer=5\r\n2016-02-25 04:11:27.721622 sending: ping (8 bytes) peer=5\r\n2016-02-25 04:11:27.797602 received: pong (8 bytes) peer=5\r\n2016-02-25 04:11:48.622047 received: inv (37 bytes) peer=5\r\n2016-02-25 04:11:48.622095 got inv: block 000000000000000005d165e5f2f5e1755c5beacdb577516badddb70f735d8abf  have peer=5\r\n2016-02-25 04:12:02.649818 Timeout downloading block 000000000000000005d165e5f2f5e1755c5beacdb577516badddb70f735d8abf from peer=5, disconnecting\r\n2016-02-25 04:12:02.650520 disconnecting peer=5\r\n\r\nSecond peer:\r\n2016-02-25 03:27:26.585853 Added connection to 45.59.67.242:24096 peer=8\r\n2016-02-25 03:27:26.594616 received: version (102 bytes) peer=8\r\n2016-02-25 03:27:26.594644 send version message: version 70012, blocks=399909, us=0.0.0.0:8333, them=45.59.67.242:24096, peer=8\r\n2016-02-25 03:27:26.594660 sending: version (102 bytes) peer=8\r\n2016-02-25 03:27:26.594692 sending: verack (0 bytes) peer=8\r\n2016-02-25 03:27:26.594727 receive version message: /Satoshi:0.11.2/: version 70002, blocks=398962, us=0.0.0.0:0, peer=8, peeraddr=45.59.67.242:24096\r\n2016-02-25 03:27:26.594748 sending: ping (8 bytes) peer=8\r\n2016-02-25 03:27:26.594784 initial getheaders (399908) to peer=8 (startheight:398962)\r\n2016-02-25 03:27:26.594803 sending: getheaders (997 bytes) peer=8\r\n2016-02-25 03:27:26.652033 received: verack (0 bytes) peer=8\r\n2016-02-25 03:27:26.709122 received: getaddr (0 bytes) peer=8\r\n2016-02-25 03:27:26.719489 received: pong (8 bytes) peer=8\r\n2016-02-25 03:27:39.272680 sending: addr (6691 bytes) peer=8\r\n2016-02-25 03:27:40.548476 SendMessages: sending inv peer=8 hash=0000000000000000055a8d660c231dc279ad443f9b9b4c0ce7871ca76fc2a26a\r\n2016-02-25 03:27:40.548605 sending: inv (37 bytes) peer=8\r\n2016-02-25 03:29:26.638499 sending: ping (8 bytes) peer=8\r\n2016-02-25 03:29:26.695970 received: pong (8 bytes) peer=8\r\n2016-02-25 03:31:26.670438 sending: ping (8 bytes) peer=8\r\n2016-02-25 03:31:26.727856 received: pong (8 bytes) peer=8\r\n2016-02-25 03:33:26.719910 sending: ping (8 bytes) peer=8\r\n2016-02-25 03:33:26.777217 received: pong (8 bytes) peer=8\r\n2016-02-25 03:35:26.735296 sending: ping (8 bytes) peer=8\r\n2016-02-25 03:35:26.792777 received: pong (8 bytes) peer=8\r\n2016-02-25 03:37:26.768651 sending: ping (8 bytes) peer=8\r\n2016-02-25 03:37:26.826034 received: pong (8 bytes) peer=8\r\n2016-02-25 03:39:26.852381 sending: ping (8 bytes) peer=8\r\n2016-02-25 03:39:26.909663 received: pong (8 bytes) peer=8\r\n2016-02-25 03:41:26.872553 sending: ping (8 bytes) peer=8\r\n2016-02-25 03:41:26.929941 received: pong (8 bytes) peer=8\r\n2016-02-25 03:41:32.723573 SendMessages: sending inv peer=8 hash=0000000000000000045c976c3bf82c2799c71e6ea68906421d21919aec653ba1\r\n2016-02-25 03:41:32.723641 sending: inv (37 bytes) peer=8\r\n2016-02-25 03:42:27.600944 SendMessages: sending inv peer=8 hash=0000000000000000004b4641818e1a05201a590172e96827e331810e6f7ef285\r\n2016-02-25 03:42:27.625760 sending: inv (37 bytes) peer=8\r\n2016-02-25 03:43:26.905566 sending: ping (8 bytes) peer=8\r\n2016-02-25 03:43:26.963017 received: pong (8 bytes) peer=8\r\n2016-02-25 03:44:13.689271 SendMessages: sending inv peer=8 hash=000000000000000001293c1a8c0496976d5df54e880cbf2137696e0f0f289f3b\r\n2016-02-25 03:44:13.689335 sending: inv (37 bytes) peer=8\r\n2016-02-25 03:45:26.988599 sending: ping (8 bytes) peer=8\r\n2016-02-25 03:45:27.046023 received: pong (8 bytes) peer=8\r\n2016-02-25 03:47:27.015494 sending: ping (8 bytes) peer=8\r\n2016-02-25 03:47:27.072934 received: pong (8 bytes) peer=8\r\n2016-02-25 03:49:27.023920 sending: ping (8 bytes) peer=8\r\n2016-02-25 03:49:27.082058 received: pong (8 bytes) peer=8\r\n2016-02-25 03:51:27.063410 sending: ping (8 bytes) peer=8\r\n2016-02-25 03:51:27.120803 received: pong (8 bytes) peer=8\r\n2016-02-25 03:53:20.479954 sending: addr (31 bytes) peer=8\r\n2016-02-25 03:53:27.078641 sending: ping (8 bytes) peer=8\r\n2016-02-25 03:53:27.136045 received: pong (8 bytes) peer=8\r\n2016-02-25 03:55:27.094669 sending: ping (8 bytes) peer=8\r\n2016-02-25 03:55:27.152122 received: pong (8 bytes) peer=8\r\n2016-02-25 03:57:27.095562 sending: ping (8 bytes) peer=8\r\n2016-02-25 03:57:27.156677 received: pong (8 bytes) peer=8\r\n2016-02-25 03:58:17.120629 sending: addr (31 bytes) peer=8\r\n2016-02-25 03:59:27.181538 sending: ping (8 bytes) peer=8\r\n2016-02-25 03:59:27.238915 received: pong (8 bytes) peer=8\r\n2016-02-25 04:01:27.190862 sending: ping (8 bytes) peer=8\r\n2016-02-25 04:01:27.248246 received: pong (8 bytes) peer=8\r\n2016-02-25 04:03:08.118377 sending: addr (31 bytes) peer=8\r\n2016-02-25 04:03:27.639584 sending: ping (8 bytes) peer=8\r\n2016-02-25 04:03:27.711646 received: pong (8 bytes) peer=8\r\n2016-02-25 04:05:27.663313 sending: ping (8 bytes) peer=8\r\n2016-02-25 04:05:27.720738 received: pong (8 bytes) peer=8\r\n2016-02-25 04:07:27.701263 sending: ping (8 bytes) peer=8\r\n2016-02-25 04:07:27.758529 received: pong (8 bytes) peer=8\r\n2016-02-25 04:08:45.591612 sending: addr (31 bytes) peer=8\r\n2016-02-25 04:09:27.719929 sending: ping (8 bytes) peer=8\r\n2016-02-25 04:09:27.777268 received: pong (8 bytes) peer=8\r\n2016-02-25 04:11:27.721667 sending: ping (8 bytes) peer=8\r\n2016-02-25 04:11:27.779075 received: pong (8 bytes) peer=8\r\n\r\n\r\nThere appear to also be two connections from that same IP(this was taken after restarting bitcoind again):\r\n  {\r\n    \"id\": 4,\r\n    \"addr\": \"45.59.67.242:64468\",\r\n    \"services\": \"0000000000000001\",\r\n    \"relaytxes\": false,\r\n    \"lastsend\": 1456376513,\r\n    \"lastrecv\": 1456376447,\r\n    \"bytessent\": 7918,\r\n    \"bytesrecv\": 206,\r\n    \"conntime\": 1456376447,\r\n    \"timeoffset\": -92955,\r\n    \"pingtime\": 0.072335,\r\n    \"minping\": 0.072335,\r\n    \"version\": 70002,\r\n    \"subver\": \"/Satoshi:0.11.2/\",\r\n    \"inbound\": true,\r\n    \"startingheight\": 398962,\r\n    \"banscore\": 0,\r\n    \"synced_headers\": -1,\r\n    \"synced_blocks\": -1,\r\n    \"inflight\": [\r\n    ],\r\n    \"whitelisted\": false\r\n  }, \r\n  {\r\n    \"id\": 11,\r\n    \"addr\": \"45.59.67.242:64537\",\r\n    \"services\": \"0000000000000001\",\r\n    \"relaytxes\": false,\r\n    \"lastsend\": 1456376502,\r\n    \"lastrecv\": 1456376554,\r\n    \"bytessent\": 1319,\r\n    \"bytesrecv\": 572,\r\n    \"conntime\": 1456376447,\r\n    \"timeoffset\": -93290,\r\n    \"pingtime\": 0.07256899999999999,\r\n    \"minping\": 0.07256899999999999,\r\n    \"version\": 70002,\r\n    \"subver\": \"/Satoshi:0.11.2/\",\r\n    \"inbound\": true,\r\n    \"startingheight\": 398961,\r\n    \"banscore\": 0,\r\n    \"synced_headers\": 399923,\r\n    \"synced_blocks\": 399922,\r\n    \"inflight\": [\r\n      399923\r\n    ],\r\n    \"whitelisted\": false\r\n  }, ",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 5,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7596/comments",
   "created_at" : "2016-02-25T05:27:45Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7596/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/7596",
   "id" : 136285477,
   "labels" : [
      {
         "color" : "FBBAAB",
         "name" : "Bug",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug"
      },
      {
         "color" : "006b75",
         "name" : "P2P",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7596/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 7596,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "Incoming block downloads repeatedly freezing in 0.12",
   "updated_at" : "2016-02-25T09:10:25Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7596",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/3298484?v=3",
      "events_url" : "https://api.github.com/users/jameshilliard/events{/privacy}",
      "followers_url" : "https://api.github.com/users/jameshilliard/followers",
      "following_url" : "https://api.github.com/users/jameshilliard/following{/other_user}",
      "gists_url" : "https://api.github.com/users/jameshilliard/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/jameshilliard",
      "id" : 3298484,
      "login" : "jameshilliard",
      "organizations_url" : "https://api.github.com/users/jameshilliard/orgs",
      "received_events_url" : "https://api.github.com/users/jameshilliard/received_events",
      "repos_url" : "https://api.github.com/users/jameshilliard/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/jameshilliard/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/jameshilliard/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/jameshilliard"
   }
}
