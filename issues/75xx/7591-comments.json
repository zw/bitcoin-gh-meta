[
   {
      "body" : "Because the functionality is largely deprecated; it causes a lot of confusion about the security model and most of what it usefully accomplished is now (or can be) accomplished in better ways. ",
      "created_at" : "2016-02-24T17:25:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7591#issuecomment-188361978",
      "id" : 188361978,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7591",
      "updated_at" : "2016-02-24T17:25:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/188361978",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "Oh, I thought that checkpoints made syncing faster.\r\n\r\nIf they are deprecated, why do we still keep them?",
      "created_at" : "2016-02-24T17:29:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7591#issuecomment-188366022",
      "id" : 188366022,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7591",
      "updated_at" : "2016-02-24T17:29:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/188366022",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=3",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "body" : "At least on reasonably fast hardware they don't change it that much, I benchmarked with and without prior to 0.12 release and it was perhaps a 10% difference (e.g. 3.5 hrs vs 4). The fact that libsecp256k1 made signature verification 7x-ish faster made a big difference.  They were initially added to the software as the result of another not-understood-at-the-time bug that harmed verification performance which was long since fixed.\r\n\r\nRemoving them entirely requires replacing the role they serve in preventing low difficulty header flooding attacks, which would need some design and development.",
      "created_at" : "2016-02-24T17:34:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7591#issuecomment-188369540",
      "id" : 188369540,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7591",
      "updated_at" : "2016-02-24T17:43:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/188369540",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "I got interested in this particular performance question when I went to prune a x86_64 full node's datadir that had a full txindex so that I could put it on some of the lower power ARM SBCs (single board computers) that I have. Since pruning is not compatible with -txindex, that gets switched off and then the whole chain has to get re-indexed before it can be pruned.\r\n\r\nWhen 0.12 came out a few days ago, I wondered if updating the checkpoints to 395,000 would make much of a difference. I ran tests with various system configurations. The two competing versions of the software I used were the official 0.12 release and master + the patch to use block 395,000 as the latest checkpoint. The tests were simply to re-index the chain. I used an x86_64 quad core that runs at roughly 2.8 GHz when frequency scaling is in performance mode and a little less (it fluctuates during the test) when in powersave. I tried an unencrypted 5400 rpm sata drive and a samsung 840 pro ssd with luks full disk encryption. 8GB ram with dbcache set to 6000. Between any two competing runs on the same system config, the checkpoint change did NOT make any real difference. And, like Greg said, across the tests, on the order of 4 hours +- half an hour is basically what I got consistently.\r\n\r\nI also started to run tests on some armv7 hard float machines (odroid xu4, c1+, and ras pi 2 -- didn't test a Jetson TK1 yet). But, man those are so much slower (for a number of reasons including storage speed, no assembly optimizations, etc...). It's like 9-15 minutes on my x86_64 configs vs around 1.5-2.5 hours on the various SBC configs for the first 200,000 blocks or so. I didn't even let those tests complete since I just didn't have the time.\r\n\r\nWith the ARM machines in mind, I was thinking of putting a PR forward for block 395,000. If there's any desire for that, I can do it. But, I didn't yet because I just figured that re-indexing on the ARM SBCs is just using the wrong tool for the job. If you can run an x86_64 full node and prune datadir and then copy it to the ARM machine, do that. It's more of a question of if we should try to support the lower power machines for people that don't have the higher power luxury.",
      "created_at" : "2016-02-27T21:51:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7591#issuecomment-189735368",
      "id" : 189735368,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7591",
      "updated_at" : "2016-02-27T21:51:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/189735368",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6440430?v=3",
         "events_url" : "https://api.github.com/users/mruddy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mruddy/followers",
         "following_url" : "https://api.github.com/users/mruddy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mruddy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mruddy",
         "id" : 6440430,
         "login" : "mruddy",
         "organizations_url" : "https://api.github.com/users/mruddy/orgs",
         "received_events_url" : "https://api.github.com/users/mruddy/received_events",
         "repos_url" : "https://api.github.com/users/mruddy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mruddy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mruddy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mruddy"
      }
   },
   {
      "body" : "@mruddy Thanks for the confirmation.\r\n\r\nThere is still a lot of speedup available for signature validation on ARM-- we're not using the assembly that wumpus wrote (mostly as a result of the development team not having enough expertise to review it; and because arm is so slow that we gain testing confidence slowly). Those alone are a 2x validation speed improvement.\r\n\r\nBut as you say, validating performance on a low end SBC is just not great. It can be papered over by bypassing it, but I think there are better ways to do that (e.g. don't validate in IBD for blocks that are burried by a month of POW) which don't keep sending researchers down blind alleys like static checkpoints do. (The biggest effect of checkpoints these days is their invocation in papers describing centralized consensus systems as justification for a (false) equivalence of their approach and Bitcoin.)\r\n\r\n",
      "created_at" : "2016-02-27T22:45:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7591#issuecomment-189742561",
      "id" : 189742561,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7591",
      "updated_at" : "2016-02-27T22:45:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/189742561",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "@gmaxwell Regarding the ARM sig val speedup (https://github.com/bitcoin/secp256k1/pull/366 and https://github.com/bitcoin/secp256k1/pull/173), I don't have the assembly experience to review it, but I did just get a Jetson TK1 SBC (http://elinux.org/Jetson_TK1) that should be pretty fast and able to use faster SSD storage (assuming that's the case, I'd still need to try it). If I benchmarked 0.12 on that and then added the ARM assembly optimizations and ran the same re-indexing benchmark test, would that help you guys move forward with those changes? It would provide a comparison of the speedup, but probably more importantly, it would also show that the speedup does not introduce some chain splitting regression (at least as far as validating the ~400k blocks that have been created so far). I guess the question is, has the slowness of ARM SBC validation hindered your regression testing efforts in a way that my faster board could possibly help?",
      "created_at" : "2016-02-28T00:14:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7591#issuecomment-189752950",
      "id" : 189752950,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7591",
      "updated_at" : "2016-02-28T00:14:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/189752950",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6440430?v=3",
         "events_url" : "https://api.github.com/users/mruddy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mruddy/followers",
         "following_url" : "https://api.github.com/users/mruddy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mruddy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mruddy",
         "id" : 6440430,
         "login" : "mruddy",
         "organizations_url" : "https://api.github.com/users/mruddy/orgs",
         "received_events_url" : "https://api.github.com/users/mruddy/received_events",
         "repos_url" : "https://api.github.com/users/mruddy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mruddy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mruddy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mruddy"
      }
   },
   {
      "body" : "FWIW, I setup the Jetson TK1 last night with a Samsung SSD 840 EVO 250GB, set the quad core Cortex-A15 cluster to full speed @ 2.32GHz, compiled tag v0.12.0, and let it chug away re-indexing a datadir that I put on the SSD (with -dbcache=1024).\r\n\r\nAt 07:19:31 into the test, while attempting to process block 00000000000000001562e39680215040651c7dfd111cfbb9a7d6550f336297cf  height=336596, it errored with \"LoadExternalBlockFile: Deserialize or I/O error - std::bad_alloc\". I guess my dbcache was too aggressive. The first 200,000 blocks took 00:45:49 to process.\r\n\r\nI figure since I got past block 295,000 I can still have some data to compare against the checkpoint at 395,000 patch, so I just patched that and started another test. We'll see if it gets any farther and/or any faster. That'll at least be something until I figure out what dbcache setting works better.\r\n\r\nHere's a chart of the HH:MM:SS it took to process the previous 5000 blocks by block height:\r\n\r\n![image](https://cloud.githubusercontent.com/assets/6440430/13379154/3bfbd5be-ddec-11e5-9096-63daed75ca91.png)\r\n",
      "created_at" : "2016-02-28T12:25:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7591#issuecomment-189856852",
      "id" : 189856852,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7591",
      "updated_at" : "2016-02-28T12:25:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/189856852",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6440430?v=3",
         "events_url" : "https://api.github.com/users/mruddy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mruddy/followers",
         "following_url" : "https://api.github.com/users/mruddy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mruddy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mruddy",
         "id" : 6440430,
         "login" : "mruddy",
         "organizations_url" : "https://api.github.com/users/mruddy/orgs",
         "received_events_url" : "https://api.github.com/users/mruddy/received_events",
         "repos_url" : "https://api.github.com/users/mruddy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mruddy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mruddy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mruddy"
      }
   },
   {
      "body" : "@gmaxwell The month deep blocks patch sounds like an excellent idea indeed. I was about to run a full node on a Raspberry Pi and was thinking of patching it to allow me to set checkpoints from the command line / config file, using a block hash from another full node I run, or perhaps extending this further, allowing it to have configured a node which it trusts and can use as a checkpoint against. I'm wondering why this hasn't already been done by anyone else so far.",
      "created_at" : "2016-02-28T20:59:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7591#issuecomment-189945799",
      "id" : 189945799,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7591",
      "updated_at" : "2016-02-28T21:00:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/189945799",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "I just got data from my second Jetson TK1 run. Same config as before except that I patched in block 395,000 as the latest checkpoint. This time I got the `LoadExternalBlockFile: Deserialize or I/O error - std::bad_alloc` at 00000000000000000ee1ba35093a736f150a113d0231d50c29b37c3f05d1ae62 height=346233. So it got 9637 blocks farther and the run time was 19 seconds shorter. So, that points to the checkpoint update making some difference, but it's not all that meaningful since at this rate, re-indexing on this class machine is still seemingly futile.\r\n\r\n@rebroad I have a Raspberry Pi 2, and that is a much less powerful computer than this Jetson TK1 ARM SBC config that I'm telling you all about. I expect you'd have the same kind of problems (only slower) if you tried to re-index the whole chain on the Ras Pi.\r\n\r\nBTW, this was the patch:\r\n```\r\ndiff --git a/src/chainparams.cpp b/src/chainparams.cpp\r\nindex 9cf9949..63058ae 100644\r\n--- a/src/chainparams.cpp\r\n+++ b/src/chainparams.cpp\r\n@@ -135,11 +135,12 @@ public:\r\n             (225430, uint256S(\"0x00000000000001c108384350f74090433e7fcf79a606b8e797f065b130575932\"))\r\n             (250000, uint256S(\"0x000000000000003887df1f29024b06fc2200b55f8af8f35453d7be294df2d214\"))\r\n             (279000, uint256S(\"0x0000000000000001ae8c72a0b0c301f67e3afca10e819efa9041e458e9bd7e40\"))\r\n-            (295000, uint256S(\"0x00000000000000004d9b4ef50f0f9d686fd69db2e03af35a100370c64632a983\")),\r\n-            1397080064, // * UNIX timestamp of last checkpoint block\r\n-            36544669,   // * total number of transactions between genesis and last checkpoint\r\n+            (295000, uint256S(\"0x00000000000000004d9b4ef50f0f9d686fd69db2e03af35a100370c64632a983\"))\r\n+            (395000, uint256S(\"0x0000000000000000014b0f613fa97d3f512666a8aa4fd06132ff4fd330a0a664\")),\r\n+            1453737986, // * UNIX timestamp of last checkpoint block\r\n+            105734718,  // * total number of transactions between genesis and last checkpoint\r\n                         //   (the tx=... number in the SetBestChain debug.log lines)\r\n-            60000.0     // * estimated number of transactions per day after checkpoint\r\n+            120000.0    // * estimated number of transactions per day after checkpoint\r\n         };\r\n     }\r\n };\r\n```\r\n\r\nGraph from the second run:\r\n\r\n![image](https://cloud.githubusercontent.com/assets/6440430/13382209/c61291b6-de3c-11e5-9590-fe461de06b41.png)\r\n",
      "created_at" : "2016-02-28T22:03:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7591#issuecomment-189954497",
      "id" : 189954497,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7591",
      "updated_at" : "2016-02-28T22:03:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/189954497",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6440430?v=3",
         "events_url" : "https://api.github.com/users/mruddy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mruddy/followers",
         "following_url" : "https://api.github.com/users/mruddy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mruddy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mruddy",
         "id" : 6440430,
         "login" : "mruddy",
         "organizations_url" : "https://api.github.com/users/mruddy/orgs",
         "received_events_url" : "https://api.github.com/users/mruddy/received_events",
         "repos_url" : "https://api.github.com/users/mruddy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mruddy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mruddy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mruddy"
      }
   }
]
