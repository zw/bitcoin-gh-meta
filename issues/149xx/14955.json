{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "This does not remove OpenSSL, but makes our own PRNG the 'main' one; for GetStrongRandBytes, the OpenSSL RNG is still used (indirectly, by feeding its output into our PRNG state).\r\n\r\nIt includes a few policy changes (regarding what entropy is seeded when).\r\n\r\nBefore this PR:\r\n* GetRand*:\r\n  * OpenSSL\r\n* GetStrongRand*:\r\n  * CPU cycle counter\r\n  * Perfmon data (on Windows, once 10 min)\r\n  * /dev/urandom (or equivalent)\r\n  * rdrand (if available)\r\n* From scheduler when idle:\r\n  * CPU cycle counter before and after 1ms sleep\r\n* At startup:\r\n  * CPU cycle counter before and after 1ms sleep\r\n\r\nAfter this PR:\r\n* GetRand*:\r\n  * Stack pointer (which indirectly identifies thread and some call stack information)\r\n  * rdrand (if available)\r\n  * CPU cycle counter\r\n* GetStrongRand*:\r\n  * Stack pointer (which indirectly identifies thread and some call stack information)\r\n  * rdrand (if available)\r\n  * CPU cycle counter\r\n  * /dev/urandom (or equivalent)\r\n  * OpenSSL\r\n  * CPU cycle counter again\r\n* From scheduler when idle:\r\n  * Stack pointer (which indirectly identifies thread and some call stack information)\r\n  * rdrand (if available)\r\n  * CPU cycle counter before and after 1ms sleep\r\n  * Perfmon data (on Windows, once every 10 min)\r\n  * Repeated SHA512 for 10ms (once every 1 min) + CPU cycle counter during this operation\r\n* At startup:\r\n  * Stack pointer (which indirectly identifies thread and some call stack information)\r\n  * rdrand (if available)\r\n  * CPU cycle counter\r\n  * /dev/urandom (or equivalent)\r\n  * OpenSSL\r\n  * CPU cycle counter again\r\n  * Perfmon data (on Windows, once every 10 min)\r\n  * Repeated SHA512 for 10ms (once every 1 min) + CPU cycle counter during this operation\r\n\r\nAs there are just 3 OpenSSL call sites left, I've also added mutexes around those (instead of running in OpenSSL's multithreaded mode, removing some ugly initialization code).\r\n\r\nThe interface of random.h is also simplified, and documentation is added.\r\n\r\nThis implements most of #14623.",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 13,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14955/comments",
   "created_at" : "2018-12-14T03:02:58Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14955/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/14955",
   "id" : 390947027,
   "labels" : [
      {
         "color" : "E6F6D6",
         "default" : false,
         "id" : 135961,
         "name" : "Refactoring",
         "node_id" : "MDU6TGFiZWwxMzU5NjE=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring"
      },
      {
         "color" : "5319e7",
         "default" : false,
         "id" : 241832923,
         "name" : "Utils/log/libs",
         "node_id" : "MDU6TGFiZWwyNDE4MzI5MjM=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Utils/log/libs"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14955/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDExOlB1bGxSZXF1ZXN0MjM4NTk3MjU5",
   "number" : 14955,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/14955.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14955",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/14955.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14955"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "Switch all RNG code to the built-in PRNG",
   "updated_at" : "2019-01-03T17:39:58Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14955",
   "user" : {
      "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
      "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
      "followers_url" : "https://api.github.com/users/sipa/followers",
      "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/sipa",
      "id" : 548488,
      "login" : "sipa",
      "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
      "organizations_url" : "https://api.github.com/users/sipa/orgs",
      "received_events_url" : "https://api.github.com/users/sipa/received_events",
      "repos_url" : "https://api.github.com/users/sipa/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/sipa"
   }
}
