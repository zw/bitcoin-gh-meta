[
   {
      "body" : "I don't see this particular behaviour, but it may be specific to your connections. When the whole program hangs probably the cs_main lock is contended for some reason. Compiling with `-DDEBUG_LOCKCONTENTION` could help figure out what threads are contending for the lock.",
      "created_at" : "2014-10-03T06:31:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5037#issuecomment-57760883",
      "id" : 57760883,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5037",
      "updated_at" : "2014-10-03T06:31:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/57760883",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Actually, my wording should have been \"freezes for ~10 seconds\"...  I'll try that compile option, thanks.",
      "created_at" : "2014-10-03T08:31:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5037#issuecomment-57768824",
      "id" : 57768824,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5037",
      "updated_at" : "2014-10-03T08:31:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/57768824",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "@laanwj  how do I add that compile flag? By re-running ./configure -DDEBUG_LOCKCONTENTION?",
      "created_at" : "2014-10-03T08:34:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5037#issuecomment-57769148",
      "id" : 57769148,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5037",
      "updated_at" : "2014-10-03T08:34:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/57769148",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "```bash\r\n./configure ... CPPFLAGS=\"-DDEBUG_LOCKCONTENTION\"\r\n```\r\n",
      "created_at" : "2014-10-03T08:37:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5037#issuecomment-57769335",
      "id" : 57769335,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5037",
      "updated_at" : "2014-10-03T08:37:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/57769335",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "why is it a compile option rather than the code being enabled by default but optionally logged?",
      "created_at" : "2014-10-05T06:40:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5037#issuecomment-57928213",
      "id" : 57928213,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5037",
      "updated_at" : "2014-10-05T06:40:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/57928213",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "anyway, I've enabled this, but so far nothing is showing up in the logs.",
      "created_at" : "2014-10-05T06:41:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5037#issuecomment-57928218",
      "id" : 57928218,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5037",
      "updated_at" : "2014-10-05T06:41:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/57928218",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "For performance reasons, originally. Not sure what the overhead actually is, though.",
      "created_at" : "2014-10-05T07:06:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5037#issuecomment-57928555",
      "id" : 57928555,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5037",
      "updated_at" : "2014-10-05T07:06:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/57928555",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "See-also #1550 and #1213",
      "created_at" : "2014-10-05T07:06:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5037#issuecomment-57928562",
      "id" : 57928562,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5037",
      "updated_at" : "2014-10-05T07:06:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/57928562",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "Because locking is performance sensitive (that's sort of the point of it). Anything that slows the locking primitives down slows down the whole program. You're free to always build and run with it of course.\r\n",
      "created_at" : "2014-10-06T02:26:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5037#issuecomment-57964401",
      "id" : 57964401,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5037",
      "updated_at" : "2014-10-06T02:26:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/57964401",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I've also noticed that the client can hang for seconds at a time while syncing (in `ActivateBestChain`, which has a loop to catch up), this is mostly an issue in the GUI as it tries to get the cs_main lock as well.\r\n\r\nMessage handler thread:\r\n```\r\n#18 0x00005555556dd99b in ConnectBlock (block=..., state=..., pindex=pindex@entry=0x7fffb7854240, view=..., fJustCheck=fJustCheck@entry=false) at main.cpp:1612\r\n#19 0x00005555556e1e23 in ConnectTip (pblock=0x7fff90a9dbf0, pindexNew=0x7fffb7854240, state=...) at main.cpp:1867\r\n#20 ActivateBestChainStep (pblock=0x0, pindexMostWork=0x7fffb64e1ed0, state=...) at main.cpp:1985\r\n#21 ActivateBestChain (state=..., pblock=pblock@entry=0x7fff90a9e440) at main.cpp:2047\r\n#22 0x00005555556e312a in ProcessBlock (state=..., pfrom=pfrom@entry=0x7fff80000b20, pblock=pblock@entry=0x7fff90a9e440, dbp=dbp@entry=0x0) at main.cpp:2529\r\n#23 0x00005555556e80f9 in ProcessMessage (pfrom=pfrom@entry=0x7fff80000b20, strCommand=..., vRecv=..., nTimeReceived=nTimeReceived@entry=1414512718258751) at main.cpp:3937\r\n#24 0x00005555556ea143 in ProcessMessages (pfrom=0x7fff80000b20) at main.cpp:4261\r\n```\r\nThe GUI, meanwhile:\r\n```\r\n#8  0x0000555555675631 in TransactionTablePriv::updateWallet (this=0x5555566ab640, hash=..., status=status@entry=0) at qt/transactiontablemodel.cpp:98\r\n#9  0x000055555567449f in TransactionTableModel::updateTransaction (this=0x555556a77ac0, hash=..., status=0) at qt/transactiontablemodel.cpp:258\r\n#10 0x000055555561a4d6 in WalletModel::updateTransaction (this=this@entry=0x555556ab9880, hash=..., status=<optimized out>) at qt/walletmodel.cpp:170\r\n#11 0x0000555555635484 in WalletModel::qt_static_metacall (_o=0x555556ab9880, _c=<optimized out>, _id=<optimized out>, _a=0x7fffcba78470) at qt/moc_walletmodel.cpp:86\r\n#12 0x00007ffff5f75c1e in QObject::event(QEvent*) () from /usr/lib/x86_64-linux-gnu/libQtCore.so.4\r\n```",
      "created_at" : "2014-10-28T16:19:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5037#issuecomment-60783873",
      "id" : 60783873,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5037",
      "updated_at" : "2014-10-28T16:19:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60783873",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "#5168 should improve on this (although there are still quite a few places to go where the GUI thread acquires cs_main/cs_wallet)\r\n",
      "created_at" : "2014-10-29T08:36:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5037#issuecomment-60889001",
      "id" : 60889001,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5037",
      "updated_at" : "2014-10-29T08:36:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60889001",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@rebroad Are you still seeing this behaviour after the merge of #5168 ?",
      "created_at" : "2015-01-03T13:09:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5037#issuecomment-68594419",
      "id" : 68594419,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5037",
      "updated_at" : "2015-01-03T13:09:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/68594419",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=3",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "body" : "Closed because fixed with #5168 and no feedback from @rebroad.",
      "created_at" : "2015-01-10T09:06:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5037#issuecomment-69449250",
      "id" : 69449250,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5037",
      "updated_at" : "2015-01-10T09:06:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/69449250",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   }
]
