[
   {
      "body" : "Ah. This makes sense!\r\nFixes #8045 not #8051.\r\nI could not reproduce #8045 but looks good.\r\n\r\nutACK 53bcca971b807b25f219f0aeea25071e38ccea7d",
      "created_at" : "2016-05-13T17:18:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8052#issuecomment-219105087",
      "id" : 219105087,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8052",
      "updated_at" : "2016-05-13T17:18:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/219105087",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "This does not fix #8045 for me.",
      "created_at" : "2016-05-13T19:11:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8052#issuecomment-219134037",
      "id" : 219134037,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8052",
      "updated_at" : "2016-05-13T19:11:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/219134037",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Hm. I can't reliably reproduce the test failure; I got it to happen once by looping `walletbackup.py` until it failed, but the problem's too intermittent here for me to test a solution effectively.\r\n\r\nIn the error case, packet capture showed:\r\nt+0s: `importwallet` request to server\r\nt+30.5s: FIN+ACK from client\r\nt+38.5s: reply from server, followed by FIN+ACK from server\r\n\r\nSo it looks like it involves a 30 second timeout somewhere on the client end, but since `53bcca9` didn't fix it apparently the problem timeout's value is not originating with `HTTP_TIMEOUT`...\r\n\r\n[[I should probably modify this to extend the timeout only for the test case in question, but let's figure out why it isn't working first]]",
      "created_at" : "2016-05-13T19:41:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8052#issuecomment-219140717",
      "id" : 219140717,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8052",
      "updated_at" : "2016-05-13T19:48:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/219140717",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1047859?v=3",
         "events_url" : "https://api.github.com/users/kazcw/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kazcw/followers",
         "following_url" : "https://api.github.com/users/kazcw/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kazcw/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kazcw",
         "id" : 1047859,
         "login" : "kazcw",
         "organizations_url" : "https://api.github.com/users/kazcw/orgs",
         "received_events_url" : "https://api.github.com/users/kazcw/received_events",
         "repos_url" : "https://api.github.com/users/kazcw/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kazcw/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kazcw/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kazcw"
      }
   },
   {
      "body" : "I tried with HTTP_TIMEOUT=600, and walletbackup.py still fails reliably. #8051 fixes it.",
      "created_at" : "2016-05-13T19:54:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8052#issuecomment-219143416",
      "id" : 219143416,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8052",
      "updated_at" : "2016-05-13T19:54:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/219143416",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Hmm, I think this might be related: https://github.com/bitcoin/bitcoin/pull/6695\r\n\r\n@sipa Does it fix it for you if you start bitcoind with a bigger `-rpcservertimeout`?",
      "created_at" : "2016-05-13T19:57:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8052#issuecomment-219144149",
      "id" : 219144149,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8052",
      "updated_at" : "2016-05-13T19:57:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/219144149",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "body" : "Oh, the bug in #8051 occurs during send. This fixes a bug in receiving...",
      "created_at" : "2016-05-13T20:03:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8052#issuecomment-219145456",
      "id" : 219145456,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8052",
      "updated_at" : "2016-05-13T20:06:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/219145456",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1047859?v=3",
         "events_url" : "https://api.github.com/users/kazcw/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kazcw/followers",
         "following_url" : "https://api.github.com/users/kazcw/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kazcw/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kazcw",
         "id" : 1047859,
         "login" : "kazcw",
         "organizations_url" : "https://api.github.com/users/kazcw/orgs",
         "received_events_url" : "https://api.github.com/users/kazcw/received_events",
         "repos_url" : "https://api.github.com/users/kazcw/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kazcw/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kazcw/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kazcw"
      }
   },
   {
      "body" : "I tried with HTTP_TIMEOUT=1, and walletbackup.py still works fine.",
      "created_at" : "2016-05-15T06:31:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8052#issuecomment-219269140",
      "id" : 219269140,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8052",
      "updated_at" : "2016-05-15T06:31:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/219269140",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "This is the error (after `INFO: Restoring using dumped wallet`):\r\n\r\n    Unexpected exception caught during testing: timeout('timed out',)\r\n      File \"/bitcoin/qa/rpc-tests/test_framework/test_framework.py\", line 138, in main\r\n        self.run_test()\r\n      File \"./walletbackup.py\", line 188, in run_test\r\n        self.nodes[0].importwallet(tmpdir + \"/node0/wallet.dump\")\r\n      File \"/bitcoin/qa/rpc-tests/test_framework/coverage.py\", line 49, in __call__\r\n        return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\r\n      File \"/bitcoin/qa/rpc-tests/test_framework/authproxy.py\", line 137, in __call__\r\n        response = self._request('POST', self.__url.path, postdata)\r\n      File \"/bitcoin/qa/rpc-tests/test_framework/authproxy.py\", line 119, in _request\r\n        return self._get_response()\r\n      File \"/bitcoin/qa/rpc-tests/test_framework/authproxy.py\", line 152, in _get_response\r\n        http_response = self.__conn.getresponse()\r\n      File \"/usr/lib64/python3.4/http/client.py\", line 1171, in getresponse\r\n        response.begin()\r\n      File \"/usr/lib64/python3.4/http/client.py\", line 351, in begin\r\n        version, status, reason = self._read_status()\r\n      File \"/usr/lib64/python3.4/http/client.py\", line 313, in _read_status\r\n        line = str(self.fp.readline(_MAXLINE + 1), \"iso-8859-1\")\r\n      File \"/usr/lib64/python3.4/socket.py\", line 374, in readinto\r\n        return self._sock.recv_into(b)\r\n    Stopping nodes\r\n    WARN: Unable to stop node: CannotSendRequest('Request-sent',)\r\n\r\nIt doesn't happen often when my machine is otherwise idle; I looped the test for several hours (originally trying to reproduce the other bug) and got two failures. With the machine under heavy load it happens consistently (all failures look just like the above backtrace).\r\n\r\nWhen I set `HTTP_TIMEOUT=1` it fails in an earlier `recv_into` (in various rpc calls).",
      "created_at" : "2016-05-15T15:17:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8052#issuecomment-219291658",
      "id" : 219291658,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8052",
      "updated_at" : "2016-05-15T15:17:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/219291658",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1047859?v=3",
         "events_url" : "https://api.github.com/users/kazcw/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kazcw/followers",
         "following_url" : "https://api.github.com/users/kazcw/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kazcw/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kazcw",
         "id" : 1047859,
         "login" : "kazcw",
         "organizations_url" : "https://api.github.com/users/kazcw/orgs",
         "received_events_url" : "https://api.github.com/users/kazcw/received_events",
         "repos_url" : "https://api.github.com/users/kazcw/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kazcw/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kazcw/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kazcw"
      }
   },
   {
      "body" : "As this doesn't fix the issue, we should probably close it?\r\n\r\nIf we need this I'd prefer to not change the default value in `authproxy.py` but supply a different timeout where the object is created instead.",
      "created_at" : "2016-05-31T13:49:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8052#issuecomment-222693840",
      "id" : 222693840,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8052",
      "updated_at" : "2016-05-31T13:50:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/222693840",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
