[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Have you tried RPC whitelists? https://github.com/bitcoin/bitcoin/pull/12763",
      "created_at" : "2022-06-03T02:12:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/25270#issuecomment-1145519208",
      "id" : 1145519208,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25270",
      "node_id" : "IC_kwDOABII585ERzxo",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1145519208/reactions"
      },
      "updated_at" : "2022-06-03T02:12:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1145519208",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/94559964?v=4",
         "events_url" : "https://api.github.com/users/1440000bytes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/1440000bytes/followers",
         "following_url" : "https://api.github.com/users/1440000bytes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/1440000bytes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/1440000bytes",
         "id" : 94559964,
         "login" : "1440000bytes",
         "node_id" : "U_kgDOBaLe3A",
         "organizations_url" : "https://api.github.com/users/1440000bytes/orgs",
         "received_events_url" : "https://api.github.com/users/1440000bytes/received_events",
         "repos_url" : "https://api.github.com/users/1440000bytes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/1440000bytes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/1440000bytes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/1440000bytes"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> Have you tried RPC whitelists? #12763\r\n\r\nWhitelists use rpcauth which sends the password in clear text to the server https://github.com/bitcoin/bitcoin/blob/0de36941eca1bff91420dd878eb097db2b1a596c/src/httprpc.cpp#L130\r\n\r\nThis unlike the cookie file is not resilient to [server spoofing attack](https://github.com/Kixunil/security_writings/blob/master/cookie_files.md). Basically if my grafana Linux user gets compromised then it can get the password for every bitcoin RPC user. \r\n\r\n\r\nIn my case both RPC users have a wide variety of methods that need to be available, so locking down with rpc whitelists would not help much. I would not choose that over keeping random users out.  \r\n\r\n\r\n",
      "created_at" : "2022-06-03T05:07:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/25270#issuecomment-1145588814",
      "id" : 1145588814,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25270",
      "node_id" : "IC_kwDOABII585ESExO",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1145588814/reactions"
      },
      "updated_at" : "2022-06-03T05:42:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1145588814",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/64738?v=4",
         "events_url" : "https://api.github.com/users/alevchuk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/alevchuk/followers",
         "following_url" : "https://api.github.com/users/alevchuk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/alevchuk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/alevchuk",
         "id" : 64738,
         "login" : "alevchuk",
         "node_id" : "MDQ6VXNlcjY0NzM4",
         "organizations_url" : "https://api.github.com/users/alevchuk/orgs",
         "received_events_url" : "https://api.github.com/users/alevchuk/received_events",
         "repos_url" : "https://api.github.com/users/alevchuk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/alevchuk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/alevchuk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/alevchuk"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Agree it would be useful to set permissions on the cookie file, and this would be a simple feature to implement. But I don't think it would be right to say rpcauth is less secure than cookie auth.\r\n\r\nThe main advantage cookies have over RPC passwords is just their convenience. Other than being generated randomly each restart, they don't provide extra security. You could write a script to randomly generate new passwords for grafana each time bitcoin is restarted to get the same effect as using a cookie.\r\n\r\nRPC passwords also have an advantage over cookies because they are hashed. So if an attacker manages to get read access to the bitcoin directory, they can't easily use password hashes to connect to the server, while they could straightforwardly use the cookie file to connect.\r\n\r\nAlso it looks like depending on your setup you may be able control permissions of the cookie file in current versions of bitcoind by running `umask 0027` and passing `-sysperms` argument.",
      "created_at" : "2022-06-03T17:12:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/25270#issuecomment-1146189581",
      "id" : 1146189581,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25270",
      "node_id" : "IC_kwDOABII585EUXcN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1146189581/reactions"
      },
      "updated_at" : "2022-06-03T17:12:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1146189581",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I agree this would be nice to have. I personally use ACLs to achieve the same.",
      "created_at" : "2022-06-06T12:25:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/25270#issuecomment-1147391767",
      "id" : 1147391767,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25270",
      "node_id" : "IC_kwDOABII585EY88X",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1147391767/reactions"
      },
      "updated_at" : "2022-06-06T12:25:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1147391767",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "In RaspiBolt we use `-startupnotify=\"chmod g+r /home/bitcoin/.bitcoin/.cookie\"`, to add group permission after RPC cookie file is created. https://github.com/raspibolt/raspibolt/pull/846",
      "created_at" : "2022-06-08T15:10:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/25270#issuecomment-1150049416",
      "id" : 1150049416,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25270",
      "node_id" : "IC_kwDOABII585EjFyI",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 3,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 3,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1150049416/reactions"
      },
      "updated_at" : "2022-06-08T15:10:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1150049416",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4500994?v=4",
         "events_url" : "https://api.github.com/users/kristapsk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kristapsk/followers",
         "following_url" : "https://api.github.com/users/kristapsk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kristapsk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kristapsk",
         "id" : 4500994,
         "login" : "kristapsk",
         "node_id" : "MDQ6VXNlcjQ1MDA5OTQ=",
         "organizations_url" : "https://api.github.com/users/kristapsk/orgs",
         "received_events_url" : "https://api.github.com/users/kristapsk/received_events",
         "repos_url" : "https://api.github.com/users/kristapsk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kristapsk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kristapsk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kristapsk"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> In RaspiBolt we use `-startupnotify=\"chmod g+r /home/bitcoin/.bitcoin/.cookie\"`, to add group permission after RPC cookie file is created. [raspibolt/raspibolt#846](https://github.com/raspibolt/raspibolt/pull/846)\r\n\r\nThanks! \r\n\r\nThis is evidence that everyone is going to implement this in many different ways. All of which will be more complex and less audited than bitcoin choosing the right permissions when creating the file.\r\n\r\n>  I bet more people will have to re-invent this wheel as the cookie file gets wider adoption.",
      "created_at" : "2022-06-08T15:30:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/25270#issuecomment-1150072646",
      "id" : 1150072646,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25270",
      "node_id" : "IC_kwDOABII585EjLdG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1150072646/reactions"
      },
      "updated_at" : "2022-06-08T15:30:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1150072646",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/64738?v=4",
         "events_url" : "https://api.github.com/users/alevchuk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/alevchuk/followers",
         "following_url" : "https://api.github.com/users/alevchuk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/alevchuk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/alevchuk",
         "id" : 64738,
         "login" : "alevchuk",
         "node_id" : "MDQ6VXNlcjY0NzM4",
         "organizations_url" : "https://api.github.com/users/alevchuk/orgs",
         "received_events_url" : "https://api.github.com/users/alevchuk/received_events",
         "repos_url" : "https://api.github.com/users/alevchuk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/alevchuk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/alevchuk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/alevchuk"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I'll be using the @kristapsk solution as well, but I'd love for a 'cookie_umask' option or something to be added.",
      "created_at" : "2022-07-25T12:13:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/25270#issuecomment-1193971394",
      "id" : 1193971394,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25270",
      "node_id" : "IC_kwDOABII585HKo7C",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1193971394/reactions"
      },
      "updated_at" : "2022-07-25T12:13:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1193971394",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6089867?v=4",
         "events_url" : "https://api.github.com/users/lsunsi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/lsunsi/followers",
         "following_url" : "https://api.github.com/users/lsunsi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/lsunsi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/lsunsi",
         "id" : 6089867,
         "login" : "lsunsi",
         "node_id" : "MDQ6VXNlcjYwODk4Njc=",
         "organizations_url" : "https://api.github.com/users/lsunsi/orgs",
         "received_events_url" : "https://api.github.com/users/lsunsi/received_events",
         "repos_url" : "https://api.github.com/users/lsunsi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/lsunsi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/lsunsi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/lsunsi"
      }
   }
]
