[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [darosior](https://github.com/bitcoin/bitcoin/pull/25273#pullrequestreview-1354216199), [theStack](https://github.com/bitcoin/bitcoin/pull/25273#pullrequestreview-1411318920), [josibake](https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1743385349) |\n| Stale ACK | [furszy](https://github.com/bitcoin/bitcoin/pull/25273#pullrequestreview-1346792373) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#bitcoin-core/gui/733](https://github.com/bitcoin-core/gui/pull/733) (Deniability - a tool to automatically improve coin ownership privacy by denavila)\n* [#28453](https://github.com/bitcoin/bitcoin/pull/28453) (wallet: Receive silent payment transactions by achow101)\n* [#27865](https://github.com/bitcoin/bitcoin/pull/27865) (wallet: Track no-longer-spendable TXOs separately by achow101)\n* [#27792](https://github.com/bitcoin/bitcoin/pull/27792) (wallet: Deniability API (Unilateral Transaction Meta-Privacy) by denavila)\n* [#27286](https://github.com/bitcoin/bitcoin/pull/27286) (wallet: Keep track of the wallet's own transaction outputs in memory by achow101)\n* [#26902](https://github.com/bitcoin/bitcoin/pull/26902) (wallet: do not backdate locktime if it may lead to fingerprinting by rodentrabies)\n* [#24128](https://github.com/bitcoin/bitcoin/pull/24128) (wallet: BIP 326 sequence based anti-fee-snipe for taproot inputs by MarcoFalke)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2022-06-04T00:47:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1146481423",
      "id" : 1146481423,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
      "node_id" : "IC_kwDOABII585EVesP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1146481423/reactions"
      },
      "updated_at" : "2023-10-02T16:51:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1146481423",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r892703667"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/892703667"
         }
      },
      "author_association" : "MEMBER",
      "body" : "maybe inline?\r\n```suggestion\r\nif (it == m_selected.end() || !it->second.HasTxOut())) {\r\n    return false;\r\n}\r\n```",
      "commit_id" : "91e6fad8b1fd9a88db1b5d785b4ecba95a622068",
      "created_at" : "2022-06-08T18:00:30Z",
      "diff_hunk" : "@@ -66,77 +92,85 @@ class CCoinControl\n \n     bool HasSelected() const\n     {\n-        return (setSelected.size() > 0);\n+        return (m_selected.size() > 0);\n     }\n \n     bool IsSelected(const COutPoint& output) const\n     {\n-        return (setSelected.count(output) > 0);\n+        return (m_selected.count(output) > 0);\n     }\n \n     bool IsExternalSelected(const COutPoint& output) const\n     {\n-        return (m_external_txouts.count(output) > 0);\n+        const auto it = m_selected.find(output);\n+        if (it == m_selected.end()) {\n+            return false;\n+        }\n+        return it->second.HasTxOut();\n     }\n \n     bool GetExternalOutput(const COutPoint& outpoint, CTxOut& txout) const\n     {\n-        const auto ext_it = m_external_txouts.find(outpoint);\n-        if (ext_it == m_external_txouts.end()) {\n+        const auto it = m_selected.find(outpoint);\n+        if (it == m_selected.end()) {\n             return false;\n         }\n-        txout = ext_it->second;\n+        if (!it->second.HasTxOut()) {\n+            return false;\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r892703667",
      "id" : 892703667,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5841NZOz",
      "original_commit_id" : "99bd2a643d230ee2ce91b1d7a337d91386adb98a",
      "original_line" : 155,
      "original_position" : 68,
      "original_start_line" : 115,
      "path" : "src/wallet/coincontrol.h",
      "position" : null,
      "pull_request_review_id" : 1000211304,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/892703667/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2023-01-22T15:08:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/892703667",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-06-16T19:42:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1158065891",
      "id" : 1158065891,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
      "node_id" : "IC_kwDOABII585FBq7j",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1158065891/reactions"
      },
      "updated_at" : "2022-06-16T19:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1158065891",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r900971740"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/900971740"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Since this can never return a nullopt (errors throw), maybe just return `CreatedTransactionResult`?",
      "commit_id" : "664f7430478592fc89b7c2fdc423b7a649bc6c27",
      "created_at" : "2022-06-18T15:43:42Z",
      "diff_hunk" : "@@ -488,13 +487,13 @@ static std::vector<RPCArg> FundTxDoc(bool solving_data = true)\n     return args;\n }\n \n-void FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& fee_out, int& change_position, const UniValue& options, CCoinControl& coinControl, bool override_min_fee)\n+std::optional<CreatedTransactionResult> FundTransaction(CWallet& wallet, const CMutableTransaction& tx, const UniValue& options, CCoinControl& coinControl, bool override_min_fee)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r900971740",
      "id" : 900971740,
      "line" : 490,
      "node_id" : "PRRC_kwDOABII5841s7zc",
      "original_commit_id" : "664f7430478592fc89b7c2fdc423b7a649bc6c27",
      "original_line" : 490,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/spend.cpp",
      "position" : 17,
      "pull_request_review_id" : 1011430105,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/900971740/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-18T15:43:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/900971740",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">Lastly, instead of using -1 as a magic number for the change output position, the change position is changed to be an optional with no value set indicating no desired change output position (when provided as an input parameter) or no change output present (in the result).\r\n\r\nI'm not sure this is an improvement. It just adds complexity, for no benefit in this particular instance?",
      "created_at" : "2022-06-18T15:48:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1159486874",
      "id" : 1159486874,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
      "node_id" : "IC_kwDOABII585FHF2a",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1159486874/reactions"
      },
      "updated_at" : "2022-06-18T15:48:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1159486874",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r900979687"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/900979687"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think it would be better to return the `PreselectedInput` and have the caller use `SetSequence` etc directly.",
      "commit_id" : "664f7430478592fc89b7c2fdc423b7a649bc6c27",
      "created_at" : "2022-06-18T15:55:02Z",
      "diff_hunk" : "@@ -61,82 +128,153 @@ class CCoinControl\n     int m_max_depth = DEFAULT_MAX_DEPTH;\n     //! SigningProvider that has pubkeys and scripts to do spend size estimation for external inputs\n     FlatSigningProvider m_external_provider;\n+    //! Locktime\n+    std::optional<uint32_t> m_locktime;\n+    //! Version\n+    std::optional<uint32_t> m_version;\n \n     CCoinControl();\n \n     bool HasSelected() const\n     {\n-        return (setSelected.size() > 0);\n+        return (m_selected.size() > 0);\n     }\n \n     bool IsSelected(const COutPoint& output) const\n     {\n-        return (setSelected.count(output) > 0);\n+        return (m_selected.count(output) > 0);\n     }\n \n     bool IsExternalSelected(const COutPoint& output) const\n     {\n-        return (m_external_txouts.count(output) > 0);\n+        const auto it = m_selected.find(output);\n+        if (it == m_selected.end()) {\n+            return false;\n+        }\n+        return it->second.HasTxOut();\n     }\n \n     bool GetExternalOutput(const COutPoint& outpoint, CTxOut& txout) const\n     {\n-        const auto ext_it = m_external_txouts.find(outpoint);\n-        if (ext_it == m_external_txouts.end()) {\n+        const auto it = m_selected.find(outpoint);\n+        if (it == m_selected.end()) {\n+            return false;\n+        }\n+        if (!it->second.HasTxOut()) {\n             return false;\n         }\n-        txout = ext_it->second;\n+        txout = it->second.GetTxOut();\n         return true;\n     }\n \n-    void Select(const COutPoint& output)\n+    void Select(const COutPoint& output, std::optional<uint32_t> sequence = std::nullopt, std::optional<CScript> script_sig = std::nullopt, std::optional<CScriptWitness> script_witness = std::nullopt)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r900979687",
      "id" : 900979687,
      "line" : 170,
      "node_id" : "PRRC_kwDOABII5841s9vn",
      "original_commit_id" : "664f7430478592fc89b7c2fdc423b7a649bc6c27",
      "original_line" : 170,
      "original_position" : 124,
      "original_start_line" : null,
      "path" : "src/wallet/coincontrol.h",
      "position" : 124,
      "pull_request_review_id" : 1011430920,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/900979687/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-18T15:55:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/900979687",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r900983932"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/900983932"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why not? As long as one input has a non-final sequence, it should still work.\r\n\r\n(`DiscourageFeeSniping` would need its sanity checks adjusted to tolerate it, though)",
      "commit_id" : "664f7430478592fc89b7c2fdc423b7a649bc6c27",
      "created_at" : "2022-06-18T16:00:58Z",
      "diff_hunk" : "@@ -832,11 +845,33 @@ static std::optional<CreatedTransactionResult> CreateTransactionInternal(\n     // to avoid conflicting with other possible uses of nSequence,\n     // and in the spirit of \"smallest possible change from prior\n     // behavior.\"\n-    const uint32_t nSequence{coin_control.m_signal_bip125_rbf.value_or(wallet.m_signal_rbf) ? MAX_BIP125_RBF_SEQUENCE : CTxIn::MAX_SEQUENCE_NONFINAL};\n+    bool use_anti_fee_sniping = true;\n+    const uint32_t default_sequence{coin_control.m_signal_bip125_rbf.value_or(wallet.m_signal_rbf) ? MAX_BIP125_RBF_SEQUENCE : CTxIn::MAX_SEQUENCE_NONFINAL};\n     for (const auto& coin : selected_coins) {\n-        txNew.vin.push_back(CTxIn(coin.outpoint, CScript(), nSequence));\n+        uint32_t sequence = default_sequence;\n+        if (coin_control.HasSequence(coin.outpoint)) {\n+            sequence = coin_control.GetSequence(coin.outpoint);\n+            // If an input as a preset sequence, we can't do anti-fee-sniping",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r900983932",
      "id" : 900983932,
      "line" : 854,
      "node_id" : "PRRC_kwDOABII5841s-x8",
      "original_commit_id" : "664f7430478592fc89b7c2fdc423b7a649bc6c27",
      "original_line" : 854,
      "original_position" : 75,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 75,
      "pull_request_review_id" : 1011431317,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/900983932/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-18T16:00:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/900983932",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "```\r\nSUMMARY: MemorySanitizer: use-of-uninitialized-value src/wallet/spend.cpp:1025:5 in wallet::CreateTransaction(wallet::CWallet&, std::__1::vector<wallet::CRecipient, std::__1::allocator<wallet::CRecipient> > const&, std::__1::optional<unsigned int>, bilingual_str&, wallet::CCoinControl const&, FeeCalculation&, bool)",
      "created_at" : "2022-06-18T16:14:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1159490903",
      "id" : 1159490903,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
      "node_id" : "IC_kwDOABII585FHG1X",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1159490903/reactions"
      },
      "updated_at" : "2022-06-18T16:14:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1159490903",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r901781440"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901781440"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is to retain the current behavior. The next step in a followup is to allow anti-fee-sniping and modify `DiscourageFeeSniping` to consider the preset sequences.",
      "commit_id" : "5e19bce9458d4dbeb20a78905ec546decad2efa8",
      "created_at" : "2022-06-20T15:13:05Z",
      "diff_hunk" : "@@ -832,11 +845,33 @@ static std::optional<CreatedTransactionResult> CreateTransactionInternal(\n     // to avoid conflicting with other possible uses of nSequence,\n     // and in the spirit of \"smallest possible change from prior\n     // behavior.\"\n-    const uint32_t nSequence{coin_control.m_signal_bip125_rbf.value_or(wallet.m_signal_rbf) ? MAX_BIP125_RBF_SEQUENCE : CTxIn::MAX_SEQUENCE_NONFINAL};\n+    bool use_anti_fee_sniping = true;\n+    const uint32_t default_sequence{coin_control.m_signal_bip125_rbf.value_or(wallet.m_signal_rbf) ? MAX_BIP125_RBF_SEQUENCE : CTxIn::MAX_SEQUENCE_NONFINAL};\n     for (const auto& coin : selected_coins) {\n-        txNew.vin.push_back(CTxIn(coin.outpoint, CScript(), nSequence));\n+        uint32_t sequence = default_sequence;\n+        if (coin_control.HasSequence(coin.outpoint)) {\n+            sequence = coin_control.GetSequence(coin.outpoint);\n+            // If an input as a preset sequence, we can't do anti-fee-sniping",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r901781440",
      "id" : 901781440,
      "in_reply_to_id" : 900983932,
      "line" : 854,
      "node_id" : "PRRC_kwDOABII5841wBfA",
      "original_commit_id" : "664f7430478592fc89b7c2fdc423b7a649bc6c27",
      "original_line" : 854,
      "original_position" : 75,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 75,
      "pull_request_review_id" : 1012445513,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901781440/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-20T15:13:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901781440",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r901886622"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901886622"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "5e19bce9458d4dbeb20a78905ec546decad2efa8",
      "created_at" : "2022-06-20T17:37:18Z",
      "diff_hunk" : "@@ -488,13 +487,13 @@ static std::vector<RPCArg> FundTxDoc(bool solving_data = true)\n     return args;\n }\n \n-void FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& fee_out, int& change_position, const UniValue& options, CCoinControl& coinControl, bool override_min_fee)\n+std::optional<CreatedTransactionResult> FundTransaction(CWallet& wallet, const CMutableTransaction& tx, const UniValue& options, CCoinControl& coinControl, bool override_min_fee)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r901886622",
      "id" : 901886622,
      "in_reply_to_id" : 900971740,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5841wbKe",
      "original_commit_id" : "664f7430478592fc89b7c2fdc423b7a649bc6c27",
      "original_line" : 490,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/spend.cpp",
      "position" : null,
      "pull_request_review_id" : 1012589713,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901886622/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-20T17:37:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901886622",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r901886659"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901886659"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "5e19bce9458d4dbeb20a78905ec546decad2efa8",
      "created_at" : "2022-06-20T17:37:23Z",
      "diff_hunk" : "@@ -61,82 +128,153 @@ class CCoinControl\n     int m_max_depth = DEFAULT_MAX_DEPTH;\n     //! SigningProvider that has pubkeys and scripts to do spend size estimation for external inputs\n     FlatSigningProvider m_external_provider;\n+    //! Locktime\n+    std::optional<uint32_t> m_locktime;\n+    //! Version\n+    std::optional<uint32_t> m_version;\n \n     CCoinControl();\n \n     bool HasSelected() const\n     {\n-        return (setSelected.size() > 0);\n+        return (m_selected.size() > 0);\n     }\n \n     bool IsSelected(const COutPoint& output) const\n     {\n-        return (setSelected.count(output) > 0);\n+        return (m_selected.count(output) > 0);\n     }\n \n     bool IsExternalSelected(const COutPoint& output) const\n     {\n-        return (m_external_txouts.count(output) > 0);\n+        const auto it = m_selected.find(output);\n+        if (it == m_selected.end()) {\n+            return false;\n+        }\n+        return it->second.HasTxOut();\n     }\n \n     bool GetExternalOutput(const COutPoint& outpoint, CTxOut& txout) const\n     {\n-        const auto ext_it = m_external_txouts.find(outpoint);\n-        if (ext_it == m_external_txouts.end()) {\n+        const auto it = m_selected.find(outpoint);\n+        if (it == m_selected.end()) {\n+            return false;\n+        }\n+        if (!it->second.HasTxOut()) {\n             return false;\n         }\n-        txout = ext_it->second;\n+        txout = it->second.GetTxOut();\n         return true;\n     }\n \n-    void Select(const COutPoint& output)\n+    void Select(const COutPoint& output, std::optional<uint32_t> sequence = std::nullopt, std::optional<CScript> script_sig = std::nullopt, std::optional<CScriptWitness> script_witness = std::nullopt)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r901886659",
      "id" : 901886659,
      "in_reply_to_id" : 900979687,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5841wbLD",
      "original_commit_id" : "664f7430478592fc89b7c2fdc423b7a649bc6c27",
      "original_line" : 170,
      "original_position" : 124,
      "original_start_line" : null,
      "path" : "src/wallet/coincontrol.h",
      "position" : null,
      "pull_request_review_id" : 1012589768,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901886659/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-20T17:37:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901886659",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> > Lastly, instead of using -1 as a magic number for the change output position, the change position is changed to be an optional with no value set indicating no desired change output position (when provided as an input parameter) or no change output present (in the result).\r\n> \r\n> I'm not sure this is an improvement. It just adds complexity, for no benefit in this particular instance?\r\n\r\nIMO it makes it easier to understand.\r\n\r\n> ```\r\n> SUMMARY: MemorySanitizer: use-of-uninitialized-value src/wallet/spend.cpp:1025:5 in wallet::CreateTransaction(wallet::CWallet&, std::__1::vector<wallet::CRecipient, std::__1::allocator<wallet::CRecipient> > const&, std::__1::optional<unsigned int>, bilingual_str&, wallet::CCoinControl const&, FeeCalculation&, bool)\r\n> ```\r\n\r\nI think I've fixed this.",
      "created_at" : "2022-06-20T17:38:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1160699318",
      "id" : 1160699318,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
      "node_id" : "IC_kwDOABII585FLt22",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1160699318/reactions"
      },
      "updated_at" : "2022-06-20T17:38:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1160699318",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-06-20T19:53:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1160797231",
      "id" : 1160797231,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
      "node_id" : "IC_kwDOABII585FMFwv",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1160797231/reactions"
      },
      "updated_at" : "2022-06-20T19:53:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1160797231",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r901991220"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901991220"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Where is this behaviour in the current logic? I thought presently it would do the anti-sniping, and then possibly (at worst) have that partially \"broken\" by subsequent changes?",
      "commit_id" : "5e19bce9458d4dbeb20a78905ec546decad2efa8",
      "created_at" : "2022-06-20T20:48:02Z",
      "diff_hunk" : "@@ -832,11 +845,33 @@ static std::optional<CreatedTransactionResult> CreateTransactionInternal(\n     // to avoid conflicting with other possible uses of nSequence,\n     // and in the spirit of \"smallest possible change from prior\n     // behavior.\"\n-    const uint32_t nSequence{coin_control.m_signal_bip125_rbf.value_or(wallet.m_signal_rbf) ? MAX_BIP125_RBF_SEQUENCE : CTxIn::MAX_SEQUENCE_NONFINAL};\n+    bool use_anti_fee_sniping = true;\n+    const uint32_t default_sequence{coin_control.m_signal_bip125_rbf.value_or(wallet.m_signal_rbf) ? MAX_BIP125_RBF_SEQUENCE : CTxIn::MAX_SEQUENCE_NONFINAL};\n     for (const auto& coin : selected_coins) {\n-        txNew.vin.push_back(CTxIn(coin.outpoint, CScript(), nSequence));\n+        uint32_t sequence = default_sequence;\n+        if (coin_control.HasSequence(coin.outpoint)) {\n+            sequence = coin_control.GetSequence(coin.outpoint);\n+            // If an input as a preset sequence, we can't do anti-fee-sniping",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r901991220",
      "id" : 901991220,
      "in_reply_to_id" : 900983932,
      "line" : 854,
      "node_id" : "PRRC_kwDOABII5841w0s0",
      "original_commit_id" : "664f7430478592fc89b7c2fdc423b7a649bc6c27",
      "original_line" : 854,
      "original_position" : 75,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 75,
      "pull_request_review_id" : 1012736964,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901991220/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-20T20:48:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901991220",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r902007567"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/902007567"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's more of a side effect of `FundTransaction` rather than explicit behavior. Currently, having preset sequences inherently means a preset locktime which would disable anti-fee-sniping. This is just due to how `FundTransaction` works, and `FundTransaction` is the only way that preset sequences can even be provided.\r\n\r\nUntil we update `DiscourageFeeSniping` to handle preset sequences and locktime, I would prefer that we have this check explicitly just to avoid any problems in the future with how and when preset sequences and locktimes can be set.",
      "commit_id" : "5e19bce9458d4dbeb20a78905ec546decad2efa8",
      "created_at" : "2022-06-20T21:29:39Z",
      "diff_hunk" : "@@ -832,11 +845,33 @@ static std::optional<CreatedTransactionResult> CreateTransactionInternal(\n     // to avoid conflicting with other possible uses of nSequence,\n     // and in the spirit of \"smallest possible change from prior\n     // behavior.\"\n-    const uint32_t nSequence{coin_control.m_signal_bip125_rbf.value_or(wallet.m_signal_rbf) ? MAX_BIP125_RBF_SEQUENCE : CTxIn::MAX_SEQUENCE_NONFINAL};\n+    bool use_anti_fee_sniping = true;\n+    const uint32_t default_sequence{coin_control.m_signal_bip125_rbf.value_or(wallet.m_signal_rbf) ? MAX_BIP125_RBF_SEQUENCE : CTxIn::MAX_SEQUENCE_NONFINAL};\n     for (const auto& coin : selected_coins) {\n-        txNew.vin.push_back(CTxIn(coin.outpoint, CScript(), nSequence));\n+        uint32_t sequence = default_sequence;\n+        if (coin_control.HasSequence(coin.outpoint)) {\n+            sequence = coin_control.GetSequence(coin.outpoint);\n+            // If an input as a preset sequence, we can't do anti-fee-sniping",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r902007567",
      "id" : 902007567,
      "in_reply_to_id" : 900983932,
      "line" : 854,
      "node_id" : "PRRC_kwDOABII5841w4sP",
      "original_commit_id" : "664f7430478592fc89b7c2fdc423b7a649bc6c27",
      "original_line" : 854,
      "original_position" : 75,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 75,
      "pull_request_review_id" : 1012759867,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/902007567/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-20T21:29:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/902007567",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "There is also a lint issue with trailing whitespace or so?",
      "created_at" : "2022-06-21T05:42:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1161289683",
      "id" : 1161289683,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
      "node_id" : "IC_kwDOABII585FN9_T",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1161289683/reactions"
      },
      "updated_at" : "2022-06-21T05:42:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1161289683",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-07-12T13:15:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1181747630",
      "id" : 1181747630,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
      "node_id" : "IC_kwDOABII585GcAmu",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181747630/reactions"
      },
      "updated_at" : "2022-07-12T13:15:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181747630",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-08-05T13:56:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1206486864",
      "id" : 1206486864,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
      "node_id" : "IC_kwDOABII585H6YdQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1206486864/reactions"
      },
      "updated_at" : "2022-08-05T13:56:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1206486864",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-08-19T09:23:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1220453523",
      "id" : 1220453523,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
      "node_id" : "IC_kwDOABII585IvqST",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1220453523/reactions"
      },
      "updated_at" : "2022-08-19T09:23:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1220453523",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-08-22T16:56:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1222637572",
      "id" : 1222637572,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
      "node_id" : "IC_kwDOABII585I3_gE",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1222637572/reactions"
      },
      "updated_at" : "2022-08-22T16:56:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1222637572",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1025583116"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1025583116"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 9aab806b:\r\n\r\nsounds like this could be unified and return an optional<uint32_t> so double lookups aren't needed (e.g. force callers to always call `HasSequence` first then `GetSequence`).",
      "commit_id" : "91e6fad8b1fd9a88db1b5d785b4ecba95a622068",
      "created_at" : "2022-11-17T18:57:45Z",
      "diff_hunk" : "@@ -163,6 +173,20 @@ class CCoinControl\n         return m_selected.at(outpoint).GetInputWeight();\n     }\n \n+    bool HasSequence(const COutPoint& outpoint) const\n+    {\n+        const auto it = m_selected.find(outpoint);\n+        if (it == m_selected.end()) {\n+            return false;\n+        }\n+        return it->second.HasSequence();\n+    }\n+\n+    uint32_t GetSequence(const COutPoint& outpoint) const\n+    {\n+        return m_selected.at(outpoint).GetSequence();\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1025583116",
      "id" : 1025583116,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5849ISgM",
      "original_commit_id" : "bd979e2b140e7e3d79ff007b8077ff16e8eda5d6",
      "original_line" : 206,
      "original_position" : 40,
      "original_start_line" : 176,
      "path" : "src/wallet/coincontrol.h",
      "position" : null,
      "pull_request_review_id" : 1000211304,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1025583116/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2023-01-22T15:08:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1025583116",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2022-12-06T11:33:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1339186522",
      "id" : 1339186522,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
      "node_id" : "IC_kwDOABII585P0l1a",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1339186522/reactions"
      },
      "updated_at" : "2022-12-06T11:33:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1339186522",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2022-12-10T10:22:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1345231802",
      "id" : 1345231802,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
      "node_id" : "IC_kwDOABII585QLpu6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1345231802/reactions"
      },
      "updated_at" : "2022-12-10T10:22:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1345231802",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-01-03T18:09:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1370077193",
      "id" : 1370077193,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
      "node_id" : "IC_kwDOABII585RqbgJ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1370077193/reactions"
      },
      "updated_at" : "2023-01-03T18:09:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1370077193",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1083460232"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083460232"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 65550f8a:\r\n\r\nnit: could replace the inner if/else for\r\n```c++\r\nif (!wallet.IsMine(outPoint)) {\r\n    if (coins[outPoint].out.IsNull()) {\r\n        error = _(\"Unable to find UTXO for external input\");\r\n        return false;\r\n    }\r\n\r\n    // The input was not in the wallet, but is in the UTXO set, so select as external\r\n    preset_txin.SetTxOut(coins[outPoint].out);\r\n}\r\n```",
      "commit_id" : "91e6fad8b1fd9a88db1b5d785b4ecba95a622068",
      "created_at" : "2023-01-22T14:06:31Z",
      "diff_hunk" : "@@ -1136,15 +1136,15 @@ bool FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& nFeeRet,\n \n     for (const CTxIn& txin : tx.vin) {\n         const auto& outPoint = txin.prevout;\n-        if (wallet.IsMine(outPoint)) {\n-            // The input was found in the wallet, so select as internal\n-            coinControl.Select(outPoint);\n-        } else if (coins[outPoint].out.IsNull()) {\n-            error = _(\"Unable to find UTXO for external input\");\n-            return false;\n-        } else {\n-            // The input was not in the wallet, but is in the UTXO set, so select as external\n-            coinControl.SelectExternal(outPoint, coins[outPoint].out);\n+        PreselectedInput& preset_txin = coinControl.Select(outPoint);\n+        if (!wallet.IsMine(outPoint)) {\n+            if (!coins[outPoint].out.IsNull()) {\n+                // The input was not in the wallet, but is in the UTXO set, so select as external\n+                preset_txin.SetTxOut(coins[outPoint].out);\n+            } else {\n+                error = _(\"Unable to find UTXO for external input\");\n+                return false;\n+            }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1083460232",
      "id" : 1083460232,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585AlEqI",
      "original_commit_id" : "65550f8ac4a3bff8f31e5d918be83c0abfbd2457",
      "original_line" : 1187,
      "original_position" : 21,
      "original_start_line" : 1139,
      "path" : "src/wallet/spend.cpp",
      "position" : null,
      "pull_request_review_id" : 1000211304,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083460232/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2023-01-22T15:08:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083460232",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1083463841"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083463841"
         }
      },
      "author_association" : "MEMBER",
      "body" : "what about using this information inside `FetchSelectedInputs`, in the `input_bytes` size calculation too.",
      "commit_id" : "91e6fad8b1fd9a88db1b5d785b4ecba95a622068",
      "created_at" : "2023-01-22T14:25:56Z",
      "diff_hunk" : "@@ -961,7 +961,15 @@ static util::Result<CreatedTransactionResult> CreateTransactionInternal(\n             // If an input as a preset sequence, we can't do anti-fee-sniping\n             use_anti_fee_sniping = false;\n         }\n-        txNew.vin.push_back(CTxIn(coin.outpoint, CScript(), sequence));\n+        CScript script_sig;\n+        CScriptWitness script_witness;\n+        if (coin_control.HasScripts(coin.outpoint)) {\n+            auto [ss, sw] = coin_control.GetScripts(coin.outpoint);\n+            script_sig = ss;\n+            script_witness = sw;\n+        }\n+        txNew.vin.push_back(CTxIn(coin.outpoint, script_sig, sequence));\n+        txNew.vin.back().scriptWitness = script_witness;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1083463841",
      "id" : 1083463841,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585AlFih",
      "original_commit_id" : "187f2168a700e60739c09fb81c12593cfa894fb8",
      "original_line" : 984,
      "original_position" : 13,
      "original_start_line" : 966,
      "path" : "src/wallet/spend.cpp",
      "position" : null,
      "pull_request_review_id" : 1000211304,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083463841/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2023-01-22T15:08:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083463841",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1083468973"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083468973"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 6fb62218:\r\n\r\nThis removal doesn't seems to be related to the changes scope (the goal of the PR is keep inputs data). Would be good to add some context for it.\r\n\r\nIn a first glance, seems that keeping the original outputs value might be useful when you want to discard the fee calculation. Basically enable SFFO on all the outputs to not create a change output, then overwrite the returned outputs amounts with the original ones (maybe you are calling `fundrawtransaction` on different wallets and want to only calculate the fee on the last call).",
      "commit_id" : "91e6fad8b1fd9a88db1b5d785b4ecba95a622068",
      "created_at" : "2023-01-22T14:52:35Z",
      "diff_hunk" : "@@ -1188,47 +1188,25 @@ bool FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& nFeeRet,\n                 // The input was not in the wallet, but is in the UTXO set, so select as external\n                 preset_txin.SetTxOut(coins[outPoint].out);\n             } else {\n-                error = _(\"Unable to find UTXO for external input\");\n-                return false;\n+                return util::Error{_(\"Unable to find UTXO for external input\")};\n             }\n         }\n         preset_txin.SetSequence(txin.nSequence);\n         preset_txin.SetScriptSig(txin.scriptSig);\n         preset_txin.SetScriptWitness(txin.scriptWitness);\n     }\n \n-    auto res = CreateTransaction(wallet, vecSend, nChangePosInOut == -1 ? std::nullopt : std::optional<unsigned int>((unsigned int)nChangePosInOut), coinControl, false);\n+    auto res = CreateTransaction(wallet, vecSend, change_pos, coinControl, false);\n     if (!res) {\n-        error = util::ErrorString(res);\n-        return false;\n-    }\n-    const auto& txr = *res;\n-    CTransactionRef tx_new = txr.tx;\n-    nFeeRet = txr.fee;\n-    nChangePosInOut = txr.change_pos ? *txr.change_pos : -1;\n-\n-    if (nChangePosInOut != -1) {\n-        tx.vout.insert(tx.vout.begin() + nChangePosInOut, tx_new->vout[nChangePosInOut]);\n-    }\n-\n-    // Copy output sizes from new transaction; they may have had the fee\n-    // subtracted from them.\n-    for (unsigned int idx = 0; idx < tx.vout.size(); idx++) {\n-        tx.vout[idx].nValue = tx_new->vout[idx].nValue;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1083468973",
      "id" : 1083468973,
      "line" : 1168,
      "node_id" : "PRRC_kwDOABII585AlGyt",
      "original_commit_id" : "6fb622183a4d25fcdc03cbc4bcd30c77ff4ef635",
      "original_line" : 1168,
      "original_position" : 41,
      "original_start_line" : 1214,
      "path" : "src/wallet/spend.cpp",
      "position" : 272,
      "pull_request_review_id" : 1000211304,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083468973/reactions"
      },
      "side" : "LEFT",
      "start_line" : 1165,
      "start_side" : "LEFT",
      "updated_at" : "2023-01-22T15:08:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1083468973",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> How is enforced that `SignTransaction` doesn't overwrite the provided inputs' scriptsig and witness data?. It's called after setting the data and, as far as can see, it isn't skipping not empty inputs.\r\n\r\nIt will ignore inputs that have a valid scriptSig and witness. `SignTransaction` calls `DataFromTransaction` which will perform a `VerifyScript` of the existing data. If this is successful, it will mark that input as complete (sets `SignatureData.complete`) which `ProduceSignature` checks before it does anything else.",
      "created_at" : "2023-01-23T21:23:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1401000686",
      "id" : 1401000686,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
      "node_id" : "IC_kwDOABII585TgZLu",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1401000686/reactions"
      },
      "updated_at" : "2023-01-23T21:23:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1401000686",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1084603200"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084603200"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think you misunderstand what the original code was doing. It isn't preserving the original values, it's replacing the original values with the values that `CreateTransaction` produces. Originally `FundTransaction` is calling `CreateTranasction` and copying specific parts of the result into the original transaction and returning that modified original. The change I've made here is to just return the result of `CreateTransaction` directly, which matches the previous behavior because the earlier commits are preserving all of the components of the transaction that `FundTranasction` was preserving.",
      "commit_id" : "91e6fad8b1fd9a88db1b5d785b4ecba95a622068",
      "created_at" : "2023-01-23T21:51:54Z",
      "diff_hunk" : "@@ -1188,47 +1188,25 @@ bool FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& nFeeRet,\n                 // The input was not in the wallet, but is in the UTXO set, so select as external\n                 preset_txin.SetTxOut(coins[outPoint].out);\n             } else {\n-                error = _(\"Unable to find UTXO for external input\");\n-                return false;\n+                return util::Error{_(\"Unable to find UTXO for external input\")};\n             }\n         }\n         preset_txin.SetSequence(txin.nSequence);\n         preset_txin.SetScriptSig(txin.scriptSig);\n         preset_txin.SetScriptWitness(txin.scriptWitness);\n     }\n \n-    auto res = CreateTransaction(wallet, vecSend, nChangePosInOut == -1 ? std::nullopt : std::optional<unsigned int>((unsigned int)nChangePosInOut), coinControl, false);\n+    auto res = CreateTransaction(wallet, vecSend, change_pos, coinControl, false);\n     if (!res) {\n-        error = util::ErrorString(res);\n-        return false;\n-    }\n-    const auto& txr = *res;\n-    CTransactionRef tx_new = txr.tx;\n-    nFeeRet = txr.fee;\n-    nChangePosInOut = txr.change_pos ? *txr.change_pos : -1;\n-\n-    if (nChangePosInOut != -1) {\n-        tx.vout.insert(tx.vout.begin() + nChangePosInOut, tx_new->vout[nChangePosInOut]);\n-    }\n-\n-    // Copy output sizes from new transaction; they may have had the fee\n-    // subtracted from them.\n-    for (unsigned int idx = 0; idx < tx.vout.size(); idx++) {\n-        tx.vout[idx].nValue = tx_new->vout[idx].nValue;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1084603200",
      "id" : 1084603200,
      "in_reply_to_id" : 1083468973,
      "line" : 1168,
      "node_id" : "PRRC_kwDOABII585ApbtA",
      "original_commit_id" : "6fb622183a4d25fcdc03cbc4bcd30c77ff4ef635",
      "original_line" : 1168,
      "original_position" : 41,
      "original_start_line" : 1214,
      "path" : "src/wallet/spend.cpp",
      "position" : 272,
      "pull_request_review_id" : 1266411499,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084603200/reactions"
      },
      "side" : "LEFT",
      "start_line" : 1165,
      "start_side" : "LEFT",
      "updated_at" : "2023-01-23T21:51:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084603200",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1084630269"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084630269"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "91e6fad8b1fd9a88db1b5d785b4ecba95a622068",
      "created_at" : "2023-01-23T22:20:00Z",
      "diff_hunk" : "@@ -66,77 +92,85 @@ class CCoinControl\n \n     bool HasSelected() const\n     {\n-        return (setSelected.size() > 0);\n+        return (m_selected.size() > 0);\n     }\n \n     bool IsSelected(const COutPoint& output) const\n     {\n-        return (setSelected.count(output) > 0);\n+        return (m_selected.count(output) > 0);\n     }\n \n     bool IsExternalSelected(const COutPoint& output) const\n     {\n-        return (m_external_txouts.count(output) > 0);\n+        const auto it = m_selected.find(output);\n+        if (it == m_selected.end()) {\n+            return false;\n+        }\n+        return it->second.HasTxOut();\n     }\n \n     bool GetExternalOutput(const COutPoint& outpoint, CTxOut& txout) const\n     {\n-        const auto ext_it = m_external_txouts.find(outpoint);\n-        if (ext_it == m_external_txouts.end()) {\n+        const auto it = m_selected.find(outpoint);\n+        if (it == m_selected.end()) {\n             return false;\n         }\n-        txout = ext_it->second;\n+        if (!it->second.HasTxOut()) {\n+            return false;\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1084630269",
      "id" : 1084630269,
      "in_reply_to_id" : 892703667,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585ApiT9",
      "original_commit_id" : "99bd2a643d230ee2ce91b1d7a337d91386adb98a",
      "original_line" : 155,
      "original_position" : 68,
      "original_start_line" : 115,
      "path" : "src/wallet/coincontrol.h",
      "position" : null,
      "pull_request_review_id" : 1266464467,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084630269/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2023-01-23T22:20:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084630269",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1084630528"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084630528"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done, also for input weight and position.",
      "commit_id" : "91e6fad8b1fd9a88db1b5d785b4ecba95a622068",
      "created_at" : "2023-01-23T22:20:24Z",
      "diff_hunk" : "@@ -163,6 +173,20 @@ class CCoinControl\n         return m_selected.at(outpoint).GetInputWeight();\n     }\n \n+    bool HasSequence(const COutPoint& outpoint) const\n+    {\n+        const auto it = m_selected.find(outpoint);\n+        if (it == m_selected.end()) {\n+            return false;\n+        }\n+        return it->second.HasSequence();\n+    }\n+\n+    uint32_t GetSequence(const COutPoint& outpoint) const\n+    {\n+        return m_selected.at(outpoint).GetSequence();\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1084630528",
      "id" : 1084630528,
      "in_reply_to_id" : 1025583116,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585ApiYA",
      "original_commit_id" : "bd979e2b140e7e3d79ff007b8077ff16e8eda5d6",
      "original_line" : 206,
      "original_position" : 40,
      "original_start_line" : 176,
      "path" : "src/wallet/coincontrol.h",
      "position" : null,
      "pull_request_review_id" : 1266465174,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084630528/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2023-01-23T22:20:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084630528",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1084630593"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084630593"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done as suggested",
      "commit_id" : "91e6fad8b1fd9a88db1b5d785b4ecba95a622068",
      "created_at" : "2023-01-23T22:20:30Z",
      "diff_hunk" : "@@ -1136,15 +1136,15 @@ bool FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& nFeeRet,\n \n     for (const CTxIn& txin : tx.vin) {\n         const auto& outPoint = txin.prevout;\n-        if (wallet.IsMine(outPoint)) {\n-            // The input was found in the wallet, so select as internal\n-            coinControl.Select(outPoint);\n-        } else if (coins[outPoint].out.IsNull()) {\n-            error = _(\"Unable to find UTXO for external input\");\n-            return false;\n-        } else {\n-            // The input was not in the wallet, but is in the UTXO set, so select as external\n-            coinControl.SelectExternal(outPoint, coins[outPoint].out);\n+        PreselectedInput& preset_txin = coinControl.Select(outPoint);\n+        if (!wallet.IsMine(outPoint)) {\n+            if (!coins[outPoint].out.IsNull()) {\n+                // The input was not in the wallet, but is in the UTXO set, so select as external\n+                preset_txin.SetTxOut(coins[outPoint].out);\n+            } else {\n+                error = _(\"Unable to find UTXO for external input\");\n+                return false;\n+            }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1084630593",
      "id" : 1084630593,
      "in_reply_to_id" : 1083460232,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585ApiZB",
      "original_commit_id" : "65550f8ac4a3bff8f31e5d918be83c0abfbd2457",
      "original_line" : 1187,
      "original_position" : 21,
      "original_start_line" : 1139,
      "path" : "src/wallet/spend.cpp",
      "position" : null,
      "pull_request_review_id" : 1266465371,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084630593/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2023-01-23T22:20:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084630593",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1084632151"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084632151"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Right now, I don't think that's a good idea. Since we are always say that the preset inputs have scriptSigs and witnesses when they come from `FundTransaction`, any input weight calculation using them may be incorrect because those inputs are not necessarily complete or valid, so the final weight may actually differ.",
      "commit_id" : "91e6fad8b1fd9a88db1b5d785b4ecba95a622068",
      "created_at" : "2023-01-23T22:22:37Z",
      "diff_hunk" : "@@ -961,7 +961,15 @@ static util::Result<CreatedTransactionResult> CreateTransactionInternal(\n             // If an input as a preset sequence, we can't do anti-fee-sniping\n             use_anti_fee_sniping = false;\n         }\n-        txNew.vin.push_back(CTxIn(coin.outpoint, CScript(), sequence));\n+        CScript script_sig;\n+        CScriptWitness script_witness;\n+        if (coin_control.HasScripts(coin.outpoint)) {\n+            auto [ss, sw] = coin_control.GetScripts(coin.outpoint);\n+            script_sig = ss;\n+            script_witness = sw;\n+        }\n+        txNew.vin.push_back(CTxIn(coin.outpoint, script_sig, sequence));\n+        txNew.vin.back().scriptWitness = script_witness;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1084632151",
      "id" : 1084632151,
      "in_reply_to_id" : 1083463841,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585ApixX",
      "original_commit_id" : "187f2168a700e60739c09fb81c12593cfa894fb8",
      "original_line" : 984,
      "original_position" : 13,
      "original_start_line" : 966,
      "path" : "src/wallet/spend.cpp",
      "position" : null,
      "pull_request_review_id" : 1266469541,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084632151/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2023-01-23T22:22:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1084632151",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1087910019"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1087910019"
         }
      },
      "author_association" : "MEMBER",
      "body" : "oops, yeah..  nvm then.",
      "commit_id" : "91e6fad8b1fd9a88db1b5d785b4ecba95a622068",
      "created_at" : "2023-01-26T14:17:51Z",
      "diff_hunk" : "@@ -1188,47 +1188,25 @@ bool FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& nFeeRet,\n                 // The input was not in the wallet, but is in the UTXO set, so select as external\n                 preset_txin.SetTxOut(coins[outPoint].out);\n             } else {\n-                error = _(\"Unable to find UTXO for external input\");\n-                return false;\n+                return util::Error{_(\"Unable to find UTXO for external input\")};\n             }\n         }\n         preset_txin.SetSequence(txin.nSequence);\n         preset_txin.SetScriptSig(txin.scriptSig);\n         preset_txin.SetScriptWitness(txin.scriptWitness);\n     }\n \n-    auto res = CreateTransaction(wallet, vecSend, nChangePosInOut == -1 ? std::nullopt : std::optional<unsigned int>((unsigned int)nChangePosInOut), coinControl, false);\n+    auto res = CreateTransaction(wallet, vecSend, change_pos, coinControl, false);\n     if (!res) {\n-        error = util::ErrorString(res);\n-        return false;\n-    }\n-    const auto& txr = *res;\n-    CTransactionRef tx_new = txr.tx;\n-    nFeeRet = txr.fee;\n-    nChangePosInOut = txr.change_pos ? *txr.change_pos : -1;\n-\n-    if (nChangePosInOut != -1) {\n-        tx.vout.insert(tx.vout.begin() + nChangePosInOut, tx_new->vout[nChangePosInOut]);\n-    }\n-\n-    // Copy output sizes from new transaction; they may have had the fee\n-    // subtracted from them.\n-    for (unsigned int idx = 0; idx < tx.vout.size(); idx++) {\n-        tx.vout[idx].nValue = tx_new->vout[idx].nValue;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1087910019",
      "id" : 1087910019,
      "in_reply_to_id" : 1083468973,
      "line" : 1168,
      "node_id" : "PRRC_kwDOABII585A2DCD",
      "original_commit_id" : "6fb622183a4d25fcdc03cbc4bcd30c77ff4ef635",
      "original_line" : 1168,
      "original_position" : 41,
      "original_start_line" : 1214,
      "path" : "src/wallet/spend.cpp",
      "position" : 272,
      "pull_request_review_id" : 1271131964,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1087910019/reactions"
      },
      "side" : "LEFT",
      "start_line" : 1165,
      "start_side" : "LEFT",
      "updated_at" : "2023-01-26T14:17:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1087910019",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-03-07T01:07:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1457309200",
      "id" : 1457309200,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
      "node_id" : "IC_kwDOABII585W3MYQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1457309200/reactions"
      },
      "updated_at" : "2023-03-07T01:07:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1457309200",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1146013592"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1146013592"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Making sure i got this one right. `use_anti_fee_sniping` may only be `false` if this is called from `FundTransaction`. And `FundTransaction` diregards the value of the `nLockTime` that may be set here anyways. (Well not anymore in the following commits, but at this stage in the commit series it does.)",
      "commit_id" : "35fe41fbd742bfe22fd5c64a22d115f0ca02327e",
      "created_at" : "2023-03-23T11:00:17Z",
      "diff_hunk" : "@@ -832,11 +845,33 @@ static std::optional<CreatedTransactionResult> CreateTransactionInternal(\n     // to avoid conflicting with other possible uses of nSequence,\n     // and in the spirit of \"smallest possible change from prior\n     // behavior.\"\n-    const uint32_t nSequence{coin_control.m_signal_bip125_rbf.value_or(wallet.m_signal_rbf) ? MAX_BIP125_RBF_SEQUENCE : CTxIn::MAX_SEQUENCE_NONFINAL};\n+    bool use_anti_fee_sniping = true;\n+    const uint32_t default_sequence{coin_control.m_signal_bip125_rbf.value_or(wallet.m_signal_rbf) ? MAX_BIP125_RBF_SEQUENCE : CTxIn::MAX_SEQUENCE_NONFINAL};\n     for (const auto& coin : selected_coins) {\n-        txNew.vin.push_back(CTxIn(coin.outpoint, CScript(), nSequence));\n+        uint32_t sequence = default_sequence;\n+        if (coin_control.HasSequence(coin.outpoint)) {\n+            sequence = coin_control.GetSequence(coin.outpoint);\n+            // If an input as a preset sequence, we can't do anti-fee-sniping",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1146013592",
      "id" : 1146013592,
      "in_reply_to_id" : 900983932,
      "line" : 998,
      "node_id" : "PRRC_kwDOABII585ETseY",
      "original_commit_id" : "664f7430478592fc89b7c2fdc423b7a649bc6c27",
      "original_line" : 998,
      "original_position" : 75,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 112,
      "pull_request_review_id" : 1354216199,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1146013592/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-23T11:34:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1146013592",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1146387794"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1146387794"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, `FundTransaction` currently throws away `nLockTime` thereby disabling anti-fee-sniping, and this preserves that behavior.",
      "commit_id" : "d8393d8bed0133ac5e4da6c209a3ff4c269bce90",
      "created_at" : "2023-03-23T15:36:45Z",
      "diff_hunk" : "@@ -832,11 +845,33 @@ static std::optional<CreatedTransactionResult> CreateTransactionInternal(\n     // to avoid conflicting with other possible uses of nSequence,\n     // and in the spirit of \"smallest possible change from prior\n     // behavior.\"\n-    const uint32_t nSequence{coin_control.m_signal_bip125_rbf.value_or(wallet.m_signal_rbf) ? MAX_BIP125_RBF_SEQUENCE : CTxIn::MAX_SEQUENCE_NONFINAL};\n+    bool use_anti_fee_sniping = true;\n+    const uint32_t default_sequence{coin_control.m_signal_bip125_rbf.value_or(wallet.m_signal_rbf) ? MAX_BIP125_RBF_SEQUENCE : CTxIn::MAX_SEQUENCE_NONFINAL};\n     for (const auto& coin : selected_coins) {\n-        txNew.vin.push_back(CTxIn(coin.outpoint, CScript(), nSequence));\n+        uint32_t sequence = default_sequence;\n+        if (coin_control.HasSequence(coin.outpoint)) {\n+            sequence = coin_control.GetSequence(coin.outpoint);\n+            // If an input as a preset sequence, we can't do anti-fee-sniping",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1146387794",
      "id" : 1146387794,
      "in_reply_to_id" : 900983932,
      "line" : 1032,
      "node_id" : "PRRC_kwDOABII585EVH1S",
      "original_commit_id" : "664f7430478592fc89b7c2fdc423b7a649bc6c27",
      "original_line" : 1032,
      "original_position" : 75,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 112,
      "pull_request_review_id" : 1354916353,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1146387794/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-23T15:36:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1146387794",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1181279440"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181279440"
         }
      },
      "author_association" : "MEMBER",
      "body" : "tiny nit:\r\njust because I'm using this in another PR:\r\n```c++\r\nchange_pos == -1 ? std::nullopt : std::make_optional(change_pos)\r\n```",
      "commit_id" : "d8393d8bed0133ac5e4da6c209a3ff4c269bce90",
      "created_at" : "2023-04-30T19:07:22Z",
      "diff_hunk" : "@@ -258,12 +258,12 @@ class WalletImpl : public Wallet\n         CAmount& fee) override\n     {\n         LOCK(m_wallet->cs_wallet);\n-        auto res = CreateTransaction(*m_wallet, recipients, change_pos,\n+        auto res = CreateTransaction(*m_wallet, recipients, change_pos == -1 ? std::nullopt : std::optional<unsigned int>((unsigned int)change_pos),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1181279440",
      "id" : 1181279440,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585GaOTQ",
      "original_commit_id" : "c158ad118a5e38a042e7a9fb04c8171c68df0f0d",
      "original_line" : 261,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/interfaces.cpp",
      "position" : null,
      "pull_request_review_id" : 1407167119,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181279440/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-03T19:56:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181279440",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1183946012"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1183946012"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "(in commit bf275f358a5e816cf9a8ab6e7dbd39f6dcdf80d7) nit: this could just be a one-liner using [std::optional<T>::value_or](https://en.cppreference.com/w/cpp/utility/optional/value_or)\r\n```suggestion\r\n        return {m_script_sig.value_or(CScript{}), m_script_witness.value_or(CScriptWitness{})};\r\n```",
      "commit_id" : "d8393d8bed0133ac5e4da6c209a3ff4c269bce90",
      "created_at" : "2023-05-03T16:42:18Z",
      "diff_hunk" : "@@ -55,6 +59,22 @@ class PreselectedInput\n     {\n         return m_sequence;\n     }\n+\n+    void SetScriptSig(const CScript& script) { m_script_sig = script; }\n+    void SetScriptWitness(const CScriptWitness& script_wit) { m_script_witness = script_wit; }\n+    bool HasScripts() const { return m_script_sig.has_value() || m_script_witness.has_value(); }\n+    std::pair<CScript, CScriptWitness> GetScripts() const\n+    {\n+        CScript script_sig;\n+        if (m_script_sig.has_value()) {\n+            script_sig = m_script_sig.value();\n+        }\n+        CScriptWitness script_witness;\n+        if (m_script_witness.has_value()) {\n+            script_witness = m_script_witness.value();\n+        }\n+        return {script_sig, script_witness};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1183946012",
      "id" : 1183946012,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585GkZUc",
      "original_commit_id" : "bf275f358a5e816cf9a8ab6e7dbd39f6dcdf80d7",
      "original_line" : 76,
      "original_position" : 29,
      "original_start_line" : 68,
      "path" : "src/wallet/coincontrol.h",
      "position" : null,
      "pull_request_review_id" : 1411318920,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1183946012/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-05-03T17:00:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1183946012",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1183964527"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1183964527"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "(in commit bf275f358a5e816cf9a8ab6e7dbd39f6dcdf80d7): nit: could avoid introducing temporary variables by directly assigning to script_sig/script_witness using std::tie\r\n```suggestion\r\n            std::tie(script_sig, script_witness) = coin_control.GetScripts(coin->outpoint);\r\n```",
      "commit_id" : "d8393d8bed0133ac5e4da6c209a3ff4c269bce90",
      "created_at" : "2023-05-03T16:57:43Z",
      "diff_hunk" : "@@ -982,7 +982,15 @@ static util::Result<CreatedTransactionResult> CreateTransactionInternal(\n             // If an input as a preset sequence, we can't do anti-fee-sniping\n             use_anti_fee_sniping = false;\n         }\n-        txNew.vin.push_back(CTxIn(coin->outpoint, CScript(), sequence.value_or(default_sequence)));\n+        CScript script_sig;\n+        CScriptWitness script_witness;\n+        if (coin_control.HasScripts(coin->outpoint)) {\n+            auto [ss, sw] = coin_control.GetScripts(coin->outpoint);\n+            script_sig = ss;\n+            script_witness = sw;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1183964527",
      "id" : 1183964527,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Gkd1v",
      "original_commit_id" : "bf275f358a5e816cf9a8ab6e7dbd39f6dcdf80d7",
      "original_line" : 990,
      "original_position" : 10,
      "original_start_line" : 988,
      "path" : "src/wallet/spend.cpp",
      "position" : null,
      "pull_request_review_id" : 1411318920,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1183964527/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-05-03T17:00:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1183964527",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased",
      "created_at" : "2023-05-25T14:58:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1563059936",
      "id" : 1563059936,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
      "node_id" : "IC_kwDOABII585dKmbg",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1563059936/reactions"
      },
      "updated_at" : "2023-05-25T14:58:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1563059936",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Needs rebase if still relevant",
      "created_at" : "2023-06-28T10:56:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1611191360",
      "id" : 1611191360,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
      "node_id" : "IC_kwDOABII585gCNRA",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1611191360/reactions"
      },
      "updated_at" : "2023-06-28T10:56:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1611191360",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1285205986"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285205986"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "(in commit 2de8e8309ac0ee60742e45b8cc1342e61c725566)\r\nnit: could be written as one-liner\r\n```suggestion\r\n    return (it != m_selected.end() && it->second.HasTxOut());\r\n```\r\n(same for `HasInputWeight`, though that gets replaced anyway in the next commit)",
      "commit_id" : "d8393d8bed0133ac5e4da6c209a3ff4c269bce90",
      "created_at" : "2023-08-06T11:50:24Z",
      "diff_hunk" : "@@ -14,69 +14,110 @@ CCoinControl::CCoinControl()\n \n bool CCoinControl::HasSelected() const\n {\n-    return !m_selected_inputs.empty();\n+    return !m_selected.empty();\n }\n \n bool CCoinControl::IsSelected(const COutPoint& output) const\n {\n-    return m_selected_inputs.count(output) > 0;\n+    return m_selected.count(output) > 0;\n }\n \n bool CCoinControl::IsExternalSelected(const COutPoint& output) const\n {\n-    return m_external_txouts.count(output) > 0;\n+    const auto it = m_selected.find(output);\n+    if (it == m_selected.end()) {\n+        return false;\n+    }\n+    return it->second.HasTxOut();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1285205986",
      "id" : 1285205986,
      "line" : 31,
      "node_id" : "PRRC_kwDOABII585Mmq_i",
      "original_commit_id" : "2de8e8309ac0ee60742e45b8cc1342e61c725566",
      "original_line" : 31,
      "original_position" : 21,
      "original_start_line" : 28,
      "path" : "src/wallet/coincontrol.cpp",
      "position" : 21,
      "pull_request_review_id" : 1564136969,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285205986/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 28,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-08-06T12:49:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285205986",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1285210302"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285210302"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "(in commit 077783d24b7f1e3d3312e6cc12aee3f178400725)\r\nLooking at the \"override calculated size with coin control specified size\" branch removed below, seems like a `GetVirtualTransactionSize` call is missing here (in the case that `GetInputWeight` doesn't return std::nullopt), as we want vbytes as `input_bytes` unit, not WU?",
      "commit_id" : "d8393d8bed0133ac5e4da6c209a3ff4c269bce90",
      "created_at" : "2023-08-06T12:17:06Z",
      "diff_hunk" : "@@ -161,15 +161,17 @@ util::Result<PreSelectedInputs> FetchSelectedInputs(const CWallet& wallet, const\n     PreSelectedInputs result;\n     const bool can_grind_r = wallet.CanGrindR();\n     for (const COutPoint& outpoint : coin_control.ListSelected()) {\n-        int input_bytes = -1;\n+        int32_t input_bytes = coin_control.GetInputWeight(outpoint).value_or(-1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1285210302",
      "id" : 1285210302,
      "line" : 164,
      "node_id" : "PRRC_kwDOABII585MmsC-",
      "original_commit_id" : "077783d24b7f1e3d3312e6cc12aee3f178400725",
      "original_line" : 164,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 5,
      "pull_request_review_id" : 1564136969,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285210302/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-06T12:49:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285210302",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1285211710"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285211710"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "(in commit 705568146d4399ad8089adc4943786e2a0c0a62e)\r\nnit: could be written as a one-liner\r\n```suggestion\r\n    return (it != m_selected.end()) ? it->second.GetSequence() : std::nullopt;\r\n```",
      "commit_id" : "d8393d8bed0133ac5e4da6c209a3ff4c269bce90",
      "created_at" : "2023-08-06T12:27:35Z",
      "diff_hunk" : "@@ -79,6 +79,15 @@ std::optional<int64_t> CCoinControl::GetInputWeight(const COutPoint& outpoint) c\n     return it->second.GetInputWeight();\n }\n \n+std::optional<uint32_t> CCoinControl::GetSequence(const COutPoint& outpoint) const\n+{\n+    const auto it = m_selected.find(outpoint);\n+    if (it == m_selected.end()) {\n+        return std::nullopt;\n+    }\n+    return it->second.GetSequence();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1285211710",
      "id" : 1285211710,
      "line" : 90,
      "node_id" : "PRRC_kwDOABII585MmsY-",
      "original_commit_id" : "705568146d4399ad8089adc4943786e2a0c0a62e",
      "original_line" : 88,
      "original_position" : 10,
      "original_start_line" : 85,
      "path" : "src/wallet/coincontrol.cpp",
      "position" : 96,
      "pull_request_review_id" : 1564136969,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285211710/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 87,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-08-06T12:49:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285211710",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1285212353"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285212353"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "typo, I guess\r\n```suggestion\r\n            // If an input has a preset sequence, we can't do anti-fee-sniping\r\n```",
      "commit_id" : "d8393d8bed0133ac5e4da6c209a3ff4c269bce90",
      "created_at" : "2023-08-06T12:33:28Z",
      "diff_hunk" : "@@ -1004,11 +1004,19 @@ static util::Result<CreatedTransactionResult> CreateTransactionInternal(\n     // to avoid conflicting with other possible uses of nSequence,\n     // and in the spirit of \"smallest possible change from prior\n     // behavior.\"\n-    const uint32_t nSequence{coin_control.m_signal_bip125_rbf.value_or(wallet.m_signal_rbf) ? MAX_BIP125_RBF_SEQUENCE : CTxIn::MAX_SEQUENCE_NONFINAL};\n+    bool use_anti_fee_sniping = true;\n+    const uint32_t default_sequence{coin_control.m_signal_bip125_rbf.value_or(wallet.m_signal_rbf) ? MAX_BIP125_RBF_SEQUENCE : CTxIn::MAX_SEQUENCE_NONFINAL};\n     for (const auto& coin : selected_coins) {\n-        txNew.vin.push_back(CTxIn(coin->outpoint, CScript(), nSequence));\n+        std::optional<uint32_t> sequence = coin_control.GetSequence(coin->outpoint);\n+        if (sequence) {\n+            // If an input as a preset sequence, we can't do anti-fee-sniping",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1285212353",
      "id" : 1285212353,
      "line" : 1032,
      "node_id" : "PRRC_kwDOABII585MmsjB",
      "original_commit_id" : "705568146d4399ad8089adc4943786e2a0c0a62e",
      "original_line" : 1012,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 112,
      "pull_request_review_id" : 1564136969,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285212353/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-06T12:49:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285212353",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1285213341"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285213341"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "(in commit 6fcbf9f44358f85aab4c0b6617c113b4c37da5a8)\r\nnit: could be written as a one-liner\r\n```suggestion\r\n    return (it != m_selected.end() && it->second.HasScripts());\r\n```",
      "commit_id" : "d8393d8bed0133ac5e4da6c209a3ff4c269bce90",
      "created_at" : "2023-08-06T12:40:35Z",
      "diff_hunk" : "@@ -88,6 +88,20 @@ std::optional<uint32_t> CCoinControl::GetSequence(const COutPoint& outpoint) con\n     return it->second.GetSequence();\n }\n \n+bool CCoinControl::HasScripts(const COutPoint& outpoint) const\n+{\n+    const auto it = m_selected.find(outpoint);\n+    if (it == m_selected.end()) {\n+        return false;\n+    }\n+    return it->second.HasScripts();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1285213341",
      "id" : 1285213341,
      "line" : 99,
      "node_id" : "PRRC_kwDOABII585Mmsyd",
      "original_commit_id" : "6fcbf9f44358f85aab4c0b6617c113b4c37da5a8",
      "original_line" : 97,
      "original_position" : 10,
      "original_start_line" : 94,
      "path" : "src/wallet/coincontrol.cpp",
      "position" : 105,
      "pull_request_review_id" : 1564136969,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285213341/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 96,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-08-06T12:49:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1285213341",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1327776881"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327776881"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "46e721b4b3490e80467876d10a2473d74304c57f",
      "created_at" : "2023-09-15T20:49:32Z",
      "diff_hunk" : "@@ -14,69 +14,110 @@ CCoinControl::CCoinControl()\n \n bool CCoinControl::HasSelected() const\n {\n-    return !m_selected_inputs.empty();\n+    return !m_selected.empty();\n }\n \n bool CCoinControl::IsSelected(const COutPoint& output) const\n {\n-    return m_selected_inputs.count(output) > 0;\n+    return m_selected.count(output) > 0;\n }\n \n bool CCoinControl::IsExternalSelected(const COutPoint& output) const\n {\n-    return m_external_txouts.count(output) > 0;\n+    const auto it = m_selected.find(output);\n+    if (it == m_selected.end()) {\n+        return false;\n+    }\n+    return it->second.HasTxOut();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1327776881",
      "id" : 1327776881,
      "in_reply_to_id" : 1285205986,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585PJERx",
      "original_commit_id" : "2de8e8309ac0ee60742e45b8cc1342e61c725566",
      "original_line" : 31,
      "original_position" : 21,
      "original_start_line" : 28,
      "path" : "src/wallet/coincontrol.cpp",
      "position" : null,
      "pull_request_review_id" : 1629709327,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327776881/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-09-15T20:49:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327776881",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1327788643"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327788643"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "46e721b4b3490e80467876d10a2473d74304c57f",
      "created_at" : "2023-09-15T21:06:34Z",
      "diff_hunk" : "@@ -79,6 +79,15 @@ std::optional<int64_t> CCoinControl::GetInputWeight(const COutPoint& outpoint) c\n     return it->second.GetInputWeight();\n }\n \n+std::optional<uint32_t> CCoinControl::GetSequence(const COutPoint& outpoint) const\n+{\n+    const auto it = m_selected.find(outpoint);\n+    if (it == m_selected.end()) {\n+        return std::nullopt;\n+    }\n+    return it->second.GetSequence();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1327788643",
      "id" : 1327788643,
      "in_reply_to_id" : 1285211710,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585PJHJj",
      "original_commit_id" : "705568146d4399ad8089adc4943786e2a0c0a62e",
      "original_line" : 90,
      "original_position" : 10,
      "original_start_line" : 85,
      "path" : "src/wallet/coincontrol.cpp",
      "position" : null,
      "pull_request_review_id" : 1629725874,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327788643/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-09-15T21:06:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327788643",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1327788688"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327788688"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "46e721b4b3490e80467876d10a2473d74304c57f",
      "created_at" : "2023-09-15T21:06:40Z",
      "diff_hunk" : "@@ -1004,11 +1004,19 @@ static util::Result<CreatedTransactionResult> CreateTransactionInternal(\n     // to avoid conflicting with other possible uses of nSequence,\n     // and in the spirit of \"smallest possible change from prior\n     // behavior.\"\n-    const uint32_t nSequence{coin_control.m_signal_bip125_rbf.value_or(wallet.m_signal_rbf) ? MAX_BIP125_RBF_SEQUENCE : CTxIn::MAX_SEQUENCE_NONFINAL};\n+    bool use_anti_fee_sniping = true;\n+    const uint32_t default_sequence{coin_control.m_signal_bip125_rbf.value_or(wallet.m_signal_rbf) ? MAX_BIP125_RBF_SEQUENCE : CTxIn::MAX_SEQUENCE_NONFINAL};\n     for (const auto& coin : selected_coins) {\n-        txNew.vin.push_back(CTxIn(coin->outpoint, CScript(), nSequence));\n+        std::optional<uint32_t> sequence = coin_control.GetSequence(coin->outpoint);\n+        if (sequence) {\n+            // If an input as a preset sequence, we can't do anti-fee-sniping",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1327788688",
      "id" : 1327788688,
      "in_reply_to_id" : 1285212353,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585PJHKQ",
      "original_commit_id" : "705568146d4399ad8089adc4943786e2a0c0a62e",
      "original_line" : 1134,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : null,
      "pull_request_review_id" : 1629725954,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327788688/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-15T21:06:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327788688",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1327788735"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327788735"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "46e721b4b3490e80467876d10a2473d74304c57f",
      "created_at" : "2023-09-15T21:06:44Z",
      "diff_hunk" : "@@ -88,6 +88,20 @@ std::optional<uint32_t> CCoinControl::GetSequence(const COutPoint& outpoint) con\n     return it->second.GetSequence();\n }\n \n+bool CCoinControl::HasScripts(const COutPoint& outpoint) const\n+{\n+    const auto it = m_selected.find(outpoint);\n+    if (it == m_selected.end()) {\n+        return false;\n+    }\n+    return it->second.HasScripts();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1327788735",
      "id" : 1327788735,
      "in_reply_to_id" : 1285213341,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585PJHK_",
      "original_commit_id" : "6fcbf9f44358f85aab4c0b6617c113b4c37da5a8",
      "original_line" : 99,
      "original_position" : 10,
      "original_start_line" : 94,
      "path" : "src/wallet/coincontrol.cpp",
      "position" : null,
      "pull_request_review_id" : 1629726131,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327788735/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-09-15T21:06:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327788735",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1327814485"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327814485"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good catch, fixed.\r\n\r\nTried to add a test but the effects of this mistake are not readily apparent enough to be tested in our functional test framework.",
      "commit_id" : "46e721b4b3490e80467876d10a2473d74304c57f",
      "created_at" : "2023-09-15T21:38:32Z",
      "diff_hunk" : "@@ -161,15 +161,17 @@ util::Result<PreSelectedInputs> FetchSelectedInputs(const CWallet& wallet, const\n     PreSelectedInputs result;\n     const bool can_grind_r = wallet.CanGrindR();\n     for (const COutPoint& outpoint : coin_control.ListSelected()) {\n-        int input_bytes = -1;\n+        int32_t input_bytes = coin_control.GetInputWeight(outpoint).value_or(-1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1327814485",
      "id" : 1327814485,
      "in_reply_to_id" : 1285210302,
      "line" : 264,
      "node_id" : "PRRC_kwDOABII585PJNdV",
      "original_commit_id" : "077783d24b7f1e3d3312e6cc12aee3f178400725",
      "original_line" : 264,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 17,
      "pull_request_review_id" : 1629759190,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327814485/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-15T21:38:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327814485",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-09-19T18:21:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1726264827",
      "id" : 1726264827,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
      "node_id" : "IC_kwDOABII585m5LX7",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1726264827/reactions"
      },
      "updated_at" : "2023-09-19T18:21:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1726264827",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "big Concept ACK\r\n\r\nStill in the process of reviewing this, but it looks good so far. Building off of this PR in #28560",
      "created_at" : "2023-10-02T16:51:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#issuecomment-1743385349",
      "id" : 1743385349,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
      "node_id" : "IC_kwDOABII585n6fMF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1743385349/reactions"
      },
      "updated_at" : "2023-10-02T16:53:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1743385349",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7444140?v=4",
         "events_url" : "https://api.github.com/users/josibake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/josibake/followers",
         "following_url" : "https://api.github.com/users/josibake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/josibake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/josibake",
         "id" : 7444140,
         "login" : "josibake",
         "node_id" : "MDQ6VXNlcjc0NDQxNDA=",
         "organizations_url" : "https://api.github.com/users/josibake/orgs",
         "received_events_url" : "https://api.github.com/users/josibake/received_events",
         "repos_url" : "https://api.github.com/users/josibake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/josibake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/josibake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/josibake"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1378511724"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1378511724"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Can't figure out how is it set currently?",
      "commit_id" : "59c363ec7245521e388b4d21abb44d7881907757",
      "created_at" : "2023-11-01T08:22:54Z",
      "diff_hunk" : "@@ -977,6 +977,10 @@ static util::Result<CreatedTransactionResult> CreateTransactionInternal(\n     FastRandomContext rng_fast;\n     CMutableTransaction txNew; // The resulting transaction that we make\n \n+    if (coin_control.m_version) {\n+        txNew.nVersion = coin_control.m_version.value();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1378511724",
      "id" : 1378511724,
      "line" : 978,
      "node_id" : "PRRC_kwDOABII585SKmts",
      "original_commit_id" : "c8544398fb945b2402274981b22c70fdd8a67b9e",
      "original_line" : 981,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 65,
      "pull_request_review_id" : 1705662758,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1378511724/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-05T17:22:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1378511724",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1382610792"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1382610792"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "in 03420020b6b4958ee6765be718724b89cd174d5c\r\n\r\n`locktime` doesn't belong to `CoinControl` because it has nothing to do with coins being spent. I'd prefer if we keep `CoinControl` scoped down to only containing data necessary to select and spend coins.\r\n\r\nSame is true for some other fields in `CoinControl`. Maybe we should extract parameters not related to coins into a separate struct?",
      "commit_id" : "59c363ec7245521e388b4d21abb44d7881907757",
      "created_at" : "2023-11-05T17:04:05Z",
      "diff_hunk" : "@@ -91,6 +91,8 @@ class CCoinControl\n     int m_max_depth = DEFAULT_MAX_DEPTH;\n     //! SigningProvider that has pubkeys and scripts to do spend size estimation for external inputs\n     FlatSigningProvider m_external_provider;\n+    //! Locktime\n+    std::optional<uint32_t> m_locktime;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1382610792",
      "id" : 1382610792,
      "line" : 115,
      "node_id" : "PRRC_kwDOABII585SaPdo",
      "original_commit_id" : "03420020b6b4958ee6765be718724b89cd174d5c",
      "original_line" : 95,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/coincontrol.h",
      "position" : 64,
      "pull_request_review_id" : 1705662758,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1382610792/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-05T17:22:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1382610792",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1382610856"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1382610856"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "in c8544398fb945b2402274981b22c70fdd8a67b9e\r\n\r\nSame comment as for `locktime`",
      "commit_id" : "59c363ec7245521e388b4d21abb44d7881907757",
      "created_at" : "2023-11-05T17:04:39Z",
      "diff_hunk" : "@@ -93,6 +93,8 @@ class CCoinControl\n     FlatSigningProvider m_external_provider;\n     //! Locktime\n     std::optional<uint32_t> m_locktime;\n+    //! Version\n+    std::optional<uint32_t> m_version;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1382610856",
      "id" : 1382610856,
      "line" : 117,
      "node_id" : "PRRC_kwDOABII585SaPeo",
      "original_commit_id" : "c8544398fb945b2402274981b22c70fdd8a67b9e",
      "original_line" : 97,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/coincontrol.h",
      "position" : 66,
      "pull_request_review_id" : 1705662758,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1382610856/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-05T17:22:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1382610856",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1382611119"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1382611119"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I'm not sure about 49ce0fe1e2ec87508aea537d17e6bb13791be1aa and probably would prefer to drop it.\r\n\r\nIt makes interface less clear. It's not obvious that I need to call `SetTxOut` to make input as external. \r\n\r\n",
      "commit_id" : "59c363ec7245521e388b4d21abb44d7881907757",
      "created_at" : "2023-11-05T17:06:41Z",
      "diff_hunk" : "@@ -1347,15 +1347,15 @@ bool FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& nFeeRet,\n \n     for (const CTxIn& txin : tx.vin) {\n         const auto& outPoint = txin.prevout;\n-        if (wallet.IsMine(outPoint)) {\n-            // The input was found in the wallet, so select as internal\n-            coinControl.Select(outPoint);\n-        } else if (coins[outPoint].out.IsNull()) {\n-            error = _(\"Unable to find UTXO for external input\");\n-            return false;\n-        } else {\n+        PreselectedInput& preset_txin = coinControl.Select(outPoint);\n+        if (!wallet.IsMine(outPoint)) {\n+            if (coins[outPoint].out.IsNull()) {\n+                error = _(\"Unable to find UTXO for external input\");\n+                return false;\n+            }\n+\n             // The input was not in the wallet, but is in the UTXO set, so select as external\n-            coinControl.SelectExternal(outPoint, coins[outPoint].out);\n+            preset_txin.SetTxOut(coins[outPoint].out);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1382611119",
      "id" : 1382611119,
      "line" : 1401,
      "node_id" : "PRRC_kwDOABII585SaPiv",
      "original_commit_id" : "49ce0fe1e2ec87508aea537d17e6bb13791be1aa",
      "original_line" : 1358,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 270,
      "pull_request_review_id" : 1705662758,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1382611119/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-05T17:22:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1382611119",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1382612097"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1382612097"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "in 59a7c7416313693a3c8219363d9ffee1e2b86d4d\r\n\r\nNaming is hard. We already have struct `PreSelectedInputs` which is quite confusing as it refers to different data.\r\n\r\n`PreSelectedInputs` is basically `set<COutput>`. It seems we should find a better name for `PreSelectedInputs`. Maybe rename it to `PreSelectedCoins`?\r\n\r\nIt'd be nice to have consistent terms to refer to different data.\r\nHow about we use `input` when we talk about tx.in and related info.\r\nAnd we use `coin` when its enriched data in context of coin selection.\r\n\r\nPerhaps @murchandamus have thought about terminology.\r\n\r\n",
      "commit_id" : "59c363ec7245521e388b4d21abb44d7881907757",
      "created_at" : "2023-11-05T17:13:11Z",
      "diff_hunk" : "@@ -24,6 +24,33 @@ const int DEFAULT_MAX_DEPTH = 9999999;\n //! Default for -avoidpartialspends\n static constexpr bool DEFAULT_AVOIDPARTIALSPENDS = false;\n \n+class PreselectedInput",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1382612097",
      "id" : 1382612097,
      "line" : 27,
      "node_id" : "PRRC_kwDOABII585SaPyB",
      "original_commit_id" : "59a7c7416313693a3c8219363d9ffee1e2b86d4d",
      "original_line" : 27,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/coincontrol.h",
      "position" : 4,
      "pull_request_review_id" : 1705662758,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1382612097/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-05T17:22:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1382612097",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1382612557"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1382612557"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "in 53cb734591cabb37fc6e3d147a4715203cf15ddb\r\n\r\nThere is redundancy between `m_script_sig ` + `m_script_witness ` and `m_weight`. One can set all of them and reach and inconsistent state, which will lead to error.\r\n\r\nCan we make the interface better?",
      "commit_id" : "59c363ec7245521e388b4d21abb44d7881907757",
      "created_at" : "2023-11-05T17:16:33Z",
      "diff_hunk" : "@@ -33,6 +33,10 @@ class PreselectedInput\n     std::optional<int64_t> m_weight;\n     //! The sequence number for this input\n     std::optional<uint32_t> m_sequence;\n+    //! The scriptSig for this input\n+    std::optional<CScript> m_script_sig;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25273#discussion_r1382612557",
      "id" : 1382612557,
      "line" : 37,
      "node_id" : "PRRC_kwDOABII585SaP5N",
      "original_commit_id" : "53cb734591cabb37fc6e3d147a4715203cf15ddb",
      "original_line" : 37,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/coincontrol.h",
      "position" : 14,
      "pull_request_review_id" : 1705662758,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1382612557/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-05T17:22:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1382612557",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   }
]
