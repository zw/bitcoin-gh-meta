{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "We don't test bitcoin-cli at all. That means that we can miss inconsistencies between the bitcoin-cli client and the RPC interface, such as #10698 and #10747. It also means that the various bitcoin-cli options and features are untested and regressions could be silently introduced.\r\n\r\nLet's fix that.\r\n\r\nThis PR adds bitcoin-cli testing in the python functional test_framework:\r\n\r\n1. Add a bitcoin_cli.py test script that tests bitcoin-cli. At the moment it only tests that the result of `getinfo` is the same if you run it as an RPC or through bitcoin-cli, but can easily be extended to test additional bitcoin-cli features\r\n\r\n**EDIT: `--usecli` option is moved to a separate PR. This PR now only covers the bitcoin_cli.py test.**\r\n\r\n2. ~Add a `--usecli` option to the test framework. This changes the test to use bitcoin-cli for all RPC calls instead of using direct HTTP requests. This is somewhat experimental. It works for most tests, but there are some cases where it can't work transparently because:~\r\n- ~the testcase is asserting on a specific error code, and bitcoin-cli returns a different error code from the direct RPC~\r\n- ~we're sending a very large RPC request (eg `submitblock`) and it can't be serialized into a shell bitcoin-cli call.~\r\n\r\n~I think that even though `--usecli` doesn't work on all tests, it's still a useful experimental feature. Future potential enhancements:~\r\n- ~enhance the framework to automatically skip tests that are known to fail with bitcoin-cli if the `--usecli` option is used.~\r\n- ~run a subset of tests in Travis with `-usecli`~\r\n\r\nThis builds on and requires the `TestNode` PR #10711 . As an aside, this is a good demonstration of how tidy it is to add additional features/interfaces now that test node logic/state is encapsulated in a TestNode class.\r\n\r\nAddresses #10791",
   "closed_at" : "2017-08-24T20:08:16Z",
   "closed_by" : {
      "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
      "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
      "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/MarcoFalke",
      "id" : 6399679,
      "login" : "MarcoFalke",
      "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
      "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
      "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
      "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/MarcoFalke"
   },
   "comments" : 3,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10798/comments",
   "created_at" : "2017-07-11T22:36:03Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10798/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/10798",
   "id" : 242204666,
   "labels" : [
      {
         "color" : "d4c5f9",
         "default" : false,
         "id" : 62963516,
         "name" : "Tests",
         "node_id" : "MDU6TGFiZWw2Mjk2MzUxNg==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10798/labels{/name}",
   "locked" : false,
   "milestone" : {
      "closed_at" : "2018-06-13T08:19:56Z",
      "closed_issues" : 34,
      "created_at" : "2017-08-08T10:25:01Z",
      "creator" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      },
      "description" : "",
      "due_on" : null,
      "html_url" : "https://github.com/bitcoin/bitcoin/milestone/31",
      "id" : 2687782,
      "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/milestones/31/labels",
      "node_id" : "MDk6TWlsZXN0b25lMjY4Nzc4Mg==",
      "number" : 31,
      "open_issues" : 0,
      "state" : "closed",
      "title" : "0.15.2",
      "updated_at" : "2018-06-13T08:19:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/milestones/31"
   },
   "node_id" : "MDExOlB1bGxSZXF1ZXN0MTMwMDIwNTM5",
   "number" : 10798,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/10798.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10798",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/10798.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10798"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "[tests] [utils] test bitcoin-cli",
   "updated_at" : "2017-10-04T09:40:05Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10798",
   "user" : {
      "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
      "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
      "followers_url" : "https://api.github.com/users/jnewbery/followers",
      "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/jnewbery",
      "id" : 1063656,
      "login" : "jnewbery",
      "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
      "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
      "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
      "repos_url" : "https://api.github.com/users/jnewbery/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/jnewbery"
   }
}
