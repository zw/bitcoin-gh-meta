[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r125691891"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125691891"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It'd probably call this `deallocWallets()`",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-07-05T16:22:10Z",
      "diff_hunk" : "@@ -252,10 +245,7 @@ void Shutdown()\n #endif\n     UnregisterAllValidationInterfaces();\n #ifdef ENABLE_WALLET\n-    for (CWalletRef pwallet : vpwallets) {\n-        delete pwallet;\n-    }\n-    vpwallets.clear();\n+    DeleteWallets();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r125691891",
      "id" : 125691891,
      "original_commit_id" : "72c37457cd71a78add957d7f0239ffa260359701",
      "original_position" : 40,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 48106240,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-09-20T14:15:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125691891",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r125692442"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125692442"
         }
      },
      "author_association" : "MEMBER",
      "body" : "What's the reasons for keeping this function (that now always returns `true`)?",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-07-05T16:24:20Z",
      "diff_hunk" : "@@ -227,40 +227,12 @@ bool CDB::Recover(const std::string& filename, void *callbackDataIn, bool (*reco\n \n bool CDB::VerifyEnvironment(const std::string& walletFile, const fs::path& dataDir, std::string& errorStr)\n {\n-    LogPrintf(\"Using BerkeleyDB version %s\\n\", DbEnv::version(0, 0, 0));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r125692442",
      "id" : 125692442,
      "original_commit_id" : "72c37457cd71a78add957d7f0239ffa260359701",
      "original_position" : 4,
      "path" : "src/wallet/db.cpp",
      "position" : null,
      "pull_request_review_id" : 48106856,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-09-20T14:15:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125692442",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r125693083"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125693083"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I guess this belongs to `walletinit.h` now?",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-07-05T16:26:54Z",
      "diff_hunk" : "@@ -35,6 +35,8 @@\n #include <boost/algorithm/string/replace.hpp>\n #include <boost/thread.hpp>\n \n+/** Protects the vpwallets vector */\n+CCriticalSection cs_wallets;\n std::vector<CWalletRef> vpwallets;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r125693083",
      "id" : 125693083,
      "original_commit_id" : "72c37457cd71a78add957d7f0239ffa260359701",
      "original_position" : 6,
      "path" : "src/wallet/wallet.cpp",
      "position" : 6,
      "pull_request_review_id" : 48107575,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-09-20T14:15:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125693083",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r126115533"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126115533"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, `DeleteWallets()` is a bad name. `DeallocWallets()` is good, or perhaps `DetachWallets()`",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-07-07T10:18:57Z",
      "diff_hunk" : "@@ -252,10 +245,7 @@ void Shutdown()\n #endif\n     UnregisterAllValidationInterfaces();\n #ifdef ENABLE_WALLET\n-    for (CWalletRef pwallet : vpwallets) {\n-        delete pwallet;\n-    }\n-    vpwallets.clear();\n+    DeleteWallets();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r126115533",
      "id" : 126115533,
      "in_reply_to_id" : 125691891,
      "original_commit_id" : "72c37457cd71a78add957d7f0239ffa260359701",
      "original_position" : 40,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 48569969,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-09-20T14:15:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126115533",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r126116206"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126116206"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You're right. This (and `CWalletDB::VerifyEnvironment()`) are now entirely vestigial and are not called. Both can be removed.",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-07-07T10:23:11Z",
      "diff_hunk" : "@@ -227,40 +227,12 @@ bool CDB::Recover(const std::string& filename, void *callbackDataIn, bool (*reco\n \n bool CDB::VerifyEnvironment(const std::string& walletFile, const fs::path& dataDir, std::string& errorStr)\n {\n-    LogPrintf(\"Using BerkeleyDB version %s\\n\", DbEnv::version(0, 0, 0));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r126116206",
      "id" : 126116206,
      "in_reply_to_id" : 125692442,
      "original_commit_id" : "72c37457cd71a78add957d7f0239ffa260359701",
      "original_position" : 4,
      "path" : "src/wallet/db.cpp",
      "position" : null,
      "pull_request_review_id" : 48570764,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-09-20T14:15:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126116206",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r126116939"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126116939"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why? `vpwallets` is accessed by functions in several of the wallet source files.",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-07-07T10:28:10Z",
      "diff_hunk" : "@@ -35,6 +35,8 @@\n #include <boost/algorithm/string/replace.hpp>\n #include <boost/thread.hpp>\n \n+/** Protects the vpwallets vector */\n+CCriticalSection cs_wallets;\n std::vector<CWalletRef> vpwallets;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r126116939",
      "id" : 126116939,
      "in_reply_to_id" : 125693083,
      "original_commit_id" : "72c37457cd71a78add957d7f0239ffa260359701",
      "original_position" : 6,
      "path" : "src/wallet/wallet.cpp",
      "position" : 6,
      "pull_request_review_id" : 48571644,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-09-20T14:15:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126116939",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "This overlaps significantly with #10762. Not sure how I should ask for review. Perhaps find out which one people think is the priority? Or I could split the `walletinit.cpp` commits into their own PR.",
      "created_at" : "2017-07-07T10:30:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-313646695",
      "id" : 313646695,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-07-07T10:30:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/313646695",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1063656?v=3",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r126117881"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126117881"
         }
      },
      "author_association" : "MEMBER",
      "body" : "On further thought, I think I prefer the names `attachwallet` and `detachwallet`. That gives a bit more distinction from the dump/import RPCs and makes a stronger implication that the new `.dat` file is being loaded and attached as a separate wallet.",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-07-07T10:33:57Z",
      "diff_hunk" : "@@ -2432,6 +2434,133 @@ UniValue getwalletinfo(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue listwallets(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 0)\n+        throw std::runtime_error(\n+            \"listwallets\\n\"\n+            \"Returns a list of currently loaded wallets.\\n\"\n+            \"For full information on the wallet, use \\\"getwalletinfo\\\"\\n\"\n+            \"\\nResult:\\n\"\n+            \"[\\n\"\n+            \"  \\\"walletname\\\": xxxxx,             (string) the wallet name\\n\"\n+            \"   ...\\n\"\n+            \"]\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"listwallets\", \"\")\n+            + HelpExampleRpc(\"listwallets\", \"\")\n+        );\n+\n+    LOCK2(cs_main, cs_wallets);\n+\n+    UniValue obj(UniValue::VARR);\n+\n+    for (CWalletRef pwallet : vpwallets) {\n+\n+        if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {\n+            return NullUniValue;\n+        }\n+\n+        LOCK(pwallet->cs_wallet);\n+\n+        obj.push_back(pwallet->GetName());\n+    }\n+\n+    return obj;\n+}\n+\n+UniValue loadwallet(const JSONRPCRequest& request)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r126117881",
      "id" : 126117881,
      "original_commit_id" : "72c37457cd71a78add957d7f0239ffa260359701",
      "original_position" : 55,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 48572768,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-09-20T14:15:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126117881",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "@jnewbery IMO this one should rebase on the other.",
      "created_at" : "2017-07-07T10:43:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-313649091",
      "id" : 313649091,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-07-07T10:43:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/313649091",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3534524?v=3",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "> IMO this one should rebase on the other.\r\n\r\nMakes logical sense. Downside is that the other is a more significant change, so may take longer to get merged.",
      "created_at" : "2017-07-07T10:46:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-313649650",
      "id" : 313649650,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-07-07T10:46:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/313649650",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1063656?v=3",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "If this really depends on that work then there's no other way than waiting. The other downside is that the other commits will show up here too.",
      "created_at" : "2017-07-07T10:54:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-313650941",
      "id" : 313650941,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-07-07T10:54:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/313650941",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3534524?v=3",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "I've changed the PR sequence, so this will now depend on #10767. If I get positive concept feedbac on #10767 I'll rebase this on top of it.\r\n\r\nFor now, I'm still just looking for concept feedback.",
      "created_at" : "2017-07-07T15:09:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-313709042",
      "id" : 313709042,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-07-07T15:09:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/313709042",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1063656?v=3",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r126312681"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126312681"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I had the idea that `walletinit.h/.c` is kind of the multiwallet interface (wallet manager). The functions we have there (`DeleteWallets()`, `VerifyWallets()`, `ShutdownWallets();`, etc.) sounded for me after `vpwallets` belongs there... \r\n\r\nIMO, the multiwallet map should ideally not sit within the objects (`CWallet`) implementation.\r\n",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-07-09T18:58:20Z",
      "diff_hunk" : "@@ -35,6 +35,8 @@\n #include <boost/algorithm/string/replace.hpp>\n #include <boost/thread.hpp>\n \n+/** Protects the vpwallets vector */\n+CCriticalSection cs_wallets;\n std::vector<CWalletRef> vpwallets;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r126312681",
      "id" : 126312681,
      "in_reply_to_id" : 125693083,
      "original_commit_id" : "72c37457cd71a78add957d7f0239ffa260359701",
      "original_position" : 6,
      "path" : "src/wallet/wallet.cpp",
      "position" : 6,
      "pull_request_review_id" : 48784550,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-09-20T14:15:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126312681",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Rebased on #10767 . Reviewers, please review #10767 first.",
      "created_at" : "2017-08-28T21:21:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-325485732",
      "id" : 325485732,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-08-28T21:21:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/325485732",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased now that #10767 is merged. Still a work in progress. PR text updated.",
      "created_at" : "2017-09-11T16:31:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-328584502",
      "id" : 328584502,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-09-11T16:31:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/328584502",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Bad automatic merge of the testcase. Re-merged manually.",
      "created_at" : "2017-09-20T14:16:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-330865431",
      "id" : 330865431,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-09-20T14:16:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/330865431",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Manual rebase fixed the test bug. Travis now passes.\r\n\r\nThis is ready for initial review.",
      "created_at" : "2017-09-20T16:51:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-330913386",
      "id" : 330913386,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-09-20T16:51:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/330913386",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140187095"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140187095"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`{`.",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-09-21T09:07:28Z",
      "diff_hunk" : "@@ -484,16 +484,19 @@ void BitcoinApplication::initializeResult(bool success)\n         window->setClientModel(clientModel);\n \n #ifdef ENABLE_WALLET\n-        // TODO: Expose secondary wallets\n-        if (!vpwallets.empty())\n         {\n-            walletModel = new WalletModel(platformStyle, vpwallets[0], optionsModel);\n-\n-            window->addWallet(BitcoinGUI::DEFAULT_WALLET, walletModel);\n-            window->setCurrentWallet(BitcoinGUI::DEFAULT_WALLET);\n-\n-            connect(walletModel, SIGNAL(coinsSent(CWallet*,SendCoinsRecipient,QByteArray)),\n-                             paymentServer, SLOT(fetchPaymentACK(CWallet*,const SendCoinsRecipient&,QByteArray)));\n+            // TODO: Expose secondary wallets\n+            LOCK(cs_wallets);\n+            if (!vpwallets.empty())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140187095",
      "id" : 140187095,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 16,
      "path" : "src/qt/bitcoin.cpp",
      "position" : 16,
      "pull_request_review_id" : 64221162,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-09-21T09:51:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140187095",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140187207"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140187207"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Missing spaces after `,`?",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-09-21T09:08:01Z",
      "diff_hunk" : "@@ -484,16 +484,19 @@ void BitcoinApplication::initializeResult(bool success)\n         window->setClientModel(clientModel);\n \n #ifdef ENABLE_WALLET\n-        // TODO: Expose secondary wallets\n-        if (!vpwallets.empty())\n         {\n-            walletModel = new WalletModel(platformStyle, vpwallets[0], optionsModel);\n-\n-            window->addWallet(BitcoinGUI::DEFAULT_WALLET, walletModel);\n-            window->setCurrentWallet(BitcoinGUI::DEFAULT_WALLET);\n-\n-            connect(walletModel, SIGNAL(coinsSent(CWallet*,SendCoinsRecipient,QByteArray)),\n-                             paymentServer, SLOT(fetchPaymentACK(CWallet*,const SendCoinsRecipient&,QByteArray)));\n+            // TODO: Expose secondary wallets\n+            LOCK(cs_wallets);\n+            if (!vpwallets.empty())\n+            {\n+                walletModel = new WalletModel(platformStyle, vpwallets[0], optionsModel);\n+\n+                window->addWallet(BitcoinGUI::DEFAULT_WALLET, walletModel);\n+                window->setCurrentWallet(BitcoinGUI::DEFAULT_WALLET);\n+\n+                connect(walletModel, SIGNAL(coinsSent(CWallet*,SendCoinsRecipient,QByteArray)),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140187207",
      "id" : 140187207,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 23,
      "path" : "src/qt/bitcoin.cpp",
      "position" : 23,
      "pull_request_review_id" : 64221162,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-09-21T09:51:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140187207",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140194543"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140194543"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Throw an error if `-salvagewallet` an there are multiple wallets?",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-09-21T09:39:58Z",
      "diff_hunk" : "@@ -185,51 +185,23 @@ bool VerifyWallets()\n \n     uiInterface.InitMessage(_(\"Verifying wallet(s)...\"));\n \n-    // Keep track of each wallet absolute path to detect duplicates.\n-    std::set<fs::path> wallet_paths;\n+    std::vector<std::string> wallet_files = gArgs.GetArgs(\"-wallet\");\n \n-    for (const std::string& walletFile : gArgs.GetArgs(\"-wallet\")) {\n-        if (boost::filesystem::path(walletFile).filename() != walletFile) {\n-            return InitError(strprintf(_(\"Error loading wallet %s. -wallet parameter must only specify a filename (not a path).\"), walletFile));\n-        }\n+    // -salvagewallet can only be used when loading a single wallet\n+    bool salvage_wallet = gArgs.GetBoolArg(\"-salvagewallet\", false) && wallet_files.size() <= 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140194543",
      "id" : 140194543,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 13,
      "path" : "src/wallet/init.cpp",
      "position" : 13,
      "pull_request_review_id" : 64221162,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-09-21T09:51:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140194543",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140195791"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140195791"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Why not just `LOCK(cs_wallets)` too?",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-09-21T09:45:52Z",
      "diff_hunk" : "@@ -37,6 +37,7 @@ static const std::string WALLET_ENDPOINT_BASE = \"/wallet/\";\n \n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n+    AssertLockHeld(cs_wallets);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140195791",
      "id" : 140195791,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 4,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 4,
      "pull_request_review_id" : 64221162,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-09-21T09:51:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140195791",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for the review @promag!\r\n\r\nRegarding the locking: Yes, I've implemented this as a mutex for now, which as you point out would limit wallet RPCs to be single-threaded. I'd like to update this to be something a bit better before v0.16. Suggestions are either a shared mutex or (suggested by @theuni) a version of the decay pointers in #10738. The problem with using a shared mutex is that C++ doesn't have a standard library shared mutex until C++14 (std::shared_timed_mutex) so I'd either have to use boost::shared_mutex or roll my own.\r\n\r\n(apologies - I thought I'd already written a note in this PR explaining this, but I must have failed to hit send!)\r\n\r\nFor now, I think review of this PR with the mutex is helpful, and I'll change it around to use a shared_mutex later.",
      "created_at" : "2017-09-21T13:43:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-331160327",
      "id" : 331160327,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-09-21T13:43:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/331160327",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140244534"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140244534"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Because I'd prefer to avoid recursive locking if possible.",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-09-21T13:44:01Z",
      "diff_hunk" : "@@ -37,6 +37,7 @@ static const std::string WALLET_ENDPOINT_BASE = \"/wallet/\";\n \n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n+    AssertLockHeld(cs_wallets);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140244534",
      "id" : 140244534,
      "in_reply_to_id" : 140195791,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 4,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 4,
      "pull_request_review_id" : 64288061,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-09-21T13:44:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140244534",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140244708"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140244708"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Sounds like a sensible change in behaviour. I think it's beyond the scope of this PR.",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-09-21T13:44:33Z",
      "diff_hunk" : "@@ -185,51 +185,23 @@ bool VerifyWallets()\n \n     uiInterface.InitMessage(_(\"Verifying wallet(s)...\"));\n \n-    // Keep track of each wallet absolute path to detect duplicates.\n-    std::set<fs::path> wallet_paths;\n+    std::vector<std::string> wallet_files = gArgs.GetArgs(\"-wallet\");\n \n-    for (const std::string& walletFile : gArgs.GetArgs(\"-wallet\")) {\n-        if (boost::filesystem::path(walletFile).filename() != walletFile) {\n-            return InitError(strprintf(_(\"Error loading wallet %s. -wallet parameter must only specify a filename (not a path).\"), walletFile));\n-        }\n+    // -salvagewallet can only be used when loading a single wallet\n+    bool salvage_wallet = gArgs.GetBoolArg(\"-salvagewallet\", false) && wallet_files.size() <= 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140244708",
      "id" : 140244708,
      "in_reply_to_id" : 140194543,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 13,
      "path" : "src/wallet/init.cpp",
      "position" : 13,
      "pull_request_review_id" : 64288260,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-09-21T13:44:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140244708",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This seems to ignore the whole issue of long-term wallet references, and probably locks `cs_wallets` too long.",
      "created_at" : "2017-09-21T20:03:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-331265958",
      "id" : 331265958,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-09-21T20:03:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/331265958",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140364335"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140364335"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Just curious, why?",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-09-21T21:30:33Z",
      "diff_hunk" : "@@ -37,6 +37,7 @@ static const std::string WALLET_ENDPOINT_BASE = \"/wallet/\";\n \n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n+    AssertLockHeld(cs_wallets);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140364335",
      "id" : 140364335,
      "in_reply_to_id" : 140195791,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 4,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 4,
      "pull_request_review_id" : 64428676,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-09-21T21:30:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140364335",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "Adding 0.16.0 milestone, I think this should be merged after 0.15.1 to prevent extra rebasing in the wallet code when porting back to 0.15.1.",
      "created_at" : "2017-09-28T06:44:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-332742893",
      "id" : 332742893,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-09-28T06:44:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/332742893",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r142575733"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142575733"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Unneeded newline.",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-10-04T03:45:27Z",
      "diff_hunk" : "@@ -2694,6 +2694,54 @@ UniValue openwallet(const JSONRPCRequest& request)\n \n }\n \n+UniValue closewallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"closewallet \\\"walletname\\\"\\n\"\n+            \"\\nCloses a wallet.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"walletname\\\"    (string, required) The wallet name\\n\"\n+            \"\\nExamples:\\n\"\n+            \"\\nResult:\\n\"\n+            \"true|false       (boolean) Whether the wallet was unloaded successfully.\\n\"\n+            + HelpExampleCli(\"closewallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"closewallet\", \"\\\"test.dat\\\"\")\n+        );\n+\n+    LOCK(cs_wallets);\n+\n+    std::string walletName = request.params[0].get_str();\n+\n+    bool unloaded = false;\n+\n+    for (std::vector<CWalletRef>::iterator wallet_iter = vpwallets.begin(); wallet_iter != vpwallets.end(); wallet_iter++) {\n+\n+        if (!EnsureWalletIsAvailable(*wallet_iter, request.fHelp)) {\n+            throw JSONRPCError(RPC_WALLET_ERROR, \"Error accessing wallets\");\n+        }\n+\n+        if ((*wallet_iter)->GetName() == walletName) {\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r142575733",
      "id" : 142575733,
      "original_commit_id" : "e188d00eceb20ab20f091e2301386f84574bee6d",
      "original_position" : 32,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 393,
      "pull_request_review_id" : 66954949,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-10-04T04:03:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142575733",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r142575805"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142575805"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Any reason for not just doing `for (auto wallet : vpwallets) {` here?",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-10-04T03:46:25Z",
      "diff_hunk" : "@@ -2694,6 +2694,54 @@ UniValue openwallet(const JSONRPCRequest& request)\n \n }\n \n+UniValue closewallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"closewallet \\\"walletname\\\"\\n\"\n+            \"\\nCloses a wallet.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"walletname\\\"    (string, required) The wallet name\\n\"\n+            \"\\nExamples:\\n\"\n+            \"\\nResult:\\n\"\n+            \"true|false       (boolean) Whether the wallet was unloaded successfully.\\n\"\n+            + HelpExampleCli(\"closewallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"closewallet\", \"\\\"test.dat\\\"\")\n+        );\n+\n+    LOCK(cs_wallets);\n+\n+    std::string walletName = request.params[0].get_str();\n+\n+    bool unloaded = false;\n+\n+    for (std::vector<CWalletRef>::iterator wallet_iter = vpwallets.begin(); wallet_iter != vpwallets.end(); wallet_iter++) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r142575805",
      "id" : 142575805,
      "original_commit_id" : "e188d00eceb20ab20f091e2301386f84574bee6d",
      "original_position" : 25,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 386,
      "pull_request_review_id" : 66954949,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-10-04T04:03:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142575805",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r142576776"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142576776"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ugh, passwords on prompts leaves the password as plaintext in shell history etc. Can't really be fixed for HTTP-RPC I guess, but CLI could *probably* take a bool to mean \"prompt me for password\".",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-10-04T03:59:58Z",
      "diff_hunk" : "@@ -2658,35 +2658,53 @@ UniValue listwallets(const JSONRPCRequest& request)\n \n UniValue openwallet(const JSONRPCRequest& request)\n {\n-    if (request.fHelp || request.params.size() != 1)\n+    if (request.fHelp || request.params.size() > 2)\n         throw std::runtime_error(\n-            \"openwallet \\\"filename\\\"\\n\"\n+            \"openwallet \\\"filename\\\" (\\\"passphrase\\\")\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r142576776",
      "id" : 142576776,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 8,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 66954949,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-10-04T04:03:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142576776",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r142576837"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142576837"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Description is wrong.",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-10-04T04:00:41Z",
      "diff_hunk" : "@@ -2658,35 +2658,53 @@ UniValue listwallets(const JSONRPCRequest& request)\n \n UniValue openwallet(const JSONRPCRequest& request)\n {\n-    if (request.fHelp || request.params.size() != 1)\n+    if (request.fHelp || request.params.size() > 2)\n         throw std::runtime_error(\n-            \"openwallet \\\"filename\\\"\\n\"\n+            \"openwallet \\\"filename\\\" (\\\"passphrase\\\")\\n\"\n             \"\\nOpens a wallet from a wallet.dat file.\\n\"\n+            \"\\nUse the passphrase argument to unlock an encrypted wallet while opening.\\n\"\n             \"\\nArguments:\\n\"\n             \"1. \\\"filename\\\"    (string, required) The wallet.dat file\\n\"\n+            \"2. \\\"passphrase\\\"    (string, optional) The wallet.dat file\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r142576837",
      "id" : 142576837,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 13,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 66954949,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-10-04T04:03:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142576837",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Needs rebase.\r\n\r\nThe `openwallet` should rescan?",
      "created_at" : "2017-10-11T14:31:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-335830369",
      "id" : 335830369,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-10-11T14:31:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/335830369",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK.\r\n\r\nI was able to use `openwallet` and `closewallet`.\r\n\r\nI wonder how this interacts with #11383. E.g. I'm guessing the UI wouldn't pick up on this (not a big issue). I can try once both are rebased.\r\n\r\nIt would be nice if `bitcoin-cli -rpcwallet=X` would open `X` if it's not open yet, maybe close it when done (future PR). \r\n\r\n> Should there be a separate RPC for creating a new wallet or should that be done using openwallet? (my initial thoughts are that there should be a separate RPC)\r\n\r\nI would prefer it if `openwallet` fails for wallets that don't exist, rather than creating a new wallet. I understand it makes sense for `bitcoind -wallet` to create a new one, because that's what a new user would expect, but I don't think that's needed for `openwallet`.",
      "created_at" : "2017-11-20T15:56:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-345738713",
      "id" : 345738713,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-11-20T15:56:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/345738713",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@Sjors this PR must be rebased with #11383 (probably when that gets merged).",
      "created_at" : "2017-11-20T16:29:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-345749571",
      "id" : 345749571,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-11-20T16:29:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/345749571",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r154538661"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/154538661"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, definitely. cs_wallets is locked *before* cs_main in global lock order, so putting it too many places is just asking for trouble, IMO.",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-12-03T22:13:55Z",
      "diff_hunk" : "@@ -37,6 +37,7 @@ static const std::string WALLET_ENDPOINT_BASE = \"/wallet/\";\n \n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n+    AssertLockHeld(cs_wallets);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r154538661",
      "id" : 154538661,
      "in_reply_to_id" : 140195791,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 4,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 4,
      "pull_request_review_id" : 80715388,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-12-03T22:13:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/154538661",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r154538714"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/154538714"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Tend to agree with @jonasschnelli here, though I agree the barrier isn't exactly clear (yet). Ideally we'd move more towards clarifying the interface here - making CWallet less and less aware of all the things around it (including other wallets). @sipa thoughts here?",
      "commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "created_at" : "2017-12-03T22:15:50Z",
      "diff_hunk" : "@@ -35,6 +35,8 @@\n #include <boost/algorithm/string/replace.hpp>\n #include <boost/thread.hpp>\n \n+/** Protects the vpwallets vector */\n+CCriticalSection cs_wallets;\n std::vector<CWalletRef> vpwallets;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r154538714",
      "id" : 154538714,
      "in_reply_to_id" : 125693083,
      "original_commit_id" : "72c37457cd71a78add957d7f0239ffa260359701",
      "original_position" : 6,
      "path" : "src/wallet/wallet.cpp",
      "position" : 6,
      "pull_request_review_id" : 80715456,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2017-12-03T22:16:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/154538714",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Needs rebase\r\n\r\n> Should there be a separate RPC for creating a new wallet or should that be done using openwallet? (my initial thoughts are that there should be a separate RPC)\r\n\r\nI suggest there should be a new RPC command to create new wallets. Aside from least surprise, there is more than one type of wallet that the user could want created.",
      "created_at" : "2017-12-30T09:03:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-354535414",
      "id" : 354535414,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-12-30T09:03:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/354535414",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/93665?v=4",
         "events_url" : "https://api.github.com/users/wtogami/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wtogami/followers",
         "following_url" : "https://api.github.com/users/wtogami/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wtogami/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wtogami",
         "id" : 93665,
         "login" : "wtogami",
         "organizations_url" : "https://api.github.com/users/wtogami/orgs",
         "received_events_url" : "https://api.github.com/users/wtogami/received_events",
         "repos_url" : "https://api.github.com/users/wtogami/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wtogami/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wtogami/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wtogami"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Needs rebase and issues (@ryanofsky) addressed.",
      "created_at" : "2018-01-04T07:22:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-355215094",
      "id" : 355215094,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-01-04T07:22:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/355215094",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Closing the wallet that is in use by qt (the one at `vpwallets[0]` will result in a crash. So additional handling for Qt stuff is needed.",
      "created_at" : "2018-02-14T04:13:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-365491018",
      "id" : 365491018,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-02-14T04:14:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/365491018",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I plan to pick this up again in the next few days. it requires:\r\n\r\n- rebasing on top of all the recent wallet refactors\r\n- addressing the locking issues (potentially pulling in #11402)\r\n- considering how this interacts with multiwallet in the GUI #12610\r\n- potentially pulling out the Verify and Flush refactoring commits into their own PR (https://github.com/bitcoin/bitcoin/pull/10740#pullrequestreview-84849103)",
      "created_at" : "2018-04-10T20:15:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-380232134",
      "id" : 380232134,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-04-10T20:15:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/380232134",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
