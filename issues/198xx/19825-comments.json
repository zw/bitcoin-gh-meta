[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Because bans have specific durations I'm not sure if this is a good change.  Should a 1 hour ban of foo/16 stop you from adding a 1 year ban of foo/24? \r\n\r\nRight now I already have to undo every ban before adding it to make sure it's not rejected and as a result ends up expiring prematurely.  But if any wider banned blocked every narrower ban, I'm not sure how I could programmatically handle that.  I'd have to have crazy logic interrogated the banlist and broke every larger ban into smaller ones when a smaller one with a different time period was added.\r\n\r\nInstead, I think it should just be consistent in that each ban doesn't interact with an different ban. And when I add a ban for an already existing prefix, it should extend the ban if the new one has a later expiration time.  It would be fine to canonicalize actually equivalent bans (e.g. 1.2.3.4/24 = 1.2.3.0/24).",
      "created_at" : "2020-08-28T00:36:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-682259857",
      "id" : 682259857,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MjI1OTg1Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-28T00:39:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/682259857",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26261](https://github.com/bitcoin/bitcoin/pull/26261) (p2p: cleanup `LookupIntern`, `Lookup` and `LookupHost` by brunoerg)\n* [#26078](https://github.com/bitcoin/bitcoin/pull/26078) (p2p: return `CSubNet` in `LookupSubNet` by brunoerg)\n* [#24097](https://github.com/bitcoin/bitcoin/pull/24097) (Replace RecursiveMutex m_cs_banned with Mutex, and rename it by hebasto)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-08-28T03:23:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-682303669",
      "id" : 682303669,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MjMwMzY2OQ==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/682303669/reactions"
      },
      "updated_at" : "2022-10-12T02:29:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/682303669",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I'm not sure how I could programmatically handle that. I'd have to have crazy logic interrogated the banlist and broke every larger ban into smaller ones when a smaller one with a different time period was added.\r\n\r\nTotally fair. I can't see either how clients will be able to make tooling with sane logic. I am going to think this through and update the PR with a better solution. Thanks for the feedback and a potential solution, @gmaxwell !",
      "created_at" : "2020-08-28T06:59:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-682363772",
      "id" : 682363772,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MjM2Mzc3Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-28T07:00:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/682363772",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK on making this consistent. I'll review once you have an updated proposal that addresses gmaxwell's input.",
      "created_at" : "2020-08-28T07:06:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-682365929",
      "id" : 682365929,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MjM2NTkyOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-28T07:06:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/682365929",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "### Potential solution\r\n\r\nLet `(s0, t0)` be an existing ban, where `s0` is a subnet and `t0` is the ban expiration time. The user is now trying to add another ban `(s1, t1)`.\r\n\r\n**Case s1 â s0:**\r\nIf `t1 <= t0`: return success because the end goal is accomplished - this will minimize client error handling\r\nIf `t1 > t0`: insert `(s1, t1)` into `BanMan`\r\n\r\n**Case s1 â s0:**\r\nIf `t1 <= t0`: insert `(s1, t1)` into `BanMan`\r\nIf `t1 > t0`: remove `(s0, t0)`, add `(s1, t1)` into `BanMan`\r\n\r\n**Case no overlap:**\r\ninsert `(s1, t1)` into `BanMan`\r\n\r\n**Unban**:\r\nWe will treat unbanning consistent with the semantics of the rpc call: `setban ip remove` i.e. it is the _removal of a ban entry_, not the _addition of an unban entry_. Effectively, unbanning will look for exact matches of ban entries to remove.\r\n\r\nThoughts, @gmaxwell, @jnewbery ?",
      "created_at" : "2020-08-28T23:24:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-683187822",
      "id" : 683187822,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MzE4NzgyMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-02T04:38:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/683187822",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think that approach makes sense; it's equivalent to treating every ban as a per-IP thing, and remembering the longest-duration ban for each.\r\n\r\nOne question I have is how to make clearbanned consistent with that? This is a bit confusing:\r\n* ban `1.2.3.0/24` for 1h\r\n* ban `1.2.0.0/16` for 2h -> overwrites the previous ban\r\n* unban `1.2.3.0/24` -> failure because no such ban exists\r\n\r\nAnd this:\r\n* ban `1.2.3.0/24` for 1h\r\n* ban `1.2.3.4/32` for 2h -> add a longer ban for smaller range\r\n* unban `1.2.3.0/24` -> works, but leaves 1.2.3.4/32 banned\r\n\r\nWhile:\r\n* ban `1.2.3.0/24` for 2h\r\n* ban `1.2.3.4/32` for 1h -> doesn't do anything\r\n* unban `1.2.3.0/24` -> works, and doesn't leave 1.2.3.4/32 banned\r\n\r\n\r\nI think the most reasonable thing requiring an exact match for *some* ban record when unbanning, but also make it delete all (longer) subranges?\r\n\r\n",
      "created_at" : "2020-08-29T18:36:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-683327324",
      "id" : 683327324,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MzMyNzMyNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-29T18:41:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/683327324",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I don't really like the banning add removal doing fancy logic.  This will make it extremely hard to have external software add bans, even with the newly proposed behaviour.  It's also unlike access-lists on any networking device I've ever worked with.\r\n\r\nWhat is the downside of the obvious behaviour? There is a list of bans, some of which are shorter-than-maximum-CIDR,  add adds to the list, clear removes from it.  If you have overlapping bans, ... so?  You might expect them to have different durations, or they may come from different sources.\r\n\r\nThe only limitation I'm aware with that approach is that if you want to remove a ban affecting a specific host or subnet more care might be required to remove *all*...  but that could be addressed with a \"removeall\"  e.g.\r\n\r\n```\r\nsetban 1.2/16 add\r\nsetban 1.2.3/24 add\r\nsetban 1.2.3.5/32 remove #does nothing\r\nsetban 1.2.3.5/32 removeall  #removes the 1.2/16 and the 1.2.3/24 ban\r\n```\r\n\r\nThen you can get exact management of the ban list via add/remove,  but also get a \"just make this host work\" removal if that's what you want.  This also doesn't make the resulting banlist depend on the order that you did the insertions, which I believe the logic proposed a few messages up would do (e.g. if you insert less specific then more specific you won't get the same result as more than less (as their times won't match, so in one case you'll just get the less specific and the other case you'll get both).\r\n\r\nI also have a preference for not returning errors when the action the user wants is accomplished, I've had more than a few people using my ban list complain about the wall of errors when they update... though assuming it didn't return an error when it extended the duration, I think that issue would already be eliminated by the changes we've discussed.",
      "created_at" : "2020-08-30T03:49:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-683372477",
      "id" : 683372477,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MzM3MjQ3Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-30T03:56:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/683372477",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I agree with the idea that we should interpret `setban ip/mask add time` as \"add a ban entry for this address range\", and not as \"add a ban entry on each single address in the range\". This way of thinking allows for overlapping bans.\r\n\r\nI also agree that unintended side effects like `setban 127.0.0.1/32 remove` removing the ban entry for `127.0.0.1/24` is not good as it means client scripts need to maintain banlist state and execute logic prior to, and after, unbanning.\r\n\r\nFurther agree, on not returning an error when the user intent is accomplished (by a pre-existing ban entry) even if it does not create a new ban entry - I will update the code to reflect that. (Updated the proposal above as well)\r\n\r\n`removeall` is a good idea, perhaps better named `force-remove` and implemented in a follow-up PR? I am open to adding it in here if we believe we need it for atomic commits.\r\n\r\nThe one thing I am unsure about is not consolidating ban entries where possible. In my rookie opinion, `BanEntry{127.0.0.1/32 200}` should be replaced with `{BanEntry 127.0.0.1/24 400}` instead of just having an additional \"dead\" entry. Unnecessary ban entries make every call to `BanMan::IsBanned` a tiny bit more expensive, which makes opening new connections, accepting new connections, and `PeerLogicValidation::ProcessMessage/addr` more expensive. I am new here and don't yet have a good intuitive sense for the frequency of those invocations but it seems like an expense to avoid? \r\n\r\nAfter a couple attempts, I am not able to see how [this proposal](https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-683187822) will mean the banlist will depend on the order of insertions _so long as `banUntil` times are consistent_. I feel sure I'm missing something. Could you please give an example, @gmaxwell ?",
      "created_at" : "2020-08-30T05:19:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-683377943",
      "id" : 683377943,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MzM3Nzk0Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-30T05:27:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/683377943",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The most common usage is a relative time, so the times won't be consistent. :)",
      "created_at" : "2020-08-30T05:55:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-683380125",
      "id" : 683380125,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MzM4MDEyNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-30T05:55:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/683380125",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Ah, I see. So it's safe to say that the banlist would not depend on the order of insertions.",
      "created_at" : "2020-08-30T06:46:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-683383582",
      "id" : 683383582,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MzM4MzU4Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-30T06:46:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/683383582",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I think it would with what you're suggesting.  You're suggesting that if there is a shorter wider block, and I insert a longer narrower block-- both get added.  But if there is a shorter narrower block and I add a longer wider block the shorter block is removed.\r\n\r\nIf I give both a relative lifetime of 1 day then make the two calls a second apart, then the resulting set of bans depends on the order.\r\n\r\n",
      "created_at" : "2020-08-30T09:13:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-683396285",
      "id" : 683396285,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MzM5NjI4NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-30T09:13:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/683396285",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@gmaxwell I still think we are in agreement that _equivalent_ `setban` instructions will produce _identical_ banlists. We seem to be disagreeing as to whether the following two sets of RPC instructions are _equivalent_:\r\n\r\nScript 1:\r\n```\r\nsetban 127.0.0.0/24 add\r\nsleep 1\r\nsetban 127.0.0.0/32 add\r\n```\r\n\r\nScript 2:\r\n```\r\nsetban 127.0.0.0/32 add\r\nsleep 1\r\nsetban 127.0.0.0/24 add\r\n```\r\n\r\nUnless I am missing something, per the current RPC semantics, these are not equivalent instructions and the node will behave differently. In order for the node to behave differently and comply with the instructions, the banlists will have to be different.\r\n\r\nFor the use case you are trying to accomplish (atomic, bulk additions with relative timestamps), I think there are two ways we can be successful:\r\n1. Update the scripts to convert relative times into absolute times\r\n2. Let's scope and work on a new, `addall` rpc which can provide bulk atomic commits to the banlist. I volunteer to take it on if we have consensus.\r\n\r\nI think another interesting thing this conversation highlights is our expectation of where canonical state lives. i.e. Do we expect that `listbanned` will return a cumulative of past `setban` instructions (thereby agreeing with state maintained client-side), or whether `listbanned` is only responsible for painting a canonical picture of the current ban entries. I personally prefer the latter because: (a) Clients should not assume state cannot change as that assumes there are no other clients and (b) Fewer ban entries seems more efficient for the p2p layer.",
      "created_at" : "2020-08-30T17:48:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-683449495",
      "id" : 683449495,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MzQ0OTQ5NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-30T17:48:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/683449495",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "## Current state of this PR\r\n\r\n### What does the current patch at tip `9cc54bd` do?\r\nIt tries to make `setban` behave consistently whether it is provided with an IP address, or a subnet (IP address range).\r\n\r\nLet `(s0, t0)` be an existing ban, where `s0` is a subnet(a contiguous range of IP addresses) and `t0` is the ban expiration time. The user is now trying to add another ban `(s1, t1)`. If `s1 â s0 &&  t1 <= t0` the code does nothing because the requested ban is already in place. If `s1 â s0 && t1 > t0`, we remove `(s0, t0)`, add `(s1, t1)` to consolidate the ban entries. In all other cases we add `(s1, t1)`. More details [here](https://github.com/bitcoin/bitcoin/pull/19825#issue-475008180).\r\n\r\n### What is the unaddressed concern expressed by reviewers?\r\nA reviewer feels that we should not consolidate the ban entries, instead allow redundant ban entries in `BanMan::m_banned`. It is their opinion that this will help keep their existing client scripts simpler. The case they make is that the following scripts should generate identical banlists:\r\n\r\nScript 1:\r\n```\r\nsetban 127.0.0.0/24 add\r\nsleep 1\r\nsetban 127.0.0.0/32 add\r\n```\r\n\r\nScript 2:\r\n```\r\nsetban 127.0.0.0/32 add\r\nsleep 1\r\nsetban 127.0.0.0/24 add\r\n```\r\n\r\nNote: Per current `setban` RPC semantics, `setban ip/subnet add` means, \"ban this ip/subnet for 1 day (86400 seconds)\". i.e. `subnet 127.0.0.0/24 add` == `setban 127.0.0.0/24 add 86400`\r\n\r\n### What is the author's response?\r\nThe author feels that the aforementioned scripts (say, run at t=0) are not equivalent, and therefore produce different banlists. \r\n\r\nScript 1:\r\n```\r\nt=0 \"Ban 127.0.0.0/24 until t=86400\"\r\nt=1 \"Ban 127.0.0.0/32 until t=86401\"\r\n```\r\nAt `t=1`, the node must remember two ban entries `(127.0.0.0/24, 86400)`, `(127.0.0.0/32, 86401)`.\r\n\r\nScript 2:\r\n```\r\nt=0 \"Ban 127.0.0.0/32 until t=86400\"\r\nt=1 \"Ban 127.0.0.0/24 until t=86401\"\r\n```\r\nAt `t=1`, it suffices for the node to only remember `(127.0.0.0/24, 86401)` as `(127.0.0.0/32 â 127.0.0.0/24) && (86400 <= 86401)`.\r\n\r\nThe author also feels that not consolidating ban entries when possible (and cheap) creates expense in looking up `BanMan::IsBanned(subnet)` which is done when new peers are added, or when the `addr` RPC is processed. The author agrees the overhead is seems minimal and infrequent.\r\n\r\n### How can reviewers help?\r\nThe author is new to Bitcoin development and will continue to keep an open mind. Any case that can be made in interest of the node efficiency or the Bitcoin network, or shows that the proposed change violates established RPC semantics/expectations and therefore is backwards incompatible would help make the case to no longer consolidate ban entries.",
      "created_at" : "2020-09-06T19:38:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-687880953",
      "id" : 687880953,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4Nzg4MDk1Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-06T19:39:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/687880953",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I agree with @gmaxwell's suggestion here: https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-683372477 that we shouldn't try to do any clever logic.\r\n\r\nI think the behaviour should be:\r\n\r\n- for `setban add`:\r\n    - Convert the IP address/net into the canonical CIDR subnet representation\r\n    - If that subnet is not already banned, add an entry\r\n    - If that subnet is already banned:\r\n        - if the new expiry is after old expiry, update the entry to the new expiry (i.e. `setban add` can extend an existing ban)\r\n        - if the new expiry is before the old expiry, don't update the entry to the new expiry (i.e. `setban add` can't shorten an existing ban)\r\n- for `setban remove`:\r\n    - Convert the IP address/net into the canonical CIDR subet representation\r\n    - If that subnet is already banned, remove the ban\r\n\r\nand then add two new commands:\r\n\r\n- `setban list` (only accepts a single IP address, not a subnet): lists all current ban entries that contain that IP address\r\n- `setban removeall` (only accepts a single IP address, not a subnet): removes all current ban entries that contain that IP address",
      "created_at" : "2020-09-28T09:29:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-699893518",
      "id" : 699893518,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5OTg5MzUxOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-28T16:14:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/699893518",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thank you for the kind review, @jnewbery. I've heard the same opinion from another casual in-person conversation. It seems like @practicalswift agrees as well. Sounds like there is consensus that simplicity of logic wins over performance in this case, especially given the minimal overhead. I will re-work the PR this week.",
      "created_at" : "2020-09-28T15:30:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-700088723",
      "id" : 700088723,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMDA4ODcyMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-28T15:30:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700088723",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@jnewbery @gmaxwell @practicalswift I've changed the code to reflect what we agreed on. \r\n\r\n### Objectives:\r\n1. Consolidate `BanMan` functions\r\n2. Throw fewer RPC errors. If user intent is accomplished, the command is successful even if no change was made.\r\n\r\n### Changes:\r\n- Remove `BanMan::Ban(CNetAddr&)` and use `BanMan::Ban(CSubNet&)` instead (ips are subnets of one)\r\n  - RPC change: `setban subnet/ip add` now allows adding a ban entry for an ip in an already banned subnet. No error will be thrown so long as the user intent is accomplished.\r\n- Remove `BanMan::Unban(CNetAddr&)` and use `BanMan::Unban(CSubNet&)` instead (ips are subnets of one)\r\n  - RPC change: Unbanning a non-banned subnet will no longer raise an rpc error as user intent is accomplished.\r\n- Remove unused `BanMan::IsBanned(CSubNet&)`\r\n- RPC change: Add `setban ip removeall` to remove all ban entries that include an IP address\r\n- RPC change: Add `listbanned ip` to return all ban entries that include an IP address",
      "created_at" : "2020-12-14T07:30:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-744235473",
      "id" : 744235473,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0NDIzNTQ3Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-14T07:30:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/744235473",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Force pushed again to alter commit messages. Ready for review.",
      "created_at" : "2020-12-14T07:44:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-744243806",
      "id" : 744243806,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0NDI0MzgwNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-14T07:44:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/744243806",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r550812551"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550812551"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Should this be switching on a range of cases 0 to 8 now?",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-01T22:10:14Z",
      "diff_hunk" : "@@ -38,11 +38,6 @@ void test_one_input(const std::vector<uint8_t>& buffer)\n         BanMan ban_man{banlist_file, nullptr, ConsumeBanTimeOffset(fuzzed_data_provider)};\n         while (fuzzed_data_provider.ConsumeBool()) {\n             switch (fuzzed_data_provider.ConsumeIntegralInRange<int>(0, 11)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r550812551",
      "id" : 550812551,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDgxMjU1MQ==",
      "original_commit_id" : "a39cca4266813711d3b76a7f31c770e55df1ffd4",
      "original_line" : 40,
      "original_position" : 3,
      "original_start_line" : null,
      "path" : "src/test/fuzz/banman.cpp",
      "position" : null,
      "pull_request_review_id" : 560608091,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550812551",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r550813836"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550813836"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: sort alphabetically",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-01T22:24:46Z",
      "diff_hunk" : "@@ -9,6 +9,7 @@\n from test_framework.util import (\n     assert_equal,\n     assert_raises_rpc_error,\n+    assert_approx,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r550813836",
      "id" : 550813836,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDgxMzgzNg==",
      "original_commit_id" : "a39cca4266813711d3b76a7f31c770e55df1ffd4",
      "original_line" : 12,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "test/functional/p2p_disconnect_ban.py",
      "position" : null,
      "pull_request_review_id" : 560608091,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550813836",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r550820325"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550820325"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Why not erase as you go and use `m_banned.size()` to infer `m_is_dirty`, instead of constructing a whole new vector?",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-01T23:37:49Z",
      "diff_hunk" : "@@ -159,12 +135,43 @@ bool BanMan::Unban(const CSubNet& sub_net)\n     return true;\n }\n \n-void BanMan::GetBanned(banmap_t& banmap)\n+void BanMan::UnbanAll(const CNetAddr& net_addr)\n+{\n+    {\n+        LOCK(m_cs_banned);\n+        std::vector<CSubNet> entries_to_delete;\n+        for (const auto& it : m_banned) {\n+            CSubNet sub_net = it.first;\n+            if (sub_net.Match(net_addr)) entries_to_delete.push_back(sub_net);\n+        }\n+\n+        if (!entries_to_delete.empty()) m_is_dirty = true;\n+        for (const auto&it : entries_to_delete) {\n+            m_banned.erase(it);\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r550820325",
      "id" : 550820325,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDgyMDMyNQ==",
      "original_commit_id" : "a39cca4266813711d3b76a7f31c770e55df1ffd4",
      "original_line" : 150,
      "original_position" : 79,
      "original_start_line" : 142,
      "path" : "src/banman.cpp",
      "position" : null,
      "pull_request_review_id" : 560608091,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550820325",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r550820394"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550820394"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "same, I wonder if this could just be a `std::remove_if`",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-01T23:38:32Z",
      "diff_hunk" : "@@ -159,12 +135,43 @@ bool BanMan::Unban(const CSubNet& sub_net)\n     return true;\n }\n \n-void BanMan::GetBanned(banmap_t& banmap)\n+void BanMan::UnbanAll(const CNetAddr& net_addr)\n+{\n+    {\n+        LOCK(m_cs_banned);\n+        std::vector<CSubNet> entries_to_delete;\n+        for (const auto& it : m_banned) {\n+            CSubNet sub_net = it.first;\n+            if (sub_net.Match(net_addr)) entries_to_delete.push_back(sub_net);\n+        }\n+\n+        if (!entries_to_delete.empty()) m_is_dirty = true;\n+        for (const auto&it : entries_to_delete) {\n+            m_banned.erase(it);\n+        }\n+    }\n+\n+    if (m_client_interface) m_client_interface->BannedListChanged();\n+    DumpBanlist(); //store banlist to disk immediately\n+}\n+\n+void BanMan::GetBanned(banmap_t& banmap, Optional<const CNetAddr&> filterForIp)\n {\n     LOCK(m_cs_banned);\n     // Sweep the banlist so expired bans are not returned\n     SweepBanned();\n     banmap = m_banned; //create a thread safe copy\n+\n+    if (filterForIp) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r550820394",
      "id" : 550820394,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDgyMDM5NA==",
      "original_commit_id" : "a39cca4266813711d3b76a7f31c770e55df1ffd4",
      "original_line" : 163,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "src/banman.cpp",
      "position" : null,
      "pull_request_review_id" : 560608091,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550820394",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r550820714"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550820714"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`RPCArg::Optional::OMITTED_NAMED_ARG`?",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-01T23:43:37Z",
      "diff_hunk" : "@@ -702,7 +686,9 @@ static RPCHelpMan listbanned()\n {\n     return RPCHelpMan{\"listbanned\",\n                 \"\\nList all manually banned IPs/Subnets.\\n\",\n-                {},\n+                {\n+                    {\"ip\", RPCArg::Type::STR, \"all ips\", \"If IP is provided, only bans which include the IP will be returned.\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r550820714",
      "id" : 550820714,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDgyMDcxNA==",
      "original_commit_id" : "a39cca4266813711d3b76a7f31c770e55df1ffd4",
      "original_line" : 690,
      "original_position" : 97,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 560608091,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550820714",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r550885005"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550885005"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Using erase-remove_if is also more efficient - you'll only need to pass over `m_banned` once instead of up to `entries_to_delete.size()` times.",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-02T14:06:28Z",
      "diff_hunk" : "@@ -159,12 +135,43 @@ bool BanMan::Unban(const CSubNet& sub_net)\n     return true;\n }\n \n-void BanMan::GetBanned(banmap_t& banmap)\n+void BanMan::UnbanAll(const CNetAddr& net_addr)\n+{\n+    {\n+        LOCK(m_cs_banned);\n+        std::vector<CSubNet> entries_to_delete;\n+        for (const auto& it : m_banned) {\n+            CSubNet sub_net = it.first;\n+            if (sub_net.Match(net_addr)) entries_to_delete.push_back(sub_net);\n+        }\n+\n+        if (!entries_to_delete.empty()) m_is_dirty = true;\n+        for (const auto&it : entries_to_delete) {\n+            m_banned.erase(it);\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r550885005",
      "id" : 550885005,
      "in_reply_to_id" : 550820325,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDg4NTAwNQ==",
      "original_commit_id" : "a39cca4266813711d3b76a7f31c770e55df1ffd4",
      "original_line" : 150,
      "original_position" : 79,
      "original_start_line" : 142,
      "path" : "src/banman.cpp",
      "position" : null,
      "pull_request_review_id" : 560637706,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550885005",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r550914703"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550914703"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "yeah `erase_if` would be the best but it's C++20 ð­ ",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-02T19:48:45Z",
      "diff_hunk" : "@@ -159,12 +135,43 @@ bool BanMan::Unban(const CSubNet& sub_net)\n     return true;\n }\n \n-void BanMan::GetBanned(banmap_t& banmap)\n+void BanMan::UnbanAll(const CNetAddr& net_addr)\n+{\n+    {\n+        LOCK(m_cs_banned);\n+        std::vector<CSubNet> entries_to_delete;\n+        for (const auto& it : m_banned) {\n+            CSubNet sub_net = it.first;\n+            if (sub_net.Match(net_addr)) entries_to_delete.push_back(sub_net);\n+        }\n+\n+        if (!entries_to_delete.empty()) m_is_dirty = true;\n+        for (const auto&it : entries_to_delete) {\n+            m_banned.erase(it);\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r550914703",
      "id" : 550914703,
      "in_reply_to_id" : 550820325,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDkxNDcwMw==",
      "original_commit_id" : "a39cca4266813711d3b76a7f31c770e55df1ffd4",
      "original_line" : 150,
      "original_position" : 79,
      "original_start_line" : 142,
      "path" : "src/banman.cpp",
      "position" : null,
      "pull_request_review_id" : 560652507,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550914703",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r551148954"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551148954"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yup - could increase test coverage. Done. ",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-04T07:16:32Z",
      "diff_hunk" : "@@ -38,11 +38,6 @@ void test_one_input(const std::vector<uint8_t>& buffer)\n         BanMan ban_man{banlist_file, nullptr, ConsumeBanTimeOffset(fuzzed_data_provider)};\n         while (fuzzed_data_provider.ConsumeBool()) {\n             switch (fuzzed_data_provider.ConsumeIntegralInRange<int>(0, 11)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r551148954",
      "id" : 551148954,
      "in_reply_to_id" : 550812551,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTE0ODk1NA==",
      "original_commit_id" : "a39cca4266813711d3b76a7f31c770e55df1ffd4",
      "original_line" : 40,
      "original_position" : 3,
      "original_start_line" : null,
      "path" : "src/test/fuzz/banman.cpp",
      "position" : null,
      "pull_request_review_id" : 560816164,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551148954",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r551151768"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551151768"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Since `map.erase(it)` invalidates `it` I was doing a double-pass to avoid incrementing `it`. However, it turns out `erase` will [return the Iterator](https://en.cppreference.com/w/cpp/container/map/erase) following the last removed element. So I've updated the code to use that.\r\n\r\n@jnewbery I am confused about this:\r\n> you'll only need to pass over m_banned once instead of up to entries_to_delete.size() times.\r\n\r\nI think the code is only passing over `m_banned` once. Am I missing something? I also tried erase-remove_if but it does not seem to work for associative containers. Is there an example I can learn from?",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-04T07:26:22Z",
      "diff_hunk" : "@@ -159,12 +135,43 @@ bool BanMan::Unban(const CSubNet& sub_net)\n     return true;\n }\n \n-void BanMan::GetBanned(banmap_t& banmap)\n+void BanMan::UnbanAll(const CNetAddr& net_addr)\n+{\n+    {\n+        LOCK(m_cs_banned);\n+        std::vector<CSubNet> entries_to_delete;\n+        for (const auto& it : m_banned) {\n+            CSubNet sub_net = it.first;\n+            if (sub_net.Match(net_addr)) entries_to_delete.push_back(sub_net);\n+        }\n+\n+        if (!entries_to_delete.empty()) m_is_dirty = true;\n+        for (const auto&it : entries_to_delete) {\n+            m_banned.erase(it);\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r551151768",
      "id" : 551151768,
      "in_reply_to_id" : 550820325,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTE1MTc2OA==",
      "original_commit_id" : "a39cca4266813711d3b76a7f31c770e55df1ffd4",
      "original_line" : 150,
      "original_position" : 79,
      "original_start_line" : 142,
      "path" : "src/banman.cpp",
      "position" : null,
      "pull_request_review_id" : 560819738,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551151768",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r551151825"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551151825"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done.",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-04T07:26:33Z",
      "diff_hunk" : "@@ -159,12 +135,43 @@ bool BanMan::Unban(const CSubNet& sub_net)\n     return true;\n }\n \n-void BanMan::GetBanned(banmap_t& banmap)\n+void BanMan::UnbanAll(const CNetAddr& net_addr)\n+{\n+    {\n+        LOCK(m_cs_banned);\n+        std::vector<CSubNet> entries_to_delete;\n+        for (const auto& it : m_banned) {\n+            CSubNet sub_net = it.first;\n+            if (sub_net.Match(net_addr)) entries_to_delete.push_back(sub_net);\n+        }\n+\n+        if (!entries_to_delete.empty()) m_is_dirty = true;\n+        for (const auto&it : entries_to_delete) {\n+            m_banned.erase(it);\n+        }\n+    }\n+\n+    if (m_client_interface) m_client_interface->BannedListChanged();\n+    DumpBanlist(); //store banlist to disk immediately\n+}\n+\n+void BanMan::GetBanned(banmap_t& banmap, Optional<const CNetAddr&> filterForIp)\n {\n     LOCK(m_cs_banned);\n     // Sweep the banlist so expired bans are not returned\n     SweepBanned();\n     banmap = m_banned; //create a thread safe copy\n+\n+    if (filterForIp) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r551151825",
      "id" : 551151825,
      "in_reply_to_id" : 550820394,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTE1MTgyNQ==",
      "original_commit_id" : "a39cca4266813711d3b76a7f31c770e55df1ffd4",
      "original_line" : 163,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "src/banman.cpp",
      "position" : null,
      "pull_request_review_id" : 560819808,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551151825",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r551152004"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551152004"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for showing me that. Much better.",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-04T07:26:54Z",
      "diff_hunk" : "@@ -702,7 +686,9 @@ static RPCHelpMan listbanned()\n {\n     return RPCHelpMan{\"listbanned\",\n                 \"\\nList all manually banned IPs/Subnets.\\n\",\n-                {},\n+                {\n+                    {\"ip\", RPCArg::Type::STR, \"all ips\", \"If IP is provided, only bans which include the IP will be returned.\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r551152004",
      "id" : 551152004,
      "in_reply_to_id" : 550820714,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTE1MjAwNA==",
      "original_commit_id" : "a39cca4266813711d3b76a7f31c770e55df1ffd4",
      "original_line" : 690,
      "original_position" : 97,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 560819942,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551152004",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r551161796"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551161796"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "#20671 was merged, so I'm now using `std::optional` instead of `boost::optional`. \r\n\r\n`std::optional<T>` is considered ill-formed if `is_reference_v<T>` and also if `!is_destructible_v<T>`. So we can't use `std::optional<const CNetAddr&>` and can't forward declare `CNetAddr` and `CSubNet` in this file (incomplete types are not destructible).",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-04T07:57:04Z",
      "diff_hunk" : "@@ -77,7 +77,7 @@ class BanMan\n \n     // Removes all ban entries that include net_addr\n     void UnbanAll(const CNetAddr& net_addr);\n-    void GetBanned(banmap_t& banmap);\n+    void GetBanned(banmap_t& banmap, std::optional<const CNetAddr> filterForIp = {});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r551161796",
      "id" : 551161796,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTE2MTc5Ng==",
      "original_commit_id" : "e650bba6fd9bd399ad67a13758189652888bdf04",
      "original_line" : 80,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 560832354,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551161796",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thank you for the reviews, @glozow @jnewbery. Comments addressed. Rebased. Ready for further review.",
      "created_at" : "2021-01-04T08:19:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-753829686",
      "id" : 753829686,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1MzgyOTY4Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-04T08:19:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/753829686",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r553899004"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/553899004"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think better than adding this `std::optional<CNetAddr>` would be to just overload the `GetBanned()` function, since most of the logic in the function is now specific to the one case where you pass a filterForIp. Those feel like almost two different functional interfaces.\r\n\r\nI think better yet would be to do the filtering logic inside the RPC `listbanned()` function. It's not required by any other callers, so I don't think there's a need to add it to banman. If other callers need the same filtering logic at some point in the future, the logic can be moved into banman at that point.",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-08T11:46:50Z",
      "diff_hunk" : "@@ -77,7 +77,7 @@ class BanMan\n \n     // Removes all ban entries that include net_addr\n     void UnbanAll(const CNetAddr& net_addr);\n-    void GetBanned(banmap_t& banmap);\n+    void GetBanned(banmap_t& banmap, std::optional<const CNetAddr> filterForIp = {});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r553899004",
      "id" : 553899004,
      "in_reply_to_id" : 551161796,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1Mzg5OTAwNA==",
      "original_commit_id" : "e650bba6fd9bd399ad67a13758189652888bdf04",
      "original_line" : 80,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 564201100,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/553899004",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-01-11T11:06:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-757879089",
      "id" : 757879089,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1Nzg3OTA4OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-11T11:06:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/757879089",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r556304555"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/556304555"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "That sounds good. Updated code accordingly.",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-13T07:11:50Z",
      "diff_hunk" : "@@ -77,7 +77,7 @@ class BanMan\n \n     // Removes all ban entries that include net_addr\n     void UnbanAll(const CNetAddr& net_addr);\n-    void GetBanned(banmap_t& banmap);\n+    void GetBanned(banmap_t& banmap, std::optional<const CNetAddr> filterForIp = {});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r556304555",
      "id" : 556304555,
      "in_reply_to_id" : 551161796,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NjMwNDU1NQ==",
      "original_commit_id" : "e650bba6fd9bd399ad67a13758189652888bdf04",
      "original_line" : 80,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 566942122,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/556304555",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased and addressed https://github.com/bitcoin/bitcoin/pull/19825#discussion_r553899004. Ready for further review.",
      "created_at" : "2021-01-13T07:13:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-759254983",
      "id" : 759254983,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1OTI1NDk4Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-13T07:13:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/759254983",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-01-14T10:17:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-760099743",
      "id" : 760099743,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2MDA5OTc0Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-14T10:17:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/760099743",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r557294946"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557294946"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Sorry. I mistakenly thought that `m_banned` was a vector.",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-14T10:31:10Z",
      "diff_hunk" : "@@ -159,12 +135,43 @@ bool BanMan::Unban(const CSubNet& sub_net)\n     return true;\n }\n \n-void BanMan::GetBanned(banmap_t& banmap)\n+void BanMan::UnbanAll(const CNetAddr& net_addr)\n+{\n+    {\n+        LOCK(m_cs_banned);\n+        std::vector<CSubNet> entries_to_delete;\n+        for (const auto& it : m_banned) {\n+            CSubNet sub_net = it.first;\n+            if (sub_net.Match(net_addr)) entries_to_delete.push_back(sub_net);\n+        }\n+\n+        if (!entries_to_delete.empty()) m_is_dirty = true;\n+        for (const auto&it : entries_to_delete) {\n+            m_banned.erase(it);\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r557294946",
      "id" : 557294946,
      "in_reply_to_id" : 550820325,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NzI5NDk0Ng==",
      "original_commit_id" : "a39cca4266813711d3b76a7f31c770e55df1ffd4",
      "original_line" : 150,
      "original_position" : 79,
      "original_start_line" : 142,
      "path" : "src/banman.cpp",
      "position" : null,
      "pull_request_review_id" : 568104145,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557294946",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r557295685"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557295685"
         }
      },
      "author_association" : "MEMBER",
      "body" : "After you rebase, you may want to apply this patch: https://github.com/bitcoin/bitcoin/issues/20837#issuecomment-760097060",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-14T10:32:25Z",
      "diff_hunk" : "@@ -38,47 +38,34 @@ FUZZ_TARGET_INIT(banman, initialize_banman)\n     {\n         BanMan ban_man{banlist_file, nullptr, ConsumeBanTimeOffset(fuzzed_data_provider)};\n         while (fuzzed_data_provider.ConsumeBool()) {\n-            switch (fuzzed_data_provider.ConsumeIntegralInRange<int>(0, 11)) {\n+            switch (fuzzed_data_provider.ConsumeIntegralInRange<int>(0, 6)) {\n             case 0: {\n-                ban_man.Ban(ConsumeNetAddr(fuzzed_data_provider),\n-                    ConsumeBanTimeOffset(fuzzed_data_provider), fuzzed_data_provider.ConsumeBool());\n-                break;\n-            }\n-            case 1: {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r557295685",
      "id" : 557295685,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NzI5NTY4NQ==",
      "original_commit_id" : "38abc322d3c66c59fb9189ac9d2a5c4aadf8b0e9",
      "original_line" : 47,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/test/fuzz/banman.cpp",
      "position" : null,
      "pull_request_review_id" : 568105129,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557295685",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2021-01-23T22:42:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-766193756",
      "id" : 766193756,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2NjE5Mzc1Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-23T22:42:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/766193756",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r563718303"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563718303"
         }
      },
      "author_association" : "MEMBER",
      "body" : "579eaaa prefer prefix iterator over postfix one (see developer-notes.md)",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-25T13:22:31Z",
      "diff_hunk" : "@@ -159,6 +135,25 @@ bool BanMan::Unban(const CSubNet& sub_net)\n     return true;\n }\n \n+void BanMan::UnbanAll(const CNetAddr& net_addr)\n+{\n+    {\n+        LOCK(m_cs_banned);\n+        for (auto it = m_banned.begin(); it != m_banned.end();) {\n+            CSubNet sub_net = it->first;\n+            if (sub_net.Match(net_addr)) {\n+                it = m_banned.erase(it);\n+                m_is_dirty = true;\n+            } else {\n+                it++;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r563718303",
      "id" : 563718303,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MzcxODMwMw==",
      "original_commit_id" : "38abc322d3c66c59fb9189ac9d2a5c4aadf8b0e9",
      "original_line" : 148,
      "original_position" : 75,
      "original_start_line" : null,
      "path" : "src/banman.cpp",
      "position" : null,
      "pull_request_review_id" : 575389315,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563718303",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r563718976"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563718976"
         }
      },
      "author_association" : "MEMBER",
      "body" : "579eaaa\r\n```suggestion\r\n                    {\"command\", RPCArg::Type::STR, RPCArg::Optional::NO, \"'add' to add an IP/Subnet to the list, 'remove' to remove an IP/Subnet from the list, 'removeall' to remove all bans that include the single IP address\"},\r\n```",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-25T13:23:34Z",
      "diff_hunk" : "@@ -663,7 +663,7 @@ static RPCHelpMan setban()\n                 \"\\nAttempts to add or remove an IP/Subnet from the banned list.\\n\",\n                 {\n                     {\"subnet\", RPCArg::Type::STR, RPCArg::Optional::NO, \"The IP/Subnet (see getpeerinfo for nodes IP) with an optional netmask (default is /32 = single IP)\"},\n-                    {\"command\", RPCArg::Type::STR, RPCArg::Optional::NO, \"'add' to add an IP/Subnet to the list, 'remove' to remove an IP/Subnet from the list\"},\n+                    {\"command\", RPCArg::Type::STR, RPCArg::Optional::NO, \"'add' to add an IP/Subnet to the list, 'remove' to remove an IP/Subnet from the list, 'removeall' to remove all bans that include the single ip address\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r563718976",
      "id" : 563718976,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MzcxODk3Ng==",
      "original_commit_id" : "38abc322d3c66c59fb9189ac9d2a5c4aadf8b0e9",
      "original_line" : 666,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 575389315,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563718976",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r563719416"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563719416"
         }
      },
      "author_association" : "MEMBER",
      "body" : "579eaaa\r\n```suggestion\r\n        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Error: setban removeall requires a single IP address\");\r\n```",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-25T13:24:14Z",
      "diff_hunk" : "@@ -678,38 +678,32 @@ static RPCHelpMan setban()\n     std::string strCommand;\n     if (!request.params[1].isNull())\n         strCommand = request.params[1].get_str();\n-    if (strCommand != \"add\" && strCommand != \"remove\") {\n+    if (strCommand != \"add\" && strCommand != \"remove\" && strCommand != \"removeall\") {\n         throw std::runtime_error(help.ToString());\n     }\n     NodeContext& node = EnsureNodeContext(request.context);\n     if (!node.banman) {\n         throw JSONRPCError(RPC_DATABASE_ERROR, \"Error: Ban database not loaded\");\n     }\n \n+    bool isSubnet = (request.params[0].get_str().find('/') != std::string::npos);\n+    if (strCommand == \"removeall\" && isSubnet) {\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Error: setban removeall requires single ip address\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r563719416",
      "id" : 563719416,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MzcxOTQxNg==",
      "original_commit_id" : "38abc322d3c66c59fb9189ac9d2a5c4aadf8b0e9",
      "original_line" : 691,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 575389315,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563719416",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r563719732"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563719732"
         }
      },
      "author_association" : "MEMBER",
      "body" : "579eaaa\r\n```suggestion\r\n    } else if (strCommand == \"remove\") {\r\n```",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-25T13:24:50Z",
      "diff_hunk" : "@@ -718,23 +712,13 @@ static RPCHelpMan setban()\n         if (request.params[3].isTrue())\n             absolute = true;\n \n-        if (isSubnet) {\n-            node.banman->Ban(subNet, banTime, absolute);\n-            if (node.connman) {\n-                node.connman->DisconnectNode(subNet);\n-            }\n-        } else {\n-            node.banman->Ban(netAddr, banTime, absolute);\n-            if (node.connman) {\n-                node.connman->DisconnectNode(netAddr);\n-            }\n-        }\n-    }\n-    else if(strCommand == \"remove\")\n-    {\n-        if (!( isSubnet ? node.banman->Unban(subNet) : node.banman->Unban(netAddr) )) {\n-            throw JSONRPCError(RPC_CLIENT_INVALID_IP_OR_SUBNET, \"Error: Unban failed. Requested address/subnet was not previously manually banned.\");\n+        if (node.banman->Ban(subNet, banTime, absolute) && node.connman) {\n+            node.connman->DisconnectNode(subNet);\n         }\n+    } else if(strCommand == \"remove\") {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r563719732",
      "id" : 563719732,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MzcxOTczMg==",
      "original_commit_id" : "38abc322d3c66c59fb9189ac9d2a5c4aadf8b0e9",
      "original_line" : 718,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 575389315,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563719732",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r563720577"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563720577"
         }
      },
      "author_association" : "MEMBER",
      "body" : "38abc322\r\n```suggestion\r\n            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Error: Invalid IP address\");\r\n```",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-25T13:26:05Z",
      "diff_hunk" : "@@ -768,7 +754,21 @@ static RPCHelpMan listbanned()\n \n     banmap_t banMap;\n     node.banman->GetBanned(banMap);\n-\n+    if (!request.params[0].isNull()) {\n+        CNetAddr netAddr;\n+        LookupHost(request.params[0].get_str(), netAddr, false);\n+        if (!netAddr.IsValid()) {\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Error: Invalid ip address\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r563720577",
      "id" : 563720577,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MzcyMDU3Nw==",
      "original_commit_id" : "38abc322d3c66c59fb9189ac9d2a5c4aadf8b0e9",
      "original_line" : 761,
      "original_position" : 111,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 575389315,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563720577",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r563720874"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563720874"
         }
      },
      "author_association" : "MEMBER",
      "body" : "38abc322 prefer prefix iterator\r\n```suggestion\r\n                ++it;\r\n```",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-25T13:26:30Z",
      "diff_hunk" : "@@ -768,7 +754,21 @@ static RPCHelpMan listbanned()\n \n     banmap_t banMap;\n     node.banman->GetBanned(banMap);\n-\n+    if (!request.params[0].isNull()) {\n+        CNetAddr netAddr;\n+        LookupHost(request.params[0].get_str(), netAddr, false);\n+        if (!netAddr.IsValid()) {\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Error: Invalid ip address\");\n+        }\n+        for (auto it = banMap.begin(); it != banMap.end();) {\n+            CSubNet ban_sub_net = it->first;\n+            if (!ban_sub_net.Match(netAddr)) {\n+                it = banMap.erase(it);\n+            } else {\n+                it++;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r563720874",
      "id" : 563720874,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MzcyMDg3NA==",
      "original_commit_id" : "38abc322d3c66c59fb9189ac9d2a5c4aadf8b0e9",
      "original_line" : 768,
      "original_position" : 118,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 575389315,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563720874",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r563722213"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563722213"
         }
      },
      "author_association" : "MEMBER",
      "body" : "877b14aaeb ISTM this behavior ought to be documented/clarified in the setban rpc help",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-25T13:28:33Z",
      "diff_hunk" : "@@ -129,22 +109,18 @@ void BanMan::Ban(const CSubNet& sub_net, int64_t ban_time_offset, bool since_uni\n \n     {\n         LOCK(m_cs_banned);\n+        // If ban entry is absent, add it. If it's shorter, update it.\n         if (m_banned[sub_net].nBanUntil < ban_entry.nBanUntil) {\n             m_banned[sub_net] = ban_entry;\n             m_is_dirty = true;\n         } else\n-            return;\n+            return false; // nothing to do, longer ban already exists",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r563722213",
      "id" : 563722213,
      "line" : 117,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MzcyMjIxMw==",
      "original_commit_id" : "38abc322d3c66c59fb9189ac9d2a5c4aadf8b0e9",
      "original_line" : 117,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/banman.cpp",
      "position" : 45,
      "pull_request_review_id" : 575389315,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563722213",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r564933926"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/564933926"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done in 0dbe88ad3894cd76d52ed196fd2eed39de1296d2",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-27T00:31:58Z",
      "diff_hunk" : "@@ -38,47 +38,34 @@ FUZZ_TARGET_INIT(banman, initialize_banman)\n     {\n         BanMan ban_man{banlist_file, nullptr, ConsumeBanTimeOffset(fuzzed_data_provider)};\n         while (fuzzed_data_provider.ConsumeBool()) {\n-            switch (fuzzed_data_provider.ConsumeIntegralInRange<int>(0, 11)) {\n+            switch (fuzzed_data_provider.ConsumeIntegralInRange<int>(0, 6)) {\n             case 0: {\n-                ban_man.Ban(ConsumeNetAddr(fuzzed_data_provider),\n-                    ConsumeBanTimeOffset(fuzzed_data_provider), fuzzed_data_provider.ConsumeBool());\n-                break;\n-            }\n-            case 1: {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r564933926",
      "id" : 564933926,
      "in_reply_to_id" : 557295685,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NDkzMzkyNg==",
      "original_commit_id" : "38abc322d3c66c59fb9189ac9d2a5c4aadf8b0e9",
      "original_line" : 47,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/test/fuzz/banman.cpp",
      "position" : null,
      "pull_request_review_id" : 576881770,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/564933926",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r564933990"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/564933990"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-27T00:32:08Z",
      "diff_hunk" : "@@ -159,6 +135,25 @@ bool BanMan::Unban(const CSubNet& sub_net)\n     return true;\n }\n \n+void BanMan::UnbanAll(const CNetAddr& net_addr)\n+{\n+    {\n+        LOCK(m_cs_banned);\n+        for (auto it = m_banned.begin(); it != m_banned.end();) {\n+            CSubNet sub_net = it->first;\n+            if (sub_net.Match(net_addr)) {\n+                it = m_banned.erase(it);\n+                m_is_dirty = true;\n+            } else {\n+                it++;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r564933990",
      "id" : 564933990,
      "in_reply_to_id" : 563718303,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NDkzMzk5MA==",
      "original_commit_id" : "38abc322d3c66c59fb9189ac9d2a5c4aadf8b0e9",
      "original_line" : 148,
      "original_position" : 75,
      "original_start_line" : null,
      "path" : "src/banman.cpp",
      "position" : null,
      "pull_request_review_id" : 576881844,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/564933990",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r564934035"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/564934035"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-27T00:32:16Z",
      "diff_hunk" : "@@ -663,7 +663,7 @@ static RPCHelpMan setban()\n                 \"\\nAttempts to add or remove an IP/Subnet from the banned list.\\n\",\n                 {\n                     {\"subnet\", RPCArg::Type::STR, RPCArg::Optional::NO, \"The IP/Subnet (see getpeerinfo for nodes IP) with an optional netmask (default is /32 = single IP)\"},\n-                    {\"command\", RPCArg::Type::STR, RPCArg::Optional::NO, \"'add' to add an IP/Subnet to the list, 'remove' to remove an IP/Subnet from the list\"},\n+                    {\"command\", RPCArg::Type::STR, RPCArg::Optional::NO, \"'add' to add an IP/Subnet to the list, 'remove' to remove an IP/Subnet from the list, 'removeall' to remove all bans that include the single ip address\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r564934035",
      "id" : 564934035,
      "in_reply_to_id" : 563718976,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NDkzNDAzNQ==",
      "original_commit_id" : "38abc322d3c66c59fb9189ac9d2a5c4aadf8b0e9",
      "original_line" : 666,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 576881906,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/564934035",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r564934164"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/564934164"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-27T00:32:37Z",
      "diff_hunk" : "@@ -678,38 +678,32 @@ static RPCHelpMan setban()\n     std::string strCommand;\n     if (!request.params[1].isNull())\n         strCommand = request.params[1].get_str();\n-    if (strCommand != \"add\" && strCommand != \"remove\") {\n+    if (strCommand != \"add\" && strCommand != \"remove\" && strCommand != \"removeall\") {\n         throw std::runtime_error(help.ToString());\n     }\n     NodeContext& node = EnsureNodeContext(request.context);\n     if (!node.banman) {\n         throw JSONRPCError(RPC_DATABASE_ERROR, \"Error: Ban database not loaded\");\n     }\n \n+    bool isSubnet = (request.params[0].get_str().find('/') != std::string::npos);\n+    if (strCommand == \"removeall\" && isSubnet) {\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Error: setban removeall requires single ip address\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r564934164",
      "id" : 564934164,
      "in_reply_to_id" : 563719416,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NDkzNDE2NA==",
      "original_commit_id" : "38abc322d3c66c59fb9189ac9d2a5c4aadf8b0e9",
      "original_line" : 691,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 576882059,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/564934164",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r564934191"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/564934191"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-27T00:32:42Z",
      "diff_hunk" : "@@ -718,23 +712,13 @@ static RPCHelpMan setban()\n         if (request.params[3].isTrue())\n             absolute = true;\n \n-        if (isSubnet) {\n-            node.banman->Ban(subNet, banTime, absolute);\n-            if (node.connman) {\n-                node.connman->DisconnectNode(subNet);\n-            }\n-        } else {\n-            node.banman->Ban(netAddr, banTime, absolute);\n-            if (node.connman) {\n-                node.connman->DisconnectNode(netAddr);\n-            }\n-        }\n-    }\n-    else if(strCommand == \"remove\")\n-    {\n-        if (!( isSubnet ? node.banman->Unban(subNet) : node.banman->Unban(netAddr) )) {\n-            throw JSONRPCError(RPC_CLIENT_INVALID_IP_OR_SUBNET, \"Error: Unban failed. Requested address/subnet was not previously manually banned.\");\n+        if (node.banman->Ban(subNet, banTime, absolute) && node.connman) {\n+            node.connman->DisconnectNode(subNet);\n         }\n+    } else if(strCommand == \"remove\") {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r564934191",
      "id" : 564934191,
      "in_reply_to_id" : 563719732,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NDkzNDE5MQ==",
      "original_commit_id" : "38abc322d3c66c59fb9189ac9d2a5c4aadf8b0e9",
      "original_line" : 718,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 576882090,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/564934191",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r564934231"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/564934231"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-27T00:32:49Z",
      "diff_hunk" : "@@ -768,7 +754,21 @@ static RPCHelpMan listbanned()\n \n     banmap_t banMap;\n     node.banman->GetBanned(banMap);\n-\n+    if (!request.params[0].isNull()) {\n+        CNetAddr netAddr;\n+        LookupHost(request.params[0].get_str(), netAddr, false);\n+        if (!netAddr.IsValid()) {\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Error: Invalid ip address\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r564934231",
      "id" : 564934231,
      "in_reply_to_id" : 563720577,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NDkzNDIzMQ==",
      "original_commit_id" : "38abc322d3c66c59fb9189ac9d2a5c4aadf8b0e9",
      "original_line" : 761,
      "original_position" : 111,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 576882137,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/564934231",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r564934279"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/564934279"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-27T00:32:55Z",
      "diff_hunk" : "@@ -768,7 +754,21 @@ static RPCHelpMan listbanned()\n \n     banmap_t banMap;\n     node.banman->GetBanned(banMap);\n-\n+    if (!request.params[0].isNull()) {\n+        CNetAddr netAddr;\n+        LookupHost(request.params[0].get_str(), netAddr, false);\n+        if (!netAddr.IsValid()) {\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Error: Invalid ip address\");\n+        }\n+        for (auto it = banMap.begin(); it != banMap.end();) {\n+            CSubNet ban_sub_net = it->first;\n+            if (!ban_sub_net.Match(netAddr)) {\n+                it = banMap.erase(it);\n+            } else {\n+                it++;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r564934279",
      "id" : 564934279,
      "in_reply_to_id" : 563720874,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NDkzNDI3OQ==",
      "original_commit_id" : "38abc322d3c66c59fb9189ac9d2a5c4aadf8b0e9",
      "original_line" : 768,
      "original_position" : 118,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 576882174,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/564934279",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r564934327"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/564934327"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done.",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-27T00:33:01Z",
      "diff_hunk" : "@@ -129,22 +109,18 @@ void BanMan::Ban(const CSubNet& sub_net, int64_t ban_time_offset, bool since_uni\n \n     {\n         LOCK(m_cs_banned);\n+        // If ban entry is absent, add it. If it's shorter, update it.\n         if (m_banned[sub_net].nBanUntil < ban_entry.nBanUntil) {\n             m_banned[sub_net] = ban_entry;\n             m_is_dirty = true;\n         } else\n-            return;\n+            return false; // nothing to do, longer ban already exists",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r564934327",
      "id" : 564934327,
      "in_reply_to_id" : 563722213,
      "line" : 117,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NDkzNDMyNw==",
      "original_commit_id" : "38abc322d3c66c59fb9189ac9d2a5c4aadf8b0e9",
      "original_line" : 117,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/banman.cpp",
      "position" : 45,
      "pull_request_review_id" : 576882224,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-27T01:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/564934327",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased and comments addressed. Ready for review.",
      "created_at" : "2021-01-27T00:33:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-767924279",
      "id" : 767924279,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2NzkyNDI3OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-27T00:33:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/767924279",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Failing test fixed. Ready for review.",
      "created_at" : "2021-01-27T06:23:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-768062803",
      "id" : 768062803,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2ODA2MjgwMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-27T06:23:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/768062803",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r566323809"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/566323809"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Can remove this diff, and then rebase",
      "commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "created_at" : "2021-01-28T18:40:37Z",
      "diff_hunk" : "@@ -952,7 +952,7 @@ static const CRPCCommand commands[] =\n     { \"network\",            \"getnettotals\",           &getnettotals,           {} },\n     { \"network\",            \"getnetworkinfo\",         &getnetworkinfo,         {} },\n     { \"network\",            \"setban\",                 &setban,                 {\"subnet\", \"command\", \"bantime\", \"absolute\"} },\n-    { \"network\",            \"listbanned\",             &listbanned,             {} },\n+    { \"network\",            \"listbanned\",             &listbanned,             {\"ip\"} },",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#discussion_r566323809",
      "id" : 566323809,
      "line" : 955,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NjMyMzgwOQ==",
      "original_commit_id" : "8ad64d28794f2d91cf6eea7ab15f662ec3e211da",
      "original_line" : 955,
      "original_position" : 134,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : 134,
      "pull_request_review_id" : 578633169,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19825",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-28T18:40:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/566323809",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-01-28T18:59:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-769302719",
      "id" : 769302719,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2OTMwMjcxOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-28T18:59:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/769302719",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased. Ready for further review.",
      "created_at" : "2021-01-28T19:25:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-769317861",
      "id" : 769317861,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2OTMxNzg2MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-02-06T02:45:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/769317861",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-04-11T12:23:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-817299055",
      "id" : 817299055,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxNzI5OTA1NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-11T12:23:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/817299055",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased. Ready for further review.",
      "created_at" : "2021-04-23T21:09:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-825927339",
      "id" : 825927339,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyNTkyNzMzOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-23T21:09:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/825927339",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Needs rebase to drop already merged hunks in the fuzz tests",
      "created_at" : "2021-07-30T12:08:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-889849378",
      "id" : 889849378,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "IC_kwDOABII5841CgYi",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/889849378/reactions"
      },
      "updated_at" : "2021-07-30T12:08:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/889849378",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Okay, a lot of things here:\r\n1. I like the consolidation because it removes code.\r\n2. I donât see a big difference between a no-op and throwing an error?\r\n3. I think UnbanAll would be better if it affected everything downwards (all bans for subnets of given net), not upwards. For âunban all above-nets of a specific addrâ, I donât see a use-case (maybe you can point out one?). If you really want to connect to a given addr, use white list?\r\n4. Same for listbanned",
      "created_at" : "2021-09-28T10:18:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-929054558",
      "id" : 929054558,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "IC_kwDOABII5843YD9e",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/929054558/reactions"
      },
      "updated_at" : "2021-09-28T10:18:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/929054558",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Remove BanMan::Ban(CNetAddr&) and use BanMan::Ban(CSubNet&) instead (ips are subnets of one)\r\nRPC change: setban subnet/ip add now allows adding a ban entry for an ip in an already banned subnet. No error will be thrown so long as the user intent is accomplished.\r\nRemove BanMan::Unban(CNetAddr&) and use BanMan::Unban(CSubNet&) instead (ips are subnets of one)\r\nRPC change: Unbanning a non-banned subnet will no longer raise an rpc error as user intent is accomplished.\r\n\r\nI don't understand why are these changes required? The errors right now look correct.\r\n\r\n> RPC change: Add setban ip removeall to remove all ban entries that include an IP address\r\nRPC change: Add listbanned ip to return all ban entries that include an IP address\r\n\r\nConcept ACK for `setban ip removeall` and `listbanned ip`",
      "created_at" : "2022-08-09T01:42:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-1208812062",
      "id" : 1208812062,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "IC_kwDOABII585IDQIe",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1208812062/reactions"
      },
      "updated_at" : "2022-08-09T01:42:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1208812062",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/94559964?v=4",
         "events_url" : "https://api.github.com/users/1440000bytes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/1440000bytes/followers",
         "following_url" : "https://api.github.com/users/1440000bytes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/1440000bytes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/1440000bytes",
         "id" : 94559964,
         "login" : "1440000bytes",
         "node_id" : "U_kgDOBaLe3A",
         "organizations_url" : "https://api.github.com/users/1440000bytes/orgs",
         "received_events_url" : "https://api.github.com/users/1440000bytes/received_events",
         "repos_url" : "https://api.github.com/users/1440000bytes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/1440000bytes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/1440000bytes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/1440000bytes"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Are you still working on this?",
      "created_at" : "2022-10-12T18:14:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19825#issuecomment-1276558375",
      "id" : 1276558375,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19825",
      "node_id" : "IC_kwDOABII585MFrwn",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1276558375/reactions"
      },
      "updated_at" : "2022-10-12T18:14:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1276558375",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   }
]
