[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "What you're describing with very small probabilities I mostly fixed in a784f90c a long time ago. What code are you actually seeing this in?\n",
      "created_at" : "2015-11-22T23:08:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6903#issuecomment-158817150",
      "id" : 158817150,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6903",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDE1ODgxNzE1MA==",
      "updated_at" : "2015-11-22T23:08:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/158817150",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Related issue: #1664\n(it was solved back then, at least, as gmaxwell says)\n",
      "created_at" : "2016-02-16T12:23:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6903#issuecomment-184662093",
      "id" : 184662093,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6903",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDE4NDY2MjA5Mw==",
      "updated_at" : "2016-02-16T12:23:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/184662093",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Zcash users are [seeing this behaviour on our testnet](https://forum.z.cash/t/what-is-the-expected-cpu-resource-consumption-of-zcashd/508/15?u=str4d) (our corresponding issue is zcash/zcash#717). We are based off 0.11.2; it does appear that [there have been slight changes](/bitcoin/bitcoin/blob/master/src/addrman.cpp#L333) to `Select_()` in the intervening time, but nothing that appears to alter the break condition for the infinite loop.\n",
      "created_at" : "2016-05-11T04:10:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6903#issuecomment-218357010",
      "id" : 218357010,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6903",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDIxODM1NzAxMA==",
      "updated_at" : "2016-05-11T04:10:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/218357010",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4993799?v=4",
         "events_url" : "https://api.github.com/users/str4d/events{/privacy}",
         "followers_url" : "https://api.github.com/users/str4d/followers",
         "following_url" : "https://api.github.com/users/str4d/following{/other_user}",
         "gists_url" : "https://api.github.com/users/str4d/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/str4d",
         "id" : 4993799,
         "login" : "str4d",
         "node_id" : "MDQ6VXNlcjQ5OTM3OTk=",
         "organizations_url" : "https://api.github.com/users/str4d/orgs",
         "received_events_url" : "https://api.github.com/users/str4d/received_events",
         "repos_url" : "https://api.github.com/users/str4d/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/str4d/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/str4d/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/str4d"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "We have a proposed fix for this now (zcash/zcash#929). It would be great to have your thoughts on it @gmaxwell (and if desired we can make a PR for here :smiley:)\n",
      "created_at" : "2016-06-03T06:58:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6903#issuecomment-223505370",
      "id" : 223505370,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6903",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDIyMzUwNTM3MA==",
      "updated_at" : "2016-06-03T06:58:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/223505370",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4993799?v=4",
         "events_url" : "https://api.github.com/users/str4d/events{/privacy}",
         "followers_url" : "https://api.github.com/users/str4d/followers",
         "following_url" : "https://api.github.com/users/str4d/following{/other_user}",
         "gists_url" : "https://api.github.com/users/str4d/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/str4d",
         "id" : 4993799,
         "login" : "str4d",
         "node_id" : "MDQ6VXNlcjQ5OTM3OTk=",
         "organizations_url" : "https://api.github.com/users/str4d/orgs",
         "received_events_url" : "https://api.github.com/users/str4d/received_events",
         "repos_url" : "https://api.github.com/users/str4d/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/str4d/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/str4d/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/str4d"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for mentioning @str4d\n",
      "created_at" : "2016-06-09T08:40:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6903#issuecomment-224834009",
      "id" : 224834009,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6903",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDIyNDgzNDAwOQ==",
      "updated_at" : "2016-06-09T08:40:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/224834009",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I can confirm this issue. I am sad to see that this issue has been opened nearly four years ago and is still open.\r\n\r\nRunning bitcoind v0.18.0 full node with bitcoin.conf:\r\n```\r\nonlynet=onion\r\nonion=127.0.0.1:9050\r\nlisten=1\r\n```\r\n\r\nI think it would be much smarter and better, if bitcoind would detect network unreachability and then go into some sleepy connection testing loop, until connection is detected as up again. This would prevent unhealthy CPU and therefore electrical power usage.",
      "created_at" : "2019-07-19T18:20:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6903#issuecomment-513328179",
      "id" : 513328179,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6903",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxMzMyODE3OQ==",
      "updated_at" : "2019-08-09T20:54:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/513328179",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8447873?v=4",
         "events_url" : "https://api.github.com/users/wodry/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wodry/followers",
         "following_url" : "https://api.github.com/users/wodry/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wodry/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wodry",
         "id" : 8447873,
         "login" : "wodry",
         "node_id" : "MDQ6VXNlcjg0NDc4NzM=",
         "organizations_url" : "https://api.github.com/users/wodry/orgs",
         "received_events_url" : "https://api.github.com/users/wodry/received_events",
         "repos_url" : "https://api.github.com/users/wodry/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wodry/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wodry/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wodry"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@wodry What are the steps to reproduce, please?\r\n\r\nWhich OS are you running. What version of tor? Does it happen when you start the node without a connection or does it only happen when you initially had some connections?",
      "created_at" : "2019-07-19T20:31:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6903#issuecomment-513367684",
      "id" : 513367684,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6903",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxMzM2NzY4NA==",
      "updated_at" : "2019-07-19T20:31:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/513367684",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Oh yes, sorry, of course:\r\n\r\nBitcoin-qt: ``bitcoin-0.18.0-x86_64`` from binary tar ball\r\nOS: ``Debian GNU/Linux 9.8 (stretch)``, all packages up to date.\r\nKernel: ``4.9.0-8-amd64 #1 SMP Debian 4.9.144-3 (2019-02-02) x86_64 GNU/Linux``\r\nTor: ``0.2.9.16-1``\r\n\r\nThe 100% CPU usage also happens maybe 10 minutes after having started bitcoin-qt when DSL cable was initially already cut off (and therefore local running Tor had already lost connection).\r\n\r\nSteps to reproduce:\r\n\r\nRun local Tor with following config\r\n\r\n``/etc/tor/torrc``\r\n```\r\nClientOnly 1\r\n\r\nClientUseIPv6 1\r\n\r\nReachableAddresses *:53,*:80,*:443,*:6667,*:8333,*:9001,*:9030\r\n\r\nBandwidthRate  3 MBit\r\nBandwidthBurst 5 MBit\r\n```\r\nThe user that runs Bitcoin-qt has to be in the group ``debian-tor`` so bitcoin-qt can start Tor Hidden Service automatically.\r\n\r\nRun Bitcoin-qt (no connections inbound from internet to any ports like 8333 allowed) with following config\r\n\r\n``~/.bitcoin/bitcoin.conf``\r\n```\r\nupnp=0\r\n\r\nonlynet=onion\r\nonion=127.0.0.1:9050\r\nlisten=1\r\nmaxuploadtarget=400\r\n\r\n# Specify connection timeout in milliseconds\r\ntimeout=20000\r\n\r\n# Accept command line and JSON-RPC commands\r\nserver=1\r\n```\r\n\r\nLet bitcoin-qt run some days and then disconnect network cable, wait approx. 1 hour\r\n_or_\r\nHave only Tor running, then disconnect netwotk cable and then start bitcoin-qt and wait 10 minutes (last debug.log messages: _\"0 addresses found from DNS seeds\"_, _\"dnsseed thread exit\"_)\r\n\r\n-> CPU usage of bitcoin-qt process is constantly 100%\r\n\r\nConnect network cable\r\n\r\n-> after some time (1h or so) Tor detects network as up again, bitcoin-qt has connection again (messages: _\"Potential stale tip detected, will try using extra outbound peer (last tip update: 1890 seconds ago)\"_, \r\n_\"New outbound peer connected: version: 70015\"_), and the CPU usage reduces to normal low value.",
      "created_at" : "2019-07-20T08:32:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6903#issuecomment-513448708",
      "id" : 513448708,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6903",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxMzQ0ODcwOA==",
      "updated_at" : "2019-07-20T18:18:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/513448708",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8447873?v=4",
         "events_url" : "https://api.github.com/users/wodry/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wodry/followers",
         "following_url" : "https://api.github.com/users/wodry/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wodry/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wodry",
         "id" : 8447873,
         "login" : "wodry",
         "node_id" : "MDQ6VXNlcjg0NDc4NzM=",
         "organizations_url" : "https://api.github.com/users/wodry/orgs",
         "received_events_url" : "https://api.github.com/users/wodry/received_events",
         "repos_url" : "https://api.github.com/users/wodry/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wodry/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wodry/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wodry"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The issues seems to be solved with bitcoind 0.18.1.\r\nMaybe #16405 fixed it?\r\n\r\nWith 0.18.1 CPU usage stays now low when internet connection goes down, and when internet connection is up again, at once bitcoind detects it and connects to new outbound peers.\r\nSo behavior is now really smooth.\r\nFrom my point of view, this issue can be closed.",
      "created_at" : "2019-08-09T21:02:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6903#issuecomment-520062394",
      "id" : 520062394,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6903",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUyMDA2MjM5NA==",
      "updated_at" : "2019-08-09T21:02:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/520062394",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8447873?v=4",
         "events_url" : "https://api.github.com/users/wodry/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wodry/followers",
         "following_url" : "https://api.github.com/users/wodry/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wodry/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wodry",
         "id" : 8447873,
         "login" : "wodry",
         "node_id" : "MDQ6VXNlcjg0NDc4NzM=",
         "organizations_url" : "https://api.github.com/users/wodry/orgs",
         "received_events_url" : "https://api.github.com/users/wodry/received_events",
         "repos_url" : "https://api.github.com/users/wodry/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wodry/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wodry/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wodry"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@wodry #16405 fix in unrelated to this issue.",
      "created_at" : "2019-08-09T21:10:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6903#issuecomment-520064543",
      "id" : 520064543,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6903",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUyMDA2NDU0Mw==",
      "updated_at" : "2019-08-09T21:10:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/520064543",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   }
]
