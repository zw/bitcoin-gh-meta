[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r140993847"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140993847"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit *Expose method to find key for a single-key destination*:\r\n\r\nUse `boost::apply_visitor` instead?",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-26T08:52:45Z",
      "diff_hunk" : "@@ -4051,3 +4051,24 @@ bool CWallet::IsSolvable(const CScript& script) const\n     SignatureData sigs;\n     return (ProduceSignature(creator, script, sigs) && VerifyScript(sigs.scriptSig, script, &sigs.scriptWitness, MANDATORY_SCRIPT_VERIFY_FLAGS | SCRIPT_VERIFY_WITNESS_PUBKEYTYPE, creator.Checker()));\n }\n+\n+CKeyID CWallet::GetKeyForDestination(const CTxDestination& dest) const\n+{\n+    // Only supports P2PKH, P2WPKH, P2SH-P2WPKH.\n+    if (boost::get<CKeyID>(&dest)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r140993847",
      "id" : 140993847,
      "original_commit_id" : "1ae94623eceb96728b6a791732776d01a455f83f",
      "original_position" : 8,
      "path" : "src/wallet/wallet.cpp",
      "position" : 55,
      "pull_request_review_id" : 65141769,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140993847",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r140994498"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140994498"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit *Expose method to find key for a single-key destination*:\r\n\r\nRecursive call?\r\n```cpp\r\n            return GetKeyForDestination(inner_dest);\r\n```",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-26T08:55:24Z",
      "diff_hunk" : "@@ -4051,3 +4051,24 @@ bool CWallet::IsSolvable(const CScript& script) const\n     SignatureData sigs;\n     return (ProduceSignature(creator, script, sigs) && VerifyScript(sigs.scriptSig, script, &sigs.scriptWitness, MANDATORY_SCRIPT_VERIFY_FLAGS | SCRIPT_VERIFY_WITNESS_PUBKEYTYPE, creator.Checker()));\n }\n+\n+CKeyID CWallet::GetKeyForDestination(const CTxDestination& dest) const\n+{\n+    // Only supports P2PKH, P2WPKH, P2SH-P2WPKH.\n+    if (boost::get<CKeyID>(&dest)) {\n+        return boost::get<CKeyID>(dest);\n+    }\n+    if (boost::get<WitnessV0KeyHash>(&dest)) {\n+        return CKeyID(boost::get<WitnessV0KeyHash>(dest));\n+    }\n+    if (boost::get<CScriptID>(&dest)) {\n+        CScript script;\n+        CTxDestination inner_dest;\n+        if (GetCScript(boost::get<CScriptID>(dest), script) && ExtractDestination(script, inner_dest)) {\n+            if (boost::get<WitnessV0KeyHash>(&inner_dest)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r140994498",
      "id" : 140994498,
      "original_commit_id" : "1ae94623eceb96728b6a791732776d01a455f83f",
      "original_position" : 18,
      "path" : "src/wallet/wallet.cpp",
      "position" : 65,
      "pull_request_review_id" : 65141769,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140994498",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r140995719"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140995719"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit *SegWit wallet support*:\r\n\r\nRemove?",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-26T09:00:02Z",
      "diff_hunk" : "@@ -4072,3 +4074,82 @@ CKeyID CWallet::GetKeyForDestination(const CTxDestination& dest) const\n     }\n     return CKeyID();\n }\n+\n+static const std::string STYLE_STRING_NONE = \"\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r140995719",
      "id" : 140995719,
      "original_commit_id" : "a3a79cdb2193facac697857a472fe90c235f7c82",
      "original_position" : 41,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 65141769,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140995719",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141033697"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141033697"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Add init tests (follow up maybe)?",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-26T11:58:03Z",
      "diff_hunk" : "@@ -168,6 +170,22 @@ bool WalletParameterInteraction()\n     bSpendZeroConfChange = gArgs.GetBoolArg(\"-spendzeroconfchange\", DEFAULT_SPEND_ZEROCONF_CHANGE);\n     fWalletRbf = gArgs.GetBoolArg(\"-walletrbf\", DEFAULT_WALLET_RBF);\n \n+    std::string style = gArgs.GetArg(\"-addressstyle\", \"default\");\n+    OutputStyle parsed_style = ParseStyle(style);\n+    if (parsed_style == STYLE_NONE) {\n+        return InitError(strprintf(_(\"Unknown address style '%s'\"), style));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141033697",
      "id" : 141033697,
      "original_commit_id" : "a3a79cdb2193facac697857a472fe90c235f7c82",
      "original_position" : 16,
      "path" : "src/wallet/init.cpp",
      "position" : 16,
      "pull_request_review_id" : 65141769,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141033697",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141034121"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141034121"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Missing default value?",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-26T12:00:16Z",
      "diff_hunk" : "@@ -225,11 +234,13 @@ UniValue getrawchangeaddress(const JSONRPCRequest& request)\n         return NullUniValue;\n     }\n \n-    if (request.fHelp || request.params.size() > 0)\n+    if (request.fHelp || request.params.size() > 1)\n         throw std::runtime_error(\n-            \"getrawchangeaddress\\n\"\n+            \"getrawchangeaddress ( \\\"style\\\" )\\n\"\n             \"\\nReturns a new Bitcoin address, for receiving change.\\n\"\n             \"This is for use with raw transactions, NOT normal use.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"style\\\"          (string, optional) The address style to use. Valid options are 'p2pkh', 'p2sh_p2wpkh', and 'p2wpkh'\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141034121",
      "id" : 141034121,
      "original_commit_id" : "a3a79cdb2193facac697857a472fe90c235f7c82",
      "original_position" : 69,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 69,
      "pull_request_review_id" : 65141769,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141034121",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141034255"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141034255"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Fix index `[0]`.",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-26T12:01:02Z",
      "diff_hunk" : "@@ -243,16 +254,24 @@ UniValue getrawchangeaddress(const JSONRPCRequest& request)\n         pwallet->TopUpKeyPool();\n     }\n \n+    OutputStyle style = change_style;\n+    if (!request.params[0].isNull()) {\n+        style = ParseStyle(request.params[1].get_str());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141034255",
      "id" : 141034255,
      "original_commit_id" : "a3a79cdb2193facac697857a472fe90c235f7c82",
      "original_position" : 79,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 79,
      "pull_request_review_id" : 65141769,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141034255",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141034483"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141034483"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Missing test for this error.",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-26T12:02:11Z",
      "diff_hunk" : "@@ -157,6 +158,14 @@ UniValue getnewaddress(const JSONRPCRequest& request)\n     if (!request.params[0].isNull())\n         strAccount = AccountFromValue(request.params[0]);\n \n+    OutputStyle style = address_style;\n+    if (!request.params[1].isNull()) {\n+        style = ParseStyle(request.params[1].get_str());\n+        if (style == STYLE_NONE) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, strprintf(\"Unknown address style '%s'\", request.params[1].get_str()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141034483",
      "id" : 141034483,
      "original_commit_id" : "a3a79cdb2193facac697857a472fe90c235f7c82",
      "original_position" : 26,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 26,
      "pull_request_review_id" : 65141769,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141034483",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141034548"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141034548"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Default value?",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-26T12:02:28Z",
      "diff_hunk" : "@@ -135,14 +135,15 @@ UniValue getnewaddress(const JSONRPCRequest& request)\n         return NullUniValue;\n     }\n \n-    if (request.fHelp || request.params.size() > 1)\n+    if (request.fHelp || request.params.size() > 2)\n         throw std::runtime_error(\n-            \"getnewaddress ( \\\"account\\\" )\\n\"\n+            \"getnewaddress ( \\\"account\\\" ) ( \\\"style\\\" )\\n\"\n             \"\\nReturns a new Bitcoin address for receiving payments.\\n\"\n             \"If 'account' is specified (DEPRECATED), it is added to the address book \\n\"\n             \"so payments received with the address will be credited to 'account'.\\n\"\n             \"\\nArguments:\\n\"\n             \"1. \\\"account\\\"        (string, optional) DEPRECATED. The account name for the address to be linked to. If not provided, the default account \\\"\\\" is used. It can also be set to the empty string \\\"\\\" to represent the default account. The account does not need to exist, it will be created if there is no account by the given name.\\n\"\n+            \"2. \\\"style\\\"          (string, optional) The address style to use. Valid options are 'p2pkh', 'p2sh_p2wpkh', and 'p2wpkh'\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141034548",
      "id" : 141034548,
      "original_commit_id" : "a3a79cdb2193facac697857a472fe90c235f7c82",
      "original_position" : 14,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 14,
      "pull_request_review_id" : 65141769,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141034548",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141034833"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141034833"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Add init tests (follow up maybe)?",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-26T12:03:46Z",
      "diff_hunk" : "@@ -168,6 +170,22 @@ bool WalletParameterInteraction()\n     bSpendZeroConfChange = gArgs.GetBoolArg(\"-spendzeroconfchange\", DEFAULT_SPEND_ZEROCONF_CHANGE);\n     fWalletRbf = gArgs.GetBoolArg(\"-walletrbf\", DEFAULT_WALLET_RBF);\n \n+    std::string style = gArgs.GetArg(\"-addressstyle\", \"default\");\n+    OutputStyle parsed_style = ParseStyle(style);\n+    if (parsed_style == STYLE_NONE) {\n+        return InitError(strprintf(_(\"Unknown address style '%s'\"), style));\n+    } else {\n+        address_style = parsed_style;\n+    }\n+\n+    style = gArgs.GetArg(\"-changestyle\", style);\n+    parsed_style = ParseStyle(style);\n+    if (parsed_style == STYLE_NONE) {\n+        return InitError(strprintf(_(\"Unknown change style '%s'\"), style));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141034833",
      "id" : 141034833,
      "original_commit_id" : "a3a79cdb2193facac697857a472fe90c235f7c82",
      "original_position" : 24,
      "path" : "src/wallet/init.cpp",
      "position" : 24,
      "pull_request_review_id" : 65141769,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141034833",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141034981"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141034981"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Missing test.",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-26T12:04:26Z",
      "diff_hunk" : "@@ -243,16 +254,24 @@ UniValue getrawchangeaddress(const JSONRPCRequest& request)\n         pwallet->TopUpKeyPool();\n     }\n \n+    OutputStyle style = change_style;\n+    if (!request.params[0].isNull()) {\n+        style = ParseStyle(request.params[1].get_str());\n+        if (style == STYLE_NONE) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, strprintf(\"Unknown address style '%s'\", request.params[0].get_str()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141034981",
      "id" : 141034981,
      "original_commit_id" : "a3a79cdb2193facac697857a472fe90c235f7c82",
      "original_position" : 81,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 81,
      "pull_request_review_id" : 65141769,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141034981",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141035708"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141035708"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Remove `, True` so that default value is tested.",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-26T12:07:53Z",
      "diff_hunk" : "@@ -133,8 +133,15 @@ def run_test(self):\n             newaddress = self.nodes[i].getnewaddress()\n             self.pubkey.append(self.nodes[i].validateaddress(newaddress)[\"pubkey\"])\n             multiaddress = self.nodes[i].addmultisigaddress(1, [self.pubkey[-1]])\n-            self.nodes[i].addwitnessaddress(newaddress)\n-            self.nodes[i].addwitnessaddress(multiaddress)\n+            multiscript = CScript([OP_1, hex_str_to_bytes(self.pubkey[-1]), OP_1, OP_CHECKMULTISIG])\n+            p2sh_addr = self.nodes[i].addwitnessaddress(newaddress, True)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141035708",
      "id" : 141035708,
      "original_commit_id" : "a3a79cdb2193facac697857a472fe90c235f7c82",
      "original_position" : 63,
      "path" : "test/functional/segwit.py",
      "position" : null,
      "pull_request_review_id" : 65141769,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141035708",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141137104"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141137104"
         }
      },
      "author_association" : "OWNER",
      "body" : "I tried that, but the result is much longer and harder to get right (see below). It's also the wrong approach I think. A visitor is used when you want to handle all possible types - here we specifically only want to support a specific subset of cases (P2PKH, P2WPKH, P2SH-P2WPKH).",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-26T18:06:20Z",
      "diff_hunk" : "@@ -4051,3 +4051,24 @@ bool CWallet::IsSolvable(const CScript& script) const\n     SignatureData sigs;\n     return (ProduceSignature(creator, script, sigs) && VerifyScript(sigs.scriptSig, script, &sigs.scriptWitness, MANDATORY_SCRIPT_VERIFY_FLAGS | SCRIPT_VERIFY_WITNESS_PUBKEYTYPE, creator.Checker()));\n }\n+\n+CKeyID CWallet::GetKeyForDestination(const CTxDestination& dest) const\n+{\n+    // Only supports P2PKH, P2WPKH, P2SH-P2WPKH.\n+    if (boost::get<CKeyID>(&dest)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141137104",
      "id" : 141137104,
      "in_reply_to_id" : 140993847,
      "original_commit_id" : "1ae94623eceb96728b6a791732776d01a455f83f",
      "original_position" : 8,
      "path" : "src/wallet/wallet.cpp",
      "position" : 55,
      "pull_request_review_id" : 65308272,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141137104",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141137409"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141137409"
         }
      },
      "author_association" : "OWNER",
      "body" : "It's not that easy, as it could match a superset (for example P2SH-P2PKH), or even invalid things (P2SH-P2SH-P2WPKH?).",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-26T18:07:28Z",
      "diff_hunk" : "@@ -4051,3 +4051,24 @@ bool CWallet::IsSolvable(const CScript& script) const\n     SignatureData sigs;\n     return (ProduceSignature(creator, script, sigs) && VerifyScript(sigs.scriptSig, script, &sigs.scriptWitness, MANDATORY_SCRIPT_VERIFY_FLAGS | SCRIPT_VERIFY_WITNESS_PUBKEYTYPE, creator.Checker()));\n }\n+\n+CKeyID CWallet::GetKeyForDestination(const CTxDestination& dest) const\n+{\n+    // Only supports P2PKH, P2WPKH, P2SH-P2WPKH.\n+    if (boost::get<CKeyID>(&dest)) {\n+        return boost::get<CKeyID>(dest);\n+    }\n+    if (boost::get<WitnessV0KeyHash>(&dest)) {\n+        return CKeyID(boost::get<WitnessV0KeyHash>(dest));\n+    }\n+    if (boost::get<CScriptID>(&dest)) {\n+        CScript script;\n+        CTxDestination inner_dest;\n+        if (GetCScript(boost::get<CScriptID>(dest), script) && ExtractDestination(script, inner_dest)) {\n+            if (boost::get<WitnessV0KeyHash>(&inner_dest)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141137409",
      "id" : 141137409,
      "in_reply_to_id" : 140994498,
      "original_commit_id" : "1ae94623eceb96728b6a791732776d01a455f83f",
      "original_position" : 18,
      "path" : "src/wallet/wallet.cpp",
      "position" : 65,
      "pull_request_review_id" : 65308623,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141137409",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141172352"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141172352"
         }
      },
      "author_association" : "MEMBER",
      "body" : "These should mention the defaults, which likely means refactoring how the \"default\" string is handled.",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-26T20:21:36Z",
      "diff_hunk" : "@@ -15,6 +15,8 @@\n std::string GetWalletHelpString(bool showDebug)\n {\n     std::string strUsage = HelpMessageGroup(_(\"Wallet options:\"));\n+    strUsage += HelpMessageOpt(\"-addressstyle\", _(\"What style addresses to use (\\\"p2pkh\\\", \\\"p2sh_p2wpkh\\\", \\\"p2wpkh\\\")\"));\n+    strUsage += HelpMessageOpt(\"-changestyle\", _(\"What style change to use (\\\"p2pkh\\\", \\\"p2sh_p2wpkh\\\", \\\"p2wpkh\\\")\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141172352",
      "id" : 141172352,
      "original_commit_id" : "a3a79cdb2193facac697857a472fe90c235f7c82",
      "original_position" : 5,
      "path" : "src/wallet/init.cpp",
      "position" : 5,
      "pull_request_review_id" : 65348501,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141172352",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141172562"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141172562"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Default should probably remain legacy until support for newer styles is complete (eg, `import*` RPC)?",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-26T20:22:30Z",
      "diff_hunk" : "@@ -4021,3 +4042,114 @@ bool CMerkleTx::AcceptToMemoryPool(const CAmount& nAbsurdFee, CValidationState&\n {\n     return ::AcceptToMemoryPool(mempool, state, tx, true, nullptr, nullptr, false, nAbsurdFee);\n }\n+\n+bool CWallet::IsSolvable(const CScript& script) const\n+{\n+    // This check is to make sure that the script we created can actually be solved for and signed by us\n+    // if we were to have the private keys. This is just to make sure that the script is valid and that,\n+    // if found in a transaction, we would still accept and relay that transaction. In particular,\n+    // it will reject witness outputs that require signing with an uncompressed public key.\n+    DummySignatureCreator creator(this);\n+    SignatureData sigs;\n+    return (ProduceSignature(creator, script, sigs) && VerifyScript(sigs.scriptSig, script, &sigs.scriptWitness, MANDATORY_SCRIPT_VERIFY_FLAGS | SCRIPT_VERIFY_WITNESS_PUBKEYTYPE, creator.Checker()));\n+}\n+\n+CKeyID CWallet::GetKeyForDestination(const CTxDestination& dest) const\n+{\n+    // Only supports P2PKH, P2WPKH, P2SH-P2WPKH.\n+    if (boost::get<CKeyID>(&dest)) {\n+        return boost::get<CKeyID>(dest);\n+    }\n+    if (boost::get<WitnessV0KeyHash>(&dest)) {\n+        return CKeyID(boost::get<WitnessV0KeyHash>(dest));\n+    }\n+    if (boost::get<CScriptID>(&dest)) {\n+        CScript script;\n+        CTxDestination inner_dest;\n+        if (GetCScript(boost::get<CScriptID>(dest), script) && ExtractDestination(script, inner_dest)) {\n+            if (boost::get<WitnessV0KeyHash>(&inner_dest)) {\n+                return CKeyID(boost::get<WitnessV0KeyHash>(inner_dest));\n+            }\n+        }\n+    }\n+    return CKeyID();\n+}\n+\n+static const std::string STYLE_STRING_NONE = \"\";\n+static const std::string STYLE_STRING_LEGACY = \"legacy\";\n+static const std::string STYLE_STRING_P2SH = \"p2sh\";\n+static const std::string STYLE_STRING_SEGWIT = \"segwit\";\n+\n+OutputStyle ParseStyle(const std::string& style)\n+{\n+    if (style == STYLE_STRING_LEGACY) {\n+        return STYLE_LEGACY;\n+    } else if (style == STYLE_STRING_P2SH || style == \"default\") {\n+        return STYLE_P2SH;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141172562",
      "id" : 141172562,
      "original_commit_id" : "a3a79cdb2193facac697857a472fe90c235f7c82",
      "original_position" : 111,
      "path" : "src/wallet/wallet.cpp",
      "position" : 83,
      "pull_request_review_id" : 65348501,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141172562",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141173466"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141173466"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Seems like it would be better to change the deprecated `\"account\"` into a JSON Object `options`.",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-26T20:25:56Z",
      "diff_hunk" : "@@ -135,14 +135,15 @@ UniValue getnewaddress(const JSONRPCRequest& request)\n         return NullUniValue;\n     }\n \n-    if (request.fHelp || request.params.size() > 1)\n+    if (request.fHelp || request.params.size() > 2)\n         throw std::runtime_error(\n-            \"getnewaddress ( \\\"account\\\" )\\n\"\n+            \"getnewaddress ( \\\"account\\\" ) ( \\\"style\\\" )\\n\"\n             \"\\nReturns a new Bitcoin address for receiving payments.\\n\"\n             \"If 'account' is specified (DEPRECATED), it is added to the address book \\n\"\n             \"so payments received with the address will be credited to 'account'.\\n\"\n             \"\\nArguments:\\n\"\n             \"1. \\\"account\\\"        (string, optional) DEPRECATED. The account name for the address to be linked to. If not provided, the default account \\\"\\\" is used. It can also be set to the empty string \\\"\\\" to represent the default account. The account does not need to exist, it will be created if there is no account by the given name.\\n\"\n+            \"2. \\\"style\\\"          (string, optional) The address style to use. Valid options are 'p2pkh', 'p2sh_p2wpkh', and 'p2wpkh'\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141173466",
      "id" : 141173466,
      "original_commit_id" : "a3a79cdb2193facac697857a472fe90c235f7c82",
      "original_position" : 14,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 14,
      "pull_request_review_id" : 65348501,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141173466",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141575484"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141575484"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Right.\r\n\r\nIsn't boost::get kind of expensive? Avoid 2nd call?",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-28T09:56:46Z",
      "diff_hunk" : "@@ -4051,3 +4051,24 @@ bool CWallet::IsSolvable(const CScript& script) const\n     SignatureData sigs;\n     return (ProduceSignature(creator, script, sigs) && VerifyScript(sigs.scriptSig, script, &sigs.scriptWitness, MANDATORY_SCRIPT_VERIFY_FLAGS | SCRIPT_VERIFY_WITNESS_PUBKEYTYPE, creator.Checker()));\n }\n+\n+CKeyID CWallet::GetKeyForDestination(const CTxDestination& dest) const\n+{\n+    // Only supports P2PKH, P2WPKH, P2SH-P2WPKH.\n+    if (boost::get<CKeyID>(&dest)) {\n+        return boost::get<CKeyID>(dest);\n+    }\n+    if (boost::get<WitnessV0KeyHash>(&dest)) {\n+        return CKeyID(boost::get<WitnessV0KeyHash>(dest));\n+    }\n+    if (boost::get<CScriptID>(&dest)) {\n+        CScript script;\n+        CTxDestination inner_dest;\n+        if (GetCScript(boost::get<CScriptID>(dest), script) && ExtractDestination(script, inner_dest)) {\n+            if (boost::get<WitnessV0KeyHash>(&inner_dest)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141575484",
      "id" : 141575484,
      "in_reply_to_id" : 140994498,
      "original_commit_id" : "1ae94623eceb96728b6a791732776d01a455f83f",
      "original_position" : 18,
      "path" : "src/wallet/wallet.cpp",
      "position" : 65,
      "pull_request_review_id" : 65808218,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141575484",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141580941"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141580941"
         }
      },
      "author_association" : "OWNER",
      "body" : "I'd rather not. This makes the existing tests far more powerful.",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-28T10:23:28Z",
      "diff_hunk" : "@@ -4021,3 +4042,114 @@ bool CMerkleTx::AcceptToMemoryPool(const CAmount& nAbsurdFee, CValidationState&\n {\n     return ::AcceptToMemoryPool(mempool, state, tx, true, nullptr, nullptr, false, nAbsurdFee);\n }\n+\n+bool CWallet::IsSolvable(const CScript& script) const\n+{\n+    // This check is to make sure that the script we created can actually be solved for and signed by us\n+    // if we were to have the private keys. This is just to make sure that the script is valid and that,\n+    // if found in a transaction, we would still accept and relay that transaction. In particular,\n+    // it will reject witness outputs that require signing with an uncompressed public key.\n+    DummySignatureCreator creator(this);\n+    SignatureData sigs;\n+    return (ProduceSignature(creator, script, sigs) && VerifyScript(sigs.scriptSig, script, &sigs.scriptWitness, MANDATORY_SCRIPT_VERIFY_FLAGS | SCRIPT_VERIFY_WITNESS_PUBKEYTYPE, creator.Checker()));\n+}\n+\n+CKeyID CWallet::GetKeyForDestination(const CTxDestination& dest) const\n+{\n+    // Only supports P2PKH, P2WPKH, P2SH-P2WPKH.\n+    if (boost::get<CKeyID>(&dest)) {\n+        return boost::get<CKeyID>(dest);\n+    }\n+    if (boost::get<WitnessV0KeyHash>(&dest)) {\n+        return CKeyID(boost::get<WitnessV0KeyHash>(dest));\n+    }\n+    if (boost::get<CScriptID>(&dest)) {\n+        CScript script;\n+        CTxDestination inner_dest;\n+        if (GetCScript(boost::get<CScriptID>(dest), script) && ExtractDestination(script, inner_dest)) {\n+            if (boost::get<WitnessV0KeyHash>(&inner_dest)) {\n+                return CKeyID(boost::get<WitnessV0KeyHash>(inner_dest));\n+            }\n+        }\n+    }\n+    return CKeyID();\n+}\n+\n+static const std::string STYLE_STRING_NONE = \"\";\n+static const std::string STYLE_STRING_LEGACY = \"legacy\";\n+static const std::string STYLE_STRING_P2SH = \"p2sh\";\n+static const std::string STYLE_STRING_SEGWIT = \"segwit\";\n+\n+OutputStyle ParseStyle(const std::string& style)\n+{\n+    if (style == STYLE_STRING_LEGACY) {\n+        return STYLE_LEGACY;\n+    } else if (style == STYLE_STRING_P2SH || style == \"default\") {\n+        return STYLE_P2SH;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141580941",
      "id" : 141580941,
      "in_reply_to_id" : 141172562,
      "original_commit_id" : "a3a79cdb2193facac697857a472fe90c235f7c82",
      "original_position" : 111,
      "path" : "src/wallet/wallet.cpp",
      "position" : 83,
      "pull_request_review_id" : 65814667,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141580941",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "A potential problem with supporting `-addressstyle=segwit` w/ Bech32 on day zero is it may confuse people into thinking segwit *needs* the new address format. OTOH, if we don't, it probably makes the P2SH adoption hell more likely.",
      "created_at" : "2017-09-28T19:12:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#issuecomment-332935671",
      "id" : 332935671,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11403",
      "updated_at" : "2017-09-28T19:12:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/332935671",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7042?v=4",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141715642"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141715642"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Tests don't need to (and probably shouldn't) rely on defaults...",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-28T19:36:44Z",
      "diff_hunk" : "@@ -4021,3 +4042,114 @@ bool CMerkleTx::AcceptToMemoryPool(const CAmount& nAbsurdFee, CValidationState&\n {\n     return ::AcceptToMemoryPool(mempool, state, tx, true, nullptr, nullptr, false, nAbsurdFee);\n }\n+\n+bool CWallet::IsSolvable(const CScript& script) const\n+{\n+    // This check is to make sure that the script we created can actually be solved for and signed by us\n+    // if we were to have the private keys. This is just to make sure that the script is valid and that,\n+    // if found in a transaction, we would still accept and relay that transaction. In particular,\n+    // it will reject witness outputs that require signing with an uncompressed public key.\n+    DummySignatureCreator creator(this);\n+    SignatureData sigs;\n+    return (ProduceSignature(creator, script, sigs) && VerifyScript(sigs.scriptSig, script, &sigs.scriptWitness, MANDATORY_SCRIPT_VERIFY_FLAGS | SCRIPT_VERIFY_WITNESS_PUBKEYTYPE, creator.Checker()));\n+}\n+\n+CKeyID CWallet::GetKeyForDestination(const CTxDestination& dest) const\n+{\n+    // Only supports P2PKH, P2WPKH, P2SH-P2WPKH.\n+    if (boost::get<CKeyID>(&dest)) {\n+        return boost::get<CKeyID>(dest);\n+    }\n+    if (boost::get<WitnessV0KeyHash>(&dest)) {\n+        return CKeyID(boost::get<WitnessV0KeyHash>(dest));\n+    }\n+    if (boost::get<CScriptID>(&dest)) {\n+        CScript script;\n+        CTxDestination inner_dest;\n+        if (GetCScript(boost::get<CScriptID>(dest), script) && ExtractDestination(script, inner_dest)) {\n+            if (boost::get<WitnessV0KeyHash>(&inner_dest)) {\n+                return CKeyID(boost::get<WitnessV0KeyHash>(inner_dest));\n+            }\n+        }\n+    }\n+    return CKeyID();\n+}\n+\n+static const std::string STYLE_STRING_NONE = \"\";\n+static const std::string STYLE_STRING_LEGACY = \"legacy\";\n+static const std::string STYLE_STRING_P2SH = \"p2sh\";\n+static const std::string STYLE_STRING_SEGWIT = \"segwit\";\n+\n+OutputStyle ParseStyle(const std::string& style)\n+{\n+    if (style == STYLE_STRING_LEGACY) {\n+        return STYLE_LEGACY;\n+    } else if (style == STYLE_STRING_P2SH || style == \"default\") {\n+        return STYLE_P2SH;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141715642",
      "id" : 141715642,
      "in_reply_to_id" : 141172562,
      "original_commit_id" : "a3a79cdb2193facac697857a472fe90c235f7c82",
      "original_position" : 111,
      "path" : "src/wallet/wallet.cpp",
      "position" : 83,
      "pull_request_review_id" : 65975207,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141715642",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "maybe it should be renamed to `-addressstyle=bech32`? ",
      "created_at" : "2017-09-28T21:08:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#issuecomment-332964633",
      "id" : 332964633,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11403",
      "updated_at" : "2017-09-28T21:08:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/332964633",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/425166?v=4",
         "events_url" : "https://api.github.com/users/flack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/flack/followers",
         "following_url" : "https://api.github.com/users/flack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/flack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/flack",
         "id" : 425166,
         "login" : "flack",
         "organizations_url" : "https://api.github.com/users/flack/orgs",
         "received_events_url" : "https://api.github.com/users/flack/received_events",
         "repos_url" : "https://api.github.com/users/flack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/flack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/flack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/flack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Needs rebase after #11167 merge but that'll make it clearer what's new here to review :+1:",
      "created_at" : "2017-09-29T11:57:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#issuecomment-333107294",
      "id" : 333107294,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11403",
      "updated_at" : "2017-09-29T11:57:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/333107294",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/MeshCollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MeshCollider/followers",
         "following_url" : "https://api.github.com/users/MeshCollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MeshCollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MeshCollider",
         "id" : 3211283,
         "login" : "MeshCollider",
         "organizations_url" : "https://api.github.com/users/MeshCollider/orgs",
         "received_events_url" : "https://api.github.com/users/MeshCollider/received_events",
         "repos_url" : "https://api.github.com/users/MeshCollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MeshCollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MeshCollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MeshCollider"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141910029"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141910029"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This field needs to be added anywhere it's used in help text for RPC calls. ",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-29T16:23:36Z",
      "diff_hunk" : "@@ -64,6 +67,13 @@ class DescribeAddressVisitor : public boost::static_visitor<UniValue>\n             obj.push_back(Pair(\"script\", GetTxnOutputType(whichType)));\n             obj.push_back(Pair(\"hex\", HexStr(subscript.begin(), subscript.end())));\n             UniValue a(UniValue::VARR);\n+            if (whichType == TX_WITNESS_V0_KEYHASH || whichType == TX_WITNESS_V0_SCRIPTHASH) {\n+                UniValue subobj = boost::apply_visitor(*this, addresses[0]);\n+                obj.push_back(Pair(\"embedded\", std::move(subobj)));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141910029",
      "id" : 141910029,
      "original_commit_id" : "a3a79cdb2193facac697857a472fe90c235f7c82",
      "original_position" : 30,
      "path" : "src/rpc/misc.cpp",
      "position" : 6,
      "pull_request_review_id" : 66202799,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141910029",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141910356"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141910356"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Remove plurals from description.",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-29T16:25:13Z",
      "diff_hunk" : "@@ -1111,6 +1111,9 @@ class CWallet final : public CCryptoKeyStore, public CValidationInterface\n      * have all private keys. This is unrelated to whether we consider this\n      * output to be ours. */\n     bool IsSolvable(const CScript& script) const;\n+\n+    /** Return the hashes of the keys involved in a script. */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141910356",
      "id" : 141910356,
      "original_commit_id" : "1ae94623eceb96728b6a791732776d01a455f83f",
      "original_position" : 5,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_review_id" : 66203188,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141910356",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "Rebased after #11167 merge.",
      "created_at" : "2017-09-29T18:36:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#issuecomment-333205001",
      "id" : 333205001,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11403",
      "updated_at" : "2017-09-29T18:36:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/333205001",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141940333"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141940333"
         }
      },
      "author_association" : "OWNER",
      "body" : "Yes and no.\r\n\r\nI think that many tests, which are primarily testing things unrelated to addresses, should use the default address type. They don't strictly rely on them, but it's better if they work with either type, and it's certainly easier to not need to change all of them.",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-29T18:47:45Z",
      "diff_hunk" : "@@ -4021,3 +4042,114 @@ bool CMerkleTx::AcceptToMemoryPool(const CAmount& nAbsurdFee, CValidationState&\n {\n     return ::AcceptToMemoryPool(mempool, state, tx, true, nullptr, nullptr, false, nAbsurdFee);\n }\n+\n+bool CWallet::IsSolvable(const CScript& script) const\n+{\n+    // This check is to make sure that the script we created can actually be solved for and signed by us\n+    // if we were to have the private keys. This is just to make sure that the script is valid and that,\n+    // if found in a transaction, we would still accept and relay that transaction. In particular,\n+    // it will reject witness outputs that require signing with an uncompressed public key.\n+    DummySignatureCreator creator(this);\n+    SignatureData sigs;\n+    return (ProduceSignature(creator, script, sigs) && VerifyScript(sigs.scriptSig, script, &sigs.scriptWitness, MANDATORY_SCRIPT_VERIFY_FLAGS | SCRIPT_VERIFY_WITNESS_PUBKEYTYPE, creator.Checker()));\n+}\n+\n+CKeyID CWallet::GetKeyForDestination(const CTxDestination& dest) const\n+{\n+    // Only supports P2PKH, P2WPKH, P2SH-P2WPKH.\n+    if (boost::get<CKeyID>(&dest)) {\n+        return boost::get<CKeyID>(dest);\n+    }\n+    if (boost::get<WitnessV0KeyHash>(&dest)) {\n+        return CKeyID(boost::get<WitnessV0KeyHash>(dest));\n+    }\n+    if (boost::get<CScriptID>(&dest)) {\n+        CScript script;\n+        CTxDestination inner_dest;\n+        if (GetCScript(boost::get<CScriptID>(dest), script) && ExtractDestination(script, inner_dest)) {\n+            if (boost::get<WitnessV0KeyHash>(&inner_dest)) {\n+                return CKeyID(boost::get<WitnessV0KeyHash>(inner_dest));\n+            }\n+        }\n+    }\n+    return CKeyID();\n+}\n+\n+static const std::string STYLE_STRING_NONE = \"\";\n+static const std::string STYLE_STRING_LEGACY = \"legacy\";\n+static const std::string STYLE_STRING_P2SH = \"p2sh\";\n+static const std::string STYLE_STRING_SEGWIT = \"segwit\";\n+\n+OutputStyle ParseStyle(const std::string& style)\n+{\n+    if (style == STYLE_STRING_LEGACY) {\n+        return STYLE_LEGACY;\n+    } else if (style == STYLE_STRING_P2SH || style == \"default\") {\n+        return STYLE_P2SH;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141940333",
      "id" : 141940333,
      "in_reply_to_id" : 141172562,
      "original_commit_id" : "a3a79cdb2193facac697857a472fe90c235f7c82",
      "original_position" : 111,
      "path" : "src/wallet/wallet.cpp",
      "position" : 83,
      "pull_request_review_id" : 66238860,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141940333",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141960988"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141960988"
         }
      },
      "author_association" : "MEMBER",
      "body" : "pedantic nit, but this only supports v0 of each witness version",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-29T20:28:13Z",
      "diff_hunk" : "@@ -4061,3 +4061,24 @@ bool CWallet::IsSolvable(const CScript& script) const\n     SignatureData sigs;\n     return (ProduceSignature(creator, script, sigs) && VerifyScript(sigs.scriptSig, script, &sigs.scriptWitness, MANDATORY_SCRIPT_VERIFY_FLAGS | SCRIPT_VERIFY_WITNESS_PUBKEYTYPE, creator.Checker()));\n }\n+\n+CKeyID CWallet::GetKeyForDestination(const CTxDestination& dest) const\n+{\n+    // Only supports P2PKH, P2WPKH, P2SH-P2WPKH.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141960988",
      "id" : 141960988,
      "original_commit_id" : "7f88d8ad7796c0f6d1e80d11943c19f0af2cda62",
      "original_position" : 7,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 66263128,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141960988",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141964928"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141964928"
         }
      },
      "author_association" : "MEMBER",
      "body" : "startup options strings being different than getnewaddress options is a bit odd to me?\r\n\r\n'p2sh_p2wpkh' vs `p2sh` etc",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-29T20:49:11Z",
      "diff_hunk" : "@@ -135,14 +135,15 @@ UniValue getnewaddress(const JSONRPCRequest& request)\n         return NullUniValue;\n     }\n \n-    if (request.fHelp || request.params.size() > 1)\n+    if (request.fHelp || request.params.size() > 2)\n         throw std::runtime_error(\n-            \"getnewaddress ( \\\"account\\\" )\\n\"\n+            \"getnewaddress ( \\\"account\\\" ) ( \\\"style\\\" )\\n\"\n             \"\\nReturns a new Bitcoin address for receiving payments.\\n\"\n             \"If 'account' is specified (DEPRECATED), it is added to the address book \\n\"\n             \"so payments received with the address will be credited to 'account'.\\n\"\n             \"\\nArguments:\\n\"\n             \"1. \\\"account\\\"        (string, optional) DEPRECATED. The account name for the address to be linked to. If not provided, the default account \\\"\\\" is used. It can also be set to the empty string \\\"\\\" to represent the default account. The account does not need to exist, it will be created if there is no account by the given name.\\n\"\n+            \"2. \\\"style\\\"          (string, optional) The address style to use. Valid options are 'p2pkh', 'p2sh_p2wpkh', and 'p2wpkh'\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141964928",
      "id" : 141964928,
      "original_commit_id" : "20da3447269696a3505b061852771d0bb11d6779",
      "original_position" : 14,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 14,
      "pull_request_review_id" : 66263128,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141964928",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141965443"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141965443"
         }
      },
      "author_association" : "MEMBER",
      "body" : "No solution off the top of my head, but it makes sense that this would be set per-wallet. If not, could we name it `g_address_style`?",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-29T20:51:49Z",
      "diff_hunk" : "@@ -43,6 +43,8 @@ CFeeRate payTxFee(DEFAULT_TRANSACTION_FEE);\n unsigned int nTxConfirmTarget = DEFAULT_TX_CONFIRM_TARGET;\n bool bSpendZeroConfChange = DEFAULT_SPEND_ZEROCONF_CHANGE;\n bool fWalletRbf = DEFAULT_WALLET_RBF;\n+OutputStyle address_style = STYLE_P2SH;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141965443",
      "id" : 141965443,
      "original_commit_id" : "20da3447269696a3505b061852771d0bb11d6779",
      "original_position" : 4,
      "path" : "src/wallet/wallet.cpp",
      "position" : 4,
      "pull_request_review_id" : 66263128,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141965443",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141966093"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141966093"
         }
      },
      "author_association" : "MEMBER",
      "body" : "changestyle needs a test",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-29T20:55:21Z",
      "diff_hunk" : "@@ -168,6 +170,22 @@ bool WalletParameterInteraction()\n     bSpendZeroConfChange = gArgs.GetBoolArg(\"-spendzeroconfchange\", DEFAULT_SPEND_ZEROCONF_CHANGE);\n     fWalletRbf = gArgs.GetBoolArg(\"-walletrbf\", DEFAULT_WALLET_RBF);\n \n+    std::string style = gArgs.GetArg(\"-addressstyle\", \"default\");\n+    OutputStyle parsed_style = ParseStyle(style);\n+    if (parsed_style == STYLE_NONE) {\n+        return InitError(strprintf(_(\"Unknown address style '%s'\"), style));\n+    } else {\n+        address_style = parsed_style;\n+    }\n+\n+    style = gArgs.GetArg(\"-changestyle\", style);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141966093",
      "id" : 141966093,
      "original_commit_id" : "20da3447269696a3505b061852771d0bb11d6779",
      "original_position" : 21,
      "path" : "src/wallet/init.cpp",
      "position" : 21,
      "pull_request_review_id" : 66263128,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141966093",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141966363"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141966363"
         }
      },
      "author_association" : "MEMBER",
      "body" : "argument needs a test",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-29T20:56:35Z",
      "diff_hunk" : "@@ -225,11 +234,13 @@ UniValue getrawchangeaddress(const JSONRPCRequest& request)\n         return NullUniValue;\n     }\n \n-    if (request.fHelp || request.params.size() > 0)\n+    if (request.fHelp || request.params.size() > 1)\n         throw std::runtime_error(\n-            \"getrawchangeaddress\\n\"\n+            \"getrawchangeaddress ( \\\"style\\\" )\\n\"\n             \"\\nReturns a new Bitcoin address, for receiving change.\\n\"\n             \"This is for use with raw transactions, NOT normal use.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"style\\\"          (string, optional) The address style to use. Valid options are 'p2pkh', 'p2sh_p2wpkh', and 'p2wpkh'\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141966363",
      "id" : 141966363,
      "original_commit_id" : "20da3447269696a3505b061852771d0bb11d6779",
      "original_position" : 69,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 69,
      "pull_request_review_id" : 66263128,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141966363",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141967056"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141967056"
         }
      },
      "author_association" : "MEMBER",
      "body" : "change seems way out of place here",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-29T20:59:35Z",
      "diff_hunk" : "@@ -1234,7 +1254,7 @@ UniValue addwitnessaddress(const JSONRPCRequest& request)\n \n     {\n         LOCK(cs_main);\n-        if (!IsWitnessEnabled(chainActive.Tip(), Params().GetConsensus()) && !gArgs.GetBoolArg(\"-walletprematurewitness\", false)) {\n+        if (!IsWitnessEnabled(pindexBestHeader, Params().GetConsensus()) && !gArgs.GetBoolArg(\"-walletprematurewitness\", false)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141967056",
      "id" : 141967056,
      "original_commit_id" : "20da3447269696a3505b061852771d0bb11d6779",
      "original_position" : 121,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 149,
      "pull_request_review_id" : 66263128,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141967056",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141967691"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141967691"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Same suggestion as address_style",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-09-29T21:02:18Z",
      "diff_hunk" : "@@ -43,6 +43,8 @@ CFeeRate payTxFee(DEFAULT_TRANSACTION_FEE);\n unsigned int nTxConfirmTarget = DEFAULT_TX_CONFIRM_TARGET;\n bool bSpendZeroConfChange = DEFAULT_SPEND_ZEROCONF_CHANGE;\n bool fWalletRbf = DEFAULT_WALLET_RBF;\n+OutputStyle address_style = STYLE_P2SH;\n+OutputStyle change_style = STYLE_P2SH;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r141967691",
      "id" : 141967691,
      "original_commit_id" : "20da3447269696a3505b061852771d0bb11d6779",
      "original_position" : 5,
      "path" : "src/wallet/wallet.cpp",
      "position" : 5,
      "pull_request_review_id" : 66263128,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/141967691",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Regarding petertodd's concern, I think something like flack's suggestion would address it.",
      "created_at" : "2017-10-11T20:02:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#issuecomment-335931037",
      "id" : 335931037,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11403",
      "updated_at" : "2017-10-11T20:02:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/335931037",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r144192744"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144192744"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The help for e.g. `getnewaddress` says `\"p2wpkh\"` etc. One or the other needs to be changed.",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-10-12T04:38:39Z",
      "diff_hunk" : "@@ -4050,3 +4052,114 @@ bool CMerkleTx::AcceptToMemoryPool(const CAmount& nAbsurdFee, CValidationState&\n     return ::AcceptToMemoryPool(mempool, state, tx, nullptr /* pfMissingInputs */,\n                                 nullptr /* plTxnReplaced */, false /* bypass_limits */, nAbsurdFee);\n }\n+\n+bool CWallet::IsSolvable(const CScript& script) const\n+{\n+    // This check is to make sure that the script we created can actually be solved for and signed by us\n+    // if we were to have the private keys. This is just to make sure that the script is valid and that,\n+    // if found in a transaction, we would still accept and relay that transaction. In particular,\n+    // it will reject witness outputs that require signing with an uncompressed public key.\n+    DummySignatureCreator creator(this);\n+    SignatureData sigs;\n+    return (ProduceSignature(creator, script, sigs) && VerifyScript(sigs.scriptSig, script, &sigs.scriptWitness, MANDATORY_SCRIPT_VERIFY_FLAGS | SCRIPT_VERIFY_WITNESS_PUBKEYTYPE, creator.Checker()));\n+}\n+\n+CKeyID CWallet::GetKeyForDestination(const CTxDestination& dest) const\n+{\n+    // Only supports P2PKH, P2WPKH, P2SH-P2WPKH.\n+    if (boost::get<CKeyID>(&dest)) {\n+        return boost::get<CKeyID>(dest);\n+    }\n+    if (boost::get<WitnessV0KeyHash>(&dest)) {\n+        return CKeyID(boost::get<WitnessV0KeyHash>(dest));\n+    }\n+    if (boost::get<CScriptID>(&dest)) {\n+        CScript script;\n+        CTxDestination inner_dest;\n+        if (GetCScript(boost::get<CScriptID>(dest), script) && ExtractDestination(script, inner_dest)) {\n+            if (boost::get<WitnessV0KeyHash>(&inner_dest)) {\n+                return CKeyID(boost::get<WitnessV0KeyHash>(inner_dest));\n+            }\n+        }\n+    }\n+    return CKeyID();\n+}\n+\n+static const std::string STYLE_STRING_NONE = \"\";\n+static const std::string STYLE_STRING_LEGACY = \"legacy\";\n+static const std::string STYLE_STRING_P2SH = \"p2sh\";\n+static const std::string STYLE_STRING_SEGWIT = \"segwit\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r144192744",
      "id" : 144192744,
      "original_commit_id" : "5632374f2f71bca384ceed07ca6842fd87102346",
      "original_position" : 76,
      "path" : "src/wallet/wallet.cpp",
      "position" : 76,
      "pull_request_review_id" : 68814644,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144192744",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r144193626"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144193626"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think you want `\"getnewaddress ( \\\"account\\\" \\\"style\\\" )\\n\"`",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-10-12T04:49:26Z",
      "diff_hunk" : "@@ -135,14 +135,15 @@ UniValue getnewaddress(const JSONRPCRequest& request)\n         return NullUniValue;\n     }\n \n-    if (request.fHelp || request.params.size() > 1)\n+    if (request.fHelp || request.params.size() > 2)\n         throw std::runtime_error(\n-            \"getnewaddress ( \\\"account\\\" )\\n\"\n+            \"getnewaddress ( \\\"account\\\" ) ( \\\"style\\\" )\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r144193626",
      "id" : 144193626,
      "original_commit_id" : "5632374f2f71bca384ceed07ca6842fd87102346",
      "original_position" : 8,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 8,
      "pull_request_review_id" : 68814644,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144193626",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r144199735"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144199735"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This shouldn't just be tacked on the end. Accounts are deprecated. Just replace \"account\" with an options Object.",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-10-12T05:56:19Z",
      "diff_hunk" : "@@ -135,14 +135,15 @@ UniValue getnewaddress(const JSONRPCRequest& request)\n         return NullUniValue;\n     }\n \n-    if (request.fHelp || request.params.size() > 1)\n+    if (request.fHelp || request.params.size() > 2)\n         throw std::runtime_error(\n-            \"getnewaddress ( \\\"account\\\" )\\n\"\n+            \"getnewaddress ( \\\"account\\\" ) ( \\\"style\\\" )\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r144199735",
      "id" : 144199735,
      "original_commit_id" : "5632374f2f71bca384ceed07ca6842fd87102346",
      "original_position" : 8,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 8,
      "pull_request_review_id" : 68822415,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144199735",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r144636061"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144636061"
         }
      },
      "author_association" : "MEMBER",
      "body" : "That would be API breaking for a lot of parties which is at odds with rapid deployment.",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-10-13T19:13:16Z",
      "diff_hunk" : "@@ -135,14 +135,15 @@ UniValue getnewaddress(const JSONRPCRequest& request)\n         return NullUniValue;\n     }\n \n-    if (request.fHelp || request.params.size() > 1)\n+    if (request.fHelp || request.params.size() > 2)\n         throw std::runtime_error(\n-            \"getnewaddress ( \\\"account\\\" )\\n\"\n+            \"getnewaddress ( \\\"account\\\" ) ( \\\"style\\\" )\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r144636061",
      "id" : 144636061,
      "in_reply_to_id" : 144199735,
      "original_commit_id" : "5632374f2f71bca384ceed07ca6842fd87102346",
      "original_position" : 8,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 8,
      "pull_request_review_id" : 69324709,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-14T02:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/144636061",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r145239469"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145239469"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You could instead inherit the ctors from uint160/uint256 to shortcut the construction from ```WitnessV0KeyHash(uint160(foo)``` to ```WitnessV0KeyHash(foo)```:\r\n```c++\r\nusing uint160::uint160;\r\n```",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-10-17T20:02:36Z",
      "diff_hunk" : "@@ -73,8 +73,19 @@ class CNoDestination {\n     friend bool operator<(const CNoDestination &a, const CNoDestination &b) { return true; }\n };\n \n-struct WitnessV0ScriptHash : public uint256 {};\n-struct WitnessV0KeyHash : public uint160 {};\n+struct WitnessV0ScriptHash : public uint256\n+{\n+public:\n+    WitnessV0ScriptHash() : uint256() {}\n+    WitnessV0ScriptHash(const uint256& in) : uint256(in) {}\n+};\n+\n+struct WitnessV0KeyHash : public uint160\n+{\n+public:\n+    WitnessV0KeyHash() : uint160() {}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r145239469",
      "id" : 145239469,
      "original_commit_id" : "fb0361d74a578c626b8876e71ad35775d718aed9",
      "original_position" : 16,
      "path" : "src/script/standard.h",
      "position" : 16,
      "pull_request_review_id" : 70011130,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-17T20:02:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145239469",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r145240904"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145240904"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You might want to _copy_ the field to the help text rather than _move_ it, though :p\r\n\r\n(Use after move here)",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-10-17T20:08:07Z",
      "diff_hunk" : "@@ -64,6 +67,13 @@ class DescribeAddressVisitor : public boost::static_visitor<UniValue>\n             obj.push_back(Pair(\"script\", GetTxnOutputType(whichType)));\n             obj.push_back(Pair(\"hex\", HexStr(subscript.begin(), subscript.end())));\n             UniValue a(UniValue::VARR);\n+            if (whichType == TX_WITNESS_V0_KEYHASH || whichType == TX_WITNESS_V0_SCRIPTHASH) {\n+                UniValue subobj = boost::apply_visitor(*this, addresses[0]);\n+                obj.push_back(Pair(\"embedded\", std::move(subobj)));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r145240904",
      "id" : 145240904,
      "in_reply_to_id" : 141910029,
      "original_commit_id" : "a3a79cdb2193facac697857a472fe90c235f7c82",
      "original_position" : 30,
      "path" : "src/rpc/misc.cpp",
      "position" : 6,
      "pull_request_review_id" : 70012766,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-17T20:08:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145240904",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r145245638"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145245638"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why dupe this? Helps with existing tooling?",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-10-17T20:26:40Z",
      "diff_hunk" : "@@ -67,6 +67,13 @@ class DescribeAddressVisitor : public boost::static_visitor<UniValue>\n             obj.push_back(Pair(\"script\", GetTxnOutputType(whichType)));\n             obj.push_back(Pair(\"hex\", HexStr(subscript.begin(), subscript.end())));\n             UniValue a(UniValue::VARR);\n+            if (whichType == TX_WITNESS_V0_KEYHASH || whichType == TX_WITNESS_V0_SCRIPTHASH) {\n+                UniValue subobj = boost::apply_visitor(*this, addresses[0]);\n+                obj.push_back(Pair(\"embedded\", std::move(subobj)));\n+                if (subobj.exists(\"pubkey\")) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r145245638",
      "id" : 145245638,
      "original_commit_id" : "97f4fc173dda51f21cc092b9b29a9ea4b208f8e2",
      "original_position" : 7,
      "path" : "src/rpc/misc.cpp",
      "position" : 7,
      "pull_request_review_id" : 70018324,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-17T22:38:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145245638",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r145255319"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145255319"
         }
      },
      "author_association" : "MEMBER",
      "body" : "imo, it's clearer (and less redundant) to test the result of the assignment:\r\n```c++\r\n    if (const CKeyID* ret = boost::get<CKeyID>(&dest)) {\r\n        return *ret;\r\n    }\r\n```",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-10-17T21:02:22Z",
      "diff_hunk" : "@@ -4072,3 +4072,24 @@ bool CWallet::IsSolvable(const CScript& script) const\n     SignatureData sigs;\n     return (ProduceSignature(creator, script, sigs) && VerifyScript(sigs.scriptSig, script, &sigs.scriptWitness, MANDATORY_SCRIPT_VERIFY_FLAGS | SCRIPT_VERIFY_WITNESS_PUBKEYTYPE, creator.Checker()));\n }\n+\n+CKeyID CWallet::GetKeyForDestination(const CTxDestination& dest) const\n+{\n+    // Only supports P2PKH, P2WPKH, P2SH-P2WPKH.\n+    if (boost::get<CKeyID>(&dest)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r145255319",
      "id" : 145255319,
      "original_commit_id" : "8c55a70cebeb4e18c686c93d96dde95deed6dc0e",
      "original_position" : 8,
      "path" : "src/wallet/wallet.cpp",
      "position" : 55,
      "pull_request_review_id" : 70018324,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-17T22:38:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145255319",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r145261446"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145261446"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm not sure about the sequencing rules here. I'd feel safer with a temporary CScriptID.",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-10-17T21:28:51Z",
      "diff_hunk" : "@@ -13,6 +13,18 @@ bool CKeyStore::AddKey(const CKey &key) {\n     return AddKeyPubKey(key, key.GetPubKey());\n }\n \n+void CBasicKeyStore::AddRelatedKeyScripts(const CPubKey& pubkey)\n+{\n+    AssertLockHeld(cs_KeyStore);\n+    // This adds the redeemscripts necessary to detect P2WPKH and P2SH-P2WPKH\n+    // outputs.\n+    if (pubkey.IsCompressed()) {\n+        CScript script = CScript() << OP_0 << ToByteVector(pubkey.GetID());\n+        // This does not use AddCScript, as it may be overridden.\n+        mapScripts[CScriptID(script)] = std::move(script);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r145261446",
      "id" : 145261446,
      "original_commit_id" : "b7209bdc9007b0f6c22403ab042dd474eb8ef2c5",
      "original_position" : 12,
      "path" : "src/keystore.cpp",
      "position" : 12,
      "pull_request_review_id" : 70018324,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-17T22:38:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145261446",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r145270452"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145270452"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Can't this pass in nullptr and move out of CWallet? Unless I'm missing something, it's not actually related.",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-10-17T22:09:59Z",
      "diff_hunk" : "@@ -4061,3 +4061,14 @@ bool CMerkleTx::AcceptToMemoryPool(const CAmount& nAbsurdFee, CValidationState&\n     return ::AcceptToMemoryPool(mempool, state, tx, nullptr /* pfMissingInputs */,\n                                 nullptr /* plTxnReplaced */, false /* bypass_limits */, nAbsurdFee);\n }\n+\n+bool CWallet::IsSolvable(const CScript& script) const\n+{\n+    // This check is to make sure that the script we created can actually be solved for and signed by us\n+    // if we were to have the private keys. This is just to make sure that the script is valid and that,\n+    // if found in a transaction, we would still accept and relay that transaction. In particular,\n+    // it will reject witness outputs that require signing with an uncompressed public key.\n+    DummySignatureCreator creator(this);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r145270452",
      "id" : 145270452,
      "original_commit_id" : "4bc304c9fa8657bc5a025fecfa7fa40e30ea7a20",
      "original_position" : 11,
      "path" : "src/wallet/wallet.cpp",
      "position" : 47,
      "pull_request_review_id" : 70018324,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-17T22:38:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145270452",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r145271944"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145271944"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If IsSolvable moves out of CWallet, I believe these can too.",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-10-17T22:18:10Z",
      "diff_hunk" : "@@ -4093,3 +4095,82 @@ CKeyID CWallet::GetKeyForDestination(const CTxDestination& dest) const\n     }\n     return CKeyID();\n }\n+\n+static const std::string STYLE_STRING_NONE = \"\";\n+static const std::string STYLE_STRING_LEGACY = \"legacy\";\n+static const std::string STYLE_STRING_P2SH = \"p2sh\";\n+static const std::string STYLE_STRING_SEGWIT = \"segwit\";\n+\n+OutputStyle ParseStyle(const std::string& style)\n+{\n+    if (style == STYLE_STRING_LEGACY) {\n+        return STYLE_LEGACY;\n+    } else if (style == STYLE_STRING_P2SH || style == \"default\") {\n+        return STYLE_P2SH;\n+    } else if (style == STYLE_STRING_SEGWIT) {\n+        return STYLE_SEGWIT;\n+    } else {\n+        return STYLE_NONE;\n+    }\n+}\n+\n+\n+const std::string& FormatStyle(OutputStyle style)\n+{\n+    switch (style) {\n+    case STYLE_LEGACY: return STYLE_STRING_LEGACY;\n+    case STYLE_P2SH: return STYLE_STRING_P2SH;\n+    case STYLE_SEGWIT: return STYLE_STRING_SEGWIT;\n+    default: assert(false);\n+    }\n+}\n+\n+std::vector<CTxDestination> CWallet::GetAllDestinationsForKey(const CPubKey& key)\n+{\n+    CKeyID keyid = key.GetID();\n+    if (key.IsCompressed()) {\n+        CTxDestination segwit = WitnessV0KeyHash(keyid);\n+        CTxDestination p2sh = CScriptID(GetScriptForDestination(segwit));\n+        return std::vector<CTxDestination>{std::move(keyid), std::move(p2sh), std::move(segwit)};\n+    } else {\n+        return std::vector<CTxDestination>{std::move(keyid)};\n+    }\n+}\n+\n+CTxDestination CWallet::GetDestinationForKey(const CPubKey& key, OutputStyle style)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r145271944",
      "id" : 145271944,
      "original_commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "original_position" : 82,
      "path" : "src/wallet/wallet.cpp",
      "position" : 114,
      "pull_request_review_id" : 70018324,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-17T22:38:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145271944",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r145274394"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145274394"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Seems the caller should be responsible for adding this if it's a WitnessV0ScriptHash? Like the others, this doesn't seem like wallet functionality to me.",
      "commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "created_at" : "2017-10-17T22:30:54Z",
      "diff_hunk" : "@@ -4093,3 +4095,82 @@ CKeyID CWallet::GetKeyForDestination(const CTxDestination& dest) const\n     }\n     return CKeyID();\n }\n+\n+static const std::string STYLE_STRING_NONE = \"\";\n+static const std::string STYLE_STRING_LEGACY = \"legacy\";\n+static const std::string STYLE_STRING_P2SH = \"p2sh\";\n+static const std::string STYLE_STRING_SEGWIT = \"segwit\";\n+\n+OutputStyle ParseStyle(const std::string& style)\n+{\n+    if (style == STYLE_STRING_LEGACY) {\n+        return STYLE_LEGACY;\n+    } else if (style == STYLE_STRING_P2SH || style == \"default\") {\n+        return STYLE_P2SH;\n+    } else if (style == STYLE_STRING_SEGWIT) {\n+        return STYLE_SEGWIT;\n+    } else {\n+        return STYLE_NONE;\n+    }\n+}\n+\n+\n+const std::string& FormatStyle(OutputStyle style)\n+{\n+    switch (style) {\n+    case STYLE_LEGACY: return STYLE_STRING_LEGACY;\n+    case STYLE_P2SH: return STYLE_STRING_P2SH;\n+    case STYLE_SEGWIT: return STYLE_STRING_SEGWIT;\n+    default: assert(false);\n+    }\n+}\n+\n+std::vector<CTxDestination> CWallet::GetAllDestinationsForKey(const CPubKey& key)\n+{\n+    CKeyID keyid = key.GetID();\n+    if (key.IsCompressed()) {\n+        CTxDestination segwit = WitnessV0KeyHash(keyid);\n+        CTxDestination p2sh = CScriptID(GetScriptForDestination(segwit));\n+        return std::vector<CTxDestination>{std::move(keyid), std::move(p2sh), std::move(segwit)};\n+    } else {\n+        return std::vector<CTxDestination>{std::move(keyid)};\n+    }\n+}\n+\n+CTxDestination CWallet::GetDestinationForKey(const CPubKey& key, OutputStyle style)\n+{\n+    switch (style) {\n+    case STYLE_LEGACY: return key.GetID();\n+    case STYLE_P2SH:\n+    case STYLE_SEGWIT: {\n+        CTxDestination witdest = WitnessV0KeyHash(key.GetID());\n+        CScript witprog = GetScriptForDestination(witdest);\n+        // Check if the resulting program is solvable (i.e. doesn't use an uncompressed key)\n+        if (!IsSolvable(witprog)) return key.GetID();\n+        if (style == STYLE_P2SH) {\n+            return CScriptID(witprog);\n+        } else {\n+            return witdest;\n+        }\n+    }\n+    default: assert(false);\n+    }\n+}\n+\n+CTxDestination CWallet::GetDestinationForScript(const CScript& script, OutputStyle style)\n+{\n+    switch (style) {\n+    case STYLE_LEGACY:\n+    case STYLE_P2SH:\n+        return CScriptID(script);\n+    case STYLE_SEGWIT: {\n+        CTxDestination witdest = WitnessV0ScriptHash(Hash(script.begin(), script.end()));\n+        CScript witprog = GetScriptForDestination(witdest);\n+        // Check if the resulting program is solvable (i.e. doesn't use an uncompressed key)\n+        if (!IsSolvable(witprog)) return CScriptID(script);\n+        AddCScript(witprog);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11403#discussion_r145274394",
      "id" : 145274394,
      "original_commit_id" : "f542daeb6986b0cc3ea796f177f20739706eddf2",
      "original_position" : 113,
      "path" : "src/wallet/wallet.cpp",
      "position" : 145,
      "pull_request_review_id" : 70018324,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11403",
      "updated_at" : "2017-10-17T22:38:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145274394",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   }
]
