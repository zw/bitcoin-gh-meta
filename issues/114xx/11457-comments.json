[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143107886"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143107886"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "What about adding `GUARDED_BY(Ã¢ÂÂ¦)` (see #10866 and #11226) annotations here?\r\n\r\nLike this:\r\n\r\n```\r\n    CCriticalSection m_cs_banned;\r\n    banmap_t m_banned GUARDED_BY(m_cs_banned);\r\n    bool m_is_dirty GUARDED_BY(m_cs_banned);\r\n```\r\n\r\nNit: The lock was renamed from `cs_setBanned` to `m_cs_banned`. All `CCriticalSection`:s in the code base except `m_cs_callbacks_pending` are named with the `cs_` prefix (as opposed to `m_cs_`). Is `m_cs_` the recommended prefix going forward? More specifically, what prefix is recommended for my work in #10866? :-)\r\n\r\nI think there is a point in having consistent naming for the locks in order to allow for easy grepping of the locks. Personally I use grepping frequently (e.g. `git grep ' cs_[a-zA-Z0-9]\\+;' -- \"*.h\" \"*.cpp\"`) in the scripts that keep tracks of the locks to cover in #10866).",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-06T04:32:01Z",
      "diff_hunk" : "@@ -0,0 +1,65 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2017 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_BANMAN_H\n+#define BITCOIN_BANMAN_H\n+\n+#include \"addrdb.h\"\n+#include \"fs.h\"\n+#include \"sync.h\"\n+\n+// NOTE: When adjusting this, update rpcnet:setban's help (\"24h\")\n+static const unsigned int DEFAULT_MISBEHAVING_BANTIME = 60 * 60 * 24;  // Default 24-hour ban\n+\n+class CClientUIInterface;\n+class CNetAddr;\n+class CSubNet;\n+\n+class BanMan\n+{\n+public:\n+    // Denial-of-service detection/prevention\n+    // The idea is to detect peers that are behaving\n+    // badly and disconnect/ban them, but do it in a\n+    // one-coding-mistake-won't-shatter-the-entire-network\n+    // way.\n+    // IMPORTANT:  There should be nothing I can give a\n+    // node that it will forward on that will make that\n+    // node's peers drop it. If there is, an attacker\n+    // can isolate a node and/or try to split the network.\n+    // Dropping a node for sending stuff that is invalid\n+    // now but might be valid in a later version is also\n+    // dangerous, because it can cause a network split\n+    // between nodes running old code and nodes running\n+    // new code.\n+    ~BanMan();\n+    BanMan(fs::path ban_file, CClientUIInterface* client_interface, int64_t default_ban_time);\n+    void Ban(const CNetAddr& netAddr, const BanReason& reason, int64_t bantimeoffset = 0, bool sinceUnixEpoch = false);\n+    void Ban(const CSubNet& subNet, const BanReason& reason, int64_t bantimeoffset = 0, bool sinceUnixEpoch = false);\n+    void ClearBanned(); // needed for unit testing\n+    bool IsBanned(CNetAddr ip);\n+    bool IsBanned(CSubNet subnet);\n+    bool Unban(const CNetAddr &ip);\n+    bool Unban(const CSubNet &ip);\n+    void GetBanned(banmap_t &banmap);\n+    void DumpBanlist();\n+\n+private:\n+    void SetBanned(const banmap_t &banmap);\n+    bool BannedSetIsDirty();\n+    //!set the \"dirty\" flag for the banlist\n+    void SetBannedSetDirty(bool dirty=true);\n+    //!clean unused entries (if bantime has expired)\n+    void SweepBanned();\n+\n+    banmap_t m_banned;\n+    CCriticalSection m_cs_banned;\n+    bool m_is_dirty;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143107886",
      "id" : 143107886,
      "original_commit_id" : "a006ca20f20b776038e8562000ec8724d35ce607",
      "original_position" : 58,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 67570999,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143107886",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK modulo `GUARDED_BY(Ã¢ÂÂ¦)` addition :-)",
      "created_at" : "2017-10-06T04:33:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#issuecomment-334655782",
      "id" : 334655782,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11457",
      "updated_at" : "2017-10-06T04:33:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334655782",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept Ack!",
      "created_at" : "2017-10-06T14:59:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#issuecomment-334780169",
      "id" : 334780169,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11457",
      "updated_at" : "2017-10-06T14:59:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334780169",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143282072"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143282072"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Shouldnt these technically be in the opposite order? Isnt there otherwise a (supidly rare) race where a new connection can come in and slip behind the ban?",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-06T19:57:37Z",
      "diff_hunk" : "@@ -541,7 +541,13 @@ UniValue setban(const JSONRPCRequest& request)\n         if (request.params[3].isTrue())\n             absolute = true;\n \n-        isSubnet ? g_connman->Ban(subNet, BanReasonManuallyAdded, banTime, absolute) : g_connman->Ban(netAddr, BanReasonManuallyAdded, banTime, absolute);\n+        if (isSubnet) {\n+            g_connman->DisconnectNode(subNet);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143282072",
      "id" : 143282072,
      "original_commit_id" : "ac90cbc5c1faf76b9e9e2cb35c5b77319e10d146",
      "original_position" : 6,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 67777701,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143282072",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143282518"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143282518"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Make explicit?",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-06T19:59:51Z",
      "diff_hunk" : "@@ -94,7 +94,7 @@ class CBanDB\n private:\n     fs::path pathBanlist;\n public:\n-    CBanDB();\n+    CBanDB(fs::path pathBanlist);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143282518",
      "id" : 143282518,
      "original_commit_id" : "a006ca20f20b776038e8562000ec8724d35ce607",
      "original_position" : 5,
      "path" : "src/addrdb.h",
      "position" : null,
      "pull_request_review_id" : 67778242,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143282518",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143282845"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143282845"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Should this be a class-level comment? (Like placed right above `class BanMan`)",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-06T20:01:30Z",
      "diff_hunk" : "@@ -0,0 +1,65 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2017 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_BANMAN_H\n+#define BITCOIN_BANMAN_H\n+\n+#include \"addrdb.h\"\n+#include \"fs.h\"\n+#include \"sync.h\"\n+\n+// NOTE: When adjusting this, update rpcnet:setban's help (\"24h\")\n+static const unsigned int DEFAULT_MISBEHAVING_BANTIME = 60 * 60 * 24;  // Default 24-hour ban\n+\n+class CClientUIInterface;\n+class CNetAddr;\n+class CSubNet;\n+\n+class BanMan\n+{\n+public:\n+    // Denial-of-service detection/prevention",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143282845",
      "id" : 143282845,
      "original_commit_id" : "a006ca20f20b776038e8562000ec8724d35ce607",
      "original_position" : 22,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 67778242,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143282845",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143285317"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143285317"
         }
      },
      "author_association" : "MEMBER",
      "body" : "See https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md:\r\n> Class member variables have a m_ prefix.\r\n\r\nSo yes, m_cs_foo is the recommended syntax going forward for member mutexes, I suppose.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-06T20:15:31Z",
      "diff_hunk" : "@@ -0,0 +1,65 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2017 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_BANMAN_H\n+#define BITCOIN_BANMAN_H\n+\n+#include \"addrdb.h\"\n+#include \"fs.h\"\n+#include \"sync.h\"\n+\n+// NOTE: When adjusting this, update rpcnet:setban's help (\"24h\")\n+static const unsigned int DEFAULT_MISBEHAVING_BANTIME = 60 * 60 * 24;  // Default 24-hour ban\n+\n+class CClientUIInterface;\n+class CNetAddr;\n+class CSubNet;\n+\n+class BanMan\n+{\n+public:\n+    // Denial-of-service detection/prevention\n+    // The idea is to detect peers that are behaving\n+    // badly and disconnect/ban them, but do it in a\n+    // one-coding-mistake-won't-shatter-the-entire-network\n+    // way.\n+    // IMPORTANT:  There should be nothing I can give a\n+    // node that it will forward on that will make that\n+    // node's peers drop it. If there is, an attacker\n+    // can isolate a node and/or try to split the network.\n+    // Dropping a node for sending stuff that is invalid\n+    // now but might be valid in a later version is also\n+    // dangerous, because it can cause a network split\n+    // between nodes running old code and nodes running\n+    // new code.\n+    ~BanMan();\n+    BanMan(fs::path ban_file, CClientUIInterface* client_interface, int64_t default_ban_time);\n+    void Ban(const CNetAddr& netAddr, const BanReason& reason, int64_t bantimeoffset = 0, bool sinceUnixEpoch = false);\n+    void Ban(const CSubNet& subNet, const BanReason& reason, int64_t bantimeoffset = 0, bool sinceUnixEpoch = false);\n+    void ClearBanned(); // needed for unit testing\n+    bool IsBanned(CNetAddr ip);\n+    bool IsBanned(CSubNet subnet);\n+    bool Unban(const CNetAddr &ip);\n+    bool Unban(const CSubNet &ip);\n+    void GetBanned(banmap_t &banmap);\n+    void DumpBanlist();\n+\n+private:\n+    void SetBanned(const banmap_t &banmap);\n+    bool BannedSetIsDirty();\n+    //!set the \"dirty\" flag for the banlist\n+    void SetBannedSetDirty(bool dirty=true);\n+    //!clean unused entries (if bantime has expired)\n+    void SweepBanned();\n+\n+    banmap_t m_banned;\n+    CCriticalSection m_cs_banned;\n+    bool m_is_dirty;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143285317",
      "id" : 143285317,
      "in_reply_to_id" : 143107886,
      "original_commit_id" : "a006ca20f20b776038e8562000ec8724d35ce607",
      "original_position" : 58,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 67781626,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143285317",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143285464"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143285464"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Sure",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-06T20:16:22Z",
      "diff_hunk" : "@@ -0,0 +1,65 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2017 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_BANMAN_H\n+#define BITCOIN_BANMAN_H\n+\n+#include \"addrdb.h\"\n+#include \"fs.h\"\n+#include \"sync.h\"\n+\n+// NOTE: When adjusting this, update rpcnet:setban's help (\"24h\")\n+static const unsigned int DEFAULT_MISBEHAVING_BANTIME = 60 * 60 * 24;  // Default 24-hour ban\n+\n+class CClientUIInterface;\n+class CNetAddr;\n+class CSubNet;\n+\n+class BanMan\n+{\n+public:\n+    // Denial-of-service detection/prevention",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143285464",
      "id" : 143285464,
      "in_reply_to_id" : 143282845,
      "original_commit_id" : "a006ca20f20b776038e8562000ec8724d35ce607",
      "original_position" : 22,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 67781818,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143285464",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143285484"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143285484"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Will do.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-06T20:16:28Z",
      "diff_hunk" : "@@ -94,7 +94,7 @@ class CBanDB\n private:\n     fs::path pathBanlist;\n public:\n-    CBanDB();\n+    CBanDB(fs::path pathBanlist);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143285484",
      "id" : 143285484,
      "in_reply_to_id" : 143282518,
      "original_commit_id" : "a006ca20f20b776038e8562000ec8724d35ce607",
      "original_position" : 5,
      "path" : "src/addrdb.h",
      "position" : null,
      "pull_request_review_id" : 67781848,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143285484",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143287393"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143287393"
         }
      },
      "author_association" : "MEMBER",
      "body" : ">What about adding GUARDED_BY(Ã¢ÂÂ¦) (see #10866 and #11226) annotations here?\r\n\r\nWill do. Additionally, this actually needs another mutex for the db. I've been debating whether it should be fixed as part of this PR, but event-driven db flushes can actually collide with the one on a timer. addrman has the same issue, and that may be the cause of some addrman corruption we've seen lately (#11252, #11409, #11454).",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-06T20:27:02Z",
      "diff_hunk" : "@@ -0,0 +1,65 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2017 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_BANMAN_H\n+#define BITCOIN_BANMAN_H\n+\n+#include \"addrdb.h\"\n+#include \"fs.h\"\n+#include \"sync.h\"\n+\n+// NOTE: When adjusting this, update rpcnet:setban's help (\"24h\")\n+static const unsigned int DEFAULT_MISBEHAVING_BANTIME = 60 * 60 * 24;  // Default 24-hour ban\n+\n+class CClientUIInterface;\n+class CNetAddr;\n+class CSubNet;\n+\n+class BanMan\n+{\n+public:\n+    // Denial-of-service detection/prevention\n+    // The idea is to detect peers that are behaving\n+    // badly and disconnect/ban them, but do it in a\n+    // one-coding-mistake-won't-shatter-the-entire-network\n+    // way.\n+    // IMPORTANT:  There should be nothing I can give a\n+    // node that it will forward on that will make that\n+    // node's peers drop it. If there is, an attacker\n+    // can isolate a node and/or try to split the network.\n+    // Dropping a node for sending stuff that is invalid\n+    // now but might be valid in a later version is also\n+    // dangerous, because it can cause a network split\n+    // between nodes running old code and nodes running\n+    // new code.\n+    ~BanMan();\n+    BanMan(fs::path ban_file, CClientUIInterface* client_interface, int64_t default_ban_time);\n+    void Ban(const CNetAddr& netAddr, const BanReason& reason, int64_t bantimeoffset = 0, bool sinceUnixEpoch = false);\n+    void Ban(const CSubNet& subNet, const BanReason& reason, int64_t bantimeoffset = 0, bool sinceUnixEpoch = false);\n+    void ClearBanned(); // needed for unit testing\n+    bool IsBanned(CNetAddr ip);\n+    bool IsBanned(CSubNet subnet);\n+    bool Unban(const CNetAddr &ip);\n+    bool Unban(const CSubNet &ip);\n+    void GetBanned(banmap_t &banmap);\n+    void DumpBanlist();\n+\n+private:\n+    void SetBanned(const banmap_t &banmap);\n+    bool BannedSetIsDirty();\n+    //!set the \"dirty\" flag for the banlist\n+    void SetBannedSetDirty(bool dirty=true);\n+    //!clean unused entries (if bantime has expired)\n+    void SweepBanned();\n+\n+    banmap_t m_banned;\n+    CCriticalSection m_cs_banned;\n+    bool m_is_dirty;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143287393",
      "id" : 143287393,
      "in_reply_to_id" : 143107886,
      "original_commit_id" : "a006ca20f20b776038e8562000ec8724d35ce607",
      "original_position" : 58,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 67784203,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143287393",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143291015"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143291015"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, good point. Will fix.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-06T20:48:15Z",
      "diff_hunk" : "@@ -541,7 +541,13 @@ UniValue setban(const JSONRPCRequest& request)\n         if (request.params[3].isTrue())\n             absolute = true;\n \n-        isSubnet ? g_connman->Ban(subNet, BanReasonManuallyAdded, banTime, absolute) : g_connman->Ban(netAddr, BanReasonManuallyAdded, banTime, absolute);\n+        if (isSubnet) {\n+            g_connman->DisconnectNode(subNet);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143291015",
      "id" : 143291015,
      "in_reply_to_id" : 143282072,
      "original_commit_id" : "ac90cbc5c1faf76b9e9e2cb35c5b77319e10d146",
      "original_position" : 6,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 67788874,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143291015",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143301192"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143301192"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "```c++\r\n#endif // BITCOIN_BANMAN_H\r\n```",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-06T21:47:03Z",
      "diff_hunk" : "@@ -0,0 +1,65 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2017 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_BANMAN_H\n+#define BITCOIN_BANMAN_H\n+\n+#include \"addrdb.h\"\n+#include \"fs.h\"\n+#include \"sync.h\"\n+\n+// NOTE: When adjusting this, update rpcnet:setban's help (\"24h\")\n+static const unsigned int DEFAULT_MISBEHAVING_BANTIME = 60 * 60 * 24;  // Default 24-hour ban\n+\n+class CClientUIInterface;\n+class CNetAddr;\n+class CSubNet;\n+\n+class BanMan\n+{\n+public:\n+    // Denial-of-service detection/prevention\n+    // The idea is to detect peers that are behaving\n+    // badly and disconnect/ban them, but do it in a\n+    // one-coding-mistake-won't-shatter-the-entire-network\n+    // way.\n+    // IMPORTANT:  There should be nothing I can give a\n+    // node that it will forward on that will make that\n+    // node's peers drop it. If there is, an attacker\n+    // can isolate a node and/or try to split the network.\n+    // Dropping a node for sending stuff that is invalid\n+    // now but might be valid in a later version is also\n+    // dangerous, because it can cause a network split\n+    // between nodes running old code and nodes running\n+    // new code.\n+    ~BanMan();\n+    BanMan(fs::path ban_file, CClientUIInterface* client_interface, int64_t default_ban_time);\n+    void Ban(const CNetAddr& netAddr, const BanReason& reason, int64_t bantimeoffset = 0, bool sinceUnixEpoch = false);\n+    void Ban(const CSubNet& subNet, const BanReason& reason, int64_t bantimeoffset = 0, bool sinceUnixEpoch = false);\n+    void ClearBanned(); // needed for unit testing\n+    bool IsBanned(CNetAddr ip);\n+    bool IsBanned(CSubNet subnet);\n+    bool Unban(const CNetAddr &ip);\n+    bool Unban(const CSubNet &ip);\n+    void GetBanned(banmap_t &banmap);\n+    void DumpBanlist();\n+\n+private:\n+    void SetBanned(const banmap_t &banmap);\n+    bool BannedSetIsDirty();\n+    //!set the \"dirty\" flag for the banlist\n+    void SetBannedSetDirty(bool dirty=true);\n+    //!clean unused entries (if bantime has expired)\n+    void SweepBanned();\n+\n+    banmap_t m_banned;\n+    CCriticalSection m_cs_banned;\n+    bool m_is_dirty;\n+    CClientUIInterface* m_client_interface = nullptr;\n+    CBanDB m_ban_db;\n+    int64_t m_default_ban_time;\n+};\n+\n+extern std::unique_ptr<BanMan> g_banman;\n+#endif",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143301192",
      "id" : 143301192,
      "original_commit_id" : "a006ca20f20b776038e8562000ec8724d35ce607",
      "original_position" : 65,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 67801007,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143301192",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143301475"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143301475"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Use `std::make_unique`.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-06T21:49:13Z",
      "diff_hunk" : "@@ -1267,11 +1273,13 @@ bool AppInitMain(boost::thread_group& threadGroup, CScheduler& scheduler)\n     // is not yet setup and may end up being set up twice if we\n     // need to reindex later.\n \n+    assert(!g_banman);\n+    g_banman = std::unique_ptr<BanMan>(new BanMan(GetDataDir() / \"banlist.dat\", &uiInterface, DEFAULT_MISBEHAVING_BANTIME));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143301475",
      "id" : 143301475,
      "original_commit_id" : "a006ca20f20b776038e8562000ec8724d35ce607",
      "original_position" : 34,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 67801007,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143301475",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143304316"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143304316"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Inverting opens another dumb case: ban -> (unban -> connect) -> disconnect Ã°ÂÂÂ Do you think `DisconnectNode()` should be called inside `Ban()` while the lock is held?",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-06T22:09:14Z",
      "diff_hunk" : "@@ -541,7 +541,13 @@ UniValue setban(const JSONRPCRequest& request)\n         if (request.params[3].isTrue())\n             absolute = true;\n \n-        isSubnet ? g_connman->Ban(subNet, BanReasonManuallyAdded, banTime, absolute) : g_connman->Ban(netAddr, BanReasonManuallyAdded, banTime, absolute);\n+        if (isSubnet) {\n+            g_connman->DisconnectNode(subNet);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143304316",
      "id" : 143304316,
      "in_reply_to_id" : 143282072,
      "original_commit_id" : "ac90cbc5c1faf76b9e9e2cb35c5b77319e10d146",
      "original_position" : 6,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 67801007,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143304316",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143304477"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143304477"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Use `std::make_unique`.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-06T22:10:28Z",
      "diff_hunk" : "@@ -44,6 +44,8 @@ BOOST_FIXTURE_TEST_SUITE(DoS_tests, TestingSetup)\n \n BOOST_AUTO_TEST_CASE(DoS_banning)\n {\n+    auto connman = std::unique_ptr<CConnman>(new CConnman(0x1337, 0x1337));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143304477",
      "id" : 143304477,
      "original_commit_id" : "027b8d391812740ed2c77b995d91ea7a9ba14340",
      "original_position" : 4,
      "path" : "src/test/DoS_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 67801007,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143304477",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143306698"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143306698"
         }
      },
      "author_association" : "MEMBER",
      "body" : "that's c++14 :(",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-06T22:28:36Z",
      "diff_hunk" : "@@ -1267,11 +1273,13 @@ bool AppInitMain(boost::thread_group& threadGroup, CScheduler& scheduler)\n     // is not yet setup and may end up being set up twice if we\n     // need to reindex later.\n \n+    assert(!g_banman);\n+    g_banman = std::unique_ptr<BanMan>(new BanMan(GetDataDir() / \"banlist.dat\", &uiInterface, DEFAULT_MISBEHAVING_BANTIME));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143306698",
      "id" : 143306698,
      "in_reply_to_id" : 143301475,
      "original_commit_id" : "a006ca20f20b776038e8562000ec8724d35ce607",
      "original_position" : 34,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 67807542,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143306698",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143308982"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143308982"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't see how this could reasonably happen. Anyway, it's not a departure from the current behavior.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-06T22:50:58Z",
      "diff_hunk" : "@@ -541,7 +541,13 @@ UniValue setban(const JSONRPCRequest& request)\n         if (request.params[3].isTrue())\n             absolute = true;\n \n-        isSubnet ? g_connman->Ban(subNet, BanReasonManuallyAdded, banTime, absolute) : g_connman->Ban(netAddr, BanReasonManuallyAdded, banTime, absolute);\n+        if (isSubnet) {\n+            g_connman->DisconnectNode(subNet);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143308982",
      "id" : 143308982,
      "in_reply_to_id" : 143282072,
      "original_commit_id" : "ac90cbc5c1faf76b9e9e2cb35c5b77319e10d146",
      "original_position" : 6,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 67810130,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143308982",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Nice!\r\nConcept ACK,.. will review soon.",
      "created_at" : "2017-10-07T04:28:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#issuecomment-334909625",
      "id" : 334909625,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11457",
      "updated_at" : "2017-10-07T04:28:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/334909625",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143327303"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143327303"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Would it make sense to move `ClearBanned()` to a subclass that's only used by the test suite?",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-07T09:50:54Z",
      "diff_hunk" : "@@ -0,0 +1,66 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2017 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_BANMAN_H\n+#define BITCOIN_BANMAN_H\n+\n+#include \"addrdb.h\"\n+#include \"fs.h\"\n+#include \"sync.h\"\n+\n+// NOTE: When adjusting this, update rpcnet:setban's help (\"24h\")\n+static const unsigned int DEFAULT_MISBEHAVING_BANTIME = 60 * 60 * 24;  // Default 24-hour ban\n+\n+class CClientUIInterface;\n+class CNetAddr;\n+class CSubNet;\n+\n+// Denial-of-service detection/prevention\n+// The idea is to detect peers that are behaving\n+// badly and disconnect/ban them, but do it in a\n+// one-coding-mistake-won't-shatter-the-entire-network\n+// way.\n+// IMPORTANT:  There should be nothing I can give a\n+// node that it will forward on that will make that\n+// node's peers drop it. If there is, an attacker\n+// can isolate a node and/or try to split the network.\n+// Dropping a node for sending stuff that is invalid\n+// now but might be valid in a later version is also\n+// dangerous, because it can cause a network split\n+// between nodes running old code and nodes running\n+// new code.\n+\n+class BanMan\n+{\n+public:\n+    ~BanMan();\n+    BanMan(fs::path ban_file, CClientUIInterface* client_interface, int64_t default_ban_time);\n+    void Ban(const CNetAddr& netAddr, const BanReason& reason, int64_t bantimeoffset = 0, bool sinceUnixEpoch = false);\n+    void Ban(const CSubNet& subNet, const BanReason& reason, int64_t bantimeoffset = 0, bool sinceUnixEpoch = false);\n+    void ClearBanned(); // needed for unit testing",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143327303",
      "id" : 143327303,
      "original_commit_id" : "7a574787c889a26d03af70a493210da5087935c7",
      "original_position" : 41,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 67829712,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143327303",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143557085"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143557085"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "A substitute for C++14 `std::make_unique` in the form of `MakeUnique` is added to `util.h` as part of #11043 (see https://github.com/bitcoin/bitcoin/pull/11043/commits/27a54eacc07325e9a10cbea71ab03d87a96679b7) which will hopefully be merged soon :-)",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-09T19:29:26Z",
      "diff_hunk" : "@@ -1267,11 +1273,13 @@ bool AppInitMain(boost::thread_group& threadGroup, CScheduler& scheduler)\n     // is not yet setup and may end up being set up twice if we\n     // need to reindex later.\n \n+    assert(!g_banman);\n+    g_banman = std::unique_ptr<BanMan>(new BanMan(GetDataDir() / \"banlist.dat\", &uiInterface, DEFAULT_MISBEHAVING_BANTIME));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143557085",
      "id" : 143557085,
      "in_reply_to_id" : 143301475,
      "original_commit_id" : "a006ca20f20b776038e8562000ec8724d35ce607",
      "original_position" : 34,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 68085079,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143557085",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143563808"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143563808"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is a misleading comment that needs to be dropped. This is used by the ```clearbanned``` rpc as well.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-09T20:01:13Z",
      "diff_hunk" : "@@ -0,0 +1,66 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2017 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_BANMAN_H\n+#define BITCOIN_BANMAN_H\n+\n+#include \"addrdb.h\"\n+#include \"fs.h\"\n+#include \"sync.h\"\n+\n+// NOTE: When adjusting this, update rpcnet:setban's help (\"24h\")\n+static const unsigned int DEFAULT_MISBEHAVING_BANTIME = 60 * 60 * 24;  // Default 24-hour ban\n+\n+class CClientUIInterface;\n+class CNetAddr;\n+class CSubNet;\n+\n+// Denial-of-service detection/prevention\n+// The idea is to detect peers that are behaving\n+// badly and disconnect/ban them, but do it in a\n+// one-coding-mistake-won't-shatter-the-entire-network\n+// way.\n+// IMPORTANT:  There should be nothing I can give a\n+// node that it will forward on that will make that\n+// node's peers drop it. If there is, an attacker\n+// can isolate a node and/or try to split the network.\n+// Dropping a node for sending stuff that is invalid\n+// now but might be valid in a later version is also\n+// dangerous, because it can cause a network split\n+// between nodes running old code and nodes running\n+// new code.\n+\n+class BanMan\n+{\n+public:\n+    ~BanMan();\n+    BanMan(fs::path ban_file, CClientUIInterface* client_interface, int64_t default_ban_time);\n+    void Ban(const CNetAddr& netAddr, const BanReason& reason, int64_t bantimeoffset = 0, bool sinceUnixEpoch = false);\n+    void Ban(const CSubNet& subNet, const BanReason& reason, int64_t bantimeoffset = 0, bool sinceUnixEpoch = false);\n+    void ClearBanned(); // needed for unit testing",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r143563808",
      "id" : 143563808,
      "in_reply_to_id" : 143327303,
      "original_commit_id" : "7a574787c889a26d03af70a493210da5087935c7",
      "original_position" : 41,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 68092372,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143563808",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased and addressed most of the feedback here.",
      "created_at" : "2017-10-18T04:40:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#issuecomment-337458551",
      "id" : 337458551,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11457",
      "updated_at" : "2017-10-18T04:40:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/337458551",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145399568"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145399568"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think we need to invoke the new DisconnectNode() method that takes a CNetAddr, rather than just the nodeid, in order to keep the behavior the same (ie disconnect all peers on the same subnet)?",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-18T12:33:50Z",
      "diff_hunk" : "@@ -1155,16 +1155,17 @@ void RPCConsole::banSelectedNode(int bantime)\n         // Get currently selected peer address\n         NodeId id = nodes.at(i).data().toLongLong();\n \n-\t// Get currently selected peer address\n-\tint detailNodeRow = clientModel->getPeerTableModel()->getRowByNodeId(id);\n-\tif(detailNodeRow < 0)\n-\t    return;\n-\n-\t// Find possible nodes, ban it and clear the selected node\n-\tconst CNodeCombinedStats *stats = clientModel->getPeerTableModel()->getNodeStats(detailNodeRow);\n-\tif(stats) {\n-\t    g_connman->Ban(stats->nodeStats.addr, BanReasonManuallyAdded, bantime);\n-\t}\n+        // Get currently selected peer address\n+        int detailNodeRow = clientModel->getPeerTableModel()->getRowByNodeId(id);\n+        if(detailNodeRow < 0)\n+            return;\n+\n+        // Find possible nodes, ban it and clear the selected node\n+        const CNodeCombinedStats *stats = clientModel->getPeerTableModel()->getNodeStats(detailNodeRow);\n+        if(stats) {\n+            g_connman->Ban(stats->nodeStats.addr, BanReasonManuallyAdded, bantime);\n+            g_connman->DisconnectNode(id);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145399568",
      "id" : 145399568,
      "original_commit_id" : "5226fd1c0ce0e96a8b7a136d39752b2d78544de3",
      "original_position" : 23,
      "path" : "src/qt/rpcconsole.cpp",
      "position" : null,
      "pull_request_review_id" : 70192383,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145399568",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145402177"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145402177"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Is this a place where a `constexpr` is preferred over just `const`?",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-18T12:45:12Z",
      "diff_hunk" : "@@ -38,8 +38,11 @@\n \n #include <math.h>\n \n-// Dump addresses to peers.dat and banlist.dat every 15 minutes (900s)\n-#define DUMP_ADDRESSES_INTERVAL 900\n+// Dump addresses to peers.dat every 15 minutes (900s)\n+static const int DUMP_PEERS_INTERVAL = 60 * 15;\n+\n+// Dump addresses to banlist.dat every 15 minutes (900s)\n+static const int DUMP_BANS_INTERVAL = 60 * 15;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145402177",
      "id" : 145402177,
      "original_commit_id" : "fc8eeeca4b721895b5b973c8dfb5d9a898c1b55d",
      "original_position" : 10,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 70192383,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145402177",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145402746"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145402746"
         }
      },
      "author_association" : "MEMBER",
      "body" : "(same question as before, about whether `constexpr` should be preferred?)",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-18T12:47:32Z",
      "diff_hunk" : "@@ -72,8 +72,12 @@ static const bool DEFAULT_PROXYRANDOMIZE = true;\n static const bool DEFAULT_REST_ENABLE = false;\n static const bool DEFAULT_STOPAFTERBLOCKIMPORT = false;\n \n+// Dump addresses to banlist.dat every 15 minutes (900s)\n+static const int DUMP_BANS_INTERVAL = 60 * 15;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145402746",
      "id" : 145402746,
      "original_commit_id" : "b435a7995da5ea7d914ea1d26ddd89babdd87c25",
      "original_position" : 5,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 70192383,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145402746",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145403823"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145403823"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Mostly an aside, since we're already doing it this way with connman, but I'm curious why we're not using shared pointers here instead of this unique_ptr.get() stuff?",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-18T12:52:28Z",
      "diff_hunk" : "@@ -1266,11 +1271,13 @@ bool AppInitMain(boost::thread_group& threadGroup, CScheduler& scheduler)\n     // is not yet setup and may end up being set up twice if we\n     // need to reindex later.\n \n+    assert(!g_banman);\n+    g_banman = std::unique_ptr<BanMan>(new BanMan(&uiInterface));\n     assert(!g_connman);\n     g_connman = std::unique_ptr<CConnman>(new CConnman(GetRand(std::numeric_limits<uint64_t>::max()), GetRand(std::numeric_limits<uint64_t>::max())));\n     CConnman& connman = *g_connman;\n \n-    peerLogic.reset(new PeerLogicValidation(&connman));\n+    peerLogic.reset(new PeerLogicValidation(g_connman.get(), g_banman.get()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145403823",
      "id" : 145403823,
      "original_commit_id" : "b435a7995da5ea7d914ea1d26ddd89babdd87c25",
      "original_position" : 32,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 70192383,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145403823",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145404743"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145404743"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Is there a circumstance where g_banman would not exist here?  If so a comment would be nice; if not then I'm wondering if we should `assert` instead, or otherwise enforce a shutdown.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-18T12:56:05Z",
      "diff_hunk" : "@@ -1722,5 +1730,11 @@ bool AppInitMain(boost::thread_group& threadGroup, CScheduler& scheduler)\n     StartWallets(scheduler);\n #endif\n \n+    if (g_banman) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145404743",
      "id" : 145404743,
      "original_commit_id" : "b435a7995da5ea7d914ea1d26ddd89babdd87c25",
      "original_position" : 48,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 70192383,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145404743",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145406514"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145406514"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why do we need this, if the BanMan already dumps its banlist in its destructor?",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-18T13:03:12Z",
      "diff_hunk" : "@@ -2405,7 +2413,9 @@ void CConnman::Stop()\n     if (fAddressesInitialized)\n     {\n         DumpAddresses();\n-        DumpBanlist();\n+        if (m_banman) {\n+            m_banman->DumpBanlist();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145406514",
      "id" : 145406514,
      "original_commit_id" : "b435a7995da5ea7d914ea1d26ddd89babdd87c25",
      "original_position" : 217,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 70192383,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145406514",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145456651"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145456651"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: Does this rpc error change require a release note mention?  If so, we should track this in an issue.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-18T15:44:24Z",
      "diff_hunk" : "@@ -509,8 +509,8 @@ UniValue setban(const JSONRPCRequest& request)\n                             + HelpExampleCli(\"setban\", \"\\\"192.168.0.0/24\\\" \\\"add\\\"\")\n                             + HelpExampleRpc(\"setban\", \"\\\"192.168.0.6\\\", \\\"add\\\", 86400\")\n                             );\n-    if(!g_connman)\n-        throw JSONRPCError(RPC_CLIENT_P2P_DISABLED, \"Error: Peer-to-peer functionality missing or disabled\");\n+    if(!g_banman)\n+        throw JSONRPCError(RPC_DATABASE_ERROR, \"Error: Ban database not loaded\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145456651",
      "id" : 145456651,
      "original_commit_id" : "b435a7995da5ea7d914ea1d26ddd89babdd87c25",
      "original_position" : 7,
      "path" : "src/rpc/net.cpp",
      "position" : 15,
      "pull_request_review_id" : 70192383,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145456651",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145456944"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145456944"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Same comment as before about using nodeid rather than address",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-18T15:45:19Z",
      "diff_hunk" : "@@ -1163,8 +1163,12 @@ void RPCConsole::banSelectedNode(int bantime)\n         // Find possible nodes, ban it and clear the selected node\n         const CNodeCombinedStats *stats = clientModel->getPeerTableModel()->getNodeStats(detailNodeRow);\n         if(stats) {\n-            g_connman->Ban(stats->nodeStats.addr, BanReasonManuallyAdded, bantime);\n-            g_connman->DisconnectNode(id);\n+            if (g_banman) {\n+                g_banman->Ban(stats->nodeStats.addr, BanReasonManuallyAdded, bantime);\n+            }\n+            if (g_connman) {\n+                g_connman->DisconnectNode(id);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145456944",
      "id" : 145456944,
      "original_commit_id" : "b435a7995da5ea7d914ea1d26ddd89babdd87c25",
      "original_position" : 19,
      "path" : "src/qt/rpcconsole.cpp",
      "position" : null,
      "pull_request_review_id" : 70192383,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145456944",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145458299"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145458299"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: Consider adding a release-note to do for the rpc error change in this rpc call as well.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-18T15:49:39Z",
      "diff_hunk" : "@@ -570,11 +574,11 @@ UniValue listbanned(const JSONRPCRequest& request)\n                             + HelpExampleRpc(\"listbanned\", \"\")\n                             );\n \n-    if(!g_connman)\n-        throw JSONRPCError(RPC_CLIENT_P2P_DISABLED, \"Error: Peer-to-peer functionality missing or disabled\");\n+    if(!g_banman)\n+        throw JSONRPCError(RPC_DATABASE_ERROR, \"Error: Ban database not loaded\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145458299",
      "id" : 145458299,
      "original_commit_id" : "b435a7995da5ea7d914ea1d26ddd89babdd87c25",
      "original_position" : 53,
      "path" : "src/rpc/net.cpp",
      "position" : 59,
      "pull_request_review_id" : 70192383,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145458299",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145461994"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145461994"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think we need to pass `gArgs.GetArg(\"-bantime\", DEFAULT_MISBEHAVING_BANTIME)` here?  Or else I'm missing how the command line argument gets used after this commit.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-18T16:01:18Z",
      "diff_hunk" : "@@ -1272,7 +1272,7 @@ bool AppInitMain(boost::thread_group& threadGroup, CScheduler& scheduler)\n     // need to reindex later.\n \n     assert(!g_banman);\n-    g_banman = std::unique_ptr<BanMan>(new BanMan(GetDataDir() / \"banlist.dat\", &uiInterface));\n+    g_banman = std::unique_ptr<BanMan>(new BanMan(GetDataDir() / \"banlist.dat\", &uiInterface, DEFAULT_MISBEHAVING_BANTIME));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145461994",
      "id" : 145461994,
      "original_commit_id" : "8009f1d587b27728c00eaffe47bb324a25dfd39a",
      "original_position" : 5,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 70192383,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145461994",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145471394"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145471394"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Because these aren't intended to be actual globals. We just don't (yet) have the infrastructure to pass them into RPC and qt. Once banman/addrman are split out, I'll be PRing a set of changes that make RPC instantiated. With that done, the ui (rpc/qt/whatever else) will have these interfaces passed in, and they can assume that the pointers are good for their lifetime.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-18T16:35:28Z",
      "diff_hunk" : "@@ -1266,11 +1271,13 @@ bool AppInitMain(boost::thread_group& threadGroup, CScheduler& scheduler)\n     // is not yet setup and may end up being set up twice if we\n     // need to reindex later.\n \n+    assert(!g_banman);\n+    g_banman = std::unique_ptr<BanMan>(new BanMan(&uiInterface));\n     assert(!g_connman);\n     g_connman = std::unique_ptr<CConnman>(new CConnman(GetRand(std::numeric_limits<uint64_t>::max()), GetRand(std::numeric_limits<uint64_t>::max())));\n     CConnman& connman = *g_connman;\n \n-    peerLogic.reset(new PeerLogicValidation(&connman));\n+    peerLogic.reset(new PeerLogicValidation(g_connman.get(), g_banman.get()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145471394",
      "id" : 145471394,
      "in_reply_to_id" : 145403823,
      "original_commit_id" : "b435a7995da5ea7d914ea1d26ddd89babdd87c25",
      "original_position" : 32,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 70277014,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145471394",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145471972"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145471972"
         }
      },
      "author_association" : "MEMBER",
      "body" : "My original thinking was that if we add a -nop2p option (which I'm hoping we can do soon), the bandb would be disabled as well. But thinking about it now, one doesn't exclude the other. So yes, an assert makes more sense here. Will do.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-18T16:37:19Z",
      "diff_hunk" : "@@ -1722,5 +1730,11 @@ bool AppInitMain(boost::thread_group& threadGroup, CScheduler& scheduler)\n     StartWallets(scheduler);\n #endif\n \n+    if (g_banman) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145471972",
      "id" : 145471972,
      "in_reply_to_id" : 145404743,
      "original_commit_id" : "b435a7995da5ea7d914ea1d26ddd89babdd87c25",
      "original_position" : 48,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 70277729,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145471972",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145472121"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145472121"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yep, will change.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-18T16:37:54Z",
      "diff_hunk" : "@@ -38,8 +38,11 @@\n \n #include <math.h>\n \n-// Dump addresses to peers.dat and banlist.dat every 15 minutes (900s)\n-#define DUMP_ADDRESSES_INTERVAL 900\n+// Dump addresses to peers.dat every 15 minutes (900s)\n+static const int DUMP_PEERS_INTERVAL = 60 * 15;\n+\n+// Dump addresses to banlist.dat every 15 minutes (900s)\n+static const int DUMP_BANS_INTERVAL = 60 * 15;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145472121",
      "id" : 145472121,
      "in_reply_to_id" : 145402177,
      "original_commit_id" : "fc8eeeca4b721895b5b973c8dfb5d9a898c1b55d",
      "original_position" : 10,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 70277899,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145472121",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145472278"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145472278"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good point, will remove.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-18T16:38:40Z",
      "diff_hunk" : "@@ -2405,7 +2413,9 @@ void CConnman::Stop()\n     if (fAddressesInitialized)\n     {\n         DumpAddresses();\n-        DumpBanlist();\n+        if (m_banman) {\n+            m_banman->DumpBanlist();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145472278",
      "id" : 145472278,
      "in_reply_to_id" : 145406514,
      "original_commit_id" : "b435a7995da5ea7d914ea1d26ddd89babdd87c25",
      "original_position" : 217,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 70278107,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145472278",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145472776"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145472776"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Very much so, thanks for catching that.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-18T16:40:49Z",
      "diff_hunk" : "@@ -1272,7 +1272,7 @@ bool AppInitMain(boost::thread_group& threadGroup, CScheduler& scheduler)\n     // need to reindex later.\n \n     assert(!g_banman);\n-    g_banman = std::unique_ptr<BanMan>(new BanMan(GetDataDir() / \"banlist.dat\", &uiInterface));\n+    g_banman = std::unique_ptr<BanMan>(new BanMan(GetDataDir() / \"banlist.dat\", &uiInterface, DEFAULT_MISBEHAVING_BANTIME));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145472776",
      "id" : 145472776,
      "in_reply_to_id" : 145461994,
      "original_commit_id" : "8009f1d587b27728c00eaffe47bb324a25dfd39a",
      "original_position" : 5,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 70278742,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145472776",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145474963"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145474963"
         }
      },
      "author_association" : "MEMBER",
      "body" : "When accepting an ip as a string from the user I agree. But in this case the request is for a specific node, so I would argue that the id is more in line with what the user would expect.\r\n\r\nI don't care hugely either way though.\r\n\r\nAs an aside, what we really need here is kick/ban/kick+ban options. But I don't think it's worth adding the complexity?",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-18T16:49:27Z",
      "diff_hunk" : "@@ -1155,16 +1155,17 @@ void RPCConsole::banSelectedNode(int bantime)\n         // Get currently selected peer address\n         NodeId id = nodes.at(i).data().toLongLong();\n \n-\t// Get currently selected peer address\n-\tint detailNodeRow = clientModel->getPeerTableModel()->getRowByNodeId(id);\n-\tif(detailNodeRow < 0)\n-\t    return;\n-\n-\t// Find possible nodes, ban it and clear the selected node\n-\tconst CNodeCombinedStats *stats = clientModel->getPeerTableModel()->getNodeStats(detailNodeRow);\n-\tif(stats) {\n-\t    g_connman->Ban(stats->nodeStats.addr, BanReasonManuallyAdded, bantime);\n-\t}\n+        // Get currently selected peer address\n+        int detailNodeRow = clientModel->getPeerTableModel()->getRowByNodeId(id);\n+        if(detailNodeRow < 0)\n+            return;\n+\n+        // Find possible nodes, ban it and clear the selected node\n+        const CNodeCombinedStats *stats = clientModel->getPeerTableModel()->getNodeStats(detailNodeRow);\n+        if(stats) {\n+            g_connman->Ban(stats->nodeStats.addr, BanReasonManuallyAdded, bantime);\n+            g_connman->DisconnectNode(id);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145474963",
      "id" : 145474963,
      "in_reply_to_id" : 145399568,
      "original_commit_id" : "5226fd1c0ce0e96a8b7a136d39752b2d78544de3",
      "original_position" : 23,
      "path" : "src/qt/rpcconsole.cpp",
      "position" : null,
      "pull_request_review_id" : 70281229,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145474963",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145476777"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145476777"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Same response :)\r\n\r\nNote that these comments are a bit stale. We used to track down the entry by looking through all node addresses, but now we use the id directly. I'll update those comments independently.\r\n\r\nAlso, see the behavior of disconnectSelectedNode above. I think it makes sense to be consistent with that?\r\n\r\nFor the sake of not over-complicating this, It may make sense to just keep the old behavior for this PR and switch to id in a follow-up.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-18T16:56:22Z",
      "diff_hunk" : "@@ -1163,8 +1163,12 @@ void RPCConsole::banSelectedNode(int bantime)\n         // Find possible nodes, ban it and clear the selected node\n         const CNodeCombinedStats *stats = clientModel->getPeerTableModel()->getNodeStats(detailNodeRow);\n         if(stats) {\n-            g_connman->Ban(stats->nodeStats.addr, BanReasonManuallyAdded, bantime);\n-            g_connman->DisconnectNode(id);\n+            if (g_banman) {\n+                g_banman->Ban(stats->nodeStats.addr, BanReasonManuallyAdded, bantime);\n+            }\n+            if (g_connman) {\n+                g_connman->DisconnectNode(id);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145476777",
      "id" : 145476777,
      "in_reply_to_id" : 145456944,
      "original_commit_id" : "b435a7995da5ea7d914ea1d26ddd89babdd87c25",
      "original_position" : 19,
      "path" : "src/qt/rpcconsole.cpp",
      "position" : null,
      "pull_request_review_id" : 70283288,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145476777",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145477562"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145477562"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I didn't bother with docs because as far as I know, it's been impossible to receive this error in practice because g_connman always exists. It won't be until we have a -nop2p that it's relevant.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-18T16:59:13Z",
      "diff_hunk" : "@@ -509,8 +509,8 @@ UniValue setban(const JSONRPCRequest& request)\n                             + HelpExampleCli(\"setban\", \"\\\"192.168.0.0/24\\\" \\\"add\\\"\")\n                             + HelpExampleRpc(\"setban\", \"\\\"192.168.0.6\\\", \\\"add\\\", 86400\")\n                             );\n-    if(!g_connman)\n-        throw JSONRPCError(RPC_CLIENT_P2P_DISABLED, \"Error: Peer-to-peer functionality missing or disabled\");\n+    if(!g_banman)\n+        throw JSONRPCError(RPC_DATABASE_ERROR, \"Error: Ban database not loaded\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145477562",
      "id" : 145477562,
      "in_reply_to_id" : 145456651,
      "original_commit_id" : "b435a7995da5ea7d914ea1d26ddd89babdd87c25",
      "original_position" : 7,
      "path" : "src/rpc/net.cpp",
      "position" : 15,
      "pull_request_review_id" : 70284221,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145477562",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145478034"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145478034"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Same as above. These could be asserts for now, but imo we're less likely to forget about these if errors are hooked up in advance.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-10-18T17:00:57Z",
      "diff_hunk" : "@@ -570,11 +574,11 @@ UniValue listbanned(const JSONRPCRequest& request)\n                             + HelpExampleRpc(\"listbanned\", \"\")\n                             );\n \n-    if(!g_connman)\n-        throw JSONRPCError(RPC_CLIENT_P2P_DISABLED, \"Error: Peer-to-peer functionality missing or disabled\");\n+    if(!g_banman)\n+        throw JSONRPCError(RPC_DATABASE_ERROR, \"Error: Ban database not loaded\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r145478034",
      "id" : 145478034,
      "in_reply_to_id" : 145458299,
      "original_commit_id" : "b435a7995da5ea7d914ea1d26ddd89babdd87c25",
      "original_position" : 53,
      "path" : "src/rpc/net.cpp",
      "position" : 59,
      "pull_request_review_id" : 70284753,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145478034",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Addressed @sdaftuar's feedback. I went ahead and changed the Disconnect() in qt/rpcconsole back to using IP rather than nodeid to avoid adding unnecessary behavioral changes in a PR that should otherwise be a code refactor.",
      "created_at" : "2017-10-19T18:02:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#issuecomment-337988985",
      "id" : 337988985,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11457",
      "updated_at" : "2017-10-19T18:02:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/337988985",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK, needs rebase.",
      "created_at" : "2017-11-13T18:59:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#issuecomment-344021553",
      "id" : 344021553,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11457",
      "updated_at" : "2017-11-13T18:59:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/344021553",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "rebased.",
      "created_at" : "2017-11-14T21:31:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#issuecomment-344405562",
      "id" : 344405562,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11457",
      "updated_at" : "2017-11-14T21:31:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/344405562",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r150986287"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/150986287"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit `net: Break disconnecting out of Ban()`,\r\n\r\nWhy `bool` if the return value is not used?",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-11-14T22:42:05Z",
      "diff_hunk" : "@@ -2559,6 +2553,25 @@ bool CConnman::DisconnectNode(const std::string& strNode)\n     }\n     return false;\n }\n+\n+bool CConnman::DisconnectNode(const CSubNet& subnet)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r150986287",
      "id" : 150986287,
      "original_commit_id" : "5f25e6ac15f4002a3227c2c207363e7c386d7e76",
      "original_position" : 20,
      "path" : "src/net.cpp",
      "position" : 291,
      "pull_request_review_id" : 76621832,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/150986287",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r150986423"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/150986423"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit `net: Break disconnecting out of Ban()`,\r\n\r\nNit, add space.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-11-14T22:42:42Z",
      "diff_hunk" : "@@ -1143,16 +1143,17 @@ void RPCConsole::banSelectedNode(int bantime)\n         // Get currently selected peer address\n         NodeId id = nodes.at(i).data().toLongLong();\n \n-\t// Get currently selected peer address\n-\tint detailNodeRow = clientModel->getPeerTableModel()->getRowByNodeId(id);\n-\tif(detailNodeRow < 0)\n-\t    return;\n-\n-\t// Find possible nodes, ban it and clear the selected node\n-\tconst CNodeCombinedStats *stats = clientModel->getPeerTableModel()->getNodeStats(detailNodeRow);\n-\tif(stats) {\n-\t    g_connman->Ban(stats->nodeStats.addr, BanReasonManuallyAdded, bantime);\n-\t}\n+        // Get currently selected peer address\n+        int detailNodeRow = clientModel->getPeerTableModel()->getRowByNodeId(id);\n+        if(detailNodeRow < 0)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r150986423",
      "id" : 150986423,
      "original_commit_id" : "5f25e6ac15f4002a3227c2c207363e7c386d7e76",
      "original_position" : 16,
      "path" : "src/qt/rpcconsole.cpp",
      "position" : null,
      "pull_request_review_id" : 76621832,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/150986423",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r150997377"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/150997377"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Just to be consistent with the others.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-11-14T23:41:31Z",
      "diff_hunk" : "@@ -2559,6 +2553,25 @@ bool CConnman::DisconnectNode(const std::string& strNode)\n     }\n     return false;\n }\n+\n+bool CConnman::DisconnectNode(const CSubNet& subnet)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r150997377",
      "id" : 150997377,
      "in_reply_to_id" : 150986287,
      "original_commit_id" : "5f25e6ac15f4002a3227c2c207363e7c386d7e76",
      "original_position" : 20,
      "path" : "src/net.cpp",
      "position" : 291,
      "pull_request_review_id" : 76634738,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/150997377",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r150998819"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/150998819"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-11-14T23:50:16Z",
      "diff_hunk" : "@@ -1143,16 +1143,17 @@ void RPCConsole::banSelectedNode(int bantime)\n         // Get currently selected peer address\n         NodeId id = nodes.at(i).data().toLongLong();\n \n-\t// Get currently selected peer address\n-\tint detailNodeRow = clientModel->getPeerTableModel()->getRowByNodeId(id);\n-\tif(detailNodeRow < 0)\n-\t    return;\n-\n-\t// Find possible nodes, ban it and clear the selected node\n-\tconst CNodeCombinedStats *stats = clientModel->getPeerTableModel()->getNodeStats(detailNodeRow);\n-\tif(stats) {\n-\t    g_connman->Ban(stats->nodeStats.addr, BanReasonManuallyAdded, bantime);\n-\t}\n+        // Get currently selected peer address\n+        int detailNodeRow = clientModel->getPeerTableModel()->getRowByNodeId(id);\n+        if(detailNodeRow < 0)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r150998819",
      "id" : 150998819,
      "in_reply_to_id" : 150986423,
      "original_commit_id" : "5f25e6ac15f4002a3227c2c207363e7c386d7e76",
      "original_position" : 16,
      "path" : "src/qt/rpcconsole.cpp",
      "position" : null,
      "pull_request_review_id" : 76636385,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/150998819",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> In commit net: Break disconnecting out of Ban(),\r\n> \r\n> Missing call DisconnectNode() after:\r\n\r\nThis is handled by setting fDisconnect directly above.",
      "created_at" : "2017-11-14T23:51:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#issuecomment-344439326",
      "id" : 344439326,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11457",
      "updated_at" : "2017-11-14T23:51:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/344439326",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Heh, rebase needed for the include change.",
      "created_at" : "2017-11-16T16:59:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#issuecomment-344988604",
      "id" : 344988604,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11457",
      "updated_at" : "2017-11-16T16:59:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/344988604",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "I've added this to high-priority for review, would be nice to move this forward and this blocks further work in this direction.",
      "created_at" : "2017-11-28T08:19:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#issuecomment-347447124",
      "id" : 347447124,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11457",
      "updated_at" : "2017-11-28T08:19:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/347447124",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@laanwj Thanks!",
      "created_at" : "2017-11-28T21:35:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#issuecomment-347671320",
      "id" : 347671320,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11457",
      "updated_at" : "2017-11-28T21:35:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/347671320",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Needs rebase.",
      "created_at" : "2017-12-13T17:06:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#issuecomment-351456420",
      "id" : 351456420,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11457",
      "updated_at" : "2017-12-13T17:06:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/351456420",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157000260"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157000260"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This is a behavior change when banning a remote IP in net_processing - we no longer disconnect any other connections from the same peer, only block new ones and disconnect the specific connection that made us ban them. Don't know that its a big deal, but might be nice to disconnect-by-ip there, too.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-12-14T16:52:14Z",
      "diff_hunk" : "@@ -556,13 +556,7 @@ void CConnman::Ban(const CSubNet& subNet, const BanReason &banReason, int64_t ba\n     }\n     if(clientInterface)\n         clientInterface->BannedListChanged();\n-    {\n-        LOCK(cs_vNodes);\n-        for (CNode* pnode : vNodes) {\n-            if (subNet.Match((CNetAddr)pnode->addr))\n-                pnode->fDisconnect = true;\n-        }\n-    }\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157000260",
      "id" : 157000260,
      "original_commit_id" : "04e692c5292988688d492937ad37b8ac80f2fa07",
      "original_position" : 11,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 83571030,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157000260",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157001644"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157001644"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Hmm, it seems like our trend is to move things like this into the constructor/init logic for the subsystem/module itself instead of shoving everything in init. I rather liked that trend....",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-12-14T16:57:12Z",
      "diff_hunk" : "@@ -1726,5 +1734,9 @@ bool AppInitMain(boost::thread_group& threadGroup, CScheduler& scheduler)\n     StartWallets(scheduler);\n #endif\n \n+    scheduler.scheduleEvery([]{",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157001644",
      "id" : 157001644,
      "original_commit_id" : "04d0b51af1e42a32b35299e4cd69d78e6a0fffd4",
      "original_position" : 48,
      "path" : "src/init.cpp",
      "position" : 56,
      "pull_request_review_id" : 83571030,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157001644",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157002284"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157002284"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This seems like a dead store?",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-12-14T16:59:21Z",
      "diff_hunk" : "@@ -2283,24 +2279,8 @@ bool CConnman::Start(CScheduler& scheduler, const Options& connOptions)\n             DumpAddresses();\n         }\n     }\n-    if (clientInterface)\n-        clientInterface->InitMessage(_(\"Loading banlist...\"));\n-    // Load addresses from banlist.dat\n-    nStart = GetTimeMillis();\n-    CBanDB bandb;\n-    banmap_t banmap;\n-    if (bandb.Read(banmap)) {\n-        SetBanned(banmap); // thread save setter\n-        SetBannedSetDirty(false); // no need to write down, just read data\n-        SweepBanned(); // sweep out unused entries\n \n-        LogPrint(BCLog::NET, \"Loaded %d banned node ips/subnets from banlist.dat  %dms\\n\",\n-            banmap.size(), GetTimeMillis() - nStart);\n-    } else {\n-        LogPrintf(\"Invalid or missing banlist.dat; recreating\\n\");\n-        SetBannedSetDirty(true); // force write\n-        DumpBanlist();\n-    }\n+    nStart = GetTimeMillis();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157002284",
      "id" : 157002284,
      "original_commit_id" : "04d0b51af1e42a32b35299e4cd69d78e6a0fffd4",
      "original_position" : 166,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 83571030,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157002284",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157003948"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157003948"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Is it really worth checking? We already check for g_banman further up, are we really anticipating having a g_banman but not a g_connman?",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-12-14T17:04:57Z",
      "diff_hunk" : "@@ -544,16 +544,20 @@ UniValue setban(const JSONRPCRequest& request)\n             absolute = true;\n \n         if (isSubnet) {\n-            g_connman->Ban(subNet, BanReasonManuallyAdded, banTime, absolute);\n-            g_connman->DisconnectNode(subNet);\n+            g_banman->Ban(subNet, BanReasonManuallyAdded, banTime, absolute);\n+            if (g_connman) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157003948",
      "id" : 157003948,
      "original_commit_id" : "04d0b51af1e42a32b35299e4cd69d78e6a0fffd4",
      "original_position" : 27,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 83571030,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157003948",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157004696"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157004696"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I cant say I really understand the desire to avoid the argparsing dep, when you include <util.h> either way. Seems like useless indirection.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-12-14T17:07:42Z",
      "diff_hunk" : "@@ -132,7 +132,7 @@ class BanMan\n     // between nodes running old code and nodes running\n     // new code.\n     ~BanMan();\n-    BanMan(fs::path ban_file, CClientUIInterface* client_interface);\n+    BanMan(fs::path ban_file, CClientUIInterface* client_interface, int64_t default_ban_time);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157004696",
      "id" : 157004696,
      "original_commit_id" : "c4c300849c1eaca3069022428dcabea6a1d6c4d4",
      "original_position" : 5,
      "path" : "src/net.h",
      "position" : null,
      "pull_request_review_id" : 83571030,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157004696",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157638178"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157638178"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good point. Disconnecting the single node seems more correct to me, but I'll revert to the current behavior here to avoid the change.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-12-19T00:34:40Z",
      "diff_hunk" : "@@ -556,13 +556,7 @@ void CConnman::Ban(const CSubNet& subNet, const BanReason &banReason, int64_t ba\n     }\n     if(clientInterface)\n         clientInterface->BannedListChanged();\n-    {\n-        LOCK(cs_vNodes);\n-        for (CNode* pnode : vNodes) {\n-            if (subNet.Match((CNetAddr)pnode->addr))\n-                pnode->fDisconnect = true;\n-        }\n-    }\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157638178",
      "id" : 157638178,
      "in_reply_to_id" : 157000260,
      "original_commit_id" : "04e692c5292988688d492937ad37b8ac80f2fa07",
      "original_position" : 11,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 84313453,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157638178",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157638414"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157638414"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, will remove.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-12-19T00:36:30Z",
      "diff_hunk" : "@@ -2283,24 +2279,8 @@ bool CConnman::Start(CScheduler& scheduler, const Options& connOptions)\n             DumpAddresses();\n         }\n     }\n-    if (clientInterface)\n-        clientInterface->InitMessage(_(\"Loading banlist...\"));\n-    // Load addresses from banlist.dat\n-    nStart = GetTimeMillis();\n-    CBanDB bandb;\n-    banmap_t banmap;\n-    if (bandb.Read(banmap)) {\n-        SetBanned(banmap); // thread save setter\n-        SetBannedSetDirty(false); // no need to write down, just read data\n-        SweepBanned(); // sweep out unused entries\n \n-        LogPrint(BCLog::NET, \"Loaded %d banned node ips/subnets from banlist.dat  %dms\\n\",\n-            banmap.size(), GetTimeMillis() - nStart);\n-    } else {\n-        LogPrintf(\"Invalid or missing banlist.dat; recreating\\n\");\n-        SetBannedSetDirty(true); // force write\n-        DumpBanlist();\n-    }\n+    nStart = GetTimeMillis();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157638414",
      "id" : 157638414,
      "in_reply_to_id" : 157002284,
      "original_commit_id" : "04d0b51af1e42a32b35299e4cd69d78e6a0fffd4",
      "original_position" : 166,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 84313719,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157638414",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157638681"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157638681"
         }
      },
      "author_association" : "MEMBER",
      "body" : "So that we can test independent of the cmdline args.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-12-19T00:38:48Z",
      "diff_hunk" : "@@ -132,7 +132,7 @@ class BanMan\n     // between nodes running old code and nodes running\n     // new code.\n     ~BanMan();\n-    BanMan(fs::path ban_file, CClientUIInterface* client_interface);\n+    BanMan(fs::path ban_file, CClientUIInterface* client_interface, int64_t default_ban_time);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157638681",
      "id" : 157638681,
      "in_reply_to_id" : 157004696,
      "original_commit_id" : "c4c300849c1eaca3069022428dcabea6a1d6c4d4",
      "original_position" : 5,
      "path" : "src/net.h",
      "position" : null,
      "pull_request_review_id" : 84314037,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157638681",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157638858"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157638858"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yea, I think it may be useful in the future to run with -p2p=0 in order to view/cleanup your bandb. ",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-12-19T00:40:14Z",
      "diff_hunk" : "@@ -544,16 +544,20 @@ UniValue setban(const JSONRPCRequest& request)\n             absolute = true;\n \n         if (isSubnet) {\n-            g_connman->Ban(subNet, BanReasonManuallyAdded, banTime, absolute);\n-            g_connman->DisconnectNode(subNet);\n+            g_banman->Ban(subNet, BanReasonManuallyAdded, banTime, absolute);\n+            if (g_connman) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157638858",
      "id" : 157638858,
      "in_reply_to_id" : 157003948,
      "original_commit_id" : "04d0b51af1e42a32b35299e4cd69d78e6a0fffd4",
      "original_position" : 27,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 84314247,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157638858",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157640452"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157640452"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Well the schedule in this case is bitcoind specific. There's no reason for BanMan to know about it, and it's not exclusive to net. Throwing in an app-specific schedule would kinda defeat the purpose of breaking it out.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-12-19T00:52:50Z",
      "diff_hunk" : "@@ -1726,5 +1734,9 @@ bool AppInitMain(boost::thread_group& threadGroup, CScheduler& scheduler)\n     StartWallets(scheduler);\n #endif\n \n+    scheduler.scheduleEvery([]{",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157640452",
      "id" : 157640452,
      "in_reply_to_id" : 157001644,
      "original_commit_id" : "04d0b51af1e42a32b35299e4cd69d78e6a0fffd4",
      "original_position" : 48,
      "path" : "src/init.cpp",
      "position" : 56,
      "pull_request_review_id" : 84316024,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T01:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157640452",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Addressed @TheBlueMatt's review and squashed. Diff from before (minus the rebase to master):\r\n```patch\r\ndiff --git a/src/net.cpp b/src/net.cpp\r\nindex 78c08b1..46e7783 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -2125,4 +2125,2 @@ bool CConnman::Start(CScheduler& scheduler, const Options& connOptions)\r\n \r\n-    nStart = GetTimeMillis();\r\n-\r\n     uiInterface.InitMessage(_(\"Starting network threads...\"));\r\ndiff --git a/src/net_processing.cpp b/src/net_processing.cpp\r\nindex 2981413..e8d731c 100644\r\n--- a/src/net_processing.cpp\r\n+++ b/src/net_processing.cpp\r\n@@ -2852,3 +2852,2 @@ bool PeerLogicValidation::SendRejectsAndCheckIfBanned(CNode* pnode)\r\n         else {\r\n-            pnode->fDisconnect = true;\r\n             if (pnode->addr.IsLocal())\r\n@@ -2861,2 +2860,4 @@ bool PeerLogicValidation::SendRejectsAndCheckIfBanned(CNode* pnode)\r\n             }\r\n+            // Disconnect all nodes with this address\r\n+            connman->DisconnectNode(pnode->addr);\r\n         }\r\n\r\n```",
      "created_at" : "2017-12-19T01:41:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#issuecomment-352613328",
      "id" : 352613328,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11457",
      "updated_at" : "2017-12-19T01:41:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/352613328",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157657703"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157657703"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ugh, I mean the other annoying bit is that init.o is, by far, our largest compilation module. Any excuse to pull stuff out of init and put knowledge of a module in that module instead of init seems like the right direction to me. Also because we're telling the scheduler to schedule calling a function in that module based on a timer set in that module's header just seems...weird to me. If we want to ensure its easy to add unit tests later you can easily make the scheduler an optional arg and skip dumping if one isn't provided to the constructor.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2017-12-19T03:32:09Z",
      "diff_hunk" : "@@ -1726,5 +1734,9 @@ bool AppInitMain(boost::thread_group& threadGroup, CScheduler& scheduler)\n     StartWallets(scheduler);\n #endif\n \n+    scheduler.scheduleEvery([]{",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157657703",
      "id" : 157657703,
      "in_reply_to_id" : 157001644,
      "original_commit_id" : "04d0b51af1e42a32b35299e4cd69d78e6a0fffd4",
      "original_position" : 48,
      "path" : "src/init.cpp",
      "position" : 56,
      "pull_request_review_id" : 84335595,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2017-12-19T03:32:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157657703",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r159706508"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/159706508"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"net: Break disconnecting out of Ban()\"\r\n\r\nMaybe drop this C cast. It doesn't do anything and could cause bugs if class definitions change.\r\n  \r\n  \r\n  \r\n  ",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2018-01-04T17:14:20Z",
      "diff_hunk" : "@@ -2556,6 +2550,25 @@ bool CConnman::DisconnectNode(const std::string& strNode)\n     }\n     return false;\n }\n+\n+bool CConnman::DisconnectNode(const CSubNet& subnet)\n+{\n+    bool disconnected = false;\n+    LOCK(cs_vNodes);\n+    for (CNode* pnode : vNodes) {\n+        if (subnet.Match((CNetAddr)pnode->addr)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r159706508",
      "id" : 159706508,
      "original_commit_id" : "b8d5dd5751eb45c9f1c576cc84301c0de75fea76",
      "original_position" : 25,
      "path" : "src/net.cpp",
      "position" : 296,
      "pull_request_review_id" : 86696965,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2018-01-04T19:57:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/159706508",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r159716790"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/159716790"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157000260\r\n\r\nIn commit \"net: Break disconnecting out of Ban()\"\r\n\r\n> This is a behavior change \r\n\r\nSeems to be fixed by the new change: https://github.com/bitcoin/bitcoin/pull/11457#issuecomment-352613328, but it would be clearer if commit message also said this commit does not change current behavior.\r\n  ",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2018-01-04T18:00:11Z",
      "diff_hunk" : "@@ -556,13 +556,7 @@ void CConnman::Ban(const CSubNet& subNet, const BanReason &banReason, int64_t ba\n     }\n     if(clientInterface)\n         clientInterface->BannedListChanged();\n-    {\n-        LOCK(cs_vNodes);\n-        for (CNode* pnode : vNodes) {\n-            if (subNet.Match((CNetAddr)pnode->addr))\n-                pnode->fDisconnect = true;\n-        }\n-    }\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r159716790",
      "id" : 159716790,
      "in_reply_to_id" : 157000260,
      "original_commit_id" : "04e692c5292988688d492937ad37b8ac80f2fa07",
      "original_position" : 11,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 86696965,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2018-01-04T19:57:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/159716790",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r159718738"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/159718738"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"net: Break disconnecting out of Ban()\"\r\n\r\nIs this a behavior change in the IsLocal case? It would be helpful if commit message clarified whether this is supposed be a pure refactoring or a behavior change.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2018-01-04T18:09:51Z",
      "diff_hunk" : "@@ -2849,13 +2849,14 @@ static bool SendRejectsAndCheckIfBanned(CNode* pnode, CConnman* connman)\n         else if (pnode->m_manual_connection)\n             LogPrintf(\"Warning: not punishing manually-connected peer %s!\\n\", pnode->addr.ToString());\n         else {\n-            pnode->fDisconnect = true;\n             if (pnode->addr.IsLocal())\n                 LogPrintf(\"Warning: not banning local peer %s!\\n\", pnode->addr.ToString());\n             else\n             {\n                 connman->Ban(pnode->addr, BanReasonNodeMisbehaving);\n             }\n+            // Disconnect all nodes with this address\n+            connman->DisconnectNode(pnode->addr);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r159718738",
      "id" : 159718738,
      "original_commit_id" : "b8d5dd5751eb45c9f1c576cc84301c0de75fea76",
      "original_position" : 12,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 86696965,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2018-01-04T19:57:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/159718738",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r159720117"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/159720117"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"tests: remove member connman/peerLogic in TestingSetup\"\r\n\r\nCould abbreviate `auto connman = MakeUnique<CConnman>(0x1337, 0x1337);`",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2018-01-04T18:16:49Z",
      "diff_hunk" : "@@ -54,6 +68,9 @@ BOOST_FIXTURE_TEST_SUITE(DoS_tests, TestingSetup)\n // work.\n BOOST_AUTO_TEST_CASE(outbound_slow_chain_eviction)\n {\n+    auto connman = std::unique_ptr<CConnman>(new CConnman(0x1337, 0x1337));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r159720117",
      "id" : 159720117,
      "original_commit_id" : "25c27594bf6f9ce91e0401f13745e359c1987a19",
      "original_position" : 25,
      "path" : "src/test/DoS_tests.cpp",
      "position" : 33,
      "pull_request_review_id" : 86696965,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2018-01-04T19:57:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/159720117",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r159720959"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/159720959"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> Use std::make_unique.\r\n\r\nIt's not available in c++11, but we do have MakeUnique in src/util.h\r\n",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2018-01-04T18:20:55Z",
      "diff_hunk" : "@@ -44,6 +44,8 @@ BOOST_FIXTURE_TEST_SUITE(DoS_tests, TestingSetup)\n \n BOOST_AUTO_TEST_CASE(DoS_banning)\n {\n+    auto connman = std::unique_ptr<CConnman>(new CConnman(0x1337, 0x1337));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r159720959",
      "id" : 159720959,
      "in_reply_to_id" : 143304477,
      "original_commit_id" : "027b8d391812740ed2c77b995d91ea7a9ba14340",
      "original_position" : 4,
      "path" : "src/test/DoS_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 86696965,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2018-01-04T19:57:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/159720959",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r159724353"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/159724353"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r157001644\r\n\r\nIn commit \"banman: create and split out banman\"\r\n\r\n> Well the schedule in this case is bitcoind specific. There's no reason for BanMan to know about it, and it's not exclusive to net. Throwing in an app-specific schedule would kinda defeat the purpose of breaking it out.\r\n\r\nI'm surprised the scheduler would be considered \"bitcoind specific\" / \"app-specific\" but BanMan would not be. How could that be true? On the surface, it seems reasonable for BanMan to use the scheduler since it relies on a scheduler to function, and would seem to simplify init.cpp and anything else using BanMan.\r\n  \r\n  \r\n  ",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2018-01-04T18:36:23Z",
      "diff_hunk" : "@@ -1726,5 +1734,9 @@ bool AppInitMain(boost::thread_group& threadGroup, CScheduler& scheduler)\n     StartWallets(scheduler);\n #endif\n \n+    scheduler.scheduleEvery([]{",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r159724353",
      "id" : 159724353,
      "in_reply_to_id" : 157001644,
      "original_commit_id" : "04d0b51af1e42a32b35299e4cd69d78e6a0fffd4",
      "original_position" : 48,
      "path" : "src/init.cpp",
      "position" : 56,
      "pull_request_review_id" : 86696965,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2018-01-04T19:57:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/159724353",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r159733485"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/159733485"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Commit [banman: create and split out banman].\r\n\r\nI feel like this should be checked outside the surrounding `if (pnode->addr.IsLocal())` statement. Doesn't make sense to log \"not banning local peer\" if it wouldn't have been banned anyway.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2018-01-04T19:18:34Z",
      "diff_hunk" : "@@ -2853,7 +2853,9 @@ static bool SendRejectsAndCheckIfBanned(CNode* pnode, CConnman* connman)\n                 LogPrintf(\"Warning: not banning local peer %s!\\n\", pnode->addr.ToString());\n             else\n             {\n-                connman->Ban(pnode->addr, BanReasonNodeMisbehaving);\n+                if (m_banman) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r159733485",
      "id" : 159733485,
      "original_commit_id" : "8500946d626ea3a65ec5307da5bd5eb15c954335",
      "original_position" : 23,
      "path" : "src/net_processing.cpp",
      "position" : 36,
      "pull_request_review_id" : 86732177,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2018-01-04T19:35:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/159733485",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r159734421"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/159734421"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Commit [banman: create and split out banman].\r\n\r\n`g_banman` is guaranteed to exist given the check at the top of the function.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2018-01-04T19:23:04Z",
      "diff_hunk" : "@@ -1200,9 +1204,9 @@ void RPCConsole::unbanSelectedNode()\n         CSubNet possibleSubnet;\n \n         LookupSubNet(strNode.toStdString().c_str(), possibleSubnet);\n-        if (possibleSubnet.IsValid() && g_connman)\n+        if (possibleSubnet.IsValid() && g_banman)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r159734421",
      "id" : 159734421,
      "original_commit_id" : "8500946d626ea3a65ec5307da5bd5eb15c954335",
      "original_position" : 38,
      "path" : "src/qt/rpcconsole.cpp",
      "position" : 63,
      "pull_request_review_id" : 86732177,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2018-01-04T19:35:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/159734421",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r159734897"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/159734897"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Commit [banman: create and split out banman].\r\n\r\nPerhaps pull the common `DisconnectNode` code out of this `if/else` statement?",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2018-01-04T19:25:29Z",
      "diff_hunk" : "@@ -544,16 +544,20 @@ UniValue setban(const JSONRPCRequest& request)\n             absolute = true;\n \n         if (isSubnet) {\n-            g_connman->Ban(subNet, BanReasonManuallyAdded, banTime, absolute);\n-            g_connman->DisconnectNode(subNet);\n+            g_banman->Ban(subNet, BanReasonManuallyAdded, banTime, absolute);\n+            if (g_connman) {\n+                g_connman->DisconnectNode(subNet);\n+            }\n         } else {\n-            g_connman->Ban(netAddr, BanReasonManuallyAdded, banTime, absolute);\n-            g_connman->DisconnectNode(netAddr);\n+            g_banman->Ban(netAddr, BanReasonManuallyAdded, banTime, absolute);\n+            if (g_connman) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r159734897",
      "id" : 159734897,
      "original_commit_id" : "8500946d626ea3a65ec5307da5bd5eb15c954335",
      "original_position" : 34,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 86732177,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2018-01-04T19:35:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/159734897",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r160584194"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160584194"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@ryanofsky BanMan doesn't rely on a scheduler to function any more than the wallet does, that's a bitcoind thing. Banman just loads/unloads the bandb when it's told.\r\n\r\nImagine a small util to dump/edit the bandb, (which would be completely reasonable). The scheduler would just be a needless dependency.\r\n\r\n@TheBlueMatt It's time to create an app context class (and .h/cpp) anyway, that holds these types of objects for the life of bitcoind. I figured one of us would get around to that once enough stuff had piled up in init.cpp :p .",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2018-01-10T03:46:33Z",
      "diff_hunk" : "@@ -1726,5 +1734,9 @@ bool AppInitMain(boost::thread_group& threadGroup, CScheduler& scheduler)\n     StartWallets(scheduler);\n #endif\n \n+    scheduler.scheduleEvery([]{",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r160584194",
      "id" : 160584194,
      "in_reply_to_id" : 157001644,
      "original_commit_id" : "04d0b51af1e42a32b35299e4cd69d78e6a0fffd4",
      "original_position" : 48,
      "path" : "src/init.cpp",
      "position" : 56,
      "pull_request_review_id" : 87726035,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2018-01-10T03:46:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160584194",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r160584448"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160584448"
         }
      },
      "author_association" : "MEMBER",
      "body" : "sure",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2018-01-10T03:49:25Z",
      "diff_hunk" : "@@ -2556,6 +2550,25 @@ bool CConnman::DisconnectNode(const std::string& strNode)\n     }\n     return false;\n }\n+\n+bool CConnman::DisconnectNode(const CSubNet& subnet)\n+{\n+    bool disconnected = false;\n+    LOCK(cs_vNodes);\n+    for (CNode* pnode : vNodes) {\n+        if (subnet.Match((CNetAddr)pnode->addr)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r160584448",
      "id" : 160584448,
      "in_reply_to_id" : 159706508,
      "original_commit_id" : "b8d5dd5751eb45c9f1c576cc84301c0de75fea76",
      "original_position" : 25,
      "path" : "src/net.cpp",
      "position" : 296,
      "pull_request_review_id" : 87726334,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2018-01-10T03:49:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160584448",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r160584782"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160584782"
         }
      },
      "author_association" : "MEMBER",
      "body" : "good point, will fix.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2018-01-10T03:53:13Z",
      "diff_hunk" : "@@ -2853,7 +2853,9 @@ static bool SendRejectsAndCheckIfBanned(CNode* pnode, CConnman* connman)\n                 LogPrintf(\"Warning: not banning local peer %s!\\n\", pnode->addr.ToString());\n             else\n             {\n-                connman->Ban(pnode->addr, BanReasonNodeMisbehaving);\n+                if (m_banman) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r160584782",
      "id" : 160584782,
      "in_reply_to_id" : 159733485,
      "original_commit_id" : "8500946d626ea3a65ec5307da5bd5eb15c954335",
      "original_position" : 23,
      "path" : "src/net_processing.cpp",
      "position" : 36,
      "pull_request_review_id" : 87726729,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2018-01-10T03:53:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160584782",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r160585955"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160585955"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm not sure what the behavior change would be, so I guess not :)",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2018-01-10T04:06:40Z",
      "diff_hunk" : "@@ -2849,13 +2849,14 @@ static bool SendRejectsAndCheckIfBanned(CNode* pnode, CConnman* connman)\n         else if (pnode->m_manual_connection)\n             LogPrintf(\"Warning: not punishing manually-connected peer %s!\\n\", pnode->addr.ToString());\n         else {\n-            pnode->fDisconnect = true;\n             if (pnode->addr.IsLocal())\n                 LogPrintf(\"Warning: not banning local peer %s!\\n\", pnode->addr.ToString());\n             else\n             {\n                 connman->Ban(pnode->addr, BanReasonNodeMisbehaving);\n             }\n+            // Disconnect all nodes with this address\n+            connman->DisconnectNode(pnode->addr);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r160585955",
      "id" : 160585955,
      "in_reply_to_id" : 159718738,
      "original_commit_id" : "b8d5dd5751eb45c9f1c576cc84301c0de75fea76",
      "original_position" : 12,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 87728007,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2018-01-10T04:06:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160585955",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r160586025"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160586025"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yep, will fix.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2018-01-10T04:07:33Z",
      "diff_hunk" : "@@ -1200,9 +1204,9 @@ void RPCConsole::unbanSelectedNode()\n         CSubNet possibleSubnet;\n \n         LookupSubNet(strNode.toStdString().c_str(), possibleSubnet);\n-        if (possibleSubnet.IsValid() && g_connman)\n+        if (possibleSubnet.IsValid() && g_banman)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r160586025",
      "id" : 160586025,
      "in_reply_to_id" : 159734421,
      "original_commit_id" : "8500946d626ea3a65ec5307da5bd5eb15c954335",
      "original_position" : 38,
      "path" : "src/qt/rpcconsole.cpp",
      "position" : 63,
      "pull_request_review_id" : 87728086,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2018-01-10T04:07:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160586025",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r160586393"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160586393"
         }
      },
      "author_association" : "MEMBER",
      "body" : "One is a subnet, the other is an address. CSubNet is a subclass of CNetAddr, so we could potentially store a generic one, but imo duplicating the disconnect is more straightforward.",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2018-01-10T04:11:34Z",
      "diff_hunk" : "@@ -544,16 +544,20 @@ UniValue setban(const JSONRPCRequest& request)\n             absolute = true;\n \n         if (isSubnet) {\n-            g_connman->Ban(subNet, BanReasonManuallyAdded, banTime, absolute);\n-            g_connman->DisconnectNode(subNet);\n+            g_banman->Ban(subNet, BanReasonManuallyAdded, banTime, absolute);\n+            if (g_connman) {\n+                g_connman->DisconnectNode(subNet);\n+            }\n         } else {\n-            g_connman->Ban(netAddr, BanReasonManuallyAdded, banTime, absolute);\n-            g_connman->DisconnectNode(netAddr);\n+            g_banman->Ban(netAddr, BanReasonManuallyAdded, banTime, absolute);\n+            if (g_connman) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r160586393",
      "id" : 160586393,
      "in_reply_to_id" : 159734897,
      "original_commit_id" : "8500946d626ea3a65ec5307da5bd5eb15c954335",
      "original_position" : 34,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 87728488,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2018-01-10T04:11:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160586393",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r160586473"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160586473"
         }
      },
      "author_association" : "MEMBER",
      "body" : "will do",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2018-01-10T04:12:38Z",
      "diff_hunk" : "@@ -54,6 +68,9 @@ BOOST_FIXTURE_TEST_SUITE(DoS_tests, TestingSetup)\n // work.\n BOOST_AUTO_TEST_CASE(outbound_slow_chain_eviction)\n {\n+    auto connman = std::unique_ptr<CConnman>(new CConnman(0x1337, 0x1337));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r160586473",
      "id" : 160586473,
      "in_reply_to_id" : 159720117,
      "original_commit_id" : "25c27594bf6f9ce91e0401f13745e359c1987a19",
      "original_position" : 25,
      "path" : "src/test/DoS_tests.cpp",
      "position" : 33,
      "pull_request_review_id" : 87728573,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2018-01-10T04:12:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160586473",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r171335691"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/171335691"
         }
      },
      "author_association" : "NONE",
      "body" : "if (disconnected == false) {\r\n    disconnected = true;\r\n}      \r\n\r\nTo improve performance a tiny bit",
      "commit_id" : "8c91ffe777ffcd2724f576490068abcbb95d60c0",
      "created_at" : "2018-02-28T18:14:06Z",
      "diff_hunk" : "@@ -2556,6 +2550,25 @@ bool CConnman::DisconnectNode(const std::string& strNode)\n     }\n     return false;\n }\n+\n+bool CConnman::DisconnectNode(const CSubNet& subnet)\n+{\n+    bool disconnected = false;\n+    LOCK(cs_vNodes);\n+    for (CNode* pnode : vNodes) {\n+        if (subnet.Match((CNetAddr)pnode->addr)) {\n+            pnode->fDisconnect = true;\n+            disconnected = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#discussion_r171335691",
      "id" : 171335691,
      "original_commit_id" : "b8d5dd5751eb45c9f1c576cc84301c0de75fea76",
      "original_position" : 27,
      "path" : "src/net.cpp",
      "position" : 298,
      "pull_request_review_id" : 100170473,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11457",
      "updated_at" : "2018-02-28T18:14:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/171335691",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/2915786?v=4",
         "events_url" : "https://api.github.com/users/mizhang/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mizhang/followers",
         "following_url" : "https://api.github.com/users/mizhang/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mizhang/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mizhang",
         "id" : 2915786,
         "login" : "mizhang",
         "organizations_url" : "https://api.github.com/users/mizhang/orgs",
         "received_events_url" : "https://api.github.com/users/mizhang/received_events",
         "repos_url" : "https://api.github.com/users/mizhang/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mizhang/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mizhang/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mizhang"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased with only trivial changes, with one exception: https://github.com/bitcoin/bitcoin/pull/11457/commits/2335579f842607557a4742d2ec0749e459270bd0.\r\n\r\nAs @TheBlueMatt and @ryanofsky pointed out, it wasn't clear if any behavioral changes were introduced in SendRejectsAndCheckIfBanned, and it turned out that the new code indeed did not match master's behavior exactly, as pointed out by rpc tests.\r\n\r\nThat's now fixed and behavior should be exactly as before.",
      "created_at" : "2018-03-29T20:06:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#issuecomment-377356118",
      "id" : 377356118,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11457",
      "updated_at" : "2018-03-29T20:06:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/377356118",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "utACK 0950d72",
      "created_at" : "2018-03-29T21:47:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11457#issuecomment-377382545",
      "id" : 377382545,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11457",
      "updated_at" : "2018-03-29T21:47:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/377382545",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
