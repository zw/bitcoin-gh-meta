[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r408525476"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408525476"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Is this duration_cast needed? I think conversion should be automatic.",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-04-15T01:18:23Z",
      "diff_hunk" : "@@ -1373,7 +1375,11 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds rotate_interval = std::chrono::duration_cast<std::chrono::seconds>(ROTATE_ADDR_RELAY_DEST_INTERVAL);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r408525476",
      "id" : 408525476,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODUyNTQ3Ng==",
      "original_commit_id" : "3c8319f57b8f982335dd588ac2fe40ad87fabd29",
      "original_line" : 1379,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 393396647,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408525476",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r408527433"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408527433"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You are right. I spent 30 minutes fighting with this code, and couldn't come up with something better.\r\n\r\nBut after you messaged I tried once more and it worked. Will force push in a second.",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-04-15T01:25:42Z",
      "diff_hunk" : "@@ -1373,7 +1375,11 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds rotate_interval = std::chrono::duration_cast<std::chrono::seconds>(ROTATE_ADDR_RELAY_DEST_INTERVAL);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r408527433",
      "id" : 408527433,
      "in_reply_to_id" : 408525476,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODUyNzQzMw==",
      "original_commit_id" : "3c8319f57b8f982335dd588ac2fe40ad87fabd29",
      "original_line" : 1379,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 393398772,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408527433",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sipa btw, take a look at how hashAddr was fed to the hasher twice (with a shift, yeah).\r\nI removed it, although I don't know why it was there in the first place... Feeding it once like I do should be sufficient.",
      "created_at" : "2020-04-15T01:29:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#issuecomment-613763747",
      "id" : 613763747,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18642",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxMzc2Mzc0Nw==",
      "updated_at" : "2020-04-15T01:29:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/613763747",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r408528523"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408528523"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    const uint64_t time_seed {GetTime<std::chrono::seconds>().count() / std::chrono::seconds{ROTATE_ADDR_RELAY_DEST_INTERVAL}.count()};\r\n```\r\n\r\nEverything in one line with compile-time checks enabled would look like this, btw",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-04-15T01:29:40Z",
      "diff_hunk" : "@@ -1373,7 +1375,11 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds rotate_interval = std::chrono::duration_cast<std::chrono::seconds>(ROTATE_ADDR_RELAY_DEST_INTERVAL);\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    uint64_t time_seed = current_time.count() / rotate_interval.count();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r408528523",
      "id" : 408528523,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODUyODUyMw==",
      "original_commit_id" : "3c8319f57b8f982335dd588ac2fe40ad87fabd29",
      "original_line" : 1381,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 393399933,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408528523",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r408528847"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408528847"
         }
      },
      "author_association" : "MEMBER",
      "body" : "can we keep it to 2 lines? I think what you suggest is hard to read.",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-04-15T01:30:57Z",
      "diff_hunk" : "@@ -1373,7 +1375,11 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds rotate_interval = std::chrono::duration_cast<std::chrono::seconds>(ROTATE_ADDR_RELAY_DEST_INTERVAL);\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    uint64_t time_seed = current_time.count() / rotate_interval.count();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r408528847",
      "id" : 408528847,
      "in_reply_to_id" : 408528523,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODUyODg0Nw==",
      "original_commit_id" : "3c8319f57b8f982335dd588ac2fe40ad87fabd29",
      "original_line" : 1381,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 393400312,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408528847",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@naumenkogs It was very inscrutable code, but the construction with double-hashing the address hash was by design.\r\n\r\nThe idea is that the address both influences the hash directly, but also determines when the \"reset time of the day\" is (by including hashaddr in `(time + hashaddr)/DAY`, not every address will change salt simultaneously throughout the day).\r\n\r\nThe shifting is pointless, we should get rid of it. It seems to be a silly evolution of this 2010 Satoshi code: 5cbf75324d1509a1262b65c5073314a4da3f6d77 (where it made sense because everything was XORed together, and the address used the high bits, while the time used the low ones).",
      "created_at" : "2020-04-15T02:05:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#issuecomment-613773120",
      "id" : 613773120,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18642",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxMzc3MzEyMA==",
      "updated_at" : "2020-04-15T02:12:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/613773120",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r408538603"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408538603"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr).Write((current_time + hashAddr) / ROTATE_ADDR_RELAY_DEST_INTERVAL);\r\n```",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-04-15T02:06:36Z",
      "diff_hunk" : "@@ -1373,7 +1375,10 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    uint64_t time_seed = current_time / ROTATE_ADDR_RELAY_DEST_INTERVAL;\n+    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr).Write(time_seed);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r408538603",
      "id" : 408538603,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODUzODYwMw==",
      "original_commit_id" : "8690d401a71609108f47d7e303c113eed401d52f",
      "original_line" : 1381,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 393410577,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408538603",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r408860100"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408860100"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yeah, I'm not 100% sure that this measure is effective against anything, but it won't hurt to have a less symmetry.\r\nThis mehaviour _may_ leak extra information if someone tries to analyze how addresses are flowing, but since we don't have any real evidence, we probably should stick to the existing reasoning.\r\n\r\nHad to slightly adjust the code you suggested, because adding uint to chrono type doesn't work right away.",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-04-15T13:54:20Z",
      "diff_hunk" : "@@ -1373,7 +1375,10 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    uint64_t time_seed = current_time / ROTATE_ADDR_RELAY_DEST_INTERVAL;\n+    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr).Write(time_seed);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r408860100",
      "id" : 408860100,
      "in_reply_to_id" : 408538603,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODg2MDEwMA==",
      "original_commit_id" : "8690d401a71609108f47d7e303c113eed401d52f",
      "original_line" : 1381,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 393796074,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408860100",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated the code with suggestion by @sipa, and simplified tests.\r\nThey are a bit loosened now, but more robust to failures caused by randomness. ",
      "created_at" : "2020-04-15T14:05:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#issuecomment-614060919",
      "id" : 614060919,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18642",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxNDA2MDkxOQ==",
      "updated_at" : "2020-04-15T14:12:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/614060919",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r408882152"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408882152"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Previously `hashAddr` was of type seconds, now it is type hours. What was the reason to change it?",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-04-15T14:23:32Z",
      "diff_hunk" : "@@ -1373,7 +1375,11 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = (current_time + std::chrono::hours(hashAddr)) / ROTATE_ADDR_RELAY_DEST_INTERVAL;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r408882152",
      "id" : 408882152,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODg4MjE1Mg==",
      "original_commit_id" : "cca35ff2477eea45a2d0781544621ce6e8afa158",
      "original_line" : 1381,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 393824603,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408882152",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r408927009"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408927009"
         }
      },
      "author_association" : "MEMBER",
      "body" : "There is no real difference, as long as it  is an order of hours or more. Otherwise, it won't add enough randomness.",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-04-15T15:20:50Z",
      "diff_hunk" : "@@ -1373,7 +1375,11 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = (current_time + std::chrono::hours(hashAddr)) / ROTATE_ADDR_RELAY_DEST_INTERVAL;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r408927009",
      "id" : 408927009,
      "in_reply_to_id" : 408882152,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODkyNzAwOQ==",
      "original_commit_id" : "cca35ff2477eea45a2d0781544621ce6e8afa158",
      "original_line" : 1381,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 393880756,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408927009",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r408942249"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408942249"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You will get rid of the \"reset time of the day\" feature. Generally I don't like refactoring commits to also change behavior.",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-04-15T15:40:55Z",
      "diff_hunk" : "@@ -1373,7 +1375,11 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = (current_time + std::chrono::hours(hashAddr)) / ROTATE_ADDR_RELAY_DEST_INTERVAL;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r408942249",
      "id" : 408942249,
      "in_reply_to_id" : 408882152,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk0MjI0OQ==",
      "original_commit_id" : "cca35ff2477eea45a2d0781544621ce6e8afa158",
      "original_line" : 1381,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 393899475,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408942249",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r408950804"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408950804"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Okay, made it seconds again so that we don't change the behavior. Although I think we won't loose any properties if hours are used.",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-04-15T15:52:49Z",
      "diff_hunk" : "@@ -1373,7 +1375,11 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = (current_time + std::chrono::hours(hashAddr)) / ROTATE_ADDR_RELAY_DEST_INTERVAL;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r408950804",
      "id" : 408950804,
      "in_reply_to_id" : 408882152,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk1MDgwNA==",
      "original_commit_id" : "cca35ff2477eea45a2d0781544621ce6e8afa158",
      "original_line" : 1381,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 393909762,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408950804",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r409919084"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409919084"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    uint64_t time_addr = (current_time + std::chrono::seconds{static_cast<int64_t>(hashAddr)}) / ROTATE_ADDR_RELAY_DEST_INTERVAL;\r\n```\r\n\r\nMaybe try this to avoid https://travis-ci.org/github/bitcoin/bitcoin/jobs/675780723#L4756",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-04-17T00:10:42Z",
      "diff_hunk" : "@@ -1373,7 +1375,11 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = (current_time + std::chrono::seconds(hashAddr)) / ROTATE_ADDR_RELAY_DEST_INTERVAL;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r409919084",
      "id" : 409919084,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTkxOTA4NA==",
      "original_commit_id" : "ae5eaf52624703752f63703942fd5aacdc0b7122",
      "original_line" : 1381,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 395080647,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409919084",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r412253058"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/412253058"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    uint64_t time_addr = static_cast<uint64_t>((current_time + std::chrono::seconds{static_cast<int64_t>(hashAddr)}) / ROTATE_ADDR_RELAY_DEST_INTERVAL);\r\n```\r\n\r\n\r\n```\r\n node0 stderr net_processing.cpp:1381:26: runtime error: implicit conversion from type 'typename common_type<long, long>::type' (aka 'long') of value -28739051454386 (64-bit, signed) to type 'uint64_t' (aka 'unsigned long') changed the value to 18446715334658097230 (64-bit, unsigned)",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-04-21T14:49:28Z",
      "diff_hunk" : "@@ -1373,7 +1375,11 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = (current_time + std::chrono::seconds{static_cast<int64_t>(hashAddr)}) / ROTATE_ADDR_RELAY_DEST_INTERVAL;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r412253058",
      "id" : 412253058,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjI1MzA1OA==",
      "original_commit_id" : "72c4db3521069240a91609499638ba92313009af",
      "original_line" : 1381,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 397408347,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/412253058",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#23542](https://github.com/bitcoin/bitcoin/pull/23542) (net: open p2p connections to nodes that listen on non-default ports by vasild)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-04-23T21:06:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#issuecomment-618671026",
      "id" : 618671026,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18642",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxODY3MTAyNg==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/618671026/reactions"
      },
      "updated_at" : "2022-01-11T14:01:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/618671026",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-04-25T13:09:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#issuecomment-619377387",
      "id" : 619377387,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18642",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxOTM3NzM4Nw==",
      "updated_at" : "2020-04-25T13:09:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/619377387",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-06-24T21:39:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#issuecomment-649087230",
      "id" : 649087230,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18642",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0OTA4NzIzMA==",
      "updated_at" : "2020-06-24T21:39:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/649087230",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r446666126"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/446666126"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: Can this be simpler? It's more code and (even with the removed bit shifting) a bit more complex to understand.",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-06-28T15:45:29Z",
      "diff_hunk" : "@@ -1433,7 +1435,11 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = static_cast<uint64_t>((current_time + std::chrono::seconds{static_cast<int64_t>(hashAddr)}) / ROTATE_ADDR_RELAY_DEST_INTERVAL);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r446666126",
      "id" : 446666126,
      "line" : 1441,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY2NjEyNg==",
      "original_commit_id" : "177df94a6ccce896e3bf067cc3c8254ecc40bfa9",
      "original_line" : 1441,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 17,
      "pull_request_review_id" : 438791359,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/446666126",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r446666432"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/446666432"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 6 places (here, above at line 72 and line 87, below at lines 106+107 and 113), it could be good to move the multiplications out of the loops and up to constants at the top like `ONE_HOUR`, `TWO_HOURS`, and `ONE_DAY`.",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-06-28T15:48:55Z",
      "diff_hunk" : "@@ -48,24 +53,72 @@ def run_test(self):\n         self.log.info('Create connection that sends addr messages')\n         addr_source = self.nodes[0].add_p2p_connection(P2PInterface())\n         msg = msg_addr()\n-\n         self.log.info('Send too-large addr message')\n-        msg.addrs = ADDRS * 101\n+        msg.addrs = gen_addrs(1010, int(time.time()))\n         with self.nodes[0].assert_debug_log(['addr message size = 1010']):\n             addr_source.send_and_ping(msg)\n \n         self.log.info('Check that addr message content is relayed and added to addrman')\n         addr_receiver = self.nodes[0].add_p2p_connection(AddrReceiver())\n-        msg.addrs = ADDRS\n+        mocked_time = int(time.time())\n+        self.nodes[0].setmocktime(mocked_time)\n+        msg.addrs = gen_addrs(10, mocked_time)\n         with self.nodes[0].assert_debug_log([\n                 'Added 10 addresses from 127.0.0.1: 0 tried',\n                 'received: addr (301 bytes) peer=0',\n                 'sending addr (301 bytes) peer=1',\n         ]):\n             addr_source.send_and_ping(msg)\n-            self.nodes[0].setmocktime(int(time.time()) + 30 * 60)\n+            mocked_time += 30 * 60\n+            self.nodes[0].setmocktime(mocked_time)\n             addr_receiver.sync_with_ping()\n \n+        self.log.info('Check that within 24 hours an addr relay destination is rotated at most once')\n+        mocked_time = int(time.time()) + 100000\n+        self.nodes[0].setmocktime(mocked_time)\n+        msg.addrs = gen_addrs(1, mocked_time)\n+        addr_receiver.received_addr = False\n+        addr_receivers = [addr_receiver]\n+        for i in range(20):\n+            addr_receiver = self.nodes[0].add_p2p_connection(AddrReceiver())\n+            addr_receivers.append(addr_receiver)\n+\n+        for i in range(11): # 11 times jump for 2 hours, so less than 24 hours -> at most one rotation\n+            msg.addrs[0].time = mocked_time + 10 * 60\n+            with self.nodes[0].assert_debug_log([\n+                'received: addr (31 bytes) peer=0',\n+            ]):\n+                addr_source.send_and_ping(msg)\n+                mocked_time += 2 * 60 * 60",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r446666432",
      "id" : 446666432,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY2NjQzMg==",
      "original_commit_id" : "177df94a6ccce896e3bf067cc3c8254ecc40bfa9",
      "original_line" : 92,
      "original_position" : 80,
      "original_start_line" : null,
      "path" : "test/functional/p2p_addr_relay.py",
      "position" : null,
      "pull_request_review_id" : 438791359,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/446666432",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r446666610"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/446666610"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n        for _ in range(11):  # 11 times jump for 2 hours, so less than 24 hours -> at most one rotation\r\n```",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-06-28T15:50:19Z",
      "diff_hunk" : "@@ -48,24 +53,72 @@ def run_test(self):\n         self.log.info('Create connection that sends addr messages')\n         addr_source = self.nodes[0].add_p2p_connection(P2PInterface())\n         msg = msg_addr()\n-\n         self.log.info('Send too-large addr message')\n-        msg.addrs = ADDRS * 101\n+        msg.addrs = gen_addrs(1010, int(time.time()))\n         with self.nodes[0].assert_debug_log(['addr message size = 1010']):\n             addr_source.send_and_ping(msg)\n \n         self.log.info('Check that addr message content is relayed and added to addrman')\n         addr_receiver = self.nodes[0].add_p2p_connection(AddrReceiver())\n-        msg.addrs = ADDRS\n+        mocked_time = int(time.time())\n+        self.nodes[0].setmocktime(mocked_time)\n+        msg.addrs = gen_addrs(10, mocked_time)\n         with self.nodes[0].assert_debug_log([\n                 'Added 10 addresses from 127.0.0.1: 0 tried',\n                 'received: addr (301 bytes) peer=0',\n                 'sending addr (301 bytes) peer=1',\n         ]):\n             addr_source.send_and_ping(msg)\n-            self.nodes[0].setmocktime(int(time.time()) + 30 * 60)\n+            mocked_time += 30 * 60\n+            self.nodes[0].setmocktime(mocked_time)\n             addr_receiver.sync_with_ping()\n \n+        self.log.info('Check that within 24 hours an addr relay destination is rotated at most once')\n+        mocked_time = int(time.time()) + 100000\n+        self.nodes[0].setmocktime(mocked_time)\n+        msg.addrs = gen_addrs(1, mocked_time)\n+        addr_receiver.received_addr = False\n+        addr_receivers = [addr_receiver]\n+        for i in range(20):\n+            addr_receiver = self.nodes[0].add_p2p_connection(AddrReceiver())\n+            addr_receivers.append(addr_receiver)\n+\n+        for i in range(11): # 11 times jump for 2 hours, so less than 24 hours -> at most one rotation",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r446666610",
      "id" : 446666610,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY2NjYxMA==",
      "original_commit_id" : "177df94a6ccce896e3bf067cc3c8254ecc40bfa9",
      "original_line" : 86,
      "original_position" : 74,
      "original_start_line" : null,
      "path" : "test/functional/p2p_addr_relay.py",
      "position" : null,
      "pull_request_review_id" : 438791359,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/446666610",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r446666666"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/446666666"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n        for _ in range(10):  # 11 times jump for a day, so less than 24 hours -> at most one rotation\r\n```\r\nShould this be 10 or 11?",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-06-28T15:50:49Z",
      "diff_hunk" : "@@ -48,24 +53,72 @@ def run_test(self):\n         self.log.info('Create connection that sends addr messages')\n         addr_source = self.nodes[0].add_p2p_connection(P2PInterface())\n         msg = msg_addr()\n-\n         self.log.info('Send too-large addr message')\n-        msg.addrs = ADDRS * 101\n+        msg.addrs = gen_addrs(1010, int(time.time()))\n         with self.nodes[0].assert_debug_log(['addr message size = 1010']):\n             addr_source.send_and_ping(msg)\n \n         self.log.info('Check that addr message content is relayed and added to addrman')\n         addr_receiver = self.nodes[0].add_p2p_connection(AddrReceiver())\n-        msg.addrs = ADDRS\n+        mocked_time = int(time.time())\n+        self.nodes[0].setmocktime(mocked_time)\n+        msg.addrs = gen_addrs(10, mocked_time)\n         with self.nodes[0].assert_debug_log([\n                 'Added 10 addresses from 127.0.0.1: 0 tried',\n                 'received: addr (301 bytes) peer=0',\n                 'sending addr (301 bytes) peer=1',\n         ]):\n             addr_source.send_and_ping(msg)\n-            self.nodes[0].setmocktime(int(time.time()) + 30 * 60)\n+            mocked_time += 30 * 60\n+            self.nodes[0].setmocktime(mocked_time)\n             addr_receiver.sync_with_ping()\n \n+        self.log.info('Check that within 24 hours an addr relay destination is rotated at most once')\n+        mocked_time = int(time.time()) + 100000\n+        self.nodes[0].setmocktime(mocked_time)\n+        msg.addrs = gen_addrs(1, mocked_time)\n+        addr_receiver.received_addr = False\n+        addr_receivers = [addr_receiver]\n+        for i in range(20):\n+            addr_receiver = self.nodes[0].add_p2p_connection(AddrReceiver())\n+            addr_receivers.append(addr_receiver)\n+\n+        for i in range(11): # 11 times jump for 2 hours, so less than 24 hours -> at most one rotation\n+            msg.addrs[0].time = mocked_time + 10 * 60\n+            with self.nodes[0].assert_debug_log([\n+                'received: addr (31 bytes) peer=0',\n+            ]):\n+                addr_source.send_and_ping(msg)\n+                mocked_time += 2 * 60 * 60\n+                self.nodes[0].setmocktime(mocked_time)\n+                for receiver in addr_receivers:\n+                    receiver.sync_with_ping()\n+        nodes_received_addr = [node for node in addr_receivers if node.received_addr]\n+        assert(len(nodes_received_addr) <= 4)\n+\n+        self.log.info('Check that after 5 days an addr relay destination was rotated more than once')\n+        mocked_time = int(time.time()) + 200000\n+        self.nodes[0].setmocktime(mocked_time)\n+        for node in addr_receivers:\n+            node.received_addr = False\n+\n+        for i in range(10): # 11 times jump for a day, so less than 24 hours -> at most one rotation",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r446666666",
      "id" : 446666666,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY2NjY2Ng==",
      "original_commit_id" : "177df94a6ccce896e3bf067cc3c8254ecc40bfa9",
      "original_line" : 105,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "test/functional/p2p_addr_relay.py",
      "position" : null,
      "pull_request_review_id" : 438791359,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/446666666",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r446666908"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/446666908"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n                mocked_time += 60 * 60  # should be enough to cover 30-min Poisson in most cases.\r\n```",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-06-28T15:53:10Z",
      "diff_hunk" : "@@ -48,24 +53,72 @@ def run_test(self):\n         self.log.info('Create connection that sends addr messages')\n         addr_source = self.nodes[0].add_p2p_connection(P2PInterface())\n         msg = msg_addr()\n-\n         self.log.info('Send too-large addr message')\n-        msg.addrs = ADDRS * 101\n+        msg.addrs = gen_addrs(1010, int(time.time()))\n         with self.nodes[0].assert_debug_log(['addr message size = 1010']):\n             addr_source.send_and_ping(msg)\n \n         self.log.info('Check that addr message content is relayed and added to addrman')\n         addr_receiver = self.nodes[0].add_p2p_connection(AddrReceiver())\n-        msg.addrs = ADDRS\n+        mocked_time = int(time.time())\n+        self.nodes[0].setmocktime(mocked_time)\n+        msg.addrs = gen_addrs(10, mocked_time)\n         with self.nodes[0].assert_debug_log([\n                 'Added 10 addresses from 127.0.0.1: 0 tried',\n                 'received: addr (301 bytes) peer=0',\n                 'sending addr (301 bytes) peer=1',\n         ]):\n             addr_source.send_and_ping(msg)\n-            self.nodes[0].setmocktime(int(time.time()) + 30 * 60)\n+            mocked_time += 30 * 60\n+            self.nodes[0].setmocktime(mocked_time)\n             addr_receiver.sync_with_ping()\n \n+        self.log.info('Check that within 24 hours an addr relay destination is rotated at most once')\n+        mocked_time = int(time.time()) + 100000\n+        self.nodes[0].setmocktime(mocked_time)\n+        msg.addrs = gen_addrs(1, mocked_time)\n+        addr_receiver.received_addr = False\n+        addr_receivers = [addr_receiver]\n+        for i in range(20):\n+            addr_receiver = self.nodes[0].add_p2p_connection(AddrReceiver())\n+            addr_receivers.append(addr_receiver)\n+\n+        for i in range(11): # 11 times jump for 2 hours, so less than 24 hours -> at most one rotation\n+            msg.addrs[0].time = mocked_time + 10 * 60\n+            with self.nodes[0].assert_debug_log([\n+                'received: addr (31 bytes) peer=0',\n+            ]):\n+                addr_source.send_and_ping(msg)\n+                mocked_time += 2 * 60 * 60\n+                self.nodes[0].setmocktime(mocked_time)\n+                for receiver in addr_receivers:\n+                    receiver.sync_with_ping()\n+        nodes_received_addr = [node for node in addr_receivers if node.received_addr]\n+        assert(len(nodes_received_addr) <= 4)\n+\n+        self.log.info('Check that after 5 days an addr relay destination was rotated more than once')\n+        mocked_time = int(time.time()) + 200000\n+        self.nodes[0].setmocktime(mocked_time)\n+        for node in addr_receivers:\n+            node.received_addr = False\n+\n+        for i in range(10): # 11 times jump for a day, so less than 24 hours -> at most one rotation\n+            mocked_time += 24 * 60 * 60\n+            msg.addrs[0].time = mocked_time + 10 * 60\n+            self.nodes[0].setmocktime(mocked_time)\n+            with self.nodes[0].assert_debug_log([\n+                'received: addr (31 bytes) peer=0',\n+            ]):\n+                addr_source.send_and_ping(msg)\n+                mocked_time += 60 * 60 # should be enough to cover 30-min Poisson in most cases.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r446666908",
      "id" : 446666908,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY2NjkwOA==",
      "original_commit_id" : "177df94a6ccce896e3bf067cc3c8254ecc40bfa9",
      "original_line" : 113,
      "original_position" : 101,
      "original_start_line" : null,
      "path" : "test/functional/p2p_addr_relay.py",
      "position" : null,
      "pull_request_review_id" : 438791359,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/446666908",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r446667037"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/446667037"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n        assert len(nodes_received_addr) > 4\r\n```\r\nor even better (adding it to the imported methods at the top)\r\n```suggestion\r\n        assert_greater_than(len(nodes_received_addr), 4)\r\n```",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-06-28T15:54:27Z",
      "diff_hunk" : "@@ -48,24 +53,72 @@ def run_test(self):\n         self.log.info('Create connection that sends addr messages')\n         addr_source = self.nodes[0].add_p2p_connection(P2PInterface())\n         msg = msg_addr()\n-\n         self.log.info('Send too-large addr message')\n-        msg.addrs = ADDRS * 101\n+        msg.addrs = gen_addrs(1010, int(time.time()))\n         with self.nodes[0].assert_debug_log(['addr message size = 1010']):\n             addr_source.send_and_ping(msg)\n \n         self.log.info('Check that addr message content is relayed and added to addrman')\n         addr_receiver = self.nodes[0].add_p2p_connection(AddrReceiver())\n-        msg.addrs = ADDRS\n+        mocked_time = int(time.time())\n+        self.nodes[0].setmocktime(mocked_time)\n+        msg.addrs = gen_addrs(10, mocked_time)\n         with self.nodes[0].assert_debug_log([\n                 'Added 10 addresses from 127.0.0.1: 0 tried',\n                 'received: addr (301 bytes) peer=0',\n                 'sending addr (301 bytes) peer=1',\n         ]):\n             addr_source.send_and_ping(msg)\n-            self.nodes[0].setmocktime(int(time.time()) + 30 * 60)\n+            mocked_time += 30 * 60\n+            self.nodes[0].setmocktime(mocked_time)\n             addr_receiver.sync_with_ping()\n \n+        self.log.info('Check that within 24 hours an addr relay destination is rotated at most once')\n+        mocked_time = int(time.time()) + 100000\n+        self.nodes[0].setmocktime(mocked_time)\n+        msg.addrs = gen_addrs(1, mocked_time)\n+        addr_receiver.received_addr = False\n+        addr_receivers = [addr_receiver]\n+        for i in range(20):\n+            addr_receiver = self.nodes[0].add_p2p_connection(AddrReceiver())\n+            addr_receivers.append(addr_receiver)\n+\n+        for i in range(11): # 11 times jump for 2 hours, so less than 24 hours -> at most one rotation\n+            msg.addrs[0].time = mocked_time + 10 * 60\n+            with self.nodes[0].assert_debug_log([\n+                'received: addr (31 bytes) peer=0',\n+            ]):\n+                addr_source.send_and_ping(msg)\n+                mocked_time += 2 * 60 * 60\n+                self.nodes[0].setmocktime(mocked_time)\n+                for receiver in addr_receivers:\n+                    receiver.sync_with_ping()\n+        nodes_received_addr = [node for node in addr_receivers if node.received_addr]\n+        assert(len(nodes_received_addr) <= 4)\n+\n+        self.log.info('Check that after 5 days an addr relay destination was rotated more than once')\n+        mocked_time = int(time.time()) + 200000\n+        self.nodes[0].setmocktime(mocked_time)\n+        for node in addr_receivers:\n+            node.received_addr = False\n+\n+        for i in range(10): # 11 times jump for a day, so less than 24 hours -> at most one rotation\n+            mocked_time += 24 * 60 * 60\n+            msg.addrs[0].time = mocked_time + 10 * 60\n+            self.nodes[0].setmocktime(mocked_time)\n+            with self.nodes[0].assert_debug_log([\n+                'received: addr (31 bytes) peer=0',\n+            ]):\n+                addr_source.send_and_ping(msg)\n+                mocked_time += 60 * 60 # should be enough to cover 30-min Poisson in most cases.\n+                self.nodes[0].setmocktime(mocked_time)\n+                for receiver in addr_receivers:\n+                    receiver.sync_with_ping()\n+        nodes_received_addr = [node for node in addr_receivers if node.received_addr]\n+        assert(len(nodes_received_addr) > 4)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r446667037",
      "id" : 446667037,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY2NzAzNw==",
      "original_commit_id" : "177df94a6ccce896e3bf067cc3c8254ecc40bfa9",
      "original_line" : 118,
      "original_position" : 106,
      "original_start_line" : null,
      "path" : "test/functional/p2p_addr_relay.py",
      "position" : null,
      "pull_request_review_id" : 438791359,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/446667037",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r446667134"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/446667134"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n        assert len(nodes_received_addr) <= 4\r\n```",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-06-28T15:55:15Z",
      "diff_hunk" : "@@ -48,24 +53,72 @@ def run_test(self):\n         self.log.info('Create connection that sends addr messages')\n         addr_source = self.nodes[0].add_p2p_connection(P2PInterface())\n         msg = msg_addr()\n-\n         self.log.info('Send too-large addr message')\n-        msg.addrs = ADDRS * 101\n+        msg.addrs = gen_addrs(1010, int(time.time()))\n         with self.nodes[0].assert_debug_log(['addr message size = 1010']):\n             addr_source.send_and_ping(msg)\n \n         self.log.info('Check that addr message content is relayed and added to addrman')\n         addr_receiver = self.nodes[0].add_p2p_connection(AddrReceiver())\n-        msg.addrs = ADDRS\n+        mocked_time = int(time.time())\n+        self.nodes[0].setmocktime(mocked_time)\n+        msg.addrs = gen_addrs(10, mocked_time)\n         with self.nodes[0].assert_debug_log([\n                 'Added 10 addresses from 127.0.0.1: 0 tried',\n                 'received: addr (301 bytes) peer=0',\n                 'sending addr (301 bytes) peer=1',\n         ]):\n             addr_source.send_and_ping(msg)\n-            self.nodes[0].setmocktime(int(time.time()) + 30 * 60)\n+            mocked_time += 30 * 60\n+            self.nodes[0].setmocktime(mocked_time)\n             addr_receiver.sync_with_ping()\n \n+        self.log.info('Check that within 24 hours an addr relay destination is rotated at most once')\n+        mocked_time = int(time.time()) + 100000\n+        self.nodes[0].setmocktime(mocked_time)\n+        msg.addrs = gen_addrs(1, mocked_time)\n+        addr_receiver.received_addr = False\n+        addr_receivers = [addr_receiver]\n+        for i in range(20):\n+            addr_receiver = self.nodes[0].add_p2p_connection(AddrReceiver())\n+            addr_receivers.append(addr_receiver)\n+\n+        for i in range(11): # 11 times jump for 2 hours, so less than 24 hours -> at most one rotation\n+            msg.addrs[0].time = mocked_time + 10 * 60\n+            with self.nodes[0].assert_debug_log([\n+                'received: addr (31 bytes) peer=0',\n+            ]):\n+                addr_source.send_and_ping(msg)\n+                mocked_time += 2 * 60 * 60\n+                self.nodes[0].setmocktime(mocked_time)\n+                for receiver in addr_receivers:\n+                    receiver.sync_with_ping()\n+        nodes_received_addr = [node for node in addr_receivers if node.received_addr]\n+        assert(len(nodes_received_addr) <= 4)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r446667134",
      "id" : 446667134,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY2NzEzNA==",
      "original_commit_id" : "177df94a6ccce896e3bf067cc3c8254ecc40bfa9",
      "original_line" : 97,
      "original_position" : 85,
      "original_start_line" : null,
      "path" : "test/functional/p2p_addr_relay.py",
      "position" : null,
      "pull_request_review_id" : 438791359,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/446667134",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r446667220"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/446667220"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n        for _ in range(20):\r\n```",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-06-28T15:55:54Z",
      "diff_hunk" : "@@ -48,24 +53,72 @@ def run_test(self):\n         self.log.info('Create connection that sends addr messages')\n         addr_source = self.nodes[0].add_p2p_connection(P2PInterface())\n         msg = msg_addr()\n-\n         self.log.info('Send too-large addr message')\n-        msg.addrs = ADDRS * 101\n+        msg.addrs = gen_addrs(1010, int(time.time()))\n         with self.nodes[0].assert_debug_log(['addr message size = 1010']):\n             addr_source.send_and_ping(msg)\n \n         self.log.info('Check that addr message content is relayed and added to addrman')\n         addr_receiver = self.nodes[0].add_p2p_connection(AddrReceiver())\n-        msg.addrs = ADDRS\n+        mocked_time = int(time.time())\n+        self.nodes[0].setmocktime(mocked_time)\n+        msg.addrs = gen_addrs(10, mocked_time)\n         with self.nodes[0].assert_debug_log([\n                 'Added 10 addresses from 127.0.0.1: 0 tried',\n                 'received: addr (301 bytes) peer=0',\n                 'sending addr (301 bytes) peer=1',\n         ]):\n             addr_source.send_and_ping(msg)\n-            self.nodes[0].setmocktime(int(time.time()) + 30 * 60)\n+            mocked_time += 30 * 60\n+            self.nodes[0].setmocktime(mocked_time)\n             addr_receiver.sync_with_ping()\n \n+        self.log.info('Check that within 24 hours an addr relay destination is rotated at most once')\n+        mocked_time = int(time.time()) + 100000\n+        self.nodes[0].setmocktime(mocked_time)\n+        msg.addrs = gen_addrs(1, mocked_time)\n+        addr_receiver.received_addr = False\n+        addr_receivers = [addr_receiver]\n+        for i in range(20):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r446667220",
      "id" : 446667220,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY2NzIyMA==",
      "original_commit_id" : "177df94a6ccce896e3bf067cc3c8254ecc40bfa9",
      "original_line" : 82,
      "original_position" : 70,
      "original_start_line" : null,
      "path" : "test/functional/p2p_addr_relay.py",
      "position" : null,
      "pull_request_review_id" : 438791359,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/446667220",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r446668071"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/446668071"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't grok what/why regarding the 100000 value. It would be nice to comment and/or hoist it to a variable.\r\n\r\nSame for 200000 at line 100.",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-06-28T16:03:25Z",
      "diff_hunk" : "@@ -48,24 +53,72 @@ def run_test(self):\n         self.log.info('Create connection that sends addr messages')\n         addr_source = self.nodes[0].add_p2p_connection(P2PInterface())\n         msg = msg_addr()\n-\n         self.log.info('Send too-large addr message')\n-        msg.addrs = ADDRS * 101\n+        msg.addrs = gen_addrs(1010, int(time.time()))\n         with self.nodes[0].assert_debug_log(['addr message size = 1010']):\n             addr_source.send_and_ping(msg)\n \n         self.log.info('Check that addr message content is relayed and added to addrman')\n         addr_receiver = self.nodes[0].add_p2p_connection(AddrReceiver())\n-        msg.addrs = ADDRS\n+        mocked_time = int(time.time())\n+        self.nodes[0].setmocktime(mocked_time)\n+        msg.addrs = gen_addrs(10, mocked_time)\n         with self.nodes[0].assert_debug_log([\n                 'Added 10 addresses from 127.0.0.1: 0 tried',\n                 'received: addr (301 bytes) peer=0',\n                 'sending addr (301 bytes) peer=1',\n         ]):\n             addr_source.send_and_ping(msg)\n-            self.nodes[0].setmocktime(int(time.time()) + 30 * 60)\n+            mocked_time += 30 * 60\n+            self.nodes[0].setmocktime(mocked_time)\n             addr_receiver.sync_with_ping()\n \n+        self.log.info('Check that within 24 hours an addr relay destination is rotated at most once')\n+        mocked_time = int(time.time()) + 100000",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r446668071",
      "id" : 446668071,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY2ODA3MQ==",
      "original_commit_id" : "177df94a6ccce896e3bf067cc3c8254ecc40bfa9",
      "original_line" : 77,
      "original_position" : 65,
      "original_start_line" : null,
      "path" : "test/functional/p2p_addr_relay.py",
      "position" : null,
      "pull_request_review_id" : 438791359,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/446668071",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r446668728"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/446668728"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why the value of 4 here and line 118? Perhaps add a comment.",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-06-28T16:10:00Z",
      "diff_hunk" : "@@ -48,24 +53,72 @@ def run_test(self):\n         self.log.info('Create connection that sends addr messages')\n         addr_source = self.nodes[0].add_p2p_connection(P2PInterface())\n         msg = msg_addr()\n-\n         self.log.info('Send too-large addr message')\n-        msg.addrs = ADDRS * 101\n+        msg.addrs = gen_addrs(1010, int(time.time()))\n         with self.nodes[0].assert_debug_log(['addr message size = 1010']):\n             addr_source.send_and_ping(msg)\n \n         self.log.info('Check that addr message content is relayed and added to addrman')\n         addr_receiver = self.nodes[0].add_p2p_connection(AddrReceiver())\n-        msg.addrs = ADDRS\n+        mocked_time = int(time.time())\n+        self.nodes[0].setmocktime(mocked_time)\n+        msg.addrs = gen_addrs(10, mocked_time)\n         with self.nodes[0].assert_debug_log([\n                 'Added 10 addresses from 127.0.0.1: 0 tried',\n                 'received: addr (301 bytes) peer=0',\n                 'sending addr (301 bytes) peer=1',\n         ]):\n             addr_source.send_and_ping(msg)\n-            self.nodes[0].setmocktime(int(time.time()) + 30 * 60)\n+            mocked_time += 30 * 60\n+            self.nodes[0].setmocktime(mocked_time)\n             addr_receiver.sync_with_ping()\n \n+        self.log.info('Check that within 24 hours an addr relay destination is rotated at most once')\n+        mocked_time = int(time.time()) + 100000\n+        self.nodes[0].setmocktime(mocked_time)\n+        msg.addrs = gen_addrs(1, mocked_time)\n+        addr_receiver.received_addr = False\n+        addr_receivers = [addr_receiver]\n+        for i in range(20):\n+            addr_receiver = self.nodes[0].add_p2p_connection(AddrReceiver())\n+            addr_receivers.append(addr_receiver)\n+\n+        for i in range(11): # 11 times jump for 2 hours, so less than 24 hours -> at most one rotation\n+            msg.addrs[0].time = mocked_time + 10 * 60\n+            with self.nodes[0].assert_debug_log([\n+                'received: addr (31 bytes) peer=0',\n+            ]):\n+                addr_source.send_and_ping(msg)\n+                mocked_time += 2 * 60 * 60\n+                self.nodes[0].setmocktime(mocked_time)\n+                for receiver in addr_receivers:\n+                    receiver.sync_with_ping()\n+        nodes_received_addr = [node for node in addr_receivers if node.received_addr]\n+        assert(len(nodes_received_addr) <= 4)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r446668728",
      "id" : 446668728,
      "in_reply_to_id" : 446667134,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY2ODcyOA==",
      "original_commit_id" : "177df94a6ccce896e3bf067cc3c8254ecc40bfa9",
      "original_line" : 97,
      "original_position" : 85,
      "original_start_line" : null,
      "path" : "test/functional/p2p_addr_relay.py",
      "position" : null,
      "pull_request_review_id" : 438791359,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/446668728",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r447658790"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/447658790"
         }
      },
      "author_association" : "MEMBER",
      "body" : "We iterated over this line a couple times with @MarcoFalke, so I'm out of ideas here.\r\nOpen to suggestions!",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-06-30T12:54:23Z",
      "diff_hunk" : "@@ -1433,7 +1435,11 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = static_cast<uint64_t>((current_time + std::chrono::seconds{static_cast<int64_t>(hashAddr)}) / ROTATE_ADDR_RELAY_DEST_INTERVAL);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r447658790",
      "id" : 447658790,
      "in_reply_to_id" : 446666126,
      "line" : 1441,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzY1ODc5MA==",
      "original_commit_id" : "177df94a6ccce896e3bf067cc3c8254ecc40bfa9",
      "original_line" : 1441,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 17,
      "pull_request_review_id" : 439982931,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-01T09:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/447658790",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jonatack addressed all the things.",
      "created_at" : "2020-07-01T10:10:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#issuecomment-652327720",
      "id" : 652327720,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18642",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1MjMyNzcyMA==",
      "updated_at" : "2020-07-01T10:10:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/652327720",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r451096710"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/451096710"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Annoyingly, I think this is UB, as hashAddr may exceed 2^63, and casting a larger number to a signed 64-bit integer would be outside its range (and overflowing signed integers is undefined behavior).\r\n\r\nSuggestion: `uint64_t time_addr = (current_time + std::chrono::seconds{hashAddr % ROTATE_ADDR_RELAY_DEST_INTERVAL.count()}) / ROTATE_ADDR_RELAY_DEST_INTERVAL;`, and make `ROTATE_ADDR_RELAY_DEST_INTERVAL` to be of type `std::chrono::seconds`.",
      "commit_id" : "72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-07-07T19:35:12Z",
      "diff_hunk" : "@@ -1433,7 +1435,11 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = static_cast<uint64_t>((current_time + std::chrono::seconds{static_cast<int64_t>(hashAddr)}) / ROTATE_ADDR_RELAY_DEST_INTERVAL);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r451096710",
      "id" : 451096710,
      "in_reply_to_id" : 446666126,
      "line" : 1441,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA5NjcxMA==",
      "original_commit_id" : "177df94a6ccce896e3bf067cc3c8254ecc40bfa9",
      "original_line" : 1441,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 17,
      "pull_request_review_id" : 444191165,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-07T19:35:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/451096710",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 72d7e2400759dacfc8860341d5bb90459e363a81. I only casually reviewed the tests.",
      "created_at" : "2020-09-30T19:17:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#issuecomment-701591535",
      "id" : 701591535,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18642",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMTU5MTUzNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-30T19:17:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/701591535",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 72d7e2400759dacfc8860341d5bb90459e363a81",
      "created_at" : "2020-10-01T08:04:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#issuecomment-701965127",
      "id" : 701965127,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18642",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMTk2NTEyNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-01T08:04:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/701965127",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2020-12-14T13:07:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#issuecomment-744427653",
      "id" : 744427653,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18642",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0NDQyNzY1Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-14T13:07:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/744427653",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Aside from this needing rebase for conflicts, can you rebase on master so that new CIs run. That should remove appveyor as well.",
      "created_at" : "2021-09-16T02:08:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#issuecomment-920518707",
      "id" : 920518707,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18642",
      "node_id" : "IC_kwDOABII58423gAz",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-16T02:08:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/920518707",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@naumenkogs Is this up for grabs?",
      "created_at" : "2021-09-22T07:36:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#issuecomment-924666057",
      "id" : 924666057,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18642",
      "node_id" : "IC_kwDOABII5843HUjJ",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-22T07:36:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/924666057",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Okay, it was hard to rebase @jonatack test contributed, but I just did it. Ready for review.",
      "created_at" : "2021-09-27T13:14:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#issuecomment-927863694",
      "id" : 927863694,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18642",
      "node_id" : "IC_kwDOABII5843ThOO",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-27T13:14:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/927863694",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r771999170"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771999170"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The `HALF_HOUR` constant doesn't seem to be used anywhere below, i.e. it can be removed.\r\n```suggestion\r\nONE_HOUR    = 60 * ONE_MINUTE\r\n```\r\n(or `6 * TEN_MINUTES`)",
      "commit_id" : "b3c71eafbeae8225d04aa91fd43f2ca7de704acf",
      "created_at" : "2021-12-19T20:50:25Z",
      "diff_hunk" : "@@ -21,8 +21,16 @@\n     P2P_SERVICES,\n )\n from test_framework.test_framework import BitcoinTestFramework\n-from test_framework.util import assert_equal, assert_greater_than\n+from test_framework.util import assert_equal, assert_greater_than, assert_greater_than_or_equal\n \n+ONE_MINUTE  = 60\n+TEN_MINUTES = 10 * ONE_MINUTE\n+HALF_HOUR   =  3 * TEN_MINUTES\n+ONE_HOUR    =  2 * HALF_HOUR",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r771999170",
      "id" : 771999170,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584uA8XC",
      "original_commit_id" : "7ba6b190b626095945a0637354ba61ba5ccce1ad",
      "original_line" : 29,
      "original_position" : 10,
      "original_start_line" : 28,
      "path" : "test/functional/p2p_addr_relay.py",
      "position" : null,
      "pull_request_review_id" : 835901571,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771999170/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-12-19T21:05:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771999170",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r771999430"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771999430"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit:\r\n```suggestion\r\nfrom test_framework.util import (\r\n    assert_equal,\r\n    assert_greater_than,\r\n    assert_greater_than_or_equal,\r\n)\r\n```",
      "commit_id" : "b3c71eafbeae8225d04aa91fd43f2ca7de704acf",
      "created_at" : "2021-12-19T20:53:19Z",
      "diff_hunk" : "@@ -21,8 +21,16 @@\n     P2P_SERVICES,\n )\n from test_framework.test_framework import BitcoinTestFramework\n-from test_framework.util import assert_equal, assert_greater_than\n+from test_framework.util import assert_equal, assert_greater_than, assert_greater_than_or_equal",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r771999430",
      "id" : 771999430,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584uA8bG",
      "original_commit_id" : "7ba6b190b626095945a0637354ba61ba5ccce1ad",
      "original_line" : 24,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/p2p_addr_relay.py",
      "position" : null,
      "pull_request_review_id" : 835901571,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771999430/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-19T21:05:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771999430",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@naumenkogs Is this up for grabs?",
      "created_at" : "2022-01-04T09:49:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#issuecomment-1004663352",
      "id" : 1004663352,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18642",
      "node_id" : "IC_kwDOABII58474fI4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1004663352/reactions"
      },
      "updated_at" : "2022-01-04T09:49:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1004663352",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke I mean, it's up-to-date (apart from those little nits) and reviewable.\r\nI probably don't have energy to nudge people for reviewing this, so if that makes it \"up for grabs\", then yes.",
      "created_at" : "2022-01-04T10:26:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#issuecomment-1004690277",
      "id" : 1004690277,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18642",
      "node_id" : "IC_kwDOABII58474ltl",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1004690277/reactions"
      },
      "updated_at" : "2022-01-04T10:26:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1004690277",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It would be good to reply to the comments. Either addressing them or denying/closing them.",
      "created_at" : "2022-01-04T10:29:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#issuecomment-1004692998",
      "id" : 1004692998,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18642",
      "node_id" : "IC_kwDOABII58474mYG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1004692998/reactions"
      },
      "updated_at" : "2022-01-04T10:29:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1004692998",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Or alternatively submit the test in a separate pull request, since this is refactoring, so the test should already pass on master.",
      "created_at" : "2022-01-04T11:10:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#issuecomment-1004719148",
      "id" : 1004719148,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18642",
      "node_id" : "IC_kwDOABII58474sws",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1004719148/reactions"
      },
      "updated_at" : "2022-01-04T11:10:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1004719148",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778299818"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778299818"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Can you explain why it is safe / defined behavior to perform a `static_cast<uint64_t>(std::chrono::seconds)`?  I can't figure out from reading https://en.cppreference.com/w/cpp/chrono/duration whether this is supposed to be defined, but maybe I'm missing something.",
      "commit_id" : "b3c71eafbeae8225d04aa91fd43f2ca7de704acf",
      "created_at" : "2022-01-04T18:29:17Z",
      "diff_hunk" : "@@ -1700,7 +1702,11 @@ void PeerManagerImpl::RelayAddress(NodeId originator,\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = m_connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = static_cast<uint64_t>((current_time + std::chrono::seconds{static_cast<int64_t>(hashAddr)}) / ROTATE_ADDR_RELAY_DEST_INTERVAL);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778299818",
      "id" : 778299818,
      "line" : 1708,
      "node_id" : "PRRC_kwDOABII584uY-mq",
      "original_commit_id" : "dd83d9f0506154d1598cecf7feca179a4fb45c32",
      "original_line" : 1708,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 19,
      "pull_request_review_id" : 843878849,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778299818/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-04T18:29:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778299818",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778305300"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778305300"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Sorry for the noise, @sipa explained this to me (the result of the division is being cast, which is not a duration but a number).",
      "commit_id" : "b3c71eafbeae8225d04aa91fd43f2ca7de704acf",
      "created_at" : "2022-01-04T18:38:46Z",
      "diff_hunk" : "@@ -1700,7 +1702,11 @@ void PeerManagerImpl::RelayAddress(NodeId originator,\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = m_connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = static_cast<uint64_t>((current_time + std::chrono::seconds{static_cast<int64_t>(hashAddr)}) / ROTATE_ADDR_RELAY_DEST_INTERVAL);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778305300",
      "id" : 778305300,
      "in_reply_to_id" : 778299818,
      "line" : 1708,
      "node_id" : "PRRC_kwDOABII584uY_8U",
      "original_commit_id" : "dd83d9f0506154d1598cecf7feca179a4fb45c32",
      "original_line" : 1708,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 19,
      "pull_request_review_id" : 843886770,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778305300/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-04T18:38:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778305300",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778306695"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778306695"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This isn't resolved actually; it's still casting `hashAddr` from `uint64_t` to `int64_t`, which is implementation-defined behavior if it overflows (I was wrong claiming earlier that it was UB; arithmetic that overflows signed types is UB, but just the conversion to a signed type is at worst implementation-defined).",
      "commit_id" : "b3c71eafbeae8225d04aa91fd43f2ca7de704acf",
      "created_at" : "2022-01-04T18:41:04Z",
      "diff_hunk" : "@@ -1433,7 +1435,11 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = static_cast<uint64_t>((current_time + std::chrono::seconds{static_cast<int64_t>(hashAddr)}) / ROTATE_ADDR_RELAY_DEST_INTERVAL);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778306695",
      "id" : 778306695,
      "in_reply_to_id" : 446666126,
      "line" : 1708,
      "node_id" : "PRRC_kwDOABII584uZASH",
      "original_commit_id" : "177df94a6ccce896e3bf067cc3c8254ecc40bfa9",
      "original_line" : 1708,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 19,
      "pull_request_review_id" : 843888787,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778306695/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-04T18:45:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778306695",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778322158"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778322158"
         }
      },
      "author_association" : "MEMBER",
      "body" : "We're constructing a `std::chrono::seconds` from an `int64_t`, but according to https://en.cppreference.com/w/cpp/chrono/duration, `std::chrono::seconds` is only guaranteed to have 35 bits -- is this problematic?",
      "commit_id" : "b3c71eafbeae8225d04aa91fd43f2ca7de704acf",
      "created_at" : "2022-01-04T19:06:31Z",
      "diff_hunk" : "@@ -1433,7 +1435,11 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = static_cast<uint64_t>((current_time + std::chrono::seconds{static_cast<int64_t>(hashAddr)}) / ROTATE_ADDR_RELAY_DEST_INTERVAL);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778322158",
      "id" : 778322158,
      "in_reply_to_id" : 446666126,
      "line" : 1708,
      "node_id" : "PRRC_kwDOABII584uZEDu",
      "original_commit_id" : "177df94a6ccce896e3bf067cc3c8254ecc40bfa9",
      "original_line" : 1708,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 19,
      "pull_request_review_id" : 843911055,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778322158/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-04T19:06:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778322158",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778343489"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778343489"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Uh, right. I think that could be a problem. This will need something like\r\n\r\n```c++\r\nuint64_t time_addr = (uint64_t{current_time / std::chrono::seconds{1}} + hashAddr) / (ROTATE_ADDR_RELAY_DEST_INTERVAL / std::chrono::seconds{1});\r\n```\r\n\r\n(I prefer using `x / std::chrono::seconds{1}` over `x.count()` to get the number of seconds of `x`, as the former expression remains meaningful if the type of `x` changes to something other than `std::chrono::seconds`).",
      "commit_id" : "b3c71eafbeae8225d04aa91fd43f2ca7de704acf",
      "created_at" : "2022-01-04T19:44:05Z",
      "diff_hunk" : "@@ -1433,7 +1435,11 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = static_cast<uint64_t>((current_time + std::chrono::seconds{static_cast<int64_t>(hashAddr)}) / ROTATE_ADDR_RELAY_DEST_INTERVAL);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778343489",
      "id" : 778343489,
      "in_reply_to_id" : 446666126,
      "line" : 1708,
      "node_id" : "PRRC_kwDOABII584uZJRB",
      "original_commit_id" : "177df94a6ccce896e3bf067cc3c8254ecc40bfa9",
      "original_line" : 1708,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 19,
      "pull_request_review_id" : 843941192,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778343489/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-04T19:44:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778343489",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778344158"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778344158"
         }
      },
      "author_association" : "MEMBER",
      "body" : "No need for the `<< 32` here, I think.",
      "commit_id" : "b3c71eafbeae8225d04aa91fd43f2ca7de704acf",
      "created_at" : "2022-01-04T19:45:24Z",
      "diff_hunk" : "@@ -1700,7 +1702,11 @@ void PeerManagerImpl::RelayAddress(NodeId originator,\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = m_connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = static_cast<uint64_t>((current_time + std::chrono::seconds{static_cast<int64_t>(hashAddr)}) / ROTATE_ADDR_RELAY_DEST_INTERVAL);\n+    const CSipHasher hasher = m_connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write(time_addr);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778344158",
      "id" : 778344158,
      "line" : 1709,
      "node_id" : "PRRC_kwDOABII584uZJbe",
      "original_commit_id" : "b3c71eafbeae8225d04aa91fd43f2ca7de704acf",
      "original_line" : 1709,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 20,
      "pull_request_review_id" : 843942227,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778344158/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-04T19:45:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778344158",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778628257"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778628257"
         }
      },
      "author_association" : "MEMBER",
      "body" : "My understanding was that `std::chrono::seconds{int64_t{}}` wouldn't compile on platforms where seconds isn't backed by at least 64 bits. I don't expect any such platform to exist.\r\n\r\n@ sipa there is also a `count_seconds()` helper.",
      "commit_id" : "b3c71eafbeae8225d04aa91fd43f2ca7de704acf",
      "created_at" : "2022-01-05T08:30:11Z",
      "diff_hunk" : "@@ -1433,7 +1435,11 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = static_cast<uint64_t>((current_time + std::chrono::seconds{static_cast<int64_t>(hashAddr)}) / ROTATE_ADDR_RELAY_DEST_INTERVAL);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778628257",
      "id" : 778628257,
      "in_reply_to_id" : 446666126,
      "line" : 1708,
      "node_id" : "PRRC_kwDOABII584uaOyh",
      "original_commit_id" : "177df94a6ccce896e3bf067cc3c8254ecc40bfa9",
      "original_line" : 1708,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 19,
      "pull_request_review_id" : 844328801,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778628257/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-05T08:30:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778628257",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Just to note `GetTime` is already mockable, so this only changes the type. Though, if this is too much hassle to get right and too hard to review (due to static_cast and `{}`-cast hell), then maybe leave the code as is and only add the test?\r\n\r\n",
      "created_at" : "2022-01-05T08:33:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#issuecomment-1005480927",
      "id" : 1005480927,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18642",
      "node_id" : "IC_kwDOABII58477mvf",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1005480927/reactions"
      },
      "updated_at" : "2022-01-05T08:33:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1005480927",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778630442"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778630442"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I've pulled that out into #23970, since it also resolves a sanitizer issue.",
      "commit_id" : "b3c71eafbeae8225d04aa91fd43f2ca7de704acf",
      "created_at" : "2022-01-05T08:33:39Z",
      "diff_hunk" : "@@ -1700,7 +1702,11 @@ void PeerManagerImpl::RelayAddress(NodeId originator,\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = m_connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = static_cast<uint64_t>((current_time + std::chrono::seconds{static_cast<int64_t>(hashAddr)}) / ROTATE_ADDR_RELAY_DEST_INTERVAL);\n+    const CSipHasher hasher = m_connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write(time_addr);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778630442",
      "id" : 778630442,
      "in_reply_to_id" : 778344158,
      "line" : 1709,
      "node_id" : "PRRC_kwDOABII584uaPUq",
      "original_commit_id" : "b3c71eafbeae8225d04aa91fd43f2ca7de704acf",
      "original_line" : 1709,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 20,
      "pull_request_review_id" : 844331674,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778630442/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-05T08:33:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778630442",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778677236"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778677236"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke does it mean i can leave it as it is here?",
      "commit_id" : "fca9977a1554c19a2b81df1fe3a29b3e892c924e",
      "created_at" : "2022-01-05T09:43:15Z",
      "diff_hunk" : "@@ -1700,7 +1702,11 @@ void PeerManagerImpl::RelayAddress(NodeId originator,\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = m_connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = static_cast<uint64_t>((current_time + std::chrono::seconds{static_cast<int64_t>(hashAddr)}) / ROTATE_ADDR_RELAY_DEST_INTERVAL);\n+    const CSipHasher hasher = m_connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write(time_addr);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778677236",
      "id" : 778677236,
      "in_reply_to_id" : 778344158,
      "line" : 1709,
      "node_id" : "PRRC_kwDOABII584uaav0",
      "original_commit_id" : "b3c71eafbeae8225d04aa91fd43f2ca7de704acf",
      "original_line" : 1709,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 20,
      "pull_request_review_id" : 844397768,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778677236/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-05T09:43:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778677236",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778678752"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778678752"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Github is weird, I found this un-resolved issue totally accidentally...",
      "commit_id" : "fca9977a1554c19a2b81df1fe3a29b3e892c924e",
      "created_at" : "2022-01-05T09:45:19Z",
      "diff_hunk" : "@@ -1433,7 +1435,11 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = static_cast<uint64_t>((current_time + std::chrono::seconds{static_cast<int64_t>(hashAddr)}) / ROTATE_ADDR_RELAY_DEST_INTERVAL);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778678752",
      "id" : 778678752,
      "in_reply_to_id" : 446666126,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584uabHg",
      "original_commit_id" : "177df94a6ccce896e3bf067cc3c8254ecc40bfa9",
      "original_line" : 1708,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 844399857,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778678752/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-05T09:45:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778678752",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778681127"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778681127"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You can either leave it as is or take it, but if you take it, make sure to also remove the suppression like in #23970.",
      "commit_id" : "fca9977a1554c19a2b81df1fe3a29b3e892c924e",
      "created_at" : "2022-01-05T09:48:25Z",
      "diff_hunk" : "@@ -1700,7 +1702,11 @@ void PeerManagerImpl::RelayAddress(NodeId originator,\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = m_connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = static_cast<uint64_t>((current_time + std::chrono::seconds{static_cast<int64_t>(hashAddr)}) / ROTATE_ADDR_RELAY_DEST_INTERVAL);\n+    const CSipHasher hasher = m_connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write(time_addr);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778681127",
      "id" : 778681127,
      "in_reply_to_id" : 778344158,
      "line" : 1709,
      "node_id" : "PRRC_kwDOABII584uabsn",
      "original_commit_id" : "b3c71eafbeae8225d04aa91fd43f2ca7de704acf",
      "original_line" : 1709,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 20,
      "pull_request_review_id" : 844402960,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778681127/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-05T09:48:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778681127",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778700091"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778700091"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Okay the latest version should be safe?",
      "commit_id" : "fca9977a1554c19a2b81df1fe3a29b3e892c924e",
      "created_at" : "2022-01-05T10:15:09Z",
      "diff_hunk" : "@@ -1433,7 +1435,11 @@ static void RelayAddress(const CAddress& addr, bool fReachable, const CConnman&\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n     uint64_t hashAddr = addr.GetHash();\n-    const CSipHasher hasher = connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr << 32).Write((GetTime() + hashAddr) / (24 * 60 * 60));\n+\n+    std::chrono::seconds current_time = GetTime<std::chrono::seconds>();\n+    // Adding address hash makes exact rotation time different per address, while preserving periodicity.\n+    uint64_t time_addr = static_cast<uint64_t>((current_time + std::chrono::seconds{static_cast<int64_t>(hashAddr)}) / ROTATE_ADDR_RELAY_DEST_INTERVAL);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778700091",
      "id" : 778700091,
      "in_reply_to_id" : 446666126,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584uagU7",
      "original_commit_id" : "177df94a6ccce896e3bf067cc3c8254ecc40bfa9",
      "original_line" : 1708,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 844429831,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778700091/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-05T10:15:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778700091",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778701909"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778701909"
         }
      },
      "author_association" : "MEMBER",
      "body" : "why is this changed? This also conflicts with #23832 ",
      "commit_id" : "fca9977a1554c19a2b81df1fe3a29b3e892c924e",
      "created_at" : "2022-01-05T10:17:34Z",
      "diff_hunk" : "@@ -124,7 +124,9 @@ static const unsigned int NODE_NETWORK_LIMITED_MIN_BLOCKS = 288;\n /** Average delay between local address broadcasts */\n static constexpr auto AVG_LOCAL_ADDRESS_BROADCAST_INTERVAL = 24h;\n /** Average delay between peer address broadcasts */\n-static constexpr auto AVG_ADDRESS_BROADCAST_INTERVAL = 30s;\n+static constexpr std::chrono::seconds AVG_ADDRESS_BROADCAST_INTERVAL{30};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778701909",
      "id" : 778701909,
      "line" : 127,
      "node_id" : "PRRC_kwDOABII584uagxV",
      "original_commit_id" : "fca9977a1554c19a2b81df1fe3a29b3e892c924e",
      "original_line" : 127,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 5,
      "pull_request_review_id" : 844432303,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778701909/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-05T10:17:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778701909",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778704550"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778704550"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think it was like that from the very beginning? But sure, I can drop this.",
      "commit_id" : "fca9977a1554c19a2b81df1fe3a29b3e892c924e",
      "created_at" : "2022-01-05T10:21:36Z",
      "diff_hunk" : "@@ -124,7 +124,9 @@ static const unsigned int NODE_NETWORK_LIMITED_MIN_BLOCKS = 288;\n /** Average delay between local address broadcasts */\n static constexpr auto AVG_LOCAL_ADDRESS_BROADCAST_INTERVAL = 24h;\n /** Average delay between peer address broadcasts */\n-static constexpr auto AVG_ADDRESS_BROADCAST_INTERVAL = 30s;\n+static constexpr std::chrono::seconds AVG_ADDRESS_BROADCAST_INTERVAL{30};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r778704550",
      "id" : 778704550,
      "in_reply_to_id" : 778701909,
      "line" : 127,
      "node_id" : "PRRC_kwDOABII584uaham",
      "original_commit_id" : "fca9977a1554c19a2b81df1fe3a29b3e892c924e",
      "original_line" : 127,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 5,
      "pull_request_review_id" : 844436308,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778704550/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-05T10:21:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778704550",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r779111624"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/779111624"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Using the `static constexpr auto NAME = <numer><suffix>;` as is used here is a bit more readable I think. I'd suggest using the same for the line below.",
      "commit_id" : "fca9977a1554c19a2b81df1fe3a29b3e892c924e",
      "created_at" : "2022-01-05T20:20:11Z",
      "diff_hunk" : "@@ -124,7 +124,9 @@ static const unsigned int NODE_NETWORK_LIMITED_MIN_BLOCKS = 288;\n /** Average delay between local address broadcasts */\n static constexpr auto AVG_LOCAL_ADDRESS_BROADCAST_INTERVAL = 24h;\n /** Average delay between peer address broadcasts */\n-static constexpr auto AVG_ADDRESS_BROADCAST_INTERVAL = 30s;\n+static constexpr std::chrono::seconds AVG_ADDRESS_BROADCAST_INTERVAL{30};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r779111624",
      "id" : 779111624,
      "in_reply_to_id" : 778701909,
      "line" : 127,
      "node_id" : "PRRC_kwDOABII584ucEzI",
      "original_commit_id" : "fca9977a1554c19a2b81df1fe3a29b3e892c924e",
      "original_line" : 127,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 5,
      "pull_request_review_id" : 845027096,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/779111624/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-05T20:20:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/779111624",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-01-06T01:38:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#issuecomment-1006214813",
      "id" : 1006214813,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18642",
      "node_id" : "IC_kwDOABII5847-Z6d",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1006214813/reactions"
      },
      "updated_at" : "2022-01-06T01:38:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1006214813",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r791536026"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/791536026"
         }
      },
      "author_association" : "MEMBER",
      "body" : "why is this changed?",
      "commit_id" : "f6177ff03967131e0e0c3430721157115fde8264",
      "created_at" : "2022-01-25T09:49:44Z",
      "diff_hunk" : "@@ -1746,8 +1748,12 @@ void PeerManagerImpl::RelayAddress(NodeId originator,\n     // Relay to a limited number of other nodes\n     // Use deterministic randomness to send to the same nodes for 24 hours\n     // at a time so the m_addr_knowns of the chosen nodes prevent repeats\n-    const uint64_t hashAddr{addr.GetHash()};\n-    const CSipHasher hasher{m_connman.GetDeterministicRandomizer(RANDOMIZER_ID_ADDRESS_RELAY).Write(hashAddr).Write((GetTime() + hashAddr) / (24 * 60 * 60))};\n+    uint64_t hashAddr = addr.GetHash();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#discussion_r791536026",
      "id" : 791536026,
      "line" : 1751,
      "node_id" : "PRRC_kwDOABII584vLeGa",
      "original_commit_id" : "f6177ff03967131e0e0c3430721157115fde8264",
      "original_line" : 1751,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 15,
      "pull_request_review_id" : 862032996,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18642",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/791536026/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-25T09:49:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/791536026",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-03-02T09:06:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18642#issuecomment-1056628946",
      "id" : 1056628946,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18642",
      "node_id" : "IC_kwDOABII584--uDS",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1056628946/reactions"
      },
      "updated_at" : "2022-03-02T09:06:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1056628946",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   }
]
