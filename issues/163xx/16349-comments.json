[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.",
      "created_at" : "2019-07-06T21:19:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#issuecomment-508954326",
      "id" : 508954326,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16349",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwODk1NDMyNg==",
      "updated_at" : "2019-07-24T02:46:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/508954326",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Can you explain why it fixes?",
      "created_at" : "2019-07-07T22:35:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#issuecomment-509036092",
      "id" : 509036092,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16349",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwOTAzNjA5Mg==",
      "updated_at" : "2019-07-07T22:35:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/509036092",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. I've tested that this PR fixes #15453 (running with `-nowallet` on Debian with Qt `5.7.1`). However I haven't yet checked for any regressions.\r\n\r\nI agree with promag that more of an explanation (also added to the PR body) would be good. Can you also try improve the commit title.",
      "created_at" : "2019-07-08T01:01:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#issuecomment-509046067",
      "id" : 509046067,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16349",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwOTA0NjA2Nw==",
      "updated_at" : "2019-07-08T01:01:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/509046067",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@promag \r\n> Can you explain why it fixes?\r\n\r\n@fanquake \r\n> I agree with **promag** that more of an explanation (also added to the PR body) would be good.\r\n\r\nTrying to investigate the #15453 bug I've [downloaded Qt 5.7.1](https://download.qt.io/archive/qt/5.7/5.7.1/), but [failed to build](https://github.com/bitcoin/bitcoin/issues/15453#issuecomment-508939324) the Bitcoin Core. I even failed to start Qt Creator (there are some similar messages on Qt bug tracker).\r\nSo, unfortunately, I have no clear explanation of such Qt 5.7.1 behavior for now.\r\n\r\nRegarding the code patch: the private slot `addWallet()` seems redundant in the master branch.",
      "created_at" : "2019-07-08T06:08:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#issuecomment-509091639",
      "id" : 509091639,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16349",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwOTA5MTYzOQ==",
      "updated_at" : "2019-07-08T06:08:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/509091639",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@fanquake \r\n>  Can you also try improve the commit title.\r\n\r\nWith my pleasure. What title could you suggest?",
      "created_at" : "2019-07-08T06:09:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#issuecomment-509091909",
      "id" : 509091909,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16349",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwOTA5MTkwOQ==",
      "updated_at" : "2019-07-08T06:10:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/509091909",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> What title could you suggest?\r\n\r\nMaybe: `qt: refactor WalletController to fix loading wallets when running with -nowallet`.\r\n\r\nThen you could extend the body text to be:\r\n\r\n> This establishes a parent-child relation between WalletController and WalletModel objects immediately. This fixes wallet loading on Debian when building against Qt 5.7.x and running with -nowallet.\r\n",
      "created_at" : "2019-07-08T12:05:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#issuecomment-509198025",
      "id" : 509198025,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16349",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwOTE5ODAyNQ==",
      "updated_at" : "2019-07-08T12:05:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/509198025",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "So this is only an issue with qt5.7.x?\r\n\r\nIf so, it could be tested by reverting depends to 2fca6568f27c9a1714b7a415cde947b79c10ed45 locally.",
      "created_at" : "2019-07-08T12:37:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#issuecomment-509207832",
      "id" : 509207832,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16349",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwOTIwNzgzMg==",
      "updated_at" : "2019-07-08T12:39:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/509207832",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@promag regarding the [IRC discussion](http://www.erisian.com.au/bitcoin-core-dev/log-2019-07-08.html#l-149):\r\n\r\n1. you are definitely right: a `WalletController` instance thread affinity and the current running thread could (and mostly are) different;\r\n\r\n2. the _only_ reason of these lines\r\nhttps://github.com/bitcoin/bitcoin/blob/2679bb8919b5089f8067ccfd94f766747b8df671/src/qt/walletcontroller.cpp#L121-L128\r\nis to `Q_EMIT walletAdded(wallet_model);` in a thread-safe manner;\r\n\r\n3. in this PR the next line is also thread-safe by default:\r\nhttps://github.com/bitcoin/bitcoin/blob/1b83875006749d79916af0197bed65aecdc7ff17/src/qt/walletcontroller.cpp#L121",
      "created_at" : "2019-07-08T16:49:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#issuecomment-509304198",
      "id" : 509304198,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16349",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwOTMwNDE5OA==",
      "updated_at" : "2019-07-08T16:49:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/509304198",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "As #15453 is fixed in https://github.com/bitcoin/bitcoin/pull/16348#issuecomment-509308347 I have updated the OP and the commit message.\r\n\r\nPlease, label this PR as refactoring.",
      "created_at" : "2019-07-08T17:18:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#issuecomment-509315321",
      "id" : 509315321,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16349",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwOTMxNTMyMQ==",
      "updated_at" : "2019-07-08T17:18:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/509315321",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This is useful for reviewers: https://code.woboq.org/qt5/qtbase/src/corelib/kernel/qobject.cpp.html#_ZN7QObject12moveToThreadEP7QThread",
      "created_at" : "2019-07-09T08:18:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#issuecomment-509541347",
      "id" : 509541347,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16349",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwOTU0MTM0Nw==",
      "updated_at" : "2019-07-09T08:18:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/509541347",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased on top of #16348.",
      "created_at" : "2019-07-09T12:55:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#issuecomment-509630446",
      "id" : 509630446,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16349",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwOTYzMDQ0Ng==",
      "updated_at" : "2019-07-09T12:55:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/509630446",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@ryanofsky Would you mind reviewing this PR?",
      "created_at" : "2019-07-09T12:58:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#issuecomment-509631505",
      "id" : 509631505,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16349",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwOTYzMTUwNQ==",
      "updated_at" : "2019-07-09T12:58:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/509631505",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r301574549"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301574549"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Could keep this comment.",
      "commit_id" : "6285a318d77dbfdf50f893963ebfb2973746f757",
      "created_at" : "2019-07-09T13:05:58Z",
      "diff_hunk" : "@@ -119,25 +121,11 @@ WalletModel* WalletController::getOrCreateWallet(std::unique_ptr<interfaces::Wal\n     connect(wallet_model, &WalletModel::coinsSent, this, &WalletController::coinsSent);\n \n     // Notify walletAdded signal on the GUI thread.\n-    if (QThread::currentThread() == thread()) {\n-        addWallet(wallet_model);\n-    } else {\n-        // Handler callback runs in a different thread so fix wallet model thread affinity.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r301574549",
      "id" : 301574549,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMTU3NDU0OQ==",
      "original_commit_id" : "225ff6b28a80431a400806015cb1e1107ec3e8a5",
      "original_position" : 16,
      "path" : "src/qt/walletcontroller.cpp",
      "position" : 17,
      "pull_request_review_id" : 259486371,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349",
      "updated_at" : "2019-07-09T13:32:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301574549",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r301575906"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301575906"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Just to be clear, this would work even without `qRegisterMetaType<WalletModel*>()` added in #16348?",
      "commit_id" : "6285a318d77dbfdf50f893963ebfb2973746f757",
      "created_at" : "2019-07-09T13:08:45Z",
      "diff_hunk" : "@@ -119,25 +121,11 @@ WalletModel* WalletController::getOrCreateWallet(std::unique_ptr<interfaces::Wal\n     connect(wallet_model, &WalletModel::coinsSent, this, &WalletController::coinsSent);\n \n     // Notify walletAdded signal on the GUI thread.\n-    if (QThread::currentThread() == thread()) {\n-        addWallet(wallet_model);\n-    } else {\n-        // Handler callback runs in a different thread so fix wallet model thread affinity.\n-        wallet_model->moveToThread(thread());\n-        bool invoked = QMetaObject::invokeMethod(this, \"addWallet\", Qt::QueuedConnection, Q_ARG(WalletModel*, wallet_model));\n-        assert(invoked);\n-    }\n+    Q_EMIT walletAdded(wallet_model);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r301575906",
      "id" : 301575906,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMTU3NTkwNg==",
      "original_commit_id" : "225ff6b28a80431a400806015cb1e1107ec3e8a5",
      "original_position" : 21,
      "path" : "src/qt/walletcontroller.cpp",
      "position" : 22,
      "pull_request_review_id" : 259488077,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349",
      "updated_at" : "2019-07-09T13:32:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301575906",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r301580912"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301580912"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes.",
      "commit_id" : "6285a318d77dbfdf50f893963ebfb2973746f757",
      "created_at" : "2019-07-09T13:19:28Z",
      "diff_hunk" : "@@ -119,25 +121,11 @@ WalletModel* WalletController::getOrCreateWallet(std::unique_ptr<interfaces::Wal\n     connect(wallet_model, &WalletModel::coinsSent, this, &WalletController::coinsSent);\n \n     // Notify walletAdded signal on the GUI thread.\n-    if (QThread::currentThread() == thread()) {\n-        addWallet(wallet_model);\n-    } else {\n-        // Handler callback runs in a different thread so fix wallet model thread affinity.\n-        wallet_model->moveToThread(thread());\n-        bool invoked = QMetaObject::invokeMethod(this, \"addWallet\", Qt::QueuedConnection, Q_ARG(WalletModel*, wallet_model));\n-        assert(invoked);\n-    }\n+    Q_EMIT walletAdded(wallet_model);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r301580912",
      "id" : 301580912,
      "in_reply_to_id" : 301575906,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMTU4MDkxMg==",
      "original_commit_id" : "225ff6b28a80431a400806015cb1e1107ec3e8a5",
      "original_position" : 21,
      "path" : "src/qt/walletcontroller.cpp",
      "position" : 22,
      "pull_request_review_id" : 259494402,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349",
      "updated_at" : "2019-07-09T13:32:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301580912",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r301585287"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301585287"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "6285a318d77dbfdf50f893963ebfb2973746f757",
      "created_at" : "2019-07-09T13:27:37Z",
      "diff_hunk" : "@@ -119,25 +121,11 @@ WalletModel* WalletController::getOrCreateWallet(std::unique_ptr<interfaces::Wal\n     connect(wallet_model, &WalletModel::coinsSent, this, &WalletController::coinsSent);\n \n     // Notify walletAdded signal on the GUI thread.\n-    if (QThread::currentThread() == thread()) {\n-        addWallet(wallet_model);\n-    } else {\n-        // Handler callback runs in a different thread so fix wallet model thread affinity.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r301585287",
      "id" : 301585287,
      "in_reply_to_id" : 301574549,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMTU4NTI4Nw==",
      "original_commit_id" : "225ff6b28a80431a400806015cb1e1107ec3e8a5",
      "original_position" : 16,
      "path" : "src/qt/walletcontroller.cpp",
      "position" : 17,
      "pull_request_review_id" : 259499622,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349",
      "updated_at" : "2019-07-09T13:32:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301585287",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "s/signal/slot in PR title and commit message?",
      "created_at" : "2019-07-09T13:29:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#issuecomment-509642578",
      "id" : 509642578,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16349",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwOTY0MjU3OA==",
      "updated_at" : "2019-07-09T13:29:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/509642578",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@promag \r\n> s/signal/slot in PR title and commit message?\r\n\r\nSure ;) Thank you.\r\nDone.\r\n",
      "created_at" : "2019-07-09T13:33:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#issuecomment-509643930",
      "id" : 509643930,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16349",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwOTY0MzkzMA==",
      "updated_at" : "2019-07-09T13:33:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/509643930",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 6285a318d77dbfdf50f893963ebfb2973746f757.",
      "created_at" : "2019-07-09T13:57:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#issuecomment-509653291",
      "id" : 509653291,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16349",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwOTY1MzI5MQ==",
      "updated_at" : "2019-07-09T13:57:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/509653291",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r301632632"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301632632"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This comment is very vague. In particular it's not clear what \"handler callback runs in a different thread\" is referring to. If I'm understanding this correctly, I think a comment that specifically says which threads the object is being moved to and from would be more helpful:\r\n\r\n```c++\r\n// Move WalletModel object to the thread that created the WalletController\r\n// object (GUI main thread), instead of the current thread, which could be\r\n// an outside wallet thread or RPC thread sending a LoadWallet notification.\r\n//\r\n// This ensures queued signals sent to the WalletModel object will be\r\n// handled on the GUI event loop, see\r\n// https://doc.qt.io/qt-5/threads-qobject.html#signals-and-slots-across-threads\r\n```",
      "commit_id" : "6285a318d77dbfdf50f893963ebfb2973746f757",
      "created_at" : "2019-07-09T14:55:21Z",
      "diff_hunk" : "@@ -99,6 +99,9 @@ WalletModel* WalletController::getOrCreateWallet(std::unique_ptr<interfaces::Wal\n \n     // Instantiate model and register it.\n     WalletModel* wallet_model = new WalletModel(std::move(wallet), m_node, m_platform_style, m_options_model, nullptr);\n+    // Handler callback runs in a different thread so fix wallet model thread affinity.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r301632632",
      "id" : 301632632,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMTYzMjYzMg==",
      "original_commit_id" : "6285a318d77dbfdf50f893963ebfb2973746f757",
      "original_position" : 4,
      "path" : "src/qt/walletcontroller.cpp",
      "position" : 4,
      "pull_request_review_id" : 259560078,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349",
      "updated_at" : "2019-07-09T16:09:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301632632",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r301644943"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301644943"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Curious: Is this `setParent` call actually necessary for anything? Maybe consider dropping it or adding a comment that says why it's useful.\r\n\r\nIf you will keep this line, it'd also be helpful to have a comment explaining why we are passing `parent=nullptr` to the constructor above, and then changing the parent later. I am guessing from https://doc.qt.io/qt-5/qobject.html#thread-affinity, that it is because \"All QObjects must live in the same thread as their parent\" and so this is necessary to avoid a \"QObject: Cannot create children for a parent that is in a different thread\" error.",
      "commit_id" : "6285a318d77dbfdf50f893963ebfb2973746f757",
      "created_at" : "2019-07-09T15:16:47Z",
      "diff_hunk" : "@@ -99,6 +99,9 @@ WalletModel* WalletController::getOrCreateWallet(std::unique_ptr<interfaces::Wal\n \n     // Instantiate model and register it.\n     WalletModel* wallet_model = new WalletModel(std::move(wallet), m_node, m_platform_style, m_options_model, nullptr);\n+    // Handler callback runs in a different thread so fix wallet model thread affinity.\n+    wallet_model->moveToThread(thread());\n+    wallet_model->setParent(this);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r301644943",
      "id" : 301644943,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMTY0NDk0Mw==",
      "original_commit_id" : "6285a318d77dbfdf50f893963ebfb2973746f757",
      "original_position" : 6,
      "path" : "src/qt/walletcontroller.cpp",
      "position" : 6,
      "pull_request_review_id" : 259560078,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349",
      "updated_at" : "2019-07-09T16:09:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301644943",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r301653309"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301653309"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It seems like this comment is obsolete and should be dropped.",
      "commit_id" : "6285a318d77dbfdf50f893963ebfb2973746f757",
      "created_at" : "2019-07-09T15:32:26Z",
      "diff_hunk" : "@@ -119,25 +122,11 @@ WalletModel* WalletController::getOrCreateWallet(std::unique_ptr<interfaces::Wal\n     connect(wallet_model, &WalletModel::coinsSent, this, &WalletController::coinsSent);\n \n     // Notify walletAdded signal on the GUI thread.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r301653309",
      "id" : 301653309,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMTY1MzMwOQ==",
      "original_commit_id" : "6285a318d77dbfdf50f893963ebfb2973746f757",
      "original_position" : 13,
      "path" : "src/qt/walletcontroller.cpp",
      "position" : 13,
      "pull_request_review_id" : 259560078,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349",
      "updated_at" : "2019-07-09T16:09:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301653309",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r301654534"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301654534"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It seems good to get rid of this, but I can't figure out why it was ever necessary to call addWallet here with invokeMethod instead of directly.",
      "commit_id" : "6285a318d77dbfdf50f893963ebfb2973746f757",
      "created_at" : "2019-07-09T15:34:41Z",
      "diff_hunk" : "@@ -119,25 +122,11 @@ WalletModel* WalletController::getOrCreateWallet(std::unique_ptr<interfaces::Wal\n     connect(wallet_model, &WalletModel::coinsSent, this, &WalletController::coinsSent);\n \n     // Notify walletAdded signal on the GUI thread.\n-    if (QThread::currentThread() == thread()) {\n-        addWallet(wallet_model);\n-    } else {\n-        // Handler callback runs in a different thread so fix wallet model thread affinity.\n-        wallet_model->moveToThread(thread());\n-        bool invoked = QMetaObject::invokeMethod(this, \"addWallet\", Qt::QueuedConnection, Q_ARG(WalletModel*, wallet_model));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r301654534",
      "id" : 301654534,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMTY1NDUzNA==",
      "original_commit_id" : "6285a318d77dbfdf50f893963ebfb2973746f757",
      "original_position" : 19,
      "path" : "src/qt/walletcontroller.cpp",
      "position" : 19,
      "pull_request_review_id" : 259560078,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349",
      "updated_at" : "2019-07-09T16:09:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301654534",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r301679192"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301679192"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Exactly, can't set parent on constructor because parent thread can be different.\r\n\r\n`setParent` is not necessary at the moment because (afaict) the wallet is always unloaded here:\r\nhttps://github.com/bitcoin/bitcoin/blob/8046a3e0befeea641b6309bc0c742b7481e681d9/src/qt/walletcontroller.cpp#L104\r\n\r\nHowever I think it's good habit to set ownership, so at least the following would release all models:\r\nhttps://github.com/bitcoin/bitcoin/blob/8046a3e0befeea641b6309bc0c742b7481e681d9/src/qt/bitcoin.cpp#L216\r\n\r\n",
      "commit_id" : "6285a318d77dbfdf50f893963ebfb2973746f757",
      "created_at" : "2019-07-09T16:25:40Z",
      "diff_hunk" : "@@ -99,6 +99,9 @@ WalletModel* WalletController::getOrCreateWallet(std::unique_ptr<interfaces::Wal\n \n     // Instantiate model and register it.\n     WalletModel* wallet_model = new WalletModel(std::move(wallet), m_node, m_platform_style, m_options_model, nullptr);\n+    // Handler callback runs in a different thread so fix wallet model thread affinity.\n+    wallet_model->moveToThread(thread());\n+    wallet_model->setParent(this);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r301679192",
      "id" : 301679192,
      "in_reply_to_id" : 301644943,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMTY3OTE5Mg==",
      "original_commit_id" : "6285a318d77dbfdf50f893963ebfb2973746f757",
      "original_position" : 6,
      "path" : "src/qt/walletcontroller.cpp",
      "position" : 6,
      "pull_request_review_id" : 259618151,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349",
      "updated_at" : "2019-07-09T16:25:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301679192",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> It would be better if wallet notifications just emitted signals that got handled asynchronously in the GUI. \r\n\r\n@ryanofsky IIRC I had some problems with this because of `std::unique_ptr<interfaces::Wallet>`, it was easier to instantiate the `WalletModel` and then send to the GUI thread by invoking `addWallet`.\r\n\r\nFrom https://github.com/bitcoin/bitcoin/pull/16349#discussion_r301654534\r\n\r\n> It seems good to get rid of this, but I can't figure out why it was ever necessary to call addWallet here with invokeMethod instead of directly.\r\n\r\nAt the time the idea was to allow (and prevent issues) `connect(..., &WalletController::walletAdded, ..., Qt::DirectConnection)`.\r\n\r\nBut agree, this code can be improved.",
      "created_at" : "2019-07-09T16:36:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#issuecomment-509715981",
      "id" : 509715981,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16349",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwOTcxNTk4MQ==",
      "updated_at" : "2019-07-09T16:36:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/509715981",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r303212806"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/303212806"
         }
      },
      "author_association" : "MEMBER",
      "body" : "PR description has been updated.",
      "commit_id" : "6285a318d77dbfdf50f893963ebfb2973746f757",
      "created_at" : "2019-07-13T17:33:40Z",
      "diff_hunk" : "@@ -99,6 +99,9 @@ WalletModel* WalletController::getOrCreateWallet(std::unique_ptr<interfaces::Wal\n \n     // Instantiate model and register it.\n     WalletModel* wallet_model = new WalletModel(std::move(wallet), m_node, m_platform_style, m_options_model, nullptr);\n+    // Handler callback runs in a different thread so fix wallet model thread affinity.\n+    wallet_model->moveToThread(thread());\n+    wallet_model->setParent(this);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r303212806",
      "id" : 303212806,
      "in_reply_to_id" : 301644943,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMzIxMjgwNg==",
      "original_commit_id" : "6285a318d77dbfdf50f893963ebfb2973746f757",
      "original_position" : 6,
      "path" : "src/qt/walletcontroller.cpp",
      "position" : 6,
      "pull_request_review_id" : 261550103,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349",
      "updated_at" : "2019-07-13T17:33:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/303212806",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r303212903"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/303212903"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Agree, but I'd leave it to preserve ACKs.",
      "commit_id" : "6285a318d77dbfdf50f893963ebfb2973746f757",
      "created_at" : "2019-07-13T17:36:39Z",
      "diff_hunk" : "@@ -119,25 +122,11 @@ WalletModel* WalletController::getOrCreateWallet(std::unique_ptr<interfaces::Wal\n     connect(wallet_model, &WalletModel::coinsSent, this, &WalletController::coinsSent);\n \n     // Notify walletAdded signal on the GUI thread.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r303212903",
      "id" : 303212903,
      "in_reply_to_id" : 301653309,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMzIxMjkwMw==",
      "original_commit_id" : "6285a318d77dbfdf50f893963ebfb2973746f757",
      "original_position" : 13,
      "path" : "src/qt/walletcontroller.cpp",
      "position" : 13,
      "pull_request_review_id" : 261550214,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349",
      "updated_at" : "2019-07-13T17:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/303212903",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r303213007"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/303213007"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> This comment is very vague.\r\n\r\nAgree, but I'd leave it to preserve ACKs.",
      "commit_id" : "6285a318d77dbfdf50f893963ebfb2973746f757",
      "created_at" : "2019-07-13T17:40:15Z",
      "diff_hunk" : "@@ -99,6 +99,9 @@ WalletModel* WalletController::getOrCreateWallet(std::unique_ptr<interfaces::Wal\n \n     // Instantiate model and register it.\n     WalletModel* wallet_model = new WalletModel(std::move(wallet), m_node, m_platform_style, m_options_model, nullptr);\n+    // Handler callback runs in a different thread so fix wallet model thread affinity.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16349#discussion_r303213007",
      "id" : 303213007,
      "in_reply_to_id" : 301632632,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMzIxMzAwNw==",
      "original_commit_id" : "6285a318d77dbfdf50f893963ebfb2973746f757",
      "original_position" : 4,
      "path" : "src/qt/walletcontroller.cpp",
      "position" : 4,
      "pull_request_review_id" : 261550341,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16349",
      "updated_at" : "2019-07-13T17:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/303213007",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   }
]
