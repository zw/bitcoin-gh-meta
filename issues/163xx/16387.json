{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "New macOS releases have historically led to unpleasant surprises, so I decided to run the beta on an older machine. I installed both the beta of macOS and Xcode, and made the latter default using `sudo xcode-select --switch /Applications/Xcode-beta.app/Contents/Developer`. \r\n\r\nNote that Apple switched the default shell to zsh: https://support.apple.com/kb/HT208050\r\n\r\n## Beta 3\r\n\r\nTL&DR: binaries still work, but building QT from source doesn't and depends seems broken\r\n\r\nThe existing binary on my system kept working fine. I was also able to download and install v0.18 from [bitcoincore.org](https://bitcoincore.org/en/download/).\r\n\r\nCompling master (536590f358dc3d3e5821eba7f1009452ea93b205) from source source fails, see ([log](https://gist.github.com/Sjors/8257c37c48acb38e8a6c81e410dcb7b3#file-make-log)).\r\n\r\nUsing Homebrew with `boost` 1.70.0 and qt `5.13.0`.\r\n\r\nThe tests produce a  bunch of warnings:\r\n\r\n```\r\ntest/util_threadnames_tests.cpp:64:5: note: in instantiation of function template specialization 'boost::test_tools::tt_detail::check_frwd<boost::test_tools::tt_detail::equal_impl_frwd, unsigned long, int>' requested here\r\n    BOOST_CHECK_EQUAL(names.size(), 100);\r\n    ^\r\n/usr/local/include/boost/test/tools/old/interface.hpp:154:45: note: expanded from macro 'BOOST_CHECK_EQUAL'\r\n#define BOOST_CHECK_EQUAL( L, R )           BOOST_TEST_TOOL_IMPL( 0, \\\r\n                                            ^\r\n/usr/local/include/boost/test/tools/old/interface.hpp:67:47: note: expanded from macro 'BOOST_TEST_TOOL_IMPL'\r\n    BOOST_PP_IF( frwd_type, report_assertion, check_frwd ) (                    \\\r\n```\r\n\r\nThese warnings also occur in the Solaris problem in #15708.\r\n\r\nQT produces warnings:\r\n```\r\n  CXX      qt/libbitcoinqt_a-bitcoinunits.o\r\nqt/bitcoinamountfield.cpp:124:24: warning: 'width' is deprecated: Use QFontMetrics::horizontalAdvance [-Wdeprecated-declarations]\r\n            int w = fm.width(BitcoinUnits::format(BitcoinUnits::BTC, BitcoinUnits::maxMoney(), false, BitcoinUnits::separatorAlways));\r\n                       ^\r\n/usr/local/Cellar/qt/5.13.0/lib/QtGui.framework/Headers/qfontmetrics.h:107:5: note: 'width' has been explicitly marked deprecated here\r\n    QT_DEPRECATED_X(\"Use QFontMetrics::horizontalAdvance\")\r\n    ^\r\n/usr/local/Cellar/qt/5.13.0/lib/QtCore.framework/Headers/qglobal.h:294:33: note: expanded from macro 'QT_DEPRECATED_X'\r\n#  define QT_DEPRECATED_X(text) Q_DECL_DEPRECATED_X(text)\r\n                                ^\r\n/usr/local/Cellar/qt/5.13.0/lib/QtCore.framework/Headers/qcompilerdetection.h:649:55: note: expanded from macro 'Q_DECL_DEPRECATED_X'\r\n#    define Q_DECL_DEPRECATED_X(text) __attribute__ ((__deprecated__(text)))\r\n                                                      ^\r\n```\r\n\r\nAnd finally QT throws an error:\r\n\r\n```\r\n  CXX      qt/libbitcoinqt_a-networkstyle.o\r\nqt/guiutil.cpp:365:14: error: no matching function for call to 'objc_msgSend'\r\n    id app = objc_msgSend((id) objc_getClass(\"NSApplication\"), sel_registerName(\"sharedApplication\"));\r\n             ^~~~~~~~~~~~\r\n/Applications/Xcode-beta.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include/objc/message.h:63:1: note: candidate function not viable: requires 0 arguments, but 2 were provided\r\nobjc_msgSend(void /* id self, SEL op, ... */ )\r\n^\r\nqt/guiutil.cpp:366:5: error: no matching function for call to 'objc_msgSend'\r\n    objc_msgSend(app, sel_registerName(\"activateIgnoringOtherApps:\"), YES);\r\n    ^~~~~~~~~~~~\r\n/Applications/Xcode-beta.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include/objc/message.h:63:1: note: candidate function not viable: requires 0 arguments, but 3 were provided\r\nobjc_msgSend(void /* id self, SEL op, ... */ )\r\n^\r\n2 errors generated.\r\nmake[2]: *** [qt/libbitcoinqt_a-guiutil.o] Error 1\r\n```\r\n\r\nI can `./configure --without-gui` and run the test suite.\r\n\r\nI reinstalled all of homebrew, but still get the above warnings and errors. \r\n\r\nUsing depends instead, I'm unable to build protobuf (see [log](https://gist.github.com/Sjors/8257c37c48acb38e8a6c81e410dcb7b3#file-depends-protobuf-log)). When I strip out protobuf, Boost fails in the same way as #13601 ([log](https://gist.github.com/Sjors/8257c37c48acb38e8a6c81e410dcb7b3#file-depends-boost-log)). However in this case `xcode-select --install` doesn't make the issue go away, and the other workaround `/Library/Developer/CommandLineTools/Packages/macOS_SDK_headers_for_macOS_10.14.pkg` no longer exists. See also [this dicussion](http://cmake.3232098.n2.nabble.com/Linking-on-OSX-tt7599565.html#a7599590).",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 1,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16387/comments",
   "created_at" : "2019-07-14T12:04:42Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16387/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/16387",
   "id" : 467828303,
   "labels" : [
      {
         "color" : "660000",
         "default" : false,
         "id" : 234879,
         "name" : "macOS",
         "node_id" : "MDU6TGFiZWwyMzQ4Nzk=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/macOS"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16387/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDU6SXNzdWU0Njc4MjgzMDM=",
   "number" : 16387,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "macOS Catalina",
   "updated_at" : "2019-07-16T23:20:47Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16387",
   "user" : {
      "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
      "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
      "followers_url" : "https://api.github.com/users/Sjors/followers",
      "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/Sjors",
      "id" : 10217,
      "login" : "Sjors",
      "node_id" : "MDQ6VXNlcjEwMjE3",
      "organizations_url" : "https://api.github.com/users/Sjors/orgs",
      "received_events_url" : "https://api.github.com/users/Sjors/received_events",
      "repos_url" : "https://api.github.com/users/Sjors/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/Sjors"
   }
}
