[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16333#discussion_r299975273"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16333"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/299975273"
         }
      },
      "author_association" : "MEMBER",
      "body" : "please document why",
      "commit_id" : "48ed8fd170f5bfef19e437f4301c82633296504a",
      "created_at" : "2019-07-03T14:06:00Z",
      "diff_hunk" : "@@ -91,29 +92,22 @@ def add_witness_commitment(block, nonce=0):\n     block.hashMerkleRoot = block.calc_merkle_root()\n     block.rehash()\n \n-def serialize_script_num(value):\n-    r = bytearray(0)\n-    if value == 0:\n-        return r\n-    neg = value < 0\n-    absvalue = -value if neg else value\n-    while (absvalue):\n-        r.append(int(absvalue & 0xff))\n-        absvalue >>= 8\n-    if r[-1] & 0x80:\n-        r.append(0x80 if neg else 0)\n-    elif neg:\n-        r[-1] |= 0x80\n-    return r\n+\n+def script_BIP34_coinbase_height(height):\n+    if height <= 16:\n+        res = CScriptOp.encode_op_n(height)\n+        # Append dummy to increase scriptSig size above 2",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16333#discussion_r299975273",
      "id" : 299975273,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI5OTk3NTI3Mw==",
      "original_commit_id" : "faa2e0d668b2568021a3872ae0d48ec161781605",
      "original_position" : 38,
      "path" : "test/functional/test_framework/blocktools.py",
      "position" : null,
      "pull_request_review_id" : 257511187,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16333",
      "updated_at" : "2019-07-09T18:55:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/299975273",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16333#discussion_r299987349"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16333"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/299987349"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't know the reason for this. The rule was added by satoshi in the first commit https://github.com/bitcoin/bitcoin/blame/5b721607b1057df4dfe97f80d235ed372312f398/main.h#L495",
      "commit_id" : "48ed8fd170f5bfef19e437f4301c82633296504a",
      "created_at" : "2019-07-03T14:27:58Z",
      "diff_hunk" : "@@ -91,29 +92,22 @@ def add_witness_commitment(block, nonce=0):\n     block.hashMerkleRoot = block.calc_merkle_root()\n     block.rehash()\n \n-def serialize_script_num(value):\n-    r = bytearray(0)\n-    if value == 0:\n-        return r\n-    neg = value < 0\n-    absvalue = -value if neg else value\n-    while (absvalue):\n-        r.append(int(absvalue & 0xff))\n-        absvalue >>= 8\n-    if r[-1] & 0x80:\n-        r.append(0x80 if neg else 0)\n-    elif neg:\n-        r[-1] |= 0x80\n-    return r\n+\n+def script_BIP34_coinbase_height(height):\n+    if height <= 16:\n+        res = CScriptOp.encode_op_n(height)\n+        # Append dummy to increase scriptSig size above 2",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16333#discussion_r299987349",
      "id" : 299987349,
      "in_reply_to_id" : 299975273,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI5OTk4NzM0OQ==",
      "original_commit_id" : "faa2e0d668b2568021a3872ae0d48ec161781605",
      "original_position" : 38,
      "path" : "test/functional/test_framework/blocktools.py",
      "position" : null,
      "pull_request_review_id" : 257526826,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16333",
      "updated_at" : "2019-07-09T18:55:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/299987349",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16333#discussion_r299988583"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16333"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/299988583"
         }
      },
      "author_association" : "MEMBER",
      "body" : "this doesn't look like an improvement in readability, might want to surround this table with `// clang-format off` and `// clang-format on`",
      "commit_id" : "48ed8fd170f5bfef19e437f4301c82633296504a",
      "created_at" : "2019-07-03T14:30:02Z",
      "diff_hunk" : "@@ -46,39 +46,26 @@ static BlockAssembler AssemblerForTest(const CChainParams& params) {\n     return BlockAssembler(params, options);\n }\n \n-static\n-struct {\n+constexpr static struct {\n     unsigned char extranonce;\n     unsigned int nonce;\n-} blockinfo[] = {\n-    {4, 0xa4a3e223}, {2, 0x15c32f9e}, {1, 0x0375b547}, {1, 0x7004a8a5},\n-    {2, 0xce440296}, {2, 0x52cfe198}, {1, 0x77a72cd0}, {2, 0xbb5d6f84},\n-    {2, 0x83f30c2c}, {1, 0x48a73d5b}, {1, 0xef7dcd01}, {2, 0x6809c6c4},\n-    {2, 0x0883ab3c}, {1, 0x087bbbe2}, {2, 0x2104a814}, {2, 0xdffb6daa},\n-    {1, 0xee8a0a08}, {2, 0xba4237c1}, {1, 0xa70349dc}, {1, 0x344722bb},\n-    {3, 0xd6294733}, {2, 0xec9f5c94}, {2, 0xca2fbc28}, {1, 0x6ba4f406},\n-    {2, 0x015d4532}, {1, 0x6e119b7c}, {2, 0x43e8f314}, {2, 0x27962f38},\n-    {2, 0xb571b51b}, {2, 0xb36bee23}, {2, 0xd17924a8}, {2, 0x6bc212d9},\n-    {1, 0x630d4948}, {2, 0x9a4c4ebb}, {2, 0x554be537}, {1, 0xd63ddfc7},\n-    {2, 0xa10acc11}, {1, 0x759a8363}, {2, 0xfb73090d}, {1, 0xe82c6a34},\n-    {1, 0xe33e92d7}, {3, 0x658ef5cb}, {2, 0xba32ff22}, {5, 0x0227a10c},\n-    {1, 0xa9a70155}, {5, 0xd096d809}, {1, 0x37176174}, {1, 0x830b8d0f},\n-    {1, 0xc6e3910e}, {2, 0x823f3ca8}, {1, 0x99850849}, {1, 0x7521fb81},\n-    {1, 0xaacaabab}, {1, 0xd645a2eb}, {5, 0x7aea1781}, {5, 0x9d6e4b78},\n-    {1, 0x4ce90fd8}, {1, 0xabdc832d}, {6, 0x4a34f32a}, {2, 0xf2524c1c},\n-    {2, 0x1bbeb08a}, {1, 0xad47f480}, {1, 0x9f026aeb}, {1, 0x15a95049},\n-    {2, 0xd1cb95b2}, {2, 0xf84bbda5}, {1, 0x0fa62cd1}, {1, 0xe05f9169},\n-    {1, 0x78d194a9}, {5, 0x3e38147b}, {5, 0x737ba0d4}, {1, 0x63378e10},\n-    {1, 0x6d5f91cf}, {2, 0x88612eb8}, {2, 0xe9639484}, {1, 0xb7fabc9d},\n-    {2, 0x19b01592}, {1, 0x5a90dd31}, {2, 0x5bd7e028}, {2, 0x94d00323},\n-    {1, 0xa9b9c01a}, {1, 0x3a40de61}, {1, 0x56e7eec7}, {5, 0x859f7ef6},\n-    {1, 0xfd8e5630}, {1, 0x2b0c9f7f}, {1, 0xba700e26}, {1, 0x7170a408},\n-    {1, 0x70de86a8}, {1, 0x74d64cd5}, {1, 0x49e738a1}, {2, 0x6910b602},\n-    {0, 0x643c565f}, {1, 0x54264b3f}, {2, 0x97ea6396}, {2, 0x55174459},\n-    {2, 0x03e8779a}, {1, 0x98f34d8f}, {1, 0xc07b2b07}, {1, 0xdfe29668},\n-    {1, 0x3141c7c1}, {1, 0xb3b595f4}, {1, 0x735abf08}, {5, 0x623bfbce},\n-    {2, 0xd351e722}, {1, 0xf4ca48c9}, {1, 0x5b19c670}, {1, 0xa164bf0e},\n-    {2, 0xbbbeb305}, {2, 0xfe1c810a},\n+} BLOCKINFO[] = {\n+    {8, 582909131}, {0, 971462344}, {2, 1169481553}, {6, 66147495}, {7, 427785981}, {8, 80538907}, {8, 207348013}, {2,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16333#discussion_r299988583",
      "id" : 299988583,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI5OTk4ODU4Mw==",
      "original_commit_id" : "faa2e0d668b2568021a3872ae0d48ec161781605",
      "original_position" : 39,
      "path" : "src/test/miner_tests.cpp",
      "position" : 39,
      "pull_request_review_id" : 257528430,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16333",
      "updated_at" : "2019-07-09T18:55:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/299988583",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16333#discussion_r299991209"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16333"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/299991209"
         }
      },
      "author_association" : "MEMBER",
      "body" : "clang format will put them in separate lines, which is wasteful. So I ran the \"paragraph formatter\" in vim for extra compaction. I don't think this needs to be human-readable, so should be fine as is.",
      "commit_id" : "48ed8fd170f5bfef19e437f4301c82633296504a",
      "created_at" : "2019-07-03T14:34:33Z",
      "diff_hunk" : "@@ -46,39 +46,26 @@ static BlockAssembler AssemblerForTest(const CChainParams& params) {\n     return BlockAssembler(params, options);\n }\n \n-static\n-struct {\n+constexpr static struct {\n     unsigned char extranonce;\n     unsigned int nonce;\n-} blockinfo[] = {\n-    {4, 0xa4a3e223}, {2, 0x15c32f9e}, {1, 0x0375b547}, {1, 0x7004a8a5},\n-    {2, 0xce440296}, {2, 0x52cfe198}, {1, 0x77a72cd0}, {2, 0xbb5d6f84},\n-    {2, 0x83f30c2c}, {1, 0x48a73d5b}, {1, 0xef7dcd01}, {2, 0x6809c6c4},\n-    {2, 0x0883ab3c}, {1, 0x087bbbe2}, {2, 0x2104a814}, {2, 0xdffb6daa},\n-    {1, 0xee8a0a08}, {2, 0xba4237c1}, {1, 0xa70349dc}, {1, 0x344722bb},\n-    {3, 0xd6294733}, {2, 0xec9f5c94}, {2, 0xca2fbc28}, {1, 0x6ba4f406},\n-    {2, 0x015d4532}, {1, 0x6e119b7c}, {2, 0x43e8f314}, {2, 0x27962f38},\n-    {2, 0xb571b51b}, {2, 0xb36bee23}, {2, 0xd17924a8}, {2, 0x6bc212d9},\n-    {1, 0x630d4948}, {2, 0x9a4c4ebb}, {2, 0x554be537}, {1, 0xd63ddfc7},\n-    {2, 0xa10acc11}, {1, 0x759a8363}, {2, 0xfb73090d}, {1, 0xe82c6a34},\n-    {1, 0xe33e92d7}, {3, 0x658ef5cb}, {2, 0xba32ff22}, {5, 0x0227a10c},\n-    {1, 0xa9a70155}, {5, 0xd096d809}, {1, 0x37176174}, {1, 0x830b8d0f},\n-    {1, 0xc6e3910e}, {2, 0x823f3ca8}, {1, 0x99850849}, {1, 0x7521fb81},\n-    {1, 0xaacaabab}, {1, 0xd645a2eb}, {5, 0x7aea1781}, {5, 0x9d6e4b78},\n-    {1, 0x4ce90fd8}, {1, 0xabdc832d}, {6, 0x4a34f32a}, {2, 0xf2524c1c},\n-    {2, 0x1bbeb08a}, {1, 0xad47f480}, {1, 0x9f026aeb}, {1, 0x15a95049},\n-    {2, 0xd1cb95b2}, {2, 0xf84bbda5}, {1, 0x0fa62cd1}, {1, 0xe05f9169},\n-    {1, 0x78d194a9}, {5, 0x3e38147b}, {5, 0x737ba0d4}, {1, 0x63378e10},\n-    {1, 0x6d5f91cf}, {2, 0x88612eb8}, {2, 0xe9639484}, {1, 0xb7fabc9d},\n-    {2, 0x19b01592}, {1, 0x5a90dd31}, {2, 0x5bd7e028}, {2, 0x94d00323},\n-    {1, 0xa9b9c01a}, {1, 0x3a40de61}, {1, 0x56e7eec7}, {5, 0x859f7ef6},\n-    {1, 0xfd8e5630}, {1, 0x2b0c9f7f}, {1, 0xba700e26}, {1, 0x7170a408},\n-    {1, 0x70de86a8}, {1, 0x74d64cd5}, {1, 0x49e738a1}, {2, 0x6910b602},\n-    {0, 0x643c565f}, {1, 0x54264b3f}, {2, 0x97ea6396}, {2, 0x55174459},\n-    {2, 0x03e8779a}, {1, 0x98f34d8f}, {1, 0xc07b2b07}, {1, 0xdfe29668},\n-    {1, 0x3141c7c1}, {1, 0xb3b595f4}, {1, 0x735abf08}, {5, 0x623bfbce},\n-    {2, 0xd351e722}, {1, 0xf4ca48c9}, {1, 0x5b19c670}, {1, 0xa164bf0e},\n-    {2, 0xbbbeb305}, {2, 0xfe1c810a},\n+} BLOCKINFO[] = {\n+    {8, 582909131}, {0, 971462344}, {2, 1169481553}, {6, 66147495}, {7, 427785981}, {8, 80538907}, {8, 207348013}, {2,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16333#discussion_r299991209",
      "id" : 299991209,
      "in_reply_to_id" : 299988583,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI5OTk5MTIwOQ==",
      "original_commit_id" : "faa2e0d668b2568021a3872ae0d48ec161781605",
      "original_position" : 39,
      "path" : "src/test/miner_tests.cpp",
      "position" : 39,
      "pull_request_review_id" : 257531720,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16333",
      "updated_at" : "2019-07-09T18:55:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/299991209",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16333#discussion_r300002280"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16333"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300002280"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ok then just document it's a check in `CheckTransaction`, I just couldn't recall this rule.",
      "commit_id" : "48ed8fd170f5bfef19e437f4301c82633296504a",
      "created_at" : "2019-07-03T14:53:44Z",
      "diff_hunk" : "@@ -91,29 +92,22 @@ def add_witness_commitment(block, nonce=0):\n     block.hashMerkleRoot = block.calc_merkle_root()\n     block.rehash()\n \n-def serialize_script_num(value):\n-    r = bytearray(0)\n-    if value == 0:\n-        return r\n-    neg = value < 0\n-    absvalue = -value if neg else value\n-    while (absvalue):\n-        r.append(int(absvalue & 0xff))\n-        absvalue >>= 8\n-    if r[-1] & 0x80:\n-        r.append(0x80 if neg else 0)\n-    elif neg:\n-        r[-1] |= 0x80\n-    return r\n+\n+def script_BIP34_coinbase_height(height):\n+    if height <= 16:\n+        res = CScriptOp.encode_op_n(height)\n+        # Append dummy to increase scriptSig size above 2",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16333#discussion_r300002280",
      "id" : 300002280,
      "in_reply_to_id" : 299975273,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMDAwMjI4MA==",
      "original_commit_id" : "faa2e0d668b2568021a3872ae0d48ec161781605",
      "original_position" : 38,
      "path" : "test/functional/test_framework/blocktools.py",
      "position" : null,
      "pull_request_review_id" : 257545371,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16333",
      "updated_at" : "2019-07-09T18:55:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300002280",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16333#discussion_r300005333"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16333"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300005333"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "48ed8fd170f5bfef19e437f4301c82633296504a",
      "created_at" : "2019-07-03T14:58:58Z",
      "diff_hunk" : "@@ -91,29 +92,22 @@ def add_witness_commitment(block, nonce=0):\n     block.hashMerkleRoot = block.calc_merkle_root()\n     block.rehash()\n \n-def serialize_script_num(value):\n-    r = bytearray(0)\n-    if value == 0:\n-        return r\n-    neg = value < 0\n-    absvalue = -value if neg else value\n-    while (absvalue):\n-        r.append(int(absvalue & 0xff))\n-        absvalue >>= 8\n-    if r[-1] & 0x80:\n-        r.append(0x80 if neg else 0)\n-    elif neg:\n-        r[-1] |= 0x80\n-    return r\n+\n+def script_BIP34_coinbase_height(height):\n+    if height <= 16:\n+        res = CScriptOp.encode_op_n(height)\n+        # Append dummy to increase scriptSig size above 2",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16333#discussion_r300005333",
      "id" : 300005333,
      "in_reply_to_id" : 299975273,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMDAwNTMzMw==",
      "original_commit_id" : "faa2e0d668b2568021a3872ae0d48ec161781605",
      "original_position" : 38,
      "path" : "test/functional/test_framework/blocktools.py",
      "position" : null,
      "pull_request_review_id" : 257549132,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16333",
      "updated_at" : "2019-07-09T18:55:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300005333",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.",
      "created_at" : "2019-07-03T17:57:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16333#issuecomment-508195628",
      "id" : 508195628,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16333",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwODE5NTYyOA==",
      "updated_at" : "2019-07-27T11:05:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/508195628",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Fails with `Assertion failed: lock cs_main not held in ./validation.h:411`",
      "created_at" : "2019-07-04T15:38:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16333#issuecomment-508522150",
      "id" : 508522150,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16333",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwODUyMjE1MA==",
      "updated_at" : "2019-07-04T15:38:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/508522150",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I changed the BIP34 height to `2`, so that the block at height=1 may be used to mine a duplicate coinbase. (Needed to test mainnet behaviour)\r\n\r\nThis didn't quite make sense to me, but I think it works. I think the two behaviours that warrant testing are:\r\n\r\n * block 1 coinbase txid = X, block 2 spends X, block 3 coinbase txid = X, block 4 spends X again; all okay\r\n * block 1 coinbase txid = X, block 2 at most partially spends X, block 3 coinbase txid = X, should be prevented by BIP30 enforcement\r\n\r\nI think this adds a test for the second case (with X completely unspent), but not the first? (And duplicates are at block 120 not block 3)",
      "created_at" : "2019-07-05T01:51:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16333#issuecomment-508604071",
      "id" : 508604071,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16333",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwODYwNDA3MQ==",
      "updated_at" : "2019-07-05T01:51:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/508604071",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16333#discussion_r300816304"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16333"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300816304"
         }
      },
      "author_association" : "NONE",
      "body" : "I'd prefer not to use Yoda conditions",
      "commit_id" : "48ed8fd170f5bfef19e437f4301c82633296504a",
      "created_at" : "2019-07-06T01:44:41Z",
      "diff_hunk" : "@@ -221,21 +208,19 @@ BOOST_AUTO_TEST_CASE(CreateNewBlock_validity)\n     BOOST_CHECK(pblocktemplate = AssemblerForTest(chainparams).CreateNewBlock(scriptPubKey));\n \n     // We can't make transactions until we have inputs\n-    // Therefore, load 100 blocks :)\n+    // Therefore, load 110 blocks :)\n+    static_assert(110 == sizeof(BLOCKINFO) / sizeof(*BLOCKINFO));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16333#discussion_r300816304",
      "id" : 300816304,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMDgxNjMwNA==",
      "original_commit_id" : "fa1a949bf368528b9f350961a9e5ac0aa6f40bfb",
      "original_position" : 64,
      "path" : "src/test/miner_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 258572959,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16333",
      "updated_at" : "2019-07-09T18:55:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300816304",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1562849?v=4",
         "events_url" : "https://api.github.com/users/fqlx/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fqlx/followers",
         "following_url" : "https://api.github.com/users/fqlx/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fqlx/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fqlx",
         "id" : 1562849,
         "login" : "fqlx",
         "node_id" : "MDQ6VXNlcjE1NjI4NDk=",
         "organizations_url" : "https://api.github.com/users/fqlx/orgs",
         "received_events_url" : "https://api.github.com/users/fqlx/received_events",
         "repos_url" : "https://api.github.com/users/fqlx/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fqlx/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fqlx/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fqlx"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Based on the comments in #14633 our implementation doesn't match BIP34 for blocks at heights lower than 17 (since we do `OP_1..OP_16` instead of non-minimal `0x01 [0x01...0x10]` as per BIP34); maybe it might be better to only test BIP34 from block 17 rather than block 2? FWIW, tests look like they work unchanged with `BIP34Height = 17` instead of 2.\r\n\r\nIf so, could be worth adding `assert(globalChainParams->GetConsensus().BIP34Height > 16);` to `SelectParams()` along with a comment about divergence from BIP34 if that assertion were violated.\r\n\r\nAlternatively, seems like BIP34 probably should be updated to at least note the divergence to the original specification for bitcoind's regtest (and potentially signet or \"tapnet\" or similar, which might actually require interoperability with other clients).\r\n\r\n(Edited to add: ACK once the above is dealt with one way or another, fwiw)",
      "created_at" : "2019-07-16T06:25:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16333#issuecomment-511683294",
      "id" : 511683294,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16333",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxMTY4MzI5NA==",
      "updated_at" : "2019-07-16T06:27:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/511683294",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   }
]
