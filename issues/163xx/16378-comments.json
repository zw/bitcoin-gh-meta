[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r303001240"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/303001240"
         }
      },
      "author_association" : "MEMBER",
      "body" : "as noted in my other PR, I think `broadcast` is the wrong word here. It's moreso that we do not commit it to the wallet, which also broadcasts it",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2019-07-12T14:15:37Z",
      "diff_hunk" : "@@ -4122,6 +4123,153 @@ UniValue walletcreatefundedpsbt(const JSONRPCRequest& request)\n     return result;\n }\n \n+UniValue send(const JSONRPCRequest& request)\n+{\n+    std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+    CWallet* const pwallet = wallet.get();\n+\n+    if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {\n+        return NullUniValue;\n+    }\n+\n+    RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"inputs\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Leave empty to add inputs automatically. A json array of json objects\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"addInputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"broadcast\", RPCArg::Type::BOOL, /* default */ \"true\", \"Broadcast to the Bitcoin network or submit manually\"},\n+                    {\"changeAddress\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"changePosition\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if changeAddress is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"includeWatching\", RPCArg::Type::BOOL, /* default */ \"false\", \"Also select inputs which are watch only\"},\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lockUnspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"feeRate\", RPCArg::Type::AMOUNT, /* default */ \"not set: makes wallet determine the fee\", \"Set a specific fee rate in \" + CURRENCY_UNIT + \"/kB\"},\n+                    {\"subtractFeeFromOutputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"                              The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"                              Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"                              If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"false\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"Fallback to wallet's confirmation target\", \"Confirmation target (in blocks)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"UNSET\", \"The fee estimate mode, must be one of:\\n\"\n+                    \"         \\\"UNSET\\\"\\n\"\n+                    \"         \\\"ECONOMICAL\\\"\\n\"\n+                    \"         \\\"CONSERVATIVE\\\"\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+                    \"{\\n\"\n+                    \"  \\\"complete\\\" : true|false, (boolean) If the transaction has a complete set of signatures\\n\"\n+                    \"  \\\"txid\\\" :                 (string) The transaction id for the send. Only 1 transaction is created regardless of \\n\"\n+                    \"                                      the number of addresses.\\n\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r303001240",
      "id" : 303001240,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMzAwMTI0MA==",
      "original_commit_id" : "5136b7316e995bdf6100e95be4e372e2f51d7b1f",
      "original_line" : 4345,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 261283429,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-10T11:45:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/303001240",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r303007096"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/303007096"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm open to other terms, maybe `commit`? But that seems less clear.\r\n\r\nThe background motivation here is that an RPC consumer may need certainty about whether the transaction failed or succeeded. For example this should even work if the RPC connection gets cut before the call returns.\r\n\r\nJust retrying is unsafe. So right now the only option is to check if the wallet contains transactions to the expected destination(s). With this flag, the RPC consumer gets full control and can for example commit the full transaction to some redundant database before broadcasting it.\r\n\r\n(and maybe in future we support wallet-less spend based on just a descriptor with private keys, where there's no way to know if a previous attempt failed, since you can't rely on the local mempool for that)",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2019-07-12T14:28:18Z",
      "diff_hunk" : "@@ -4122,6 +4123,153 @@ UniValue walletcreatefundedpsbt(const JSONRPCRequest& request)\n     return result;\n }\n \n+UniValue send(const JSONRPCRequest& request)\n+{\n+    std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+    CWallet* const pwallet = wallet.get();\n+\n+    if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {\n+        return NullUniValue;\n+    }\n+\n+    RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"inputs\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Leave empty to add inputs automatically. A json array of json objects\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"addInputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"broadcast\", RPCArg::Type::BOOL, /* default */ \"true\", \"Broadcast to the Bitcoin network or submit manually\"},\n+                    {\"changeAddress\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"changePosition\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if changeAddress is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"includeWatching\", RPCArg::Type::BOOL, /* default */ \"false\", \"Also select inputs which are watch only\"},\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lockUnspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"feeRate\", RPCArg::Type::AMOUNT, /* default */ \"not set: makes wallet determine the fee\", \"Set a specific fee rate in \" + CURRENCY_UNIT + \"/kB\"},\n+                    {\"subtractFeeFromOutputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"                              The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"                              Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"                              If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"false\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"Fallback to wallet's confirmation target\", \"Confirmation target (in blocks)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"UNSET\", \"The fee estimate mode, must be one of:\\n\"\n+                    \"         \\\"UNSET\\\"\\n\"\n+                    \"         \\\"ECONOMICAL\\\"\\n\"\n+                    \"         \\\"CONSERVATIVE\\\"\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+                    \"{\\n\"\n+                    \"  \\\"complete\\\" : true|false, (boolean) If the transaction has a complete set of signatures\\n\"\n+                    \"  \\\"txid\\\" :                 (string) The transaction id for the send. Only 1 transaction is created regardless of \\n\"\n+                    \"                                      the number of addresses.\\n\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r303007096",
      "id" : 303007096,
      "in_reply_to_id" : 303001240,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMzAwNzA5Ng==",
      "original_commit_id" : "5136b7316e995bdf6100e95be4e372e2f51d7b1f",
      "original_line" : 4345,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 261291199,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-10T11:45:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/303007096",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r303016671"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/303016671"
         }
      },
      "author_association" : "MEMBER",
      "body" : "\"broadcast\" already has meaning to users unfortunately e.g., `walletbroadcast` startup arg",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2019-07-12T14:49:10Z",
      "diff_hunk" : "@@ -4122,6 +4123,153 @@ UniValue walletcreatefundedpsbt(const JSONRPCRequest& request)\n     return result;\n }\n \n+UniValue send(const JSONRPCRequest& request)\n+{\n+    std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+    CWallet* const pwallet = wallet.get();\n+\n+    if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {\n+        return NullUniValue;\n+    }\n+\n+    RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"inputs\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Leave empty to add inputs automatically. A json array of json objects\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"addInputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"broadcast\", RPCArg::Type::BOOL, /* default */ \"true\", \"Broadcast to the Bitcoin network or submit manually\"},\n+                    {\"changeAddress\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"changePosition\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if changeAddress is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"includeWatching\", RPCArg::Type::BOOL, /* default */ \"false\", \"Also select inputs which are watch only\"},\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lockUnspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"feeRate\", RPCArg::Type::AMOUNT, /* default */ \"not set: makes wallet determine the fee\", \"Set a specific fee rate in \" + CURRENCY_UNIT + \"/kB\"},\n+                    {\"subtractFeeFromOutputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"                              The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"                              Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"                              If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"false\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"Fallback to wallet's confirmation target\", \"Confirmation target (in blocks)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"UNSET\", \"The fee estimate mode, must be one of:\\n\"\n+                    \"         \\\"UNSET\\\"\\n\"\n+                    \"         \\\"ECONOMICAL\\\"\\n\"\n+                    \"         \\\"CONSERVATIVE\\\"\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+                    \"{\\n\"\n+                    \"  \\\"complete\\\" : true|false, (boolean) If the transaction has a complete set of signatures\\n\"\n+                    \"  \\\"txid\\\" :                 (string) The transaction id for the send. Only 1 transaction is created regardless of \\n\"\n+                    \"                                      the number of addresses.\\n\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r303016671",
      "id" : 303016671,
      "in_reply_to_id" : 303001240,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMzAxNjY3MQ==",
      "original_commit_id" : "5136b7316e995bdf6100e95be4e372e2f51d7b1f",
      "original_line" : 4345,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 261303922,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-10T11:45:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/303016671",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #18788 (tests: Update more tests to work with descriptor wallets by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-07-12T16:18:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#issuecomment-510946416",
      "id" : 510946416,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16378",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxMDk0NjQxNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-03T23:14:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/510946416",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r303209033"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/303209033"
         }
      },
      "author_association" : "MEMBER",
      "body" : "That's a rather scary startup option imo; forget it once and everything gets broadcast?",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2019-07-13T15:25:27Z",
      "diff_hunk" : "@@ -4122,6 +4123,153 @@ UniValue walletcreatefundedpsbt(const JSONRPCRequest& request)\n     return result;\n }\n \n+UniValue send(const JSONRPCRequest& request)\n+{\n+    std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+    CWallet* const pwallet = wallet.get();\n+\n+    if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {\n+        return NullUniValue;\n+    }\n+\n+    RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"inputs\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Leave empty to add inputs automatically. A json array of json objects\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"addInputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"broadcast\", RPCArg::Type::BOOL, /* default */ \"true\", \"Broadcast to the Bitcoin network or submit manually\"},\n+                    {\"changeAddress\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"changePosition\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if changeAddress is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"includeWatching\", RPCArg::Type::BOOL, /* default */ \"false\", \"Also select inputs which are watch only\"},\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lockUnspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"feeRate\", RPCArg::Type::AMOUNT, /* default */ \"not set: makes wallet determine the fee\", \"Set a specific fee rate in \" + CURRENCY_UNIT + \"/kB\"},\n+                    {\"subtractFeeFromOutputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"                              The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"                              Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"                              If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"false\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"Fallback to wallet's confirmation target\", \"Confirmation target (in blocks)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"UNSET\", \"The fee estimate mode, must be one of:\\n\"\n+                    \"         \\\"UNSET\\\"\\n\"\n+                    \"         \\\"ECONOMICAL\\\"\\n\"\n+                    \"         \\\"CONSERVATIVE\\\"\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+                    \"{\\n\"\n+                    \"  \\\"complete\\\" : true|false, (boolean) If the transaction has a complete set of signatures\\n\"\n+                    \"  \\\"txid\\\" :                 (string) The transaction id for the send. Only 1 transaction is created regardless of \\n\"\n+                    \"                                      the number of addresses.\\n\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r303209033",
      "id" : 303209033,
      "in_reply_to_id" : 303001240,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMzIwOTAzMw==",
      "original_commit_id" : "5136b7316e995bdf6100e95be4e372e2f51d7b1f",
      "original_line" : 4345,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 261545538,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-10T11:45:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/303209033",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r309679500"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/309679500"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> That's a rather scary startup option imo; forget it once and everything gets broadcast?\r\n\r\nThis is definitely an option, like the proxy configuration, one'd want to have in the `bitcoin.conf` and not on the command line!\r\n\r\nBut also, not necessarily: the idea is that when you have it enabled, you broadcast wallet transactions manually (e.g. by pasting them into the transaction broadcast of a  block explorer, or a script such as `bitcoin-submittx` over tor) so they end up in the mempool or block chain through some other route. There's no reason for the wallet to broadcast them then.",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2019-08-01T12:51:53Z",
      "diff_hunk" : "@@ -4122,6 +4123,153 @@ UniValue walletcreatefundedpsbt(const JSONRPCRequest& request)\n     return result;\n }\n \n+UniValue send(const JSONRPCRequest& request)\n+{\n+    std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+    CWallet* const pwallet = wallet.get();\n+\n+    if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {\n+        return NullUniValue;\n+    }\n+\n+    RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"inputs\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Leave empty to add inputs automatically. A json array of json objects\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"addInputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"broadcast\", RPCArg::Type::BOOL, /* default */ \"true\", \"Broadcast to the Bitcoin network or submit manually\"},\n+                    {\"changeAddress\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"changePosition\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if changeAddress is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"includeWatching\", RPCArg::Type::BOOL, /* default */ \"false\", \"Also select inputs which are watch only\"},\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lockUnspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"feeRate\", RPCArg::Type::AMOUNT, /* default */ \"not set: makes wallet determine the fee\", \"Set a specific fee rate in \" + CURRENCY_UNIT + \"/kB\"},\n+                    {\"subtractFeeFromOutputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"                              The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"                              Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"                              If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"false\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"Fallback to wallet's confirmation target\", \"Confirmation target (in blocks)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"UNSET\", \"The fee estimate mode, must be one of:\\n\"\n+                    \"         \\\"UNSET\\\"\\n\"\n+                    \"         \\\"ECONOMICAL\\\"\\n\"\n+                    \"         \\\"CONSERVATIVE\\\"\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+                    \"{\\n\"\n+                    \"  \\\"complete\\\" : true|false, (boolean) If the transaction has a complete set of signatures\\n\"\n+                    \"  \\\"txid\\\" :                 (string) The transaction id for the send. Only 1 transaction is created regardless of \\n\"\n+                    \"                                      the number of addresses.\\n\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r309679500",
      "id" : 309679500,
      "in_reply_to_id" : 303001240,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwOTY3OTUwMA==",
      "original_commit_id" : "5136b7316e995bdf6100e95be4e372e2f51d7b1f",
      "original_line" : 4345,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 269595979,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-10T11:45:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/309679500",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r309802778"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/309802778"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The option I introduce here doesn't even add the transaction to the wallet; it only returns the hex. So it goes beyond `walletbroadcast=0` afaik.",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2019-08-01T17:04:50Z",
      "diff_hunk" : "@@ -4122,6 +4123,153 @@ UniValue walletcreatefundedpsbt(const JSONRPCRequest& request)\n     return result;\n }\n \n+UniValue send(const JSONRPCRequest& request)\n+{\n+    std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+    CWallet* const pwallet = wallet.get();\n+\n+    if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {\n+        return NullUniValue;\n+    }\n+\n+    RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"inputs\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Leave empty to add inputs automatically. A json array of json objects\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"addInputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"broadcast\", RPCArg::Type::BOOL, /* default */ \"true\", \"Broadcast to the Bitcoin network or submit manually\"},\n+                    {\"changeAddress\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"changePosition\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if changeAddress is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"includeWatching\", RPCArg::Type::BOOL, /* default */ \"false\", \"Also select inputs which are watch only\"},\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lockUnspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"feeRate\", RPCArg::Type::AMOUNT, /* default */ \"not set: makes wallet determine the fee\", \"Set a specific fee rate in \" + CURRENCY_UNIT + \"/kB\"},\n+                    {\"subtractFeeFromOutputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"                              The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"                              Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"                              If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"false\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"Fallback to wallet's confirmation target\", \"Confirmation target (in blocks)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"UNSET\", \"The fee estimate mode, must be one of:\\n\"\n+                    \"         \\\"UNSET\\\"\\n\"\n+                    \"         \\\"ECONOMICAL\\\"\\n\"\n+                    \"         \\\"CONSERVATIVE\\\"\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+                    \"{\\n\"\n+                    \"  \\\"complete\\\" : true|false, (boolean) If the transaction has a complete set of signatures\\n\"\n+                    \"  \\\"txid\\\" :                 (string) The transaction id for the send. Only 1 transaction is created regardless of \\n\"\n+                    \"                                      the number of addresses.\\n\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r309802778",
      "id" : 309802778,
      "in_reply_to_id" : 303001240,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwOTgwMjc3OA==",
      "original_commit_id" : "5136b7316e995bdf6100e95be4e372e2f51d7b1f",
      "original_line" : 4345,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 269756507,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-10T11:45:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/309802778",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2019-08-02T13:20:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#issuecomment-517698107",
      "id" : 517698107,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16378",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNzY5ODEwNw==",
      "updated_at" : "2019-08-02T13:20:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/517698107",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r310209218"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/310209218"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I renamed `broadcast` to `add_to_wallet` and explained it a bit better in the docs. ",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2019-08-02T16:34:34Z",
      "diff_hunk" : "@@ -4122,6 +4123,153 @@ UniValue walletcreatefundedpsbt(const JSONRPCRequest& request)\n     return result;\n }\n \n+UniValue send(const JSONRPCRequest& request)\n+{\n+    std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+    CWallet* const pwallet = wallet.get();\n+\n+    if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {\n+        return NullUniValue;\n+    }\n+\n+    RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"inputs\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Leave empty to add inputs automatically. A json array of json objects\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"addInputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"broadcast\", RPCArg::Type::BOOL, /* default */ \"true\", \"Broadcast to the Bitcoin network or submit manually\"},\n+                    {\"changeAddress\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"changePosition\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if changeAddress is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"includeWatching\", RPCArg::Type::BOOL, /* default */ \"false\", \"Also select inputs which are watch only\"},\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lockUnspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"feeRate\", RPCArg::Type::AMOUNT, /* default */ \"not set: makes wallet determine the fee\", \"Set a specific fee rate in \" + CURRENCY_UNIT + \"/kB\"},\n+                    {\"subtractFeeFromOutputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"                              The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"                              Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"                              If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"false\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"Fallback to wallet's confirmation target\", \"Confirmation target (in blocks)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"UNSET\", \"The fee estimate mode, must be one of:\\n\"\n+                    \"         \\\"UNSET\\\"\\n\"\n+                    \"         \\\"ECONOMICAL\\\"\\n\"\n+                    \"         \\\"CONSERVATIVE\\\"\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+                    \"{\\n\"\n+                    \"  \\\"complete\\\" : true|false, (boolean) If the transaction has a complete set of signatures\\n\"\n+                    \"  \\\"txid\\\" :                 (string) The transaction id for the send. Only 1 transaction is created regardless of \\n\"\n+                    \"                                      the number of addresses.\\n\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r310209218",
      "id" : 310209218,
      "in_reply_to_id" : 303001240,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMxMDIwOTIxOA==",
      "original_commit_id" : "5136b7316e995bdf6100e95be4e372e2f51d7b1f",
      "original_line" : 4345,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 270280098,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-10T11:45:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/310209218",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Suggest moving \"inputs\" to a field on \"options\", and removing PSBT output from `send` (there is already a RPC for it, as you note).",
      "created_at" : "2019-08-20T00:05:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#issuecomment-522799652",
      "id" : 522799652,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16378",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUyMjc5OTY1Mg==",
      "updated_at" : "2019-08-20T00:05:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/522799652",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@luke-jr agree about moving the inputs. That also makes it easier to rebase on #11413 (explicit fee rate) and have a syntax like `send 0.001 BTC bc1... 1 sat/B`.\r\n\r\nThe reason I added PSBT output is to make multisig easier. When used with a descriptor wallet #15764 you simply call `send` and it will sign its own part and give you a PSBT to give to the other party (haven't tested this yet though). With the existing psbt methods that's more tedious.",
      "created_at" : "2019-08-21T08:56:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#issuecomment-523364668",
      "id" : 523364668,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16378",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUyMzM2NDY2OA==",
      "updated_at" : "2019-08-21T08:56:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/523364668",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Closing in favor of tweaking `sendmany` / `sendtoaddress`:\r\n* #11413 adds fee rate support (`1 sat/b`) without the need for an options JSON\r\n* @luke-jr suggested moving coin selection into an options JSON (it's a more advanced feature than fee selection, so that's fine by me)\r\n* PSBT output can be added when we need it, same for the option to avoid committing transaction to wallet",
      "created_at" : "2019-08-26T10:34:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#issuecomment-524810407",
      "id" : 524810407,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16378",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUyNDgxMDQwNw==",
      "updated_at" : "2019-08-26T10:34:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/524810407",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "And we're back! I tried to make the simplest use case, sending coins to a single address with a manual fee in satoshi per byte, easy for `bitcoin-cli` users. This means you can set `conf_target` and `estimate_mode` either in the options dictionary or as a positional argument.\r\n\r\n```\r\nbitcoin-cli -regtest send '{\"ADDRESS\": 0.1}' 1 sat/b\r\n```\r\n\r\nIdeally I'd also get rid of the JSON encoding, but at least this RPC example is easy enough for a new `bitcoin-cli` user to copy-paste and tweak. And meanwhile GUI PSBT support has made enough progress.\r\n\r\nThis needs some cleanup, but I suggest focussing initial review on:\r\n1. the dependencies: #16377 and #11413 (I'll have to adjust some things depending on those)\r\n2. concept ACKs and/or suggestions for the RPC interface\r\n\r\n@luke-jr suggested:\r\n\r\n> Suggest moving \"inputs\" to a field on \"options\"\r\n\r\nDone",
      "created_at" : "2020-02-24T21:28:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#issuecomment-590557710",
      "id" : 590557710,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16378",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5MDU1NzcxMA==",
      "updated_at" : "2020-02-24T21:30:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/590557710",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This now has enough test coverage that I consider it review worthy, but note that it depends on 3 other pull requests.",
      "created_at" : "2020-03-02T17:37:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#issuecomment-593523577",
      "id" : 593523577,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16378",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5MzUyMzU3Nw==",
      "updated_at" : "2020-03-02T17:37:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/593523577",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/fa733bbd78add587e19f0175ab9c127a8c27e024/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-03-07T01:02:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#issuecomment-596024921",
      "id" : 596024921,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16378",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5NjAyNDkyMQ==",
      "updated_at" : "2020-03-07T01:02:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/596024921",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.",
      "created_at" : "2020-03-15T15:07:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#issuecomment-599222476",
      "id" : 599222476,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16378",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5OTIyMjQ3Ng==",
      "updated_at" : "2020-03-15T15:07:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/599222476",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased after #16377 and #11413, it should be easier to review now. ",
      "created_at" : "2020-06-25T19:01:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#issuecomment-649761160",
      "id" : 649761160,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16378",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0OTc2MTE2MA==",
      "updated_at" : "2020-06-25T19:01:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/649761160",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased and tests should pass now. Some things that I think are worth discussing:\r\n\r\n1. `CommitTransaction()` happily accepts transactions with `nLockTime` in the future. It's not clear to me if those eventually get broadcast; in the functional test I had to re-submit it manually. This could be tackled in another PR though.\r\n2. We return a transaction hash or a PSBT, in part depending on magic. You can opt out of this magic by setting the `psbt` option to `true` (which implies `add_to_wallet=false`, but in addition to the serialised hex it returns a PSBT even for a fully signed transaction)\r\n3. A hex serialized transaction is only returned when setting `add_to_wallet` to `false`, so there's no magic there. But depending on how (1) is handled, this could change, e.g. it could return a hex for transaction with (far) future `nLockTime` (not my preference though).",
      "created_at" : "2020-08-07T15:37:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#issuecomment-670577529",
      "id" : 670577529,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16378",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MDU3NzUyOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-07T15:37:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/670577529",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r470590536"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470590536"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Might use the non-deprecated constructor. E.g. #19528  ",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-08-14T12:21:36Z",
      "diff_hunk" : "@@ -3818,6 +3833,186 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+UniValue send(const JSONRPCRequest& request)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r470590536",
      "id" : 470590536,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDU5MDUzNg==",
      "original_commit_id" : "15ba29aafe9a448c4cbf5f1550fa633e3ebd998a",
      "original_line" : 3836,
      "original_position" : 103,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 467531019,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-10T11:45:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470590536",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r470590770"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470590770"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n                    \"The fee will be equally deducted from the amount of each specified output.\\n\"\r\n```\r\n\r\nNo need for the whitespace",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-08-14T12:22:09Z",
      "diff_hunk" : "@@ -3818,6 +3833,186 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+UniValue send(const JSONRPCRequest& request)\n+{\n+    RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, RPCArg::Optional::OMITTED, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+            \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+                    {\"include_watching\", RPCArg::Type::BOOL, /* default */ \"true for watch-only wallets, otherwise false\", \"Also select inputs which are watch only.\\n\"\n+                                          \"Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\\n\"\n+                                          \"e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.\"},\n+                    {\"inputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Specify inputs instead of adding them automatically. A json array of json objects\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lock_unspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"psbt\", RPCArg::Type::BOOL,  /* default */ \"automatic\", \"Always return a PSBT, implies add_to_wallet=false.\"},\n+                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"                              The fee will be equally deducted from the amount of each specified output.\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r470590770",
      "id" : 470590770,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDU5MDc3MA==",
      "original_commit_id" : "15ba29aafe9a448c4cbf5f1550fa633e3ebd998a",
      "original_line" : 3884,
      "original_position" : 151,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 467531019,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-10T11:45:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470590770",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r470591098"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470591098"
         }
      },
      "author_association" : "MEMBER",
      "body" : "As the previous line already checks for nullptr, this can be a reference.\r\n```suggestion\r\n    CWallet& wallet = pwallet.get();\r\n```",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-08-14T12:22:53Z",
      "diff_hunk" : "@@ -3818,6 +3833,186 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+UniValue send(const JSONRPCRequest& request)\n+{\n+    RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, RPCArg::Optional::OMITTED, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+            \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+                    {\"include_watching\", RPCArg::Type::BOOL, /* default */ \"true for watch-only wallets, otherwise false\", \"Also select inputs which are watch only.\\n\"\n+                                          \"Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\\n\"\n+                                          \"e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.\"},\n+                    {\"inputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Specify inputs instead of adding them automatically. A json array of json objects\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lock_unspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"psbt\", RPCArg::Type::BOOL,  /* default */ \"automatic\", \"Always return a PSBT, implies add_to_wallet=false.\"},\n+                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"                              The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"                              Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"                              If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+                {\n+                    {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n+                    {RPCResult::Type::STR_HEX, \"txid\", \"The transaction id for the send. Only 1 transaction is created regardless of \\n\"\n+                                                       \"the number of addresses.\\n\"},\n+                    {RPCResult::Type::STR_HEX, \"hex\", \"If add_to_wallet is false, the hex-encoded raw transaction with signature(s)\"},\n+                    {RPCResult::Type::STR, \"psbt\", \"If more signatures are needed, or if add_to_wallet is false, the base64-encoded (partially) signed transaction\"}\n+                }\n+        },\n+        RPCExamples{\"\"\n+        \"\\nSend with a fee rate of 1 satoshi per byte\\n\"\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 sat/b\\n\" +\n+            \"\\nCreate a transaction that should confirm the next block, with a specific input, and return result without adding to wallet or broadcasting to the network\\n\")\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 economical '{\\\"add_to_wallet\\\": false, \\\"inputs\\\": [{\\\"txid\\\":\\\"a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\", \\\"vout\\\":1}]}'\")\n+        }\n+    }.Check(request);\n+\n+    RPCTypeCheck(request.params, {\n+        UniValueType(), // ARR or OBJ, checked later\n+        UniValue::VNUM,\n+        UniValue::VSTR,\n+        UniValue::VOBJ\n+        }, true\n+    );\n+\n+    std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+    if (!wallet) return NullUniValue;\n+    CWallet* const pwallet = wallet.get();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r470591098",
      "id" : 470591098,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDU5MTA5OA==",
      "original_commit_id" : "15ba29aafe9a448c4cbf5f1550fa633e3ebd998a",
      "original_line" : 3924,
      "original_position" : 191,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 467531019,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-10T11:45:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470591098",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r479398807"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/479398807"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Do you mean `const CWallet& pwallet = wallet.get();` ? This creates a `const` mess when calling `FundTransaction` (which I'd rather not refactor in this PR).",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-08-28T16:06:00Z",
      "diff_hunk" : "@@ -3818,6 +3833,186 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+UniValue send(const JSONRPCRequest& request)\n+{\n+    RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, RPCArg::Optional::OMITTED, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+            \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+                    {\"include_watching\", RPCArg::Type::BOOL, /* default */ \"true for watch-only wallets, otherwise false\", \"Also select inputs which are watch only.\\n\"\n+                                          \"Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\\n\"\n+                                          \"e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.\"},\n+                    {\"inputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Specify inputs instead of adding them automatically. A json array of json objects\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lock_unspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"psbt\", RPCArg::Type::BOOL,  /* default */ \"automatic\", \"Always return a PSBT, implies add_to_wallet=false.\"},\n+                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"                              The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"                              Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"                              If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+                {\n+                    {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n+                    {RPCResult::Type::STR_HEX, \"txid\", \"The transaction id for the send. Only 1 transaction is created regardless of \\n\"\n+                                                       \"the number of addresses.\\n\"},\n+                    {RPCResult::Type::STR_HEX, \"hex\", \"If add_to_wallet is false, the hex-encoded raw transaction with signature(s)\"},\n+                    {RPCResult::Type::STR, \"psbt\", \"If more signatures are needed, or if add_to_wallet is false, the base64-encoded (partially) signed transaction\"}\n+                }\n+        },\n+        RPCExamples{\"\"\n+        \"\\nSend with a fee rate of 1 satoshi per byte\\n\"\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 sat/b\\n\" +\n+            \"\\nCreate a transaction that should confirm the next block, with a specific input, and return result without adding to wallet or broadcasting to the network\\n\")\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 economical '{\\\"add_to_wallet\\\": false, \\\"inputs\\\": [{\\\"txid\\\":\\\"a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\", \\\"vout\\\":1}]}'\")\n+        }\n+    }.Check(request);\n+\n+    RPCTypeCheck(request.params, {\n+        UniValueType(), // ARR or OBJ, checked later\n+        UniValue::VNUM,\n+        UniValue::VSTR,\n+        UniValue::VOBJ\n+        }, true\n+    );\n+\n+    std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+    if (!wallet) return NullUniValue;\n+    CWallet* const pwallet = wallet.get();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r479398807",
      "id" : 479398807,
      "in_reply_to_id" : 470591098,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTM5ODgwNw==",
      "original_commit_id" : "15ba29aafe9a448c4cbf5f1550fa633e3ebd998a",
      "original_line" : 3924,
      "original_position" : 191,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 477851275,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-10T11:45:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/479398807",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r479406129"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/479406129"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I switched to the fancy new thing.",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-08-28T16:19:33Z",
      "diff_hunk" : "@@ -3818,6 +3833,186 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+UniValue send(const JSONRPCRequest& request)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r479406129",
      "id" : 479406129,
      "in_reply_to_id" : 470590536,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQwNjEyOQ==",
      "original_commit_id" : "15ba29aafe9a448c4cbf5f1550fa633e3ebd998a",
      "original_line" : 3836,
      "original_position" : 103,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 477860841,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-10T11:45:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/479406129",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased after #18244 landed.",
      "created_at" : "2020-08-31T11:56:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#issuecomment-683733694",
      "id" : 683733694,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16378",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MzczMzY5NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-31T11:56:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/683733694",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r484135309"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/484135309"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Because these are Optional::OMITTED, the \"default\" is actually the description string, so the only output is:\r\n```\r\n2. conf_target                           (numeric) wallet default\r\n3. estimate_mode                         (string) unset\r\n```",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-07T00:33:53Z",
      "diff_hunk" : "@@ -3885,6 +3890,188 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, RPCArg::Optional::OMITTED, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r484135309",
      "id" : 484135309,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDEzNTMwOQ==",
      "original_commit_id" : "27c07f08662a8044c729d0adead0511984c40cef",
      "original_line" : 3915,
      "original_position" : 56,
      "original_start_line" : 3914,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 483188381,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-09-10T11:45:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/484135309",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/meshcollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/meshcollider/followers",
         "following_url" : "https://api.github.com/users/meshcollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/meshcollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/meshcollider",
         "id" : 3211283,
         "login" : "meshcollider",
         "node_id" : "MDQ6VXNlcjMyMTEyODM=",
         "organizations_url" : "https://api.github.com/users/meshcollider/orgs",
         "received_events_url" : "https://api.github.com/users/meshcollider/received_events",
         "repos_url" : "https://api.github.com/users/meshcollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/meshcollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/meshcollider"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r484135676"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/484135676"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: unnecessary newline",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-07T00:36:46Z",
      "diff_hunk" : "@@ -3885,6 +3890,188 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, RPCArg::Optional::OMITTED, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+            \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+                    {\"include_watching\", RPCArg::Type::BOOL, /* default */ \"true for watch-only wallets, otherwise false\", \"Also select inputs which are watch only.\\n\"\n+                                          \"Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\\n\"\n+                                          \"e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.\"},\n+                    {\"inputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Specify inputs instead of adding them automatically. A json array of json objects\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lock_unspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"psbt\", RPCArg::Type::BOOL,  /* default */ \"automatic\", \"Always return a PSBT, implies add_to_wallet=false.\"},\n+                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+                {\n+                    {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n+                    {RPCResult::Type::STR_HEX, \"txid\", \"The transaction id for the send. Only 1 transaction is created regardless of \\n\"\n+                                                       \"the number of addresses.\\n\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r484135676",
      "id" : 484135676,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDEzNTY3Ng==",
      "original_commit_id" : "27c07f08662a8044c729d0adead0511984c40cef",
      "original_line" : 3958,
      "original_position" : 99,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 483188381,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-10T11:45:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/484135676",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/meshcollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/meshcollider/followers",
         "following_url" : "https://api.github.com/users/meshcollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/meshcollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/meshcollider",
         "id" : 3211283,
         "login" : "meshcollider",
         "node_id" : "MDQ6VXNlcjMyMTEyODM=",
         "organizations_url" : "https://api.github.com/users/meshcollider/orgs",
         "received_events_url" : "https://api.github.com/users/meshcollider/received_events",
         "repos_url" : "https://api.github.com/users/meshcollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/meshcollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/meshcollider"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r484545963"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/484545963"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I dropped the `Optional::OMITTED` bit, not super intuitive... (cc @MarcoFalke)\r\n\r\n```\r\n2. conf_target                           (numeric, optional, default=wallet default) Confirmation target (in blocks), or fee rate (for BTC/kB or sat/B estimate modes)\r\n3. estimate_mode                         (string, optional, default=unset) The fee estimate mode, must be one of (case insensitive):\r\n                                         \"unset\"\r\n                                         \"economical\"\r\n                                         \"conservative\"\r\n                                         \"BTC/kB\"\r\n                                         \"sat/B\"\r\n4. options                               (json object, optional)\r\n```",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-07T18:57:07Z",
      "diff_hunk" : "@@ -3885,6 +3890,188 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, RPCArg::Optional::OMITTED, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r484545963",
      "id" : 484545963,
      "in_reply_to_id" : 484135309,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDU0NTk2Mw==",
      "original_commit_id" : "27c07f08662a8044c729d0adead0511984c40cef",
      "original_line" : 3915,
      "original_position" : 56,
      "original_start_line" : 3914,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 483690076,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-09-10T11:45:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/484545963",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r486028808"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486028808"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why is this check so much more involved than just if exists() and get_bool() like you do with add_to_wallet below?",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-10T02:41:18Z",
      "diff_hunk" : "@@ -3866,6 +3871,187 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+            \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+                    {\"include_watching\", RPCArg::Type::BOOL, /* default */ \"true for watch-only wallets, otherwise false\", \"Also select inputs which are watch only.\\n\"\n+                                          \"Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\\n\"\n+                                          \"e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.\"},\n+                    {\"inputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Specify inputs instead of adding them automatically. A json array of json objects\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lock_unspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"psbt\", RPCArg::Type::BOOL,  /* default */ \"automatic\", \"Always return a PSBT, implies add_to_wallet=false.\"},\n+                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+                {\n+                    {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n+                    {RPCResult::Type::STR_HEX, \"txid\", \"The transaction id for the send. Only 1 transaction is created regardless of the number of addresses.\"},\n+                    {RPCResult::Type::STR_HEX, \"hex\", \"If add_to_wallet is false, the hex-encoded raw transaction with signature(s)\"},\n+                    {RPCResult::Type::STR, \"psbt\", \"If more signatures are needed, or if add_to_wallet is false, the base64-encoded (partially) signed transaction\"}\n+                }\n+        },\n+        RPCExamples{\"\"\n+        \"\\nSend with a fee rate of 1 satoshi per byte\\n\"\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 sat/b\\n\" +\n+            \"\\nCreate a transaction that should confirm the next block, with a specific input, and return result without adding to wallet or broadcasting to the network\\n\")\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 economical '{\\\"add_to_wallet\\\": false, \\\"inputs\\\": [{\\\"txid\\\":\\\"a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\", \\\"vout\\\":1}]}'\")\n+        },\n+        [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n+        {\n+            RPCTypeCheck(request.params, {\n+                UniValueType(), // ARR or OBJ, checked later\n+                UniValue::VNUM,\n+                UniValue::VSTR,\n+                UniValue::VOBJ\n+                }, true\n+            );\n+\n+            std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+            if (!wallet) return NullUniValue;\n+            CWallet* const pwallet = wallet.get();\n+\n+            UniValue options = request.params[3];\n+            if (options.exists(\"feeRate\") || options.exists(\"fee_rate\") || options.exists(\"estimate_mode\") || options.exists(\"conf_target\")) {\n+                if (!request.params[1].isNull() || !request.params[2].isNull()) {\n+                    throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use either conf_target and estimate_mode or the options dictionary to control fee rate\");\n+                }\n+            } else {\n+                options.pushKV(\"conf_target\", request.params[1]);\n+                options.pushKV(\"estimate_mode\", request.params[2]);\n+            }\n+            if (!options[\"conf_target\"].isNull() && (options[\"estimate_mode\"].isNull() || (options[\"estimate_mode\"].get_str() == \"unset\"))) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Specify estimate_mode\");\n+            }\n+            if (options.exists(\"changeAddress\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_address\");\n+            }\n+            if (options.exists(\"changePosition\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_position\");\n+            }\n+            if (options.exists(\"includeWatching\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use include_watching\");\n+            }\n+            if (options.exists(\"lockUnspents\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use lock_unspents\");\n+            }\n+            if (options.exists(\"subtractFeeFromOutputs\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use subtract_fee_from_outputs\");\n+            }\n+\n+            const bool psbt_opt_in = options.exists(\"psbt\") && options[\"psbt\"].get_bool();\n+\n+            CAmount fee;\n+            int change_position;\n+            bool rbf = pwallet->m_signal_rbf;\n+            const UniValue &replaceable_arg = options[\"replaceable\"];\n+            if (!replaceable_arg.isNull()) {\n+                RPCTypeCheckArgument(replaceable_arg, UniValue::VBOOL);\n+                rbf = replaceable_arg.isTrue();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r486028808",
      "id" : 486028808,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjAyODgwOA==",
      "original_commit_id" : "62d3523e2163e251f7a10aca8e538c7f13f258d8",
      "original_line" : 3999,
      "original_position" : 159,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 485526785,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-10T11:45:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486028808",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/meshcollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/meshcollider/followers",
         "following_url" : "https://api.github.com/users/meshcollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/meshcollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/meshcollider",
         "id" : 3211283,
         "login" : "meshcollider",
         "node_id" : "MDQ6VXNlcjMyMTEyODM=",
         "organizations_url" : "https://api.github.com/users/meshcollider/orgs",
         "received_events_url" : "https://api.github.com/users/meshcollider/received_events",
         "repos_url" : "https://api.github.com/users/meshcollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/meshcollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/meshcollider"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r486271735"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486271735"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Because I blindly copied it from `walletcreatefundedpsbt` :-)\r\n\r\nReplaced with simpler version.",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-10T11:44:47Z",
      "diff_hunk" : "@@ -3866,6 +3871,187 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+            \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+                    {\"include_watching\", RPCArg::Type::BOOL, /* default */ \"true for watch-only wallets, otherwise false\", \"Also select inputs which are watch only.\\n\"\n+                                          \"Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\\n\"\n+                                          \"e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.\"},\n+                    {\"inputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Specify inputs instead of adding them automatically. A json array of json objects\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lock_unspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"psbt\", RPCArg::Type::BOOL,  /* default */ \"automatic\", \"Always return a PSBT, implies add_to_wallet=false.\"},\n+                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+                {\n+                    {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n+                    {RPCResult::Type::STR_HEX, \"txid\", \"The transaction id for the send. Only 1 transaction is created regardless of the number of addresses.\"},\n+                    {RPCResult::Type::STR_HEX, \"hex\", \"If add_to_wallet is false, the hex-encoded raw transaction with signature(s)\"},\n+                    {RPCResult::Type::STR, \"psbt\", \"If more signatures are needed, or if add_to_wallet is false, the base64-encoded (partially) signed transaction\"}\n+                }\n+        },\n+        RPCExamples{\"\"\n+        \"\\nSend with a fee rate of 1 satoshi per byte\\n\"\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 sat/b\\n\" +\n+            \"\\nCreate a transaction that should confirm the next block, with a specific input, and return result without adding to wallet or broadcasting to the network\\n\")\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 economical '{\\\"add_to_wallet\\\": false, \\\"inputs\\\": [{\\\"txid\\\":\\\"a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\", \\\"vout\\\":1}]}'\")\n+        },\n+        [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n+        {\n+            RPCTypeCheck(request.params, {\n+                UniValueType(), // ARR or OBJ, checked later\n+                UniValue::VNUM,\n+                UniValue::VSTR,\n+                UniValue::VOBJ\n+                }, true\n+            );\n+\n+            std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+            if (!wallet) return NullUniValue;\n+            CWallet* const pwallet = wallet.get();\n+\n+            UniValue options = request.params[3];\n+            if (options.exists(\"feeRate\") || options.exists(\"fee_rate\") || options.exists(\"estimate_mode\") || options.exists(\"conf_target\")) {\n+                if (!request.params[1].isNull() || !request.params[2].isNull()) {\n+                    throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use either conf_target and estimate_mode or the options dictionary to control fee rate\");\n+                }\n+            } else {\n+                options.pushKV(\"conf_target\", request.params[1]);\n+                options.pushKV(\"estimate_mode\", request.params[2]);\n+            }\n+            if (!options[\"conf_target\"].isNull() && (options[\"estimate_mode\"].isNull() || (options[\"estimate_mode\"].get_str() == \"unset\"))) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Specify estimate_mode\");\n+            }\n+            if (options.exists(\"changeAddress\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_address\");\n+            }\n+            if (options.exists(\"changePosition\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_position\");\n+            }\n+            if (options.exists(\"includeWatching\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use include_watching\");\n+            }\n+            if (options.exists(\"lockUnspents\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use lock_unspents\");\n+            }\n+            if (options.exists(\"subtractFeeFromOutputs\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use subtract_fee_from_outputs\");\n+            }\n+\n+            const bool psbt_opt_in = options.exists(\"psbt\") && options[\"psbt\"].get_bool();\n+\n+            CAmount fee;\n+            int change_position;\n+            bool rbf = pwallet->m_signal_rbf;\n+            const UniValue &replaceable_arg = options[\"replaceable\"];\n+            if (!replaceable_arg.isNull()) {\n+                RPCTypeCheckArgument(replaceable_arg, UniValue::VBOOL);\n+                rbf = replaceable_arg.isTrue();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r486271735",
      "id" : 486271735,
      "in_reply_to_id" : 486028808,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjI3MTczNQ==",
      "original_commit_id" : "62d3523e2163e251f7a10aca8e538c7f13f258d8",
      "original_line" : 3999,
      "original_position" : 159,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 485845648,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-10T11:45:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486271735",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r486325092"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486325092"
         }
      },
      "author_association" : "NONE",
      "body" : "nit: parenthesis ')' in wrong place, enclosing HelpExampleCli and next example string",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-10T13:13:44Z",
      "diff_hunk" : "@@ -3857,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+            \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+                    {\"include_watching\", RPCArg::Type::BOOL, /* default */ \"true for watch-only wallets, otherwise false\", \"Also select inputs which are watch only.\\n\"\n+                                          \"Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\\n\"\n+                                          \"e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.\"},\n+                    {\"inputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Specify inputs instead of adding them automatically. A json array of json objects\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lock_unspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"psbt\", RPCArg::Type::BOOL,  /* default */ \"automatic\", \"Always return a PSBT, implies add_to_wallet=false.\"},\n+                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+                {\n+                    {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n+                    {RPCResult::Type::STR_HEX, \"txid\", \"The transaction id for the send. Only 1 transaction is created regardless of the number of addresses.\"},\n+                    {RPCResult::Type::STR_HEX, \"hex\", \"If add_to_wallet is false, the hex-encoded raw transaction with signature(s)\"},\n+                    {RPCResult::Type::STR, \"psbt\", \"If more signatures are needed, or if add_to_wallet is false, the base64-encoded (partially) signed transaction\"}\n+                }\n+        },\n+        RPCExamples{\"\"\n+        \"\\nSend with a fee rate of 1 satoshi per byte\\n\"\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 sat/b\\n\" +\n+            \"\\nCreate a transaction that should confirm the next block, with a specific input, and return result without adding to wallet or broadcasting to the network\\n\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r486325092",
      "id" : 486325092,
      "line" : 3946,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjMyNTA5Mg==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 3946,
      "original_position" : 167,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 167,
      "pull_request_review_id" : 485914977,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-10T13:13:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486325092",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/4433907?v=4",
         "events_url" : "https://api.github.com/users/ShaunApps/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ShaunApps/followers",
         "following_url" : "https://api.github.com/users/ShaunApps/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ShaunApps/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ShaunApps",
         "id" : 4433907,
         "login" : "ShaunApps",
         "node_id" : "MDQ6VXNlcjQ0MzM5MDc=",
         "organizations_url" : "https://api.github.com/users/ShaunApps/orgs",
         "received_events_url" : "https://api.github.com/users/ShaunApps/received_events",
         "repos_url" : "https://api.github.com/users/ShaunApps/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ShaunApps/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ShaunApps/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ShaunApps"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "ACK.\r\n\r\nRan functional tests. Played w/ command in cli. Left a nit",
      "created_at" : "2020-09-10T13:14:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#issuecomment-690279475",
      "id" : 690279475,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16378",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MDI3OTQ3NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-10T13:14:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/690279475",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/4433907?v=4",
         "events_url" : "https://api.github.com/users/ShaunApps/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ShaunApps/followers",
         "following_url" : "https://api.github.com/users/ShaunApps/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ShaunApps/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ShaunApps",
         "id" : 4433907,
         "login" : "ShaunApps",
         "node_id" : "MDQ6VXNlcjQ0MzM5MDc=",
         "organizations_url" : "https://api.github.com/users/ShaunApps/orgs",
         "received_events_url" : "https://api.github.com/users/ShaunApps/received_events",
         "repos_url" : "https://api.github.com/users/ShaunApps/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ShaunApps/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ShaunApps/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ShaunApps"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488315345"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488315345"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: Extra trailing comma",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T00:44:30Z",
      "diff_hunk" : "@@ -2955,16 +2956,20 @@ void FundTransaction(CWallet* const pwallet, CMutableTransaction& tx, CAmount& f\n         RPCTypeCheckObj(options,\n             {\n                 {\"add_inputs\", UniValueType(UniValue::VBOOL)},\n+                {\"add_to_wallet\", UniValueType(UniValue::VBOOL)},\n                 {\"changeAddress\", UniValueType(UniValue::VSTR)},\n                 {\"change_address\", UniValueType(UniValue::VSTR)},\n                 {\"changePosition\", UniValueType(UniValue::VNUM)},\n                 {\"change_position\", UniValueType(UniValue::VNUM)},\n                 {\"change_type\", UniValueType(UniValue::VSTR)},\n                 {\"includeWatching\", UniValueType(UniValue::VBOOL)},\n                 {\"include_watching\", UniValueType(UniValue::VBOOL)},\n+                {\"inputs\", UniValueType(UniValue::VARR)},\n                 {\"lockUnspents\", UniValueType(UniValue::VBOOL)},\n                 {\"lock_unspents\", UniValueType(UniValue::VBOOL)},\n-                {\"feeRate\", UniValueType()}, // will be checked below\n+                {\"locktime\", UniValueType(UniValue::VNUM)},\n+                {\"feeRate\", UniValueType()}, // will be checked below,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488315345",
      "id" : 488315345,
      "line" : 2971,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMxNTM0NQ==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 2971,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 25,
      "pull_request_review_id" : 488246913,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T01:33:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488315345",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488321814"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488321814"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: s/out/our",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T01:06:56Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+            \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+                    {\"include_watching\", RPCArg::Type::BOOL, /* default */ \"true for watch-only wallets, otherwise false\", \"Also select inputs which are watch only.\\n\"\n+                                          \"Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\\n\"\n+                                          \"e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.\"},\n+                    {\"inputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Specify inputs instead of adding them automatically. A json array of json objects\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lock_unspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"psbt\", RPCArg::Type::BOOL,  /* default */ \"automatic\", \"Always return a PSBT, implies add_to_wallet=false.\"},\n+                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+                {\n+                    {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n+                    {RPCResult::Type::STR_HEX, \"txid\", \"The transaction id for the send. Only 1 transaction is created regardless of the number of addresses.\"},\n+                    {RPCResult::Type::STR_HEX, \"hex\", \"If add_to_wallet is false, the hex-encoded raw transaction with signature(s)\"},\n+                    {RPCResult::Type::STR, \"psbt\", \"If more signatures are needed, or if add_to_wallet is false, the base64-encoded (partially) signed transaction\"}\n+                }\n+        },\n+        RPCExamples{\"\"\n+        \"\\nSend with a fee rate of 1 satoshi per byte\\n\"\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 sat/b\\n\" +\n+            \"\\nCreate a transaction that should confirm the next block, with a specific input, and return result without adding to wallet or broadcasting to the network\\n\")\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 economical '{\\\"add_to_wallet\\\": false, \\\"inputs\\\": [{\\\"txid\\\":\\\"a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\", \\\"vout\\\":1}]}'\")\n+        },\n+        [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n+        {\n+            RPCTypeCheck(request.params, {\n+                UniValueType(), // ARR or OBJ, checked later\n+                UniValue::VNUM,\n+                UniValue::VSTR,\n+                UniValue::VOBJ\n+                }, true\n+            );\n+\n+            std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+            if (!wallet) return NullUniValue;\n+            CWallet* const pwallet = wallet.get();\n+\n+            UniValue options = request.params[3];\n+            if (options.exists(\"feeRate\") || options.exists(\"fee_rate\") || options.exists(\"estimate_mode\") || options.exists(\"conf_target\")) {\n+                if (!request.params[1].isNull() || !request.params[2].isNull()) {\n+                    throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use either conf_target and estimate_mode or the options dictionary to control fee rate\");\n+                }\n+            } else {\n+                options.pushKV(\"conf_target\", request.params[1]);\n+                options.pushKV(\"estimate_mode\", request.params[2]);\n+            }\n+            if (!options[\"conf_target\"].isNull() && (options[\"estimate_mode\"].isNull() || (options[\"estimate_mode\"].get_str() == \"unset\"))) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Specify estimate_mode\");\n+            }\n+            if (options.exists(\"changeAddress\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_address\");\n+            }\n+            if (options.exists(\"changePosition\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_position\");\n+            }\n+            if (options.exists(\"includeWatching\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use include_watching\");\n+            }\n+            if (options.exists(\"lockUnspents\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use lock_unspents\");\n+            }\n+            if (options.exists(\"subtractFeeFromOutputs\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use subtract_fee_from_outputs\");\n+            }\n+\n+            const bool psbt_opt_in = options.exists(\"psbt\") && options[\"psbt\"].get_bool();\n+\n+            CAmount fee;\n+            int change_position;\n+            bool rbf = pwallet->m_signal_rbf;\n+            if (options.exists(\"replaceable\")) {\n+                rbf = options[\"add_to_wallet\"].get_bool();\n+            }\n+            CMutableTransaction rawTx = ConstructTransaction(options[\"inputs\"], request.params[0], options[\"locktime\"], rbf);\n+            CCoinControl coin_control;\n+            // Automatically select coins, unless at least one is manually selected. Can\n+            // be overriden by options.add_inputs.\n+            coin_control.m_add_inputs = rawTx.vin.size() == 0;\n+            FundTransaction(pwallet, rawTx, fee, change_position, options, coin_control);\n+\n+            bool add_to_wallet = true;\n+            if (options.exists(\"add_to_wallet\")) {\n+                add_to_wallet = options[\"add_to_wallet\"].get_bool();\n+            }\n+\n+            // Make a blank psbt\n+            PartiallySignedTransaction psbtx(rawTx);\n+\n+            // Fill transaction with out data and sign",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488321814",
      "id" : 488321814,
      "line" : 4014,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMyMTgxNA==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 4014,
      "original_position" : 174,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 235,
      "pull_request_review_id" : 488246913,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T01:33:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488321814",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488322349"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488322349"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Seems like this serialization should only occur if we are actually going to return the psbt, so move it inside the next if block?",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T01:08:59Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+            \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+                    {\"include_watching\", RPCArg::Type::BOOL, /* default */ \"true for watch-only wallets, otherwise false\", \"Also select inputs which are watch only.\\n\"\n+                                          \"Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\\n\"\n+                                          \"e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.\"},\n+                    {\"inputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Specify inputs instead of adding them automatically. A json array of json objects\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lock_unspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"psbt\", RPCArg::Type::BOOL,  /* default */ \"automatic\", \"Always return a PSBT, implies add_to_wallet=false.\"},\n+                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+                {\n+                    {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n+                    {RPCResult::Type::STR_HEX, \"txid\", \"The transaction id for the send. Only 1 transaction is created regardless of the number of addresses.\"},\n+                    {RPCResult::Type::STR_HEX, \"hex\", \"If add_to_wallet is false, the hex-encoded raw transaction with signature(s)\"},\n+                    {RPCResult::Type::STR, \"psbt\", \"If more signatures are needed, or if add_to_wallet is false, the base64-encoded (partially) signed transaction\"}\n+                }\n+        },\n+        RPCExamples{\"\"\n+        \"\\nSend with a fee rate of 1 satoshi per byte\\n\"\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 sat/b\\n\" +\n+            \"\\nCreate a transaction that should confirm the next block, with a specific input, and return result without adding to wallet or broadcasting to the network\\n\")\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 economical '{\\\"add_to_wallet\\\": false, \\\"inputs\\\": [{\\\"txid\\\":\\\"a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\", \\\"vout\\\":1}]}'\")\n+        },\n+        [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n+        {\n+            RPCTypeCheck(request.params, {\n+                UniValueType(), // ARR or OBJ, checked later\n+                UniValue::VNUM,\n+                UniValue::VSTR,\n+                UniValue::VOBJ\n+                }, true\n+            );\n+\n+            std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+            if (!wallet) return NullUniValue;\n+            CWallet* const pwallet = wallet.get();\n+\n+            UniValue options = request.params[3];\n+            if (options.exists(\"feeRate\") || options.exists(\"fee_rate\") || options.exists(\"estimate_mode\") || options.exists(\"conf_target\")) {\n+                if (!request.params[1].isNull() || !request.params[2].isNull()) {\n+                    throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use either conf_target and estimate_mode or the options dictionary to control fee rate\");\n+                }\n+            } else {\n+                options.pushKV(\"conf_target\", request.params[1]);\n+                options.pushKV(\"estimate_mode\", request.params[2]);\n+            }\n+            if (!options[\"conf_target\"].isNull() && (options[\"estimate_mode\"].isNull() || (options[\"estimate_mode\"].get_str() == \"unset\"))) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Specify estimate_mode\");\n+            }\n+            if (options.exists(\"changeAddress\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_address\");\n+            }\n+            if (options.exists(\"changePosition\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_position\");\n+            }\n+            if (options.exists(\"includeWatching\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use include_watching\");\n+            }\n+            if (options.exists(\"lockUnspents\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use lock_unspents\");\n+            }\n+            if (options.exists(\"subtractFeeFromOutputs\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use subtract_fee_from_outputs\");\n+            }\n+\n+            const bool psbt_opt_in = options.exists(\"psbt\") && options[\"psbt\"].get_bool();\n+\n+            CAmount fee;\n+            int change_position;\n+            bool rbf = pwallet->m_signal_rbf;\n+            if (options.exists(\"replaceable\")) {\n+                rbf = options[\"add_to_wallet\"].get_bool();\n+            }\n+            CMutableTransaction rawTx = ConstructTransaction(options[\"inputs\"], request.params[0], options[\"locktime\"], rbf);\n+            CCoinControl coin_control;\n+            // Automatically select coins, unless at least one is manually selected. Can\n+            // be overriden by options.add_inputs.\n+            coin_control.m_add_inputs = rawTx.vin.size() == 0;\n+            FundTransaction(pwallet, rawTx, fee, change_position, options, coin_control);\n+\n+            bool add_to_wallet = true;\n+            if (options.exists(\"add_to_wallet\")) {\n+                add_to_wallet = options[\"add_to_wallet\"].get_bool();\n+            }\n+\n+            // Make a blank psbt\n+            PartiallySignedTransaction psbtx(rawTx);\n+\n+            // Fill transaction with out data and sign\n+            bool complete = true;\n+            const TransactionError err = pwallet->FillPSBT(psbtx, complete, SIGHASH_ALL, true, false);\n+            if (err != TransactionError::OK) {\n+                throw JSONRPCTransactionError(err);\n+            }\n+\n+            CMutableTransaction mtx;\n+            complete = FinalizeAndExtractPSBT(psbtx, mtx);\n+\n+            UniValue result(UniValue::VOBJ);\n+\n+            // Serialize the PSBT\n+            CDataStream ssTx(SER_NETWORK, PROTOCOL_VERSION);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488322349",
      "id" : 488322349,
      "line" : 4027,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMyMjM0OQ==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 4027,
      "original_position" : 187,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 248,
      "pull_request_review_id" : 488246913,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T01:33:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488322349",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488322773"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488322773"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: spaces after each arg, here and below",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T01:10:34Z",
      "diff_hunk" : "@@ -0,0 +1,339 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the send RPC command.\"\"\"\n+\n+from decimal import Decimal, getcontext\n+from test_framework.authproxy import JSONRPCException\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_fee_amount,\n+    assert_greater_than,\n+    assert_raises_rpc_error\n+)\n+\n+class WalletSendTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        # whitelist all peers to speed up tx relay / mempool sync\n+        self.extra_args = [\n+            [\"-whitelist=127.0.0.1\",\"-walletrbf=1\"],\n+            [\"-whitelist=127.0.0.1\",\"-walletrbf=1\"],\n+        ]\n+        getcontext().prec = 8 # Satoshi precision for Decimal\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def test_send(self, from_wallet, to_wallet=None, amount=None, data=None,\n+                  arg_conf_target=None, arg_estimate_mode=None,\n+                  conf_target=None, estimate_mode=None, add_to_wallet=None,psbt=None,\n+                  inputs=None,add_inputs=None,change_address=None,change_position=None,change_type=None,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488322773",
      "id" : 488322773,
      "line" : 33,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMyMjc3Mw==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 33,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : 33,
      "pull_request_review_id" : 488246913,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T01:33:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488322773",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488323964"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488323964"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Seems like it would be better to call this `broadcast` rather than `add_to_wallet`.",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T01:15:11Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488323964",
      "id" : 488323964,
      "line" : 3901,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMyMzk2NA==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 3901,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 122,
      "pull_request_review_id" : 488246913,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T01:33:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488323964",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488325666"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488325666"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think that's supposed to be 0.1, not 1.000",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T01:21:17Z",
      "diff_hunk" : "@@ -0,0 +1,339 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the send RPC command.\"\"\"\n+\n+from decimal import Decimal, getcontext\n+from test_framework.authproxy import JSONRPCException\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_fee_amount,\n+    assert_greater_than,\n+    assert_raises_rpc_error\n+)\n+\n+class WalletSendTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        # whitelist all peers to speed up tx relay / mempool sync\n+        self.extra_args = [\n+            [\"-whitelist=127.0.0.1\",\"-walletrbf=1\"],\n+            [\"-whitelist=127.0.0.1\",\"-walletrbf=1\"],\n+        ]\n+        getcontext().prec = 8 # Satoshi precision for Decimal\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def test_send(self, from_wallet, to_wallet=None, amount=None, data=None,\n+                  arg_conf_target=None, arg_estimate_mode=None,\n+                  conf_target=None, estimate_mode=None, add_to_wallet=None,psbt=None,\n+                  inputs=None,add_inputs=None,change_address=None,change_position=None,change_type=None,\n+                  include_watching=None,locktime=None,lock_unspents=None,replaceable=None,subtract_fee_from_outputs=None,\n+                  expect_error=None):\n+        assert (amount is None) != (data is None)\n+\n+        from_balance_before = from_wallet.getbalance()\n+        if to_wallet is None:\n+            assert amount is None\n+        else:\n+            to_untrusted_pending_before = to_wallet.getbalances()[\"mine\"][\"untrusted_pending\"]\n+\n+        if amount:\n+            dest = to_wallet.getnewaddress()\n+            outputs = {dest: amount}\n+        else:\n+            outputs = {\"data\": data}\n+\n+        # Construct options dictionary\n+        options = {}\n+        if add_to_wallet is not None:\n+            options[\"add_to_wallet\"] = add_to_wallet\n+        else:\n+            if psbt:\n+                add_to_wallet = False\n+            else:\n+                add_to_wallet = from_wallet.getwalletinfo()[\"private_keys_enabled\"] # Default value\n+        if psbt is not None:\n+            options[\"psbt\"] = psbt\n+        if conf_target is not None:\n+            options[\"conf_target\"] = conf_target\n+        if estimate_mode is not None:\n+            options[\"estimate_mode\"] = estimate_mode\n+        if inputs is not None:\n+            options[\"inputs\"] = inputs\n+        if add_inputs is not None:\n+            options[\"add_inputs\"] = add_inputs\n+        if change_address is not None:\n+            options[\"change_address\"] = change_address\n+        if change_position is not None:\n+            options[\"change_position\"] = change_position\n+        if change_type is not None:\n+            options[\"change_type\"] = change_type\n+        if include_watching is not None:\n+            options[\"include_watching\"] = include_watching\n+        if locktime is not None:\n+            options[\"locktime\"] = locktime\n+        if lock_unspents is not None:\n+            options[\"lock_unspents\"] = lock_unspents\n+        if replaceable is None:\n+            replaceable = True # default\n+        else:\n+            options[\"replaceable\"] = replaceable\n+        if subtract_fee_from_outputs is not None:\n+            options[\"subtract_fee_from_outputs\"] = subtract_fee_from_outputs\n+\n+        if len(options.keys()) == 0:\n+            options = None\n+\n+        if expect_error is None:\n+            res = from_wallet.send(outputs=outputs, conf_target=arg_conf_target, estimate_mode=arg_estimate_mode, options=options)\n+        else:\n+            try:\n+                assert_raises_rpc_error(expect_error[0],expect_error[1],from_wallet.send,\n+                                        outputs=outputs,conf_target=arg_conf_target,estimate_mode=arg_estimate_mode,options=options)\n+            except AssertionError:\n+                # Provide debug info if the test fails\n+                self.log.error(\"Unexpected successful result:\")\n+                self.log.error(options)\n+                res = from_wallet.send(outputs=outputs,conf_target=arg_conf_target,estimate_mode=arg_estimate_mode,options=options)\n+                self.log.error(res)\n+                if \"txid\" in res and add_to_wallet:\n+                    self.log.error(\"Transaction details:\")\n+                    try:\n+                        tx = from_wallet.gettransaction(res[\"txid\"])\n+                        self.log.error(tx)\n+                        self.log.error(\"testmempoolaccept (transaction may already be in mempool):\")\n+                        self.log.error(from_wallet.testmempoolaccept([tx[\"hex\"]]))\n+                    except JSONRPCException as exc:\n+                        self.log.error(exc)\n+\n+                raise\n+\n+            return\n+\n+        if locktime:\n+            return res\n+\n+        if from_wallet.getwalletinfo()[\"private_keys_enabled\"] and not include_watching:\n+            assert_equal(res[\"complete\"], True)\n+            assert \"txid\" in res\n+        else:\n+            assert_equal(res[\"complete\"], False)\n+            assert not \"txid\" in res\n+            assert \"psbt\" in res\n+\n+        if add_to_wallet and not include_watching:\n+            # Ensure transaction exists in the wallet:\n+            tx = from_wallet.gettransaction(res[\"txid\"])\n+            assert tx\n+            assert_equal(tx[\"bip125-replaceable\"], \"yes\" if replaceable else \"no\")\n+            # Ensure transaction exists in the mempool:\n+            tx = from_wallet.getrawtransaction(res[\"txid\"],True)\n+            assert tx\n+            if amount:\n+                if subtract_fee_from_outputs:\n+                    assert_equal(from_balance_before - from_wallet.getbalance(), amount)\n+                else:\n+                    assert_greater_than(from_balance_before - from_wallet.getbalance(), amount)\n+            else:\n+                assert next((out for out in tx[\"vout\"] if out[\"scriptPubKey\"][\"asm\"] == \"OP_RETURN 35\"), None)\n+        else:\n+            assert_equal(from_balance_before, from_wallet.getbalance())\n+\n+        if to_wallet:\n+            self.sync_mempools()\n+            if add_to_wallet:\n+                if not subtract_fee_from_outputs:\n+                    assert_equal(to_wallet.getbalances()[\"mine\"][\"untrusted_pending\"], to_untrusted_pending_before + Decimal(amount if amount else 0))\n+            else:\n+                assert_equal(to_wallet.getbalances()[\"mine\"][\"untrusted_pending\"], to_untrusted_pending_before)\n+\n+        return res\n+\n+    def run_test(self):\n+        self.log.info(\"Setup wallets...\")\n+        # w0 is a wallet with coinbase rewards\n+        w0 = self.nodes[0].get_wallet_rpc(\"\")\n+        # w1 is a regular wallet\n+        self.nodes[1].createwallet(wallet_name=\"w1\")\n+        w1 = self.nodes[1].get_wallet_rpc(\"w1\")\n+        # w2 contains the private keys for w3\n+        self.nodes[1].createwallet(wallet_name=\"w2\")\n+        w2 = self.nodes[1].get_wallet_rpc(\"w2\")\n+        # w3 is a watch-only wallet, based on w2\n+        self.nodes[1].createwallet(wallet_name=\"w3\",disable_private_keys=True)\n+        w3 = self.nodes[1].get_wallet_rpc(\"w3\")\n+        for _ in range(3):\n+            a2_receive = w2.getnewaddress()\n+            a2_change = w2.getrawchangeaddress() # doesn't actually use change derivation\n+            res = w3.importmulti([{\n+                \"desc\": w2.getaddressinfo(a2_receive)[\"desc\"],\n+                \"timestamp\": \"now\",\n+                \"keypool\": True,\n+                \"watchonly\": True\n+            },{\n+                \"desc\": w2.getaddressinfo(a2_change)[\"desc\"],\n+                \"timestamp\": \"now\",\n+                \"keypool\": True,\n+                \"internal\": True,\n+                \"watchonly\": True\n+            }])\n+            assert_equal(res, [{\"success\": True}, {\"success\": True}])\n+\n+        w0.sendtoaddress(a2_receive, 10) # fund w3\n+        self.nodes[0].generate(1)\n+        self.sync_blocks()\n+\n+        # w4 has private keys enabled, but only contains watch-only keys (from w2)\n+        self.nodes[1].createwallet(wallet_name=\"w4\",disable_private_keys=False)\n+        w4 = self.nodes[1].get_wallet_rpc(\"w4\")\n+        for _ in range(3):\n+            a2_receive = w2.getnewaddress()\n+            res = w4.importmulti([{\n+                \"desc\": w2.getaddressinfo(a2_receive)[\"desc\"],\n+                \"timestamp\": \"now\",\n+                \"keypool\": False,\n+                \"watchonly\": True\n+            }])\n+            assert_equal(res, [{\"success\": True}])\n+\n+        w0.sendtoaddress(a2_receive, 10) # fund w4\n+        self.nodes[0].generate(1)\n+        self.sync_blocks()\n+\n+        self.log.info(\"Send to address...\")\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1)\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=True)\n+\n+        self.log.info(\"Don't broadcast...\")\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=False)\n+        assert(res[\"hex\"])\n+\n+        self.log.info(\"Return PSBT...\")\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, psbt=True)\n+        assert(res[\"psbt\"])\n+\n+        self.log.info(\"Create transaction that spends to address, but don't broadcast...\")\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=False)\n+        # conf_target & estimate_mode can be set as argument or option\n+        res1 = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=1, arg_estimate_mode=\"economical\", add_to_wallet=False)\n+        res2 = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=1, estimate_mode=\"economical\", add_to_wallet=False)\n+        assert_equal(self.nodes[1].decodepsbt(res1[\"psbt\"])[\"fee\"],\n+                     self.nodes[1].decodepsbt(res2[\"psbt\"])[\"fee\"])\n+        # but not at the same time\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=1, arg_estimate_mode=\"economical\",\n+                       conf_target=1, estimate_mode=\"economical\", add_to_wallet=False, expect_error=(-8,\"Use either conf_target and estimate_mode or the options dictionary to control fee rate\"))\n+\n+        self.log.info(\"Create PSBT from watch-only wallet w3, sign with w2...\")\n+        res = self.test_send(from_wallet=w3, to_wallet=w1, amount=1)\n+        res = w2.walletprocesspsbt(res[\"psbt\"])\n+        assert res[\"complete\"]\n+\n+        self.log.info(\"Create PSBT from wallet w4 with watch-only keys, sign with w2...\")\n+        self.test_send(from_wallet=w4, to_wallet=w1, amount=1, expect_error=(-4, \"Insufficient funds\"))\n+        res = self.test_send(from_wallet=w4, to_wallet=w1, amount=1, include_watching=True, add_to_wallet=False)\n+        res = w2.walletprocesspsbt(res[\"psbt\"])\n+        assert res[\"complete\"]\n+\n+        self.log.info(\"Create OP_RETURN...\")\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1)\n+        self.test_send(from_wallet=w0, data=\"Hello World\", expect_error=(-8, \"Data must be hexadecimal string (not 'Hello World')\"))\n+        self.test_send(from_wallet=w0, data=\"23\")\n+        res = self.test_send(from_wallet=w3, data=\"23\")\n+        res = w2.walletprocesspsbt(res[\"psbt\"])\n+        assert res[\"complete\"]\n+\n+        self.log.info(\"Set fee rate...\")\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=2, estimate_mode=\"sat/b\", add_to_wallet=False)\n+        fee = self.nodes[1].decodepsbt(res[\"psbt\"])[\"fee\"]\n+        assert_fee_amount(fee, Decimal(len(res[\"hex\"]) / 2), Decimal(\"0.00002\"))\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=-1, estimate_mode=\"sat/b\",\n+                       expect_error=(-3, \"Amount out of range\"))\n+        # Fee rate of 0.1 satoshi per byte should throw an error\n+        # TODO: error should say 1.000 sat/b",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488325666",
      "id" : 488325666,
      "line" : 256,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMyNTY2Ng==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 256,
      "original_position" : 256,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : 256,
      "pull_request_review_id" : 488246913,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T01:33:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488325666",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488342027"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488342027"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`[rpc] walletcreatefundedpsbt: allow inputs to be null`:\r\n\r\nStyle-nit: add `{}` while at it, since you're touching this line.",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T02:19:01Z",
      "diff_hunk" : "@@ -21,10 +21,15 @@\n \n CMutableTransaction ConstructTransaction(const UniValue& inputs_in, const UniValue& outputs_in, const UniValue& locktime, bool rbf)\n {\n-    if (inputs_in.isNull() || outputs_in.isNull())\n-        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid parameter, arguments 1 and 2 must be non-null\");\n+    if (outputs_in.isNull())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488342027",
      "id" : 488342027,
      "line" : 24,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM0MjAyNw==",
      "original_commit_id" : "1bc8d0fd5906bc9637d513cd193a1f47ad94da28",
      "original_line" : 24,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction_util.cpp",
      "position" : 6,
      "pull_request_review_id" : 488276068,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T02:47:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488342027",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488342222"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488342222"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`[rpc] walletcreatefundedpsbt: allow inputs to be null`:\r\n\r\nAdd `{}`s.",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T02:19:44Z",
      "diff_hunk" : "@@ -21,10 +21,15 @@\n \n CMutableTransaction ConstructTransaction(const UniValue& inputs_in, const UniValue& outputs_in, const UniValue& locktime, bool rbf)\n {\n-    if (inputs_in.isNull() || outputs_in.isNull())\n-        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid parameter, arguments 1 and 2 must be non-null\");\n+    if (outputs_in.isNull())\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid parameter, output argument must be non-null\");\n+\n+    UniValue inputs;\n+    if (inputs_in.isNull())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488342222",
      "id" : 488342222,
      "line" : 28,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM0MjIyMg==",
      "original_commit_id" : "1bc8d0fd5906bc9637d513cd193a1f47ad94da28",
      "original_line" : 28,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction_util.cpp",
      "position" : 10,
      "pull_request_review_id" : 488276068,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T02:47:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488342222",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488344542"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488344542"
         }
      },
      "author_association" : "MEMBER",
      "body" : "We have at least one of these already; these may deserve a helper function.\r\n```C++\r\nUniValue GetAliasedOption(const UniValue& options, const std::string& name, const std::string& alias)\r\n{\r\n    switch (options.exists(name) + options.exists(alias)) {\r\n    case 0: return NullUniValue;\r\n    case 1: return options.exists(name) ? options[name] : options[alias];\r\n    }\r\n    throw JSONRPCError(RPC_INVALID_PARAMETER, \"Cannot use both \" + name + \" and \" + alias + \" simultaneously.\");\r\n}\r\n```\r\nthen this becomes\r\n```C++\r\nUniValue addr = GetAliasedOption(options, \"change_address\", \"changeAddress\"));\r\nif (!addr.isNull()) {\r\n    CTxDestination dest = DecodeDestination(addr.get_str());\r\n    ...\r\n```\r\n",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T02:27:39Z",
      "diff_hunk" : "@@ -2972,22 +2977,24 @@ void FundTransaction(CWallet* const pwallet, CMutableTransaction& tx, CAmount& f\n             coinControl.m_add_inputs = options[\"add_inputs\"].get_bool();\n         }\n \n-        if (options.exists(\"changeAddress\")) {\n-            CTxDestination dest = DecodeDestination(options[\"changeAddress\"].get_str());\n+        if (options.exists(\"changeAddress\") || options.exists(\"change_address\")) {\n+            const std::string change_address_str = (options.exists(\"change_address\") ? options[\"change_address\"] : options[\"changeAddress\"]).get_str();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488344542",
      "id" : 488344542,
      "line" : 2986,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM0NDU0Mg==",
      "original_commit_id" : "2c2a1445dc9d22c9d729b8301c8b3f54195bcfcf",
      "original_line" : 2981,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 39,
      "pull_request_review_id" : 488276068,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T02:47:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488344542",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488347026"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488347026"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`RPCArg::Type::AMOUNT` is not a key-value pair. I think you mean `RPCArg::Type::OBJ`.",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T02:36:39Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488347026",
      "id" : 488347026,
      "line" : 3885,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM0NzAyNg==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 3885,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 106,
      "pull_request_review_id" : 488276068,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T02:47:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488347026",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488347536"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488347536"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`RPCArg::Type::STR_HEX` is not a key-value pair either. I think you mean `RPCArg::Type::OBJ` here too.",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T02:38:27Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488347536",
      "id" : 488347536,
      "line" : 3890,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM0NzUzNg==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 3890,
      "original_position" : 50,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 111,
      "pull_request_review_id" : 488276068,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T02:47:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488347536",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488348105"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488348105"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why are there two conf_target and estimate_mode parameters?",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T02:40:23Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488348105",
      "id" : 488348105,
      "line" : 3906,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM0ODEwNQ==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 3906,
      "original_position" : 66,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 127,
      "pull_request_review_id" : 488276068,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T02:47:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488348105",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488349241"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488349241"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Alternative:\r\n```C++\r\nbool add_to_wallet = !options.exists(\"add_to_wallet\") || options[\"add_to_wallet\"].get_bool();\r\n```\r\n",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T02:44:23Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+            \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+                    {\"include_watching\", RPCArg::Type::BOOL, /* default */ \"true for watch-only wallets, otherwise false\", \"Also select inputs which are watch only.\\n\"\n+                                          \"Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\\n\"\n+                                          \"e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.\"},\n+                    {\"inputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Specify inputs instead of adding them automatically. A json array of json objects\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lock_unspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"psbt\", RPCArg::Type::BOOL,  /* default */ \"automatic\", \"Always return a PSBT, implies add_to_wallet=false.\"},\n+                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+                {\n+                    {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n+                    {RPCResult::Type::STR_HEX, \"txid\", \"The transaction id for the send. Only 1 transaction is created regardless of the number of addresses.\"},\n+                    {RPCResult::Type::STR_HEX, \"hex\", \"If add_to_wallet is false, the hex-encoded raw transaction with signature(s)\"},\n+                    {RPCResult::Type::STR, \"psbt\", \"If more signatures are needed, or if add_to_wallet is false, the base64-encoded (partially) signed transaction\"}\n+                }\n+        },\n+        RPCExamples{\"\"\n+        \"\\nSend with a fee rate of 1 satoshi per byte\\n\"\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 sat/b\\n\" +\n+            \"\\nCreate a transaction that should confirm the next block, with a specific input, and return result without adding to wallet or broadcasting to the network\\n\")\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 economical '{\\\"add_to_wallet\\\": false, \\\"inputs\\\": [{\\\"txid\\\":\\\"a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\", \\\"vout\\\":1}]}'\")\n+        },\n+        [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n+        {\n+            RPCTypeCheck(request.params, {\n+                UniValueType(), // ARR or OBJ, checked later\n+                UniValue::VNUM,\n+                UniValue::VSTR,\n+                UniValue::VOBJ\n+                }, true\n+            );\n+\n+            std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+            if (!wallet) return NullUniValue;\n+            CWallet* const pwallet = wallet.get();\n+\n+            UniValue options = request.params[3];\n+            if (options.exists(\"feeRate\") || options.exists(\"fee_rate\") || options.exists(\"estimate_mode\") || options.exists(\"conf_target\")) {\n+                if (!request.params[1].isNull() || !request.params[2].isNull()) {\n+                    throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use either conf_target and estimate_mode or the options dictionary to control fee rate\");\n+                }\n+            } else {\n+                options.pushKV(\"conf_target\", request.params[1]);\n+                options.pushKV(\"estimate_mode\", request.params[2]);\n+            }\n+            if (!options[\"conf_target\"].isNull() && (options[\"estimate_mode\"].isNull() || (options[\"estimate_mode\"].get_str() == \"unset\"))) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Specify estimate_mode\");\n+            }\n+            if (options.exists(\"changeAddress\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_address\");\n+            }\n+            if (options.exists(\"changePosition\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_position\");\n+            }\n+            if (options.exists(\"includeWatching\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use include_watching\");\n+            }\n+            if (options.exists(\"lockUnspents\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use lock_unspents\");\n+            }\n+            if (options.exists(\"subtractFeeFromOutputs\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use subtract_fee_from_outputs\");\n+            }\n+\n+            const bool psbt_opt_in = options.exists(\"psbt\") && options[\"psbt\"].get_bool();\n+\n+            CAmount fee;\n+            int change_position;\n+            bool rbf = pwallet->m_signal_rbf;\n+            if (options.exists(\"replaceable\")) {\n+                rbf = options[\"add_to_wallet\"].get_bool();\n+            }\n+            CMutableTransaction rawTx = ConstructTransaction(options[\"inputs\"], request.params[0], options[\"locktime\"], rbf);\n+            CCoinControl coin_control;\n+            // Automatically select coins, unless at least one is manually selected. Can\n+            // be overriden by options.add_inputs.\n+            coin_control.m_add_inputs = rawTx.vin.size() == 0;\n+            FundTransaction(pwallet, rawTx, fee, change_position, options, coin_control);\n+\n+            bool add_to_wallet = true;\n+            if (options.exists(\"add_to_wallet\")) {\n+                add_to_wallet = options[\"add_to_wallet\"].get_bool();\n+            }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488349241",
      "id" : 488349241,
      "line" : 4009,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM0OTI0MQ==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 4009,
      "original_position" : 169,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 230,
      "pull_request_review_id" : 488276068,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T02:48:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488349241",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Nits can be left for followup, let's get this in to move #16546 forward  ",
      "created_at" : "2020-09-15T02:51:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#issuecomment-692430345",
      "id" : 692430345,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16378",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MjQzMDM0NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-15T02:51:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/692430345",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/meshcollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/meshcollider/followers",
         "following_url" : "https://api.github.com/users/meshcollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/meshcollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/meshcollider",
         "id" : 3211283,
         "login" : "meshcollider",
         "node_id" : "MDQ6VXNlcjMyMTEyODM=",
         "organizations_url" : "https://api.github.com/users/meshcollider/orgs",
         "received_events_url" : "https://api.github.com/users/meshcollider/received_events",
         "repos_url" : "https://api.github.com/users/meshcollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/meshcollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/meshcollider"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488690111"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488690111"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Would be more robust to throw an error if both options are set.",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T13:58:26Z",
      "diff_hunk" : "@@ -2972,22 +2977,24 @@ void FundTransaction(CWallet* const pwallet, CMutableTransaction& tx, CAmount& f\n             coinControl.m_add_inputs = options[\"add_inputs\"].get_bool();\n         }\n \n-        if (options.exists(\"changeAddress\")) {\n-            CTxDestination dest = DecodeDestination(options[\"changeAddress\"].get_str());\n+        if (options.exists(\"changeAddress\") || options.exists(\"change_address\")) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488690111",
      "id" : 488690111,
      "line" : 2985,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODY5MDExMQ==",
      "original_commit_id" : "2c2a1445dc9d22c9d729b8301c8b3f54195bcfcf",
      "original_line" : 2980,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 38,
      "pull_request_review_id" : 488713127,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T16:03:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488690111",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488692783"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488692783"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: JSON, Capitalize A",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T14:01:49Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488692783",
      "id" : 488692783,
      "line" : 3879,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODY5Mjc4Mw==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 3879,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 100,
      "pull_request_review_id" : 488713127,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T16:03:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488692783",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488694616"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488694616"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: JSON",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T14:04:15Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+            \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+                    {\"include_watching\", RPCArg::Type::BOOL, /* default */ \"true for watch-only wallets, otherwise false\", \"Also select inputs which are watch only.\\n\"\n+                                          \"Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\\n\"\n+                                          \"e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.\"},\n+                    {\"inputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Specify inputs instead of adding them automatically. A json array of json objects\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lock_unspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"psbt\", RPCArg::Type::BOOL,  /* default */ \"automatic\", \"Always return a PSBT, implies add_to_wallet=false.\"},\n+                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488694616",
      "id" : 488694616,
      "line" : 3921,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODY5NDYxNg==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 3921,
      "original_position" : 81,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 142,
      "pull_request_review_id" : 488713127,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T16:03:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488694616",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488695442"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488695442"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: JSON",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T14:05:19Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+            \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+                    {\"include_watching\", RPCArg::Type::BOOL, /* default */ \"true for watch-only wallets, otherwise false\", \"Also select inputs which are watch only.\\n\"\n+                                          \"Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\\n\"\n+                                          \"e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.\"},\n+                    {\"inputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Specify inputs instead of adding them automatically. A json array of json objects\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488695442",
      "id" : 488695442,
      "line" : 3911,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODY5NTQ0Mg==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 3911,
      "original_position" : 71,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 132,
      "pull_request_review_id" : 488713127,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T16:03:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488695442",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488698235"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488698235"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This seems like an bug? s/\"add_to_wallet\"/\"replaceable\"/",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T14:09:12Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+            \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+                    {\"include_watching\", RPCArg::Type::BOOL, /* default */ \"true for watch-only wallets, otherwise false\", \"Also select inputs which are watch only.\\n\"\n+                                          \"Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\\n\"\n+                                          \"e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.\"},\n+                    {\"inputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Specify inputs instead of adding them automatically. A json array of json objects\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lock_unspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"psbt\", RPCArg::Type::BOOL,  /* default */ \"automatic\", \"Always return a PSBT, implies add_to_wallet=false.\"},\n+                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+                {\n+                    {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n+                    {RPCResult::Type::STR_HEX, \"txid\", \"The transaction id for the send. Only 1 transaction is created regardless of the number of addresses.\"},\n+                    {RPCResult::Type::STR_HEX, \"hex\", \"If add_to_wallet is false, the hex-encoded raw transaction with signature(s)\"},\n+                    {RPCResult::Type::STR, \"psbt\", \"If more signatures are needed, or if add_to_wallet is false, the base64-encoded (partially) signed transaction\"}\n+                }\n+        },\n+        RPCExamples{\"\"\n+        \"\\nSend with a fee rate of 1 satoshi per byte\\n\"\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 sat/b\\n\" +\n+            \"\\nCreate a transaction that should confirm the next block, with a specific input, and return result without adding to wallet or broadcasting to the network\\n\")\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 economical '{\\\"add_to_wallet\\\": false, \\\"inputs\\\": [{\\\"txid\\\":\\\"a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\", \\\"vout\\\":1}]}'\")\n+        },\n+        [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n+        {\n+            RPCTypeCheck(request.params, {\n+                UniValueType(), // ARR or OBJ, checked later\n+                UniValue::VNUM,\n+                UniValue::VSTR,\n+                UniValue::VOBJ\n+                }, true\n+            );\n+\n+            std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+            if (!wallet) return NullUniValue;\n+            CWallet* const pwallet = wallet.get();\n+\n+            UniValue options = request.params[3];\n+            if (options.exists(\"feeRate\") || options.exists(\"fee_rate\") || options.exists(\"estimate_mode\") || options.exists(\"conf_target\")) {\n+                if (!request.params[1].isNull() || !request.params[2].isNull()) {\n+                    throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use either conf_target and estimate_mode or the options dictionary to control fee rate\");\n+                }\n+            } else {\n+                options.pushKV(\"conf_target\", request.params[1]);\n+                options.pushKV(\"estimate_mode\", request.params[2]);\n+            }\n+            if (!options[\"conf_target\"].isNull() && (options[\"estimate_mode\"].isNull() || (options[\"estimate_mode\"].get_str() == \"unset\"))) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Specify estimate_mode\");\n+            }\n+            if (options.exists(\"changeAddress\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_address\");\n+            }\n+            if (options.exists(\"changePosition\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_position\");\n+            }\n+            if (options.exists(\"includeWatching\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use include_watching\");\n+            }\n+            if (options.exists(\"lockUnspents\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use lock_unspents\");\n+            }\n+            if (options.exists(\"subtractFeeFromOutputs\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use subtract_fee_from_outputs\");\n+            }\n+\n+            const bool psbt_opt_in = options.exists(\"psbt\") && options[\"psbt\"].get_bool();\n+\n+            CAmount fee;\n+            int change_position;\n+            bool rbf = pwallet->m_signal_rbf;\n+            if (options.exists(\"replaceable\")) {\n+                rbf = options[\"add_to_wallet\"].get_bool();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488698235",
      "id" : 488698235,
      "line" : 3997,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODY5ODIzNQ==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 3997,
      "original_position" : 157,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 218,
      "pull_request_review_id" : 488713127,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T16:03:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488698235",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488701017"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488701017"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: Maybe this and comparable sections could be compressed with ternaries as well\r\n```\r\nconst bool rbf = options.exists(\"replaceable\") ? options[\"add_to_wallet\"].get_bool() : pwallet->m_signal_rbf;\r\n```\r\n\r\nEDIT: or see kalle's suggestion...",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T14:12:55Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+            \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+                    {\"include_watching\", RPCArg::Type::BOOL, /* default */ \"true for watch-only wallets, otherwise false\", \"Also select inputs which are watch only.\\n\"\n+                                          \"Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\\n\"\n+                                          \"e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.\"},\n+                    {\"inputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Specify inputs instead of adding them automatically. A json array of json objects\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lock_unspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"psbt\", RPCArg::Type::BOOL,  /* default */ \"automatic\", \"Always return a PSBT, implies add_to_wallet=false.\"},\n+                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+                {\n+                    {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n+                    {RPCResult::Type::STR_HEX, \"txid\", \"The transaction id for the send. Only 1 transaction is created regardless of the number of addresses.\"},\n+                    {RPCResult::Type::STR_HEX, \"hex\", \"If add_to_wallet is false, the hex-encoded raw transaction with signature(s)\"},\n+                    {RPCResult::Type::STR, \"psbt\", \"If more signatures are needed, or if add_to_wallet is false, the base64-encoded (partially) signed transaction\"}\n+                }\n+        },\n+        RPCExamples{\"\"\n+        \"\\nSend with a fee rate of 1 satoshi per byte\\n\"\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 sat/b\\n\" +\n+            \"\\nCreate a transaction that should confirm the next block, with a specific input, and return result without adding to wallet or broadcasting to the network\\n\")\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 economical '{\\\"add_to_wallet\\\": false, \\\"inputs\\\": [{\\\"txid\\\":\\\"a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\", \\\"vout\\\":1}]}'\")\n+        },\n+        [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n+        {\n+            RPCTypeCheck(request.params, {\n+                UniValueType(), // ARR or OBJ, checked later\n+                UniValue::VNUM,\n+                UniValue::VSTR,\n+                UniValue::VOBJ\n+                }, true\n+            );\n+\n+            std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+            if (!wallet) return NullUniValue;\n+            CWallet* const pwallet = wallet.get();\n+\n+            UniValue options = request.params[3];\n+            if (options.exists(\"feeRate\") || options.exists(\"fee_rate\") || options.exists(\"estimate_mode\") || options.exists(\"conf_target\")) {\n+                if (!request.params[1].isNull() || !request.params[2].isNull()) {\n+                    throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use either conf_target and estimate_mode or the options dictionary to control fee rate\");\n+                }\n+            } else {\n+                options.pushKV(\"conf_target\", request.params[1]);\n+                options.pushKV(\"estimate_mode\", request.params[2]);\n+            }\n+            if (!options[\"conf_target\"].isNull() && (options[\"estimate_mode\"].isNull() || (options[\"estimate_mode\"].get_str() == \"unset\"))) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Specify estimate_mode\");\n+            }\n+            if (options.exists(\"changeAddress\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_address\");\n+            }\n+            if (options.exists(\"changePosition\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_position\");\n+            }\n+            if (options.exists(\"includeWatching\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use include_watching\");\n+            }\n+            if (options.exists(\"lockUnspents\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use lock_unspents\");\n+            }\n+            if (options.exists(\"subtractFeeFromOutputs\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use subtract_fee_from_outputs\");\n+            }\n+\n+            const bool psbt_opt_in = options.exists(\"psbt\") && options[\"psbt\"].get_bool();\n+\n+            CAmount fee;\n+            int change_position;\n+            bool rbf = pwallet->m_signal_rbf;\n+            if (options.exists(\"replaceable\")) {\n+                rbf = options[\"add_to_wallet\"].get_bool();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488701017",
      "id" : 488701017,
      "in_reply_to_id" : 488698235,
      "line" : 3997,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODcwMTAxNw==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 3997,
      "original_position" : 157,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 218,
      "pull_request_review_id" : 488713127,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T16:03:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488701017",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488711853"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488711853"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The assert if the replaceable option was actually set is only done if the tx is added to the wallet, so I think these tests can not fail.",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T14:26:43Z",
      "diff_hunk" : "@@ -0,0 +1,339 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the send RPC command.\"\"\"\n+\n+from decimal import Decimal, getcontext\n+from test_framework.authproxy import JSONRPCException\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_fee_amount,\n+    assert_greater_than,\n+    assert_raises_rpc_error\n+)\n+\n+class WalletSendTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        # whitelist all peers to speed up tx relay / mempool sync\n+        self.extra_args = [\n+            [\"-whitelist=127.0.0.1\",\"-walletrbf=1\"],\n+            [\"-whitelist=127.0.0.1\",\"-walletrbf=1\"],\n+        ]\n+        getcontext().prec = 8 # Satoshi precision for Decimal\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def test_send(self, from_wallet, to_wallet=None, amount=None, data=None,\n+                  arg_conf_target=None, arg_estimate_mode=None,\n+                  conf_target=None, estimate_mode=None, add_to_wallet=None,psbt=None,\n+                  inputs=None,add_inputs=None,change_address=None,change_position=None,change_type=None,\n+                  include_watching=None,locktime=None,lock_unspents=None,replaceable=None,subtract_fee_from_outputs=None,\n+                  expect_error=None):\n+        assert (amount is None) != (data is None)\n+\n+        from_balance_before = from_wallet.getbalance()\n+        if to_wallet is None:\n+            assert amount is None\n+        else:\n+            to_untrusted_pending_before = to_wallet.getbalances()[\"mine\"][\"untrusted_pending\"]\n+\n+        if amount:\n+            dest = to_wallet.getnewaddress()\n+            outputs = {dest: amount}\n+        else:\n+            outputs = {\"data\": data}\n+\n+        # Construct options dictionary\n+        options = {}\n+        if add_to_wallet is not None:\n+            options[\"add_to_wallet\"] = add_to_wallet\n+        else:\n+            if psbt:\n+                add_to_wallet = False\n+            else:\n+                add_to_wallet = from_wallet.getwalletinfo()[\"private_keys_enabled\"] # Default value\n+        if psbt is not None:\n+            options[\"psbt\"] = psbt\n+        if conf_target is not None:\n+            options[\"conf_target\"] = conf_target\n+        if estimate_mode is not None:\n+            options[\"estimate_mode\"] = estimate_mode\n+        if inputs is not None:\n+            options[\"inputs\"] = inputs\n+        if add_inputs is not None:\n+            options[\"add_inputs\"] = add_inputs\n+        if change_address is not None:\n+            options[\"change_address\"] = change_address\n+        if change_position is not None:\n+            options[\"change_position\"] = change_position\n+        if change_type is not None:\n+            options[\"change_type\"] = change_type\n+        if include_watching is not None:\n+            options[\"include_watching\"] = include_watching\n+        if locktime is not None:\n+            options[\"locktime\"] = locktime\n+        if lock_unspents is not None:\n+            options[\"lock_unspents\"] = lock_unspents\n+        if replaceable is None:\n+            replaceable = True # default\n+        else:\n+            options[\"replaceable\"] = replaceable\n+        if subtract_fee_from_outputs is not None:\n+            options[\"subtract_fee_from_outputs\"] = subtract_fee_from_outputs\n+\n+        if len(options.keys()) == 0:\n+            options = None\n+\n+        if expect_error is None:\n+            res = from_wallet.send(outputs=outputs, conf_target=arg_conf_target, estimate_mode=arg_estimate_mode, options=options)\n+        else:\n+            try:\n+                assert_raises_rpc_error(expect_error[0],expect_error[1],from_wallet.send,\n+                                        outputs=outputs,conf_target=arg_conf_target,estimate_mode=arg_estimate_mode,options=options)\n+            except AssertionError:\n+                # Provide debug info if the test fails\n+                self.log.error(\"Unexpected successful result:\")\n+                self.log.error(options)\n+                res = from_wallet.send(outputs=outputs,conf_target=arg_conf_target,estimate_mode=arg_estimate_mode,options=options)\n+                self.log.error(res)\n+                if \"txid\" in res and add_to_wallet:\n+                    self.log.error(\"Transaction details:\")\n+                    try:\n+                        tx = from_wallet.gettransaction(res[\"txid\"])\n+                        self.log.error(tx)\n+                        self.log.error(\"testmempoolaccept (transaction may already be in mempool):\")\n+                        self.log.error(from_wallet.testmempoolaccept([tx[\"hex\"]]))\n+                    except JSONRPCException as exc:\n+                        self.log.error(exc)\n+\n+                raise\n+\n+            return\n+\n+        if locktime:\n+            return res\n+\n+        if from_wallet.getwalletinfo()[\"private_keys_enabled\"] and not include_watching:\n+            assert_equal(res[\"complete\"], True)\n+            assert \"txid\" in res\n+        else:\n+            assert_equal(res[\"complete\"], False)\n+            assert not \"txid\" in res\n+            assert \"psbt\" in res\n+\n+        if add_to_wallet and not include_watching:\n+            # Ensure transaction exists in the wallet:\n+            tx = from_wallet.gettransaction(res[\"txid\"])\n+            assert tx\n+            assert_equal(tx[\"bip125-replaceable\"], \"yes\" if replaceable else \"no\")\n+            # Ensure transaction exists in the mempool:\n+            tx = from_wallet.getrawtransaction(res[\"txid\"],True)\n+            assert tx\n+            if amount:\n+                if subtract_fee_from_outputs:\n+                    assert_equal(from_balance_before - from_wallet.getbalance(), amount)\n+                else:\n+                    assert_greater_than(from_balance_before - from_wallet.getbalance(), amount)\n+            else:\n+                assert next((out for out in tx[\"vout\"] if out[\"scriptPubKey\"][\"asm\"] == \"OP_RETURN 35\"), None)\n+        else:\n+            assert_equal(from_balance_before, from_wallet.getbalance())\n+\n+        if to_wallet:\n+            self.sync_mempools()\n+            if add_to_wallet:\n+                if not subtract_fee_from_outputs:\n+                    assert_equal(to_wallet.getbalances()[\"mine\"][\"untrusted_pending\"], to_untrusted_pending_before + Decimal(amount if amount else 0))\n+            else:\n+                assert_equal(to_wallet.getbalances()[\"mine\"][\"untrusted_pending\"], to_untrusted_pending_before)\n+\n+        return res\n+\n+    def run_test(self):\n+        self.log.info(\"Setup wallets...\")\n+        # w0 is a wallet with coinbase rewards\n+        w0 = self.nodes[0].get_wallet_rpc(\"\")\n+        # w1 is a regular wallet\n+        self.nodes[1].createwallet(wallet_name=\"w1\")\n+        w1 = self.nodes[1].get_wallet_rpc(\"w1\")\n+        # w2 contains the private keys for w3\n+        self.nodes[1].createwallet(wallet_name=\"w2\")\n+        w2 = self.nodes[1].get_wallet_rpc(\"w2\")\n+        # w3 is a watch-only wallet, based on w2\n+        self.nodes[1].createwallet(wallet_name=\"w3\",disable_private_keys=True)\n+        w3 = self.nodes[1].get_wallet_rpc(\"w3\")\n+        for _ in range(3):\n+            a2_receive = w2.getnewaddress()\n+            a2_change = w2.getrawchangeaddress() # doesn't actually use change derivation\n+            res = w3.importmulti([{\n+                \"desc\": w2.getaddressinfo(a2_receive)[\"desc\"],\n+                \"timestamp\": \"now\",\n+                \"keypool\": True,\n+                \"watchonly\": True\n+            },{\n+                \"desc\": w2.getaddressinfo(a2_change)[\"desc\"],\n+                \"timestamp\": \"now\",\n+                \"keypool\": True,\n+                \"internal\": True,\n+                \"watchonly\": True\n+            }])\n+            assert_equal(res, [{\"success\": True}, {\"success\": True}])\n+\n+        w0.sendtoaddress(a2_receive, 10) # fund w3\n+        self.nodes[0].generate(1)\n+        self.sync_blocks()\n+\n+        # w4 has private keys enabled, but only contains watch-only keys (from w2)\n+        self.nodes[1].createwallet(wallet_name=\"w4\",disable_private_keys=False)\n+        w4 = self.nodes[1].get_wallet_rpc(\"w4\")\n+        for _ in range(3):\n+            a2_receive = w2.getnewaddress()\n+            res = w4.importmulti([{\n+                \"desc\": w2.getaddressinfo(a2_receive)[\"desc\"],\n+                \"timestamp\": \"now\",\n+                \"keypool\": False,\n+                \"watchonly\": True\n+            }])\n+            assert_equal(res, [{\"success\": True}])\n+\n+        w0.sendtoaddress(a2_receive, 10) # fund w4\n+        self.nodes[0].generate(1)\n+        self.sync_blocks()\n+\n+        self.log.info(\"Send to address...\")\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1)\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=True)\n+\n+        self.log.info(\"Don't broadcast...\")\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=False)\n+        assert(res[\"hex\"])\n+\n+        self.log.info(\"Return PSBT...\")\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, psbt=True)\n+        assert(res[\"psbt\"])\n+\n+        self.log.info(\"Create transaction that spends to address, but don't broadcast...\")\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=False)\n+        # conf_target & estimate_mode can be set as argument or option\n+        res1 = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=1, arg_estimate_mode=\"economical\", add_to_wallet=False)\n+        res2 = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=1, estimate_mode=\"economical\", add_to_wallet=False)\n+        assert_equal(self.nodes[1].decodepsbt(res1[\"psbt\"])[\"fee\"],\n+                     self.nodes[1].decodepsbt(res2[\"psbt\"])[\"fee\"])\n+        # but not at the same time\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=1, arg_estimate_mode=\"economical\",\n+                       conf_target=1, estimate_mode=\"economical\", add_to_wallet=False, expect_error=(-8,\"Use either conf_target and estimate_mode or the options dictionary to control fee rate\"))\n+\n+        self.log.info(\"Create PSBT from watch-only wallet w3, sign with w2...\")\n+        res = self.test_send(from_wallet=w3, to_wallet=w1, amount=1)\n+        res = w2.walletprocesspsbt(res[\"psbt\"])\n+        assert res[\"complete\"]\n+\n+        self.log.info(\"Create PSBT from wallet w4 with watch-only keys, sign with w2...\")\n+        self.test_send(from_wallet=w4, to_wallet=w1, amount=1, expect_error=(-4, \"Insufficient funds\"))\n+        res = self.test_send(from_wallet=w4, to_wallet=w1, amount=1, include_watching=True, add_to_wallet=False)\n+        res = w2.walletprocesspsbt(res[\"psbt\"])\n+        assert res[\"complete\"]\n+\n+        self.log.info(\"Create OP_RETURN...\")\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1)\n+        self.test_send(from_wallet=w0, data=\"Hello World\", expect_error=(-8, \"Data must be hexadecimal string (not 'Hello World')\"))\n+        self.test_send(from_wallet=w0, data=\"23\")\n+        res = self.test_send(from_wallet=w3, data=\"23\")\n+        res = w2.walletprocesspsbt(res[\"psbt\"])\n+        assert res[\"complete\"]\n+\n+        self.log.info(\"Set fee rate...\")\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=2, estimate_mode=\"sat/b\", add_to_wallet=False)\n+        fee = self.nodes[1].decodepsbt(res[\"psbt\"])[\"fee\"]\n+        assert_fee_amount(fee, Decimal(len(res[\"hex\"]) / 2), Decimal(\"0.00002\"))\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=-1, estimate_mode=\"sat/b\",\n+                       expect_error=(-3, \"Amount out of range\"))\n+        # Fee rate of 0.1 satoshi per byte should throw an error\n+        # TODO: error should say 1.000 sat/b\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.1, estimate_mode=\"sat/b\",\n+                       expect_error=(-4, \"Fee rate (0.00000100 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\"))\n+\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.000001, estimate_mode=\"BTC/KB\",\n+                       expect_error=(-4, \"Fee rate (0.00000100 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\"))\n+\n+        # TODO: Return hex if fee rate is below -maxmempool\n+        # res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.1, estimate_mode=\"sat/b\", add_to_wallet=False)\n+        # assert res[\"hex\"]\n+        # hex = res[\"hex\"]\n+        # res = self.nodes[0].testmempoolaccept([hex])\n+        # assert not res[0][\"allowed\"]\n+        # assert_equal(res[0][\"reject-reason\"], \"...\") # low fee\n+        # assert_fee_amount(fee, Decimal(len(res[\"hex\"]) / 2), Decimal(\"0.000001\"))\n+\n+        self.log.info(\"If inputs are specified, do not automatically add more...\")\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=51, inputs=[], add_to_wallet=False)\n+        assert res[\"complete\"]\n+        utxo1 = w0.listunspent()[0]\n+        assert_equal(utxo1[\"amount\"], 50)\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=51, inputs=[utxo1],\n+                       expect_error=(-4, \"Insufficient funds\"))\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=51, inputs=[utxo1], add_inputs=False,\n+                       expect_error=(-4, \"Insufficient funds\"))\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=51, inputs=[utxo1], add_inputs=True, add_to_wallet=False)\n+        assert res[\"complete\"]\n+\n+        self.log.info(\"Manual change address and position...\")\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, change_address=\"not an address\",\n+                       expect_error=(-5, \"Change address must be a valid bitcoin address\"))\n+        change_address = w0.getnewaddress()\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=False, change_address=change_address)\n+        assert res[\"complete\"]\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=False, change_address=change_address, change_position=0)\n+        assert res[\"complete\"]\n+        assert_equal(self.nodes[0].decodepsbt(res[\"psbt\"])[\"tx\"][\"vout\"][0][\"scriptPubKey\"][\"addresses\"], [change_address])\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=False, change_type=\"legacy\", change_position=0)\n+        assert res[\"complete\"]\n+        change_address = self.nodes[0].decodepsbt(res[\"psbt\"])[\"tx\"][\"vout\"][0][\"scriptPubKey\"][\"addresses\"][0]\n+        assert change_address[0] == \"m\" or change_address[0] == \"n\"\n+\n+        self.log.info(\"Set lock time...\")\n+        height = self.nodes[0].getblockchaininfo()[\"blocks\"]\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, locktime=height + 1)\n+        assert res[\"complete\"]\n+        assert res[\"txid\"]\n+        txid = res[\"txid\"]\n+        # Although the wallet finishes the transaction, it can't be added to the mempool yet:\n+        hex = self.nodes[0].gettransaction(res[\"txid\"])[\"hex\"]\n+        res = self.nodes[0].testmempoolaccept([hex])\n+        assert not res[0][\"allowed\"]\n+        assert_equal(res[0][\"reject-reason\"], \"non-final\")\n+        # It shouldn't be confirmed in the next block\n+        self.nodes[0].generate(1)\n+        assert_equal(self.nodes[0].gettransaction(txid)[\"confirmations\"], 0)\n+        # The mempool should allow it now:\n+        res = self.nodes[0].testmempoolaccept([hex])\n+        assert res[0][\"allowed\"]\n+        # Don't wait for wallet to add it to the mempool:\n+        res = self.nodes[0].sendrawtransaction(hex)\n+        self.nodes[0].generate(1)\n+        assert_equal(self.nodes[0].gettransaction(txid)[\"confirmations\"], 1)\n+\n+        self.log.info(\"Lock unspents...\")\n+        utxo1 = w0.listunspent()[0]\n+        assert_greater_than(utxo1[\"amount\"], 1)\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, inputs=[utxo1], add_to_wallet=False, lock_unspents=True)\n+        assert res[\"complete\"]\n+        locked_coins = w0.listlockunspent()\n+        assert_equal(len(locked_coins), 1)\n+        # Locked coins are automatically unlocked when manually selected\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, inputs=[utxo1],add_to_wallet=False)\n+\n+        self.log.info(\"Replaceable...\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488711853",
      "id" : 488711853,
      "line" : 330,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODcxMTg1Mw==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 330,
      "original_position" : 330,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : 330,
      "pull_request_review_id" : 488713127,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T16:03:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488711853",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488714069"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488714069"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "micro-nit: spacing before `add_to_wallet`",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-15T14:29:23Z",
      "diff_hunk" : "@@ -0,0 +1,339 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the send RPC command.\"\"\"\n+\n+from decimal import Decimal, getcontext\n+from test_framework.authproxy import JSONRPCException\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_fee_amount,\n+    assert_greater_than,\n+    assert_raises_rpc_error\n+)\n+\n+class WalletSendTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        # whitelist all peers to speed up tx relay / mempool sync\n+        self.extra_args = [\n+            [\"-whitelist=127.0.0.1\",\"-walletrbf=1\"],\n+            [\"-whitelist=127.0.0.1\",\"-walletrbf=1\"],\n+        ]\n+        getcontext().prec = 8 # Satoshi precision for Decimal\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def test_send(self, from_wallet, to_wallet=None, amount=None, data=None,\n+                  arg_conf_target=None, arg_estimate_mode=None,\n+                  conf_target=None, estimate_mode=None, add_to_wallet=None,psbt=None,\n+                  inputs=None,add_inputs=None,change_address=None,change_position=None,change_type=None,\n+                  include_watching=None,locktime=None,lock_unspents=None,replaceable=None,subtract_fee_from_outputs=None,\n+                  expect_error=None):\n+        assert (amount is None) != (data is None)\n+\n+        from_balance_before = from_wallet.getbalance()\n+        if to_wallet is None:\n+            assert amount is None\n+        else:\n+            to_untrusted_pending_before = to_wallet.getbalances()[\"mine\"][\"untrusted_pending\"]\n+\n+        if amount:\n+            dest = to_wallet.getnewaddress()\n+            outputs = {dest: amount}\n+        else:\n+            outputs = {\"data\": data}\n+\n+        # Construct options dictionary\n+        options = {}\n+        if add_to_wallet is not None:\n+            options[\"add_to_wallet\"] = add_to_wallet\n+        else:\n+            if psbt:\n+                add_to_wallet = False\n+            else:\n+                add_to_wallet = from_wallet.getwalletinfo()[\"private_keys_enabled\"] # Default value\n+        if psbt is not None:\n+            options[\"psbt\"] = psbt\n+        if conf_target is not None:\n+            options[\"conf_target\"] = conf_target\n+        if estimate_mode is not None:\n+            options[\"estimate_mode\"] = estimate_mode\n+        if inputs is not None:\n+            options[\"inputs\"] = inputs\n+        if add_inputs is not None:\n+            options[\"add_inputs\"] = add_inputs\n+        if change_address is not None:\n+            options[\"change_address\"] = change_address\n+        if change_position is not None:\n+            options[\"change_position\"] = change_position\n+        if change_type is not None:\n+            options[\"change_type\"] = change_type\n+        if include_watching is not None:\n+            options[\"include_watching\"] = include_watching\n+        if locktime is not None:\n+            options[\"locktime\"] = locktime\n+        if lock_unspents is not None:\n+            options[\"lock_unspents\"] = lock_unspents\n+        if replaceable is None:\n+            replaceable = True # default\n+        else:\n+            options[\"replaceable\"] = replaceable\n+        if subtract_fee_from_outputs is not None:\n+            options[\"subtract_fee_from_outputs\"] = subtract_fee_from_outputs\n+\n+        if len(options.keys()) == 0:\n+            options = None\n+\n+        if expect_error is None:\n+            res = from_wallet.send(outputs=outputs, conf_target=arg_conf_target, estimate_mode=arg_estimate_mode, options=options)\n+        else:\n+            try:\n+                assert_raises_rpc_error(expect_error[0],expect_error[1],from_wallet.send,\n+                                        outputs=outputs,conf_target=arg_conf_target,estimate_mode=arg_estimate_mode,options=options)\n+            except AssertionError:\n+                # Provide debug info if the test fails\n+                self.log.error(\"Unexpected successful result:\")\n+                self.log.error(options)\n+                res = from_wallet.send(outputs=outputs,conf_target=arg_conf_target,estimate_mode=arg_estimate_mode,options=options)\n+                self.log.error(res)\n+                if \"txid\" in res and add_to_wallet:\n+                    self.log.error(\"Transaction details:\")\n+                    try:\n+                        tx = from_wallet.gettransaction(res[\"txid\"])\n+                        self.log.error(tx)\n+                        self.log.error(\"testmempoolaccept (transaction may already be in mempool):\")\n+                        self.log.error(from_wallet.testmempoolaccept([tx[\"hex\"]]))\n+                    except JSONRPCException as exc:\n+                        self.log.error(exc)\n+\n+                raise\n+\n+            return\n+\n+        if locktime:\n+            return res\n+\n+        if from_wallet.getwalletinfo()[\"private_keys_enabled\"] and not include_watching:\n+            assert_equal(res[\"complete\"], True)\n+            assert \"txid\" in res\n+        else:\n+            assert_equal(res[\"complete\"], False)\n+            assert not \"txid\" in res\n+            assert \"psbt\" in res\n+\n+        if add_to_wallet and not include_watching:\n+            # Ensure transaction exists in the wallet:\n+            tx = from_wallet.gettransaction(res[\"txid\"])\n+            assert tx\n+            assert_equal(tx[\"bip125-replaceable\"], \"yes\" if replaceable else \"no\")\n+            # Ensure transaction exists in the mempool:\n+            tx = from_wallet.getrawtransaction(res[\"txid\"],True)\n+            assert tx\n+            if amount:\n+                if subtract_fee_from_outputs:\n+                    assert_equal(from_balance_before - from_wallet.getbalance(), amount)\n+                else:\n+                    assert_greater_than(from_balance_before - from_wallet.getbalance(), amount)\n+            else:\n+                assert next((out for out in tx[\"vout\"] if out[\"scriptPubKey\"][\"asm\"] == \"OP_RETURN 35\"), None)\n+        else:\n+            assert_equal(from_balance_before, from_wallet.getbalance())\n+\n+        if to_wallet:\n+            self.sync_mempools()\n+            if add_to_wallet:\n+                if not subtract_fee_from_outputs:\n+                    assert_equal(to_wallet.getbalances()[\"mine\"][\"untrusted_pending\"], to_untrusted_pending_before + Decimal(amount if amount else 0))\n+            else:\n+                assert_equal(to_wallet.getbalances()[\"mine\"][\"untrusted_pending\"], to_untrusted_pending_before)\n+\n+        return res\n+\n+    def run_test(self):\n+        self.log.info(\"Setup wallets...\")\n+        # w0 is a wallet with coinbase rewards\n+        w0 = self.nodes[0].get_wallet_rpc(\"\")\n+        # w1 is a regular wallet\n+        self.nodes[1].createwallet(wallet_name=\"w1\")\n+        w1 = self.nodes[1].get_wallet_rpc(\"w1\")\n+        # w2 contains the private keys for w3\n+        self.nodes[1].createwallet(wallet_name=\"w2\")\n+        w2 = self.nodes[1].get_wallet_rpc(\"w2\")\n+        # w3 is a watch-only wallet, based on w2\n+        self.nodes[1].createwallet(wallet_name=\"w3\",disable_private_keys=True)\n+        w3 = self.nodes[1].get_wallet_rpc(\"w3\")\n+        for _ in range(3):\n+            a2_receive = w2.getnewaddress()\n+            a2_change = w2.getrawchangeaddress() # doesn't actually use change derivation\n+            res = w3.importmulti([{\n+                \"desc\": w2.getaddressinfo(a2_receive)[\"desc\"],\n+                \"timestamp\": \"now\",\n+                \"keypool\": True,\n+                \"watchonly\": True\n+            },{\n+                \"desc\": w2.getaddressinfo(a2_change)[\"desc\"],\n+                \"timestamp\": \"now\",\n+                \"keypool\": True,\n+                \"internal\": True,\n+                \"watchonly\": True\n+            }])\n+            assert_equal(res, [{\"success\": True}, {\"success\": True}])\n+\n+        w0.sendtoaddress(a2_receive, 10) # fund w3\n+        self.nodes[0].generate(1)\n+        self.sync_blocks()\n+\n+        # w4 has private keys enabled, but only contains watch-only keys (from w2)\n+        self.nodes[1].createwallet(wallet_name=\"w4\",disable_private_keys=False)\n+        w4 = self.nodes[1].get_wallet_rpc(\"w4\")\n+        for _ in range(3):\n+            a2_receive = w2.getnewaddress()\n+            res = w4.importmulti([{\n+                \"desc\": w2.getaddressinfo(a2_receive)[\"desc\"],\n+                \"timestamp\": \"now\",\n+                \"keypool\": False,\n+                \"watchonly\": True\n+            }])\n+            assert_equal(res, [{\"success\": True}])\n+\n+        w0.sendtoaddress(a2_receive, 10) # fund w4\n+        self.nodes[0].generate(1)\n+        self.sync_blocks()\n+\n+        self.log.info(\"Send to address...\")\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1)\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=True)\n+\n+        self.log.info(\"Don't broadcast...\")\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=False)\n+        assert(res[\"hex\"])\n+\n+        self.log.info(\"Return PSBT...\")\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, psbt=True)\n+        assert(res[\"psbt\"])\n+\n+        self.log.info(\"Create transaction that spends to address, but don't broadcast...\")\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=False)\n+        # conf_target & estimate_mode can be set as argument or option\n+        res1 = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=1, arg_estimate_mode=\"economical\", add_to_wallet=False)\n+        res2 = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=1, estimate_mode=\"economical\", add_to_wallet=False)\n+        assert_equal(self.nodes[1].decodepsbt(res1[\"psbt\"])[\"fee\"],\n+                     self.nodes[1].decodepsbt(res2[\"psbt\"])[\"fee\"])\n+        # but not at the same time\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=1, arg_estimate_mode=\"economical\",\n+                       conf_target=1, estimate_mode=\"economical\", add_to_wallet=False, expect_error=(-8,\"Use either conf_target and estimate_mode or the options dictionary to control fee rate\"))\n+\n+        self.log.info(\"Create PSBT from watch-only wallet w3, sign with w2...\")\n+        res = self.test_send(from_wallet=w3, to_wallet=w1, amount=1)\n+        res = w2.walletprocesspsbt(res[\"psbt\"])\n+        assert res[\"complete\"]\n+\n+        self.log.info(\"Create PSBT from wallet w4 with watch-only keys, sign with w2...\")\n+        self.test_send(from_wallet=w4, to_wallet=w1, amount=1, expect_error=(-4, \"Insufficient funds\"))\n+        res = self.test_send(from_wallet=w4, to_wallet=w1, amount=1, include_watching=True, add_to_wallet=False)\n+        res = w2.walletprocesspsbt(res[\"psbt\"])\n+        assert res[\"complete\"]\n+\n+        self.log.info(\"Create OP_RETURN...\")\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1)\n+        self.test_send(from_wallet=w0, data=\"Hello World\", expect_error=(-8, \"Data must be hexadecimal string (not 'Hello World')\"))\n+        self.test_send(from_wallet=w0, data=\"23\")\n+        res = self.test_send(from_wallet=w3, data=\"23\")\n+        res = w2.walletprocesspsbt(res[\"psbt\"])\n+        assert res[\"complete\"]\n+\n+        self.log.info(\"Set fee rate...\")\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=2, estimate_mode=\"sat/b\", add_to_wallet=False)\n+        fee = self.nodes[1].decodepsbt(res[\"psbt\"])[\"fee\"]\n+        assert_fee_amount(fee, Decimal(len(res[\"hex\"]) / 2), Decimal(\"0.00002\"))\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=-1, estimate_mode=\"sat/b\",\n+                       expect_error=(-3, \"Amount out of range\"))\n+        # Fee rate of 0.1 satoshi per byte should throw an error\n+        # TODO: error should say 1.000 sat/b\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.1, estimate_mode=\"sat/b\",\n+                       expect_error=(-4, \"Fee rate (0.00000100 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\"))\n+\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.000001, estimate_mode=\"BTC/KB\",\n+                       expect_error=(-4, \"Fee rate (0.00000100 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\"))\n+\n+        # TODO: Return hex if fee rate is below -maxmempool\n+        # res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.1, estimate_mode=\"sat/b\", add_to_wallet=False)\n+        # assert res[\"hex\"]\n+        # hex = res[\"hex\"]\n+        # res = self.nodes[0].testmempoolaccept([hex])\n+        # assert not res[0][\"allowed\"]\n+        # assert_equal(res[0][\"reject-reason\"], \"...\") # low fee\n+        # assert_fee_amount(fee, Decimal(len(res[\"hex\"]) / 2), Decimal(\"0.000001\"))\n+\n+        self.log.info(\"If inputs are specified, do not automatically add more...\")\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=51, inputs=[], add_to_wallet=False)\n+        assert res[\"complete\"]\n+        utxo1 = w0.listunspent()[0]\n+        assert_equal(utxo1[\"amount\"], 50)\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=51, inputs=[utxo1],\n+                       expect_error=(-4, \"Insufficient funds\"))\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=51, inputs=[utxo1], add_inputs=False,\n+                       expect_error=(-4, \"Insufficient funds\"))\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=51, inputs=[utxo1], add_inputs=True, add_to_wallet=False)\n+        assert res[\"complete\"]\n+\n+        self.log.info(\"Manual change address and position...\")\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, change_address=\"not an address\",\n+                       expect_error=(-5, \"Change address must be a valid bitcoin address\"))\n+        change_address = w0.getnewaddress()\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=False, change_address=change_address)\n+        assert res[\"complete\"]\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=False, change_address=change_address, change_position=0)\n+        assert res[\"complete\"]\n+        assert_equal(self.nodes[0].decodepsbt(res[\"psbt\"])[\"tx\"][\"vout\"][0][\"scriptPubKey\"][\"addresses\"], [change_address])\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=False, change_type=\"legacy\", change_position=0)\n+        assert res[\"complete\"]\n+        change_address = self.nodes[0].decodepsbt(res[\"psbt\"])[\"tx\"][\"vout\"][0][\"scriptPubKey\"][\"addresses\"][0]\n+        assert change_address[0] == \"m\" or change_address[0] == \"n\"\n+\n+        self.log.info(\"Set lock time...\")\n+        height = self.nodes[0].getblockchaininfo()[\"blocks\"]\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, locktime=height + 1)\n+        assert res[\"complete\"]\n+        assert res[\"txid\"]\n+        txid = res[\"txid\"]\n+        # Although the wallet finishes the transaction, it can't be added to the mempool yet:\n+        hex = self.nodes[0].gettransaction(res[\"txid\"])[\"hex\"]\n+        res = self.nodes[0].testmempoolaccept([hex])\n+        assert not res[0][\"allowed\"]\n+        assert_equal(res[0][\"reject-reason\"], \"non-final\")\n+        # It shouldn't be confirmed in the next block\n+        self.nodes[0].generate(1)\n+        assert_equal(self.nodes[0].gettransaction(txid)[\"confirmations\"], 0)\n+        # The mempool should allow it now:\n+        res = self.nodes[0].testmempoolaccept([hex])\n+        assert res[0][\"allowed\"]\n+        # Don't wait for wallet to add it to the mempool:\n+        res = self.nodes[0].sendrawtransaction(hex)\n+        self.nodes[0].generate(1)\n+        assert_equal(self.nodes[0].gettransaction(txid)[\"confirmations\"], 1)\n+\n+        self.log.info(\"Lock unspents...\")\n+        utxo1 = w0.listunspent()[0]\n+        assert_greater_than(utxo1[\"amount\"], 1)\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, inputs=[utxo1], add_to_wallet=False, lock_unspents=True)\n+        assert res[\"complete\"]\n+        locked_coins = w0.listlockunspent()\n+        assert_equal(len(locked_coins), 1)\n+        # Locked coins are automatically unlocked when manually selected\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, inputs=[utxo1],add_to_wallet=False)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r488714069",
      "id" : 488714069,
      "line" : 328,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODcxNDA2OQ==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 328,
      "original_position" : 328,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : 328,
      "pull_request_review_id" : 488713127,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-15T16:03:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488714069",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490222969"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490222969"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks, adding fix to followup PR.",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-17T12:58:53Z",
      "diff_hunk" : "@@ -3857,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+            \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+                    {\"include_watching\", RPCArg::Type::BOOL, /* default */ \"true for watch-only wallets, otherwise false\", \"Also select inputs which are watch only.\\n\"\n+                                          \"Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\\n\"\n+                                          \"e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.\"},\n+                    {\"inputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Specify inputs instead of adding them automatically. A json array of json objects\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lock_unspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"psbt\", RPCArg::Type::BOOL,  /* default */ \"automatic\", \"Always return a PSBT, implies add_to_wallet=false.\"},\n+                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+                {\n+                    {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n+                    {RPCResult::Type::STR_HEX, \"txid\", \"The transaction id for the send. Only 1 transaction is created regardless of the number of addresses.\"},\n+                    {RPCResult::Type::STR_HEX, \"hex\", \"If add_to_wallet is false, the hex-encoded raw transaction with signature(s)\"},\n+                    {RPCResult::Type::STR, \"psbt\", \"If more signatures are needed, or if add_to_wallet is false, the base64-encoded (partially) signed transaction\"}\n+                }\n+        },\n+        RPCExamples{\"\"\n+        \"\\nSend with a fee rate of 1 satoshi per byte\\n\"\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 sat/b\\n\" +\n+            \"\\nCreate a transaction that should confirm the next block, with a specific input, and return result without adding to wallet or broadcasting to the network\\n\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490222969",
      "id" : 490222969,
      "in_reply_to_id" : 486325092,
      "line" : 3946,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDIyMjk2OQ==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 3946,
      "original_position" : 167,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 167,
      "pull_request_review_id" : 490564605,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T12:58:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490222969",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490223692"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490223692"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks, fixing nits in followup.",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-17T12:59:58Z",
      "diff_hunk" : "@@ -2955,16 +2956,20 @@ void FundTransaction(CWallet* const pwallet, CMutableTransaction& tx, CAmount& f\n         RPCTypeCheckObj(options,\n             {\n                 {\"add_inputs\", UniValueType(UniValue::VBOOL)},\n+                {\"add_to_wallet\", UniValueType(UniValue::VBOOL)},\n                 {\"changeAddress\", UniValueType(UniValue::VSTR)},\n                 {\"change_address\", UniValueType(UniValue::VSTR)},\n                 {\"changePosition\", UniValueType(UniValue::VNUM)},\n                 {\"change_position\", UniValueType(UniValue::VNUM)},\n                 {\"change_type\", UniValueType(UniValue::VSTR)},\n                 {\"includeWatching\", UniValueType(UniValue::VBOOL)},\n                 {\"include_watching\", UniValueType(UniValue::VBOOL)},\n+                {\"inputs\", UniValueType(UniValue::VARR)},\n                 {\"lockUnspents\", UniValueType(UniValue::VBOOL)},\n                 {\"lock_unspents\", UniValueType(UniValue::VBOOL)},\n-                {\"feeRate\", UniValueType()}, // will be checked below\n+                {\"locktime\", UniValueType(UniValue::VNUM)},\n+                {\"feeRate\", UniValueType()}, // will be checked below,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490223692",
      "id" : 490223692,
      "in_reply_to_id" : 488315345,
      "line" : 2971,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDIyMzY5Mg==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 2971,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 25,
      "pull_request_review_id" : 490565551,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T12:59:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490223692",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490232799"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490232799"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`,[a-zA-Z0-9]+` found a bunch more",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-17T13:13:28Z",
      "diff_hunk" : "@@ -0,0 +1,339 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the send RPC command.\"\"\"\n+\n+from decimal import Decimal, getcontext\n+from test_framework.authproxy import JSONRPCException\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_fee_amount,\n+    assert_greater_than,\n+    assert_raises_rpc_error\n+)\n+\n+class WalletSendTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        # whitelist all peers to speed up tx relay / mempool sync\n+        self.extra_args = [\n+            [\"-whitelist=127.0.0.1\",\"-walletrbf=1\"],\n+            [\"-whitelist=127.0.0.1\",\"-walletrbf=1\"],\n+        ]\n+        getcontext().prec = 8 # Satoshi precision for Decimal\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def test_send(self, from_wallet, to_wallet=None, amount=None, data=None,\n+                  arg_conf_target=None, arg_estimate_mode=None,\n+                  conf_target=None, estimate_mode=None, add_to_wallet=None,psbt=None,\n+                  inputs=None,add_inputs=None,change_address=None,change_position=None,change_type=None,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490232799",
      "id" : 490232799,
      "in_reply_to_id" : 488322773,
      "line" : 33,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDIzMjc5OQ==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 33,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : 33,
      "pull_request_review_id" : 490577514,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:13:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490232799",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490233578"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490233578"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe, but this also works when `walletbroadcast` is off",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-17T13:14:34Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490233578",
      "id" : 490233578,
      "in_reply_to_id" : 488323964,
      "line" : 3901,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDIzMzU3OA==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 3901,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 122,
      "pull_request_review_id" : 490578529,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:14:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490233578",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490235723"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490235723"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Will change in the followup in a separate commit, in case people think it's too late to touch.",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-17T13:17:37Z",
      "diff_hunk" : "@@ -21,10 +21,15 @@\n \n CMutableTransaction ConstructTransaction(const UniValue& inputs_in, const UniValue& outputs_in, const UniValue& locktime, bool rbf)\n {\n-    if (inputs_in.isNull() || outputs_in.isNull())\n-        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid parameter, arguments 1 and 2 must be non-null\");\n+    if (outputs_in.isNull())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490235723",
      "id" : 490235723,
      "in_reply_to_id" : 488342027,
      "line" : 24,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDIzNTcyMw==",
      "original_commit_id" : "1bc8d0fd5906bc9637d513cd193a1f47ad94da28",
      "original_line" : 24,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction_util.cpp",
      "position" : 6,
      "pull_request_review_id" : 490581378,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:17:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490235723",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490237857"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490237857"
         }
      },
      "author_association" : "MEMBER",
      "body" : "For convenience; setting the fee rate is so common I'd rather not have to use the options field.",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-17T13:20:24Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490237857",
      "id" : 490237857,
      "in_reply_to_id" : 488348105,
      "line" : 3906,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDIzNzg1Nw==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 3906,
      "original_position" : 66,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 127,
      "pull_request_review_id" : 490585490,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:20:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490237857",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490238141"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490238141"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'll leave this to your #19957 ",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-17T13:20:48Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+            \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+                    {\"include_watching\", RPCArg::Type::BOOL, /* default */ \"true for watch-only wallets, otherwise false\", \"Also select inputs which are watch only.\\n\"\n+                                          \"Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\\n\"\n+                                          \"e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.\"},\n+                    {\"inputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Specify inputs instead of adding them automatically. A json array of json objects\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lock_unspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"psbt\", RPCArg::Type::BOOL,  /* default */ \"automatic\", \"Always return a PSBT, implies add_to_wallet=false.\"},\n+                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+                {\n+                    {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n+                    {RPCResult::Type::STR_HEX, \"txid\", \"The transaction id for the send. Only 1 transaction is created regardless of the number of addresses.\"},\n+                    {RPCResult::Type::STR_HEX, \"hex\", \"If add_to_wallet is false, the hex-encoded raw transaction with signature(s)\"},\n+                    {RPCResult::Type::STR, \"psbt\", \"If more signatures are needed, or if add_to_wallet is false, the base64-encoded (partially) signed transaction\"}\n+                }\n+        },\n+        RPCExamples{\"\"\n+        \"\\nSend with a fee rate of 1 satoshi per byte\\n\"\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 sat/b\\n\" +\n+            \"\\nCreate a transaction that should confirm the next block, with a specific input, and return result without adding to wallet or broadcasting to the network\\n\")\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 economical '{\\\"add_to_wallet\\\": false, \\\"inputs\\\": [{\\\"txid\\\":\\\"a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\", \\\"vout\\\":1}]}'\")\n+        },\n+        [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n+        {\n+            RPCTypeCheck(request.params, {\n+                UniValueType(), // ARR or OBJ, checked later\n+                UniValue::VNUM,\n+                UniValue::VSTR,\n+                UniValue::VOBJ\n+                }, true\n+            );\n+\n+            std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+            if (!wallet) return NullUniValue;\n+            CWallet* const pwallet = wallet.get();\n+\n+            UniValue options = request.params[3];\n+            if (options.exists(\"feeRate\") || options.exists(\"fee_rate\") || options.exists(\"estimate_mode\") || options.exists(\"conf_target\")) {\n+                if (!request.params[1].isNull() || !request.params[2].isNull()) {\n+                    throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use either conf_target and estimate_mode or the options dictionary to control fee rate\");\n+                }\n+            } else {\n+                options.pushKV(\"conf_target\", request.params[1]);\n+                options.pushKV(\"estimate_mode\", request.params[2]);\n+            }\n+            if (!options[\"conf_target\"].isNull() && (options[\"estimate_mode\"].isNull() || (options[\"estimate_mode\"].get_str() == \"unset\"))) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Specify estimate_mode\");\n+            }\n+            if (options.exists(\"changeAddress\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_address\");\n+            }\n+            if (options.exists(\"changePosition\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_position\");\n+            }\n+            if (options.exists(\"includeWatching\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use include_watching\");\n+            }\n+            if (options.exists(\"lockUnspents\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use lock_unspents\");\n+            }\n+            if (options.exists(\"subtractFeeFromOutputs\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use subtract_fee_from_outputs\");\n+            }\n+\n+            const bool psbt_opt_in = options.exists(\"psbt\") && options[\"psbt\"].get_bool();\n+\n+            CAmount fee;\n+            int change_position;\n+            bool rbf = pwallet->m_signal_rbf;\n+            if (options.exists(\"replaceable\")) {\n+                rbf = options[\"add_to_wallet\"].get_bool();\n+            }\n+            CMutableTransaction rawTx = ConstructTransaction(options[\"inputs\"], request.params[0], options[\"locktime\"], rbf);\n+            CCoinControl coin_control;\n+            // Automatically select coins, unless at least one is manually selected. Can\n+            // be overriden by options.add_inputs.\n+            coin_control.m_add_inputs = rawTx.vin.size() == 0;\n+            FundTransaction(pwallet, rawTx, fee, change_position, options, coin_control);\n+\n+            bool add_to_wallet = true;\n+            if (options.exists(\"add_to_wallet\")) {\n+                add_to_wallet = options[\"add_to_wallet\"].get_bool();\n+            }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490238141",
      "id" : 490238141,
      "in_reply_to_id" : 488349241,
      "line" : 4009,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDIzODE0MQ==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 4009,
      "original_position" : 169,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 230,
      "pull_request_review_id" : 490586055,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:20:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490238141",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490238402"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490238402"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I believe that's covered in #19957",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-17T13:21:08Z",
      "diff_hunk" : "@@ -2972,22 +2977,24 @@ void FundTransaction(CWallet* const pwallet, CMutableTransaction& tx, CAmount& f\n             coinControl.m_add_inputs = options[\"add_inputs\"].get_bool();\n         }\n \n-        if (options.exists(\"changeAddress\")) {\n-            CTxDestination dest = DecodeDestination(options[\"changeAddress\"].get_str());\n+        if (options.exists(\"changeAddress\") || options.exists(\"change_address\")) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490238402",
      "id" : 490238402,
      "in_reply_to_id" : 488690111,
      "line" : 2985,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDIzODQwMg==",
      "original_commit_id" : "2c2a1445dc9d22c9d729b8301c8b3f54195bcfcf",
      "original_line" : 2980,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 38,
      "pull_request_review_id" : 490586618,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:21:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490238402",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490239407"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490239407"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'll address nits in the followup PR",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-17T13:22:29Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490239407",
      "id" : 490239407,
      "in_reply_to_id" : 488692783,
      "line" : 3879,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDIzOTQwNw==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 3879,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 100,
      "pull_request_review_id" : 490588534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:22:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490239407",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490240636"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490240636"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Hopefully addressed in #19957?",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-17T13:23:50Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+            \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+                    {\"include_watching\", RPCArg::Type::BOOL, /* default */ \"true for watch-only wallets, otherwise false\", \"Also select inputs which are watch only.\\n\"\n+                                          \"Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\\n\"\n+                                          \"e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.\"},\n+                    {\"inputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Specify inputs instead of adding them automatically. A json array of json objects\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lock_unspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"psbt\", RPCArg::Type::BOOL,  /* default */ \"automatic\", \"Always return a PSBT, implies add_to_wallet=false.\"},\n+                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+                {\n+                    {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n+                    {RPCResult::Type::STR_HEX, \"txid\", \"The transaction id for the send. Only 1 transaction is created regardless of the number of addresses.\"},\n+                    {RPCResult::Type::STR_HEX, \"hex\", \"If add_to_wallet is false, the hex-encoded raw transaction with signature(s)\"},\n+                    {RPCResult::Type::STR, \"psbt\", \"If more signatures are needed, or if add_to_wallet is false, the base64-encoded (partially) signed transaction\"}\n+                }\n+        },\n+        RPCExamples{\"\"\n+        \"\\nSend with a fee rate of 1 satoshi per byte\\n\"\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 sat/b\\n\" +\n+            \"\\nCreate a transaction that should confirm the next block, with a specific input, and return result without adding to wallet or broadcasting to the network\\n\")\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 economical '{\\\"add_to_wallet\\\": false, \\\"inputs\\\": [{\\\"txid\\\":\\\"a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\", \\\"vout\\\":1}]}'\")\n+        },\n+        [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n+        {\n+            RPCTypeCheck(request.params, {\n+                UniValueType(), // ARR or OBJ, checked later\n+                UniValue::VNUM,\n+                UniValue::VSTR,\n+                UniValue::VOBJ\n+                }, true\n+            );\n+\n+            std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+            if (!wallet) return NullUniValue;\n+            CWallet* const pwallet = wallet.get();\n+\n+            UniValue options = request.params[3];\n+            if (options.exists(\"feeRate\") || options.exists(\"fee_rate\") || options.exists(\"estimate_mode\") || options.exists(\"conf_target\")) {\n+                if (!request.params[1].isNull() || !request.params[2].isNull()) {\n+                    throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use either conf_target and estimate_mode or the options dictionary to control fee rate\");\n+                }\n+            } else {\n+                options.pushKV(\"conf_target\", request.params[1]);\n+                options.pushKV(\"estimate_mode\", request.params[2]);\n+            }\n+            if (!options[\"conf_target\"].isNull() && (options[\"estimate_mode\"].isNull() || (options[\"estimate_mode\"].get_str() == \"unset\"))) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Specify estimate_mode\");\n+            }\n+            if (options.exists(\"changeAddress\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_address\");\n+            }\n+            if (options.exists(\"changePosition\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_position\");\n+            }\n+            if (options.exists(\"includeWatching\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use include_watching\");\n+            }\n+            if (options.exists(\"lockUnspents\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use lock_unspents\");\n+            }\n+            if (options.exists(\"subtractFeeFromOutputs\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use subtract_fee_from_outputs\");\n+            }\n+\n+            const bool psbt_opt_in = options.exists(\"psbt\") && options[\"psbt\"].get_bool();\n+\n+            CAmount fee;\n+            int change_position;\n+            bool rbf = pwallet->m_signal_rbf;\n+            if (options.exists(\"replaceable\")) {\n+                rbf = options[\"add_to_wallet\"].get_bool();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490240636",
      "id" : 490240636,
      "in_reply_to_id" : 488698235,
      "line" : 3997,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI0MDYzNg==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 3997,
      "original_position" : 157,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 218,
      "pull_request_review_id" : 490589909,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:23:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490240636",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490244843"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490244843"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Added the check here in two other places just in case, though `test_send` should probably be refactored to check this unless it's explicitly expected to fail.",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-17T13:28:27Z",
      "diff_hunk" : "@@ -0,0 +1,339 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the send RPC command.\"\"\"\n+\n+from decimal import Decimal, getcontext\n+from test_framework.authproxy import JSONRPCException\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_fee_amount,\n+    assert_greater_than,\n+    assert_raises_rpc_error\n+)\n+\n+class WalletSendTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        # whitelist all peers to speed up tx relay / mempool sync\n+        self.extra_args = [\n+            [\"-whitelist=127.0.0.1\",\"-walletrbf=1\"],\n+            [\"-whitelist=127.0.0.1\",\"-walletrbf=1\"],\n+        ]\n+        getcontext().prec = 8 # Satoshi precision for Decimal\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def test_send(self, from_wallet, to_wallet=None, amount=None, data=None,\n+                  arg_conf_target=None, arg_estimate_mode=None,\n+                  conf_target=None, estimate_mode=None, add_to_wallet=None,psbt=None,\n+                  inputs=None,add_inputs=None,change_address=None,change_position=None,change_type=None,\n+                  include_watching=None,locktime=None,lock_unspents=None,replaceable=None,subtract_fee_from_outputs=None,\n+                  expect_error=None):\n+        assert (amount is None) != (data is None)\n+\n+        from_balance_before = from_wallet.getbalance()\n+        if to_wallet is None:\n+            assert amount is None\n+        else:\n+            to_untrusted_pending_before = to_wallet.getbalances()[\"mine\"][\"untrusted_pending\"]\n+\n+        if amount:\n+            dest = to_wallet.getnewaddress()\n+            outputs = {dest: amount}\n+        else:\n+            outputs = {\"data\": data}\n+\n+        # Construct options dictionary\n+        options = {}\n+        if add_to_wallet is not None:\n+            options[\"add_to_wallet\"] = add_to_wallet\n+        else:\n+            if psbt:\n+                add_to_wallet = False\n+            else:\n+                add_to_wallet = from_wallet.getwalletinfo()[\"private_keys_enabled\"] # Default value\n+        if psbt is not None:\n+            options[\"psbt\"] = psbt\n+        if conf_target is not None:\n+            options[\"conf_target\"] = conf_target\n+        if estimate_mode is not None:\n+            options[\"estimate_mode\"] = estimate_mode\n+        if inputs is not None:\n+            options[\"inputs\"] = inputs\n+        if add_inputs is not None:\n+            options[\"add_inputs\"] = add_inputs\n+        if change_address is not None:\n+            options[\"change_address\"] = change_address\n+        if change_position is not None:\n+            options[\"change_position\"] = change_position\n+        if change_type is not None:\n+            options[\"change_type\"] = change_type\n+        if include_watching is not None:\n+            options[\"include_watching\"] = include_watching\n+        if locktime is not None:\n+            options[\"locktime\"] = locktime\n+        if lock_unspents is not None:\n+            options[\"lock_unspents\"] = lock_unspents\n+        if replaceable is None:\n+            replaceable = True # default\n+        else:\n+            options[\"replaceable\"] = replaceable\n+        if subtract_fee_from_outputs is not None:\n+            options[\"subtract_fee_from_outputs\"] = subtract_fee_from_outputs\n+\n+        if len(options.keys()) == 0:\n+            options = None\n+\n+        if expect_error is None:\n+            res = from_wallet.send(outputs=outputs, conf_target=arg_conf_target, estimate_mode=arg_estimate_mode, options=options)\n+        else:\n+            try:\n+                assert_raises_rpc_error(expect_error[0],expect_error[1],from_wallet.send,\n+                                        outputs=outputs,conf_target=arg_conf_target,estimate_mode=arg_estimate_mode,options=options)\n+            except AssertionError:\n+                # Provide debug info if the test fails\n+                self.log.error(\"Unexpected successful result:\")\n+                self.log.error(options)\n+                res = from_wallet.send(outputs=outputs,conf_target=arg_conf_target,estimate_mode=arg_estimate_mode,options=options)\n+                self.log.error(res)\n+                if \"txid\" in res and add_to_wallet:\n+                    self.log.error(\"Transaction details:\")\n+                    try:\n+                        tx = from_wallet.gettransaction(res[\"txid\"])\n+                        self.log.error(tx)\n+                        self.log.error(\"testmempoolaccept (transaction may already be in mempool):\")\n+                        self.log.error(from_wallet.testmempoolaccept([tx[\"hex\"]]))\n+                    except JSONRPCException as exc:\n+                        self.log.error(exc)\n+\n+                raise\n+\n+            return\n+\n+        if locktime:\n+            return res\n+\n+        if from_wallet.getwalletinfo()[\"private_keys_enabled\"] and not include_watching:\n+            assert_equal(res[\"complete\"], True)\n+            assert \"txid\" in res\n+        else:\n+            assert_equal(res[\"complete\"], False)\n+            assert not \"txid\" in res\n+            assert \"psbt\" in res\n+\n+        if add_to_wallet and not include_watching:\n+            # Ensure transaction exists in the wallet:\n+            tx = from_wallet.gettransaction(res[\"txid\"])\n+            assert tx\n+            assert_equal(tx[\"bip125-replaceable\"], \"yes\" if replaceable else \"no\")\n+            # Ensure transaction exists in the mempool:\n+            tx = from_wallet.getrawtransaction(res[\"txid\"],True)\n+            assert tx\n+            if amount:\n+                if subtract_fee_from_outputs:\n+                    assert_equal(from_balance_before - from_wallet.getbalance(), amount)\n+                else:\n+                    assert_greater_than(from_balance_before - from_wallet.getbalance(), amount)\n+            else:\n+                assert next((out for out in tx[\"vout\"] if out[\"scriptPubKey\"][\"asm\"] == \"OP_RETURN 35\"), None)\n+        else:\n+            assert_equal(from_balance_before, from_wallet.getbalance())\n+\n+        if to_wallet:\n+            self.sync_mempools()\n+            if add_to_wallet:\n+                if not subtract_fee_from_outputs:\n+                    assert_equal(to_wallet.getbalances()[\"mine\"][\"untrusted_pending\"], to_untrusted_pending_before + Decimal(amount if amount else 0))\n+            else:\n+                assert_equal(to_wallet.getbalances()[\"mine\"][\"untrusted_pending\"], to_untrusted_pending_before)\n+\n+        return res\n+\n+    def run_test(self):\n+        self.log.info(\"Setup wallets...\")\n+        # w0 is a wallet with coinbase rewards\n+        w0 = self.nodes[0].get_wallet_rpc(\"\")\n+        # w1 is a regular wallet\n+        self.nodes[1].createwallet(wallet_name=\"w1\")\n+        w1 = self.nodes[1].get_wallet_rpc(\"w1\")\n+        # w2 contains the private keys for w3\n+        self.nodes[1].createwallet(wallet_name=\"w2\")\n+        w2 = self.nodes[1].get_wallet_rpc(\"w2\")\n+        # w3 is a watch-only wallet, based on w2\n+        self.nodes[1].createwallet(wallet_name=\"w3\",disable_private_keys=True)\n+        w3 = self.nodes[1].get_wallet_rpc(\"w3\")\n+        for _ in range(3):\n+            a2_receive = w2.getnewaddress()\n+            a2_change = w2.getrawchangeaddress() # doesn't actually use change derivation\n+            res = w3.importmulti([{\n+                \"desc\": w2.getaddressinfo(a2_receive)[\"desc\"],\n+                \"timestamp\": \"now\",\n+                \"keypool\": True,\n+                \"watchonly\": True\n+            },{\n+                \"desc\": w2.getaddressinfo(a2_change)[\"desc\"],\n+                \"timestamp\": \"now\",\n+                \"keypool\": True,\n+                \"internal\": True,\n+                \"watchonly\": True\n+            }])\n+            assert_equal(res, [{\"success\": True}, {\"success\": True}])\n+\n+        w0.sendtoaddress(a2_receive, 10) # fund w3\n+        self.nodes[0].generate(1)\n+        self.sync_blocks()\n+\n+        # w4 has private keys enabled, but only contains watch-only keys (from w2)\n+        self.nodes[1].createwallet(wallet_name=\"w4\",disable_private_keys=False)\n+        w4 = self.nodes[1].get_wallet_rpc(\"w4\")\n+        for _ in range(3):\n+            a2_receive = w2.getnewaddress()\n+            res = w4.importmulti([{\n+                \"desc\": w2.getaddressinfo(a2_receive)[\"desc\"],\n+                \"timestamp\": \"now\",\n+                \"keypool\": False,\n+                \"watchonly\": True\n+            }])\n+            assert_equal(res, [{\"success\": True}])\n+\n+        w0.sendtoaddress(a2_receive, 10) # fund w4\n+        self.nodes[0].generate(1)\n+        self.sync_blocks()\n+\n+        self.log.info(\"Send to address...\")\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1)\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=True)\n+\n+        self.log.info(\"Don't broadcast...\")\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=False)\n+        assert(res[\"hex\"])\n+\n+        self.log.info(\"Return PSBT...\")\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, psbt=True)\n+        assert(res[\"psbt\"])\n+\n+        self.log.info(\"Create transaction that spends to address, but don't broadcast...\")\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=False)\n+        # conf_target & estimate_mode can be set as argument or option\n+        res1 = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=1, arg_estimate_mode=\"economical\", add_to_wallet=False)\n+        res2 = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=1, estimate_mode=\"economical\", add_to_wallet=False)\n+        assert_equal(self.nodes[1].decodepsbt(res1[\"psbt\"])[\"fee\"],\n+                     self.nodes[1].decodepsbt(res2[\"psbt\"])[\"fee\"])\n+        # but not at the same time\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=1, arg_estimate_mode=\"economical\",\n+                       conf_target=1, estimate_mode=\"economical\", add_to_wallet=False, expect_error=(-8,\"Use either conf_target and estimate_mode or the options dictionary to control fee rate\"))\n+\n+        self.log.info(\"Create PSBT from watch-only wallet w3, sign with w2...\")\n+        res = self.test_send(from_wallet=w3, to_wallet=w1, amount=1)\n+        res = w2.walletprocesspsbt(res[\"psbt\"])\n+        assert res[\"complete\"]\n+\n+        self.log.info(\"Create PSBT from wallet w4 with watch-only keys, sign with w2...\")\n+        self.test_send(from_wallet=w4, to_wallet=w1, amount=1, expect_error=(-4, \"Insufficient funds\"))\n+        res = self.test_send(from_wallet=w4, to_wallet=w1, amount=1, include_watching=True, add_to_wallet=False)\n+        res = w2.walletprocesspsbt(res[\"psbt\"])\n+        assert res[\"complete\"]\n+\n+        self.log.info(\"Create OP_RETURN...\")\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1)\n+        self.test_send(from_wallet=w0, data=\"Hello World\", expect_error=(-8, \"Data must be hexadecimal string (not 'Hello World')\"))\n+        self.test_send(from_wallet=w0, data=\"23\")\n+        res = self.test_send(from_wallet=w3, data=\"23\")\n+        res = w2.walletprocesspsbt(res[\"psbt\"])\n+        assert res[\"complete\"]\n+\n+        self.log.info(\"Set fee rate...\")\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=2, estimate_mode=\"sat/b\", add_to_wallet=False)\n+        fee = self.nodes[1].decodepsbt(res[\"psbt\"])[\"fee\"]\n+        assert_fee_amount(fee, Decimal(len(res[\"hex\"]) / 2), Decimal(\"0.00002\"))\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=-1, estimate_mode=\"sat/b\",\n+                       expect_error=(-3, \"Amount out of range\"))\n+        # Fee rate of 0.1 satoshi per byte should throw an error\n+        # TODO: error should say 1.000 sat/b\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.1, estimate_mode=\"sat/b\",\n+                       expect_error=(-4, \"Fee rate (0.00000100 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\"))\n+\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.000001, estimate_mode=\"BTC/KB\",\n+                       expect_error=(-4, \"Fee rate (0.00000100 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\"))\n+\n+        # TODO: Return hex if fee rate is below -maxmempool\n+        # res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.1, estimate_mode=\"sat/b\", add_to_wallet=False)\n+        # assert res[\"hex\"]\n+        # hex = res[\"hex\"]\n+        # res = self.nodes[0].testmempoolaccept([hex])\n+        # assert not res[0][\"allowed\"]\n+        # assert_equal(res[0][\"reject-reason\"], \"...\") # low fee\n+        # assert_fee_amount(fee, Decimal(len(res[\"hex\"]) / 2), Decimal(\"0.000001\"))\n+\n+        self.log.info(\"If inputs are specified, do not automatically add more...\")\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=51, inputs=[], add_to_wallet=False)\n+        assert res[\"complete\"]\n+        utxo1 = w0.listunspent()[0]\n+        assert_equal(utxo1[\"amount\"], 50)\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=51, inputs=[utxo1],\n+                       expect_error=(-4, \"Insufficient funds\"))\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=51, inputs=[utxo1], add_inputs=False,\n+                       expect_error=(-4, \"Insufficient funds\"))\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=51, inputs=[utxo1], add_inputs=True, add_to_wallet=False)\n+        assert res[\"complete\"]\n+\n+        self.log.info(\"Manual change address and position...\")\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, change_address=\"not an address\",\n+                       expect_error=(-5, \"Change address must be a valid bitcoin address\"))\n+        change_address = w0.getnewaddress()\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=False, change_address=change_address)\n+        assert res[\"complete\"]\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=False, change_address=change_address, change_position=0)\n+        assert res[\"complete\"]\n+        assert_equal(self.nodes[0].decodepsbt(res[\"psbt\"])[\"tx\"][\"vout\"][0][\"scriptPubKey\"][\"addresses\"], [change_address])\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, add_to_wallet=False, change_type=\"legacy\", change_position=0)\n+        assert res[\"complete\"]\n+        change_address = self.nodes[0].decodepsbt(res[\"psbt\"])[\"tx\"][\"vout\"][0][\"scriptPubKey\"][\"addresses\"][0]\n+        assert change_address[0] == \"m\" or change_address[0] == \"n\"\n+\n+        self.log.info(\"Set lock time...\")\n+        height = self.nodes[0].getblockchaininfo()[\"blocks\"]\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, locktime=height + 1)\n+        assert res[\"complete\"]\n+        assert res[\"txid\"]\n+        txid = res[\"txid\"]\n+        # Although the wallet finishes the transaction, it can't be added to the mempool yet:\n+        hex = self.nodes[0].gettransaction(res[\"txid\"])[\"hex\"]\n+        res = self.nodes[0].testmempoolaccept([hex])\n+        assert not res[0][\"allowed\"]\n+        assert_equal(res[0][\"reject-reason\"], \"non-final\")\n+        # It shouldn't be confirmed in the next block\n+        self.nodes[0].generate(1)\n+        assert_equal(self.nodes[0].gettransaction(txid)[\"confirmations\"], 0)\n+        # The mempool should allow it now:\n+        res = self.nodes[0].testmempoolaccept([hex])\n+        assert res[0][\"allowed\"]\n+        # Don't wait for wallet to add it to the mempool:\n+        res = self.nodes[0].sendrawtransaction(hex)\n+        self.nodes[0].generate(1)\n+        assert_equal(self.nodes[0].gettransaction(txid)[\"confirmations\"], 1)\n+\n+        self.log.info(\"Lock unspents...\")\n+        utxo1 = w0.listunspent()[0]\n+        assert_greater_than(utxo1[\"amount\"], 1)\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, inputs=[utxo1], add_to_wallet=False, lock_unspents=True)\n+        assert res[\"complete\"]\n+        locked_coins = w0.listlockunspent()\n+        assert_equal(len(locked_coins), 1)\n+        # Locked coins are automatically unlocked when manually selected\n+        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, inputs=[utxo1],add_to_wallet=False)\n+\n+        self.log.info(\"Replaceable...\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490244843",
      "id" : 490244843,
      "in_reply_to_id" : 488711853,
      "line" : 330,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDI0NDg0Mw==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 330,
      "original_position" : 330,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : 330,
      "pull_request_review_id" : 490594309,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:28:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490244843",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Nits addressed in #19969, where I'm also declaring this RPC experimental.",
      "created_at" : "2020-09-17T13:31:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#issuecomment-694236447",
      "id" : 694236447,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16378",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NDIzNjQ0Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-17T13:31:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/694236447",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490400099"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490400099"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Not that I see... I am not sure if I am missing something or if you missed the point of my initial (non-nit) comment :) But now I seem to be able to make code suggestions again (didn't work before for some reason), this is what I meant with \"this seems like a bug\":\r\n\r\n```suggestion\r\n                rbf = options[\"replaceable\"].get_bool();\r\n```",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-17T16:32:03Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+            \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+                    {\"include_watching\", RPCArg::Type::BOOL, /* default */ \"true for watch-only wallets, otherwise false\", \"Also select inputs which are watch only.\\n\"\n+                                          \"Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\\n\"\n+                                          \"e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.\"},\n+                    {\"inputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Specify inputs instead of adding them automatically. A json array of json objects\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lock_unspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"psbt\", RPCArg::Type::BOOL,  /* default */ \"automatic\", \"Always return a PSBT, implies add_to_wallet=false.\"},\n+                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+                {\n+                    {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n+                    {RPCResult::Type::STR_HEX, \"txid\", \"The transaction id for the send. Only 1 transaction is created regardless of the number of addresses.\"},\n+                    {RPCResult::Type::STR_HEX, \"hex\", \"If add_to_wallet is false, the hex-encoded raw transaction with signature(s)\"},\n+                    {RPCResult::Type::STR, \"psbt\", \"If more signatures are needed, or if add_to_wallet is false, the base64-encoded (partially) signed transaction\"}\n+                }\n+        },\n+        RPCExamples{\"\"\n+        \"\\nSend with a fee rate of 1 satoshi per byte\\n\"\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 sat/b\\n\" +\n+            \"\\nCreate a transaction that should confirm the next block, with a specific input, and return result without adding to wallet or broadcasting to the network\\n\")\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 economical '{\\\"add_to_wallet\\\": false, \\\"inputs\\\": [{\\\"txid\\\":\\\"a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\", \\\"vout\\\":1}]}'\")\n+        },\n+        [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n+        {\n+            RPCTypeCheck(request.params, {\n+                UniValueType(), // ARR or OBJ, checked later\n+                UniValue::VNUM,\n+                UniValue::VSTR,\n+                UniValue::VOBJ\n+                }, true\n+            );\n+\n+            std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+            if (!wallet) return NullUniValue;\n+            CWallet* const pwallet = wallet.get();\n+\n+            UniValue options = request.params[3];\n+            if (options.exists(\"feeRate\") || options.exists(\"fee_rate\") || options.exists(\"estimate_mode\") || options.exists(\"conf_target\")) {\n+                if (!request.params[1].isNull() || !request.params[2].isNull()) {\n+                    throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use either conf_target and estimate_mode or the options dictionary to control fee rate\");\n+                }\n+            } else {\n+                options.pushKV(\"conf_target\", request.params[1]);\n+                options.pushKV(\"estimate_mode\", request.params[2]);\n+            }\n+            if (!options[\"conf_target\"].isNull() && (options[\"estimate_mode\"].isNull() || (options[\"estimate_mode\"].get_str() == \"unset\"))) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Specify estimate_mode\");\n+            }\n+            if (options.exists(\"changeAddress\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_address\");\n+            }\n+            if (options.exists(\"changePosition\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_position\");\n+            }\n+            if (options.exists(\"includeWatching\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use include_watching\");\n+            }\n+            if (options.exists(\"lockUnspents\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use lock_unspents\");\n+            }\n+            if (options.exists(\"subtractFeeFromOutputs\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use subtract_fee_from_outputs\");\n+            }\n+\n+            const bool psbt_opt_in = options.exists(\"psbt\") && options[\"psbt\"].get_bool();\n+\n+            CAmount fee;\n+            int change_position;\n+            bool rbf = pwallet->m_signal_rbf;\n+            if (options.exists(\"replaceable\")) {\n+                rbf = options[\"add_to_wallet\"].get_bool();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490400099",
      "id" : 490400099,
      "in_reply_to_id" : 488698235,
      "line" : 3997,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQwMDA5OQ==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 3997,
      "original_position" : 157,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 218,
      "pull_request_review_id" : 490785684,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T16:36:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490400099",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490477215"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490477215"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think I got distracted by your second comment. Will fix in #19969 ",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-17T18:42:48Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+            \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+                    {\"include_watching\", RPCArg::Type::BOOL, /* default */ \"true for watch-only wallets, otherwise false\", \"Also select inputs which are watch only.\\n\"\n+                                          \"Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\\n\"\n+                                          \"e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.\"},\n+                    {\"inputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Specify inputs instead of adding them automatically. A json array of json objects\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lock_unspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"psbt\", RPCArg::Type::BOOL,  /* default */ \"automatic\", \"Always return a PSBT, implies add_to_wallet=false.\"},\n+                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+                {\n+                    {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n+                    {RPCResult::Type::STR_HEX, \"txid\", \"The transaction id for the send. Only 1 transaction is created regardless of the number of addresses.\"},\n+                    {RPCResult::Type::STR_HEX, \"hex\", \"If add_to_wallet is false, the hex-encoded raw transaction with signature(s)\"},\n+                    {RPCResult::Type::STR, \"psbt\", \"If more signatures are needed, or if add_to_wallet is false, the base64-encoded (partially) signed transaction\"}\n+                }\n+        },\n+        RPCExamples{\"\"\n+        \"\\nSend with a fee rate of 1 satoshi per byte\\n\"\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 sat/b\\n\" +\n+            \"\\nCreate a transaction that should confirm the next block, with a specific input, and return result without adding to wallet or broadcasting to the network\\n\")\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 economical '{\\\"add_to_wallet\\\": false, \\\"inputs\\\": [{\\\"txid\\\":\\\"a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\", \\\"vout\\\":1}]}'\")\n+        },\n+        [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n+        {\n+            RPCTypeCheck(request.params, {\n+                UniValueType(), // ARR or OBJ, checked later\n+                UniValue::VNUM,\n+                UniValue::VSTR,\n+                UniValue::VOBJ\n+                }, true\n+            );\n+\n+            std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+            if (!wallet) return NullUniValue;\n+            CWallet* const pwallet = wallet.get();\n+\n+            UniValue options = request.params[3];\n+            if (options.exists(\"feeRate\") || options.exists(\"fee_rate\") || options.exists(\"estimate_mode\") || options.exists(\"conf_target\")) {\n+                if (!request.params[1].isNull() || !request.params[2].isNull()) {\n+                    throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use either conf_target and estimate_mode or the options dictionary to control fee rate\");\n+                }\n+            } else {\n+                options.pushKV(\"conf_target\", request.params[1]);\n+                options.pushKV(\"estimate_mode\", request.params[2]);\n+            }\n+            if (!options[\"conf_target\"].isNull() && (options[\"estimate_mode\"].isNull() || (options[\"estimate_mode\"].get_str() == \"unset\"))) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Specify estimate_mode\");\n+            }\n+            if (options.exists(\"changeAddress\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_address\");\n+            }\n+            if (options.exists(\"changePosition\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_position\");\n+            }\n+            if (options.exists(\"includeWatching\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use include_watching\");\n+            }\n+            if (options.exists(\"lockUnspents\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use lock_unspents\");\n+            }\n+            if (options.exists(\"subtractFeeFromOutputs\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use subtract_fee_from_outputs\");\n+            }\n+\n+            const bool psbt_opt_in = options.exists(\"psbt\") && options[\"psbt\"].get_bool();\n+\n+            CAmount fee;\n+            int change_position;\n+            bool rbf = pwallet->m_signal_rbf;\n+            if (options.exists(\"replaceable\")) {\n+                rbf = options[\"add_to_wallet\"].get_bool();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490477215",
      "id" : 490477215,
      "in_reply_to_id" : 488698235,
      "line" : 3997,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ3NzIxNQ==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 3997,
      "original_position" : 157,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 218,
      "pull_request_review_id" : 490885423,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T18:42:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490477215",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490500686"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490500686"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think the type is correct, see also `walletcreatefundedpsbt`, but it's confusing (in the code) that the wrapping object is described next to the `data` field. cc @achow101 / @MarcoFalke thoughts?",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-17T19:23:58Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490500686",
      "id" : 490500686,
      "in_reply_to_id" : 488347536,
      "line" : 3890,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDUwMDY4Ng==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 3890,
      "original_position" : 50,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 111,
      "pull_request_review_id" : 490918410,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T19:23:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490500686",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490511521"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490511521"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The type is correct because it is describing the type of the value in this key-value pair. The weirdness is that this output specification is the almost the only place where the key is not fixed but user defined.",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-17T19:34:06Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490511521",
      "id" : 490511521,
      "in_reply_to_id" : 488347536,
      "line" : 3890,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDUxMTUyMQ==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 3890,
      "original_position" : 50,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 111,
      "pull_request_review_id" : 490925595,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T19:34:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490511521",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490628950"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490628950"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Feels out of scope for #19957, and not a big deal anyway so leaving it be.",
      "commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "created_at" : "2020-09-18T00:12:43Z",
      "diff_hunk" : "@@ -3866,6 +3871,185 @@ static UniValue listlabels(const JSONRPCRequest& request)\n     return ret;\n }\n \n+static RPCHelpMan send()\n+{\n+    return RPCHelpMan{\"send\",\n+        \"\\nSend a transaction.\\n\",\n+        {\n+            {\"outputs\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"a json array with outputs (key-value pairs), where none of the keys are duplicated.\\n\"\n+                    \"That is, each address can only appear once and there can only be one 'data' object.\\n\"\n+                    \"For convenience, a dictionary, which holds the key-value pairs directly, is also accepted.\",\n+                {\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"address\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"A key-value pair. The key (string) is the bitcoin address, the value (float or string) is the amount in \" + CURRENCY_UNIT + \"\"},\n+                        },\n+                        },\n+                    {\"\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED, \"\",\n+                        {\n+                            {\"data\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"A key-value pair. The key must be \\\"data\\\", the value is hex-encoded data\"},\n+                        },\n+                    },\n+                },\n+            },\n+            {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+                        \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+            {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                {\n+                    {\"add_inputs\", RPCArg::Type::BOOL, /* default */ \"false\", \"If inputs are specified, automatically include more if they are not enough.\"},\n+                    {\"add_to_wallet\", RPCArg::Type::BOOL, /* default */ \"true\", \"When false, returns a serialized transaction which will not be added to the wallet or broadcast\"},\n+                    {\"change_address\", RPCArg::Type::STR_HEX, /* default */ \"pool address\", \"The bitcoin address to receive the change\"},\n+                    {\"change_position\", RPCArg::Type::NUM, /* default */ \"random\", \"The index of the change output\"},\n+                    {\"change_type\", RPCArg::Type::STR, /* default */ \"set by -changetype\", \"The output type to use. Only valid if change_address is not specified. Options are \\\"legacy\\\", \\\"p2sh-segwit\\\", and \\\"bech32\\\".\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"unset\", std::string() + \"The fee estimate mode, must be one of (case insensitive):\\n\"\n+            \"       \\\"\" + FeeModes(\"\\\"\\n\\\"\") + \"\\\"\"},\n+                    {\"include_watching\", RPCArg::Type::BOOL, /* default */ \"true for watch-only wallets, otherwise false\", \"Also select inputs which are watch only.\\n\"\n+                                          \"Only solvable inputs can be used. Watch-only destinations are solvable if the public key and/or output script was imported,\\n\"\n+                                          \"e.g. with 'importpubkey' or 'importmulti' with the 'pubkeys' or 'desc' field.\"},\n+                    {\"inputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Specify inputs instead of adding them automatically. A json array of json objects\",\n+                        {\n+                            {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                            {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                            {\"sequence\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The sequence number\"},\n+                        },\n+                    },\n+                    {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n+                    {\"lock_unspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n+                    {\"psbt\", RPCArg::Type::BOOL,  /* default */ \"automatic\", \"Always return a PSBT, implies add_to_wallet=false.\"},\n+                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A json array of integers.\\n\"\n+                    \"The fee will be equally deducted from the amount of each specified output.\\n\"\n+                    \"Those recipients will receive less bitcoins than you enter in their corresponding amount field.\\n\"\n+                    \"If no outputs are specified here, the sender pays the fee.\",\n+                        {\n+                            {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n+                        },\n+                    },\n+                    {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Marks this transaction as BIP125 replaceable.\\n\"\n+                    \"                              Allows this transaction to be replaced by a transaction with higher fees\"},\n+                },\n+                \"options\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+                {\n+                    {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n+                    {RPCResult::Type::STR_HEX, \"txid\", \"The transaction id for the send. Only 1 transaction is created regardless of the number of addresses.\"},\n+                    {RPCResult::Type::STR_HEX, \"hex\", \"If add_to_wallet is false, the hex-encoded raw transaction with signature(s)\"},\n+                    {RPCResult::Type::STR, \"psbt\", \"If more signatures are needed, or if add_to_wallet is false, the base64-encoded (partially) signed transaction\"}\n+                }\n+        },\n+        RPCExamples{\"\"\n+        \"\\nSend with a fee rate of 1 satoshi per byte\\n\"\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 sat/b\\n\" +\n+            \"\\nCreate a transaction that should confirm the next block, with a specific input, and return result without adding to wallet or broadcasting to the network\\n\")\n+        + HelpExampleCli(\"send\", \"'{\\\"\" + EXAMPLE_ADDRESS[0] + \"\\\": 0.1}' 1 economical '{\\\"add_to_wallet\\\": false, \\\"inputs\\\": [{\\\"txid\\\":\\\"a08e6907dbbd3d809776dbfc5d82e371b764ed838b5655e72f463568df1aadf0\\\", \\\"vout\\\":1}]}'\")\n+        },\n+        [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n+        {\n+            RPCTypeCheck(request.params, {\n+                UniValueType(), // ARR or OBJ, checked later\n+                UniValue::VNUM,\n+                UniValue::VSTR,\n+                UniValue::VOBJ\n+                }, true\n+            );\n+\n+            std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+            if (!wallet) return NullUniValue;\n+            CWallet* const pwallet = wallet.get();\n+\n+            UniValue options = request.params[3];\n+            if (options.exists(\"feeRate\") || options.exists(\"fee_rate\") || options.exists(\"estimate_mode\") || options.exists(\"conf_target\")) {\n+                if (!request.params[1].isNull() || !request.params[2].isNull()) {\n+                    throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use either conf_target and estimate_mode or the options dictionary to control fee rate\");\n+                }\n+            } else {\n+                options.pushKV(\"conf_target\", request.params[1]);\n+                options.pushKV(\"estimate_mode\", request.params[2]);\n+            }\n+            if (!options[\"conf_target\"].isNull() && (options[\"estimate_mode\"].isNull() || (options[\"estimate_mode\"].get_str() == \"unset\"))) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Specify estimate_mode\");\n+            }\n+            if (options.exists(\"changeAddress\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_address\");\n+            }\n+            if (options.exists(\"changePosition\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use change_position\");\n+            }\n+            if (options.exists(\"includeWatching\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use include_watching\");\n+            }\n+            if (options.exists(\"lockUnspents\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use lock_unspents\");\n+            }\n+            if (options.exists(\"subtractFeeFromOutputs\")) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Use subtract_fee_from_outputs\");\n+            }\n+\n+            const bool psbt_opt_in = options.exists(\"psbt\") && options[\"psbt\"].get_bool();\n+\n+            CAmount fee;\n+            int change_position;\n+            bool rbf = pwallet->m_signal_rbf;\n+            if (options.exists(\"replaceable\")) {\n+                rbf = options[\"add_to_wallet\"].get_bool();\n+            }\n+            CMutableTransaction rawTx = ConstructTransaction(options[\"inputs\"], request.params[0], options[\"locktime\"], rbf);\n+            CCoinControl coin_control;\n+            // Automatically select coins, unless at least one is manually selected. Can\n+            // be overriden by options.add_inputs.\n+            coin_control.m_add_inputs = rawTx.vin.size() == 0;\n+            FundTransaction(pwallet, rawTx, fee, change_position, options, coin_control);\n+\n+            bool add_to_wallet = true;\n+            if (options.exists(\"add_to_wallet\")) {\n+                add_to_wallet = options[\"add_to_wallet\"].get_bool();\n+            }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16378#discussion_r490628950",
      "id" : 490628950,
      "in_reply_to_id" : 488349241,
      "line" : 4009,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDYyODk1MA==",
      "original_commit_id" : "92326d89766155a792254d30a9962251b8fc7799",
      "original_line" : 4009,
      "original_position" : 169,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 230,
      "pull_request_review_id" : 491068640,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16378",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-18T00:12:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490628950",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   }
]
