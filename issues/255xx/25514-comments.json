[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25515](https://github.com/bitcoin/bitcoin/pull/25515) ([draft] PeerManager unit tests by dergoegge)\n* [#25472](https://github.com/bitcoin/bitcoin/pull/25472) (build: Increase MS Visual Studio minimum version by hebasto)\n* [#25454](https://github.com/bitcoin/bitcoin/pull/25454) (p2p: Avoid multiple getheaders messages in flight to the same peer by sdaftuar)\n* [#25355](https://github.com/bitcoin/bitcoin/pull/25355) (I2P: add support for transient addresses for outbound connections by vasild)\n* [#25268](https://github.com/bitcoin/bitcoin/pull/25268) (refactor: Introduce EvictionManager by dergoegge)\n* [#25203](https://github.com/bitcoin/bitcoin/pull/25203) (logging: update to severity-based logging by jonatack)\n* [#25174](https://github.com/bitcoin/bitcoin/pull/25174) (net/net_processing: Add thread safety related annotations for CNode and Peer by ajtowns)\n* [#24697](https://github.com/bitcoin/bitcoin/pull/24697) (refactor address relay time by MarcoFalke)\n* [#24571](https://github.com/bitcoin/bitcoin/pull/24571) (p2p: Prevent block index fingerprinting by sending additional getheaders messages by dergoegge)\n* [#24170](https://github.com/bitcoin/bitcoin/pull/24170) (p2p, rpc: Manual block-relay-only connections with addnode by mzumsande)\n* [#24008](https://github.com/bitcoin/bitcoin/pull/24008) (assumeutxo: net_processing changes by jamesob)\n* [#23443](https://github.com/bitcoin/bitcoin/pull/23443) (p2p: Erlay support signaling by naumenkogs)\n* [#17167](https://github.com/bitcoin/bitcoin/pull/17167) (Allow whitelisting outgoing connections by luke-jr)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-06-30T19:52:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25514#issuecomment-1171615993",
      "id" : 1171615993,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25514",
      "node_id" : "IC_kwDOABII585F1XD5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1171615993/reactions"
      },
      "updated_at" : "2022-07-04T17:43:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1171615993",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r912007088"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912007088"
         }
      },
      "author_association" : "MEMBER",
      "body" : "why is this removed when it can be moved down?",
      "commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "created_at" : "2022-07-01T14:20:32Z",
      "diff_hunk" : "@@ -324,7 +324,6 @@ void FillNode(FuzzedDataProvider& fuzzed_data_provider, ConnmanTestMsg& connman,\n     if (node.fDisconnect) return;\n     assert(node.nVersion == version);\n     assert(node.GetCommonVersion() == std::min(version, PROTOCOL_VERSION));\n-    assert(node.nServices == remote_services);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r912007088",
      "id" : 912007088,
      "line" : 327,
      "node_id" : "PRRC_kwDOABII5842XB-w",
      "original_commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "original_line" : 327,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.cpp",
      "position" : 4,
      "pull_request_review_id" : 1026286280,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912007088/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-01T14:22:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912007088",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r912007425"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912007425"
         }
      },
      "author_association" : "MEMBER",
      "body" : "why is this removed and replaced with a hardcoded value?",
      "commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "created_at" : "2022-07-01T14:20:56Z",
      "diff_hunk" : "@@ -296,7 +296,6 @@ template <bool ReturnUniquePtr = false>\n auto ConsumeNode(FuzzedDataProvider& fuzzed_data_provider, const std::optional<NodeId>& node_id_in = std::nullopt) noexcept\n {\n     const NodeId node_id = node_id_in.value_or(fuzzed_data_provider.ConsumeIntegralInRange<NodeId>(0, std::numeric_limits<NodeId>::max()));\n-    const ServiceFlags local_services = ConsumeWeakEnum(fuzzed_data_provider, ALL_SERVICE_FLAGS);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r912007425",
      "id" : 912007425,
      "line" : 299,
      "node_id" : "PRRC_kwDOABII5842XCEB",
      "original_commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "original_line" : 299,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : 4,
      "pull_request_review_id" : 1026286280,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912007425/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-01T14:22:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912007425",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r912734475"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912734475"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This function no longer requires `cs_main`.",
      "commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "created_at" : "2022-07-04T08:05:02Z",
      "diff_hunk" : "@@ -636,7 +653,7 @@ class PeerManagerImpl final : public PeerManager\n     /** Get a pointer to a mutable CNodeState. */\n     CNodeState* State(NodeId pnode) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\n \n-    uint32_t GetFetchFlags(const CNode& pfrom) const EXCLUSIVE_LOCKS_REQUIRED(cs_main);\n+    uint32_t GetFetchFlags(const Peer& peer) const EXCLUSIVE_LOCKS_REQUIRED(cs_main);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r912734475",
      "id" : 912734475,
      "line" : 656,
      "node_id" : "PRRC_kwDOABII5842ZzkL",
      "original_commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "original_line" : 656,
      "original_position" : 68,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 68,
      "pull_request_review_id" : 1027168080,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912734475/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-04T08:45:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912734475",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r912735065"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912735065"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Perhaps it makes sense to remove `NodeId nodeid` as an argument to this function, now that it can easily be accessed from the `peer` argument.",
      "commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "created_at" : "2022-07-04T08:05:49Z",
      "diff_hunk" : "@@ -757,7 +774,7 @@ class PeerManagerImpl final : public PeerManager\n     /** Update pindexLastCommonBlock and add not-in-flight missing successors to vBlocks, until it has\n      *  at most count entries.\n      */\n-    void FindNextBlocksToDownload(NodeId nodeid, unsigned int count, std::vector<const CBlockIndex*>& vBlocks, NodeId& nodeStaller) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\n+    void FindNextBlocksToDownload(NodeId nodeid, const Peer& peer, unsigned int count, std::vector<const CBlockIndex*>& vBlocks, NodeId& nodeStaller) EXCLUSIVE_LOCKS_REQUIRED(cs_main);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r912735065",
      "id" : 912735065,
      "line" : 777,
      "node_id" : "PRRC_kwDOABII5842ZztZ",
      "original_commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "original_line" : 777,
      "original_position" : 77,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 77,
      "pull_request_review_id" : 1027168080,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912735065/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-04T08:45:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912735065",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r912751871"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912751871"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm not sure if changing these fields to optional requires a release note, since missing fields that used to be always present could break clients that assume they'll be there. See #25176 for example.",
      "commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "created_at" : "2022-07-04T08:25:04Z",
      "diff_hunk" : "@@ -130,6 +125,11 @@ static RPCHelpMan getpeerinfo()\n                     {RPCResult::Type::BOOL, \"inbound\", \"Inbound (true) or Outbound (false)\"},\n                     {RPCResult::Type::BOOL, \"bip152_hb_to\", \"Whether we selected peer as (compact blocks) high-bandwidth peer\"},\n                     {RPCResult::Type::BOOL, \"bip152_hb_from\", \"Whether peer selected us as (compact blocks) high-bandwidth peer\"},\n+                    {RPCResult::Type::STR_HEX, \"services\", /*optional=*/true, \"The services offered\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r912751871",
      "id" : 912751871,
      "line" : 128,
      "node_id" : "PRRC_kwDOABII5842Z3z_",
      "original_commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "original_line" : 128,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : 16,
      "pull_request_review_id" : 1027168080,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912751871/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-04T08:45:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912751871",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r912765757"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912765757"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think the line lower down:\r\n\r\n```\r\naddrLocal = CAddress{pnode->GetAddrLocal(), addrLocal.nServices, addrLocal.nTime};\r\n```\r\n\r\nNo longer makes sense, since `addrLocal.nServices` will always be `NODE_NONE`. Perhaps change `addrLocal.nServices` to `NODE_NONE`, since it is the caller's job to set the services.\r\n\r\nPerhaps even better would be to change `GetLocalAddrForPeer` and `GetLocalAddress` to return a `CService` instead of a `CAddress`, so the caller has to set the `nTime` and `nServices` fields (which might help avoid bugs like #25314).",
      "commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "created_at" : "2022-07-04T08:40:39Z",
      "diff_hunk" : "@@ -235,10 +235,10 @@ bool IsPeerAddrLocalGood(CNode *pnode)\n \n std::optional<CAddress> GetLocalAddrForPeer(CNode *pnode)\n {\n-    CAddress addrLocal = GetLocalAddress(&pnode->addr, pnode->GetLocalServices());\n+    CAddress addrLocal = GetLocalAddress(&pnode->addr);\n     if (gArgs.GetBoolArg(\"-addrmantest\", false)) {\n         // use IPv4 loopback during addrmantest\n-        addrLocal = CAddress(CService(LookupNumeric(\"127.0.0.1\", GetListenPort())), pnode->GetLocalServices());\n+        addrLocal = CAddress(CService(LookupNumeric(\"127.0.0.1\", GetListenPort())), NODE_NONE);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r912765757",
      "id" : 912765757,
      "line" : 241,
      "node_id" : "PRRC_kwDOABII5842Z7M9",
      "original_commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "original_line" : 241,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 26,
      "pull_request_review_id" : 1027168080,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912765757/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-04T08:45:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912765757",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r912770455"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912770455"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Which hardcoded value? The `CNode` object no longer contains `nServices`, so there's nothing to set here.",
      "commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "created_at" : "2022-07-04T08:45:36Z",
      "diff_hunk" : "@@ -296,7 +296,6 @@ template <bool ReturnUniquePtr = false>\n auto ConsumeNode(FuzzedDataProvider& fuzzed_data_provider, const std::optional<NodeId>& node_id_in = std::nullopt) noexcept\n {\n     const NodeId node_id = node_id_in.value_or(fuzzed_data_provider.ConsumeIntegralInRange<NodeId>(0, std::numeric_limits<NodeId>::max()));\n-    const ServiceFlags local_services = ConsumeWeakEnum(fuzzed_data_provider, ALL_SERVICE_FLAGS);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r912770455",
      "id" : 912770455,
      "in_reply_to_id" : 912007425,
      "line" : 299,
      "node_id" : "PRRC_kwDOABII5842Z8WX",
      "original_commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "original_line" : 299,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : 4,
      "pull_request_review_id" : 1027168080,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912770455/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-04T08:45:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912770455",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r912817160"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912817160"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The symbol is moved from `CNode` to `Peer`. I think a refactoring pull request should not change the value of the symbol.\r\n\r\nIf the local service flags were previously determined by the fuzz engine, they should still be after this change, regardless of the namespace of the symbol.",
      "commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "created_at" : "2022-07-04T09:34:58Z",
      "diff_hunk" : "@@ -296,7 +296,6 @@ template <bool ReturnUniquePtr = false>\n auto ConsumeNode(FuzzedDataProvider& fuzzed_data_provider, const std::optional<NodeId>& node_id_in = std::nullopt) noexcept\n {\n     const NodeId node_id = node_id_in.value_or(fuzzed_data_provider.ConsumeIntegralInRange<NodeId>(0, std::numeric_limits<NodeId>::max()));\n-    const ServiceFlags local_services = ConsumeWeakEnum(fuzzed_data_provider, ALL_SERVICE_FLAGS);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r912817160",
      "id" : 912817160,
      "in_reply_to_id" : 912007425,
      "line" : 299,
      "node_id" : "PRRC_kwDOABII5842aHwI",
      "original_commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "original_line" : 299,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : 4,
      "pull_request_review_id" : 1027284569,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912817160/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-04T09:34:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912817160",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r912899595"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912899595"
         }
      },
      "author_association" : "MEMBER",
      "body" : "To be clear, are you suggesting that the `InitializeNode()` calls in fuzz/processmessage.cpp and fuzz/processmessages.cpp should be updated to take `ConsumeWeakEnum(fuzzed_data_provider, ALL_SERVICE_FLAGS)`?",
      "commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "created_at" : "2022-07-04T11:15:13Z",
      "diff_hunk" : "@@ -296,7 +296,6 @@ template <bool ReturnUniquePtr = false>\n auto ConsumeNode(FuzzedDataProvider& fuzzed_data_provider, const std::optional<NodeId>& node_id_in = std::nullopt) noexcept\n {\n     const NodeId node_id = node_id_in.value_or(fuzzed_data_provider.ConsumeIntegralInRange<NodeId>(0, std::numeric_limits<NodeId>::max()));\n-    const ServiceFlags local_services = ConsumeWeakEnum(fuzzed_data_provider, ALL_SERVICE_FLAGS);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r912899595",
      "id" : 912899595,
      "in_reply_to_id" : 912007425,
      "line" : 299,
      "node_id" : "PRRC_kwDOABII5842ab4L",
      "original_commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "original_line" : 299,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : 4,
      "pull_request_review_id" : 1027404490,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912899595/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-04T11:15:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912899595",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r912904348"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912904348"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes.\r\n\r\nI am also thinking if `InitializeNode` can be moved into `FillNode`, so that only one place needs to be updated.",
      "commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "created_at" : "2022-07-04T11:21:38Z",
      "diff_hunk" : "@@ -296,7 +296,6 @@ template <bool ReturnUniquePtr = false>\n auto ConsumeNode(FuzzedDataProvider& fuzzed_data_provider, const std::optional<NodeId>& node_id_in = std::nullopt) noexcept\n {\n     const NodeId node_id = node_id_in.value_or(fuzzed_data_provider.ConsumeIntegralInRange<NodeId>(0, std::numeric_limits<NodeId>::max()));\n-    const ServiceFlags local_services = ConsumeWeakEnum(fuzzed_data_provider, ALL_SERVICE_FLAGS);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r912904348",
      "id" : 912904348,
      "in_reply_to_id" : 912007425,
      "line" : 299,
      "node_id" : "PRRC_kwDOABII5842adCc",
      "original_commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "original_line" : 299,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : 4,
      "pull_request_review_id" : 1027411098,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912904348/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-04T11:21:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/912904348",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r913133744"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913133744"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Moved the assert down.",
      "commit_id" : "fae6a00290e0eb9584e2205f252ab46648d6fbdc",
      "created_at" : "2022-07-04T16:18:17Z",
      "diff_hunk" : "@@ -324,7 +324,6 @@ void FillNode(FuzzedDataProvider& fuzzed_data_provider, ConnmanTestMsg& connman,\n     if (node.fDisconnect) return;\n     assert(node.nVersion == version);\n     assert(node.GetCommonVersion() == std::min(version, PROTOCOL_VERSION));\n-    assert(node.nServices == remote_services);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r913133744",
      "id" : 913133744,
      "in_reply_to_id" : 912007088,
      "line" : 327,
      "node_id" : "PRRC_kwDOABII5842bVCw",
      "original_commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "original_line" : 327,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.cpp",
      "position" : 18,
      "pull_request_review_id" : 1027737610,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913133744/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-04T16:18:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913133744",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
         "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dergoegge/followers",
         "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dergoegge",
         "id" : 8077169,
         "login" : "dergoegge",
         "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
         "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
         "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
         "repos_url" : "https://api.github.com/users/dergoegge/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dergoegge"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r913134477"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913134477"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Moved all `InitializeNode` calls (there were only 2) into `FillNode` with service flags consumed from the fuzzer.",
      "commit_id" : "fae6a00290e0eb9584e2205f252ab46648d6fbdc",
      "created_at" : "2022-07-04T16:19:39Z",
      "diff_hunk" : "@@ -296,7 +296,6 @@ template <bool ReturnUniquePtr = false>\n auto ConsumeNode(FuzzedDataProvider& fuzzed_data_provider, const std::optional<NodeId>& node_id_in = std::nullopt) noexcept\n {\n     const NodeId node_id = node_id_in.value_or(fuzzed_data_provider.ConsumeIntegralInRange<NodeId>(0, std::numeric_limits<NodeId>::max()));\n-    const ServiceFlags local_services = ConsumeWeakEnum(fuzzed_data_provider, ALL_SERVICE_FLAGS);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r913134477",
      "id" : 913134477,
      "in_reply_to_id" : 912007425,
      "line" : 299,
      "node_id" : "PRRC_kwDOABII5842bVON",
      "original_commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "original_line" : 299,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : 4,
      "pull_request_review_id" : 1027738527,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913134477/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-04T16:19:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913134477",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
         "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dergoegge/followers",
         "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dergoegge",
         "id" : 8077169,
         "login" : "dergoegge",
         "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
         "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
         "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
         "repos_url" : "https://api.github.com/users/dergoegge/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dergoegge"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r913134913"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913134913"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yup, removed the NodeId arg.",
      "commit_id" : "fae6a00290e0eb9584e2205f252ab46648d6fbdc",
      "created_at" : "2022-07-04T16:20:33Z",
      "diff_hunk" : "@@ -757,7 +774,7 @@ class PeerManagerImpl final : public PeerManager\n     /** Update pindexLastCommonBlock and add not-in-flight missing successors to vBlocks, until it has\n      *  at most count entries.\n      */\n-    void FindNextBlocksToDownload(NodeId nodeid, unsigned int count, std::vector<const CBlockIndex*>& vBlocks, NodeId& nodeStaller) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\n+    void FindNextBlocksToDownload(NodeId nodeid, const Peer& peer, unsigned int count, std::vector<const CBlockIndex*>& vBlocks, NodeId& nodeStaller) EXCLUSIVE_LOCKS_REQUIRED(cs_main);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r913134913",
      "id" : 913134913,
      "in_reply_to_id" : 912735065,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5842bVVB",
      "original_commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "original_line" : 777,
      "original_position" : 77,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 1027739092,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913134913/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-04T16:20:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913134913",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
         "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dergoegge/followers",
         "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dergoegge",
         "id" : 8077169,
         "login" : "dergoegge",
         "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
         "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
         "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
         "repos_url" : "https://api.github.com/users/dergoegge/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dergoegge"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r913135978"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913135978"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Perhaps even better would be to change GetLocalAddrForPeer and GetLocalAddress to return a `CService`\r\n\r\nAdded an extra commit to do this. Makes it obvious that the caller is supposed to set the `nTime` and `nServices` fields.",
      "commit_id" : "fae6a00290e0eb9584e2205f252ab46648d6fbdc",
      "created_at" : "2022-07-04T16:22:37Z",
      "diff_hunk" : "@@ -235,10 +235,10 @@ bool IsPeerAddrLocalGood(CNode *pnode)\n \n std::optional<CAddress> GetLocalAddrForPeer(CNode *pnode)\n {\n-    CAddress addrLocal = GetLocalAddress(&pnode->addr, pnode->GetLocalServices());\n+    CAddress addrLocal = GetLocalAddress(&pnode->addr);\n     if (gArgs.GetBoolArg(\"-addrmantest\", false)) {\n         // use IPv4 loopback during addrmantest\n-        addrLocal = CAddress(CService(LookupNumeric(\"127.0.0.1\", GetListenPort())), pnode->GetLocalServices());\n+        addrLocal = CAddress(CService(LookupNumeric(\"127.0.0.1\", GetListenPort())), NODE_NONE);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r913135978",
      "id" : 913135978,
      "in_reply_to_id" : 912765757,
      "line" : 239,
      "node_id" : "PRRC_kwDOABII5842bVlq",
      "original_commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "original_line" : 239,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 32,
      "pull_request_review_id" : 1027740470,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913135978/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-04T16:22:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913135978",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
         "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dergoegge/followers",
         "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dergoegge",
         "id" : 8077169,
         "login" : "dergoegge",
         "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
         "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
         "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
         "repos_url" : "https://api.github.com/users/dergoegge/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dergoegge"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r913146453"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913146453"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I changed this back to be non-optional just to stick with the previous behavior (i.e. when the peer has not sent a `version` message yet we default to  `NODE_NONE`).",
      "commit_id" : "fae6a00290e0eb9584e2205f252ab46648d6fbdc",
      "created_at" : "2022-07-04T16:45:07Z",
      "diff_hunk" : "@@ -130,6 +125,11 @@ static RPCHelpMan getpeerinfo()\n                     {RPCResult::Type::BOOL, \"inbound\", \"Inbound (true) or Outbound (false)\"},\n                     {RPCResult::Type::BOOL, \"bip152_hb_to\", \"Whether we selected peer as (compact blocks) high-bandwidth peer\"},\n                     {RPCResult::Type::BOOL, \"bip152_hb_from\", \"Whether peer selected us as (compact blocks) high-bandwidth peer\"},\n+                    {RPCResult::Type::STR_HEX, \"services\", /*optional=*/true, \"The services offered\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25514#discussion_r913146453",
      "id" : 913146453,
      "in_reply_to_id" : 912751871,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5842bYJV",
      "original_commit_id" : "10a4ebab27309c781f284d260c882055c66eeb1e",
      "original_line" : 128,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 1027754456,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25514",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913146453/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-04T16:45:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913146453",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
         "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dergoegge/followers",
         "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dergoegge",
         "id" : 8077169,
         "login" : "dergoegge",
         "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
         "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
         "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
         "repos_url" : "https://api.github.com/users/dergoegge/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dergoegge"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-07-04T21:06:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25514#issuecomment-1174361399",
      "id" : 1174361399,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25514",
      "node_id" : "IC_kwDOABII585F_1U3",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1174361399/reactions"
      },
      "updated_at" : "2022-07-04T21:06:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1174361399",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   }
]
