[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [vasild](https://github.com/bitcoin/bitcoin/pull/28078#pullrequestreview-1556652326), [stickies-v](https://github.com/bitcoin/bitcoin/pull/28078#pullrequestreview-1560767388), [achow101](https://github.com/bitcoin/bitcoin/pull/28078#issuecomment-1729810988) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#27581](https://github.com/bitcoin/bitcoin/pull/27581) (net: Continuous ASMap health check by fjahr)\n* [#27071](https://github.com/bitcoin/bitcoin/pull/27071) (Handle CJDNS from LookupSubNet() by vasild)\n* [#25390](https://github.com/bitcoin/bitcoin/pull/25390) (sync: introduce a thread-safe generic container and use it to remove a bunch of \"GlobalMutex\"es by vasild)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-07-14T17:27:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#issuecomment-1636164999",
      "id" : 1636164999,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28078",
      "node_id" : "IC_kwDOABII585hheWH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1636164999/reactions"
      },
      "updated_at" : "2023-09-21T15:26:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1636164999",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1265725273"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265725273"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: not sure this is an improvement? I find the existing format easier to read, with less LoC change.",
      "commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "created_at" : "2023-07-17T18:01:59Z",
      "diff_hunk" : "@@ -2915,10 +2911,8 @@ uint64_t CConnman::CalculateKeyedNetGroup(const CAddress& address) const\n     return GetDeterministicRandomizer(RANDOMIZER_ID_NETGROUP).Write(vchNetGroup.data(), vchNetGroup.size()).Finalize();\n }\n \n-void CaptureMessageToFile(const CAddress& addr,\n-                          const std::string& msg_type,\n-                          Span<const unsigned char> data,\n-                          bool is_incoming)\n+// Dump binary message to file, with timestamp.\n+static void CaptureMessageToFile(const CAddress& addr, const std::string& msg_type, Span<const unsigned char> data, bool is_incoming)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1265725273",
      "id" : 1265725273,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585LcW9Z",
      "original_commit_id" : "b252918caa4475528225477026ac95c6edf817c2",
      "original_line" : 2915,
      "original_position" : 96,
      "original_start_line" : 2914,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 1533381378,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265725273/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-07-17T18:23:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265725273",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1265733802"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265733802"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think this can be simplified further?\r\n```diff\r\ndiff --git a/src/net.cpp b/src/net.cpp\r\nindex 0d6b4f04a..c6c4c9a3e 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -149,7 +149,7 @@ uint16_t GetListenPort()\r\n [[nodiscard]] static std::optional<CService> GetLocal(const CNode& peer)\r\n {\r\n     if (!fListen) return std::nullopt;\r\n-    CService addr;\r\n+    std::optional<CService> addr;\r\n     int nBestScore = -1;\r\n     int nBestReachability = -1;\r\n     {\r\n@@ -167,13 +167,12 @@ uint16_t GetListenPort()\r\n             int nReachability = entry.first.GetReachabilityFrom(peer.addr);\r\n             if (nReachability > nBestReachability || (nReachability == nBestReachability && nScore > nBestScore))\r\n             {\r\n-                addr = CService(entry.first, entry.second.nPort);\r\n+                addr.emplace(CService(entry.first, entry.second.nPort));\r\n                 nBestReachability = nReachability;\r\n                 nBestScore = nScore;\r\n             }\r\n         }\r\n     }\r\n-    if (nBestScore == -1) return std::nullopt;\r\n     return addr;\r\n }\r\n \r\n```",
      "commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "created_at" : "2023-07-17T18:09:43Z",
      "diff_hunk" : "@@ -177,7 +173,8 @@ bool GetLocal(CService& addr, const CNode& peer)\n             }\n         }\n     }\n-    return nBestScore >= 0;\n+    if (nBestScore == -1) return std::nullopt;\n+    return addr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1265733802",
      "id" : 1265733802,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585LcZCq",
      "original_commit_id" : "b252918caa4475528225477026ac95c6edf817c2",
      "original_line" : 177,
      "original_position" : 35,
      "original_start_line" : 180,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 1533381378,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265733802/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "LEFT",
      "subject_type" : "line",
      "updated_at" : "2023-07-17T18:23:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265733802",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1265737690"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265737690"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Entire function can be simplified to just:\r\n\r\n```cpp\r\n    return GetLocal(peer).value_or(CService{CNetAddr(), GetListenPort()});\r\n```",
      "commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "created_at" : "2023-07-17T18:13:48Z",
      "diff_hunk" : "@@ -208,9 +205,8 @@ static std::vector<CAddress> ConvertSeeds(const std::vector<uint8_t> &vSeedsIn)\n // one by discovery.\n CService GetLocalAddress(const CNode& peer)\n {\n-    CService addr;\n-    if (GetLocal(addr, peer)) {\n-        return addr;\n+    if (std::optional<CService> addr = GetLocal(peer)) {\n+        return addr.value();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1265737690",
      "id" : 1265737690,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585LcZ_a",
      "original_commit_id" : "b252918caa4475528225477026ac95c6edf817c2",
      "original_line" : 209,
      "original_position" : 47,
      "original_start_line" : 208,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 1533381378,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265737690/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-07-17T18:23:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265737690",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1265746027"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265746027"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I don't see the benefit of this helper function. It doesn't really make things more readable imo (the underlying calls are short and clear enough for me). It also feels quite arbitrary: what about `IsTorOrCJDNS()`, `IsI2POrCJDNS()`, ...? ",
      "commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "created_at" : "2023-07-17T18:21:48Z",
      "diff_hunk" : "@@ -161,9 +161,15 @@ class CNetAddr\n      */\n     bool SetSpecial(const std::string& addr);\n \n+    [[nodiscard]] bool IsIPv4() const { return m_net == NET_IPV4; } // IPv4 mapped address (::FFFF:0:0/96, 0.0.0.0/0)\n+    [[nodiscard]] bool IsIPv6() const { return m_net == NET_IPV6; } // IPv6 address (not mapped IPv4, not Tor)\n+    [[nodiscard]] bool IsTor() const { return m_net == NET_ONION; }\n+    [[nodiscard]] bool IsI2P() const { return m_net == NET_I2P; }\n+    [[nodiscard]] bool IsCJDNS() const { return m_net == NET_CJDNS; }\n+    [[nodiscard]] bool IsTorOrI2P() const { return IsTor() || IsI2P(); }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1265746027",
      "id" : 1265746027,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585LccBr",
      "original_commit_id" : "b252918caa4475528225477026ac95c6edf817c2",
      "original_line" : 169,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : null,
      "pull_request_review_id" : 1533381378,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265746027/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-17T18:23:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265746027",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1265859575"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265859575"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Very nice, done.",
      "commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "created_at" : "2023-07-17T20:22:36Z",
      "diff_hunk" : "@@ -177,7 +173,8 @@ bool GetLocal(CService& addr, const CNode& peer)\n             }\n         }\n     }\n-    return nBestScore >= 0;\n+    if (nBestScore == -1) return std::nullopt;\n+    return addr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1265859575",
      "id" : 1265859575,
      "in_reply_to_id" : 1265733802,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Lc3v3",
      "original_commit_id" : "b252918caa4475528225477026ac95c6edf817c2",
      "original_line" : 177,
      "original_position" : 35,
      "original_start_line" : 180,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 1533614518,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265859575/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "LEFT",
      "subject_type" : "line",
      "updated_at" : "2023-07-17T20:22:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265859575",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1265859783"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265859783"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Much better, thank you!",
      "commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "created_at" : "2023-07-17T20:22:50Z",
      "diff_hunk" : "@@ -208,9 +205,8 @@ static std::vector<CAddress> ConvertSeeds(const std::vector<uint8_t> &vSeedsIn)\n // one by discovery.\n CService GetLocalAddress(const CNode& peer)\n {\n-    CService addr;\n-    if (GetLocal(addr, peer)) {\n-        return addr;\n+    if (std::optional<CService> addr = GetLocal(peer)) {\n+        return addr.value();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1265859783",
      "id" : 1265859783,
      "in_reply_to_id" : 1265737690,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Lc3zH",
      "original_commit_id" : "b252918caa4475528225477026ac95c6edf817c2",
      "original_line" : 209,
      "original_position" : 47,
      "original_start_line" : 208,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 1533615028,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265859783/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-07-17T20:22:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265859783",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1265860411"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265860411"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I made the declaration on one line for the smaller diff, and I don't mind reading the parameter list left-to-right. But sure, kept it multi-line.",
      "commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "created_at" : "2023-07-17T20:23:38Z",
      "diff_hunk" : "@@ -2915,10 +2911,8 @@ uint64_t CConnman::CalculateKeyedNetGroup(const CAddress& address) const\n     return GetDeterministicRandomizer(RANDOMIZER_ID_NETGROUP).Write(vchNetGroup.data(), vchNetGroup.size()).Finalize();\n }\n \n-void CaptureMessageToFile(const CAddress& addr,\n-                          const std::string& msg_type,\n-                          Span<const unsigned char> data,\n-                          bool is_incoming)\n+// Dump binary message to file, with timestamp.\n+static void CaptureMessageToFile(const CAddress& addr, const std::string& msg_type, Span<const unsigned char> data, bool is_incoming)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1265860411",
      "id" : 1265860411,
      "in_reply_to_id" : 1265725273,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Lc387",
      "original_commit_id" : "b252918caa4475528225477026ac95c6edf817c2",
      "original_line" : 2915,
      "original_position" : 96,
      "original_start_line" : 2914,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 1533616698,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265860411/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-07-17T20:23:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265860411",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1265869787"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265869787"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Dropped the commit and instead added an `IsPrivacyNet()` helper for `GetLocal()` only, where it cleans things up. When we'll likely need to add `IsCJDNS()` to it later on (when there are more nodes running it), it will be simple to do and will keep `GetLocal()` easy to read.",
      "commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "created_at" : "2023-07-17T20:31:56Z",
      "diff_hunk" : "@@ -161,9 +161,15 @@ class CNetAddr\n      */\n     bool SetSpecial(const std::string& addr);\n \n+    [[nodiscard]] bool IsIPv4() const { return m_net == NET_IPV4; } // IPv4 mapped address (::FFFF:0:0/96, 0.0.0.0/0)\n+    [[nodiscard]] bool IsIPv6() const { return m_net == NET_IPV6; } // IPv6 address (not mapped IPv4, not Tor)\n+    [[nodiscard]] bool IsTor() const { return m_net == NET_ONION; }\n+    [[nodiscard]] bool IsI2P() const { return m_net == NET_I2P; }\n+    [[nodiscard]] bool IsCJDNS() const { return m_net == NET_CJDNS; }\n+    [[nodiscard]] bool IsTorOrI2P() const { return IsTor() || IsI2P(); }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1265869787",
      "id" : 1265869787,
      "in_reply_to_id" : 1265746027,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Lc6Pb",
      "original_commit_id" : "b252918caa4475528225477026ac95c6edf817c2",
      "original_line" : 169,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : null,
      "pull_request_review_id" : 1533640753,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265869787/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-17T20:32:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265869787",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thank you for the excellent review @stickies-v -- updated to take your feedback.",
      "created_at" : "2023-07-17T22:37:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#issuecomment-1638982355",
      "id" : 1638982355,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28078",
      "node_id" : "IC_kwDOABII585hsOLT",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1638982355/reactions"
      },
      "updated_at" : "2023-07-17T22:37:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1638982355",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1266580999"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266580999"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: would not include the ~classname in method name\r\n\r\n```suggestion\r\n    [[nodiscard]] bool HasCJDNSPrefix() const { return m_addr[0] == 0xfc; }\r\n```",
      "commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "created_at" : "2023-07-18T10:32:44Z",
      "diff_hunk" : "@@ -161,9 +161,15 @@ class CNetAddr\n      */\n     bool SetSpecial(const std::string& addr);\n \n+    [[nodiscard]] bool IsIPv4() const { return m_net == NET_IPV4; } // IPv4 mapped address (::FFFF:0:0/96, 0.0.0.0/0)\n+    [[nodiscard]] bool IsIPv6() const { return m_net == NET_IPV6; } // IPv6 address (not mapped IPv4, not Tor)\n+    [[nodiscard]] bool IsTor() const { return m_net == NET_ONION; }\n+    [[nodiscard]] bool IsI2P() const { return m_net == NET_I2P; }\n+    [[nodiscard]] bool IsCJDNS() const { return m_net == NET_CJDNS; }\n+    [[nodiscard]] bool IsPrivacyNet() const { return IsTor() || IsI2P(); }\n+    [[nodiscard]] bool AddrHasCJDNSPrefix() const { return m_addr[0] == 0xfc; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1266580999",
      "id" : 1266580999,
      "line" : 170,
      "node_id" : "PRRC_kwDOABII585Lfn4H",
      "original_commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "original_line" : 170,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 10,
      "pull_request_review_id" : 1534736352,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266580999/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-18T11:05:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266580999",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1266584113"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266584113"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: is \"TODO\" easier (i.e. more likely someone does it) to grep than \"Note:\"? Also, I think these last 2 lines are better placed near the definition of `IsPrivacyNet()`.",
      "commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "created_at" : "2023-07-18T10:35:47Z",
      "diff_hunk" : "@@ -146,38 +146,35 @@ uint16_t GetListenPort()\n }\n \n // find 'best' local address for a particular peer\n-bool GetLocal(CService& addr, const CNode& peer)\n+[[nodiscard]] static std::optional<CService> GetLocal(const CNode& peer)\n {\n-    if (!fListen)\n-        return false;\n-\n+    if (!fListen) return std::nullopt;\n+    std::optional<CService> addr;\n     int nBestScore = -1;\n     int nBestReachability = -1;\n     {\n         LOCK(g_maplocalhost_mutex);\n         for (const auto& entry : mapLocalHost)\n         {\n-            // For privacy reasons, don't advertise our privacy-network address\n-            // to other networks and don't advertise our other-network address\n-            // to privacy networks.\n-            const Network our_net{entry.first.GetNetwork()};\n-            const Network peers_net{peer.ConnectedThroughNetwork()};\n-            if (our_net != peers_net &&\n-                (our_net == NET_ONION || our_net == NET_I2P ||\n-                 peers_net == NET_ONION || peers_net == NET_I2P)) {\n+            // For privacy reasons, don't advertise our privacy-network address to other\n+            // networks, and don't advertise our other-network address to privacy networks.\n+            // Note: consider adding IsCJDNS() to IsPrivacyNet() when there are more CJDNS peers;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1266584113",
      "id" : 1266584113,
      "line" : 161,
      "node_id" : "PRRC_kwDOABII585Lfoox",
      "original_commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "original_line" : 161,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 28,
      "pull_request_review_id" : 1534736352,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266584113/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-18T11:05:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266584113",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1266591147"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266591147"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "As we're now touching all these LoC, would suggest to clean up even further. Slightly increases the diff but worth it for readability imo.\r\n\r\n<details>\r\n<summary>git diff on 5d7188ed92908237ce51bbe6ed0a97472825c6b8</summary>\r\n\r\n```diff\r\ndiff --git a/src/net.cpp b/src/net.cpp\r\nindex eee179c8a..b35725ea2 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -154,21 +154,21 @@ uint16_t GetListenPort()\r\n     int nBestReachability = -1;\r\n     {\r\n         LOCK(g_maplocalhost_mutex);\r\n-        for (const auto& entry : mapLocalHost)\r\n+        for (const auto& [local_addr, service_info] : mapLocalHost)\r\n         {\r\n             // For privacy reasons, don't advertise our privacy-network address to other\r\n             // networks, and don't advertise our other-network address to privacy networks.\r\n             // Note: consider adding IsCJDNS() to IsPrivacyNet() when there are more CJDNS peers;\r\n             // see https://github.com/bitcoin/bitcoin/pull/27411#issuecomment-1497176155\r\n-            if (entry.first.GetNetwork() != peer.ConnectedThroughNetwork()\r\n-                && (entry.first.IsPrivacyNet() || peer.addr.IsPrivacyNet() || peer.m_inbound_onion)) {\r\n+            if (local_addr.GetNetwork() != peer.ConnectedThroughNetwork()\r\n+                && (local_addr.IsPrivacyNet() || peer.addr.IsPrivacyNet() || peer.m_inbound_onion)) {\r\n                 continue;\r\n             }\r\n-            int nScore = entry.second.nScore;\r\n-            int nReachability = entry.first.GetReachabilityFrom(peer.addr);\r\n+            int nScore{service_info.nScore};\r\n+            int nReachability{local_addr.GetReachabilityFrom(peer.addr)};\r\n             if (nReachability > nBestReachability || (nReachability == nBestReachability && nScore > nBestScore))\r\n             {\r\n-                addr.emplace(CService{entry.first, entry.second.nPort});\r\n+                addr.emplace(CService{local_addr, service_info.nPort});\r\n                 nBestReachability = nReachability;\r\n                 nBestScore = nScore;\r\n             }\r\n\r\n```\r\n</details>\r\n\r\n",
      "commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "created_at" : "2023-07-18T10:42:56Z",
      "diff_hunk" : "@@ -146,38 +146,35 @@ uint16_t GetListenPort()\n }\n \n // find 'best' local address for a particular peer\n-bool GetLocal(CService& addr, const CNode& peer)\n+[[nodiscard]] static std::optional<CService> GetLocal(const CNode& peer)\n {\n-    if (!fListen)\n-        return false;\n-\n+    if (!fListen) return std::nullopt;\n+    std::optional<CService> addr;\n     int nBestScore = -1;\n     int nBestReachability = -1;\n     {\n         LOCK(g_maplocalhost_mutex);\n         for (const auto& entry : mapLocalHost)\n         {\n-            // For privacy reasons, don't advertise our privacy-network address\n-            // to other networks and don't advertise our other-network address\n-            // to privacy networks.\n-            const Network our_net{entry.first.GetNetwork()};\n-            const Network peers_net{peer.ConnectedThroughNetwork()};\n-            if (our_net != peers_net &&\n-                (our_net == NET_ONION || our_net == NET_I2P ||\n-                 peers_net == NET_ONION || peers_net == NET_I2P)) {\n+            // For privacy reasons, don't advertise our privacy-network address to other\n+            // networks, and don't advertise our other-network address to privacy networks.\n+            // Note: consider adding IsCJDNS() to IsPrivacyNet() when there are more CJDNS peers;\n+            // see https://github.com/bitcoin/bitcoin/pull/27411#issuecomment-1497176155\n+            if (entry.first.GetNetwork() != peer.ConnectedThroughNetwork()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1266591147",
      "id" : 1266591147,
      "line" : 163,
      "node_id" : "PRRC_kwDOABII585LfqWr",
      "original_commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "original_line" : 163,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 30,
      "pull_request_review_id" : 1534736352,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266591147/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-18T11:05:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266591147",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1266596572"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266596572"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah I think that's a good approach.",
      "commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "created_at" : "2023-07-18T10:48:44Z",
      "diff_hunk" : "@@ -161,9 +161,15 @@ class CNetAddr\n      */\n     bool SetSpecial(const std::string& addr);\n \n+    [[nodiscard]] bool IsIPv4() const { return m_net == NET_IPV4; } // IPv4 mapped address (::FFFF:0:0/96, 0.0.0.0/0)\n+    [[nodiscard]] bool IsIPv6() const { return m_net == NET_IPV6; } // IPv6 address (not mapped IPv4, not Tor)\n+    [[nodiscard]] bool IsTor() const { return m_net == NET_ONION; }\n+    [[nodiscard]] bool IsI2P() const { return m_net == NET_I2P; }\n+    [[nodiscard]] bool IsCJDNS() const { return m_net == NET_CJDNS; }\n+    [[nodiscard]] bool IsTorOrI2P() const { return IsTor() || IsI2P(); }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1266596572",
      "id" : 1266596572,
      "in_reply_to_id" : 1265746027,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Lfrrc",
      "original_commit_id" : "b252918caa4475528225477026ac95c6edf817c2",
      "original_line" : 169,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : null,
      "pull_request_review_id" : 1534736352,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266596572/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-18T11:05:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266596572",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1266621620"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266621620"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Maybe let's not move all these lines? A bit unnecessary churn, is fine as is imo.",
      "commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "created_at" : "2023-07-18T11:14:06Z",
      "diff_hunk" : "@@ -161,9 +161,15 @@ class CNetAddr\n      */\n     bool SetSpecial(const std::string& addr);\n \n+    [[nodiscard]] bool IsIPv4() const { return m_net == NET_IPV4; } // IPv4 mapped address (::FFFF:0:0/96, 0.0.0.0/0)\n+    [[nodiscard]] bool IsIPv6() const { return m_net == NET_IPV6; } // IPv6 address (not mapped IPv4, not Tor)\n+    [[nodiscard]] bool IsTor() const { return m_net == NET_ONION; }\n+    [[nodiscard]] bool IsI2P() const { return m_net == NET_I2P; }\n+    [[nodiscard]] bool IsCJDNS() const { return m_net == NET_CJDNS; }\n+    [[nodiscard]] bool IsPrivacyNet() const { return IsTor() || IsI2P(); }\n+    [[nodiscard]] bool AddrHasCJDNSPrefix() const { return m_addr[0] == 0xfc; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1266621620",
      "id" : 1266621620,
      "line" : 170,
      "node_id" : "PRRC_kwDOABII585Lfxy0",
      "original_commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "original_line" : 170,
      "original_position" : 10,
      "original_start_line" : 164,
      "path" : "src/netaddress.h",
      "position" : 10,
      "pull_request_review_id" : 1534800401,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266621620/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 164,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-07-18T11:14:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266621620",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267078962"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267078962"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "c69a74229da514228d3388e9652d2ea2e89224d7",
      "created_at" : "2023-07-18T17:07:04Z",
      "diff_hunk" : "@@ -146,38 +146,35 @@ uint16_t GetListenPort()\n }\n \n // find 'best' local address for a particular peer\n-bool GetLocal(CService& addr, const CNode& peer)\n+[[nodiscard]] static std::optional<CService> GetLocal(const CNode& peer)\n {\n-    if (!fListen)\n-        return false;\n-\n+    if (!fListen) return std::nullopt;\n+    std::optional<CService> addr;\n     int nBestScore = -1;\n     int nBestReachability = -1;\n     {\n         LOCK(g_maplocalhost_mutex);\n         for (const auto& entry : mapLocalHost)\n         {\n-            // For privacy reasons, don't advertise our privacy-network address\n-            // to other networks and don't advertise our other-network address\n-            // to privacy networks.\n-            const Network our_net{entry.first.GetNetwork()};\n-            const Network peers_net{peer.ConnectedThroughNetwork()};\n-            if (our_net != peers_net &&\n-                (our_net == NET_ONION || our_net == NET_I2P ||\n-                 peers_net == NET_ONION || peers_net == NET_I2P)) {\n+            // For privacy reasons, don't advertise our privacy-network address to other\n+            // networks, and don't advertise our other-network address to privacy networks.\n+            // Note: consider adding IsCJDNS() to IsPrivacyNet() when there are more CJDNS peers;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267078962",
      "id" : 1267078962,
      "in_reply_to_id" : 1266584113,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Lhhcy",
      "original_commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "original_line" : 161,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 1535544825,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267078962/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-18T17:07:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267078962",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267079059"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267079059"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "c69a74229da514228d3388e9652d2ea2e89224d7",
      "created_at" : "2023-07-18T17:07:10Z",
      "diff_hunk" : "@@ -161,9 +161,15 @@ class CNetAddr\n      */\n     bool SetSpecial(const std::string& addr);\n \n+    [[nodiscard]] bool IsIPv4() const { return m_net == NET_IPV4; } // IPv4 mapped address (::FFFF:0:0/96, 0.0.0.0/0)\n+    [[nodiscard]] bool IsIPv6() const { return m_net == NET_IPV6; } // IPv6 address (not mapped IPv4, not Tor)\n+    [[nodiscard]] bool IsTor() const { return m_net == NET_ONION; }\n+    [[nodiscard]] bool IsI2P() const { return m_net == NET_I2P; }\n+    [[nodiscard]] bool IsCJDNS() const { return m_net == NET_CJDNS; }\n+    [[nodiscard]] bool IsPrivacyNet() const { return IsTor() || IsI2P(); }\n+    [[nodiscard]] bool AddrHasCJDNSPrefix() const { return m_addr[0] == 0xfc; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267079059",
      "id" : 1267079059,
      "in_reply_to_id" : 1266580999,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585LhheT",
      "original_commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "original_line" : 170,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : null,
      "pull_request_review_id" : 1535545030,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267079059/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-18T17:07:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267079059",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267080536"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267080536"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nice! Took the liberty of adding a commit credited to you. LMK if that's ok and if you'd like any changes.",
      "commit_id" : "c69a74229da514228d3388e9652d2ea2e89224d7",
      "created_at" : "2023-07-18T17:08:39Z",
      "diff_hunk" : "@@ -146,38 +146,35 @@ uint16_t GetListenPort()\n }\n \n // find 'best' local address for a particular peer\n-bool GetLocal(CService& addr, const CNode& peer)\n+[[nodiscard]] static std::optional<CService> GetLocal(const CNode& peer)\n {\n-    if (!fListen)\n-        return false;\n-\n+    if (!fListen) return std::nullopt;\n+    std::optional<CService> addr;\n     int nBestScore = -1;\n     int nBestReachability = -1;\n     {\n         LOCK(g_maplocalhost_mutex);\n         for (const auto& entry : mapLocalHost)\n         {\n-            // For privacy reasons, don't advertise our privacy-network address\n-            // to other networks and don't advertise our other-network address\n-            // to privacy networks.\n-            const Network our_net{entry.first.GetNetwork()};\n-            const Network peers_net{peer.ConnectedThroughNetwork()};\n-            if (our_net != peers_net &&\n-                (our_net == NET_ONION || our_net == NET_I2P ||\n-                 peers_net == NET_ONION || peers_net == NET_I2P)) {\n+            // For privacy reasons, don't advertise our privacy-network address to other\n+            // networks, and don't advertise our other-network address to privacy networks.\n+            // Note: consider adding IsCJDNS() to IsPrivacyNet() when there are more CJDNS peers;\n+            // see https://github.com/bitcoin/bitcoin/pull/27411#issuecomment-1497176155\n+            if (entry.first.GetNetwork() != peer.ConnectedThroughNetwork()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267080536",
      "id" : 1267080536,
      "in_reply_to_id" : 1266591147,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Lhh1Y",
      "original_commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "original_line" : 163,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 1535548214,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267080536/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-18T17:08:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267080536",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267080665"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267080665"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "c69a74229da514228d3388e9652d2ea2e89224d7",
      "created_at" : "2023-07-18T17:08:48Z",
      "diff_hunk" : "@@ -161,9 +161,15 @@ class CNetAddr\n      */\n     bool SetSpecial(const std::string& addr);\n \n+    [[nodiscard]] bool IsIPv4() const { return m_net == NET_IPV4; } // IPv4 mapped address (::FFFF:0:0/96, 0.0.0.0/0)\n+    [[nodiscard]] bool IsIPv6() const { return m_net == NET_IPV6; } // IPv6 address (not mapped IPv4, not Tor)\n+    [[nodiscard]] bool IsTor() const { return m_net == NET_ONION; }\n+    [[nodiscard]] bool IsI2P() const { return m_net == NET_I2P; }\n+    [[nodiscard]] bool IsCJDNS() const { return m_net == NET_CJDNS; }\n+    [[nodiscard]] bool IsPrivacyNet() const { return IsTor() || IsI2P(); }\n+    [[nodiscard]] bool AddrHasCJDNSPrefix() const { return m_addr[0] == 0xfc; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267080665",
      "id" : 1267080665,
      "in_reply_to_id" : 1266621620,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Lhh3Z",
      "original_commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "original_line" : 170,
      "original_position" : 10,
      "original_start_line" : 164,
      "path" : "src/netaddress.h",
      "position" : null,
      "pull_request_review_id" : 1535548521,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267080665/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-07-18T17:08:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267080665",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267277566"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267277566"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: no need to specify where it's used for a public method imo\r\n```suggestion\r\n     * Whether this object is a privacy network.\r\n```",
      "commit_id" : "c69a74229da514228d3388e9652d2ea2e89224d7",
      "created_at" : "2023-07-18T20:31:00Z",
      "diff_hunk" : "@@ -179,14 +179,22 @@ class CNetAddr\n     bool IsRFC6052() const; // IPv6 well-known prefix for IPv4-embedded address (64:FF9B::/96)\n     bool IsRFC6145() const; // IPv6 IPv4-translated address (::FFFF:0:0:0/96) (actually defined in RFC2765)\n     bool IsHeNet() const;   // IPv6 Hurricane Electric - https://he.net (2001:0470::/36)\n-    bool IsTor() const;\n-    bool IsI2P() const;\n-    bool IsCJDNS() const;\n+    [[nodiscard]] bool IsTor() const { return m_net == NET_ONION; }\n+    [[nodiscard]] bool IsI2P() const { return m_net == NET_I2P; }\n+    [[nodiscard]] bool IsCJDNS() const { return m_net == NET_CJDNS; }\n+    [[nodiscard]] bool HasCJDNSPrefix() const { return m_addr[0] == 0xfc; }\n     bool IsLocal() const;\n     bool IsRoutable() const;\n     bool IsInternal() const;\n     bool IsValid() const;\n \n+    /**\n+     * Whether this object is a privacy network for self-advertisement purposes in `GetLocal()`.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267277566",
      "id" : 1267277566,
      "line" : 192,
      "node_id" : "PRRC_kwDOABII585LiR7-",
      "original_commit_id" : "c69a74229da514228d3388e9652d2ea2e89224d7",
      "original_line" : 192,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 28,
      "pull_request_review_id" : 1535860538,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267277566/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-18T20:37:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267277566",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267279181"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267279181"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Absolutely, thanks. Just left some small comments.",
      "commit_id" : "c69a74229da514228d3388e9652d2ea2e89224d7",
      "created_at" : "2023-07-18T20:32:54Z",
      "diff_hunk" : "@@ -146,38 +146,35 @@ uint16_t GetListenPort()\n }\n \n // find 'best' local address for a particular peer\n-bool GetLocal(CService& addr, const CNode& peer)\n+[[nodiscard]] static std::optional<CService> GetLocal(const CNode& peer)\n {\n-    if (!fListen)\n-        return false;\n-\n+    if (!fListen) return std::nullopt;\n+    std::optional<CService> addr;\n     int nBestScore = -1;\n     int nBestReachability = -1;\n     {\n         LOCK(g_maplocalhost_mutex);\n         for (const auto& entry : mapLocalHost)\n         {\n-            // For privacy reasons, don't advertise our privacy-network address\n-            // to other networks and don't advertise our other-network address\n-            // to privacy networks.\n-            const Network our_net{entry.first.GetNetwork()};\n-            const Network peers_net{peer.ConnectedThroughNetwork()};\n-            if (our_net != peers_net &&\n-                (our_net == NET_ONION || our_net == NET_I2P ||\n-                 peers_net == NET_ONION || peers_net == NET_I2P)) {\n+            // For privacy reasons, don't advertise our privacy-network address to other\n+            // networks, and don't advertise our other-network address to privacy networks.\n+            // Note: consider adding IsCJDNS() to IsPrivacyNet() when there are more CJDNS peers;\n+            // see https://github.com/bitcoin/bitcoin/pull/27411#issuecomment-1497176155\n+            if (entry.first.GetNetwork() != peer.ConnectedThroughNetwork()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267279181",
      "id" : 1267279181,
      "in_reply_to_id" : 1266591147,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585LiSVN",
      "original_commit_id" : "5d7188ed92908237ce51bbe6ed0a97472825c6b8",
      "original_line" : 163,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 1535860538,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267279181/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-18T20:37:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267279181",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267281474"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267281474"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: any reason the order of these lines got switched? if not necessary, wouldn't do that",
      "commit_id" : "c69a74229da514228d3388e9652d2ea2e89224d7",
      "created_at" : "2023-07-18T20:35:26Z",
      "diff_hunk" : "@@ -148,36 +148,33 @@ uint16_t GetListenPort()\n // find 'best' local address for a particular peer\n [[nodiscard]] static bool GetLocal(CService& addr, const CNode& peer)\n {\n-    if (!fListen)\n-        return false;\n+    if (!fListen) return false;\n \n-    int nBestScore = -1;\n-    int nBestReachability = -1;\n+    int best_reachability = -1;\n+    int best_score = -1;\n     {\n         LOCK(g_maplocalhost_mutex);\n-        for (const auto& entry : mapLocalHost)\n-        {\n+        for (const auto& [local_addr, local_service_info] : mapLocalHost) {\n             // For privacy reasons, don't advertise our privacy-network address\n             // to other networks and don't advertise our other-network address\n             // to privacy networks.\n-            const Network our_net{entry.first.GetNetwork()};\n+            const Network our_net{local_addr.GetNetwork()};\n             const Network peers_net{peer.ConnectedThroughNetwork()};\n             if (our_net != peers_net &&\n                 (our_net == NET_ONION || our_net == NET_I2P ||\n                  peers_net == NET_ONION || peers_net == NET_I2P)) {\n                 continue;\n             }\n-            int nScore = entry.second.nScore;\n-            int nReachability = entry.first.GetReachabilityFrom(peer.addr);\n-            if (nReachability > nBestReachability || (nReachability == nBestReachability && nScore > nBestScore))\n-            {\n-                addr = CService(entry.first, entry.second.nPort);\n-                nBestReachability = nReachability;\n-                nBestScore = nScore;\n+            const int reachability{local_addr.GetReachabilityFrom(peer.addr)};\n+            const int score{local_service_info.nScore};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267281474",
      "id" : 1267281474,
      "line" : 167,
      "node_id" : "PRRC_kwDOABII585LiS5C",
      "original_commit_id" : "2d2575b92da65c8f852a538ec74717effcd3d603",
      "original_line" : 169,
      "original_position" : 36,
      "original_start_line" : 168,
      "path" : "src/net.cpp",
      "position" : 43,
      "pull_request_review_id" : 1535860538,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267281474/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 166,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-07-18T20:37:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267281474",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267282655"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267282655"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: not sure the snake case is worth the added LoC (+further down). Would prefer to keep as is.",
      "commit_id" : "c69a74229da514228d3388e9652d2ea2e89224d7",
      "created_at" : "2023-07-18T20:36:53Z",
      "diff_hunk" : "@@ -148,36 +148,33 @@ uint16_t GetListenPort()\n // find 'best' local address for a particular peer\n [[nodiscard]] static bool GetLocal(CService& addr, const CNode& peer)\n {\n-    if (!fListen)\n-        return false;\n+    if (!fListen) return false;\n \n-    int nBestScore = -1;\n-    int nBestReachability = -1;\n+    int best_reachability = -1;\n+    int best_score = -1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267282655",
      "id" : 1267282655,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585LiTLf",
      "original_commit_id" : "2d2575b92da65c8f852a538ec74717effcd3d603",
      "original_line" : 154,
      "original_position" : 11,
      "original_start_line" : 154,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 1535860538,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267282655/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "LEFT",
      "subject_type" : "line",
      "updated_at" : "2023-07-18T20:37:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267282655",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267286727"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267286727"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think it's important to provide the context here. (Otherwise, people could wonder why the helper is not called elsewhere, or debate for example whether CJDNS is a privacy network in general, etc.)",
      "commit_id" : "c69a74229da514228d3388e9652d2ea2e89224d7",
      "created_at" : "2023-07-18T20:41:50Z",
      "diff_hunk" : "@@ -179,14 +179,22 @@ class CNetAddr\n     bool IsRFC6052() const; // IPv6 well-known prefix for IPv4-embedded address (64:FF9B::/96)\n     bool IsRFC6145() const; // IPv6 IPv4-translated address (::FFFF:0:0:0/96) (actually defined in RFC2765)\n     bool IsHeNet() const;   // IPv6 Hurricane Electric - https://he.net (2001:0470::/36)\n-    bool IsTor() const;\n-    bool IsI2P() const;\n-    bool IsCJDNS() const;\n+    [[nodiscard]] bool IsTor() const { return m_net == NET_ONION; }\n+    [[nodiscard]] bool IsI2P() const { return m_net == NET_I2P; }\n+    [[nodiscard]] bool IsCJDNS() const { return m_net == NET_CJDNS; }\n+    [[nodiscard]] bool HasCJDNSPrefix() const { return m_addr[0] == 0xfc; }\n     bool IsLocal() const;\n     bool IsRoutable() const;\n     bool IsInternal() const;\n     bool IsValid() const;\n \n+    /**\n+     * Whether this object is a privacy network for self-advertisement purposes in `GetLocal()`.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267286727",
      "id" : 1267286727,
      "in_reply_to_id" : 1267277566,
      "line" : 192,
      "node_id" : "PRRC_kwDOABII585LiULH",
      "original_commit_id" : "c69a74229da514228d3388e9652d2ea2e89224d7",
      "original_line" : 192,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 28,
      "pull_request_review_id" : 1535875182,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267286727/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-18T20:51:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267286727",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267289243"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267289243"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Alphabetical order, first use order, and consistency (see the last use).",
      "commit_id" : "c69a74229da514228d3388e9652d2ea2e89224d7",
      "created_at" : "2023-07-18T20:44:59Z",
      "diff_hunk" : "@@ -148,36 +148,33 @@ uint16_t GetListenPort()\n // find 'best' local address for a particular peer\n [[nodiscard]] static bool GetLocal(CService& addr, const CNode& peer)\n {\n-    if (!fListen)\n-        return false;\n+    if (!fListen) return false;\n \n-    int nBestScore = -1;\n-    int nBestReachability = -1;\n+    int best_reachability = -1;\n+    int best_score = -1;\n     {\n         LOCK(g_maplocalhost_mutex);\n-        for (const auto& entry : mapLocalHost)\n-        {\n+        for (const auto& [local_addr, local_service_info] : mapLocalHost) {\n             // For privacy reasons, don't advertise our privacy-network address\n             // to other networks and don't advertise our other-network address\n             // to privacy networks.\n-            const Network our_net{entry.first.GetNetwork()};\n+            const Network our_net{local_addr.GetNetwork()};\n             const Network peers_net{peer.ConnectedThroughNetwork()};\n             if (our_net != peers_net &&\n                 (our_net == NET_ONION || our_net == NET_I2P ||\n                  peers_net == NET_ONION || peers_net == NET_I2P)) {\n                 continue;\n             }\n-            int nScore = entry.second.nScore;\n-            int nReachability = entry.first.GetReachabilityFrom(peer.addr);\n-            if (nReachability > nBestReachability || (nReachability == nBestReachability && nScore > nBestScore))\n-            {\n-                addr = CService(entry.first, entry.second.nPort);\n-                nBestReachability = nReachability;\n-                nBestScore = nScore;\n+            const int reachability{local_addr.GetReachabilityFrom(peer.addr)};\n+            const int score{local_service_info.nScore};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267289243",
      "id" : 1267289243,
      "in_reply_to_id" : 1267281474,
      "line" : 167,
      "node_id" : "PRRC_kwDOABII585LiUyb",
      "original_commit_id" : "2d2575b92da65c8f852a538ec74717effcd3d603",
      "original_line" : 169,
      "original_position" : 36,
      "original_start_line" : 168,
      "path" : "src/net.cpp",
      "position" : 43,
      "pull_request_review_id" : 1535879214,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267289243/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 166,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-07-18T20:44:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267289243",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267291414"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267291414"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> As we're now touching all these LoC, would suggest to clean up even further. Slightly increases the diff but worth it for readability imo.\r\n\r\nUpdating the naming seems consistent with this and the improved naming in that change.",
      "commit_id" : "c69a74229da514228d3388e9652d2ea2e89224d7",
      "created_at" : "2023-07-18T20:47:43Z",
      "diff_hunk" : "@@ -148,36 +148,33 @@ uint16_t GetListenPort()\n // find 'best' local address for a particular peer\n [[nodiscard]] static bool GetLocal(CService& addr, const CNode& peer)\n {\n-    if (!fListen)\n-        return false;\n+    if (!fListen) return false;\n \n-    int nBestScore = -1;\n-    int nBestReachability = -1;\n+    int best_reachability = -1;\n+    int best_score = -1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#discussion_r1267291414",
      "id" : 1267291414,
      "in_reply_to_id" : 1267282655,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585LiVUW",
      "original_commit_id" : "2d2575b92da65c8f852a538ec74717effcd3d603",
      "original_line" : 154,
      "original_position" : 11,
      "original_start_line" : 154,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 1535882628,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28078",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267291414/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "LEFT",
      "subject_type" : "line",
      "updated_at" : "2023-07-18T20:48:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267291414",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I thought we were going to avoid unproductive refactors?",
      "created_at" : "2023-07-18T21:11:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#issuecomment-1640997776",
      "id" : 1640997776,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28078",
      "node_id" : "IC_kwDOABII585hz6OQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1640997776/reactions"
      },
      "updated_at" : "2023-07-18T21:11:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1640997776",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I thought we were going to avoid unproductive refactors?\r\n\r\nI'm unaware of the context behind that comment but see similar refactoring in many pull requests and, in general, there are good reasons for them; in this case, removing unneeded exports and simplifying and removing code.  (If you'd like to review a pull that fixes something, may I re-review beg for https://github.com/bitcoin/bitcoin/pull/27231 that was updated to take your feedback? Thanks!)",
      "created_at" : "2023-07-18T22:36:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#issuecomment-1641078447",
      "id" : 1641078447,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28078",
      "node_id" : "IC_kwDOABII585h0N6v",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1641078447/reactions"
      },
      "updated_at" : "2023-07-18T22:36:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1641078447",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated to take all feedback by @stickies-v and @vasild -- thank you!",
      "created_at" : "2023-07-19T18:00:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#issuecomment-1642518571",
      "id" : 1642518571,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28078",
      "node_id" : "IC_kwDOABII585h5tgr",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1642518571/reactions"
      },
      "updated_at" : "2023-07-21T13:10:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1642518571",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think some of the changes here are fine, but seem to be done somewhat verbosely.\r\n\r\nThere are 3 commits (5ba73cd0ee1e661ec4d041ac8ae7a60cfd31f0c0, df488563b280c63f5d74d5ac0fcb1a2cad489d55, 5316ae5dd8d90623f9bb883bb253fa6463ee4d34) that independently change/refactor `GetLocal()`. Any reason they can't be combined, and avoid touching the same line of code 3 times?\r\n\r\nSpeaking generally, not sure about the addition of `[nodiscard]`. It's not clear that is something that other project contributors agree with, i.e: discussion in this thread: https://github.com/bitcoin/bitcoin/pull/27675#discussion_r1254980474.",
      "created_at" : "2023-08-01T09:09:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#issuecomment-1659899169",
      "id" : 1659899169,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28078",
      "node_id" : "IC_kwDOABII585i8A0h",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1659899169/reactions"
      },
      "updated_at" : "2023-08-01T09:09:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1659899169",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> It's not clear that is something that other project contributors agree with, i.e: discussion in this thread: https://github.com/bitcoin/bitcoin/pull/27675#discussion_r1254980474.\r\n\r\nI can see the desire to enforce it everywhere, but then it should be done via clang-tidy or a clang-tidy plugin. Ideally without modifying the source code at all.",
      "created_at" : "2023-08-01T09:34:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#issuecomment-1659940762",
      "id" : 1659940762,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28078",
      "node_id" : "IC_kwDOABII585i8K-a",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1659940762/reactions"
      },
      "updated_at" : "2023-08-01T09:34:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1659940762",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "_offtopic `[[nodiscard]]`_\r\n\r\nThere are 3 classes of functions wrt `[[nodiscard]]`:\r\n\r\n1. where ignoring the result is harmful, it probably means a bug in the program, for example [write(2)](https://man7.org/linux/man-pages/man2/write.2.html)\r\n2. where ignoring the result is ok and the code is equivalent without the call, aka it does not make sense to call the function, its call should be removed because it clutters the source code and makes the program slower, for example [strlen(3)](https://man7.org/linux/man-pages/man3/strlen.3.html)\r\n3. where ignoring the result is ok and the function has side effects which are desirable at the call site, for example [snprintf(3)](https://man7.org/linux/man-pages/man3/snprintf.3p.html)\r\n\r\nI guess `[[nodiscard]]` is desirable for 1. and 2. but not for 3.",
      "created_at" : "2023-08-01T10:31:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#issuecomment-1660036151",
      "id" : 1660036151,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28078",
      "node_id" : "IC_kwDOABII585i8iQ3",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1660036151/reactions"
      },
      "updated_at" : "2023-08-01T10:31:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1660036151",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Re `offtopic [[nodiscard]]` yes, and some contributors have been using it consistently in cases 1 and 2. I think it's fine for an author not to take a review suggestion to use it, or for the two cases mentioned, to use it in code they write or touch. A bit like the usage of `const`, perhaps. It's a handy addition to C++. If I have it wrong in a place, happy to update.\r\n\r\n> There are 3 commits ([5ba73cd](https://github.com/bitcoin/bitcoin/commit/5ba73cd0ee1e661ec4d041ac8ae7a60cfd31f0c0), [df48856](https://github.com/bitcoin/bitcoin/commit/df488563b280c63f5d74d5ac0fcb1a2cad489d55), [5316ae5](https://github.com/bitcoin/bitcoin/commit/5316ae5dd8d90623f9bb883bb253fa6463ee4d34)) that independently change/refactor `GetLocal()`.\r\n\r\nIn this case, the changes have only two lines of diff in common out of a few dozen, so there's little redundancy. They are different kinds of changes that make more sense separately and are easier to review that way -- which I strive for, like the comment above: *\"Good changes, easy to review. Thanks!\"* (Thanks!)\r\n",
      "created_at" : "2023-08-02T19:35:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#issuecomment-1662864782",
      "id" : 1662864782,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28078",
      "node_id" : "IC_kwDOABII585jHU2O",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1662864782/reactions"
      },
      "updated_at" : "2023-08-02T20:01:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1662864782",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "~0\r\n\r\nI don't think that PRs like this are a good use of reviewers' time, especially since this conflicts with a priority project. Minor refactors such as this cause code churn, conflict with other high priority PRs, and really only clean up the code style. It does not seem to meaningfully contribute to larger projects/goals of this project. ",
      "created_at" : "2023-09-21T10:48:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#issuecomment-1729323724",
      "id" : 1729323724,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28078",
      "node_id" : "IC_kwDOABII585nE2LM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1729323724/reactions"
      },
      "updated_at" : "2023-09-21T10:48:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1729323724",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 4ecfd3eaf434d868455466e001adae4b68515ab8\r\n\r\nMerging as the 324 PRs need rebasing anyways. However I don't think we should have PRs like this in the future.",
      "created_at" : "2023-09-21T15:26:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#issuecomment-1729810988",
      "id" : 1729810988,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28078",
      "node_id" : "IC_kwDOABII585nGtIs",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1729810988/reactions"
      },
      "updated_at" : "2023-09-21T15:26:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1729810988",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This change is the cause of:\r\n```bash\r\n node0 stderr ==75935== Thread 25 b-msghand:\r\n==75935== Conditional jump or move depends on uninitialised value(s)\r\n==75935==    at 0x1955B8: _M_reset (optional:313)\r\n==75935==    by 0x1955B8: ~_Optional_payload (optional:437)\r\n==75935==    by 0x1955B8: ~_Optional_base (optional:508)\r\n==75935==    by 0x1955B8: GetLocalAddress(CNode const&) (???:220)\r\n==75935==    by 0x1956A3: GetLocalAddrForPeer(CNode&) (net.cpp:240)\r\n==75935==    by 0x1D091F: MaybeSendAddr (net_processing.cpp:5259)\r\n==75935==    by 0x1D091F: (anonymous namespace)::PeerManagerImpl::SendMessages(CNode*) (???:5453)\r\n==75935==    by 0x1AA183: CConnman::ThreadMessageHandler() (net.cpp:2886)\r\n==75935==    by 0x750627: operator() (std_function.h:591)\r\n==75935==    by 0x750627: util::TraceThread(std::basic_string_view<char, std::char_traits<char> >, std::function<void ()>) (???:21)\r\n==75935==    by 0x1B290F: __invoke_impl<void, void (*)(std::basic_string_view<char, std::char_traits<char> >, std::function<void ()>), const char *, (lambda at net.cpp:3231:71)> (invoke.h:61)\r\n==75935==    by 0x1B290F: __invoke<void (*)(std::basic_string_view<char, std::char_traits<char> >, std::function<void ()>), const char *, (lambda at net.cpp:3231:71)> (invoke.h:96)\r\n==75935==    by 0x1B290F: _M_invoke<0UL, 1UL, 2UL> (std_thread.h:292)\r\n==75935==    by 0x1B290F: operator() (std_thread.h:299)\r\n==75935==    by 0x1B290F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char> >, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_5> > >::_M_run() (std_thread.h:244)\r\n==75935==    by 0x4C501BF: execute_native_thread_routine (thread.cc:104)\r\n==75935==    by 0x4F85E37: start_thread (pthread_create.c:447)\r\n==75935==    by 0x4FF0E5B: thread_start (clone.S:79)\r\n==75935== \r\n{\r\n   <insert_a_suppression_name_here>\r\n   Memcheck:Cond\r\n   fun:_M_reset\r\n   fun:~_Optional_payload\r\n   fun:~_Optional_base\r\n   fun:_Z15GetLocalAddressRK5CNode\r\n   fun:_Z19GetLocalAddrForPeerR5CNode\r\n   fun:MaybeSendAddr\r\n   fun:_ZN12_GLOBAL__N_115PeerManagerImpl12SendMessagesEP5CNode\r\n   fun:_ZN8CConnman20ThreadMessageHandlerEv\r\n   fun:operator()\r\n   fun:_ZN4util11TraceThreadESt17basic_string_viewIcSt11char_traitsIcEESt8functionIFvvEE\r\n   fun:__invoke_impl<void, void (*)(std::basic_string_view<char, std::char_traits<char> >, std::function<void ()>), const char *, (lambda at net.cpp:3231:71)>\r\n   fun:__invoke<void (*)(std::basic_string_view<char, std::char_traits<char> >, std::function<void ()>), const char *, (lambda at net.cpp:3231:71)>\r\n   fun:_M_invoke<0UL, 1UL, 2UL>\r\n   fun:operator()\r\n   fun:_ZNSt6thread11_State_implINS_8_InvokerISt5tupleIJPFvSt17basic_string_viewIcSt11char_traitsIcEESt8functionIFvvEEEPKcZN8CConnman5StartER10CSchedulerRKNSE_7OptionsEE3$_5EEEEE6_M_runEv\r\n   fun:execute_native_thread_routine\r\n   fun:start_thread\r\n   fun:thread_start\r\n}\r\n==75935== \r\n==75935== Exit program on first error (--exit-on-first-error=yes)\r\n```\r\nwhich currently happens when using Clang 17 on aarch64 with Valgrind 3.22.0. May be similar to #27741, however that is with GCC 12 on x86_64.",
      "created_at" : "2024-03-12T11:10:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28078#issuecomment-1991398244",
      "id" : 1991398244,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28078",
      "node_id" : "IC_kwDOABII5852slNk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1991398244/reactions"
      },
      "updated_at" : "2024-03-12T11:10:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1991398244",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   }
]
