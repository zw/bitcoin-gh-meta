{
   "assignee" : null,
   "body" : "Previously the benchmark code used an integer division (%) with\r\n a non-constant in the inner-loop.  This is quite slow on many\r\n processors, especially ones like ARM that lack a hardware divide.\r\n\r\nEven on fairly recent x86_64 like haswell an integer division can\r\n take something like 100 cycles-- making it comparable to the\r\n runtime of siphash.\r\n\r\nThis change avoids the division by using bitmasking instead. This\r\n was especially easy since the count was only increased by doubling.\r\n\r\nThis change also restarts the timing when the execution time was\r\n very low this avoids mintimes of zero in cases where one execution\r\n ends up below the timer resolution. It also reduces the impact of\r\n the overhead on the final result.\r\n\r\nThe formatting of the prints is changed to not use scientific\r\n notation make it more machine readable (in particular, gnuplot\r\n croaks on the non-fixedpoint, and it doesn't sort correctly).\r\n\r\nThis also hoists out all the floating point divisions out of the\r\n semi-hot path because it was easy to do so.\r\n\r\nIt might be prudent to break out the critical test into a macro\r\n just to guarantee that it gets inlined.  It might also make sense\r\n to just save out the intermediate counts and times and get the\r\n floating point completely out of the timing loop (because e.g.\r\n on hardware without a fast hardware FPU like some ARM it will\r\n still be slow enough to distort the results). I haven't done\r\n either of these in this commit.",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 0,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8115/comments",
   "created_at" : "2016-05-29T01:51:40Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8115/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/8115",
   "id" : 157364913,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8115/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 8115,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/8115.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8115",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/8115.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8115"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "Avoid integer division in the benchmark inner-most loop.",
   "updated_at" : "2016-05-29T01:51:40Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8115",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
      "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
      "followers_url" : "https://api.github.com/users/gmaxwell/followers",
      "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/gmaxwell",
      "id" : 858454,
      "login" : "gmaxwell",
      "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
      "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
      "repos_url" : "https://api.github.com/users/gmaxwell/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/gmaxwell"
   }
}
