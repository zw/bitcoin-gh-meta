[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK\r\n\r\nThis should fix https://github.com/bitcoin/bitcoin/issues/10542",
      "created_at" : "2022-01-13T13:04:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1012118062",
      "id" : 1012118062,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5848U7Iu",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 1,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012118062/reactions"
      },
      "updated_at" : "2022-01-13T13:12:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012118062",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/13405205?v=4",
         "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prayank23/followers",
         "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prayank23",
         "id" : 13405205,
         "login" : "prayank23",
         "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
         "organizations_url" : "https://api.github.com/users/prayank23/orgs",
         "received_events_url" : "https://api.github.com/users/prayank23/received_events",
         "repos_url" : "https://api.github.com/users/prayank23/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prayank23"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@kallewoof do you know if any other wallet implemented BIP-322 yet, so we can compare the implementation?\r\n\r\nThis is really a good time to add test vectors to the BIP (and this PR).",
      "created_at" : "2022-01-13T13:39:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1012145869",
      "id" : 1012145869,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5848VB7N",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012145869/reactions"
      },
      "updated_at" : "2022-01-13T14:05:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012145869",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r783971038"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783971038"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Although `SIGHASH_DEFAULT` implies `SIGHASH_ALL`, AFAIK using `SIGHASH_ALL` is still possible for users who wish to waste 1 byte. So I think you need `m_require_sighash_all && nHashType != SIGHASH_ALL` here too.",
      "commit_id" : "c1a5cf0033210f69af98a653895af801d452f041",
      "created_at" : "2022-01-13T13:46:38Z",
      "diff_hunk" : "@@ -1707,6 +1711,9 @@ bool GenericTransactionSignatureChecker<T>::CheckSchnorrSignature(Span<const uns\n \n     uint8_t hashtype = SIGHASH_DEFAULT;\n     if (sig.size() == 65) {\n+        if (m_require_sighash_all) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r783971038",
      "id" : 783971038,
      "line" : 1714,
      "node_id" : "PRRC_kwDOABII584uunLe",
      "original_commit_id" : "ad0002c91bb683c5d484ac03e16aaa682bc5a3e2",
      "original_line" : 1714,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/script/interpreter.cpp",
      "position" : 15,
      "pull_request_review_id" : 851731536,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783971038/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-13T13:48:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783971038",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r783982176"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783982176"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This message implies the user can do something about it. Suggest instead: \"BIP-322 Proof of Funds is not supported\"",
      "commit_id" : "c1a5cf0033210f69af98a653895af801d452f041",
      "created_at" : "2022-01-13T13:59:12Z",
      "diff_hunk" : "@@ -348,9 +348,16 @@ static RPCHelpMan verifymessage()\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Address does not refer to key\");\n     case MessageVerificationResult::ERR_MALFORMED_SIGNATURE:\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Malformed base64 encoding\");\n+    case MessageVerificationResult::ERR_POF:\n+        throw JSONRPCError(RPC_TYPE_ERROR, \"Proof of funds require UTXO set access to verify\"); // TODO: get access to UTXO set / mempool to handle this, then remove this error code?",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r783982176",
      "id" : 783982176,
      "line" : 352,
      "node_id" : "PRRC_kwDOABII584uup5g",
      "original_commit_id" : "aed56aa486b6258aa03fd8c9a6154bb9bd7db973",
      "original_line" : 352,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/rpc/misc.cpp",
      "position" : 5,
      "pull_request_review_id" : 851747231,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783982176/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-13T14:03:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783982176",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r783983431"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783983431"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why not just throw in these other cases?",
      "commit_id" : "c1a5cf0033210f69af98a653895af801d452f041",
      "created_at" : "2022-01-13T14:00:36Z",
      "diff_hunk" : "@@ -348,9 +348,16 @@ static RPCHelpMan verifymessage()\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Address does not refer to key\");\n     case MessageVerificationResult::ERR_MALFORMED_SIGNATURE:\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Malformed base64 encoding\");\n+    case MessageVerificationResult::ERR_POF:\n+        throw JSONRPCError(RPC_TYPE_ERROR, \"Proof of funds require UTXO set access to verify\"); // TODO: get access to UTXO set / mempool to handle this, then remove this error code?\n+    case MessageVerificationResult::INCONCLUSIVE:\n+        return false; // TODO: switch to a string based result? mix bool and strings?",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r783983431",
      "id" : 783983431,
      "line" : 354,
      "node_id" : "PRRC_kwDOABII584uuqNH",
      "original_commit_id" : "aed56aa486b6258aa03fd8c9a6154bb9bd7db973",
      "original_line" : 354,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/rpc/misc.cpp",
      "position" : 7,
      "pull_request_review_id" : 851747231,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783983431/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-13T14:03:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783983431",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r783985638"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783985638"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm unsure, but perhaps we should make a fresh `enum BIP322VerificationResult`?",
      "commit_id" : "c1a5cf0033210f69af98a653895af801d452f041",
      "created_at" : "2022-01-13T14:03:16Z",
      "diff_hunk" : "@@ -36,7 +36,23 @@ enum class MessageVerificationResult {\n     ERR_NOT_SIGNED,\n \n     //! The message verification was successful.\n-    OK\n+    OK,\n+\n+    //\n+    // BIP-322 extensions",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r783985638",
      "id" : 783985638,
      "line" : 53,
      "node_id" : "PRRC_kwDOABII584uuqvm",
      "original_commit_id" : "aed56aa486b6258aa03fd8c9a6154bb9bd7db973",
      "original_line" : 42,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/util/message.h",
      "position" : 8,
      "pull_request_review_id" : 851747231,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783985638/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-13T14:03:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783985638",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [theStack](https://github.com/bitcoin/bitcoin/pull/24058#pullrequestreview-1186516390) |\n| Concept ACK | [ghost](https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1012118062) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26008](https://github.com/bitcoin/bitcoin/pull/26008) (wallet: cache IsMine scriptPubKeys to improve performance of descriptor wallets by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2022-01-13T14:58:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1012214536",
      "id" : 1012214536,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5848VSsI",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012214536/reactions"
      },
      "updated_at" : "2023-05-16T10:50:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012214536",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @kallewoof do you know if any other wallet implemented BIP-322 yet, so we can compare the implementation?\r\n> \r\n> This is really a good time to add test vectors to the BIP (and this PR).\r\n\r\nI have an implementation here: https://github.com/bitcoin-s/bitcoin-s/pull/3823",
      "created_at" : "2022-01-13T18:38:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1012405794",
      "id" : 1012405794,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5848WBYi",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 1,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 2,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012405794/reactions"
      },
      "updated_at" : "2022-01-13T18:38:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012405794",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r784367872"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784367872"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Isn't that a malleability? Anyway, gotcha.",
      "commit_id" : "c1a5cf0033210f69af98a653895af801d452f041",
      "created_at" : "2022-01-13T22:18:53Z",
      "diff_hunk" : "@@ -1707,6 +1711,9 @@ bool GenericTransactionSignatureChecker<T>::CheckSchnorrSignature(Span<const uns\n \n     uint8_t hashtype = SIGHASH_DEFAULT;\n     if (sig.size() == 65) {\n+        if (m_require_sighash_all) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r784367872",
      "id" : 784367872,
      "in_reply_to_id" : 783971038,
      "line" : 1714,
      "node_id" : "PRRC_kwDOABII584uwIEA",
      "original_commit_id" : "ad0002c91bb683c5d484ac03e16aaa682bc5a3e2",
      "original_line" : 1714,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/script/interpreter.cpp",
      "position" : 15,
      "pull_request_review_id" : 852302598,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784367872/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-13T22:18:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784367872",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r784369323"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784369323"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Sounds good. The intention is to actually add this functionality, but I think it should be its own PR.",
      "commit_id" : "c1a5cf0033210f69af98a653895af801d452f041",
      "created_at" : "2022-01-13T22:21:45Z",
      "diff_hunk" : "@@ -348,9 +348,16 @@ static RPCHelpMan verifymessage()\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Address does not refer to key\");\n     case MessageVerificationResult::ERR_MALFORMED_SIGNATURE:\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Malformed base64 encoding\");\n+    case MessageVerificationResult::ERR_POF:\n+        throw JSONRPCError(RPC_TYPE_ERROR, \"Proof of funds require UTXO set access to verify\"); // TODO: get access to UTXO set / mempool to handle this, then remove this error code?",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r784369323",
      "id" : 784369323,
      "in_reply_to_id" : 783982176,
      "line" : 352,
      "node_id" : "PRRC_kwDOABII584uwIar",
      "original_commit_id" : "aed56aa486b6258aa03fd8c9a6154bb9bd7db973",
      "original_line" : 352,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/rpc/misc.cpp",
      "position" : 5,
      "pull_request_review_id" : 852304631,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784369323/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-13T22:21:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784369323",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r784370137"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784370137"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Because these aren't errors? But yeah, that would be one way to return a message. I think I'd prefer to expand the returned value from simple bool to true|false|\"inconclusive\", but not sure that would be appreciated.",
      "commit_id" : "c1a5cf0033210f69af98a653895af801d452f041",
      "created_at" : "2022-01-13T22:23:14Z",
      "diff_hunk" : "@@ -348,9 +348,16 @@ static RPCHelpMan verifymessage()\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Address does not refer to key\");\n     case MessageVerificationResult::ERR_MALFORMED_SIGNATURE:\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Malformed base64 encoding\");\n+    case MessageVerificationResult::ERR_POF:\n+        throw JSONRPCError(RPC_TYPE_ERROR, \"Proof of funds require UTXO set access to verify\"); // TODO: get access to UTXO set / mempool to handle this, then remove this error code?\n+    case MessageVerificationResult::INCONCLUSIVE:\n+        return false; // TODO: switch to a string based result? mix bool and strings?",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r784370137",
      "id" : 784370137,
      "in_reply_to_id" : 783983431,
      "line" : 354,
      "node_id" : "PRRC_kwDOABII584uwInZ",
      "original_commit_id" : "aed56aa486b6258aa03fd8c9a6154bb9bd7db973",
      "original_line" : 354,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/rpc/misc.cpp",
      "position" : 7,
      "pull_request_review_id" : 852305720,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784370137/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-13T22:23:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784370137",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r784393378"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784393378"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oftentimes you won't know which type it is until you finish verifying, so unifying the two types seems sensible to me.",
      "commit_id" : "8eb5031829390b1f746f54d08d28e51d507f3077",
      "created_at" : "2022-01-13T23:10:12Z",
      "diff_hunk" : "@@ -36,7 +36,23 @@ enum class MessageVerificationResult {\n     ERR_NOT_SIGNED,\n \n     //! The message verification was successful.\n-    OK\n+    OK,\n+\n+    //\n+    // BIP-322 extensions",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r784393378",
      "id" : 784393378,
      "in_reply_to_id" : 783985638,
      "line" : 53,
      "node_id" : "PRRC_kwDOABII584uwOSi",
      "original_commit_id" : "aed56aa486b6258aa03fd8c9a6154bb9bd7db973",
      "original_line" : 53,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/util/message.h",
      "position" : 26,
      "pull_request_review_id" : 852337021,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784393378/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-13T23:10:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784393378",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I will make test vectors very soon. Let's compare notes at that point @benthecarman.",
      "created_at" : "2022-01-13T23:10:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1012602458",
      "id" : 1012602458,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5848WxZa",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012602458/reactions"
      },
      "updated_at" : "2022-01-13T23:10:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012602458",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I will make test vectors very soon. Let's compare notes at that point @benthecarman.\n\nSounds good, I made some in pr if you want to try those ",
      "created_at" : "2022-01-13T23:14:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1012604302",
      "id" : 1012604302,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5848Wx2O",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012604302/reactions"
      },
      "updated_at" : "2022-01-13T23:14:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012604302",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Yep. I will try them, once I make my own. I don't want to adjust the code to fit your test vectors, I'd rather both implementations independently passing both sets.",
      "created_at" : "2022-01-13T23:15:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1012604804",
      "id" : 1012604804,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5848Wx-E",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012604804/reactions"
      },
      "updated_at" : "2022-01-13T23:15:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012604804",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r784803179"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784803179"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Some RPCs return `false` as the result and an error message field. Others just throw with an error code and message. It's an error in the vague sense that the RPC failed to verify what it was asked to verify.",
      "commit_id" : "93a9c688541eb4a241156ac35d81ac735c1dd437",
      "created_at" : "2022-01-14T12:25:25Z",
      "diff_hunk" : "@@ -348,9 +348,16 @@ static RPCHelpMan verifymessage()\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Address does not refer to key\");\n     case MessageVerificationResult::ERR_MALFORMED_SIGNATURE:\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Malformed base64 encoding\");\n+    case MessageVerificationResult::ERR_POF:\n+        throw JSONRPCError(RPC_TYPE_ERROR, \"Proof of funds require UTXO set access to verify\"); // TODO: get access to UTXO set / mempool to handle this, then remove this error code?\n+    case MessageVerificationResult::INCONCLUSIVE:\n+        return false; // TODO: switch to a string based result? mix bool and strings?",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r784803179",
      "id" : 784803179,
      "in_reply_to_id" : 783983431,
      "line" : 354,
      "node_id" : "PRRC_kwDOABII584uxyVr",
      "original_commit_id" : "aed56aa486b6258aa03fd8c9a6154bb9bd7db973",
      "original_line" : 354,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/rpc/misc.cpp",
      "position" : 7,
      "pull_request_review_id" : 852859400,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784803179/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-14T12:25:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784803179",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r785221182"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785221182"
         }
      },
      "author_association" : "MEMBER",
      "body" : "OK, but what about \"OK_TIMELOCKED\"?",
      "commit_id" : "93a9c688541eb4a241156ac35d81ac735c1dd437",
      "created_at" : "2022-01-14T23:09:17Z",
      "diff_hunk" : "@@ -348,9 +348,16 @@ static RPCHelpMan verifymessage()\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Address does not refer to key\");\n     case MessageVerificationResult::ERR_MALFORMED_SIGNATURE:\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Malformed base64 encoding\");\n+    case MessageVerificationResult::ERR_POF:\n+        throw JSONRPCError(RPC_TYPE_ERROR, \"Proof of funds require UTXO set access to verify\"); // TODO: get access to UTXO set / mempool to handle this, then remove this error code?\n+    case MessageVerificationResult::INCONCLUSIVE:\n+        return false; // TODO: switch to a string based result? mix bool and strings?",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r785221182",
      "id" : 785221182,
      "in_reply_to_id" : 783983431,
      "line" : 354,
      "node_id" : "PRRC_kwDOABII584uzYY-",
      "original_commit_id" : "aed56aa486b6258aa03fd8c9a6154bb9bd7db973",
      "original_line" : 354,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/rpc/misc.cpp",
      "position" : 7,
      "pull_request_review_id" : 853453250,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785221182/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-14T23:09:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785221182",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Would like to see BIP 322 address the distinction between the current \"signer receives fund with the address\" and the long-desired \"signer sent a prior transaction\" even if not supported by this PR.",
      "created_at" : "2022-01-15T22:06:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1013761616",
      "id" : 1013761616,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5848bMZQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013761616/reactions"
      },
      "updated_at" : "2022-01-15T22:06:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013761616",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@luke-jr I'm not sure if you're suggesting a BIP change or a code feature. If the latter, I think the ideal path forward is for you to open a pull request follow-up to this one (maybe post-merge) to do what you are requesting. If former, open a PR to the BIP?",
      "created_at" : "2022-01-16T12:10:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1013864335",
      "id" : 1013864335,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5848bleP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013864335/reactions"
      },
      "updated_at" : "2022-01-16T12:10:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013864335",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "There is now a WIP with test vectors in https://github.com/bitcoin/bips/pull/1279 which needs to be filled in (possibly with @benthecarman's cases).",
      "created_at" : "2022-01-26T10:20:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1022060067",
      "id" : 1022060067,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII584862Yj",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1022060067/reactions"
      },
      "updated_at" : "2022-01-26T10:20:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1022060067",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r795181706"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/795181706"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Note that `HASHER_BIP322` and some other identifiers are not available yet at this commit, i.e. compiling b23186d9f816aefe2fcf95e6f77d941c65e9c71c currently fails:\r\n```\r\n...\r\n  CXX      wallet/libbitcoin_wallet_tool_a-wallettool.o\r\nutil/message.cpp:105:41: error: use of undeclared identifier 'HASHER_BIP322'\r\n    uint256 message_hash = (CHashWriter(HASHER_BIP322) << message).GetSHA256();\r\n                                        ^\r\nutil/message.cpp:116:22: error: use of undeclared identifier 'DecodeTx'\r\n    if (signature && DecodeTx(to_sign, *signature, /* try_no_witness */ true, /* try_witness */ true)) {\r\n                     ^\r\nutil/message.cpp:120:49: error: no member named 'ERR_POF' in 'MessageVerificationResult'\r\n            result = MessageVerificationResult::ERR_POF;\r\n                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~^\r\nutil/message.cpp:128:49: error: no member named 'ERR_INVALID' in 'MessageVerificationResult'\r\n            result = MessageVerificationResult::ERR_INVALID;\r\n                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~^\r\nutil/message.cpp:141:57: error: no member named 'ERR_INVALID' in 'MessageVerificationResult'\r\n            result = MessageVerificationResult::ERR_INVALID;\r\n                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~^\r\n5 errors generated.\r\n...\r\n```",
      "commit_id" : "93a9c688541eb4a241156ac35d81ac735c1dd437",
      "created_at" : "2022-01-30T13:24:08Z",
      "diff_hunk" : "@@ -90,3 +90,65 @@ std::string SigningResultString(const SigningResult res)\n     }\n     assert(false);\n }\n+\n+std::optional<BIP322Txs> BIP322Txs::Create(const CTxDestination& destination, const std::string& message, MessageVerificationResult& result, const std::vector<unsigned char>* signature)\n+{\n+    // attempt to get script pub key for destination\n+    CScript message_challenge = GetScriptForDestination(destination);\n+    if (message_challenge.size() == 0) {\n+        // NoDestination; failure\n+        // (use legacy result)\n+        return std::nullopt;\n+    }\n+\n+    // prepare message hash\n+    uint256 message_hash = (CHashWriter(HASHER_BIP322) << message).GetSHA256();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r795181706",
      "id" : 795181706,
      "line" : 166,
      "node_id" : "PRRC_kwDOABII584vZYKK",
      "original_commit_id" : "b23186d9f816aefe2fcf95e6f77d941c65e9c71c",
      "original_line" : 105,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 16,
      "pull_request_review_id" : 867105720,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/795181706/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-30T13:27:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/795181706",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@theStack Thanks for the review. You're right, I meant SIMPLE not SINGLE. Fixed.\r\n\r\nI did some clean-up and I think this also fixes the issues with HASHER_BIP322 being used before it is added.",
      "created_at" : "2022-01-31T04:23:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1025366737",
      "id" : 1025366737,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5849HdrR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1025366737/reactions"
      },
      "updated_at" : "2022-01-31T04:23:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1025366737",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "No idea why fuzzer runs out of time (2h!). Restarting didn't fix it either.",
      "created_at" : "2022-01-31T10:11:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1025572189",
      "id" : 1025572189,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5849IP1d",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1025572189/reactions"
      },
      "updated_at" : "2022-01-31T10:11:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1025572189",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This was fixed in 9237bdaac196951a437accaefa65638149b25978. Restarting the fuzz now should hopefully fix it.",
      "created_at" : "2022-01-31T10:21:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1025583487",
      "id" : 1025583487,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5849ISl_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 1,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1025583487/reactions"
      },
      "updated_at" : "2022-01-31T10:21:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1025583487",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Updated to reflect discrepancies in https://github.com/bitcoin/bips/pull/1279#issuecomment-1027545873 (version was explicitly set to 2 even though BIP allow(ed) any appropriate value, resulting in differences between implementations).",
      "created_at" : "2022-02-02T03:44:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1027547066",
      "id" : 1027547066,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5849Px-6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1027547066/reactions"
      },
      "updated_at" : "2022-02-02T03:44:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1027547066",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "8f0451c0-ec7d-4357-a370-eff72fb0685f",
      "created_at" : "2022-02-04T09:55:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1029818013",
      "id" : 1029818013,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5849Ycad",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1029818013/reactions"
      },
      "updated_at" : "2022-02-04T09:55:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1029818013",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/93851981?v=4",
         "events_url" : "https://api.github.com/users/Bartascnk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Bartascnk/followers",
         "following_url" : "https://api.github.com/users/Bartascnk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Bartascnk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Bartascnk",
         "id" : 93851981,
         "login" : "Bartascnk",
         "node_id" : "U_kgDOBZgRTQ",
         "organizations_url" : "https://api.github.com/users/Bartascnk/orgs",
         "received_events_url" : "https://api.github.com/users/Bartascnk/received_events",
         "repos_url" : "https://api.github.com/users/Bartascnk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Bartascnk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Bartascnk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Bartascnk"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-04-27T15:49:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1111164990",
      "id" : 1111164990,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585COwg-",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1111164990/reactions"
      },
      "updated_at" : "2022-04-27T15:49:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1111164990",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r872561862"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/872561862"
         }
      },
      "author_association" : "NONE",
      "body" : "```suggestion\r\n\r\n    // BIP322 signature created using buidl-python library with same parameters as test on line 2596\r\n    BOOST_CHECK_EQUAL(\r\n        MessageVerify(\r\n            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\r\n         \"AkgwRQIhAOzyynlqt93lOKJr+wmmxIens//zPzl9tqIOua93wO6MAiBi5n5EyAcPScOjf1lAqIUIQtr3zKNeavYabHyR8eGhowEhAsfxIAMZZEKUPYWI4BruhAQjzFT8FSFSajuFwrDL1Yhy\",\r\n            \"Hello World\"),\r\n        MessageVerificationResult::OK);\r\n        \r\n```\r\n\r\nWe tried to create an implementation of BIP322 using the buidl-python library. The signature in this test case was produced using the same message and address. Not sure what is going on here.\r\n\r\nI was also able to verify the signature provided in the test on line 2596 through the buidl python code I produced.\r\n\r\nSo two signatures for the same message for the same address are both returning as valid. This seems strange?",
      "commit_id" : "843ce398a1d4661b9d93160635b46cc0a70d6153",
      "created_at" : "2022-05-13T16:03:33Z",
      "diff_hunk" : "@@ -2547,6 +2581,74 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r872561862",
      "id" : 872561862,
      "line" : 2602,
      "node_id" : "PRRC_kwDOABII5840AjzG",
      "original_commit_id" : "843ce398a1d4661b9d93160635b46cc0a70d6153",
      "original_line" : 2602,
      "original_position" : 99,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 99,
      "pull_request_review_id" : 972487273,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/872561862/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-13T16:03:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/872561862",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/18055112?v=4",
         "events_url" : "https://api.github.com/users/wip-abramson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wip-abramson/followers",
         "following_url" : "https://api.github.com/users/wip-abramson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wip-abramson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wip-abramson",
         "id" : 18055112,
         "login" : "wip-abramson",
         "node_id" : "MDQ6VXNlcjE4MDU1MTEy",
         "organizations_url" : "https://api.github.com/users/wip-abramson/orgs",
         "received_events_url" : "https://api.github.com/users/wip-abramson/received_events",
         "repos_url" : "https://api.github.com/users/wip-abramson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wip-abramson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wip-abramson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wip-abramson"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r872979455"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/872979455"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@wip-abramson ECDSA signatures have randomness in them, so it is perfectly possible to construct multiple valid ones for the same key and message. Bitcoin Core's signing logic is based on RFC6979, but additionally grinds the nonce in order to make sure the R and S values in signatures don't exceed 32 bytes each. Is your signing code doing the same?",
      "commit_id" : "843ce398a1d4661b9d93160635b46cc0a70d6153",
      "created_at" : "2022-05-14T13:23:51Z",
      "diff_hunk" : "@@ -2547,6 +2581,74 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r872979455",
      "id" : 872979455,
      "in_reply_to_id" : 872561862,
      "line" : 2602,
      "node_id" : "PRRC_kwDOABII5840CJv_",
      "original_commit_id" : "843ce398a1d4661b9d93160635b46cc0a70d6153",
      "original_line" : 2602,
      "original_position" : 99,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 99,
      "pull_request_review_id" : 973015656,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/872979455/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-14T13:23:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/872979455",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r874435336"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874435336"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Added suggested test and rebased. Thanks!",
      "commit_id" : "64ecca3f0e43b9088bf4be842a4096929724480f",
      "created_at" : "2022-05-17T06:56:42Z",
      "diff_hunk" : "@@ -2547,6 +2581,74 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r874435336",
      "id" : 874435336,
      "in_reply_to_id" : 872561862,
      "line" : 2683,
      "node_id" : "PRRC_kwDOABII5840HtMI",
      "original_commit_id" : "843ce398a1d4661b9d93160635b46cc0a70d6153",
      "original_line" : 2683,
      "original_position" : 99,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 99,
      "pull_request_review_id" : 974928854,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874435336/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-17T06:56:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874435336",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r874773061"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874773061"
         }
      },
      "author_association" : "NONE",
      "body" : "Makes sense thanks! @sipa I am not a hundred per cent sure, but I think so. This is the code in buidl-python to generate the deterministic k value. https://github.com/buidl-bitcoin/buidl-python/blob/e62e0b9fd4271473cf641cde0fe366e65c787403/buidl/pecc.py#L563 ",
      "commit_id" : "64ecca3f0e43b9088bf4be842a4096929724480f",
      "created_at" : "2022-05-17T12:51:32Z",
      "diff_hunk" : "@@ -2547,6 +2581,74 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r874773061",
      "id" : 874773061,
      "in_reply_to_id" : 872561862,
      "line" : 2683,
      "node_id" : "PRRC_kwDOABII5840I_pF",
      "original_commit_id" : "843ce398a1d4661b9d93160635b46cc0a70d6153",
      "original_line" : 2683,
      "original_position" : 99,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 99,
      "pull_request_review_id" : 975410318,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874773061/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-17T12:51:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874773061",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/18055112?v=4",
         "events_url" : "https://api.github.com/users/wip-abramson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wip-abramson/followers",
         "following_url" : "https://api.github.com/users/wip-abramson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wip-abramson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wip-abramson",
         "id" : 18055112,
         "login" : "wip-abramson",
         "node_id" : "MDQ6VXNlcjE4MDU1MTEy",
         "organizations_url" : "https://api.github.com/users/wip-abramson/orgs",
         "received_events_url" : "https://api.github.com/users/wip-abramson/received_events",
         "repos_url" : "https://api.github.com/users/wip-abramson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wip-abramson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wip-abramson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wip-abramson"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Whilst implementing bip322 I noticed a discrepancy in the test vectors in the actual BIP vs the ones used in this P.R. The ones currently in bip322 are incorrect and don't verify against the messages provided. The above-mentioned P.R. is a fix for this",
      "created_at" : "2022-05-17T12:59:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1128838232",
      "id" : 1128838232,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585DSLRY",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1128838232/reactions"
      },
      "updated_at" : "2022-05-17T12:59:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1128838232",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/18055112?v=4",
         "events_url" : "https://api.github.com/users/wip-abramson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wip-abramson/followers",
         "following_url" : "https://api.github.com/users/wip-abramson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wip-abramson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wip-abramson",
         "id" : 18055112,
         "login" : "wip-abramson",
         "node_id" : "MDQ6VXNlcjE4MDU1MTEy",
         "organizations_url" : "https://api.github.com/users/wip-abramson/orgs",
         "received_events_url" : "https://api.github.com/users/wip-abramson/received_events",
         "repos_url" : "https://api.github.com/users/wip-abramson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wip-abramson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wip-abramson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wip-abramson"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r877627750"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/877627750"
         }
      },
      "author_association" : "NONE",
      "body" : "Is there some reason it is useful to have different signatures considered valid for the same message?",
      "commit_id" : "64ecca3f0e43b9088bf4be842a4096929724480f",
      "created_at" : "2022-05-20T00:09:41Z",
      "diff_hunk" : "@@ -2547,6 +2581,74 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r877627750",
      "id" : 877627750,
      "in_reply_to_id" : 872561862,
      "line" : 2683,
      "node_id" : "PRRC_kwDOABII5840T4lm",
      "original_commit_id" : "843ce398a1d4661b9d93160635b46cc0a70d6153",
      "original_line" : 2683,
      "original_position" : 99,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 99,
      "pull_request_review_id" : 979382711,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/877627750/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-20T00:09:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/877627750",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/186831?v=4",
         "events_url" : "https://api.github.com/users/jandrieu/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jandrieu/followers",
         "following_url" : "https://api.github.com/users/jandrieu/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jandrieu/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jandrieu",
         "id" : 186831,
         "login" : "jandrieu",
         "node_id" : "MDQ6VXNlcjE4NjgzMQ==",
         "organizations_url" : "https://api.github.com/users/jandrieu/orgs",
         "received_events_url" : "https://api.github.com/users/jandrieu/received_events",
         "repos_url" : "https://api.github.com/users/jandrieu/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jandrieu/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jandrieu/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jandrieu"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r877631827"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/877631827"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@jandrieu It is an inevitability. No unique signature scheme based on the discrete logarithm problem that Bitcoin relies on is known (unique signatures schemes are ones where only a single signature is valid per (message, public key) pair).",
      "commit_id" : "64ecca3f0e43b9088bf4be842a4096929724480f",
      "created_at" : "2022-05-20T00:21:39Z",
      "diff_hunk" : "@@ -2547,6 +2581,74 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r877631827",
      "id" : 877631827,
      "in_reply_to_id" : 872561862,
      "line" : 2683,
      "node_id" : "PRRC_kwDOABII5840T5lT",
      "original_commit_id" : "843ce398a1d4661b9d93160635b46cc0a70d6153",
      "original_line" : 2683,
      "original_position" : 99,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 99,
      "pull_request_review_id" : 979388084,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/877631827/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-20T00:22:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/877631827",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r916736808"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/916736808"
         }
      },
      "author_association" : "NONE",
      "body" : "Two additional test vectors for p2sh and p2wsh multisig bip322 sigs\r\n\r\n```suggestion\r\n\r\n    // 2-of-3 p2sh multisig BIP322 signature (created with the buidl-python library)\r\n    // Keys are defined as (HDRootWIF, bip322_path)\r\n    // Key1 (L4DksdGZ4KQJfcLHD5Dv25fu8Rxyv7hHi2RjZR4TYzr8c6h9VNrp, m/45'/0/0/1)\r\n    // Key2 (KzSRqnCVwjzY8id2X5oHEJWXkSHwKUYaAXusjwgkES8BuQPJnPNu, m/45'/0/0/3)\r\n    // Key3 (L1zt9Rw7HrU7jaguMbVzhiX8ffuVkmMis5wLHddXYuHWYf8u8uRj, m/45'/0/0/6)\r\n    // BIP322 includes signs from Key2 and Key3\r\n    BOOST_CHECK_EQUAL(\r\n        MessageVerify(\r\n            \"3LnYoUkFrhyYP3V7rq3mhpwALz1XbCY9Uq\",\r\n         \"AAAAAAHNcfHaNfl8f/+ZC2gTr8aF+0KgppYjKM94egaNm/u1ZAAAAAD8AEcwRAIhAJ6hdj61vLDP+aFa30qUZQmrbBfE0kiOObYvt5nqPSxsAh9IrOKFwflfPRUcQ/5e0REkdFHVP2GGdUsMgDet+sNlAUcwRAIgH3eW/VyFDoXvCasd8qxgwj5NDVo0weXvM6qyGXLCR5YCIEwjbEV6fS6RWP6QsKOcMwvlGr1/SgdCC6pW4eH87/YgAUxpUiECKJfGy28imLcuAeNBLHCNv3NRP5jnJwFDNRXCYNY/vJ4hAv1RQtaZs7+vKqQeWl2rb/jd/gMxkEjUnjZdDGPDZkMLIQL65cH2X5O7LujjTLDL2l8Pxy0Y2UUR99u1qCfjdz7dklOuAAAAAAEAAAAAAAAAAAFqAAAAAA==\",\r\n            \"This will be a p2sh 2-of-3 multisig BIP 322 signed message\"),\r\n        MessageVerificationResult::OK);\r\n\r\n    // 3-of-3 p2wsh multisig BIP322 signature (created with the buidl-python library)\r\n    // Keys are defined as (HDRootWIF, bip322_path)\r\n    // Key1 (L4DksdGZ4KQJfcLHD5Dv25fu8Rxyv7hHi2RjZR4TYzr8c6h9VNrp, m/45'/0/0/6)\r\n    // Key2 (KzSRqnCVwjzY8id2X5oHEJWXkSHwKUYaAXusjwgkES8BuQPJnPNu, m/45'/0/0/9)\r\n    // Key3 (L1zt9Rw7HrU7jaguMbVzhiX8ffuVkmMis5wLHddXYuHWYf8u8uRj, m/45'/0/0/11)\r\n    BOOST_CHECK_EQUAL(\r\n        MessageVerify(\r\n            \"bc1qlqtuzpmazp2xmcutlwv0qvggdvem8vahkc333usey4gskug8nutsz53msw\",    \"BQBIMEUCIQDQoXvGKLH58exuujBOta+7+GN7vi0lKwiQxzBpuNuXuAIgIE0XYQlFDOfxbegGYYzlf+tqegleAKE6SXYIa1U+uCcBRzBEAiATegywVl6GWrG9jJuPpNwtgHKyVYCX2yfuSSDRFATAaQIgTLlU6reLQsSIrQSF21z3PtUO2yAUseUWGZqRUIE7VKoBSDBFAiEAgxtpidsU0Z4u/+5RB9cyeQtoCW5NcreLJmWXZ8kXCZMCIBR1sXoEinhZE4CF9P9STGIcMvCuZjY6F5F0XTVLj9SjAWlTIQP3dyWvTZjUENWJowMWBsQrrXCUs20Gu5YF79CG5Ga0XSEDwqI5GVBOuFkFzQOGH5eTExSAj2Z/LDV/hbcvAPQdlJMhA17FuuJd+4wGuj+ZbVxEsFapTKAOwyhfw9qpch52JKxbU64=\",\r\n            \"This will be a p2wsh 3-of-3 multisig BIP 322 signed message\"),\r\n        MessageVerificationResult::OK);\r\n        \r\n```",
      "commit_id" : "64ecca3f0e43b9088bf4be842a4096929724480f",
      "created_at" : "2022-07-08T11:41:44Z",
      "diff_hunk" : "@@ -2628,6 +2662,82 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+\n+    // BIP322 signature created using buidl-python library with same parameters as test on line 2596\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+         \"AkgwRQIhAOzyynlqt93lOKJr+wmmxIens//zPzl9tqIOua93wO6MAiBi5n5EyAcPScOjf1lAqIUIQtr3zKNeavYabHyR8eGhowEhAsfxIAMZZEKUPYWI4BruhAQjzFT8FSFSajuFwrDL1Yhy\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r916736808",
      "id" : 916736808,
      "line" : 2691,
      "node_id" : "PRRC_kwDOABII5842pEso",
      "original_commit_id" : "64ecca3f0e43b9088bf4be842a4096929724480f",
      "original_line" : 2691,
      "original_position" : 107,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 107,
      "pull_request_review_id" : 1032795887,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/916736808/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-08T11:42:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/916736808",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/18055112?v=4",
         "events_url" : "https://api.github.com/users/wip-abramson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wip-abramson/followers",
         "following_url" : "https://api.github.com/users/wip-abramson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wip-abramson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wip-abramson",
         "id" : 18055112,
         "login" : "wip-abramson",
         "node_id" : "MDQ6VXNlcjE4MDU1MTEy",
         "organizations_url" : "https://api.github.com/users/wip-abramson/orgs",
         "received_events_url" : "https://api.github.com/users/wip-abramson/received_events",
         "repos_url" : "https://api.github.com/users/wip-abramson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wip-abramson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wip-abramson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wip-abramson"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Tested for Legacy, P2SH-SegWit, SegWit, and Taproot. (commit 64ecca3f0e43b9088bf4be842a4096929724480f)\r\n\r\n`signmessage \"address\" \"mesage\"` -> signature\r\n`verifymessage \"address\" \"signature\" \"message\"` -> true\r\n\r\nResults in `true` when it should, and `errors` when messed with.\r\n\r\nExcept for Taproot addresses, which for some reason when the message is malformed, still results in `true`\r\n\r\nAll tests passed\r\n\r\nThis is a pre-req for BIP 129",
      "created_at" : "2022-07-08T15:42:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1179130082",
      "id" : 1179130082,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585GSBji",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1179130082/reactions"
      },
      "updated_at" : "2022-07-11T20:28:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1179130082",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/24482484?v=4",
         "events_url" : "https://api.github.com/users/Rspigler/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Rspigler/followers",
         "following_url" : "https://api.github.com/users/Rspigler/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Rspigler/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Rspigler",
         "id" : 24482484,
         "login" : "Rspigler",
         "node_id" : "MDQ6VXNlcjI0NDgyNDg0",
         "organizations_url" : "https://api.github.com/users/Rspigler/orgs",
         "received_events_url" : "https://api.github.com/users/Rspigler/received_events",
         "repos_url" : "https://api.github.com/users/Rspigler/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Rspigler/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Rspigler/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Rspigler"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r918213210"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918213210"
         }
      },
      "author_association" : "NONE",
      "body" : "This is a test case that demonstrates the issue with taproot signatures that @richerandprettier refers to. It seems that p2tr signatures validate against any message under the current impl. \r\n\r\nIs there some extra configuration required to setup bitcoin with schnorr & taproot, wondering if these sigs are processed at all?\r\n\r\nI ran this against the buidl-python code - https://github.com/buidl-bitcoin/buidl-python/pull/140 - and get the expected results. Will dig into the code when i get some time.\r\n\r\n```suggestion\r\n\r\n    // Single key p2tr BIP322 signature (created with the buidl-python library)\r\n    // PrivateKeyWIF L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k \r\n    BOOST_CHECK_EQUAL(\r\n        MessageVerify(\r\n            \"bc1ppv609nr0vr25u07u95waq5lucwfm6tde4nydujnu8npg4q75mr5sxq8lt3\",                                                                \"AUHd69PrJQEv+oKTfZ8l+WROBHuy9HKrbFCJu7U1iK2iiEy1vMU5EfMtjc+VSHM7aU0SDbak5IUZRVno2P5mjSafAQ==\",\r\n            \"Hello World\"),\r\n        MessageVerificationResult::OK);\r\n\r\n    // Same p2tr BIP322 signature as above (created with the buidl-python library)\r\n    // Signature should not verify against the message\r\n    BOOST_CHECK_EQUAL(\r\n        MessageVerify(\r\n            \"bc1ppv609nr0vr25u07u95waq5lucwfm6tde4nydujnu8npg4q75mr5sxq8lt3\",\r\n         \"AUHd69PrJQEv+oKTfZ8l+WROBHuy9HKrbFCJu7U1iK2iiEy1vMU5EfMtjc+VSHM7aU0SDbak5IUZRVno2P5mjSafAQ==\",\r\n            \"Hello World - This should fail\"),\r\n        MessageVerificationResult::ERR_INVALID);\r\n\r\n    // wrong address\r\n```",
      "commit_id" : "64ecca3f0e43b9088bf4be842a4096929724480f",
      "created_at" : "2022-07-11T18:00:44Z",
      "diff_hunk" : "@@ -2628,6 +2662,82 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+\n+    // BIP322 signature created using buidl-python library with same parameters as test on line 2596\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+         \"AkgwRQIhAOzyynlqt93lOKJr+wmmxIens//zPzl9tqIOua93wO6MAiBi5n5EyAcPScOjf1lAqIUIQtr3zKNeavYabHyR8eGhowEhAsfxIAMZZEKUPYWI4BruhAQjzFT8FSFSajuFwrDL1Yhy\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+\n+    // wrong address",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r918213210",
      "id" : 918213210,
      "line" : 2692,
      "node_id" : "PRRC_kwDOABII5842utJa",
      "original_commit_id" : "64ecca3f0e43b9088bf4be842a4096929724480f",
      "original_line" : 2692,
      "original_position" : 108,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 108,
      "pull_request_review_id" : 1034738039,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918213210/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-11T18:00:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918213210",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/18055112?v=4",
         "events_url" : "https://api.github.com/users/wip-abramson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wip-abramson/followers",
         "following_url" : "https://api.github.com/users/wip-abramson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wip-abramson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wip-abramson",
         "id" : 18055112,
         "login" : "wip-abramson",
         "node_id" : "MDQ6VXNlcjE4MDU1MTEy",
         "organizations_url" : "https://api.github.com/users/wip-abramson/orgs",
         "received_events_url" : "https://api.github.com/users/wip-abramson/received_events",
         "repos_url" : "https://api.github.com/users/wip-abramson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wip-abramson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wip-abramson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wip-abramson"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r918450389"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918450389"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks for the test! Immensely helpful. Looking into what's causing the issue now.",
      "commit_id" : "540c65adc4a1ab95723a5a4eda7029c551f152a9",
      "created_at" : "2022-07-12T00:38:10Z",
      "diff_hunk" : "@@ -2628,6 +2662,82 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+\n+    // BIP322 signature created using buidl-python library with same parameters as test on line 2596\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+         \"AkgwRQIhAOzyynlqt93lOKJr+wmmxIens//zPzl9tqIOua93wO6MAiBi5n5EyAcPScOjf1lAqIUIQtr3zKNeavYabHyR8eGhowEhAsfxIAMZZEKUPYWI4BruhAQjzFT8FSFSajuFwrDL1Yhy\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+\n+    // wrong address",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r918450389",
      "id" : 918450389,
      "in_reply_to_id" : 918213210,
      "line" : 2745,
      "node_id" : "PRRC_kwDOABII5842vnDV",
      "original_commit_id" : "64ecca3f0e43b9088bf4be842a4096929724480f",
      "original_line" : 2745,
      "original_position" : 108,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 149,
      "pull_request_review_id" : 1035083725,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918450389/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-12T00:38:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918450389",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Tested for Legacy, P2SH-SegWit, SegWit, and Taproot. (commit [64ecca3](https://github.com/bitcoin/bitcoin/commit/64ecca3f0e43b9088bf4be842a4096929724480f))\r\n[..]\r\n> Except for Taproot addresses, which for some reason when the message is malformed, still results in `true`\r\n\r\nThanks a lot for testing! Looking into taproot issues.",
      "created_at" : "2022-07-12T00:39:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1181186552",
      "id" : 1181186552,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585GZ3n4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181186552/reactions"
      },
      "updated_at" : "2022-07-12T00:39:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181186552",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r918451932"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918451932"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Committed.",
      "commit_id" : "540c65adc4a1ab95723a5a4eda7029c551f152a9",
      "created_at" : "2022-07-12T00:42:38Z",
      "diff_hunk" : "@@ -2628,6 +2662,82 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+\n+    // BIP322 signature created using buidl-python library with same parameters as test on line 2596\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+         \"AkgwRQIhAOzyynlqt93lOKJr+wmmxIens//zPzl9tqIOua93wO6MAiBi5n5EyAcPScOjf1lAqIUIQtr3zKNeavYabHyR8eGhowEhAsfxIAMZZEKUPYWI4BruhAQjzFT8FSFSajuFwrDL1Yhy\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r918451932",
      "id" : 918451932,
      "in_reply_to_id" : 916736808,
      "line" : 2703,
      "node_id" : "PRRC_kwDOABII5842vnbc",
      "original_commit_id" : "64ecca3f0e43b9088bf4be842a4096929724480f",
      "original_line" : 2703,
      "original_position" : 107,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 107,
      "pull_request_review_id" : 1035085606,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918451932/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-12T00:42:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918451932",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I'm not sure if you're suggesting a BIP change or a code feature.\r\n\r\nThis is a BIP incompleteness thing that should be addressed before any implementation is considered for merging. The BIP gives a technical way to \"sign a message\", without defining what the signature actually *means*.\r\n\r\nCurrent signed messages only mean \"the message is from whoever receives/d coins that are/were sent to this address\". Yet there's relatively little correct use of it. Instead, people seem to want things like proof-of-funds and proof-of-sending, which are fundamentally different in nature (eg, not associated with an address). The BIP should define each of these use cases distinctly, so they can't be misrepresented as the wrong kind of proof.",
      "created_at" : "2022-07-12T03:10:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1181264376",
      "id" : 1181264376,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585GaKn4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181264376/reactions"
      },
      "updated_at" : "2022-07-12T03:10:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181264376",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The `SCRIPT_VERIFY_TAPROOT` flag was not added to the required flags, resulting in taproot checks being auto-successes. Fixed, thanks for the help!\r\n\r\nEdit: thinking about this, this is not how BIP-322 is meant to behave when it encounters unknown opcodes and such; the \"inconclusive\" middle state is meant to address exactly this, and not just throw a \"true\" out blindly. Annoying.\r\n\r\nEdit 2: this ends up being a silly special case for taproot, but it's worth taking note of as we may have the same issues in future versions as we upgrade the BIP322_REQUIRED_FLAGS vs BIP322_INCONCLUSIVE_FLAGS. The inconclusive flags checks for upgraded taproot versions and such, which current taproot is *not*, whereas the required flags neglected to include the current taproot.",
      "created_at" : "2022-07-12T03:18:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1181268285",
      "id" : 1181268285,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585GaLk9",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181268285/reactions"
      },
      "updated_at" : "2022-07-12T03:28:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181268285",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> This is a BIP incompleteness thing that should be addressed before any implementation is considered for merging. The BIP gives a technical way to \"sign a message\", without defining what the signature actually _means_.\r\n\r\nThe motivation is quite clear on what it means, IMO:\r\n\r\n> Ultimately no message signing protocol can actually prove control of funds, both because a signature is obsolete as soon as it is created, and because the possessor of a secret key may be willing to sign messages on others' behalf even if it would not sign actual transactions. No signmessage protocol can fix these limitations.\r\n\r\nIf you have suggestions on improvements to make, please make a pull request to the BIP repository.",
      "created_at" : "2022-07-12T03:32:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1181274882",
      "id" : 1181274882,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585GaNMC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181274882/reactions"
      },
      "updated_at" : "2022-07-12T03:32:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181274882",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Right now its:\r\n\r\n`signmessage \"address\" \"message\"` -> signature\r\n`verifymessage \"address\" \"signature\" \"message\"` -> true/false\r\n\r\nWould it not be clearer to have the `verifymessage` command take the arguments this way:\r\n`verifymessage \"address\" \"message\" \"signature\"` -> true/false",
      "created_at" : "2022-07-12T06:03:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1181350722",
      "id" : 1181350722,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585GaftC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181350722/reactions"
      },
      "updated_at" : "2022-07-12T06:03:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181350722",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/24482484?v=4",
         "events_url" : "https://api.github.com/users/Rspigler/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Rspigler/followers",
         "following_url" : "https://api.github.com/users/Rspigler/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Rspigler/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Rspigler",
         "id" : 24482484,
         "login" : "Rspigler",
         "node_id" : "MDQ6VXNlcjI0NDgyNDg0",
         "organizations_url" : "https://api.github.com/users/Rspigler/orgs",
         "received_events_url" : "https://api.github.com/users/Rspigler/received_events",
         "repos_url" : "https://api.github.com/users/Rspigler/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Rspigler/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Rspigler/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Rspigler"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-07-12T16:19:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1181976962",
      "id" : 1181976962,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585Gc4mC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181976962/reactions"
      },
      "updated_at" : "2022-07-12T16:19:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181976962",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> This is a BIP incompleteness thing that should be addressed before any implementation is considered for merging. The BIP gives a technical way to \"sign a message\", without defining what the signature actually _means_.\r\n\r\nThis is not a problem specific to BIP-322. It's generally handled at another layer. For example, in Linked Data Signatures, a ProofPurpose is used to clarify why that particular proof is generated. For Verifiable Credentials, that proof purpose must be an attestationMethod, which means the signature was created as an attestation by the signer to the veracity of the signed document. \r\n\r\nIn contrast, zCaps, a capability mechanism that uses LinkedData signatures uses the two proof purposes of CapabilityInvocation and CapabilityDelegation to indicate the meaning of different signatures. The former to indicate that the signature means to \"do\" the action that is invoked, the latter that the signature means the previous controller is delegating to someone else (and not, at this time, invoking anything).\r\n\r\nIn all cases, the proof that is verified is cryptographic, and BIP-322 can provide that verifiable proof, while the proof-purpose is part of the signed payload yet exogenous to the signing itself.\r\n\r\nFWIW, @wip-abramson and I are working on mapping BIP-322 to Verifiable Credentials. I'm not sure if he's shared that work with this conversation, but it is a good example of how you can generalize BIP-322 signatures for specific use cases.",
      "created_at" : "2022-07-12T22:42:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1182565767",
      "id" : 1182565767,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585GfIWH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1182565767/reactions"
      },
      "updated_at" : "2022-07-12T22:42:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1182565767",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/186831?v=4",
         "events_url" : "https://api.github.com/users/jandrieu/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jandrieu/followers",
         "following_url" : "https://api.github.com/users/jandrieu/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jandrieu/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jandrieu",
         "id" : 186831,
         "login" : "jandrieu",
         "node_id" : "MDQ6VXNlcjE4NjgzMQ==",
         "organizations_url" : "https://api.github.com/users/jandrieu/orgs",
         "received_events_url" : "https://api.github.com/users/jandrieu/received_events",
         "repos_url" : "https://api.github.com/users/jandrieu/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jandrieu/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jandrieu/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jandrieu"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">This is not a problem specific to BIP-322. It's generally handled at another layer.\r\n\r\nIt can't be. It's a different person signing in each scenario.\r\n\r\nProof-of-funds can be anyone who _could_ spend the UTXOs. Proof-of-sender can only be the actual person who _did_ send a given transaction. Proof-of-address can only be the person who received or would receive funds sent to an address. These can all be distinct entities, so the signature itself must specify which it is testifying to.\r\n\r\nThe existing `signmessage` standard/RPC is only capable of proof-of-address, and cannot prove funds or senders.\r\n",
      "created_at" : "2022-07-12T23:06:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1182583236",
      "id" : 1182583236,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585GfMnE",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1182583236/reactions"
      },
      "updated_at" : "2022-07-12T23:06:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1182583236",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> > This is not a problem specific to BIP-322. It's generally handled at another layer.\r\n> \r\n> It can't be. It's a different person signing in each scenario.\r\n\r\nI'm not sure what you mean, but that would seem to support my point that a signature itself does not describe why the signature was made.\r\n\r\n> Proof-of-funds can be anyone who _could_ spend the UTXOs. Proof-of-sender can only be the actual person who _did_ send a given transaction. Proof-of-address can only be the person who received or would receive funds sent to an address. These can all be distinct entities, so the signature itself must specify which it is testifying to.\r\n> \r\n> The existing `signmessage` standard/RPC is only capable of proof-of-address, and cannot prove funds or senders.\r\n\r\nI see, perhaps your complaint is with the language at https://github.com/bitcoin/bips/blob/master/bip-0322.mediawiki#full-proof-of-funds that \"full\" signatures can be used to demonstrate proof-of-funds?\r\n\r\nOn that, I agree. You can apply BIP-322 to get a contributing factor for proof-of-funds, but BIP-322 itself does not establish that. \r\n\r\nAll it can establish is that the given cryptographic puzzle of a specific script is satisfied with respect to a given message. \r\n\r\nWhether or not you treat that valid signature as proof-of-funds or not is at a different layer. At a minimum, you would need to apply the logic that each of the gathered UTXOs is, in fact, still unspent. You will also need to decide if the solved puzzle should be interpreted as proof of funds for your use case, given that BIP-322 does not lock the funds.\r\n\r\nIf I've understood your point: that BIP-322 does not establish proof of funds, that would be a good candidate for an issue at https://github.com/bitcoin/bips/blob/master/bip-0322.mediawiki",
      "created_at" : "2022-07-13T15:24:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1183364373",
      "id" : 1183364373,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585GiLUV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1183364373/reactions"
      },
      "updated_at" : "2022-07-13T15:24:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1183364373",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/186831?v=4",
         "events_url" : "https://api.github.com/users/jandrieu/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jandrieu/followers",
         "following_url" : "https://api.github.com/users/jandrieu/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jandrieu/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jandrieu",
         "id" : 186831,
         "login" : "jandrieu",
         "node_id" : "MDQ6VXNlcjE4NjgzMQ==",
         "organizations_url" : "https://api.github.com/users/jandrieu/orgs",
         "received_events_url" : "https://api.github.com/users/jandrieu/received_events",
         "repos_url" : "https://api.github.com/users/jandrieu/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jandrieu/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jandrieu/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jandrieu"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@Rspigler \r\n\r\n> Would it not be clearer to have the `verifymessage` command take the arguments this way: `verifymessage \"address\" \"message\" \"signature\"` -> true/false\r\n\r\nIt would, but unfortunately this order was set long before this pull request was created, and who knows what systems out there are depending on the order being what it is today. It may be worth it to do some simple analysis on the arguments, and swap them automatically based on which of \"message\" and \"signature\" looks like a signature, but I don't know if that would be appreciated, as it's quite an unusual thing to do, at least in this code base.\r\n",
      "created_at" : "2022-07-14T03:59:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1183958953",
      "id" : 1183958953,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585Gkcep",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1183958953/reactions"
      },
      "updated_at" : "2022-07-14T03:59:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1183958953",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-07-22T07:55:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1192292402",
      "id" : 1192292402,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585HEPAy",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1192292402/reactions"
      },
      "updated_at" : "2022-07-22T07:55:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1192292402",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929213680"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929213680"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 85ed08c22ca51ed4b9d8de0a402280b9401811af \"message: add BIP-322 support to MessageHash function\"\r\n\r\n`HASHER_BIP322` is not defined in this commit.",
      "commit_id" : "e100fed327a0bd3ce11a882782c6cce3487fb28a",
      "created_at" : "2022-07-25T19:12:28Z",
      "diff_hunk" : "@@ -72,12 +72,28 @@ bool MessageSign(\n     return true;\n }\n \n-uint256 MessageHash(const std::string& message)\n+uint256 MessageHash(const std::string& message, MessageSignatureFormat format)\n {\n-    CHashWriter hasher(SER_GETHASH, 0);\n-    hasher << MESSAGE_MAGIC << message;\n-\n-    return hasher.GetHash();\n+    switch (format) {\n+    case MessageSignatureFormat::LEGACY:\n+        {\n+            CHashWriter hasher(SER_GETHASH, 0);\n+            hasher << MESSAGE_MAGIC << message;\n+\n+            return hasher.GetHash();\n+        }\n+\n+    case MessageSignatureFormat::SIMPLE:\n+    case MessageSignatureFormat::FULL:\n+        {\n+            CHashWriter hasher(HASHER_BIP322);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929213680",
      "id" : 929213680,
      "line" : 156,
      "node_id" : "PRRC_kwDOABII5843Yqzw",
      "original_commit_id" : "85ed08c22ca51ed4b9d8de0a402280b9401811af",
      "original_line" : 89,
      "original_position" : 32,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 32,
      "pull_request_review_id" : 1049939798,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929213680/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-25T20:36:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929213680",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929218874"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929218874"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 5bc21371947340a35039cb9ce95571b45bc535a4 \"message: add BIP322Txs class for preparing BIP-322 transactions\"\r\n\r\n`MessageVerificationResult::ERR_POF` is not defined in this commit.",
      "commit_id" : "e100fed327a0bd3ce11a882782c6cce3487fb28a",
      "created_at" : "2022-07-25T19:19:25Z",
      "diff_hunk" : "@@ -109,3 +109,65 @@ std::string SigningResultString(const SigningResult res)\n     }\n     assert(false);\n }\n+\n+std::optional<BIP322Txs> BIP322Txs::Create(const CTxDestination& destination, const std::string& message, MessageVerificationResult& result, const std::vector<unsigned char>* signature)\n+{\n+    // attempt to get script pub key for destination\n+    CScript message_challenge = GetScriptForDestination(destination);\n+    if (message_challenge.size() == 0) {\n+        // NoDestination; failure\n+        // (use legacy result)\n+        return std::nullopt;\n+    }\n+\n+    // prepare message hash\n+    uint256 message_hash = MessageHash(message, MessageSignatureFormat::SIMPLE);\n+    std::vector<unsigned char> message_hash_vec(message_hash.begin(), message_hash.end());\n+\n+    // generate to_spend transaction\n+    CMutableTransaction to_spend;\n+    to_spend.nVersion = 0;\n+    to_spend.nLockTime = 0;\n+    to_spend.vin.emplace_back(COutPoint(uint256::ZERO, 0xFFFFFFFF), (CScript() << OP_0 << message_hash_vec), 0);\n+    to_spend.vout.emplace_back(0, message_challenge);\n+\n+    CMutableTransaction to_sign;\n+    if (signature && DecodeTx(to_sign, *signature, /* try_no_witness */ true, /* try_witness */ true)) {\n+        // validate decoded transaction\n+        // multiple inputs (proof of funds) are not supported as we do not have UTXO set access\n+        if (to_sign.vin.size() > 1) {\n+            result = MessageVerificationResult::ERR_POF;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929218874",
      "id" : 929218874,
      "line" : 206,
      "node_id" : "PRRC_kwDOABII5843YsE6",
      "original_commit_id" : "5bc21371947340a35039cb9ce95571b45bc535a4",
      "original_line" : 139,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 31,
      "pull_request_review_id" : 1049939798,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929218874/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-25T20:36:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929218874",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929219393"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929219393"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 5bc21371947340a35039cb9ce95571b45bc535a4 \"message: add BIP322Txs class for preparing BIP-322 transactions\"\r\n\r\nMissing an `#include <core_io.h>` for `DecodeTx`.",
      "commit_id" : "e100fed327a0bd3ce11a882782c6cce3487fb28a",
      "created_at" : "2022-07-25T19:20:06Z",
      "diff_hunk" : "@@ -109,3 +109,65 @@ std::string SigningResultString(const SigningResult res)\n     }\n     assert(false);\n }\n+\n+std::optional<BIP322Txs> BIP322Txs::Create(const CTxDestination& destination, const std::string& message, MessageVerificationResult& result, const std::vector<unsigned char>* signature)\n+{\n+    // attempt to get script pub key for destination\n+    CScript message_challenge = GetScriptForDestination(destination);\n+    if (message_challenge.size() == 0) {\n+        // NoDestination; failure\n+        // (use legacy result)\n+        return std::nullopt;\n+    }\n+\n+    // prepare message hash\n+    uint256 message_hash = MessageHash(message, MessageSignatureFormat::SIMPLE);\n+    std::vector<unsigned char> message_hash_vec(message_hash.begin(), message_hash.end());\n+\n+    // generate to_spend transaction\n+    CMutableTransaction to_spend;\n+    to_spend.nVersion = 0;\n+    to_spend.nLockTime = 0;\n+    to_spend.vin.emplace_back(COutPoint(uint256::ZERO, 0xFFFFFFFF), (CScript() << OP_0 << message_hash_vec), 0);\n+    to_spend.vout.emplace_back(0, message_challenge);\n+\n+    CMutableTransaction to_sign;\n+    if (signature && DecodeTx(to_sign, *signature, /* try_no_witness */ true, /* try_witness */ true)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929219393",
      "id" : 929219393,
      "line" : 202,
      "node_id" : "PRRC_kwDOABII5843YsNB",
      "original_commit_id" : "5bc21371947340a35039cb9ce95571b45bc535a4",
      "original_line" : 135,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 27,
      "pull_request_review_id" : 1049939798,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929219393/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-25T20:36:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929219393",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929219576"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929219576"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 5bc21371947340a35039cb9ce95571b45bc535a4 \"message: add BIP322Txs class for preparing BIP-322 transactions\"\r\n\r\n`MessageVerificationResult::ERR_INVALID` is not defined in this commit.",
      "commit_id" : "e100fed327a0bd3ce11a882782c6cce3487fb28a",
      "created_at" : "2022-07-25T19:20:23Z",
      "diff_hunk" : "@@ -109,3 +109,65 @@ std::string SigningResultString(const SigningResult res)\n     }\n     assert(false);\n }\n+\n+std::optional<BIP322Txs> BIP322Txs::Create(const CTxDestination& destination, const std::string& message, MessageVerificationResult& result, const std::vector<unsigned char>* signature)\n+{\n+    // attempt to get script pub key for destination\n+    CScript message_challenge = GetScriptForDestination(destination);\n+    if (message_challenge.size() == 0) {\n+        // NoDestination; failure\n+        // (use legacy result)\n+        return std::nullopt;\n+    }\n+\n+    // prepare message hash\n+    uint256 message_hash = MessageHash(message, MessageSignatureFormat::SIMPLE);\n+    std::vector<unsigned char> message_hash_vec(message_hash.begin(), message_hash.end());\n+\n+    // generate to_spend transaction\n+    CMutableTransaction to_spend;\n+    to_spend.nVersion = 0;\n+    to_spend.nLockTime = 0;\n+    to_spend.vin.emplace_back(COutPoint(uint256::ZERO, 0xFFFFFFFF), (CScript() << OP_0 << message_hash_vec), 0);\n+    to_spend.vout.emplace_back(0, message_challenge);\n+\n+    CMutableTransaction to_sign;\n+    if (signature && DecodeTx(to_sign, *signature, /* try_no_witness */ true, /* try_witness */ true)) {\n+        // validate decoded transaction\n+        // multiple inputs (proof of funds) are not supported as we do not have UTXO set access\n+        if (to_sign.vin.size() > 1) {\n+            result = MessageVerificationResult::ERR_POF;\n+            return std::nullopt;\n+        }\n+        if ((to_sign.vin.size() == 0 || to_sign.vin[0].prevout.hash != to_spend.GetHash()) ||\n+            (to_sign.vin[0].prevout.n != 0) ||\n+            (to_sign.vout.size() != 1) ||\n+            (to_sign.vout[0].nValue != 0) ||\n+            (to_sign.vout[0].scriptPubKey != (CScript() << OP_RETURN))) {\n+            result = MessageVerificationResult::ERR_INVALID;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929219576",
      "id" : 929219576,
      "line" : 214,
      "node_id" : "PRRC_kwDOABII5843YsP4",
      "original_commit_id" : "5bc21371947340a35039cb9ce95571b45bc535a4",
      "original_line" : 147,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 39,
      "pull_request_review_id" : 1049939798,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929219576/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-25T20:36:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929219576",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929220167"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929220167"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 5bc21371947340a35039cb9ce95571b45bc535a4 \"message: add BIP322Txs class for preparing BIP-322 transactions\"\r\n\r\nI don't like using pointers as essentially an optional. It should just be a `std::optional` with a default value of `std::nullopt`.",
      "commit_id" : "e100fed327a0bd3ce11a882782c6cce3487fb28a",
      "created_at" : "2022-07-25T19:21:13Z",
      "diff_hunk" : "@@ -85,4 +85,18 @@ uint256 MessageHash(const std::string& message, MessageSignatureFormat format);\n \n std::string SigningResultString(const SigningResult res);\n \n+/**\n+ * Generate the BIP-322 tx corresponding to the given challenge\n+ */\n+class BIP322Txs {\n+    template<class T1, class T2>\n+    BIP322Txs(const T1& to_spend, const T2& to_sign) : m_to_spend{to_spend}, m_to_sign{to_sign} { }\n+\n+public:\n+    static std::optional<BIP322Txs> Create(const CTxDestination& destination, const std::string& message, MessageVerificationResult& result, const std::vector<unsigned char>* signature = nullptr);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929220167",
      "id" : 929220167,
      "line" : 112,
      "node_id" : "PRRC_kwDOABII5843YsZH",
      "original_commit_id" : "5bc21371947340a35039cb9ce95571b45bc535a4",
      "original_line" : 96,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/util/message.h",
      "position" : 12,
      "pull_request_review_id" : 1049939798,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929220167/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-25T20:36:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929220167",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929222834"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929222834"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 30642a185971555ea68bd5b80f87d633ddd09593 \"message: add BIP-322 verification support (without POF)\"\r\n\r\nThis could just fallthrough to the `return false` below instead of having it's own `return false`.",
      "commit_id" : "e100fed327a0bd3ce11a882782c6cce3487fb28a",
      "created_at" : "2022-07-25T19:24:49Z",
      "diff_hunk" : "@@ -49,9 +49,16 @@ static RPCHelpMan verifymessage()\n                 throw JSONRPCError(RPC_TYPE_ERROR, \"Address does not refer to key\");\n             case MessageVerificationResult::ERR_MALFORMED_SIGNATURE:\n                 throw JSONRPCError(RPC_TYPE_ERROR, \"Malformed base64 encoding\");\n+            case MessageVerificationResult::ERR_POF:\n+                throw JSONRPCError(RPC_TYPE_ERROR, \"BIP-322 Proof of funds is not yet supported\"); // TODO: get access to UTXO set / mempool to handle this, then remove this error code?\n+            case MessageVerificationResult::INCONCLUSIVE:\n+                return false; // TODO: switch to a string based result? mix bool and strings?",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929222834",
      "id" : 929222834,
      "line" : 55,
      "node_id" : "PRRC_kwDOABII5843YtCy",
      "original_commit_id" : "30642a185971555ea68bd5b80f87d633ddd09593",
      "original_line" : 55,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/rpc/signmessage.cpp",
      "position" : 7,
      "pull_request_review_id" : 1049939798,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929222834/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-25T20:36:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929222834",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929229553"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929229553"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 5bc21371947340a35039cb9ce95571b45bc535a4 \"message: add BIP322Txs class for preparing BIP-322 transactions\"\r\n\r\nSince both BIP 322 and BIP 325 have very similar transaction construction functions, what do you think about de-deduplicating and having `SignetTxs::Create` call this function? It would require a minor tweak to this function to take a vector of bytes to push onto `to_spend`'s input's scriptSig.",
      "commit_id" : "e100fed327a0bd3ce11a882782c6cce3487fb28a",
      "created_at" : "2022-07-25T19:33:33Z",
      "diff_hunk" : "@@ -109,3 +109,65 @@ std::string SigningResultString(const SigningResult res)\n     }\n     assert(false);\n }\n+\n+std::optional<BIP322Txs> BIP322Txs::Create(const CTxDestination& destination, const std::string& message, MessageVerificationResult& result, const std::vector<unsigned char>* signature)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929229553",
      "id" : 929229553,
      "line" : 180,
      "node_id" : "PRRC_kwDOABII5843Yurx",
      "original_commit_id" : "5bc21371947340a35039cb9ce95571b45bc535a4",
      "original_line" : 113,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 5,
      "pull_request_review_id" : 1049939798,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929229553/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-25T20:36:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929229553",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929241233"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929241233"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 62f307f442050b1149fb326efcd5d76252787f19 \"script: add 'require_sighash_all' flag to signature checker\"\r\n\r\nI think it would be better to have this in the constructor rather than a separate setter function.",
      "commit_id" : "e100fed327a0bd3ce11a882782c6cce3487fb28a",
      "created_at" : "2022-07-25T19:49:03Z",
      "diff_hunk" : "@@ -299,6 +300,7 @@ class GenericTransactionSignatureChecker : public BaseSignatureChecker\n     bool CheckSchnorrSignature(Span<const unsigned char> sig, Span<const unsigned char> pubkey, SigVersion sigversion, ScriptExecutionData& execdata, ScriptError* serror = nullptr) const override;\n     bool CheckLockTime(const CScriptNum& nLockTime) const override;\n     bool CheckSequence(const CScriptNum& nSequence) const override;\n+    void RequireSighashAll() { m_require_sighash_all = true; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929241233",
      "id" : 929241233,
      "line" : 303,
      "node_id" : "PRRC_kwDOABII5843YxiR",
      "original_commit_id" : "62f307f442050b1149fb326efcd5d76252787f19",
      "original_line" : 303,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/script/interpreter.h",
      "position" : 12,
      "pull_request_review_id" : 1049939798,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929241233/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-25T20:36:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929241233",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929241716"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929241716"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 5bc21371947340a35039cb9ce95571b45bc535a4 \"message: add BIP322Txs class for preparing BIP-322 transactions\"\r\n\r\nI don't see why this needs to be templated?",
      "commit_id" : "e100fed327a0bd3ce11a882782c6cce3487fb28a",
      "created_at" : "2022-07-25T19:49:42Z",
      "diff_hunk" : "@@ -85,4 +85,18 @@ uint256 MessageHash(const std::string& message, MessageSignatureFormat format);\n \n std::string SigningResultString(const SigningResult res);\n \n+/**\n+ * Generate the BIP-322 tx corresponding to the given challenge\n+ */\n+class BIP322Txs {\n+    template<class T1, class T2>\n+    BIP322Txs(const T1& to_spend, const T2& to_sign) : m_to_spend{to_spend}, m_to_sign{to_sign} { }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929241716",
      "id" : 929241716,
      "line" : 109,
      "node_id" : "PRRC_kwDOABII5843Yxp0",
      "original_commit_id" : "5bc21371947340a35039cb9ce95571b45bc535a4",
      "original_line" : 93,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/util/message.h",
      "position" : 9,
      "pull_request_review_id" : 1049939798,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929241716/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-25T20:36:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929241716",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929257453"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929257453"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 8f9c561c7b0887b98ce5a6670428fdeb1590deb1 \"add basic BIP-322 message signing support\"\r\n\r\nMissing `QString(\"</nobr>\"`.",
      "commit_id" : "e100fed327a0bd3ce11a882782c6cce3487fb28a",
      "created_at" : "2022-07-25T20:10:45Z",
      "diff_hunk" : "@@ -214,6 +207,27 @@ void SignVerifyMessageDialog::on_verifyMessageButton_VM_clicked()\n             QString(\"<nobr>\") + tr(\"Message verified.\") + QString(\"</nobr>\")\n         );\n         return;\n+    case MessageVerificationResult::OK_TIMELOCKED:\n+        ui->statusLabel_VM->setText(\n+            QString(\"<nobr>\") + tr(\"Message verified, but includes timelocks.\") + QString(\"</nobr>\")\n+        );\n+        return;\n+    case MessageVerificationResult::INCONCLUSIVE:\n+        ui->statusLabel_VM->setText(\n+            QString(\"<nobr>\") + tr(\"Inconclusive.\") + QString(\"</nobr>\")\n+        );\n+        return;\n+    case MessageVerificationResult::ERR_INVALID:\n+        ui->statusLabel_VM->setText(\n+            tr(\"Some check failed.\")\n+        );\n+        return;\n+    case MessageVerificationResult::ERR_POF:\n+        // TODO: support proof of funds verifications\n+        ui->statusLabel_VM->setText(\n+            tr(\"Proof of funds verification unavailable right now.\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929257453",
      "id" : 929257453,
      "line" : 228,
      "node_id" : "PRRC_kwDOABII5843Y1ft",
      "original_commit_id" : "8f9c561c7b0887b98ce5a6670428fdeb1590deb1",
      "original_line" : 228,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/qt/signverifymessagedialog.cpp",
      "position" : 45,
      "pull_request_review_id" : 1049939798,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929257453/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-25T20:36:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929257453",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929258011"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929258011"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 8f9c561c7b0887b98ce5a6670428fdeb1590deb1 \"add basic BIP-322 message signing support\"\r\n\r\nI think this should just be `Message verification failed`. It could passthrough to the `ERR_NOT_SIGNED` result.",
      "commit_id" : "e100fed327a0bd3ce11a882782c6cce3487fb28a",
      "created_at" : "2022-07-25T20:11:28Z",
      "diff_hunk" : "@@ -214,6 +207,27 @@ void SignVerifyMessageDialog::on_verifyMessageButton_VM_clicked()\n             QString(\"<nobr>\") + tr(\"Message verified.\") + QString(\"</nobr>\")\n         );\n         return;\n+    case MessageVerificationResult::OK_TIMELOCKED:\n+        ui->statusLabel_VM->setText(\n+            QString(\"<nobr>\") + tr(\"Message verified, but includes timelocks.\") + QString(\"</nobr>\")\n+        );\n+        return;\n+    case MessageVerificationResult::INCONCLUSIVE:\n+        ui->statusLabel_VM->setText(\n+            QString(\"<nobr>\") + tr(\"Inconclusive.\") + QString(\"</nobr>\")\n+        );\n+        return;\n+    case MessageVerificationResult::ERR_INVALID:\n+        ui->statusLabel_VM->setText(\n+            tr(\"Some check failed.\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929258011",
      "id" : 929258011,
      "line" : 222,
      "node_id" : "PRRC_kwDOABII5843Y1ob",
      "original_commit_id" : "8f9c561c7b0887b98ce5a6670428fdeb1590deb1",
      "original_line" : 222,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/qt/signverifymessagedialog.cpp",
      "position" : 39,
      "pull_request_review_id" : 1049939798,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929258011/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-25T20:36:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929258011",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929265232"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929265232"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In e100fed327a0bd3ce11a882782c6cce3487fb28a \"fix: add missing SCRIPT_VERIFY_TAPROOT to BIP322_REQUIRED_FLAGS\"\r\n\r\nCould be squashed into 30642a185971555ea68bd5b80f87d633ddd09593 \"message: add BIP-322 verification support (without POF)\"",
      "commit_id" : "e100fed327a0bd3ce11a882782c6cce3487fb28a",
      "created_at" : "2022-07-25T20:21:24Z",
      "diff_hunk" : "@@ -40,6 +40,7 @@ static constexpr unsigned int BIP322_REQUIRED_FLAGS =\n |   SCRIPT_VERIFY_CLEANSTACK\n |   SCRIPT_VERIFY_P2SH\n |   SCRIPT_VERIFY_WITNESS\n+|   SCRIPT_VERIFY_TAPROOT",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929265232",
      "id" : 929265232,
      "line" : 43,
      "node_id" : "PRRC_kwDOABII5843Y3ZQ",
      "original_commit_id" : "e100fed327a0bd3ce11a882782c6cce3487fb28a",
      "original_line" : 43,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 4,
      "pull_request_review_id" : 1049939798,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929265232/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-25T20:36:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929265232",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929267071"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929267071"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In f0747683eb73f2052b9ef18b8246e81411c30e20 \"wallet: add SignMessageBIP322() helper method to ScriptPubKeyMan\"\r\n\r\nThis could be an assert. It should not be possible to reach this point without having a valid destination, and as we do not provide a signature argument, `Create` should never fail.",
      "commit_id" : "e100fed327a0bd3ce11a882782c6cce3487fb28a",
      "created_at" : "2022-07-25T20:23:14Z",
      "diff_hunk" : "@@ -208,6 +208,47 @@ IsMineResult IsMineInner(const LegacyScriptPubKeyMan& keystore, const CScript& s\n \n } // namespace\n \n+SigningResult ScriptPubKeyMan::SignMessageBIP322(MessageSignatureFormat format, const SigningProvider* keystore, const std::string& message, const CTxDestination& address, std::string& str_sig) const\n+{\n+    assert(format != MessageSignatureFormat::LEGACY);\n+\n+    MessageVerificationResult result; // unused\n+    auto txs = BIP322Txs::Create(address, message, result);\n+    if (!txs) return SigningResult::PRIVATE_KEY_NOT_AVAILABLE;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929267071",
      "id" : 929267071,
      "line" : 217,
      "node_id" : "PRRC_kwDOABII5843Y31_",
      "original_commit_id" : "f0747683eb73f2052b9ef18b8246e81411c30e20",
      "original_line" : 217,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/wallet/scriptpubkeyman.cpp",
      "position" : 10,
      "pull_request_review_id" : 1049939798,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929267071/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-25T20:36:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929267071",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929276750"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929276750"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 30642a185971555ea68bd5b80f87d633ddd09593 \"message: add BIP-322 verification support (without POF)\"\r\n\r\nThis is unnecessary and will always fail.\r\n\r\nBy the time we reach this line, the destination must be `PKHash` and we must have been able to recover a pubkey from the signature, which means that the signature must have been 65 bytes, otherwise `RecoverCompact` will have failed. However, a BIP322 signature for `PKHash` must be greater than 65 bytes because it will include a full transaction for the p2pkh address. So if we do reach this line, the signature is just invalid and there's no need to attempt a `MessageVerifyBIP322`.",
      "commit_id" : "e100fed327a0bd3ce11a882782c6cce3487fb28a",
      "created_at" : "2022-07-25T20:36:06Z",
      "diff_hunk" : "@@ -25,32 +26,97 @@\n  */\n const std::string MESSAGE_MAGIC = \"Bitcoin Signed Message:\\n\";\n \n+/**\n+ * BIP-322 tagged hash\n+ */\n+const CHashWriter HASHER_BIP322 = TaggedHash(\"BIP0322-signed-message\");\n+\n+static constexpr unsigned int BIP322_REQUIRED_FLAGS =\n+    SCRIPT_VERIFY_CONST_SCRIPTCODE // disallows OP_CODESEPARATOR and FindAndDelete\n+|   SCRIPT_VERIFY_LOW_S\n+|   SCRIPT_VERIFY_STRICTENC\n+|   SCRIPT_VERIFY_NULLFAIL\n+|   SCRIPT_VERIFY_MINIMALDATA\n+|   SCRIPT_VERIFY_CLEANSTACK\n+|   SCRIPT_VERIFY_P2SH\n+|   SCRIPT_VERIFY_WITNESS\n+|   SCRIPT_VERIFY_MINIMALIF;\n+\n+static constexpr unsigned int BIP322_INCONCLUSIVE_FLAGS =\n+    SCRIPT_VERIFY_DISCOURAGE_OP_SUCCESS\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_PUBKEYTYPE\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_TAPROOT_VERSION\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM;\n+\n+MessageVerificationResult MessageVerifyBIP322(\n+    CTxDestination& destination,\n+    std::vector<unsigned char>& signature,\n+    const std::string& message,\n+    MessageVerificationResult legacyError)\n+{\n+    auto txs = BIP322Txs::Create(destination, message, legacyError, &signature);\n+    if (!txs) return legacyError;\n+\n+    const CTransaction& to_sign = txs->m_to_sign;\n+    const CTransaction& to_spend = txs->m_to_spend;\n+\n+    const CScript scriptSig = to_sign.vin[0].scriptSig;\n+    const CScriptWitness& witness = to_sign.vin[0].scriptWitness;\n+\n+    PrecomputedTransactionData txdata;\n+    txdata.Init(to_sign, {to_spend.vout[0]});\n+    TransactionSignatureChecker sigcheck(&to_sign, /* nInIn= */ 0, /* amountIn= */ to_spend.vout[0].nValue, txdata, MissingDataBehavior::ASSERT_FAIL);\n+    sigcheck.RequireSighashAll();\n+\n+    if (!VerifyScript(scriptSig, to_spend.vout[0].scriptPubKey, &witness, BIP322_REQUIRED_FLAGS, sigcheck)) {\n+        return MessageVerificationResult::ERR_INVALID;\n+    }\n+\n+    // inconclusive checks\n+\n+    if (to_sign.nVersion != 0 && to_sign.nVersion != 2) {\n+        return MessageVerificationResult::INCONCLUSIVE;\n+    }\n+\n+    if (!VerifyScript(scriptSig, to_spend.vout[0].scriptPubKey, &witness, BIP322_INCONCLUSIVE_FLAGS, sigcheck)) {\n+        return MessageVerificationResult::INCONCLUSIVE;\n+    }\n+\n+    // timelock check\n+    if (to_sign.nLockTime > 0 || to_sign.vin[0].nSequence > 0) {\n+        return MessageVerificationResult::OK_TIMELOCKED;\n+    }\n+\n+    return MessageVerificationResult::OK;\n+}\n+\n MessageVerificationResult MessageVerify(\n     const std::string& address,\n     const std::string& signature,\n     const std::string& message)\n {\n+    auto signature_bytes = DecodeBase64(signature.c_str());\n+    if (!signature_bytes) {\n+        return MessageVerificationResult::ERR_MALFORMED_SIGNATURE;\n+    }\n+\n     CTxDestination destination = DecodeDestination(address);\n     if (!IsValidDestination(destination)) {\n         return MessageVerificationResult::ERR_INVALID_ADDRESS;\n     }\n \n     if (std::get_if<PKHash>(&destination) == nullptr) {\n-        return MessageVerificationResult::ERR_ADDRESS_NO_KEY;\n-    }\n-\n-    auto signature_bytes = DecodeBase64(signature);\n-    if (!signature_bytes) {\n-        return MessageVerificationResult::ERR_MALFORMED_SIGNATURE;\n+        return MessageVerifyBIP322(destination, *signature_bytes, message, MessageVerificationResult::ERR_ADDRESS_NO_KEY);\n     }\n \n     CPubKey pubkey;\n-    if (!pubkey.RecoverCompact(MessageHash(message), *signature_bytes)) {\n-        return MessageVerificationResult::ERR_PUBKEY_NOT_RECOVERED;\n+    if (!pubkey.RecoverCompact(MessageHash(message, MessageSignatureFormat::LEGACY), *signature_bytes)) {\n+        return MessageVerifyBIP322(destination, *signature_bytes, message, MessageVerificationResult::ERR_PUBKEY_NOT_RECOVERED);\n     }\n \n     if (!(CTxDestination(PKHash(pubkey)) == destination)) {\n-        return MessageVerificationResult::ERR_NOT_SIGNED;\n+        return MessageVerifyBIP322(destination, *signature_bytes, message, MessageVerificationResult::ERR_NOT_SIGNED);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r929276750",
      "id" : 929276750,
      "line" : 120,
      "node_id" : "PRRC_kwDOABII5843Y6NO",
      "original_commit_id" : "30642a185971555ea68bd5b80f87d633ddd09593",
      "original_line" : 119,
      "original_position" : 111,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 111,
      "pull_request_review_id" : 1049939798,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929276750/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-25T20:36:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929276750",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r930631396"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930631396"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The idea is that the `return false;` statement itself is a placeholder for when a decision is made on how to deal with inconclusive proofs.",
      "commit_id" : "e100fed327a0bd3ce11a882782c6cce3487fb28a",
      "created_at" : "2022-07-27T05:23:07Z",
      "diff_hunk" : "@@ -49,9 +49,16 @@ static RPCHelpMan verifymessage()\n                 throw JSONRPCError(RPC_TYPE_ERROR, \"Address does not refer to key\");\n             case MessageVerificationResult::ERR_MALFORMED_SIGNATURE:\n                 throw JSONRPCError(RPC_TYPE_ERROR, \"Malformed base64 encoding\");\n+            case MessageVerificationResult::ERR_POF:\n+                throw JSONRPCError(RPC_TYPE_ERROR, \"BIP-322 Proof of funds is not yet supported\"); // TODO: get access to UTXO set / mempool to handle this, then remove this error code?\n+            case MessageVerificationResult::INCONCLUSIVE:\n+                return false; // TODO: switch to a string based result? mix bool and strings?",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r930631396",
      "id" : 930631396,
      "in_reply_to_id" : 929222834,
      "line" : 55,
      "node_id" : "PRRC_kwDOABII5843eE7k",
      "original_commit_id" : "30642a185971555ea68bd5b80f87d633ddd09593",
      "original_line" : 55,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/rpc/signmessage.cpp",
      "position" : 7,
      "pull_request_review_id" : 1051903548,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930631396/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-27T05:23:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930631396",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r930632640"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930632640"
         }
      },
      "author_association" : "MEMBER",
      "body" : "That is the plan yeah, but I was considering it to be the follow-up next step after this PR is merged, to keep this minimal. As you say the follow-up PR to fix this should be quite trivial and easy to review.",
      "commit_id" : "e100fed327a0bd3ce11a882782c6cce3487fb28a",
      "created_at" : "2022-07-27T05:25:36Z",
      "diff_hunk" : "@@ -109,3 +109,65 @@ std::string SigningResultString(const SigningResult res)\n     }\n     assert(false);\n }\n+\n+std::optional<BIP322Txs> BIP322Txs::Create(const CTxDestination& destination, const std::string& message, MessageVerificationResult& result, const std::vector<unsigned char>* signature)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r930632640",
      "id" : 930632640,
      "in_reply_to_id" : 929229553,
      "line" : 180,
      "node_id" : "PRRC_kwDOABII5843eFPA",
      "original_commit_id" : "5bc21371947340a35039cb9ce95571b45bc535a4",
      "original_line" : 113,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 5,
      "pull_request_review_id" : 1051905141,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930632640/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-27T05:25:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930632640",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r930634012"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930634012"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good catch. Didn't think about the >65b part.",
      "commit_id" : "e100fed327a0bd3ce11a882782c6cce3487fb28a",
      "created_at" : "2022-07-27T05:28:16Z",
      "diff_hunk" : "@@ -25,32 +26,97 @@\n  */\n const std::string MESSAGE_MAGIC = \"Bitcoin Signed Message:\\n\";\n \n+/**\n+ * BIP-322 tagged hash\n+ */\n+const CHashWriter HASHER_BIP322 = TaggedHash(\"BIP0322-signed-message\");\n+\n+static constexpr unsigned int BIP322_REQUIRED_FLAGS =\n+    SCRIPT_VERIFY_CONST_SCRIPTCODE // disallows OP_CODESEPARATOR and FindAndDelete\n+|   SCRIPT_VERIFY_LOW_S\n+|   SCRIPT_VERIFY_STRICTENC\n+|   SCRIPT_VERIFY_NULLFAIL\n+|   SCRIPT_VERIFY_MINIMALDATA\n+|   SCRIPT_VERIFY_CLEANSTACK\n+|   SCRIPT_VERIFY_P2SH\n+|   SCRIPT_VERIFY_WITNESS\n+|   SCRIPT_VERIFY_MINIMALIF;\n+\n+static constexpr unsigned int BIP322_INCONCLUSIVE_FLAGS =\n+    SCRIPT_VERIFY_DISCOURAGE_OP_SUCCESS\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_PUBKEYTYPE\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_TAPROOT_VERSION\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM;\n+\n+MessageVerificationResult MessageVerifyBIP322(\n+    CTxDestination& destination,\n+    std::vector<unsigned char>& signature,\n+    const std::string& message,\n+    MessageVerificationResult legacyError)\n+{\n+    auto txs = BIP322Txs::Create(destination, message, legacyError, &signature);\n+    if (!txs) return legacyError;\n+\n+    const CTransaction& to_sign = txs->m_to_sign;\n+    const CTransaction& to_spend = txs->m_to_spend;\n+\n+    const CScript scriptSig = to_sign.vin[0].scriptSig;\n+    const CScriptWitness& witness = to_sign.vin[0].scriptWitness;\n+\n+    PrecomputedTransactionData txdata;\n+    txdata.Init(to_sign, {to_spend.vout[0]});\n+    TransactionSignatureChecker sigcheck(&to_sign, /* nInIn= */ 0, /* amountIn= */ to_spend.vout[0].nValue, txdata, MissingDataBehavior::ASSERT_FAIL);\n+    sigcheck.RequireSighashAll();\n+\n+    if (!VerifyScript(scriptSig, to_spend.vout[0].scriptPubKey, &witness, BIP322_REQUIRED_FLAGS, sigcheck)) {\n+        return MessageVerificationResult::ERR_INVALID;\n+    }\n+\n+    // inconclusive checks\n+\n+    if (to_sign.nVersion != 0 && to_sign.nVersion != 2) {\n+        return MessageVerificationResult::INCONCLUSIVE;\n+    }\n+\n+    if (!VerifyScript(scriptSig, to_spend.vout[0].scriptPubKey, &witness, BIP322_INCONCLUSIVE_FLAGS, sigcheck)) {\n+        return MessageVerificationResult::INCONCLUSIVE;\n+    }\n+\n+    // timelock check\n+    if (to_sign.nLockTime > 0 || to_sign.vin[0].nSequence > 0) {\n+        return MessageVerificationResult::OK_TIMELOCKED;\n+    }\n+\n+    return MessageVerificationResult::OK;\n+}\n+\n MessageVerificationResult MessageVerify(\n     const std::string& address,\n     const std::string& signature,\n     const std::string& message)\n {\n+    auto signature_bytes = DecodeBase64(signature.c_str());\n+    if (!signature_bytes) {\n+        return MessageVerificationResult::ERR_MALFORMED_SIGNATURE;\n+    }\n+\n     CTxDestination destination = DecodeDestination(address);\n     if (!IsValidDestination(destination)) {\n         return MessageVerificationResult::ERR_INVALID_ADDRESS;\n     }\n \n     if (std::get_if<PKHash>(&destination) == nullptr) {\n-        return MessageVerificationResult::ERR_ADDRESS_NO_KEY;\n-    }\n-\n-    auto signature_bytes = DecodeBase64(signature);\n-    if (!signature_bytes) {\n-        return MessageVerificationResult::ERR_MALFORMED_SIGNATURE;\n+        return MessageVerifyBIP322(destination, *signature_bytes, message, MessageVerificationResult::ERR_ADDRESS_NO_KEY);\n     }\n \n     CPubKey pubkey;\n-    if (!pubkey.RecoverCompact(MessageHash(message), *signature_bytes)) {\n-        return MessageVerificationResult::ERR_PUBKEY_NOT_RECOVERED;\n+    if (!pubkey.RecoverCompact(MessageHash(message, MessageSignatureFormat::LEGACY), *signature_bytes)) {\n+        return MessageVerifyBIP322(destination, *signature_bytes, message, MessageVerificationResult::ERR_PUBKEY_NOT_RECOVERED);\n     }\n \n     if (!(CTxDestination(PKHash(pubkey)) == destination)) {\n-        return MessageVerificationResult::ERR_NOT_SIGNED;\n+        return MessageVerifyBIP322(destination, *signature_bytes, message, MessageVerificationResult::ERR_NOT_SIGNED);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r930634012",
      "id" : 930634012,
      "in_reply_to_id" : 929276750,
      "line" : 120,
      "node_id" : "PRRC_kwDOABII5843eFkc",
      "original_commit_id" : "30642a185971555ea68bd5b80f87d633ddd09593",
      "original_line" : 119,
      "original_position" : 111,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 111,
      "pull_request_review_id" : 1051906899,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930634012/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-27T05:28:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930634012",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r931819477"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/931819477"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Moved `HASHER_BIP322`.",
      "commit_id" : "a9b4dc1b9b0350277d3bd395f3f814260b331feb",
      "created_at" : "2022-07-28T06:15:11Z",
      "diff_hunk" : "@@ -72,12 +72,28 @@ bool MessageSign(\n     return true;\n }\n \n-uint256 MessageHash(const std::string& message)\n+uint256 MessageHash(const std::string& message, MessageSignatureFormat format)\n {\n-    CHashWriter hasher(SER_GETHASH, 0);\n-    hasher << MESSAGE_MAGIC << message;\n-\n-    return hasher.GetHash();\n+    switch (format) {\n+    case MessageSignatureFormat::LEGACY:\n+        {\n+            CHashWriter hasher(SER_GETHASH, 0);\n+            hasher << MESSAGE_MAGIC << message;\n+\n+            return hasher.GetHash();\n+        }\n+\n+    case MessageSignatureFormat::SIMPLE:\n+    case MessageSignatureFormat::FULL:\n+        {\n+            CHashWriter hasher(HASHER_BIP322);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r931819477",
      "id" : 931819477,
      "in_reply_to_id" : 929213680,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5843im_V",
      "original_commit_id" : "85ed08c22ca51ed4b9d8de0a402280b9401811af",
      "original_line" : 89,
      "original_position" : 32,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : null,
      "pull_request_review_id" : 1053534866,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/931819477/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-28T06:15:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/931819477",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "https://github.com/bitcoin/bips/pull/1347",
      "created_at" : "2022-07-28T06:56:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1197741102",
      "id" : 1197741102,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585HZBQu",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1197741102/reactions"
      },
      "updated_at" : "2022-07-28T06:56:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1197741102",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "[Ran out of time; will continue addressing comments and push complete changes later today/tomorrow]\r\n\r\n~~[Edited next day: got most of the work done but not quite done yet. Hopefully will get to it later today; otherwise will try over weekend]~~",
      "created_at" : "2022-07-28T07:07:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1197751049",
      "id" : 1197751049,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585HZDsJ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1197751049/reactions"
      },
      "updated_at" : "2022-07-29T07:12:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1197751049",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r932882641"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932882641"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Moved the extension into a separate commit that comes before this one.",
      "commit_id" : "fc2d3e3b3fa402b4c02741515f3ba58dc9b8c665",
      "created_at" : "2022-07-29T05:34:05Z",
      "diff_hunk" : "@@ -109,3 +109,65 @@ std::string SigningResultString(const SigningResult res)\n     }\n     assert(false);\n }\n+\n+std::optional<BIP322Txs> BIP322Txs::Create(const CTxDestination& destination, const std::string& message, MessageVerificationResult& result, const std::vector<unsigned char>* signature)\n+{\n+    // attempt to get script pub key for destination\n+    CScript message_challenge = GetScriptForDestination(destination);\n+    if (message_challenge.size() == 0) {\n+        // NoDestination; failure\n+        // (use legacy result)\n+        return std::nullopt;\n+    }\n+\n+    // prepare message hash\n+    uint256 message_hash = MessageHash(message, MessageSignatureFormat::SIMPLE);\n+    std::vector<unsigned char> message_hash_vec(message_hash.begin(), message_hash.end());\n+\n+    // generate to_spend transaction\n+    CMutableTransaction to_spend;\n+    to_spend.nVersion = 0;\n+    to_spend.nLockTime = 0;\n+    to_spend.vin.emplace_back(COutPoint(uint256::ZERO, 0xFFFFFFFF), (CScript() << OP_0 << message_hash_vec), 0);\n+    to_spend.vout.emplace_back(0, message_challenge);\n+\n+    CMutableTransaction to_sign;\n+    if (signature && DecodeTx(to_sign, *signature, /* try_no_witness */ true, /* try_witness */ true)) {\n+        // validate decoded transaction\n+        // multiple inputs (proof of funds) are not supported as we do not have UTXO set access\n+        if (to_sign.vin.size() > 1) {\n+            result = MessageVerificationResult::ERR_POF;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r932882641",
      "id" : 932882641,
      "in_reply_to_id" : 929218874,
      "line" : 205,
      "node_id" : "PRRC_kwDOABII5843mqjR",
      "original_commit_id" : "5bc21371947340a35039cb9ce95571b45bc535a4",
      "original_line" : 205,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 189,
      "pull_request_review_id" : 1055031377,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932882641/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-29T05:34:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932882641",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r932883770"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932883770"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Resolved above.",
      "commit_id" : "fc2d3e3b3fa402b4c02741515f3ba58dc9b8c665",
      "created_at" : "2022-07-29T05:36:55Z",
      "diff_hunk" : "@@ -109,3 +109,65 @@ std::string SigningResultString(const SigningResult res)\n     }\n     assert(false);\n }\n+\n+std::optional<BIP322Txs> BIP322Txs::Create(const CTxDestination& destination, const std::string& message, MessageVerificationResult& result, const std::vector<unsigned char>* signature)\n+{\n+    // attempt to get script pub key for destination\n+    CScript message_challenge = GetScriptForDestination(destination);\n+    if (message_challenge.size() == 0) {\n+        // NoDestination; failure\n+        // (use legacy result)\n+        return std::nullopt;\n+    }\n+\n+    // prepare message hash\n+    uint256 message_hash = MessageHash(message, MessageSignatureFormat::SIMPLE);\n+    std::vector<unsigned char> message_hash_vec(message_hash.begin(), message_hash.end());\n+\n+    // generate to_spend transaction\n+    CMutableTransaction to_spend;\n+    to_spend.nVersion = 0;\n+    to_spend.nLockTime = 0;\n+    to_spend.vin.emplace_back(COutPoint(uint256::ZERO, 0xFFFFFFFF), (CScript() << OP_0 << message_hash_vec), 0);\n+    to_spend.vout.emplace_back(0, message_challenge);\n+\n+    CMutableTransaction to_sign;\n+    if (signature && DecodeTx(to_sign, *signature, /* try_no_witness */ true, /* try_witness */ true)) {\n+        // validate decoded transaction\n+        // multiple inputs (proof of funds) are not supported as we do not have UTXO set access\n+        if (to_sign.vin.size() > 1) {\n+            result = MessageVerificationResult::ERR_POF;\n+            return std::nullopt;\n+        }\n+        if ((to_sign.vin.size() == 0 || to_sign.vin[0].prevout.hash != to_spend.GetHash()) ||\n+            (to_sign.vin[0].prevout.n != 0) ||\n+            (to_sign.vout.size() != 1) ||\n+            (to_sign.vout[0].nValue != 0) ||\n+            (to_sign.vout[0].scriptPubKey != (CScript() << OP_RETURN))) {\n+            result = MessageVerificationResult::ERR_INVALID;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r932883770",
      "id" : 932883770,
      "in_reply_to_id" : 929219576,
      "line" : 213,
      "node_id" : "PRRC_kwDOABII5843mq06",
      "original_commit_id" : "5bc21371947340a35039cb9ce95571b45bc535a4",
      "original_line" : 213,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 197,
      "pull_request_review_id" : 1055032892,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932883770/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-29T05:36:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932883770",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r932888195"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932888195"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Switched to using optional.",
      "commit_id" : "fc2d3e3b3fa402b4c02741515f3ba58dc9b8c665",
      "created_at" : "2022-07-29T05:47:07Z",
      "diff_hunk" : "@@ -85,4 +85,18 @@ uint256 MessageHash(const std::string& message, MessageSignatureFormat format);\n \n std::string SigningResultString(const SigningResult res);\n \n+/**\n+ * Generate the BIP-322 tx corresponding to the given challenge\n+ */\n+class BIP322Txs {\n+    template<class T1, class T2>\n+    BIP322Txs(const T1& to_spend, const T2& to_sign) : m_to_spend{to_spend}, m_to_sign{to_sign} { }\n+\n+public:\n+    static std::optional<BIP322Txs> Create(const CTxDestination& destination, const std::string& message, MessageVerificationResult& result, const std::vector<unsigned char>* signature = nullptr);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r932888195",
      "id" : 932888195,
      "in_reply_to_id" : 929220167,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5843mr6D",
      "original_commit_id" : "5bc21371947340a35039cb9ce95571b45bc535a4",
      "original_line" : 112,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/util/message.h",
      "position" : null,
      "pull_request_review_id" : 1055038781,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932888195/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-29T05:47:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932888195",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r932889988"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932889988"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If it is merged with the BIP-325 variant, it does need to be.",
      "commit_id" : "fc2d3e3b3fa402b4c02741515f3ba58dc9b8c665",
      "created_at" : "2022-07-29T05:51:17Z",
      "diff_hunk" : "@@ -85,4 +85,18 @@ uint256 MessageHash(const std::string& message, MessageSignatureFormat format);\n \n std::string SigningResultString(const SigningResult res);\n \n+/**\n+ * Generate the BIP-322 tx corresponding to the given challenge\n+ */\n+class BIP322Txs {\n+    template<class T1, class T2>\n+    BIP322Txs(const T1& to_spend, const T2& to_sign) : m_to_spend{to_spend}, m_to_sign{to_sign} { }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r932889988",
      "id" : 932889988,
      "in_reply_to_id" : 929241716,
      "line" : 109,
      "node_id" : "PRRC_kwDOABII5843msWE",
      "original_commit_id" : "5bc21371947340a35039cb9ce95571b45bc535a4",
      "original_line" : 109,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/util/message.h",
      "position" : 75,
      "pull_request_review_id" : 1055041297,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932889988/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-29T05:51:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932889988",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r932930587"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932930587"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I would like to avoid using the same message for different errors, as it makes troubleshooting more difficult. That said, maybe \"Some check failed\" is not the right wording here... ",
      "commit_id" : "13bd707dcbf985a4e7a7de170c3c51c279156304",
      "created_at" : "2022-07-29T07:04:24Z",
      "diff_hunk" : "@@ -214,6 +207,27 @@ void SignVerifyMessageDialog::on_verifyMessageButton_VM_clicked()\n             QString(\"<nobr>\") + tr(\"Message verified.\") + QString(\"</nobr>\")\n         );\n         return;\n+    case MessageVerificationResult::OK_TIMELOCKED:\n+        ui->statusLabel_VM->setText(\n+            QString(\"<nobr>\") + tr(\"Message verified, but includes timelocks.\") + QString(\"</nobr>\")\n+        );\n+        return;\n+    case MessageVerificationResult::INCONCLUSIVE:\n+        ui->statusLabel_VM->setText(\n+            QString(\"<nobr>\") + tr(\"Inconclusive.\") + QString(\"</nobr>\")\n+        );\n+        return;\n+    case MessageVerificationResult::ERR_INVALID:\n+        ui->statusLabel_VM->setText(\n+            tr(\"Some check failed.\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r932930587",
      "id" : 932930587,
      "in_reply_to_id" : 929258011,
      "line" : 222,
      "node_id" : "PRRC_kwDOABII5843m2Qb",
      "original_commit_id" : "8f9c561c7b0887b98ce5a6670428fdeb1590deb1",
      "original_line" : 222,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/qt/signverifymessagedialog.cpp",
      "position" : 39,
      "pull_request_review_id" : 1055097483,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932930587/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-29T07:04:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932930587",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r932933623"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932933623"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm not sure that's the case - what if `address` does not contain a destination?",
      "commit_id" : "13bd707dcbf985a4e7a7de170c3c51c279156304",
      "created_at" : "2022-07-29T07:09:16Z",
      "diff_hunk" : "@@ -208,6 +208,47 @@ IsMineResult IsMineInner(const LegacyScriptPubKeyMan& keystore, const CScript& s\n \n } // namespace\n \n+SigningResult ScriptPubKeyMan::SignMessageBIP322(MessageSignatureFormat format, const SigningProvider* keystore, const std::string& message, const CTxDestination& address, std::string& str_sig) const\n+{\n+    assert(format != MessageSignatureFormat::LEGACY);\n+\n+    MessageVerificationResult result; // unused\n+    auto txs = BIP322Txs::Create(address, message, result);\n+    if (!txs) return SigningResult::PRIVATE_KEY_NOT_AVAILABLE;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r932933623",
      "id" : 932933623,
      "in_reply_to_id" : 929267071,
      "line" : 217,
      "node_id" : "PRRC_kwDOABII5843m2_3",
      "original_commit_id" : "f0747683eb73f2052b9ef18b8246e81411c30e20",
      "original_line" : 217,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/wallet/scriptpubkeyman.cpp",
      "position" : 10,
      "pull_request_review_id" : 1055101868,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932933623/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-29T07:09:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932933623",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r932936879"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932936879"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I took the liberty of pasting your reasoning as a comment in case future reviewers wonder why a BIP322 attempt isn't made. I can drop that if it seems overkill.",
      "commit_id" : "13bd707dcbf985a4e7a7de170c3c51c279156304",
      "created_at" : "2022-07-29T07:13:49Z",
      "diff_hunk" : "@@ -25,32 +26,97 @@\n  */\n const std::string MESSAGE_MAGIC = \"Bitcoin Signed Message:\\n\";\n \n+/**\n+ * BIP-322 tagged hash\n+ */\n+const CHashWriter HASHER_BIP322 = TaggedHash(\"BIP0322-signed-message\");\n+\n+static constexpr unsigned int BIP322_REQUIRED_FLAGS =\n+    SCRIPT_VERIFY_CONST_SCRIPTCODE // disallows OP_CODESEPARATOR and FindAndDelete\n+|   SCRIPT_VERIFY_LOW_S\n+|   SCRIPT_VERIFY_STRICTENC\n+|   SCRIPT_VERIFY_NULLFAIL\n+|   SCRIPT_VERIFY_MINIMALDATA\n+|   SCRIPT_VERIFY_CLEANSTACK\n+|   SCRIPT_VERIFY_P2SH\n+|   SCRIPT_VERIFY_WITNESS\n+|   SCRIPT_VERIFY_MINIMALIF;\n+\n+static constexpr unsigned int BIP322_INCONCLUSIVE_FLAGS =\n+    SCRIPT_VERIFY_DISCOURAGE_OP_SUCCESS\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_PUBKEYTYPE\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_TAPROOT_VERSION\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM;\n+\n+MessageVerificationResult MessageVerifyBIP322(\n+    CTxDestination& destination,\n+    std::vector<unsigned char>& signature,\n+    const std::string& message,\n+    MessageVerificationResult legacyError)\n+{\n+    auto txs = BIP322Txs::Create(destination, message, legacyError, &signature);\n+    if (!txs) return legacyError;\n+\n+    const CTransaction& to_sign = txs->m_to_sign;\n+    const CTransaction& to_spend = txs->m_to_spend;\n+\n+    const CScript scriptSig = to_sign.vin[0].scriptSig;\n+    const CScriptWitness& witness = to_sign.vin[0].scriptWitness;\n+\n+    PrecomputedTransactionData txdata;\n+    txdata.Init(to_sign, {to_spend.vout[0]});\n+    TransactionSignatureChecker sigcheck(&to_sign, /* nInIn= */ 0, /* amountIn= */ to_spend.vout[0].nValue, txdata, MissingDataBehavior::ASSERT_FAIL);\n+    sigcheck.RequireSighashAll();\n+\n+    if (!VerifyScript(scriptSig, to_spend.vout[0].scriptPubKey, &witness, BIP322_REQUIRED_FLAGS, sigcheck)) {\n+        return MessageVerificationResult::ERR_INVALID;\n+    }\n+\n+    // inconclusive checks\n+\n+    if (to_sign.nVersion != 0 && to_sign.nVersion != 2) {\n+        return MessageVerificationResult::INCONCLUSIVE;\n+    }\n+\n+    if (!VerifyScript(scriptSig, to_spend.vout[0].scriptPubKey, &witness, BIP322_INCONCLUSIVE_FLAGS, sigcheck)) {\n+        return MessageVerificationResult::INCONCLUSIVE;\n+    }\n+\n+    // timelock check\n+    if (to_sign.nLockTime > 0 || to_sign.vin[0].nSequence > 0) {\n+        return MessageVerificationResult::OK_TIMELOCKED;\n+    }\n+\n+    return MessageVerificationResult::OK;\n+}\n+\n MessageVerificationResult MessageVerify(\n     const std::string& address,\n     const std::string& signature,\n     const std::string& message)\n {\n+    auto signature_bytes = DecodeBase64(signature.c_str());\n+    if (!signature_bytes) {\n+        return MessageVerificationResult::ERR_MALFORMED_SIGNATURE;\n+    }\n+\n     CTxDestination destination = DecodeDestination(address);\n     if (!IsValidDestination(destination)) {\n         return MessageVerificationResult::ERR_INVALID_ADDRESS;\n     }\n \n     if (std::get_if<PKHash>(&destination) == nullptr) {\n-        return MessageVerificationResult::ERR_ADDRESS_NO_KEY;\n-    }\n-\n-    auto signature_bytes = DecodeBase64(signature);\n-    if (!signature_bytes) {\n-        return MessageVerificationResult::ERR_MALFORMED_SIGNATURE;\n+        return MessageVerifyBIP322(destination, *signature_bytes, message, MessageVerificationResult::ERR_ADDRESS_NO_KEY);\n     }\n \n     CPubKey pubkey;\n-    if (!pubkey.RecoverCompact(MessageHash(message), *signature_bytes)) {\n-        return MessageVerificationResult::ERR_PUBKEY_NOT_RECOVERED;\n+    if (!pubkey.RecoverCompact(MessageHash(message, MessageSignatureFormat::LEGACY), *signature_bytes)) {\n+        return MessageVerifyBIP322(destination, *signature_bytes, message, MessageVerificationResult::ERR_PUBKEY_NOT_RECOVERED);\n     }\n \n     if (!(CTxDestination(PKHash(pubkey)) == destination)) {\n-        return MessageVerificationResult::ERR_NOT_SIGNED;\n+        return MessageVerifyBIP322(destination, *signature_bytes, message, MessageVerificationResult::ERR_NOT_SIGNED);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r932936879",
      "id" : 932936879,
      "in_reply_to_id" : 929276750,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5843m3yv",
      "original_commit_id" : "30642a185971555ea68bd5b80f87d633ddd09593",
      "original_line" : 120,
      "original_position" : 111,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : null,
      "pull_request_review_id" : 1055106325,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932936879/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-29T07:13:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932936879",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "CI is having [package woes](https://cirrus-ci.com/task/4945539455254528?logs=ci#L61)...\r\n```\r\nError: \r\n Problem 1: cannot install the best candidate for the job\r\n  - nothing provides libstdc++ = 8.5.0-15.el8 needed by gcc-c++-8.5.0-15.el8.x86_64\r\n Problem 2: cannot install the best candidate for the job\r\n  - nothing provides libstdc++(x86-64) = 8.5.0-15.el8 needed by libstdc++-devel-8.5.0-15.el8.x86_64\r\n Problem 3: cannot install the best candidate for the job\r\n  - nothing provides libstdc++(x86-32) = 8.5.0-15.el8 needed by libstdc++-devel-8.5.0-15.el8.i686\r\n```\r\n",
      "created_at" : "2022-07-29T09:18:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1199058684",
      "id" : 1199058684,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585HeC78",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1199058684/reactions"
      },
      "updated_at" : "2022-07-29T09:18:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1199058684",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r933350416"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/933350416"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It shouldn't. First, both the RPC and the GUI will validate that `address` is a valid destination before passing it on. Then `CWallet::SignMessage` also ensures that there is a valid destination by getting the script for the destination and using the `ScriptPubKeyMan` that can provide for that script. So by the time we get to this line, we've already checked at least twice that the destination is valid.",
      "commit_id" : "13bd707dcbf985a4e7a7de170c3c51c279156304",
      "created_at" : "2022-07-29T14:48:43Z",
      "diff_hunk" : "@@ -208,6 +208,47 @@ IsMineResult IsMineInner(const LegacyScriptPubKeyMan& keystore, const CScript& s\n \n } // namespace\n \n+SigningResult ScriptPubKeyMan::SignMessageBIP322(MessageSignatureFormat format, const SigningProvider* keystore, const std::string& message, const CTxDestination& address, std::string& str_sig) const\n+{\n+    assert(format != MessageSignatureFormat::LEGACY);\n+\n+    MessageVerificationResult result; // unused\n+    auto txs = BIP322Txs::Create(address, message, result);\n+    if (!txs) return SigningResult::PRIVATE_KEY_NOT_AVAILABLE;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r933350416",
      "id" : 933350416,
      "in_reply_to_id" : 929267071,
      "line" : 217,
      "node_id" : "PRRC_kwDOABII5843ocwQ",
      "original_commit_id" : "f0747683eb73f2052b9ef18b8246e81411c30e20",
      "original_line" : 217,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/wallet/scriptpubkeyman.cpp",
      "position" : 10,
      "pull_request_review_id" : 1055681147,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/933350416/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-29T14:48:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/933350416",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r934157886"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/934157886"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Switched to asserting.",
      "commit_id" : "e54e5eef7898468ae38dc9936cc07a2521294357",
      "created_at" : "2022-08-01T05:49:17Z",
      "diff_hunk" : "@@ -208,6 +208,47 @@ IsMineResult IsMineInner(const LegacyScriptPubKeyMan& keystore, const CScript& s\n \n } // namespace\n \n+SigningResult ScriptPubKeyMan::SignMessageBIP322(MessageSignatureFormat format, const SigningProvider* keystore, const std::string& message, const CTxDestination& address, std::string& str_sig) const\n+{\n+    assert(format != MessageSignatureFormat::LEGACY);\n+\n+    MessageVerificationResult result; // unused\n+    auto txs = BIP322Txs::Create(address, message, result);\n+    if (!txs) return SigningResult::PRIVATE_KEY_NOT_AVAILABLE;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r934157886",
      "id" : 934157886,
      "in_reply_to_id" : 929267071,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5843rh4-",
      "original_commit_id" : "f0747683eb73f2052b9ef18b8246e81411c30e20",
      "original_line" : 217,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/wallet/scriptpubkeyman.cpp",
      "position" : null,
      "pull_request_review_id" : 1056768329,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/934157886/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-01T05:49:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/934157886",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r975857389"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/975857389"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit:\r\n```suggestion\r\nstatic const HashWriter HASHER_BIP322{TaggedHash(\"BIP0322-signed-message\")};\r\n```",
      "commit_id" : "e54e5eef7898468ae38dc9936cc07a2521294357",
      "created_at" : "2022-09-20T22:14:24Z",
      "diff_hunk" : "@@ -25,6 +25,11 @@\n  */\n const std::string MESSAGE_MAGIC = \"Bitcoin Signed Message:\\n\";\n \n+/**\n+ * BIP-322 tagged hash\n+ */\n+const HashWriter HASHER_BIP322 = TaggedHash(\"BIP0322-signed-message\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r975857389",
      "id" : 975857389,
      "line" : 32,
      "node_id" : "PRRC_kwDOABII5846Kmbt",
      "original_commit_id" : "11f2a152d15a5f6607caf4392c94d7ab8dc99b78",
      "original_line" : 31,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 7,
      "pull_request_review_id" : 1114533938,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/975857389/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-20T22:57:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/975857389",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r975857978"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/975857978"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: Considering that `sizeof(char)` is always 1 (see e.g. https://www.cs.technion.ac.il/users/yechiel/c++-faq/sizeof-char.html), this multiplication is not needed:\r\n```suggestion\r\n                hasher.write(AsBytes(Span{message.data(), message.size()}));\r\n```",
      "commit_id" : "e54e5eef7898468ae38dc9936cc07a2521294357",
      "created_at" : "2022-09-20T22:15:40Z",
      "diff_hunk" : "@@ -72,12 +77,27 @@ bool MessageSign(\n     return true;\n }\n \n-uint256 MessageHash(const std::string& message)\n+uint256 MessageHash(const std::string& message, MessageSignatureFormat format)\n {\n-    HashWriter hasher{};\n-    hasher << MESSAGE_MAGIC << message;\n-\n-    return hasher.GetHash();\n+    switch (format) {\n+    case MessageSignatureFormat::LEGACY:\n+        {\n+            HashWriter hasher{};\n+            hasher << MESSAGE_MAGIC << message;\n+            return hasher.GetHash();\n+        }\n+\n+    case MessageSignatureFormat::SIMPLE:\n+    case MessageSignatureFormat::FULL:\n+        {\n+            HashWriter hasher{HASHER_BIP322};\n+            if (!message.empty()) {\n+                hasher.write(AsBytes(Span{message.data(), message.size() * sizeof(char)}));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r975857978",
      "id" : 975857978,
      "line" : 157,
      "node_id" : "PRRC_kwDOABII5846Kmk6",
      "original_commit_id" : "11f2a152d15a5f6607caf4392c94d7ab8dc99b78",
      "original_line" : 95,
      "original_position" : 54,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 54,
      "pull_request_review_id" : 1114533938,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/975857978/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-20T22:57:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/975857978",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r975867244"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/975867244"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: Default visibility for classes in C++ is private, but IMHO it would still be more readable if that is stated explicitly:\r\n```suggestion\r\nclass BIP322Txs {\r\nprivate:\r\n```",
      "commit_id" : "e54e5eef7898468ae38dc9936cc07a2521294357",
      "created_at" : "2022-09-20T22:34:10Z",
      "diff_hunk" : "@@ -101,4 +101,18 @@ uint256 MessageHash(const std::string& message, MessageSignatureFormat format);\n \n std::string SigningResultString(const SigningResult res);\n \n+/**\n+ * Generate the BIP-322 tx corresponding to the given challenge\n+ */\n+class BIP322Txs {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r975867244",
      "id" : 975867244,
      "line" : 107,
      "node_id" : "PRRC_kwDOABII5846Ko1s",
      "original_commit_id" : "ff121f7af53568aa67d75c02e799c9e041784b7f",
      "original_line" : 107,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/util/message.h",
      "position" : 7,
      "pull_request_review_id" : 1114533938,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/975867244/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-20T22:57:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/975867244",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r975871164"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/975871164"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit:\r\n```suggestion\r\n    if (signature.has_value() && DecodeTx(to_sign, signature.value(), /* try_no_witness= */ true, /* try_witness= */ true)) {\r\n```",
      "commit_id" : "e54e5eef7898468ae38dc9936cc07a2521294357",
      "created_at" : "2022-09-20T22:42:35Z",
      "diff_hunk" : "@@ -113,3 +114,65 @@ std::string SigningResultString(const SigningResult res)\n     }\n     assert(false);\n }\n+\n+std::optional<BIP322Txs> BIP322Txs::Create(const CTxDestination& destination, const std::string& message, MessageVerificationResult& result, std::optional<const std::vector<unsigned char>> signature)\n+{\n+    // attempt to get script pub key for destination\n+    CScript message_challenge = GetScriptForDestination(destination);\n+    if (message_challenge.size() == 0) {\n+        // NoDestination; failure\n+        // (use legacy result)\n+        return std::nullopt;\n+    }\n+\n+    // prepare message hash\n+    uint256 message_hash = MessageHash(message, MessageSignatureFormat::SIMPLE);\n+    std::vector<unsigned char> message_hash_vec(message_hash.begin(), message_hash.end());\n+\n+    // generate to_spend transaction\n+    CMutableTransaction to_spend;\n+    to_spend.nVersion = 0;\n+    to_spend.nLockTime = 0;\n+    to_spend.vin.emplace_back(COutPoint(uint256::ZERO, 0xFFFFFFFF), (CScript() << OP_0 << message_hash_vec), 0);\n+    to_spend.vout.emplace_back(0, message_challenge);\n+\n+    CMutableTransaction to_sign;\n+    if (signature.has_value() && DecodeTx(to_sign, signature.value(), /* try_no_witness */ true, /* try_witness */ true)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r975871164",
      "id" : 975871164,
      "line" : 201,
      "node_id" : "PRRC_kwDOABII5846Kpy8",
      "original_commit_id" : "ff121f7af53568aa67d75c02e799c9e041784b7f",
      "original_line" : 140,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 35,
      "pull_request_review_id" : 1114533938,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/975871164/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-20T22:57:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/975871164",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r975873671"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/975873671"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: `DecodeBase64` takes a std::string_view, i.e. passing a string directly is fine:\r\n```suggestion\r\n    auto signature_bytes = DecodeBase64(signature);\r\n```",
      "commit_id" : "e54e5eef7898468ae38dc9936cc07a2521294357",
      "created_at" : "2022-09-20T22:47:50Z",
      "diff_hunk" : "@@ -31,31 +31,92 @@ const std::string MESSAGE_MAGIC = \"Bitcoin Signed Message:\\n\";\n  */\n const HashWriter HASHER_BIP322 = TaggedHash(\"BIP0322-signed-message\");\n \n+static constexpr unsigned int BIP322_REQUIRED_FLAGS =\n+    SCRIPT_VERIFY_CONST_SCRIPTCODE // disallows OP_CODESEPARATOR and FindAndDelete\n+|   SCRIPT_VERIFY_LOW_S\n+|   SCRIPT_VERIFY_STRICTENC\n+|   SCRIPT_VERIFY_NULLFAIL\n+|   SCRIPT_VERIFY_MINIMALDATA\n+|   SCRIPT_VERIFY_CLEANSTACK\n+|   SCRIPT_VERIFY_P2SH\n+|   SCRIPT_VERIFY_WITNESS\n+|   SCRIPT_VERIFY_TAPROOT\n+|   SCRIPT_VERIFY_MINIMALIF;\n+\n+static constexpr unsigned int BIP322_INCONCLUSIVE_FLAGS =\n+    SCRIPT_VERIFY_DISCOURAGE_OP_SUCCESS\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_PUBKEYTYPE\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_TAPROOT_VERSION\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM;\n+\n+MessageVerificationResult MessageVerifyBIP322(\n+    CTxDestination& destination,\n+    std::vector<unsigned char>& signature,\n+    const std::string& message,\n+    MessageVerificationResult legacyError)\n+{\n+    auto txs = BIP322Txs::Create(destination, message, legacyError, signature);\n+    if (!txs) return legacyError;\n+\n+    const CTransaction& to_sign = txs->m_to_sign;\n+    const CTransaction& to_spend = txs->m_to_spend;\n+\n+    const CScript scriptSig = to_sign.vin[0].scriptSig;\n+    const CScriptWitness& witness = to_sign.vin[0].scriptWitness;\n+\n+    PrecomputedTransactionData txdata;\n+    txdata.Init(to_sign, {to_spend.vout[0]});\n+    TransactionSignatureChecker sigcheck(&to_sign, /* nInIn= */ 0, /* amountIn= */ to_spend.vout[0].nValue, txdata, MissingDataBehavior::ASSERT_FAIL, true);\n+\n+    if (!VerifyScript(scriptSig, to_spend.vout[0].scriptPubKey, &witness, BIP322_REQUIRED_FLAGS, sigcheck)) {\n+        return MessageVerificationResult::ERR_INVALID;\n+    }\n+\n+    // inconclusive checks\n+\n+    if (to_sign.nVersion != 0 && to_sign.nVersion != 2) {\n+        return MessageVerificationResult::INCONCLUSIVE;\n+    }\n+\n+    if (!VerifyScript(scriptSig, to_spend.vout[0].scriptPubKey, &witness, BIP322_INCONCLUSIVE_FLAGS, sigcheck)) {\n+        return MessageVerificationResult::INCONCLUSIVE;\n+    }\n+\n+    // timelock check\n+    if (to_sign.nLockTime > 0 || to_sign.vin[0].nSequence > 0) {\n+        return MessageVerificationResult::OK_TIMELOCKED;\n+    }\n+\n+    return MessageVerificationResult::OK;\n+}\n+\n MessageVerificationResult MessageVerify(\n     const std::string& address,\n     const std::string& signature,\n     const std::string& message)\n {\n+    auto signature_bytes = DecodeBase64(signature.c_str());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r975873671",
      "id" : 975873671,
      "line" : 99,
      "node_id" : "PRRC_kwDOABII5846KqaH",
      "original_commit_id" : "5f651713e9c59950ae83b06ec2bc1cb9103727b7",
      "original_line" : 99,
      "original_position" : 69,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 69,
      "pull_request_review_id" : 1114533938,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/975873671/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-20T22:57:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/975873671",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r975875079"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/975875079"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "With almost 500 characters, this comment is definitely too long for one line and should be split into multiple ones.",
      "commit_id" : "e54e5eef7898468ae38dc9936cc07a2521294357",
      "created_at" : "2022-09-20T22:51:18Z",
      "diff_hunk" : "@@ -31,31 +31,92 @@ const std::string MESSAGE_MAGIC = \"Bitcoin Signed Message:\\n\";\n  */\n const HashWriter HASHER_BIP322 = TaggedHash(\"BIP0322-signed-message\");\n \n+static constexpr unsigned int BIP322_REQUIRED_FLAGS =\n+    SCRIPT_VERIFY_CONST_SCRIPTCODE // disallows OP_CODESEPARATOR and FindAndDelete\n+|   SCRIPT_VERIFY_LOW_S\n+|   SCRIPT_VERIFY_STRICTENC\n+|   SCRIPT_VERIFY_NULLFAIL\n+|   SCRIPT_VERIFY_MINIMALDATA\n+|   SCRIPT_VERIFY_CLEANSTACK\n+|   SCRIPT_VERIFY_P2SH\n+|   SCRIPT_VERIFY_WITNESS\n+|   SCRIPT_VERIFY_TAPROOT\n+|   SCRIPT_VERIFY_MINIMALIF;\n+\n+static constexpr unsigned int BIP322_INCONCLUSIVE_FLAGS =\n+    SCRIPT_VERIFY_DISCOURAGE_OP_SUCCESS\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_PUBKEYTYPE\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_TAPROOT_VERSION\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM;\n+\n+MessageVerificationResult MessageVerifyBIP322(\n+    CTxDestination& destination,\n+    std::vector<unsigned char>& signature,\n+    const std::string& message,\n+    MessageVerificationResult legacyError)\n+{\n+    auto txs = BIP322Txs::Create(destination, message, legacyError, signature);\n+    if (!txs) return legacyError;\n+\n+    const CTransaction& to_sign = txs->m_to_sign;\n+    const CTransaction& to_spend = txs->m_to_spend;\n+\n+    const CScript scriptSig = to_sign.vin[0].scriptSig;\n+    const CScriptWitness& witness = to_sign.vin[0].scriptWitness;\n+\n+    PrecomputedTransactionData txdata;\n+    txdata.Init(to_sign, {to_spend.vout[0]});\n+    TransactionSignatureChecker sigcheck(&to_sign, /* nInIn= */ 0, /* amountIn= */ to_spend.vout[0].nValue, txdata, MissingDataBehavior::ASSERT_FAIL, true);\n+\n+    if (!VerifyScript(scriptSig, to_spend.vout[0].scriptPubKey, &witness, BIP322_REQUIRED_FLAGS, sigcheck)) {\n+        return MessageVerificationResult::ERR_INVALID;\n+    }\n+\n+    // inconclusive checks\n+\n+    if (to_sign.nVersion != 0 && to_sign.nVersion != 2) {\n+        return MessageVerificationResult::INCONCLUSIVE;\n+    }\n+\n+    if (!VerifyScript(scriptSig, to_spend.vout[0].scriptPubKey, &witness, BIP322_INCONCLUSIVE_FLAGS, sigcheck)) {\n+        return MessageVerificationResult::INCONCLUSIVE;\n+    }\n+\n+    // timelock check\n+    if (to_sign.nLockTime > 0 || to_sign.vin[0].nSequence > 0) {\n+        return MessageVerificationResult::OK_TIMELOCKED;\n+    }\n+\n+    return MessageVerificationResult::OK;\n+}\n+\n MessageVerificationResult MessageVerify(\n     const std::string& address,\n     const std::string& signature,\n     const std::string& message)\n {\n+    auto signature_bytes = DecodeBase64(signature.c_str());\n+    if (!signature_bytes) {\n+        return MessageVerificationResult::ERR_MALFORMED_SIGNATURE;\n+    }\n+\n     CTxDestination destination = DecodeDestination(address);\n     if (!IsValidDestination(destination)) {\n         return MessageVerificationResult::ERR_INVALID_ADDRESS;\n     }\n \n     if (std::get_if<PKHash>(&destination) == nullptr) {\n-        return MessageVerificationResult::ERR_ADDRESS_NO_KEY;\n-    }\n-\n-    auto signature_bytes = DecodeBase64(signature);\n-    if (!signature_bytes) {\n-        return MessageVerificationResult::ERR_MALFORMED_SIGNATURE;\n+        return MessageVerifyBIP322(destination, *signature_bytes, message, MessageVerificationResult::ERR_ADDRESS_NO_KEY);\n     }\n \n     CPubKey pubkey;\n     if (!pubkey.RecoverCompact(MessageHash(message, MessageSignatureFormat::LEGACY), *signature_bytes)) {\n-        return MessageVerificationResult::ERR_PUBKEY_NOT_RECOVERED;\n+        return MessageVerifyBIP322(destination, *signature_bytes, message, MessageVerificationResult::ERR_PUBKEY_NOT_RECOVERED);\n     }\n \n     if (!(CTxDestination(PKHash(pubkey)) == destination)) {\n+        // By the time we reach this line, the destination must be `PKHash` and we must have been able to recover a pubkey from the signature, which means that the signature must have been 65 bytes, otherwise `RecoverCompact` will have failed. However, a BIP322 signature for `PKHash` must be greater than 65 bytes because it will include a full transaction for the p2pkh address. So if we do reach this line, the signature is just invalid and there's no need to attempt a `MessageVerifyBIP322`.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r975875079",
      "id" : 975875079,
      "line" : 119,
      "node_id" : "PRRC_kwDOABII5846KqwH",
      "original_commit_id" : "5f651713e9c59950ae83b06ec2bc1cb9103727b7",
      "original_line" : 119,
      "original_position" : 96,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 96,
      "pull_request_review_id" : 1114533938,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/975875079/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-20T22:57:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/975875079",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r976577101"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/976577101"
         }
      },
      "author_association" : "MEMBER",
      "body" : "3b00ed9a52d91864665f074eadaafc179344ba56\r\n```suggestion\r\n    if (message_challenge.empty()) {\r\n```",
      "commit_id" : "29b28d07fa958b89e1c7916fda5d8654474cf495",
      "created_at" : "2022-09-21T14:22:44Z",
      "diff_hunk" : "@@ -93,3 +175,65 @@ std::string SigningResultString(const SigningResult res)\n     }\n     assert(false);\n }\n+\n+std::optional<BIP322Txs> BIP322Txs::Create(const CTxDestination& destination, const std::string& message, MessageVerificationResult& result, std::optional<const std::vector<unsigned char>> signature)\n+{\n+    // attempt to get script pub key for destination\n+    CScript message_challenge = GetScriptForDestination(destination);\n+    if (message_challenge.size() == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r976577101",
      "id" : 976577101,
      "line" : 191,
      "node_id" : "PRRC_kwDOABII5846NWJN",
      "original_commit_id" : "e54e5eef7898468ae38dc9936cc07a2521294357",
      "original_line" : 191,
      "original_position" : 165,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 174,
      "pull_request_review_id" : 1115525729,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/976577101/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-07T10:58:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/976577101",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r976577621"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/976577621"
         }
      },
      "author_association" : "MEMBER",
      "body" : "3b00ed9a52d91864665f074eadaafc179344ba56\r\n```suggestion\r\n        if ((to_sign.vin.empty() || to_sign.vin[0].prevout.hash != to_spend.GetHash()) ||\r\n```",
      "commit_id" : "29b28d07fa958b89e1c7916fda5d8654474cf495",
      "created_at" : "2022-09-21T14:23:06Z",
      "diff_hunk" : "@@ -93,3 +175,65 @@ std::string SigningResultString(const SigningResult res)\n     }\n     assert(false);\n }\n+\n+std::optional<BIP322Txs> BIP322Txs::Create(const CTxDestination& destination, const std::string& message, MessageVerificationResult& result, std::optional<const std::vector<unsigned char>> signature)\n+{\n+    // attempt to get script pub key for destination\n+    CScript message_challenge = GetScriptForDestination(destination);\n+    if (message_challenge.size() == 0) {\n+        // NoDestination; failure\n+        // (use legacy result)\n+        return std::nullopt;\n+    }\n+\n+    // prepare message hash\n+    uint256 message_hash = MessageHash(message, MessageSignatureFormat::SIMPLE);\n+    std::vector<unsigned char> message_hash_vec(message_hash.begin(), message_hash.end());\n+\n+    // generate to_spend transaction\n+    CMutableTransaction to_spend;\n+    to_spend.nVersion = 0;\n+    to_spend.nLockTime = 0;\n+    to_spend.vin.emplace_back(COutPoint(uint256::ZERO, 0xFFFFFFFF), (CScript() << OP_0 << message_hash_vec), 0);\n+    to_spend.vout.emplace_back(0, message_challenge);\n+\n+    CMutableTransaction to_sign;\n+    if (signature.has_value() && DecodeTx(to_sign, signature.value(), /* try_no_witness */ true, /* try_witness */ true)) {\n+        // validate decoded transaction\n+        // multiple inputs (proof of funds) are not supported as we do not have UTXO set access\n+        if (to_sign.vin.size() > 1) {\n+            result = MessageVerificationResult::ERR_POF;\n+            return std::nullopt;\n+        }\n+        if ((to_sign.vin.size() == 0 || to_sign.vin[0].prevout.hash != to_spend.GetHash()) ||",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r976577621",
      "id" : 976577621,
      "line" : 216,
      "node_id" : "PRRC_kwDOABII5846NWRV",
      "original_commit_id" : "e54e5eef7898468ae38dc9936cc07a2521294357",
      "original_line" : 216,
      "original_position" : 190,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 199,
      "pull_request_review_id" : 1115525729,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/976577621/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-07T10:58:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/976577621",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r976578163"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/976578163"
         }
      },
      "author_association" : "MEMBER",
      "body" : "f57ed58ef7b5381c595b7833b52775ef948bb7da\r\n```suggestion\r\n    const CTxDestination& destination,\r\n```",
      "commit_id" : "29b28d07fa958b89e1c7916fda5d8654474cf495",
      "created_at" : "2022-09-21T14:23:30Z",
      "diff_hunk" : "@@ -25,31 +26,97 @@\n  */\n const std::string MESSAGE_MAGIC = \"Bitcoin Signed Message:\\n\";\n \n+/**\n+ * BIP-322 tagged hash\n+ */\n+const HashWriter HASHER_BIP322 = TaggedHash(\"BIP0322-signed-message\");\n+\n+static constexpr unsigned int BIP322_REQUIRED_FLAGS =\n+    SCRIPT_VERIFY_CONST_SCRIPTCODE // disallows OP_CODESEPARATOR and FindAndDelete\n+|   SCRIPT_VERIFY_LOW_S\n+|   SCRIPT_VERIFY_STRICTENC\n+|   SCRIPT_VERIFY_NULLFAIL\n+|   SCRIPT_VERIFY_MINIMALDATA\n+|   SCRIPT_VERIFY_CLEANSTACK\n+|   SCRIPT_VERIFY_P2SH\n+|   SCRIPT_VERIFY_WITNESS\n+|   SCRIPT_VERIFY_TAPROOT\n+|   SCRIPT_VERIFY_MINIMALIF;\n+\n+static constexpr unsigned int BIP322_INCONCLUSIVE_FLAGS =\n+    SCRIPT_VERIFY_DISCOURAGE_OP_SUCCESS\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_PUBKEYTYPE\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_TAPROOT_VERSION\n+|   SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM;\n+\n+MessageVerificationResult MessageVerifyBIP322(\n+    CTxDestination& destination,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r976578163",
      "id" : 976578163,
      "line" : 53,
      "node_id" : "PRRC_kwDOABII5846NWZz",
      "original_commit_id" : "e54e5eef7898468ae38dc9936cc07a2521294357",
      "original_line" : 53,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 37,
      "pull_request_review_id" : 1115525729,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/976578163/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-07T10:58:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/976578163",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-09-24T14:58:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1256989038",
      "id" : 1256989038,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585K7CFu",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1256989038/reactions"
      },
      "updated_at" : "2022-09-24T14:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1256989038",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased and addressed some of @theStack's nits.  Thanks for the review.",
      "created_at" : "2022-09-26T06:44:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1257553675",
      "id" : 1257553675,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585K9L8L",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1257553675/reactions"
      },
      "updated_at" : "2022-09-26T06:44:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1257553675",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r1015281244"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1015281244"
         }
      },
      "author_association" : "MEMBER",
      "body" : "b32c238dd5bc413b4b03f99ae68f7e2b78b42d62\r\n```suggestion\r\n    if (!to_sign.vin[0].scriptSig.empty() || to_sign.vin[0].scriptWitness.IsNull()) {\r\n```",
      "commit_id" : "29b28d07fa958b89e1c7916fda5d8654474cf495",
      "created_at" : "2022-11-07T10:56:35Z",
      "diff_hunk" : "@@ -208,6 +208,47 @@ IsMineResult IsMineInner(const LegacyScriptPubKeyMan& keystore, const CScript& s\n \n } // namespace\n \n+SigningResult ScriptPubKeyMan::SignMessageBIP322(MessageSignatureFormat format, const SigningProvider* keystore, const std::string& message, const CTxDestination& address, std::string& str_sig) const\n+{\n+    assert(format != MessageSignatureFormat::LEGACY);\n+\n+    MessageVerificationResult result; // unused\n+    auto txs = BIP322Txs::Create(address, message, result);\n+    assert(txs);\n+\n+    const CTransaction& to_spend = txs->m_to_spend;\n+    CMutableTransaction to_sign(txs->m_to_sign);\n+\n+    // Create the \"unspent output\" map, consisting of the to_spend output\n+    std::map<COutPoint, Coin> coins;\n+    coins[to_sign.vin[0].prevout] = Coin(to_spend.vout[0], 1, false);\n+\n+    // Sign the transaction\n+    std::map<int, bilingual_str> errors;\n+    if (!::SignTransaction(to_sign, keystore, coins, SIGHASH_ALL, errors)) {\n+        // TODO: this may be a multisig which successfully signed but needed additional signatures\n+        return SigningResult::SIGNING_FAILED;\n+    }\n+\n+    // We force the format to FULL, if this turned out to be a legacy format (p2pkh) signature\n+    if (to_sign.vin[0].scriptSig.size() > 0 || to_sign.vin[0].scriptWitness.IsNull()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r1015281244",
      "id" : 1015281244,
      "line" : 234,
      "node_id" : "PRRC_kwDOABII5848g_Zc",
      "original_commit_id" : "29b28d07fa958b89e1c7916fda5d8654474cf495",
      "original_line" : 234,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/wallet/scriptpubkeyman.cpp",
      "position" : 27,
      "pull_request_review_id" : 1115525729,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1015281244/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-07T10:58:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1015281244",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r1026699565"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1026699565"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: could also name the last parameter here\r\n```suggestion\r\n    static std::optional<BIP322Txs> Create(const CTxDestination& destination, const std::string& message, MessageVerificationResult& result, std::optional<const std::vector<unsigned char>> signature = std::nullopt);\r\n```",
      "commit_id" : "29b28d07fa958b89e1c7916fda5d8654474cf495",
      "created_at" : "2022-11-18T17:30:37Z",
      "diff_hunk" : "@@ -101,4 +101,19 @@ uint256 MessageHash(const std::string& message, MessageSignatureFormat format);\n \n std::string SigningResultString(const SigningResult res);\n \n+/**\n+ * Generate the BIP-322 tx corresponding to the given challenge\n+ */\n+class BIP322Txs {\n+private:\n+    template<class T1, class T2>\n+    BIP322Txs(const T1& to_spend, const T2& to_sign) : m_to_spend{to_spend}, m_to_sign{to_sign} { }\n+\n+public:\n+    static std::optional<BIP322Txs> Create(const CTxDestination& destination, const std::string& message, MessageVerificationResult& result, std::optional<const std::vector<unsigned char>> = std::nullopt);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r1026699565",
      "id" : 1026699565,
      "line" : 113,
      "node_id" : "PRRC_kwDOABII5849MjEt",
      "original_commit_id" : "3b00ed9a52d91864665f074eadaafc179344ba56",
      "original_line" : 113,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/util/message.h",
      "position" : 13,
      "pull_request_review_id" : 1186516390,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1026699565/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-18T17:32:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1026699565",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r1148338733"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1148338733"
         }
      },
      "author_association" : "NONE",
      "body" : "I get this value in my implementation, yet it is not reflected in the BIP",
      "commit_id" : "29b28d07fa958b89e1c7916fda5d8654474cf495",
      "created_at" : "2023-03-25T09:27:25Z",
      "diff_hunk" : "@@ -2657,6 +2691,124 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+\n+    // BIP322 signature created using buidl-python library with same parameters as test on line 2596\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+         \"AkgwRQIhAOzyynlqt93lOKJr+wmmxIens//zPzl9tqIOua93wO6MAiBi5n5EyAcPScOjf1lAqIUIQtr3zKNeavYabHyR8eGhowEhAsfxIAMZZEKUPYWI4BruhAQjzFT8FSFSajuFwrDL1Yhy\",\n+            \"Hello World\"),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r1148338733",
      "id" : 1148338733,
      "line" : 2718,
      "node_id" : "PRRC_kwDOABII585EckIt",
      "original_commit_id" : "29b28d07fa958b89e1c7916fda5d8654474cf495",
      "original_line" : 2718,
      "original_position" : 105,
      "original_start_line" : 2717,
      "path" : "src/test/util_tests.cpp",
      "position" : 105,
      "pull_request_review_id" : 1357805235,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1148338733/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 2717,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-03-25T09:27:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1148338733",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1618764?v=4",
         "events_url" : "https://api.github.com/users/kyranjamie/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kyranjamie/followers",
         "following_url" : "https://api.github.com/users/kyranjamie/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kyranjamie/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kyranjamie",
         "id" : 1618764,
         "login" : "kyranjamie",
         "node_id" : "MDQ6VXNlcjE2MTg3NjQ=",
         "organizations_url" : "https://api.github.com/users/kyranjamie/orgs",
         "received_events_url" : "https://api.github.com/users/kyranjamie/received_events",
         "repos_url" : "https://api.github.com/users/kyranjamie/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kyranjamie/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kyranjamie/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kyranjamie"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@kallewoof could you leave a comment explaining why you closed this PR? It is not apparent from looking at the history of this PR what the state is of BIP-322 support in Bitcoin Core.",
      "created_at" : "2023-10-26T10:08:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1780813441",
      "id" : 1780813441,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585qJQ6B",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1780813441/reactions"
      },
      "updated_at" : "2023-10-26T10:08:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1780813441",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1225267?v=4",
         "events_url" : "https://api.github.com/users/benma/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benma/followers",
         "following_url" : "https://api.github.com/users/benma/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benma/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benma",
         "id" : 1225267,
         "login" : "benma",
         "node_id" : "MDQ6VXNlcjEyMjUyNjc=",
         "organizations_url" : "https://api.github.com/users/benma/orgs",
         "received_events_url" : "https://api.github.com/users/benma/received_events",
         "repos_url" : "https://api.github.com/users/benma/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benma/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benma/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benma"
      }
   }
]
