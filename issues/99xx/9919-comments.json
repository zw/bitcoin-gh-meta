[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r104290785"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104290785"
         }
      },
      "body" : "@theuni This is pretty ugly, but I don't quite know how to do this otherwise. My first intuition was to add the file to `libbitcoin_util_a_SOURCES`, however these can't depend on libevent as that is shared between all executables. There is no library that is shared between just `bitcoind` and `bitcoin-cli` and adding one just for this seems overkill.\r\n",
      "commit_id" : "695e854a0444bb5c81b1422494451f17db0b5f1e",
      "created_at" : "2017-03-04T16:00:20Z",
      "diff_hunk" : "@@ -377,6 +381,9 @@ bitcoind_LDADD += $(BOOST_LIBS) $(BDB_LIBS) $(SSL_LIBS) $(CRYPTO_LIBS) $(MINIUPN\n \n # bitcoin-cli binary #\n bitcoin_cli_SOURCES = bitcoin-cli.cpp\n+if BUILD_EVUNIX",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r104290785",
      "id" : 104290785,
      "original_commit_id" : "2f6a34c40c857db01429fd1f75959f2b749c2fac",
      "original_position" : 22,
      "path" : "src/Makefile.am",
      "position" : 22,
      "pull_request_review_id" : 25126204,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919",
      "updated_at" : "2017-03-12T14:11:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104290785",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Neat.",
      "created_at" : "2017-03-04T18:44:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#issuecomment-284172064",
      "id" : 284172064,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9919",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4NDE3MjA2NA==",
      "updated_at" : "2017-03-04T18:44:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/284172064",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This does not compile with `libevent2-2.0.22` which is OK with the current master.\r\n\r\n```\r\nbitcoin-cli.cpp:214:13: error: use of undeclared identifier `evhttp_connection_base_bufferevent_new'\r\n            evhttp_connection_base_bufferevent_new(base.get(), __null, bev, \"\", 0)\r\n            ^\r\n1 error generated.\r\n```\r\n\r\nhttps://github.com/libevent/libevent/blob/e7ff4ef2b4fc950a765008c18e74281cdb5e7668/whatsnew-2.1.txt#L422\r\n",
      "created_at" : "2017-03-04T19:46:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#issuecomment-284176052",
      "id" : 284176052,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9919",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4NDE3NjA1Mg==",
      "updated_at" : "2017-03-04T19:50:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/284176052",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/6848764?v=4",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "node_id" : "MDQ6VXNlcjY4NDg3NjQ=",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@paveljanik Yes, that needs a version `#ifdef`, that call doesn't exist in older versions of libevent, and on newer ones (until my patch lands) it ignores the current connection and tries to open a new one so that trick doesn't work. I'd recommend testing with my patched libevent. Alternatively comment out the bitcoin-cli change and test connecting with something else:\r\n- `nc -U <socket>` works, for example\r\n- curl also has a ` --unix-socket` parameter, but haven't tried it yet",
      "created_at" : "2017-03-04T21:05:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#issuecomment-284180780",
      "id" : 284180780,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9919",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4NDE4MDc4MA==",
      "updated_at" : "2017-03-04T21:05:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/284180780",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "For merge we should probably just not have the client version, then?\n\nStill, this is cool - lots of better auth controls can be applied to\nsockets than IPs :)\n\nOn 03/04/17 21:05, Wladimir J. van der Laan wrote:\n> @paveljanik <https://github.com/paveljanik> Yes, that needs a version\n> |#ifdef|, that call doesn't exist in older versions of libevent, and on\n> newer ones (until my patch lands) it ignores the current connection and\n> tries to open a new one so that trick doesn't work. I'd recommend\n> testing with my patched libevent. Alternatively comment out the\n> bitcoin-cli change and test connecting with something else:\n> \n>   * |nc -U <socket>| works, for example\n>   * curl also has a |--unix-socket| parameter, but haven't tried it yet\n> \n> Ã¢ÂÂ\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/9919#issuecomment-284180780>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AAnoHrbUK-rDkbYbVKJSmWq4tqSJyg64ks5ridILgaJpZM4MTHvN>.\n> \n",
      "created_at" : "2017-03-04T21:21:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#issuecomment-284182742",
      "id" : 284182742,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9919",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4NDE4Mjc0Mg==",
      "updated_at" : "2017-03-04T21:21:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/284182742",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "node_id" : "MDQ6VXNlcjY0OTI0Ng==",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> For merge we should probably just not have the client version, then?\r\n\r\nWould prefer putting it behind `#ifdef EXPERIMENTAL_LIBEVENT` or such, with a comment that it can be replaced with the appropriate version comparison when it lands in a version. That way, people that compile their own stuff can use it already.",
      "created_at" : "2017-03-04T21:27:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#issuecomment-284183850",
      "id" : 284183850,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9919",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4NDE4Mzg1MA==",
      "updated_at" : "2017-03-04T21:27:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/284183850",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Still, this is cool - lots of better auth controls can be applied to\r\nsockets than IPs :)\r\n\r\nIndeed. Default permissions of the socket will be `700` due to our umask setting (can be overridden with `-sysperms`), which seems okay:\r\n```\r\nsrwx------  1 user user          0 Mar  5 11:40 socket\r\n```",
      "created_at" : "2017-03-05T10:43:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#issuecomment-284219635",
      "id" : 284219635,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9919",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4NDIxOTYzNQ==",
      "updated_at" : "2017-03-05T10:44:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/284219635",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This is great!\r\nConcept ACK.",
      "created_at" : "2017-03-06T08:30:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#issuecomment-284332202",
      "id" : 284332202,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9919",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4NDMzMjIwMg==",
      "updated_at" : "2017-03-06T08:30:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/284332202",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Added a commit that makes the tests' RPC run over UNIX sockets on platforms that support it, except for a few tests that make explicit assumptions about running over TCP/IP.",
      "created_at" : "2017-03-06T16:54:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#issuecomment-284458365",
      "id" : 284458365,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9919",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4NDQ1ODM2NQ==",
      "updated_at" : "2017-03-06T16:54:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/284458365",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I've been trying to test this locally by running the qa tests. Something that I do quite often is to run the tests with --noshutdown, wait for the test to fail, and use bitcoin-cli to interactively run RPCs on the test nodes:\r\n\r\n`bitcoin.conf -conf=<test temp directory>/node<x>/bitcoin.conf`\r\n\r\nWith this PR, I'm not able to do that anymore because the conf file doesn't contain the username/password, and even when I add them back in, I get the error:\r\n\r\n```\r\n/tmp/user/1000/test_6o70u2b/28404/node0\r\nÃ¢ÂÂ ~/bitcoin/src/bitcoin-cli -rpcconnect=\":unix:rpc_socket\" -datadir=/tmp/user/1000/test_6o70u2b/28404/node0 help\r\n[warn] evhttp_connection_connect_: connection to \"\" failed: No such file or directory\r\nerror: couldn't connect to server: unknown (code -1)\r\n(make sure server is running and you are connecting to the correct RPC port)\r\n/tmp/user/1000/test_6o70u2b/28404/node0\r\nÃ¢ÂÂ ll\r\ntotal 16\r\ndrwxrwxr-x 3 ubuntu ubuntu 4096 Mar  6 23:31 ./\r\ndrwxrwxr-x 4 ubuntu ubuntu 4096 Mar  6 23:11 ../\r\n-rw-rw-r-- 1 ubuntu ubuntu   79 Mar  6 23:20 bitcoin.conf\r\ndrwx------ 5 ubuntu ubuntu 4096 Mar  6 23:26 regtest/\r\nsrwx------ 1 ubuntu ubuntu    0 Mar  6 23:11 rpc_socket=\r\n```\r\n\r\nDo you have a better way of connecting to a test node during qa testing?",
      "created_at" : "2017-03-06T23:41:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#issuecomment-284571556",
      "id" : 284571556,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9919",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4NDU3MTU1Ng==",
      "updated_at" : "2017-03-06T23:41:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/284571556",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> With this PR, I'm not able to do that anymore because the conf file doesn't contain the username/password, and even when I add them back in, I get the error:\r\n\r\nRight, I could change it to add the options (including `-rpcconnect`) to the bitcoin.conf. \r\n\r\n> And even when I add them back in, I get the error:\r\n\r\nThe above should work, though. That's exactly how I've been testing it. The connection failure is strange. Did you patch libevent so that `bitcoin-cli` is able to connect to UNIX sockets? (you did add `LIBEVENT_EXPERIMENTAL` otherwise you'd be getting a `RPC was asked to connect to a UNIX socket. However, the version of libevent that this utility was compiled with has no support for that.` error when specifying `:unix:`)\r\n\r\n> Do you have a better way of connecting to a test node during qa testing?\r\n\r\nI'll add an environment variable to force running the RPC tests over TCP.",
      "created_at" : "2017-03-07T05:59:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#issuecomment-284629971",
      "id" : 284629971,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9919",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4NDYyOTk3MQ==",
      "updated_at" : "2017-03-07T06:36:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/284629971",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jnewbery Okay, added two commits:\r\n- add `BITCOIN_TEST_RPC_TCP` environment variable to force tests to use TCP instead of UNIX sockets for RPC\r\n- write connection info to `bitcoin.conf` instead of providing it on the command line. `-conf` should just work, also for UNIX sockets, if your client supports it.\r\n",
      "created_at" : "2017-03-07T07:03:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#issuecomment-284639336",
      "id" : 284639336,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9919",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4NDYzOTMzNg==",
      "updated_at" : "2017-03-07T07:07:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/284639336",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Needed rebase, so rebased and squashed the squasme: commits.",
      "created_at" : "2017-03-09T08:23:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#issuecomment-285285667",
      "id" : 285285667,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9919",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4NTI4NTY2Nw==",
      "updated_at" : "2017-03-09T08:23:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285285667",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "F.I.Y:\r\nI wanted to test this via binaries built in gitian.\r\nI could start the daemon (wanted to test in conjunction with Q): ` ./bitcoin-0.14.99/bin/bitcoin-qt -debug=rpc -debug=http -rpcbind=nix:socket --regtest`\r\n\r\nHowever the CLI responded with:\r\n`error: RPC was asked to connect to a UNIX socket. However, the version of libevent that this utility was compiled with has no support for that.`\r\n\r\nMaybe we should bump libevent in the dependencies directory?",
      "created_at" : "2017-03-09T08:32:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#issuecomment-285287406",
      "id" : 285287406,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9919",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4NTI4NzQwNg==",
      "updated_at" : "2017-03-09T08:32:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285287406",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> However the CLI responded with:\r\n\r\nYes, that's expected. `bitcoin-cli` support needs this patch: https://github.com/laanwj/libevent/commit/403b793771341460b262edb1abc31fae267174bd.patch  as well as defining `-DLIBEVENT_EXPERIMENTAL`\r\n\r\nWithout, you should still be able to use the socket with other clients, for example from Python or with curl. The server-side support is not dependent on that patch.\r\n\r\nThis could be done as part of the depends system, but rather not in this PR as it is a wholly separate discussion.\r\n",
      "created_at" : "2017-03-09T08:39:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#issuecomment-285288774",
      "id" : 285288774,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9919",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4NTI4ODc3NA==",
      "updated_at" : "2017-03-09T08:48:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285288774",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased (RPC tests logging changes #9768)",
      "created_at" : "2017-03-12T12:07:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#issuecomment-285940308",
      "id" : 285940308,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9919",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4NTk0MDMwOA==",
      "updated_at" : "2017-03-12T12:07:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285940308",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Oops, I accidentally did my review of this code on the other PR. See here https://github.com/bitcoin/bitcoin/pull/9979#pullrequestreview-31071186",
      "created_at" : "2017-04-05T16:30:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#issuecomment-291918623",
      "id" : 291918623,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9919",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI5MTkxODYyMw==",
      "updated_at" : "2017-04-05T16:30:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/291918623",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r115097428"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/115097428"
         }
      },
      "body" : "In commit \"rpc: UNIX sockets support\"\r\n\r\nMaybe add a sock_from_path function to dedup code between evunix_bind_fd & evunix_connect_fd a little more.",
      "commit_id" : "695e854a0444bb5c81b1422494451f17db0b5f1e",
      "created_at" : "2017-05-05T22:18:32Z",
      "diff_hunk" : "@@ -0,0 +1,107 @@\n+// Copyright (c) 2017 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include \"evunix.h\"\n+\n+#include <sys/socket.h>\n+#include <sys/un.h>\n+\n+#include <event2/bufferevent.h>\n+#include <boost/filesystem/operations.hpp>\n+\n+/** Helper function to initialize a sockaddr_un from a path */\n+static bool sockaddr_from_path(struct sockaddr_un *addr, const boost::filesystem::path &path)\n+{\n+    std::string name = path.string();\n+    if (name.size() >= sizeof(addr->sun_path)) {\n+        /* Name too long */\n+        return false;\n+    }\n+    memset(addr, 0, sizeof(struct sockaddr_un));\n+    addr->sun_family = AF_UNIX;\n+    strncpy(addr->sun_path, name.c_str(), sizeof(addr->sun_path)-1);\n+    return true;\n+}\n+\n+bool evunix_remove_socket(const boost::filesystem::path &path)\n+{\n+    if (boost::filesystem::status(path).type() == boost::filesystem::socket_file) {\n+        boost::system::error_code ec;\n+        boost::filesystem::remove(path, ec);\n+        if (ec) { /* error while deleting */\n+            return false;\n+        }\n+    }\n+    return true;\n+}\n+\n+int evunix_bind_fd(const boost::filesystem::path &path)\n+{\n+    struct sockaddr_un addr;\n+    if (!sockaddr_from_path(&addr, path)) {\n+        return -1;\n+    }\n+    int fd = socket(AF_UNIX, SOCK_STREAM, 0);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r115097428",
      "id" : 115097428,
      "original_commit_id" : "45fad466d1b25478b384a3535460b6f679b3788c",
      "original_position" : 44,
      "path" : "src/support/evunix.cpp",
      "position" : 44,
      "pull_request_review_id" : 36620400,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919",
      "updated_at" : "2017-05-08T17:15:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/115097428",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r115272000"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/115272000"
         }
      },
      "body" : "In commit \"rpc: UNIX sockets support\"\r\n\r\nNaming of BUILD_EVUNIX seems a little unusual. Would expect something more like ENABLE_UNIX_SOCKETS (to be similar to ENABLE_WALLET, ENABLE_QT, ENABLE_ZMQ, etc).\r\n\r\nMaybe more to the point though, since BUILD_EVUNIX is only used to control building of a single source file, maybe consider not defining it as build variable at all and just using `#if HAVE_SOCKADDR_UN` in the c++ source. I think this makes sense since you are already using HAVE_SOCKADDR_UN to avoid calling evunix functions, so you might as well use the same variable to avoid defining those functions.",
      "commit_id" : "695e854a0444bb5c81b1422494451f17db0b5f1e",
      "created_at" : "2017-05-08T15:11:04Z",
      "diff_hunk" : "@@ -601,6 +601,21 @@ AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[#include <sys/types.h>\n  [ AC_MSG_RESULT(no)]\n )\n \n+# Check for UNIX sockets\n+AC_MSG_CHECKING(for sockaddr_un)\n+AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[#include <sys/socket.h>\n+  #include <sys/un.h>]],\n+ [[ struct sockaddr_un addr;\n+    addr.sun_family = AF_UNIX; ]])],\n+ [ AC_MSG_RESULT(yes);\n+   AC_DEFINE(HAVE_SOCKADDR_UN, 1,[Define this symbol if the sockaddr_un is available]) \n+   AM_CONDITIONAL([BUILD_EVUNIX],[true])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r115272000",
      "id" : 115272000,
      "original_commit_id" : "45fad466d1b25478b384a3535460b6f679b3788c",
      "original_position" : 12,
      "path" : "configure.ac",
      "position" : 12,
      "pull_request_review_id" : 36620400,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919",
      "updated_at" : "2017-05-08T17:15:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/115272000",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r115274495"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/115274495"
         }
      },
      "body" : "In commit \"rpc: UNIX sockets support\"\r\n\r\nMaybe consider deduping the path manipulation code with the same code in bitcoin-cli",
      "commit_id" : "695e854a0444bb5c81b1422494451f17db0b5f1e",
      "created_at" : "2017-05-08T15:21:12Z",
      "diff_hunk" : "@@ -351,6 +359,40 @@ static bool HTTPBindAddresses(struct evhttp* http)\n             LogPrintf(\"Binding RPC on address %s port %i failed.\\n\", i->first, i->second);\n         }\n     }\n+\n+    // UNIX socket binding: this is done in a separate pass because it does not care whether\n+    // `-rpcallowip` is set.\n+    if (mapMultiArgs.count(\"-rpcbind\")) {\n+        const std::vector<std::string>& vbind = mapMultiArgs.at(\"-rpcbind\");\n+        for (std::vector<std::string>::const_iterator i = vbind.begin(); i != vbind.end(); ++i) {\n+            if (boost::starts_with(*i, RPC_ADDR_PREFIX_UNIX)) {\n+#ifdef HAVE_SOCKADDR_UN\n+                boost::filesystem::path name = boost::filesystem::path(i->substr(RPC_ADDR_PREFIX_UNIX.size()));\n+                int fd;\n+                evhttp_bound_socket *bind_handle = 0;\n+\n+                // If path is not complete, it is interpreted relative to the data directory.\n+                if (!name.is_complete()) {\n+                    name = GetDataDir(true) / name;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r115274495",
      "id" : 115274495,
      "original_commit_id" : "45fad466d1b25478b384a3535460b6f679b3788c",
      "original_position" : 53,
      "path" : "src/httpserver.cpp",
      "position" : 53,
      "pull_request_review_id" : 36620400,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919",
      "updated_at" : "2017-05-08T17:15:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/115274495",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r115281634"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/115281634"
         }
      },
      "body" : "In commit \"rpc: UNIX sockets support\"\r\n\r\nSeems like this instead of emulating an NET_IPV6 address, this should have it's own network type in `netaddress.h` similar to `NET_TOR`.",
      "commit_id" : "695e854a0444bb5c81b1422494451f17db0b5f1e",
      "created_at" : "2017-05-08T15:48:03Z",
      "diff_hunk" : "@@ -619,6 +667,12 @@ CService HTTPRequest::GetPeer()\n         const char* address = \"\";\n         uint16_t port = 0;\n         evhttp_connection_get_peer(con, (char**)&address, &port);\n+        if (!strcmp(address, \"localhost\")) {\n+            /* Special: will get here for UNIX sockets. As we have no way to indicate that,\n+             * just pass localhost IPv6.\n+             */\n+            address = \"::1\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r115281634",
      "id" : 115281634,
      "original_commit_id" : "45fad466d1b25478b384a3535460b6f679b3788c",
      "original_position" : 97,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 36620400,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919",
      "updated_at" : "2017-05-08T17:15:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/115281634",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r115287259"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/115287259"
         }
      },
      "body" : "In commit \"rpc: UNIX sockets support\"\r\n\r\nWould it be possible to throw an exception here? Since the path comes from the user's configuration it seems like it would be better to provide a specific error about the path than a generic connect or bind error.",
      "commit_id" : "695e854a0444bb5c81b1422494451f17db0b5f1e",
      "created_at" : "2017-05-08T16:09:12Z",
      "diff_hunk" : "@@ -0,0 +1,107 @@\n+// Copyright (c) 2017 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include \"evunix.h\"\n+\n+#include <sys/socket.h>\n+#include <sys/un.h>\n+\n+#include <event2/bufferevent.h>\n+#include <boost/filesystem/operations.hpp>\n+\n+/** Helper function to initialize a sockaddr_un from a path */\n+static bool sockaddr_from_path(struct sockaddr_un *addr, const boost::filesystem::path &path)\n+{\n+    std::string name = path.string();\n+    if (name.size() >= sizeof(addr->sun_path)) {\n+        /* Name too long */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r115287259",
      "id" : 115287259,
      "original_commit_id" : "45fad466d1b25478b384a3535460b6f679b3788c",
      "original_position" : 17,
      "path" : "src/support/evunix.cpp",
      "position" : 17,
      "pull_request_review_id" : 36620400,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919",
      "updated_at" : "2017-05-08T17:15:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/115287259",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r115290287"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/115290287"
         }
      },
      "body" : "In commit \"rpc: More robust localhost-UNIX detection\"\r\n\r\nWould it be better to use getsockname than getpeername for this? Seems like maybe that would work even on a socket that isn't connected.",
      "commit_id" : "695e854a0444bb5c81b1422494451f17db0b5f1e",
      "created_at" : "2017-05-08T16:23:01Z",
      "diff_hunk" : "@@ -84,6 +84,18 @@ int evunix_connect_fd(const boost::filesystem::path &path)\n     return fd;\n }\n \n+bool evunix_is_conn_from_unix_fd(int fd)\n+{\n+    struct sockaddr_un peer_unix;\n+    socklen_t peer_unix_len = sizeof(peer_unix);\n+    if (getpeername(fd, (sockaddr*)&peer_unix, &peer_unix_len) == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r115290287",
      "id" : 115290287,
      "original_commit_id" : "695e854a0444bb5c81b1422494451f17db0b5f1e",
      "original_position" : 8,
      "path" : "src/support/evunix.cpp",
      "position" : 91,
      "pull_request_review_id" : 36620400,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919",
      "updated_at" : "2017-05-08T17:15:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/115290287",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r115292019"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/115292019"
         }
      },
      "body" : "In commit \"tests: Run RPC tests optionally over UNIX socket\"\r\n\r\nProbably should inherit from RPCConnectInfo. Same with RPCConnectInfoUNIX class below. Doesn't really affect anything, but might make generated documentation / help messages a little better.",
      "commit_id" : "695e854a0444bb5c81b1422494451f17db0b5f1e",
      "created_at" : "2017-05-08T16:31:00Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+import os\n+\n+from .uhttpconnection import UHTTPConnection\n+\n+# UNIX socket name for RPC connection (in data directory)\n+RPC_SOCKET_NAME = \"rpc_socket\"\n+\n+class RPCConnectInfo:\n+    '''\n+    Base class for RPC connection info. This class encapsulates both information\n+    required to connect to RPC, as to configure bitcoind to listen on that transport.\n+    '''\n+    def make_connection(self):\n+        '''\n+        Returns the 'connection' argument to pass to the RPCAuthService.\n+        Can be None to let that class figure it out itself.\n+        '''\n+        raise NotImplementedError\n+\n+    @property\n+    def bitcoind_args(self):\n+        '''\n+        Return arguments for setting up bitcoind.\n+        '''\n+        raise NotImplementedError\n+\n+class RPCConnectInfoTCP:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r115292019",
      "id" : 115292019,
      "original_commit_id" : "6218b113282a7464d2da2d531f2cd69bf919f4de",
      "original_position" : 31,
      "path" : "qa/rpc-tests/test_framework/conninfo.py",
      "position" : 31,
      "pull_request_review_id" : 36620400,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919",
      "updated_at" : "2017-05-08T17:15:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/115292019",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r115292289"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/115292289"
         }
      },
      "body" : "In commit \"tests: Run RPC tests optionally over UNIX socket\"\r\n\r\ns/urlinfo/conninfo/",
      "commit_id" : "695e854a0444bb5c81b1422494451f17db0b5f1e",
      "created_at" : "2017-05-08T16:32:23Z",
      "diff_hunk" : "@@ -69,11 +71,10 @@ def enable_coverage(dirname):\n     COVERAGE_DIR = dirname\n \n \n-def get_rpc_proxy(url, node_number, timeout=None):\n+def get_rpc_proxy(conninfo, timeout=None):\n     \"\"\"\n     Args:\n-        url (str): URL of the RPC server to call\n-        node_number (int): the node number (or id) that this calls to\n+        urlinfo (RPCConnectInfo): Connection info of the RPC server to call",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r115292289",
      "id" : 115292289,
      "original_commit_id" : "6218b113282a7464d2da2d531f2cd69bf919f4de",
      "original_position" : 19,
      "path" : "qa/rpc-tests/test_framework/util.py",
      "position" : 19,
      "pull_request_review_id" : 36620400,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919",
      "updated_at" : "2017-05-08T17:15:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/115292289",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I've had a quick read through the changes to the functional tests, but I'll defer doing a full review until this is rebased. A few general comments:\r\n\r\n- I'd prefer a command line argument over and environment variable for `BITCOIN_TEST_RPC_TCP`, partly because adding a command line argument means the help text will be updated and the option will be better documented.\r\n- there's a response to your libevent PR here: https://github.com/libevent/libevent/pull/479. It'd be good to the functionality merged into libevent so we can avoid the `LIBEVENT_EXPERIMENTAL` stuff\r\n- I also think it would be better to make the changes to the functional test framework after TestNode changes in #10082 are in. I really dislike having state for nodes floating around in util.py (eg the new `conninfo_for()` function)",
      "created_at" : "2017-05-09T20:58:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#issuecomment-300299405",
      "id" : 300299405,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9919",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDMwMDI5OTQwNQ==",
      "updated_at" : "2017-05-09T20:58:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/300299405",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r119969216"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/119969216"
         }
      },
      "body" : "I think this is OK. I think we'll end up with a few wrappers for libevent, so moving those to their own internal helper lib will  make sense.",
      "commit_id" : "695e854a0444bb5c81b1422494451f17db0b5f1e",
      "created_at" : "2017-06-02T23:26:15Z",
      "diff_hunk" : "@@ -377,6 +381,9 @@ bitcoind_LDADD += $(BOOST_LIBS) $(BDB_LIBS) $(SSL_LIBS) $(CRYPTO_LIBS) $(MINIUPN\n \n # bitcoin-cli binary #\n bitcoin_cli_SOURCES = bitcoin-cli.cpp\n+if BUILD_EVUNIX",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r119969216",
      "id" : 119969216,
      "original_commit_id" : "2f6a34c40c857db01429fd1f75959f2b749c2fac",
      "original_position" : 22,
      "path" : "src/Makefile.am",
      "position" : 22,
      "pull_request_review_id" : 41903025,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919",
      "updated_at" : "2017-06-02T23:55:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/119969216",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r119969737"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/119969737"
         }
      },
      "body" : "+1. This seems like another good use-case for NET_INTERNAL from #10446 (or something similar). As a bonus, that would allow us to use associative containers for unix socket addresses, since each path would have its own hash.",
      "commit_id" : "695e854a0444bb5c81b1422494451f17db0b5f1e",
      "created_at" : "2017-06-02T23:32:51Z",
      "diff_hunk" : "@@ -619,6 +667,12 @@ CService HTTPRequest::GetPeer()\n         const char* address = \"\";\n         uint16_t port = 0;\n         evhttp_connection_get_peer(con, (char**)&address, &port);\n+        if (!strcmp(address, \"localhost\")) {\n+            /* Special: will get here for UNIX sockets. As we have no way to indicate that,\n+             * just pass localhost IPv6.\n+             */\n+            address = \"::1\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r119969737",
      "id" : 119969737,
      "original_commit_id" : "45fad466d1b25478b384a3535460b6f679b3788c",
      "original_position" : 97,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 41903025,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919",
      "updated_at" : "2017-06-02T23:55:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/119969737",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r119970411"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/119970411"
         }
      },
      "body" : "need to disable SIGPIPE here too?",
      "commit_id" : "695e854a0444bb5c81b1422494451f17db0b5f1e",
      "created_at" : "2017-06-02T23:41:17Z",
      "diff_hunk" : "@@ -0,0 +1,107 @@\n+// Copyright (c) 2017 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#include \"evunix.h\"\n+\n+#include <sys/socket.h>\n+#include <sys/un.h>\n+\n+#include <event2/bufferevent.h>\n+#include <boost/filesystem/operations.hpp>\n+\n+/** Helper function to initialize a sockaddr_un from a path */\n+static bool sockaddr_from_path(struct sockaddr_un *addr, const boost::filesystem::path &path)\n+{\n+    std::string name = path.string();\n+    if (name.size() >= sizeof(addr->sun_path)) {\n+        /* Name too long */\n+        return false;\n+    }\n+    memset(addr, 0, sizeof(struct sockaddr_un));\n+    addr->sun_family = AF_UNIX;\n+    strncpy(addr->sun_path, name.c_str(), sizeof(addr->sun_path)-1);\n+    return true;\n+}\n+\n+bool evunix_remove_socket(const boost::filesystem::path &path)\n+{\n+    if (boost::filesystem::status(path).type() == boost::filesystem::socket_file) {\n+        boost::system::error_code ec;\n+        boost::filesystem::remove(path, ec);\n+        if (ec) { /* error while deleting */\n+            return false;\n+        }\n+    }\n+    return true;\n+}\n+\n+int evunix_bind_fd(const boost::filesystem::path &path)\n+{\n+    struct sockaddr_un addr;\n+    if (!sockaddr_from_path(&addr, path)) {\n+        return -1;\n+    }\n+    int fd = socket(AF_UNIX, SOCK_STREAM, 0);\n+    if (fd < 0) {\n+        return -1;\n+    }\n+    /* Remove any previous sockets left behind. listen() will refuse to overwrite\n+     * any file or socket. Remove only sockets, not other files that happen to have\n+     * the same name.\n+     */\n+    if (!evunix_remove_socket(path)) {\n+        close(fd);\n+        return -1;\n+    }\n+    /* Bind and listen */\n+    if (bind(fd, (struct sockaddr*)&addr, sizeof(addr)) < 0) {\n+        close(fd);\n+        return -1;\n+    }\n+    if (listen(fd, 5) < 0) {\n+        close(fd);\n+        return -1;\n+    }\n+    evutil_make_socket_nonblocking(fd);\n+    return fd;\n+}\n+\n+int evunix_connect_fd(const boost::filesystem::path &path)\n+{\n+    struct sockaddr_un addr;\n+    if (!sockaddr_from_path(&addr, path)) {\n+        return -1;\n+    }\n+    int fd = socket(AF_UNIX, SOCK_STREAM, 0);\n+    if (fd < 0) {\n+        return -1;\n+    }\n+    if (connect(fd, (struct sockaddr*)&addr, sizeof(addr)) < 0) {\n+        close(fd);\n+        return -1;\n+    }\n+    evutil_make_socket_nonblocking(fd);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r119970411",
      "id" : 119970411,
      "original_commit_id" : "45fad466d1b25478b384a3535460b6f679b3788c",
      "original_position" : 83,
      "path" : "src/support/evunix.cpp",
      "position" : 83,
      "pull_request_review_id" : 41903025,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919",
      "updated_at" : "2017-06-02T23:55:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/119970411",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r119971386"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/119971386"
         }
      },
      "body" : "should probably .clear() in case this gets called twice.",
      "commit_id" : "695e854a0444bb5c81b1422494451f17db0b5f1e",
      "created_at" : "2017-06-02T23:54:45Z",
      "diff_hunk" : "@@ -505,6 +547,12 @@ void StopHTTPServer()\n         event_base_free(eventBase);\n         eventBase = 0;\n     }\n+#ifdef HAVE_SOCKADDR_UN\n+    //! Clean up UNIX sockets on shutdown\n+    for (const auto& path: cleanupUNIXSockets) {\n+         evunix_remove_socket(path);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#discussion_r119971386",
      "id" : 119971386,
      "original_commit_id" : "45fad466d1b25478b384a3535460b6f679b3788c",
      "original_position" : 83,
      "path" : "src/httpserver.cpp",
      "position" : 83,
      "pull_request_review_id" : 41903025,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9919",
      "updated_at" : "2017-06-02T23:55:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/119971386",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Closing this for now. I'll probably pick it up again for 0.16.",
      "created_at" : "2017-06-24T11:31:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#issuecomment-310833262",
      "id" : 310833262,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9919",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDMxMDgzMzI2Mg==",
      "updated_at" : "2017-06-24T11:31:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/310833262",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. c-lightning does this too FWIW.\r\n\r\nThis was [briefly discussed](http://www.erisian.com.au/bitcoin-core-dev/log-2018-10-25.html#l-901) during the meeting today. Tag as Up for Grabs?",
      "created_at" : "2018-10-26T04:32:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9919#issuecomment-433283269",
      "id" : 433283269,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9919",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQzMzI4MzI2OQ==",
      "updated_at" : "2018-10-26T04:32:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/433283269",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   }
]
