[
   {
      "author_association" : "MEMBER",
      "body" : ">+13 Ã¢ÂÂ67\r\n\r\nconcept ACK, note that this will now include pubkeys you have, not only private keys, which I think is a more sane general anyways.",
      "created_at" : "2018-11-27T20:51:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14821#issuecomment-442212476",
      "id" : 442212476,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14821",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0MjIxMjQ3Ng==",
      "updated_at" : "2018-11-27T20:52:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/442212476",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#14144](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14144.html) (Refactoring: Clarify code using encrypted_batch in CWallet by domob1812)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2018-11-27T22:31:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14821#issuecomment-442242985",
      "id" : 442242985,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14821",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0MjI0Mjk4NQ==",
      "updated_at" : "2018-11-27T22:31:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/442242985",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2018-11-28T06:16:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14821#issuecomment-442332917",
      "id" : 442332917,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14821",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0MjMzMjkxNw==",
      "updated_at" : "2018-11-28T06:16:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/442332917",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/MeshCollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MeshCollider/followers",
         "following_url" : "https://api.github.com/users/MeshCollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MeshCollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MeshCollider",
         "id" : 3211283,
         "login" : "MeshCollider",
         "node_id" : "MDQ6VXNlcjMyMTEyODM=",
         "organizations_url" : "https://api.github.com/users/MeshCollider/orgs",
         "received_events_url" : "https://api.github.com/users/MeshCollider/received_events",
         "repos_url" : "https://api.github.com/users/MeshCollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MeshCollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MeshCollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MeshCollider"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14821#discussion_r237017307"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14821"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/237017307"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, `static`. Could also keep some comment. ",
      "commit_id" : "0e75f44a09ed07ff5eeeb142a4cefc4aba0ddf32",
      "created_at" : "2018-11-28T10:10:45Z",
      "diff_hunk" : "@@ -104,67 +105,17 @@ std::string COutput::ToString() const\n     return strprintf(\"COutput(%s, %d, %d) [%s]\", tx->GetHash().ToString(), i, nDepth, FormatMoney(tx->tx->vout[i].nValue));\n }\n \n-/** A class to identify which pubkeys a script and a keystore have in common. */\n-class CAffectedKeysVisitor : public boost::static_visitor<void> {\n-private:\n-    const CKeyStore &keystore;\n-    std::vector<CKeyID> &vKeys;\n-\n-public:\n-    /**\n-     * @param[in] keystoreIn The CKeyStore that is queried for the presence of a pubkey.\n-     * @param[out] vKeysIn A vector to which a script's pubkey identifiers are appended if they are in the keystore.\n-     */\n-    CAffectedKeysVisitor(const CKeyStore &keystoreIn, std::vector<CKeyID> &vKeysIn) : keystore(keystoreIn), vKeys(vKeysIn) {}\n-\n-    /**\n-     * Apply the visitor to each destination in a script, recursively to the redeemscript\n-     * in the case of p2sh destinations.\n-     * @param[in] script The CScript from which destinations are extracted.\n-     * @post Any CKeyIDs that script and keystore have in common are appended to the visitor's vKeys.\n-     */\n-    void Process(const CScript &script) {\n-        txnouttype type;\n-        std::vector<CTxDestination> vDest;\n-        int nRequired;\n-        if (ExtractDestinations(script, type, vDest, nRequired)) {\n-            for (const CTxDestination &dest : vDest)\n-                boost::apply_visitor(*this, dest);\n-        }\n-    }\n-\n-    void operator()(const CKeyID &keyId) {\n-        if (keystore.HaveKey(keyId))\n-            vKeys.push_back(keyId);\n-    }\n-\n-    void operator()(const CScriptID &scriptId) {\n-        CScript script;\n-        if (keystore.GetCScript(scriptId, script))\n-            Process(script);\n-    }\n-\n-    void operator()(const WitnessV0ScriptHash& scriptID)\n-    {\n-        CScriptID id;\n-        CRIPEMD160().Write(scriptID.begin(), 32).Finalize(id.begin());\n-        CScript script;\n-        if (keystore.GetCScript(id, script)) {\n-            Process(script);\n-        }\n-    }\n-\n-    void operator()(const WitnessV0KeyHash& keyid)\n-    {\n-        CKeyID id(keyid);\n-        if (keystore.HaveKey(id)) {\n-            vKeys.push_back(id);\n-        }\n+std::vector<CKeyID> GetAffectedKeys(const CScript& spk, const SigningProvider& provider)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14821#discussion_r237017307",
      "id" : 237017307,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzNzAxNzMwNw==",
      "original_commit_id" : "0e75f44a09ed07ff5eeeb142a4cefc4aba0ddf32",
      "original_position" : 68,
      "path" : "src/wallet/wallet.cpp",
      "position" : 68,
      "pull_request_review_id" : 179214063,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14821",
      "updated_at" : "2018-11-28T10:20:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/237017307",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14821#discussion_r237138464"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14821"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/237138464"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Could even make it more specific with the updated behavior.",
      "commit_id" : "0e75f44a09ed07ff5eeeb142a4cefc4aba0ddf32",
      "created_at" : "2018-11-28T15:42:20Z",
      "diff_hunk" : "@@ -104,67 +105,17 @@ std::string COutput::ToString() const\n     return strprintf(\"COutput(%s, %d, %d) [%s]\", tx->GetHash().ToString(), i, nDepth, FormatMoney(tx->tx->vout[i].nValue));\n }\n \n-/** A class to identify which pubkeys a script and a keystore have in common. */\n-class CAffectedKeysVisitor : public boost::static_visitor<void> {\n-private:\n-    const CKeyStore &keystore;\n-    std::vector<CKeyID> &vKeys;\n-\n-public:\n-    /**\n-     * @param[in] keystoreIn The CKeyStore that is queried for the presence of a pubkey.\n-     * @param[out] vKeysIn A vector to which a script's pubkey identifiers are appended if they are in the keystore.\n-     */\n-    CAffectedKeysVisitor(const CKeyStore &keystoreIn, std::vector<CKeyID> &vKeysIn) : keystore(keystoreIn), vKeys(vKeysIn) {}\n-\n-    /**\n-     * Apply the visitor to each destination in a script, recursively to the redeemscript\n-     * in the case of p2sh destinations.\n-     * @param[in] script The CScript from which destinations are extracted.\n-     * @post Any CKeyIDs that script and keystore have in common are appended to the visitor's vKeys.\n-     */\n-    void Process(const CScript &script) {\n-        txnouttype type;\n-        std::vector<CTxDestination> vDest;\n-        int nRequired;\n-        if (ExtractDestinations(script, type, vDest, nRequired)) {\n-            for (const CTxDestination &dest : vDest)\n-                boost::apply_visitor(*this, dest);\n-        }\n-    }\n-\n-    void operator()(const CKeyID &keyId) {\n-        if (keystore.HaveKey(keyId))\n-            vKeys.push_back(keyId);\n-    }\n-\n-    void operator()(const CScriptID &scriptId) {\n-        CScript script;\n-        if (keystore.GetCScript(scriptId, script))\n-            Process(script);\n-    }\n-\n-    void operator()(const WitnessV0ScriptHash& scriptID)\n-    {\n-        CScriptID id;\n-        CRIPEMD160().Write(scriptID.begin(), 32).Finalize(id.begin());\n-        CScript script;\n-        if (keystore.GetCScript(id, script)) {\n-            Process(script);\n-        }\n-    }\n-\n-    void operator()(const WitnessV0KeyHash& keyid)\n-    {\n-        CKeyID id(keyid);\n-        if (keystore.HaveKey(id)) {\n-            vKeys.push_back(id);\n-        }\n+std::vector<CKeyID> GetAffectedKeys(const CScript& spk, const SigningProvider& provider)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14821#discussion_r237138464",
      "id" : 237138464,
      "in_reply_to_id" : 237017307,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzNzEzODQ2NA==",
      "original_commit_id" : "0e75f44a09ed07ff5eeeb142a4cefc4aba0ddf32",
      "original_position" : 68,
      "path" : "src/wallet/wallet.cpp",
      "position" : 68,
      "pull_request_review_id" : 179364061,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14821",
      "updated_at" : "2018-11-28T15:42:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/237138464",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK https://github.com/bitcoin/bitcoin/pull/14821/commits/0e75f44a09ed07ff5eeeb142a4cefc4aba0ddf32",
      "created_at" : "2018-11-30T21:17:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14821#issuecomment-443342333",
      "id" : 443342333,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14821",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0MzM0MjMzMw==",
      "updated_at" : "2018-11-30T21:17:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/443342333",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/MeshCollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MeshCollider/followers",
         "following_url" : "https://api.github.com/users/MeshCollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MeshCollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MeshCollider",
         "id" : 3211283,
         "login" : "MeshCollider",
         "node_id" : "MDQ6VXNlcjMyMTEyODM=",
         "organizations_url" : "https://api.github.com/users/MeshCollider/orgs",
         "received_events_url" : "https://api.github.com/users/MeshCollider/received_events",
         "repos_url" : "https://api.github.com/users/MeshCollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MeshCollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MeshCollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MeshCollider"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@sipa if you'd like you could take this test: https://github.com/instagibbs/bitcoin/commit/a80edd7e689e89e40d4ba98f3770c5da2bc8d174",
      "created_at" : "2018-12-02T08:17:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14821#issuecomment-443489960",
      "id" : 443489960,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14821",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0MzQ4OTk2MA==",
      "updated_at" : "2018-12-02T08:17:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/443489960",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   }
]
