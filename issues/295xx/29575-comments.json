[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/29575).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [instagibbs](https://github.com/bitcoin/bitcoin/pull/29575#pullrequestreview-1919982697), [1440000bytes](https://github.com/bitcoin/bitcoin/pull/29575#issuecomment-1981551759), [brunoerg](https://github.com/bitcoin/bitcoin/pull/29575#issuecomment-1981893004) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29538](https://github.com/bitcoin/bitcoin/pull/29538) (refactor: Improve naming of CBlock::GetHash() -> GetHeaderHash() by fjahr)\n* [#29530](https://github.com/bitcoin/bitcoin/pull/29530) (rpc/net: Adds misbehaving_score to getpeerinfo by sr-gi)\n* [#29415](https://github.com/bitcoin/bitcoin/pull/29415) (Broadcast own transactions only via short-lived Tor or I2P connections by vasild)\n* [#25832](https://github.com/bitcoin/bitcoin/pull/25832) (tracing: network connection tracepoints by 0xB10C)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2024-03-06T12:54:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#issuecomment-1980808115",
      "id" : 1980808115,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29575",
      "node_id" : "IC_kwDOABII5852ELuz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1980808115/reactions"
      },
      "updated_at" : "2024-03-07T00:24:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1980808115",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1514624757"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1514624757"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n        # Now try to see how many unconnecting headers we can send\r\n        # before we get disconnected.  Should be MAX_NUM_UNCONNECTING_HEADERS_MSGS\r\n```",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-06T14:55:07Z",
      "diff_hunk" : "@@ -569,7 +569,7 @@ def test_nonnull_locators(self, test_node, inv_node):\n \n         # Now try to see how many unconnecting headers we can send\n         # before we get disconnected.  Should be 5*MAX_NUM_UNCONNECTING_HEADERS_MSGS",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1514624757",
      "id" : 1514624757,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585aR1b1",
      "original_commit_id" : "bdc5776295ee78bc12de5b1c950afc80569a4f3e",
      "original_line" : 571,
      "original_position" : 3,
      "original_start_line" : 570,
      "path" : "test/functional/p2p_sendheaders.py",
      "position" : null,
      "pull_request_review_id" : 1919982697,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1514624757/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-03-06T15:26:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1514624757",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Concept ACK ",
      "created_at" : "2024-03-06T18:42:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#issuecomment-1981551759",
      "id" : 1981551759,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29575",
      "node_id" : "IC_kwDOABII5852HBSP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1981551759/reactions"
      },
      "updated_at" : "2024-03-06T18:42:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1981551759",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/147166694?v=4",
         "events_url" : "https://api.github.com/users/1440000bytes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/1440000bytes/followers",
         "following_url" : "https://api.github.com/users/1440000bytes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/1440000bytes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/1440000bytes",
         "id" : 147166694,
         "login" : "1440000bytes",
         "node_id" : "U_kgDOCMWV5g",
         "organizations_url" : "https://api.github.com/users/1440000bytes/orgs",
         "received_events_url" : "https://api.github.com/users/1440000bytes/received_events",
         "repos_url" : "https://api.github.com/users/1440000bytes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/1440000bytes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/1440000bytes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/1440000bytes"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2024-03-06T22:09:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#issuecomment-1981893004",
      "id" : 1981893004,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29575",
      "node_id" : "IC_kwDOABII5852IUmM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1981893004/reactions"
      },
      "updated_at" : "2024-03-06T22:09:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1981893004",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I have been monitoring peer misbehavior with the misbehaving tracepoint from https://github.com/bitcoin/bitcoin/pull/25832. In the past weeks, I've seen the following misbehavior across 10 nodes:\r\n- `header with invalid proof of work` [100]: very frequent\r\n- `mutated block` [100]: these are frequent. I was running #29412 where we disconnect for each mutated block (compared to only disconnecting for mutated blocks we hadn't seen before)\r\n- `invalid header received` [10]: these are infrequent (\"Sending us more than 8 headers in a single headers message\")\r\n- `headers message size = X` [20]: only seen one occurrence (\"Sending us more than 2000 headers in a single headers message that does not connect to our block tree\")\r\n\r\nI've looked at a few of these `invalid header received` misbehaviors and they all came from the same IP address with a (fake?) v26.0 Bitcoin Core user agent and always claiming their start height to be 153681 (in the version msg). Seems ok to disconnect these?\r\n\r\nI'll keep an eye on further misbehavior.",
      "created_at" : "2024-03-07T10:27:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#issuecomment-1983207221",
      "id" : 1983207221,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29575",
      "node_id" : "IC_kwDOABII5852NVc1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1983207221/reactions"
      },
      "updated_at" : "2024-03-07T10:27:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1983207221",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> due to interaction between BIP130 and variations in system clocks (the max 2 hour in the future rule)\r\n\r\nPerhaps we can tolerate this if the block is less than 10 hours in the future and disconnect if it's more? It seems cheap enough to process slightly-too-far-in-the-future headers, and they are enormously expensive to produce.\r\n\r\n(for other reviewers, look for `MAX_NUM_UNCONNECTING_HEADERS_MSGS` to see where this is handled)\r\n\r\nThe peer might also be telling us about a reorg longer than `MAX_BLOCKS_TO_ANNOUNCE = 8`. In `UpdatedBlockTip` we:\r\n\r\n> limit announcements in case of a huge reorganization.\r\n> Rely on the peer's synchronization mechanism in that case.\r\n\r\nSo we should not disconnect the first time around.\r\n\r\nThe `HandleFewUnconnectingHeaders` documentation should probably mention this.\r\n\r\nhttps://github.com/Sjors/bitcoin/commit/fad8c5be6e05091e409186ea73e683a987e3b324 illustrates how we could limit this to just _once_ (`MAX_NUM_UNCONNECTING_HEADERS_MSGS = 2`), since > 8 block reorgs should be rare. If we were to immedidately disconnect (`MAX_NUM_UNCONNECTING_HEADERS_MSGS = 1` then step 5 of `p2p_sendheaders.py` fails). This doesn't account for the time difference issue. And in any case it can be done in a followup. And of course we wouldn't need an integer, but could instead call it `m_chicken_little`.",
      "created_at" : "2024-03-07T11:04:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#issuecomment-1983273094",
      "id" : 1983273094,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29575",
      "node_id" : "IC_kwDOABII5852NliG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1983273094/reactions"
      },
      "updated_at" : "2024-03-07T13:54:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1983273094",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "https://github.com/Sjors/bitcoin/commit/00a7dccc1c6957ce5a6a00d5322a25f949956e6d is one approach of dealing with the time difference issue. If any of the headers are `> MAX_FUTURE_BLOCK_TIME * 10` in the future we disconnect with `time-too-new`. We could perhaps increase the number to allow for even more incorrect clocks, but I'm not sure how useful that is.\r\n\r\nSome of the comments in that commit may be spurious; I can't think of a useful attack where a peer (e.g. Bob) sends us headers, three hours in the future, with fake PoW. All Bob would achieve is that we ask ~another peer (Caroll)~ Bob for the missing headers, which ~Caroll either won't have, or she does we disconnect her~ he either sends, for which we disconnect. Or he doesn't send and tries again, at which point we disconnect him.\r\n\r\nI also don't know if if it's even worth checking if a header is in the far future, but at least it makes for more useful log entries? (it's nice to know the difference between a peer with a broken clock and a peer that falsely announces a large reorg)",
      "created_at" : "2024-03-07T15:00:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#issuecomment-1983692133",
      "id" : 1983692133,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29575",
      "node_id" : "IC_kwDOABII5852PL1l",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1983692133/reactions"
      },
      "updated_at" : "2024-03-07T19:04:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1983692133",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1516462725"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516462725"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is only triggered by `AcceptBlockHeader`, which typically happens _after_ `if(!headers_connect_blockindex)` causes an early return in `ProcessHeadersMessage`.\r\n\r\nIn other words, disconnecting here does not get in the way of `HandleUnconnectingHeaders` processing.\r\n\r\nPresumably (I didn't check) this can be reached if we get an unsolicited BLOCK message. In which case it seems fine to disconnect.\r\n\r\nIt can also be reached when using the `submitblock(header)` RPC, but in that case there is no `peer`.",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-07T16:23:31Z",
      "diff_hunk" : "@@ -1833,8 +1833,7 @@ bool PeerManagerImpl::MaybePunishNodeForBlock(NodeId nodeid, const BlockValidati\n         return true;\n     // Conflicting (but not necessarily invalid) data or different policy:\n     case BlockValidationResult::BLOCK_MISSING_PREV:\n-        // TODO: Handle this much more gracefully (10 DoS points is super arbitrary)\n-        if (peer) Misbehaving(*peer, 10, message);\n+        if (peer) Misbehaving(*peer, 100, message);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1516462725",
      "id" : 1516462725,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585aY2KF",
      "original_commit_id" : "1b6cf1f456ccd250037ff4dbb7a6c0827bcbee26",
      "original_line" : 1836,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 1922932806,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516462725/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-07T17:00:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516462725",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1516479856"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516479856"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't know why we ever tolerated this, but it's been that way since headers-first was added in #4468. Perhaps to avoid a network split in the case where headers-first had an implementation bug?\r\n\r\nNote that the `getheaders` message is older, see https://github.com/bitcoin/bitcoin/pull/4468/commits/341735eb8f42e898cf9d4d130709471e5d01abe2#r17027597",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-07T16:32:05Z",
      "diff_hunk" : "@@ -2533,7 +2532,7 @@ bool PeerManagerImpl::CheckHeadersPoW(const std::vector<CBlockHeader>& headers,\n \n     // Are these headers connected to each other?\n     if (!CheckHeadersAreContinuous(headers)) {\n-        Misbehaving(peer, 20, \"non-continuous headers sequence\");\n+        Misbehaving(peer, 100, \"non-continuous headers sequence\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1516479856",
      "id" : 1516479856,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585aY6Vw",
      "original_commit_id" : "1b6cf1f456ccd250037ff4dbb7a6c0827bcbee26",
      "original_line" : 2535,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 1922932806,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516479856/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-07T17:00:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516479856",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I discussed this with @sdaftuar, @mzumsande, @sr-gi in person, and decided to instead just drop the Misbehavior score for unconnecting headers. The rationale is that this misbehavior was originally intended to prevent bandwidth wastage due to very broken (but likely non-malicious) nodes actually observed on the network that respond to GETHEADERS with a response unrelated to the request, triggering a request cycle. This has however largely been addressed by #25454, which limits the number of (not responded to) GETHEADERS requests in flight to one, with a 2 minute timeout. With that, the specific misbehavior is largely irrelevant (for inbound peers, it is now mostly harmless; for outbound peers, the eviction logic will eventually kick them out if they're not keeping up with headers at all).",
      "created_at" : "2024-03-07T16:40:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#issuecomment-1983969260",
      "id" : 1983969260,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29575",
      "node_id" : "IC_kwDOABII5852QPfs",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1983969260/reactions"
      },
      "updated_at" : "2024-03-07T16:44:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1983969260",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1516497005"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516497005"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed by deleting that code (and the corresponding test) entirely.",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-07T16:44:34Z",
      "diff_hunk" : "@@ -569,7 +569,7 @@ def test_nonnull_locators(self, test_node, inv_node):\n \n         # Now try to see how many unconnecting headers we can send\n         # before we get disconnected.  Should be 5*MAX_NUM_UNCONNECTING_HEADERS_MSGS",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1516497005",
      "id" : 1516497005,
      "in_reply_to_id" : 1514624757,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585aY-ht",
      "original_commit_id" : "bdc5776295ee78bc12de5b1c950afc80569a4f3e",
      "original_line" : 571,
      "original_position" : 3,
      "original_start_line" : 570,
      "path" : "test/functional/p2p_sendheaders.py",
      "position" : null,
      "pull_request_review_id" : 1922990282,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516497005/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-03-07T16:44:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516497005",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1516503890"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516503890"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I believe this limit was introduced a decade ago in #5419, at least on the sender side.",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-07T16:48:54Z",
      "diff_hunk" : "@@ -3782,7 +3781,7 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n \n         if (vAddr.size() > MAX_ADDR_TO_SEND)\n         {\n-            Misbehaving(*peer, 20, strprintf(\"%s message size = %u\", msg_type, vAddr.size()));\n+            Misbehaving(*peer, 100, strprintf(\"%s message size = %u\", msg_type, vAddr.size()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1516503890",
      "id" : 1516503890,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585aZANS",
      "original_commit_id" : "aee3b67d43eea083d7299840dd11a61d4cf797b9",
      "original_line" : 3784,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 1922932806,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516503890/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-07T17:00:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516503890",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1516512654"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516512654"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The maximum size of an `inv` message has be 50,000 bytes since Satoshi sneaked in that limit in e2c2648c14f4b87d331dbc30f0f2bd4aab9ce7e6.",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-07T16:55:17Z",
      "diff_hunk" : "@@ -3864,7 +3863,7 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         vRecv >> vInv;\n         if (vInv.size() > MAX_INV_SZ)\n         {\n-            Misbehaving(*peer, 20, strprintf(\"inv message size = %u\", vInv.size()));\n+            Misbehaving(*peer, 100, strprintf(\"inv message size = %u\", vInv.size()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1516512654",
      "id" : 1516512654,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585aZCWO",
      "original_commit_id" : "aee3b67d43eea083d7299840dd11a61d4cf797b9",
      "original_line" : 3866,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 1922932806,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516512654/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-07T17:00:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516512654",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1516517837"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516517837"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This limit has been in place since #4468",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-07T16:59:09Z",
      "diff_hunk" : "@@ -4651,7 +4650,7 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         // Bypass the normal CBlock deserialization, as we don't want to risk deserializing 2000 full blocks.\n         unsigned int nCount = ReadCompactSize(vRecv);\n         if (nCount > MAX_HEADERS_RESULTS) {\n-            Misbehaving(*peer, 20, strprintf(\"headers message size = %u\", nCount));\n+            Misbehaving(*peer, 100, strprintf(\"headers message size = %u\", nCount));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1516517837",
      "id" : 1516517837,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585aZDnN",
      "original_commit_id" : "aee3b67d43eea083d7299840dd11a61d4cf797b9",
      "original_line" : 4653,
      "original_position" : 51,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 1922932806,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516517837/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-07T17:00:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516517837",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1516578761"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516578761"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This was my impression as well, that it can only be triggered by unsolicited `block` messages, not through headers logic.",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-07T17:44:04Z",
      "diff_hunk" : "@@ -1833,8 +1833,7 @@ bool PeerManagerImpl::MaybePunishNodeForBlock(NodeId nodeid, const BlockValidati\n         return true;\n     // Conflicting (but not necessarily invalid) data or different policy:\n     case BlockValidationResult::BLOCK_MISSING_PREV:\n-        // TODO: Handle this much more gracefully (10 DoS points is super arbitrary)\n-        if (peer) Misbehaving(*peer, 10, message);\n+        if (peer) Misbehaving(*peer, 100, message);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1516578761",
      "id" : 1516578761,
      "in_reply_to_id" : 1516462725,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585aZSfJ",
      "original_commit_id" : "1b6cf1f456ccd250037ff4dbb7a6c0827bcbee26",
      "original_line" : 1836,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 1923131116,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516578761/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-07T17:44:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516578761",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1516629050"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516629050"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Doc needs an update.",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-07T18:26:19Z",
      "diff_hunk" : "@@ -545,7 +543,7 @@ class PeerManagerImpl final : public PeerManager\n      * Increment peer's misbehavior score. If the new value >= DISCOURAGEMENT_THRESHOLD, mark the node",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1516629050",
      "id" : 1516629050,
      "line" : 543,
      "node_id" : "PRRC_kwDOABII585aZew6",
      "original_commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "original_line" : 543,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 19,
      "pull_request_review_id" : 1923216992,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516629050/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-11T17:18:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516629050",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1516633000"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516633000"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Could be simplified to stop mentioning a \"threshold\" and a score that doesn't exist anymore.",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-07T18:29:56Z",
      "diff_hunk" : "@@ -1765,25 +1761,16 @@ void PeerManagerImpl::AddToCompactExtraTransactions(const CTransactionRef& tx)\n     vExtraTxnForCompactIt = (vExtraTxnForCompactIt + 1) % m_opts.max_extra_txs;\n }\n \n-void PeerManagerImpl::Misbehaving(Peer& peer, int howmuch, const std::string& message)\n+void PeerManagerImpl::Misbehaving(Peer& peer, const std::string& message)\n {\n-    assert(howmuch > 0);\n-\n     LOCK(peer.m_misbehavior_mutex);\n-    const int score_before{peer.m_misbehavior_score};\n-    peer.m_misbehavior_score += howmuch;\n-    const int score_now{peer.m_misbehavior_score};\n \n     const std::string message_prefixed = message.empty() ? \"\" : (\": \" + message);\n-    std::string warning;\n \n-    if (score_now >= DISCOURAGEMENT_THRESHOLD && score_before < DISCOURAGEMENT_THRESHOLD) {\n-        warning = \" DISCOURAGE THRESHOLD EXCEEDED\";\n-        peer.m_should_discourage = true;\n-    }\n+    peer.m_should_discourage = true;\n \n-    LogPrint(BCLog::NET, \"Misbehaving: peer=%d (%d -> %d)%s%s\\n\",\n-             peer.m_id, score_before, score_now, warning, message_prefixed);\n+    LogPrint(BCLog::NET, \"Misbehaving: peer=%d (0 -> 100) DISCOURAGE THRESHOLD EXCEEDED%s\\n\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1516633000",
      "id" : 1516633000,
      "line" : 1772,
      "node_id" : "PRRC_kwDOABII585aZfuo",
      "original_commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "original_line" : 1772,
      "original_position" : 77,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 77,
      "pull_request_review_id" : 1923216992,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516633000/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-11T17:18:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1516633000",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Reviewed dee6ca279cac97e167c82b0b2a61d2d2f8df1d47\r\n\r\nI'll run the log commit for a while.\r\n\r\nI'm still a bit on the fence about a903bba4d65720265659c6d4dae6cd8d9ec89c0f.\r\n\r\n> With that, the specific misbehavior is largely irrelevant (for inbound peers, it is now mostly harmless; ...\r\n\r\nSome context here for other reviewers, when you look at `SelectNodeToEvict` one of the criteria that prevents eviction is if they sent us novel blocks. This means that peers that keep sending us useless headers, will probably not enjoy this protection and eventually get replaced. Unless they _also_ give use useful data, in which case they're ... useful - and we can just humor their headers shenaningans.\r\n\r\n> ...  for outbound peers, the eviction logic will eventually kick them out if they're not keeping up with headers at all).\r\n\r\nIIUC outbound peer eviction is handled in `PeerManagerImpl::ConsiderEviction`, which loses its patience after `CHAIN_SYNC_TIMEOUT + HEADERS_RESPONSE_TIME`. That seems a bit late though, if all our outbound peers are slow? Even if that's rare, it seems better to have as many \"fit\" outbound peers as possible.\r\n\r\n\r\nAlso... It might still be useful, even if not needed for security, to _know_ if a peer sent us disconnecting headers. Although the `NET` log still provides a log message `received header %s: missing prev block %s, sending getheaders (%d) to end (peer=%d)`, we don't know the outcome.\r\n\r\nTracking if the peer did this before, e.g. with something like `m_chicken_little`, would make this easier. But not sure if it's worth the complexity. It seems all this would do is reveal that someone tried an attack that we believe to be useless.\r\n\r\n",
      "created_at" : "2024-03-07T19:36:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#issuecomment-1984287276",
      "id" : 1984287276,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29575",
      "node_id" : "IC_kwDOABII5852RdIs",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1984287276/reactions"
      },
      "updated_at" : "2024-03-07T19:37:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1984287276",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@Sjors It's worth taking into account that despite its history as originally being a \"DoS score\", the discouragement logic isn't particularly good at preventing *intentional* abuse of resources; scoring systems are inherently easy to bypass: just do enough to keep the score acceptable, and be as wasteful otherwise (or even better, if many IP addresses are available, use several). The only real solution, in my opinion, for actual DoS protection is keeping track of how many resources (bandwidth, CPU, I/O, ...) we spend on behalf of every peer, and whenever those resources become a bottleneck for us, throttle the worst peers.\r\n\r\nSo the purpose for the discouragement logic as I see it is avoiding wasting resources on (unintentionally) *broken* peers. These are somewhat distinct from *useless* peers (which is what the outbound eviction logic is aimed to prevent). There is an infinite amount of potential broken behavior one can imagine, and clearly we cannot have code for all of it. \r\n\r\nAnother reason for the misbehavior detection is to help protocol implementers get a good idea for expectations around parts of the protocol that aren't formally specified. And arguably, unconnecting headers isn't a protocol violation, at least in the context of BIP130 announcements, so disconnecting for something that's very rare but not impossible to trigger in what we'd consider a perfectly compliant protocol implementation would be confusing.",
      "created_at" : "2024-03-07T20:39:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#issuecomment-1984388837",
      "id" : 1984388837,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29575",
      "node_id" : "IC_kwDOABII5852R17l",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1984388837/reactions"
      },
      "updated_at" : "2024-03-07T20:42:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1984388837",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1520033359"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520033359"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "doc could be updated, the function now deals with non-connecting headers in general.",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-11T16:33:05Z",
      "diff_hunk" : "@@ -610,7 +610,7 @@ class PeerManagerImpl final : public PeerManager\n     /** Deal with state tracking and headers sync for peers that send the\n      * occasional non-connecting header (this can happen due to BIP 130 headers",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1520033359",
      "id" : 1520033359,
      "line" : 609,
      "node_id" : "PRRC_kwDOABII585amd5P",
      "original_commit_id" : "7712c5b2d7901fb3bebbb2f6dcf771b38fe44873",
      "original_line" : 611,
      "original_position" : 2,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 48,
      "pull_request_review_id" : 1923216992,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520033359/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-11T17:18:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520033359",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1520116486"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520116486"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The commit message of a903bba4d65720265659c6d4dae6cd8d9ec89c0f says that https://github.com/bitcoin/bitcoin/pull/25454 has largely addressed the problem of a request cycle, but I don't understand why:\r\nIf we receive an unconnecting header, we send a `GetHeaders`. But if our peer is broken in a way that they ignore the contents of our locator and send us unconnecting headers again, we clear `m_last_getheaders_timestamp`, call `ProcessHeadersMessage` and immediately send a `GetHeaders` again (we wold only delay that if `m_last_getheaders_timestamp` hadn't been cleared)  - and after this PR we wouldn't discourage the peer anymore so that this could go on forever. How did #25454 address that?",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-11T17:15:09Z",
      "diff_hunk" : "@@ -129,8 +129,6 @@ static constexpr double BLOCK_DOWNLOAD_TIMEOUT_BASE = 1;\n static constexpr double BLOCK_DOWNLOAD_TIMEOUT_PER_PEER = 0.5;\n /** Maximum number of headers to announce when relaying blocks with headers message.*/\n static const unsigned int MAX_BLOCKS_TO_ANNOUNCE = 8;\n-/** Maximum number of unconnecting headers announcements before DoS score */\n-static const int MAX_NUM_UNCONNECTING_HEADERS_MSGS = 10;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1520116486",
      "id" : 1520116486,
      "line" : 133,
      "node_id" : "PRRC_kwDOABII585amyMG",
      "original_commit_id" : "a903bba4d65720265659c6d4dae6cd8d9ec89c0f",
      "original_line" : 133,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 5,
      "pull_request_review_id" : 1923216992,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520116486/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-11T17:18:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520116486",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1520238242"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520238242"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Does 100 even have a meaning anymore?",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-11T18:24:53Z",
      "diff_hunk" : "@@ -1765,25 +1761,16 @@ void PeerManagerImpl::AddToCompactExtraTransactions(const CTransactionRef& tx)\n     vExtraTxnForCompactIt = (vExtraTxnForCompactIt + 1) % m_opts.max_extra_txs;\n }\n \n-void PeerManagerImpl::Misbehaving(Peer& peer, int howmuch, const std::string& message)\n+void PeerManagerImpl::Misbehaving(Peer& peer, const std::string& message)\n {\n-    assert(howmuch > 0);\n-\n     LOCK(peer.m_misbehavior_mutex);\n-    const int score_before{peer.m_misbehavior_score};\n-    peer.m_misbehavior_score += howmuch;\n-    const int score_now{peer.m_misbehavior_score};\n \n     const std::string message_prefixed = message.empty() ? \"\" : (\": \" + message);\n-    std::string warning;\n \n-    if (score_now >= DISCOURAGEMENT_THRESHOLD && score_before < DISCOURAGEMENT_THRESHOLD) {\n-        warning = \" DISCOURAGE THRESHOLD EXCEEDED\";\n-        peer.m_should_discourage = true;\n-    }\n+    peer.m_should_discourage = true;\n \n-    LogPrint(BCLog::NET, \"Misbehaving: peer=%d (%d -> %d)%s%s\\n\",\n-             peer.m_id, score_before, score_now, warning, message_prefixed);\n+    LogPrint(BCLog::NET, \"Misbehaving: peer=%d (0 -> 100) DISCOURAGE THRESHOLD EXCEEDED%s\\n\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1520238242",
      "id" : 1520238242,
      "in_reply_to_id" : 1516633000,
      "line" : 1772,
      "node_id" : "PRRC_kwDOABII585anP6i",
      "original_commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "original_line" : 1772,
      "original_position" : 77,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 77,
      "pull_request_review_id" : 1928739577,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520238242/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-12T15:54:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520238242",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6665628?v=4",
         "events_url" : "https://api.github.com/users/sr-gi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sr-gi/followers",
         "following_url" : "https://api.github.com/users/sr-gi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sr-gi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sr-gi",
         "id" : 6665628,
         "login" : "sr-gi",
         "node_id" : "MDQ6VXNlcjY2NjU2Mjg=",
         "organizations_url" : "https://api.github.com/users/sr-gi/orgs",
         "received_events_url" : "https://api.github.com/users/sr-gi/received_events",
         "repos_url" : "https://api.github.com/users/sr-gi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sr-gi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sr-gi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sr-gi"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1520351086"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520351086"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think the comment is still accurate? Happy to take suggestions for what to change in it, though.",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-11T19:52:55Z",
      "diff_hunk" : "@@ -610,7 +610,7 @@ class PeerManagerImpl final : public PeerManager\n     /** Deal with state tracking and headers sync for peers that send the\n      * occasional non-connecting header (this can happen due to BIP 130 headers",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1520351086",
      "id" : 1520351086,
      "in_reply_to_id" : 1520033359,
      "line" : 609,
      "node_id" : "PRRC_kwDOABII585anrdu",
      "original_commit_id" : "7712c5b2d7901fb3bebbb2f6dcf771b38fe44873",
      "original_line" : 611,
      "original_position" : 2,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 48,
      "pull_request_review_id" : 1929048352,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520351086/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-11T19:52:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520351086",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1520358548"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520358548"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oh, I was under the mistaken assumption that `m_last_getheaders_timestamp` was only cleared when a connecting header was received. I think that's fine to change here: a response to a requested GETHEADERS will always be connecting.",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-11T19:59:24Z",
      "diff_hunk" : "@@ -129,8 +129,6 @@ static constexpr double BLOCK_DOWNLOAD_TIMEOUT_BASE = 1;\n static constexpr double BLOCK_DOWNLOAD_TIMEOUT_PER_PEER = 0.5;\n /** Maximum number of headers to announce when relaying blocks with headers message.*/\n static const unsigned int MAX_BLOCKS_TO_ANNOUNCE = 8;\n-/** Maximum number of unconnecting headers announcements before DoS score */\n-static const int MAX_NUM_UNCONNECTING_HEADERS_MSGS = 10;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1520358548",
      "id" : 1520358548,
      "in_reply_to_id" : 1520116486,
      "line" : 133,
      "node_id" : "PRRC_kwDOABII585antSU",
      "original_commit_id" : "a903bba4d65720265659c6d4dae6cd8d9ec89c0f",
      "original_line" : 133,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 5,
      "pull_request_review_id" : 1929071432,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520358548/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-11T19:59:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520358548",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1520363411"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520363411"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "maybe just drop the \"occasional\" (\"that send non-connecting headers\"), but no big deal either way.",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-11T20:03:50Z",
      "diff_hunk" : "@@ -610,7 +610,7 @@ class PeerManagerImpl final : public PeerManager\n     /** Deal with state tracking and headers sync for peers that send the\n      * occasional non-connecting header (this can happen due to BIP 130 headers",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1520363411",
      "id" : 1520363411,
      "in_reply_to_id" : 1520033359,
      "line" : 609,
      "node_id" : "PRRC_kwDOABII585anueT",
      "original_commit_id" : "7712c5b2d7901fb3bebbb2f6dcf771b38fe44873",
      "original_line" : 611,
      "original_position" : 2,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 48,
      "pull_request_review_id" : 1929086807,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520363411/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-11T20:04:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520363411",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1520367830"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520367830"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Is this required anymore? Flagging as misbehaving will result in disconnecting now",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-11T20:08:08Z",
      "diff_hunk" : "@@ -4529,7 +4488,7 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                 ReadStatus status = partialBlock.InitData(cmpctblock, vExtraTxnForCompact);\n                 if (status == READ_STATUS_INVALID) {\n                     RemoveBlockRequest(pindex->GetBlockHash(), pfrom.GetId()); // Reset in-flight state in case Misbehaving does not result in a disconnect",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1520367830",
      "id" : 1520367830,
      "line" : 4490,
      "node_id" : "PRRC_kwDOABII585anvjW",
      "original_commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "original_line" : 4490,
      "original_position" : 288,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 288,
      "pull_request_review_id" : 1928739577,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520367830/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-12T15:54:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520367830",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6665628?v=4",
         "events_url" : "https://api.github.com/users/sr-gi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sr-gi/followers",
         "following_url" : "https://api.github.com/users/sr-gi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sr-gi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sr-gi",
         "id" : 6665628,
         "login" : "sr-gi",
         "node_id" : "MDQ6VXNlcjY2NjU2Mjg=",
         "organizations_url" : "https://api.github.com/users/sr-gi/orgs",
         "received_events_url" : "https://api.github.com/users/sr-gi/received_events",
         "repos_url" : "https://api.github.com/users/sr-gi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sr-gi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sr-gi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sr-gi"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1520369892"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520369892"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Looks like this comment needs updating since there is no threshold anymore",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-11T20:09:54Z",
      "diff_hunk" : "@@ -352,15 +352,14 @@ BOOST_AUTO_TEST_CASE(peer_discouragement)\n     peerLogic->InitializeNode(*nodes[1], NODE_NETWORK);\n     nodes[1]->fSuccessfullyConnected = true;\n     connman->AddTestNode(*nodes[1]);\n-    peerLogic->UnitTestMisbehaving(nodes[1]->GetId(), DISCOURAGEMENT_THRESHOLD - 1);\n     BOOST_CHECK(peerLogic->SendMessages(nodes[1]));\n     // [0] is still discouraged/disconnected.\n     BOOST_CHECK(banman->IsDiscouraged(addr[0]));\n     BOOST_CHECK(nodes[0]->fDisconnect);\n     // [1] is not discouraged/disconnected yet.\n     BOOST_CHECK(!banman->IsDiscouraged(addr[1]));\n     BOOST_CHECK(!nodes[1]->fDisconnect);\n-    peerLogic->UnitTestMisbehaving(nodes[1]->GetId(), 1); // [1] reaches discouragement threshold\n+    peerLogic->UnitTestMisbehaving(nodes[1]->GetId()); // [1] reaches discouragement threshold",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1520369892",
      "id" : 1520369892,
      "line" : 362,
      "node_id" : "PRRC_kwDOABII585anwDk",
      "original_commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "original_line" : 362,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/test/denialofservice_tests.cpp",
      "position" : 22,
      "pull_request_review_id" : 1928739577,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520369892/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-12T15:54:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520369892",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6665628?v=4",
         "events_url" : "https://api.github.com/users/sr-gi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sr-gi/followers",
         "following_url" : "https://api.github.com/users/sr-gi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sr-gi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sr-gi",
         "id" : 6665628,
         "login" : "sr-gi",
         "node_id" : "MDQ6VXNlcjY2NjU2Mjg=",
         "organizations_url" : "https://api.github.com/users/sr-gi/orgs",
         "received_events_url" : "https://api.github.com/users/sr-gi/received_events",
         "repos_url" : "https://api.github.com/users/sr-gi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sr-gi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sr-gi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sr-gi"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1520394128"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520394128"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Is this comment accurate? I don't see how it applies ",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-11T20:29:50Z",
      "diff_hunk" : "@@ -1828,8 +1828,7 @@ bool PeerManagerImpl::MaybePunishNodeForBlock(NodeId nodeid, const BlockValidati\n         return true;\n     // Conflicting (but not necessarily invalid) data or different policy:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1520394128",
      "id" : 1520394128,
      "line" : 1816,
      "node_id" : "PRRC_kwDOABII585an1-Q",
      "original_commit_id" : "aee3b67d43eea083d7299840dd11a61d4cf797b9",
      "original_line" : 1829,
      "original_position" : 2,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 135,
      "pull_request_review_id" : 1928739577,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520394128/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-12T15:54:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520394128",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6665628?v=4",
         "events_url" : "https://api.github.com/users/sr-gi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sr-gi/followers",
         "following_url" : "https://api.github.com/users/sr-gi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sr-gi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sr-gi",
         "id" : 6665628,
         "login" : "sr-gi",
         "node_id" : "MDQ6VXNlcjY2NjU2Mjg=",
         "organizations_url" : "https://api.github.com/users/sr-gi/orgs",
         "received_events_url" : "https://api.github.com/users/sr-gi/received_events",
         "repos_url" : "https://api.github.com/users/sr-gi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sr-gi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sr-gi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sr-gi"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1520433771"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520433771"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Is there a reason why we don't even signal this as a consensus discrepancy? Is it logged somewhere else?",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-11T21:07:56Z",
      "diff_hunk" : "@@ -1848,7 +1835,7 @@ bool PeerManagerImpl::MaybePunishNodeForTx(NodeId nodeid, const TxValidationStat\n         break;\n     // The node is providing invalid data:\n     case TxValidationResult::TX_CONSENSUS:\n-        if (peer) Misbehaving(*peer, 100, \"\");\n+        if (peer) Misbehaving(*peer, \"\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1520433771",
      "id" : 1520433771,
      "line" : 1838,
      "node_id" : "PRRC_kwDOABII585an_pr",
      "original_commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "original_line" : 1838,
      "original_position" : 119,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 119,
      "pull_request_review_id" : 1928739577,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520433771/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-12T15:54:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520433771",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6665628?v=4",
         "events_url" : "https://api.github.com/users/sr-gi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sr-gi/followers",
         "following_url" : "https://api.github.com/users/sr-gi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sr-gi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sr-gi",
         "id" : 6665628,
         "login" : "sr-gi",
         "node_id" : "MDQ6VXNlcjY2NjU2Mjg=",
         "organizations_url" : "https://api.github.com/users/sr-gi/orgs",
         "received_events_url" : "https://api.github.com/users/sr-gi/received_events",
         "repos_url" : "https://api.github.com/users/sr-gi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sr-gi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sr-gi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sr-gi"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1521535754"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521535754"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Does this mean `m_last_getheaders_timestamp` clearing should be moved under `ProcessHeadersMessage` conditionally to `headers_connect_blockindex` being true?",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-12T14:07:37Z",
      "diff_hunk" : "@@ -129,8 +129,6 @@ static constexpr double BLOCK_DOWNLOAD_TIMEOUT_BASE = 1;\n static constexpr double BLOCK_DOWNLOAD_TIMEOUT_PER_PEER = 0.5;\n /** Maximum number of headers to announce when relaying blocks with headers message.*/\n static const unsigned int MAX_BLOCKS_TO_ANNOUNCE = 8;\n-/** Maximum number of unconnecting headers announcements before DoS score */\n-static const int MAX_NUM_UNCONNECTING_HEADERS_MSGS = 10;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1521535754",
      "id" : 1521535754,
      "in_reply_to_id" : 1520116486,
      "line" : 133,
      "node_id" : "PRRC_kwDOABII585asMsK",
      "original_commit_id" : "a903bba4d65720265659c6d4dae6cd8d9ec89c0f",
      "original_line" : 133,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 5,
      "pull_request_review_id" : 1928739577,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521535754/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-12T15:54:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521535754",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6665628?v=4",
         "events_url" : "https://api.github.com/users/sr-gi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sr-gi/followers",
         "following_url" : "https://api.github.com/users/sr-gi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sr-gi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sr-gi",
         "id" : 6665628,
         "login" : "sr-gi",
         "node_id" : "MDQ6VXNlcjY2NjU2Mjg=",
         "organizations_url" : "https://api.github.com/users/sr-gi/orgs",
         "received_events_url" : "https://api.github.com/users/sr-gi/received_events",
         "repos_url" : "https://api.github.com/users/sr-gi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sr-gi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sr-gi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sr-gi"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1521784415"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521784415"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "yes, because some peers (e.g. ones with special permissions) don't get disconnected.",
      "commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "created_at" : "2024-03-12T16:30:30Z",
      "diff_hunk" : "@@ -4529,7 +4488,7 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                 ReadStatus status = partialBlock.InitData(cmpctblock, vExtraTxnForCompact);\n                 if (status == READ_STATUS_INVALID) {\n                     RemoveBlockRequest(pindex->GetBlockHash(), pfrom.GetId()); // Reset in-flight state in case Misbehaving does not result in a disconnect",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29575#discussion_r1521784415",
      "id" : 1521784415,
      "in_reply_to_id" : 1520367830,
      "line" : 4490,
      "node_id" : "PRRC_kwDOABII585atJZf",
      "original_commit_id" : "dee6ca279cac97e167c82b0b2a61d2d2f8df1d47",
      "original_line" : 4490,
      "original_position" : 288,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 288,
      "pull_request_review_id" : 1931580426,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29575",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521784415/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-12T16:30:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521784415",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   }
]
