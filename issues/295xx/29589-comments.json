[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/29589).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n",
      "created_at" : "2024-03-07T16:47:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29589#issuecomment-1983981942",
      "id" : 1983981942,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29589",
      "node_id" : "IC_kwDOABII5852QSl2",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1983981942/reactions"
      },
      "updated_at" : "2024-03-07T16:47:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1983981942",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29589#discussion_r1517117195"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29589"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1517117195"
         }
      },
      "author_association" : "NONE",
      "body" : "```suggestion\r\n            raise ValueError('Integer must be in range -1 <= n <= 16, got %d' % n)\r\n```",
      "commit_id" : "8bd0a8b18d68bbacee731f3e0583397f81ca078e",
      "created_at" : "2024-03-08T03:21:50Z",
      "diff_hunk" : "@@ -67,11 +67,13 @@ def encode_op_pushdata(d):\n     @staticmethod\n     def encode_op_n(n):\n         \"\"\"Encode a small integer op, returning an opcode\"\"\"\n-        if not (0 <= n <= 16):\n+        if not (-1 <= n <= 16):\n             raise ValueError('Integer must be in range 0 <= n <= 16, got %d' % n)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29589#discussion_r1517117195",
      "id" : 1517117195,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585abV8L",
      "original_commit_id" : "12cdde8fb455ba4520af02fc528f07197694d297",
      "original_line" : 71,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/script.py",
      "position" : null,
      "pull_request_review_id" : 1923956639,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29589",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1517117195/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-08T03:21:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1517117195",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/43024885?v=4",
         "events_url" : "https://api.github.com/users/vostrnad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vostrnad/followers",
         "following_url" : "https://api.github.com/users/vostrnad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vostrnad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vostrnad",
         "id" : 43024885,
         "login" : "vostrnad",
         "node_id" : "MDQ6VXNlcjQzMDI0ODg1",
         "organizations_url" : "https://api.github.com/users/vostrnad/orgs",
         "received_events_url" : "https://api.github.com/users/vostrnad/received_events",
         "repos_url" : "https://api.github.com/users/vostrnad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vostrnad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vostrnad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vostrnad"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Should `decode_op_n` and `is_small_int` perhaps be fixed as well?",
      "created_at" : "2024-03-08T14:03:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29589#issuecomment-1985750992",
      "id" : 1985750992,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29589",
      "node_id" : "IC_kwDOABII5852XCfQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1985750992/reactions"
      },
      "updated_at" : "2024-03-08T14:03:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1985750992",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/43024885?v=4",
         "events_url" : "https://api.github.com/users/vostrnad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vostrnad/followers",
         "following_url" : "https://api.github.com/users/vostrnad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vostrnad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vostrnad",
         "id" : 43024885,
         "login" : "vostrnad",
         "node_id" : "MDQ6VXNlcjQzMDI0ODg1",
         "organizations_url" : "https://api.github.com/users/vostrnad/orgs",
         "received_events_url" : "https://api.github.com/users/vostrnad/received_events",
         "repos_url" : "https://api.github.com/users/vostrnad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vostrnad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vostrnad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vostrnad"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Should `decode_op_n` and `is_small_int` perhaps be fixed as well?\r\n\r\nDone in 8bd0a8b18d68bbacee731f3e0583397f81ca078e , good catch :raised_hands: ",
      "created_at" : "2024-03-08T14:42:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29589#issuecomment-1985815464",
      "id" : 1985815464,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29589",
      "node_id" : "IC_kwDOABII5852XSOo",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1985815464/reactions"
      },
      "updated_at" : "2024-03-08T14:42:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1985815464",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3514957?v=4",
         "events_url" : "https://api.github.com/users/Christewart/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Christewart/followers",
         "following_url" : "https://api.github.com/users/Christewart/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Christewart/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Christewart",
         "id" : 3514957,
         "login" : "Christewart",
         "node_id" : "MDQ6VXNlcjM1MTQ5NTc=",
         "organizations_url" : "https://api.github.com/users/Christewart/orgs",
         "received_events_url" : "https://api.github.com/users/Christewart/received_events",
         "repos_url" : "https://api.github.com/users/Christewart/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Christewart/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Christewart/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Christewart"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29589#discussion_r1517992846"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29589"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1517992846"
         }
      },
      "author_association" : "NONE",
      "body" : "nit\r\n```suggestion\r\n        elif n == -1:\r\n```",
      "commit_id" : "8bd0a8b18d68bbacee731f3e0583397f81ca078e",
      "created_at" : "2024-03-08T16:59:33Z",
      "diff_hunk" : "@@ -67,18 +67,22 @@ def encode_op_pushdata(d):\n     @staticmethod\n     def encode_op_n(n):\n         \"\"\"Encode a small integer op, returning an opcode\"\"\"\n-        if not (0 <= n <= 16):\n-            raise ValueError('Integer must be in range 0 <= n <= 16, got %d' % n)\n+        if not (-1 <= n <= 16):\n+            raise ValueError('Integer must be in range -1 <= n <= 16, got %d' % n)\n \n         if n == 0:\n             return OP_0\n+        if n == -1:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29589#discussion_r1517992846",
      "id" : 1517992846,
      "line" : 75,
      "node_id" : "PRRC_kwDOABII585aeruO",
      "original_commit_id" : "8bd0a8b18d68bbacee731f3e0583397f81ca078e",
      "original_line" : 75,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/script.py",
      "position" : 11,
      "pull_request_review_id" : 1925343940,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29589",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1517992846/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-08T16:59:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1517992846",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/43024885?v=4",
         "events_url" : "https://api.github.com/users/vostrnad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vostrnad/followers",
         "following_url" : "https://api.github.com/users/vostrnad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vostrnad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vostrnad",
         "id" : 43024885,
         "login" : "vostrnad",
         "node_id" : "MDQ6VXNlcjQzMDI0ODg1",
         "organizations_url" : "https://api.github.com/users/vostrnad/orgs",
         "received_events_url" : "https://api.github.com/users/vostrnad/received_events",
         "repos_url" : "https://api.github.com/users/vostrnad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vostrnad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vostrnad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vostrnad"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29589#discussion_r1517993114"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29589"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1517993114"
         }
      },
      "author_association" : "NONE",
      "body" : "Checking `OP_0` is unnecessary here, but now that it's not checking `OP_1NEGATE` it's inconsistently unnecessary. How about using `is_small_int` to avoid code duplication?\r\n\r\n```python\r\ndef decode_op_n(self):\r\n    \"\"\"Decode a small integer opcode, returning an integer\"\"\"\r\n    if not self.is_small_int():\r\n        raise ValueError('op %r is not an OP_N' % self)\r\n\r\n    if self == OP_0:\r\n        return 0\r\n    elif self == OP_1NEGATE:\r\n        return -1\r\n    else:\r\n        return int(self - OP_1 + 1)\r\n```",
      "commit_id" : "8bd0a8b18d68bbacee731f3e0583397f81ca078e",
      "created_at" : "2024-03-08T16:59:40Z",
      "diff_hunk" : "@@ -67,18 +67,22 @@ def encode_op_pushdata(d):\n     @staticmethod\n     def encode_op_n(n):\n         \"\"\"Encode a small integer op, returning an opcode\"\"\"\n-        if not (0 <= n <= 16):\n-            raise ValueError('Integer must be in range 0 <= n <= 16, got %d' % n)\n+        if not (-1 <= n <= 16):\n+            raise ValueError('Integer must be in range -1 <= n <= 16, got %d' % n)\n \n         if n == 0:\n             return OP_0\n+        if n == -1:\n+            return OP_1NEGATE\n         else:\n             return CScriptOp(OP_1 + n - 1)\n \n     def decode_op_n(self):\n         \"\"\"Decode a small integer opcode, returning an integer\"\"\"\n         if self == OP_0:\n             return 0\n+        if self == OP_1NEGATE:\n+            return -1\n \n         if not (self == OP_0 or OP_1 <= self <= OP_16):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29589#discussion_r1517993114",
      "id" : 1517993114,
      "line" : 87,
      "node_id" : "PRRC_kwDOABII585aerya",
      "original_commit_id" : "8bd0a8b18d68bbacee731f3e0583397f81ca078e",
      "original_line" : 87,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/script.py",
      "position" : 23,
      "pull_request_review_id" : 1925343940,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29589",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1517993114/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-08T16:59:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1517993114",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/43024885?v=4",
         "events_url" : "https://api.github.com/users/vostrnad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vostrnad/followers",
         "following_url" : "https://api.github.com/users/vostrnad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vostrnad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vostrnad",
         "id" : 43024885,
         "login" : "vostrnad",
         "node_id" : "MDQ6VXNlcjQzMDI0ODg1",
         "organizations_url" : "https://api.github.com/users/vostrnad/orgs",
         "received_events_url" : "https://api.github.com/users/vostrnad/received_events",
         "repos_url" : "https://api.github.com/users/vostrnad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vostrnad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vostrnad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vostrnad"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29589#discussion_r1517993281"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29589"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1517993281"
         }
      },
      "author_association" : "NONE",
      "body" : "`self` is never -1, the check should be for `0x4f`. Maybe we could rewrite this using named opcodes instead of bytes:\r\n```suggestion\r\n        if self == OP_0 or OP_1 <= self <= OP_16 or self == OP_1NEGATE:\r\n```",
      "commit_id" : "8bd0a8b18d68bbacee731f3e0583397f81ca078e",
      "created_at" : "2024-03-08T16:59:44Z",
      "diff_hunk" : "@@ -87,7 +91,7 @@ def decode_op_n(self):\n \n     def is_small_int(self):\n         \"\"\"Return true if the op pushes a small integer to the stack\"\"\"\n-        if 0x51 <= self <= 0x60 or self == 0:\n+        if 0x51 <= self <= 0x60 or self == 0 or self == -1:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29589#discussion_r1517993281",
      "id" : 1517993281,
      "line" : 94,
      "node_id" : "PRRC_kwDOABII585aer1B",
      "original_commit_id" : "8bd0a8b18d68bbacee731f3e0583397f81ca078e",
      "original_line" : 94,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/script.py",
      "position" : 30,
      "pull_request_review_id" : 1925343940,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29589",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1517993281/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-08T16:59:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1517993281",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/43024885?v=4",
         "events_url" : "https://api.github.com/users/vostrnad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vostrnad/followers",
         "following_url" : "https://api.github.com/users/vostrnad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vostrnad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vostrnad",
         "id" : 43024885,
         "login" : "vostrnad",
         "node_id" : "MDQ6VXNlcjQzMDI0ODg1",
         "organizations_url" : "https://api.github.com/users/vostrnad/orgs",
         "received_events_url" : "https://api.github.com/users/vostrnad/received_events",
         "repos_url" : "https://api.github.com/users/vostrnad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vostrnad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vostrnad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vostrnad"
      }
   }
]
