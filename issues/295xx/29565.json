{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "### Please describe the feature you'd like to see added.\r\n\r\n`bitcoin-cli rollback`\r\n\r\nArguments:\r\n\r\n1. height or hash\r\n2. delete blocks from storage\r\n3. delete headers\r\n\r\nThis should be used with networking turned off. As soon as you connect to a peer, it will sync back to the tip as normal.\r\n\r\nIt should rollback indexes too.\r\n\r\nIt should probably warn users if they have a wallet loaded, especially if the rollback is more than 10 (?) block; that's the point where the rollback process stops placing transactions back into the mempool.\r\n\r\n### Is your feature related to a problem, if so please describe it.\r\n\r\nWe currently rely on `invalidateblock` to roll back the chain to an arbitrary height. And then `reconsiderblock` to go back to the tip. Rolling back the chain is used when creating snapshots for assume utxo.\r\n\r\nThis works but the RPC methods are not designed for this. It has annoying side-effects like disconnecting peers because they have \"invalid\" blocks. If there are stale blocks near the height you want to roll back to, you have to make sure to invalidate those too. IIRC there's also no way to abort the process.\r\n\r\nFor functional tests it can be useful to forget a block and a header, e.g. to test behavior when a header is received multiple times from different peers, when receiving an unsolicited or mutated block. Currently such a test has to carefully sequence events, or use multiple unconnected nodes. This RPC would effectively add \"undo\" for such tests.\r\n\r\n### Describe the solution you'd like\r\n\r\nSee above\r\n\r\n### Describe any alternatives you've considered\r\n\r\nStatus quo.\r\n\r\n### Please leave any additional context\r\n\r\nI'm not advocating to drop `invalidateblock` entirely. For example it's still useful if you want to fully validate a stale block.",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 2,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29565/comments",
   "created_at" : "2024-03-05T10:50:48Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29565/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/29565",
   "id" : 2168888697,
   "labels" : [
      {
         "color" : "7cf575",
         "default" : false,
         "description" : null,
         "id" : 64583,
         "name" : "Feature",
         "node_id" : "MDU6TGFiZWw2NDU4Mw==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Feature"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29565/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "I_kwDOABII586BRp15",
   "number" : 29565,
   "performed_via_github_app" : null,
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29565/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "state_reason" : null,
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29565/timeline",
   "title" : "rpc: rollback",
   "updated_at" : "2024-03-12T08:33:23Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29565",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
      "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
      "followers_url" : "https://api.github.com/users/Sjors/followers",
      "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/Sjors",
      "id" : 10217,
      "login" : "Sjors",
      "node_id" : "MDQ6VXNlcjEwMjE3",
      "organizations_url" : "https://api.github.com/users/Sjors/orgs",
      "received_events_url" : "https://api.github.com/users/Sjors/received_events",
      "repos_url" : "https://api.github.com/users/Sjors/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/Sjors"
   }
}
