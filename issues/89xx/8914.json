{
   "assignee" : null,
   "assignees" : [],
   "body" : "There are only a few uses of `insecure_random` outside the tests. This PR replaces uses of `insecure_random` (and its accompanying global state) in the core code with an FastRandomContext that is automatically seeded on creation.\r\n\r\nThis is meant to be used for inner loops. The FastRandomContext can be in the outer scope, or the class itself, then rand32() is used inside the loop. Useful e.g. for pushing addresses in CNode or the fee\r\nrounding, or randomization for coin selection.\r\n\r\nAs a context is created per purpose, thus it gets rid of cross-thread unprotected shared usage of a single set of globals, this should also get rid of the potential race conditions.\r\n\r\n- I'd say `TxMempool::check` is not called enough to warrant using a special fast random context, this is switched to GetRand() (open for discussion...)\r\n\r\n- The use of `insecure_rand` in `ConnectThroughProxy` has been replaced by an atomic integer counter. The only goal here is to have a different credentials pair for each connection to go on a different Tor circuit, it does not need to be random nor unpredictable.\r\n\r\n- To avoid having a `FastRandomContext` on every `CNode`, the context is passed into PushAddress as appropriate.\r\n\r\nThere remains an insecure_random for test usage in `test_random.h`.\r\n\r\nReplaces #8903. Intends to fix @JeremyRubin's concerns about race conditions.",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 2,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8914/comments",
   "created_at" : "2016-10-13T16:35:48Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8914/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/8914",
   "id" : 182839433,
   "labels" : [
      {
         "color" : "E6F6D6",
         "name" : "Refactoring",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8914/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 8914,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/8914.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8914",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/8914.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8914"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "Kill insecure_random and associated global state",
   "updated_at" : "2016-10-14T18:26:52Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8914",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
      "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
      "followers_url" : "https://api.github.com/users/laanwj/followers",
      "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/laanwj",
      "id" : 126646,
      "login" : "laanwj",
      "organizations_url" : "https://api.github.com/users/laanwj/orgs",
      "received_events_url" : "https://api.github.com/users/laanwj/received_events",
      "repos_url" : "https://api.github.com/users/laanwj/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/laanwj"
   }
}
