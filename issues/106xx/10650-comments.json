[
   {
      "body" : "This would make much more sense as `?wallet=WALLETID` than trying to emulate a path...",
      "created_at" : "2017-06-22T07:56:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-310305250",
      "id" : 310305250,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-06-22T07:56:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/310305250",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "> This would make much more sense as ?wallet=WALLETID than trying to emulate a path...\r\n\r\nNo. Please no query string.\r\nThat doesn't make sense to me.\r\n\r\nPOST data to `/wallet/<name>` seems more reasonable to me then POST data to `/?wallet=<name>`",
      "created_at" : "2017-06-22T09:30:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-310328049",
      "id" : 310328049,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-06-22T09:30:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/310328049",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r123475967"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123475967"
         }
      },
      "body" : "In commit \"Add -wallet endpoint support to bitcoin-cli\":\r\n\r\nProbably should url encode in case filename contains spaces, reserved characters, or unicode (utf8) https://en.wikipedia.org/wiki/Percent-encoding#Percent-encoding_reserved_characters\r\n\r\nCorresponding decode would be needed in GetWalletForJSONRPCRequest.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-06-22T10:38:00Z",
      "diff_hunk" : "@@ -235,7 +235,12 @@ UniValue CallRPC(const std::string& strMethod, const UniValue& params)\n     assert(output_buffer);\n     evbuffer_add(output_buffer, strRequest.data(), strRequest.size());\n \n-    int r = evhttp_make_request(evcon.get(), req.get(), EVHTTP_REQ_POST, \"/\");\n+    // check if we should use a special wallet endpoint\n+    std::string endpoint = \"/\";\n+    if (GetArg(\"-wallet\", \"\") != \"\") {\n+        endpoint = \"/wallet/\"+GetArg(\"-wallet\", \"\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r123475967",
      "id" : 123475967,
      "original_commit_id" : "2753ea62b9ac1fbae8b5b96f251b0f46246253e4",
      "original_position" : 8,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 45681446,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123475967",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r123484826"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123484826"
         }
      },
      "body" : "In commit \"[QA] Add support for wallet endpoints in Authproxy\"\r\n\r\nIt seems hacky to me for AuthServiceProxy to be aware of multiwallet and to be munging urls and service name strings this way.\r\n\r\nI think it would be better if AuthServiceProxy didn't know anything about bitcoin urls and just let the caller control the request. There are many ways to allow this, but a simple one might be to define:\r\n\r\n```python\r\ndef __idiv__(self, relative_uri):\r\n    return AuthServiceProxy(\"{}/{}\".format(self.__service_url, relative_uri), self._service_name, connection=self.__conn)\r\n```\r\n\r\nThen you could call methods on individual wallets with:\r\n\r\n```python\r\nw1 = self.nodes[0] / \"wallet/w1.dat\"\r\nw1.getwalletinfo()\r\nw1.getbalance()\r\n```",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-06-22T11:25:51Z",
      "diff_hunk" : "@@ -139,17 +139,24 @@ def _request(self, method, path, postdata):\n             return self._get_response()\n \n     def __call__(self, *args, **argsn):\n-        AuthServiceProxy.__id_count += 1\n+        # check for a possible wallet endpoint\n+        urlAdd = \"\"\n+        method = self._service_name\n+        elements = self._service_name.split(\".\")\n+        if len(elements) > 1:\n+            urlAdd = \"/wallet/\" + '.'.join(elements[:-1])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r123484826",
      "id" : 123484826,
      "original_commit_id" : "8775248d0699f433c983fb986d86186ff1cab94f",
      "original_position" : 10,
      "path" : "test/functional/test_framework/authproxy.py",
      "position" : null,
      "pull_request_review_id" : 45681446,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123484826",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r123489861"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123489861"
         }
      },
      "body" : "In commit \"Add -wallet endpoint support to bitcoin-cli\":\r\n\r\nYou should update `HelpMessageCli` to mention the new argument.\r\n\r\nSince I started making a similar change (but didn't get very far) you could steal my help string:\r\n\r\n```diff\r\nstrUsage += HelpMessageOpt(\"-wallet=<file>\", _(\"Send RPC for non-default wallet on RPC server (argument is wallet filename in bitcoind directory)\"));\r\n```",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-06-22T11:54:51Z",
      "diff_hunk" : "@@ -235,7 +235,12 @@ UniValue CallRPC(const std::string& strMethod, const UniValue& params)\n     assert(output_buffer);\n     evbuffer_add(output_buffer, strRequest.data(), strRequest.size());\n \n-    int r = evhttp_make_request(evcon.get(), req.get(), EVHTTP_REQ_POST, \"/\");\n+    // check if we should use a special wallet endpoint\n+    std::string endpoint = \"/\";\n+    if (GetArg(\"-wallet\", \"\") != \"\") {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r123489861",
      "id" : 123489861,
      "original_commit_id" : "2753ea62b9ac1fbae8b5b96f251b0f46246253e4",
      "original_position" : 7,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 45681446,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123489861",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "body" : "Concept ACK, will review.\r\n\r\n> POST data to /wallet/<name> seems more reasonable to me then POST data to /?wallet=<name>\r\n\r\nI tend to agree:\r\n- The use of query strings is usually avoided in modern APIs because they make URLs less readable, compared to path segments.\r\n- Also for POST the query data is in the payload. It is very uncommon  to have query arguments in the URL.",
      "created_at" : "2017-06-22T13:36:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-310382168",
      "id" : 310382168,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-06-22T13:36:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/310382168",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I guess personally I don't see how `/?wallet=<name>` is \"less readable\" then `/wallet/<name>` and I think I mentioned some practical reasons above for wanting to prefer query strings, but I don't have a very strong preference.\r\n\r\nIf we want to go down the road of encoding request metadata in path segments instead of query parameters maybe we should put more thought into what the path hierarchy should be? It isn't obvious to me that you'd want to put wallet selection at the very top of the path hierarchy instead of something else like an API version version number.",
      "created_at" : "2017-06-22T15:06:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-310408400",
      "id" : 310408400,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-06-22T15:06:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/310408400",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r123543935"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123543935"
         }
      },
      "body" : "In commit \"Select wallet based on the given endpoint\"\r\n\r\nMaybe change error message to something like \"Wallet file does not exist or is not loaded\" to avoid implying that the wallet doesn't exist when it might just not be loaded.\r\n\r\nAlso, since this is a URI, sanitize call should be changed to allow `%` character and probably all reserved and unreserved characters from RFC3986 (`\"%-_.~!*'();:@&=+$,/?#[]\"`).",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-06-22T15:31:04Z",
      "diff_hunk" : "@@ -31,10 +31,30 @@\n \n #include <univalue.h>\n \n+static const std::string WALLET_ENDPOINT_BASE = \"/wallet/\";\n+\n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    // TODO: Some way to access secondary wallets\n-    return vpwallets.empty() ? nullptr : vpwallets[0];\n+    LOCK(cs_main); // for now, protect vpwallets via cs_main\n+\n+    if (vpwallets.empty()) {\n+        return nullptr;\n+    }\n+    else if (request.URI.substr(0, WALLET_ENDPOINT_BASE.size()) == WALLET_ENDPOINT_BASE) {\n+        // wallet endpoint was used\n+        std::string requestedWallet = request.URI.substr(WALLET_ENDPOINT_BASE.size());\n+        for(CWallet* pwallet : vpwallets) {\n+            if (pwallet->GetWalletID() == requestedWallet) {\n+                return pwallet;\n+            }\n+        }\n+        // no wallet found with the given endpoint\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Requested wallet not found (\"+SanitizeString(requestedWallet)+\")\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r123543935",
      "id" : 123543935,
      "original_commit_id" : "1fa7d7e26b5056c66fabd1bec12c208f4dc963c8",
      "original_position" : 24,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 45758667,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123543935",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "body" : "My initial impression was \"I thought we were going to put an RPC api version in the path\" too. FWIW.  I don't know what the norms are in this kind of rpc thing.  Are there parallels in hosted wallet service APIs in the Bitcoin space already?",
      "created_at" : "2017-06-22T18:42:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-310467327",
      "id" : 310467327,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-06-22T18:42:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/310467327",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "Yes. Versioning makes probably sense at this point.\r\nThe often seen design advice is `/api/v1/wallet?id=walletid`, though not sure if we want the `/api/`.\r\n\r\nI could think of `/v1/wallet/walletID`.\r\n\r\nThe query string makes sense if we expect multiple non-hierarchical inputs.\r\n\r\nIf we start to use a URI query-string == non-hierarchical inputs, where would be the main difference between the query-string key/value level and the JSON key/value level?\r\nWhat are the arguments for a query-string rather then put the wallet id into the JSON RPC request?\r\n\r\nI don't think there are huge advantages/disadvantages between query-string vs path. It's probably a design choice, matter of taste.",
      "created_at" : "2017-06-22T19:39:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-310481482",
      "id" : 310481482,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-06-22T19:39:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/310481482",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "> If we start to use a URI query-string == non-hierarchical inputs, where would be the main difference between the query-string key/value level and the JSON key/value level?\r\n\r\nI think for simplicity we should almost always prefer using JSON-RPC parameters for passing request options. If I were designing a bitcoin JSON-RPC API from scratch, I'd require a fixed, basic, future-proof request-uri like `/api/v1` and require request options to be specified in JSON-RPC parameters, not in out-of-band url path extensions, or query strings, or http headers.\r\n\r\nBut in this case we're talking about updating an existing JSON-RPC API with dozens of commands that already have their own ways of interpreting JSON-RPC parameters and that all assume they'll be interacting with a single wallet. So for backwards compatability, I think it's a good idea to allow an out-of-band `wallet=filename` option that can be tacked on to the request-uri query string and onto the bitcoin-cli command line, and that will control which wallet the existing API methods will access by default, without having to update dozens of individual method implementations, or change API in an incompatible way.\r\n\r\nI think if you want to come up with complicated new URL schemes or authorization schemes to provide more structured and controlled access to the API, that could be great, but it goes beyond what you need for basic backward-compatible multiwallet support, which is a simple `wallet=filename` option that you can tack on to requests and command lines.",
      "created_at" : "2017-06-22T20:37:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-310495487",
      "id" : 310495487,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-06-22T20:37:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/310495487",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "body" : "Another multiwallet RPC implemention for discussion: #10653",
      "created_at" : "2017-06-22T23:55:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-310533555",
      "id" : 310533555,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-06-22T23:55:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/310533555",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "body" : "Added the /v1/ path element.\r\n\r\n@ryanofsky pointed out that we should urlencode/decode the walletID in the path element.\r\nNot having to do this is one advantage of putting the walletID into the JSON part (but again, having the wallet selector in the JSON layer makes later server separation harder).\r\n\r\nThe walletID should in future not be a representation of the filename. User should be able to manually choose the walletID. Ideally, we write the walletID into the wallet database. There we could only allow alphanumeric chars.",
      "created_at" : "2017-06-23T08:35:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-310606962",
      "id" : 310606962,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-06-23T08:35:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/310606962",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "> but again, having the wallet selector in the JSON layer makes later server separation harder\r\n\r\nWhat's this about? I think I missed this point...\r\n\r\n> Ideally, we write the walletID into the wallet database. There we could only allow alphanumeric chars.\r\n\r\nI don't think I understand the advantages of adding a \"walletID.\" The user already has to choose one name for the wallet when they make a filename, so what's the advantage of being able to choose two potentially different names for the same wallet? It seems like this would only add confusion.\r\n\r\nAlso, even you only allow alphanumerics, unless you restrict to english, you still need percent encoding for unicode.",
      "created_at" : "2017-06-23T11:06:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-310638177",
      "id" : 310638177,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-06-23T11:06:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/310638177",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "body" : ">> but again, having the wallet selector in the JSON layer makes later server separation harder\r\n\r\n> What's this about? I think I missed this point...\r\n\r\nIf we would decouple the wallet completely, a specific endpoint could probably be the better approach to switch between processes or/and even implementations.\r\n\r\n> I don't think I understand the advantages of adding a \"walletID.\" The user already has to choose one name for the wallet when they make a filename, so what's the advantage of being able to choose two potentially different names for the same wallet? It seems like this would only add confusion.\r\n\r\nYeah. Not sure if custom wallet names is a good idea. AFAIK most multiwallet application offer a custom wallet naming.\r\nBut I agree, walletID should probably be the filename, otherwise this may lead to huge confusion.\r\n\r\n> Also, even you only allow alphanumerics, unless you restrict to English, you still need percent encoding for unicode.\r\n\r\nIndeed.\r\n\r\n### API design\r\nUsing the HTTP request path makes sense to me.\r\n\r\nURLEncode/Decode would then be required if we use the path approach (not required if we embed the walletID in the JSON payload).\r\n\r\nLets have a look at GitHub's API (I don't say its good just because it's GitHub):\r\n`https://api.github.com/repos/bitcoin/bitcoin/issues?state=closed`.\r\n\r\nFor me, that makes perfect sense.\r\nWe locate a resource via: `https://api.github.com/repos/bitcoin/bitcoin/issues` and query it with `state=closed`.\r\n\r\nSame for HTTP posts:\r\n`https://api.github.com/repos/bitcoin/bitcoin/pulls/10000`.\r\nThen a JSON post of\r\n```json\r\n{\r\n  \"title\": \"new title\",\r\n  \"body\": \"updated body\",\r\n  \"state\": \"open\",\r\n  \"base\": \"master\"\r\n}\r\n```",
      "created_at" : "2017-06-23T11:34:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-310643221",
      "id" : 310643221,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-06-23T11:34:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/310643221",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "To summarize current state of things, we have 3 (nonexclusive) choices for allowing existing RPC methods work on multiple wallets:\r\n\r\n1. Add optional \"wallet\" JSON-RPC parameters to wallet RPC methods. There implementations of this in #10653 and #10661.\r\n2. Add a wallet option to the JSON-RPC endpoint URL. Could just be a query option, or could be baked into structure of a new request-path scheme. This is implemented here in #10650.\r\n3. Add a wallet option to `-rpcauth` config strings. This is implemented in #10615.",
      "created_at" : "2017-06-23T19:41:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-310755811",
      "id" : 310755811,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-06-23T19:52:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/310755811",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "body" : "Long term, here's one suggestion of how this could work:\r\n\r\n1. each wallet runs in its own process, and binds to a separate local port. Users can access RPCs for wallet commands directly on that port\r\n2. each wallet has its own rpcauth config, to control access to that wallet. A single user may have access to multiple wallets\r\n3. The bitcoin-server RPC server can dispatch wallet commands to individual wallets based on which endpoint the RPC was received on (either as a query option or request-path scheme). We could either make bitcoin-server RPC users have superuser access to all wallets or authenticate per call.\r\n\r\nI think that achieves the multi-user functionality from #10615 without the drawbacks:\r\n\r\n- it's more secure since individual wallet users won't have access to the bitcoin-server RPC interface, and will only be connecting to the wallet process\r\n- it doesn't tie users to as single wallet\r\n- it doesn't add dependencies from bitcoin-server to bitcoin-wallet.\r\n\r\nShort-term, we can implement this PR, either with query options or a request-path scheme. When the wallet is separated, the interface doesn't have to change, since this is (3) from the design above. My preference is for a query option, since this seems more flexible and doesn't restrict the API scheme if we want to use a different request-path in future.\r\n\r\nIf it's going to take time to get this PR merged, I think we should merge #10653 as a short-term measure, with warnings that the API will change.",
      "created_at" : "2017-06-28T14:03:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-311669411",
      "id" : 311669411,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-06-28T14:03:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/311669411",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1063656?v=3",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r125478756"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125478756"
         }
      },
      "body" : "Use `evhttp_uriencode()`?",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-04T13:54:36Z",
      "diff_hunk" : "@@ -701,3 +702,28 @@ bool ParseFixedPoint(const std::string &val, int decimals, int64_t *amount_out)\n     return true;\n }\n \n+std::string urlEncode(const std::string &urlPart) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r125478756",
      "id" : 125478756,
      "original_commit_id" : "b5088c505f492eb6de7ca9cffd3b5caf522f1168",
      "original_position" : 12,
      "path" : "src/utilstrencodings.cpp",
      "position" : null,
      "pull_request_review_id" : 47869785,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125478756",
      "user" : {
         "avatar_url" : "https://avatars5.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r125478798"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125478798"
         }
      },
      "body" : "Use `evhttp_uridecode()`?",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-04T13:54:52Z",
      "diff_hunk" : "@@ -701,3 +702,28 @@ bool ParseFixedPoint(const std::string &val, int decimals, int64_t *amount_out)\n     return true;\n }\n \n+std::string urlEncode(const std::string &urlPart) {\n+    std::ostringstream escaped;\n+    escaped.fill('0');\n+    escaped << std::hex;\n+\n+    for (const std::string::value_type c : urlPart) {\n+        // Keep alphanumeric and other accepted characters intact\n+        if (isalnum(c) || c == '-' || c == '_' || c == '.' || c == '~') {\n+            escaped << c;\n+            continue;\n+        }\n+\n+        // Any other characters are percent-encoded\n+        escaped << std::uppercase;\n+        escaped << '%' << std::setw(2) << int((unsigned char) c);\n+        escaped << std::nouppercase;\n+    }\n+\n+    return escaped.str();\n+}\n+\n+std::string urlDecode(const std::string &urlEncoded) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r125478798",
      "id" : 125478798,
      "original_commit_id" : "b5088c505f492eb6de7ca9cffd3b5caf522f1168",
      "original_position" : 33,
      "path" : "src/utilstrencodings.cpp",
      "position" : null,
      "pull_request_review_id" : 47869785,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125478798",
      "user" : {
         "avatar_url" : "https://avatars5.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r125479615"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125479615"
         }
      },
      "body" : "Use `evhttp_uri` and it's primitives?",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-04T13:58:55Z",
      "diff_hunk" : "@@ -235,7 +235,13 @@ UniValue CallRPC(const std::string& strMethod, const UniValue& params)\n     assert(output_buffer);\n     evbuffer_add(output_buffer, strRequest.data(), strRequest.size());\n \n-    int r = evhttp_make_request(evcon.get(), req.get(), EVHTTP_REQ_POST, \"/\");\n+    // check if we should use a special wallet endpoint\n+    std::string endpoint = \"/\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r125479615",
      "id" : 125479615,
      "original_commit_id" : "b5088c505f492eb6de7ca9cffd3b5caf522f1168",
      "original_position" : 6,
      "path" : "src/bitcoin-cli.cpp",
      "position" : 14,
      "pull_request_review_id" : 47869785,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125479615",
      "user" : {
         "avatar_url" : "https://avatars5.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r125480438"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125480438"
         }
      },
      "body" : "const.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-04T14:03:00Z",
      "diff_hunk" : "@@ -1122,6 +1124,8 @@ class CWallet : public CCryptoKeyStore, public CValidationInterface\n        caller must ensure the current wallet version is correct before calling\n        this function). */\n     bool SetHDMasterKey(const CPubKey& key);\n+\n+    const std::string GetWalletID() { return walletID; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r125480438",
      "id" : 125480438,
      "original_commit_id" : "b5088c505f492eb6de7ca9cffd3b5caf522f1168",
      "original_position" : 23,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_review_id" : 47869785,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125480438",
      "user" : {
         "avatar_url" : "https://avatars5.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r125493753"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125493753"
         }
      },
      "body" : "Oh! Very good point. Will do that.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-04T15:08:00Z",
      "diff_hunk" : "@@ -701,3 +702,28 @@ bool ParseFixedPoint(const std::string &val, int decimals, int64_t *amount_out)\n     return true;\n }\n \n+std::string urlEncode(const std::string &urlPart) {\n+    std::ostringstream escaped;\n+    escaped.fill('0');\n+    escaped << std::hex;\n+\n+    for (const std::string::value_type c : urlPart) {\n+        // Keep alphanumeric and other accepted characters intact\n+        if (isalnum(c) || c == '-' || c == '_' || c == '.' || c == '~') {\n+            escaped << c;\n+            continue;\n+        }\n+\n+        // Any other characters are percent-encoded\n+        escaped << std::uppercase;\n+        escaped << '%' << std::setw(2) << int((unsigned char) c);\n+        escaped << std::nouppercase;\n+    }\n+\n+    return escaped.str();\n+}\n+\n+std::string urlDecode(const std::string &urlEncoded) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r125493753",
      "id" : 125493753,
      "original_commit_id" : "b5088c505f492eb6de7ca9cffd3b5caf522f1168",
      "original_position" : 33,
      "path" : "src/utilstrencodings.cpp",
      "position" : null,
      "pull_request_review_id" : 47888026,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125493753",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126151074"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126151074"
         }
      },
      "body" : "I guess for the endpoint a plain std::string is okay.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-07T13:50:17Z",
      "diff_hunk" : "@@ -235,7 +235,13 @@ UniValue CallRPC(const std::string& strMethod, const UniValue& params)\n     assert(output_buffer);\n     evbuffer_add(output_buffer, strRequest.data(), strRequest.size());\n \n-    int r = evhttp_make_request(evcon.get(), req.get(), EVHTTP_REQ_POST, \"/\");\n+    // check if we should use a special wallet endpoint\n+    std::string endpoint = \"/\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126151074",
      "id" : 126151074,
      "original_commit_id" : "b5088c505f492eb6de7ca9cffd3b5caf522f1168",
      "original_position" : 6,
      "path" : "src/bitcoin-cli.cpp",
      "position" : 14,
      "pull_request_review_id" : 48610802,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126151074",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Rebased and overhauled.\r\nAdded urlencode/urldecode via libevent (thanks @promag for the hint).\r\nThere is now a `/v1/node/` and a `/v1/wallet/<filename>` endpoint.\r\nThe endpoint-split is not very mature yet, but does the job (we should then mark it as experimental in the 0.15 release notes).\r\n\r\nWhat can be done outside  this already large  PR:\r\n* Better API versioning\r\n* RPC tests multiwallet support (currently approach `self.nodes[1].<walletfilename>.metho\bd` may not be the best)\r\n* Release notes\r\n\r\nPassed travis now (see circular dependency fix 386c299 [ping @theuni]).",
      "created_at" : "2017-07-07T14:44:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-313702138",
      "id" : 313702138,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-07T14:45:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/313702138",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126449799"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126449799"
         }
      },
      "body" : "Note that \"Add -wallet endpoint support to bitcoin-cli\" doesnt build as urlDecode is undefined here (you need to swap commit ordering).",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-10T15:09:50Z",
      "diff_hunk" : "@@ -43,7 +43,7 @@ CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n     }\n     else if (request.URI.substr(0, WALLET_ENDPOINT_BASE.size()) == WALLET_ENDPOINT_BASE) {\n         // wallet endpoint was used\n-        std::string requestedWallet = request.URI.substr(WALLET_ENDPOINT_BASE.size());\n+        std::string requestedWallet = urlDecode(request.URI.substr(WALLET_ENDPOINT_BASE.size()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126449799",
      "id" : 126449799,
      "original_commit_id" : "ea785096c052abf6d7211ebb52d758cca89a972b",
      "original_position" : 5,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 48934394,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126449799",
      "user" : {
         "avatar_url" : "https://avatars4.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126453963"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126453963"
         }
      },
      "body" : "Wait, why?",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-10T15:22:11Z",
      "diff_hunk" : "@@ -10,6 +10,7 @@\n #include <cstdlib>\n #include <cstring>\n #include <errno.h>\n+#include <iomanip>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126453963",
      "id" : 126453963,
      "original_commit_id" : "386c299270cd955aebc7984b319805ac7403e906",
      "original_position" : 4,
      "path" : "src/utilstrencodings.cpp",
      "position" : null,
      "pull_request_review_id" : 48934394,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126453963",
      "user" : {
         "avatar_url" : "https://avatars4.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126456469"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126456469"
         }
      },
      "body" : "This seems superfluous. Why not just either auto-register based on the endpoint in the commands table or just register everything explicitly in httprpc.cpp (its only 4 things).",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-10T15:31:04Z",
      "diff_hunk" : "@@ -226,6 +226,11 @@ static bool InitRPCAuthentication()\n     return true;\n }\n \n+void RegisterJSONEndpoint(const std::string& endpoint, bool exactMatch)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126456469",
      "id" : 126456469,
      "original_commit_id" : "617ce96f11a988d89837a0119f1eb954f6af47a3",
      "original_position" : 4,
      "path" : "src/httprpc.cpp",
      "position" : 4,
      "pull_request_review_id" : 48934394,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126456469",
      "user" : {
         "avatar_url" : "https://avatars4.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126456621"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126456621"
         }
      },
      "body" : "Can we use some constant for this instead of duplicating the string everyhwere?",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-10T15:31:35Z",
      "diff_hunk" : "@@ -1535,33 +1535,33 @@ UniValue getchaintxstats(const JSONRPCRequest& request)\n static const CRPCCommand commands[] =\n { //  category              name                      actor (function)         okSafe argNames\n   //  --------------------- ------------------------  -----------------------  ------ ----------\n-    { \"blockchain\",         \"getblockchaininfo\",      &getblockchaininfo,      true,  {} },\n-    { \"blockchain\",         \"getchaintxstats\",        &getchaintxstats,        true,  {\"nblocks\", \"blockhash\"} },\n-    { \"blockchain\",         \"getbestblockhash\",       &getbestblockhash,       true,  {} },\n-    { \"blockchain\",         \"getblockcount\",          &getblockcount,          true,  {} },\n-    { \"blockchain\",         \"getblock\",               &getblock,               true,  {\"blockhash\",\"verbosity|verbose\"} },\n-    { \"blockchain\",         \"getblockhash\",           &getblockhash,           true,  {\"height\"} },\n-    { \"blockchain\",         \"getblockheader\",         &getblockheader,         true,  {\"blockhash\",\"verbose\"} },\n-    { \"blockchain\",         \"getchaintips\",           &getchaintips,           true,  {} },\n-    { \"blockchain\",         \"getdifficulty\",          &getdifficulty,          true,  {} },\n-    { \"blockchain\",         \"getmempoolancestors\",    &getmempoolancestors,    true,  {\"txid\",\"verbose\"} },\n-    { \"blockchain\",         \"getmempooldescendants\",  &getmempooldescendants,  true,  {\"txid\",\"verbose\"} },\n-    { \"blockchain\",         \"getmempoolentry\",        &getmempoolentry,        true,  {\"txid\"} },\n-    { \"blockchain\",         \"getmempoolinfo\",         &getmempoolinfo,         true,  {} },\n-    { \"blockchain\",         \"getrawmempool\",          &getrawmempool,          true,  {\"verbose\"} },\n-    { \"blockchain\",         \"gettxout\",               &gettxout,               true,  {\"txid\",\"n\",\"include_mempool\"} },\n-    { \"blockchain\",         \"gettxoutsetinfo\",        &gettxoutsetinfo,        true,  {} },\n-    { \"blockchain\",         \"pruneblockchain\",        &pruneblockchain,        true,  {\"height\"} },\n-    { \"blockchain\",         \"verifychain\",            &verifychain,            true,  {\"checklevel\",\"nblocks\"} },\n-\n-    { \"blockchain\",         \"preciousblock\",          &preciousblock,          true,  {\"blockhash\"} },\n+    { \"blockchain\",         \"/v1/node/\",  \"getblockchaininfo\",      &getblockchaininfo,      true,  {} },",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126456621",
      "id" : 126456621,
      "original_commit_id" : "386c299270cd955aebc7984b319805ac7403e906",
      "original_position" : 24,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 48934394,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126456621",
      "user" : {
         "avatar_url" : "https://avatars4.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126923023"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126923023"
         }
      },
      "body" : "In commit \"Expose JSON endpoint registration\"\r\n\r\nI don't see the reasoning for this either... If you decide to keep this, maybe document the function with a comment to explain why the urls shouldn't be listed in a single place.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-12T10:51:51Z",
      "diff_hunk" : "@@ -226,6 +226,11 @@ static bool InitRPCAuthentication()\n     return true;\n }\n \n+void RegisterJSONEndpoint(const std::string& endpoint, bool exactMatch)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126923023",
      "id" : 126923023,
      "original_commit_id" : "617ce96f11a988d89837a0119f1eb954f6af47a3",
      "original_position" : 4,
      "path" : "src/httprpc.cpp",
      "position" : 4,
      "pull_request_review_id" : 49453724,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126923023",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126923979"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126923979"
         }
      },
      "body" : "In commit \"Register /wallet/* endpoint in RPC server\"\r\n\r\nName `MaybeRegisterWalletRPCEndpoints` might be more descriptive since nothing happens if wallet is disabled.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-12T10:57:26Z",
      "diff_hunk" : "@@ -3044,3 +3048,11 @@ void RegisterWalletRPCCommands(CRPCTable &t)\n     for (unsigned int vcidx = 0; vcidx < ARRAYLEN(commands); vcidx++)\n         t.appendCommand(commands[vcidx].name, &commands[vcidx]);\n }\n+\n+void RegisterWalletRPCEndpoints()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126923979",
      "id" : 126923979,
      "original_commit_id" : "177fc1a6b7b104831c9a7c7aa6fd163a26bbeadb",
      "original_position" : 23,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 49453724,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126923979",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126925235"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126925235"
         }
      },
      "body" : "In commit \"Select wallet based on the given endpoint\"\r\n\r\nPrevious comment not addressed (https://github.com/bitcoin/bitcoin/pull/10650#discussion_r123543935)",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-12T11:04:20Z",
      "diff_hunk" : "@@ -31,10 +31,30 @@\n \n #include <univalue.h>\n \n+static const std::string WALLET_ENDPOINT_BASE = \"/wallet/\";\n+\n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    // TODO: Some way to access secondary wallets\n-    return vpwallets.empty() ? nullptr : vpwallets[0];\n+    LOCK(cs_main); // for now, protect vpwallets via cs_main\n+\n+    if (vpwallets.empty()) {\n+        return nullptr;\n+    }\n+    else if (request.URI.substr(0, WALLET_ENDPOINT_BASE.size()) == WALLET_ENDPOINT_BASE) {\n+        // wallet endpoint was used\n+        std::string requestedWallet = request.URI.substr(WALLET_ENDPOINT_BASE.size());\n+        for(CWallet* pwallet : vpwallets) {\n+            if (pwallet->GetWalletID() == requestedWallet) {\n+                return pwallet;\n+            }\n+        }\n+        // no wallet found with the given endpoint\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Requested wallet not found (\"+SanitizeString(requestedWallet)+\")\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126925235",
      "id" : 126925235,
      "original_commit_id" : "1fa7d7e26b5056c66fabd1bec12c208f4dc963c8",
      "original_position" : 24,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 49453724,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126925235",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126926410"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126926410"
         }
      },
      "body" : "In commit \"Select wallet based on the given endpoint\"\r\n\r\nThis logic doesn't seem right because it will silently ignore the `requestedWallet` value when `vpwallets` is empty. It would be better to trigger the \"Requested wallet not found\" error if `requestedWallet` is nonempty when `vpwallets` is empty instead of silently ignoring the `requestedWallet` value.\r\n\r\nYou could fix this by just deleting this early return and changing the last line to `return vpwallets.empty() ? nullptr : vpwallets[0];`",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-12T11:11:13Z",
      "diff_hunk" : "@@ -36,8 +36,26 @@ static const std::string WALLET_ENDPOINT_BASE = \"/v1/wallet/\";\n \n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    // TODO: Some way to access secondary wallets\n-    return vpwallets.empty() ? nullptr : vpwallets[0];\n+    LOCK(cs_main); // for now, protect vpwallets via cs_main\n+\n+    if (vpwallets.empty()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126926410",
      "id" : 126926410,
      "original_commit_id" : "0e7d0c129abfca17ecaa48b8d8b2c39ec8a7f903",
      "original_position" : 8,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 49453724,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126926410",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126928365"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126928365"
         }
      },
      "body" : "In commit \"Select wallet based on the given endpoint\"\r\n\r\nPer @laanwj's comment at https://github.com/bitcoin/bitcoin/pull/10653#issuecomment-310833084, I think it would be a good idea for this to raise an error if vpwallets.size() is not 1. If somebody has loaded multiple wallets, they should have to explicitly specify which wallet they want to call. Otherwise, it's easy to imagine writing a script that makes many rpc calls, and forgets to add the `-wallet=` option in one call, and suddenly winds up using funds or balances from the wrong wallet, causing dangerous or difficult to debug errors.\r\n\r\nHaving a default wallet is needed for backwards compatibility when there is 1 wallet, but otherwise it just seems like a dangerous and not very useful idea to want to support right now.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-12T11:23:25Z",
      "diff_hunk" : "@@ -36,8 +36,26 @@ static const std::string WALLET_ENDPOINT_BASE = \"/v1/wallet/\";\n \n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    // TODO: Some way to access secondary wallets\n-    return vpwallets.empty() ? nullptr : vpwallets[0];\n+    LOCK(cs_main); // for now, protect vpwallets via cs_main\n+\n+    if (vpwallets.empty()) {\n+        return nullptr;\n+    }\n+    else if (request.URI.substr(0, WALLET_ENDPOINT_BASE.size()) == WALLET_ENDPOINT_BASE) {\n+        // wallet endpoint was used\n+        std::string requestedWallet = request.URI.substr(WALLET_ENDPOINT_BASE.size());\n+        for(CWallet* pwallet : vpwallets) {\n+            if (pwallet->GetWalletID() == requestedWallet) {\n+                return pwallet;\n+            }\n+        }\n+        // no wallet found with the given endpoint\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Requested wallet not found (\"+SanitizeString(requestedWallet)+\")\");\n+    }\n+    else {\n+        // default endpoint, use first wallet\n+        return vpwallets[0];",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126928365",
      "id" : 126928365,
      "original_commit_id" : "0e7d0c129abfca17ecaa48b8d8b2c39ec8a7f903",
      "original_position" : 24,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 49453724,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126928365",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126967741"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126967741"
         }
      },
      "body" : "In commit \"Add a walletID to CWallet (use filename for now)\"\r\n\r\nI believe this commit should be dropped because we already have a `CWallet::GetName()` method and the duplicative functionality introduced here with mysterious \"for now\" comments is just confusing.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-12T14:20:58Z",
      "diff_hunk" : "@@ -3793,7 +3793,7 @@ CWallet* CWallet::CreateWalletFromFile(const std::string walletFile)\n     int64_t nStart = GetTimeMillis();\n     bool fFirstRun = true;\n     std::unique_ptr<CWalletDBWrapper> dbw(new CWalletDBWrapper(&bitdb, walletFile));\n-    CWallet *walletInstance = new CWallet(std::move(dbw));\n+    CWallet *walletInstance = new CWallet(std::move(dbw), walletFile); // use filename as walletID for now",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126967741",
      "id" : 126967741,
      "original_commit_id" : "7025861eebc96fbeb1bb5b56479a557bc0264d7b",
      "original_position" : 14,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 49453724,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126967741",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126968651"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126968651"
         }
      },
      "body" : "In commit \"Select wallet based on the given endpoint\"\r\n\r\n`requestedWallet` should be percent decoded here.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-12T14:24:20Z",
      "diff_hunk" : "@@ -36,8 +36,26 @@ static const std::string WALLET_ENDPOINT_BASE = \"/v1/wallet/\";\n \n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    // TODO: Some way to access secondary wallets\n-    return vpwallets.empty() ? nullptr : vpwallets[0];\n+    LOCK(cs_main); // for now, protect vpwallets via cs_main\n+\n+    if (vpwallets.empty()) {\n+        return nullptr;\n+    }\n+    else if (request.URI.substr(0, WALLET_ENDPOINT_BASE.size()) == WALLET_ENDPOINT_BASE) {\n+        // wallet endpoint was used\n+        std::string requestedWallet = request.URI.substr(WALLET_ENDPOINT_BASE.size());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126968651",
      "id" : 126968651,
      "original_commit_id" : "0e7d0c129abfca17ecaa48b8d8b2c39ec8a7f903",
      "original_position" : 13,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 49453724,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126968651",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126969502"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126969502"
         }
      },
      "body" : "In commit \"Add -wallet endpoint support to bitcoin-cli\"\r\n\r\nPrevious comment not addressed (https://github.com/bitcoin/bitcoin/pull/10650#discussion_r123489861).",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-12T14:27:24Z",
      "diff_hunk" : "@@ -235,7 +235,12 @@ UniValue CallRPC(const std::string& strMethod, const UniValue& params)\n     assert(output_buffer);\n     evbuffer_add(output_buffer, strRequest.data(), strRequest.size());\n \n-    int r = evhttp_make_request(evcon.get(), req.get(), EVHTTP_REQ_POST, \"/\");\n+    // check if we should use a special wallet endpoint\n+    std::string endpoint = \"/\";\n+    if (GetArg(\"-wallet\", \"\") != \"\") {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126969502",
      "id" : 126969502,
      "original_commit_id" : "2753ea62b9ac1fbae8b5b96f251b0f46246253e4",
      "original_position" : 7,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 49453724,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126969502",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126971554"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126971554"
         }
      },
      "body" : "In commit \"Add -wallet endpoint support to bitcoin-cli\"\r\n\r\nThis change belongs in commit \"Select wallet based on the given endpoint\" not in this bitcoin-cli commit. Also the commit introducing url encode/decode functions needs to be pushed back earlier in the history like Matt said for this to compile.\r\n\r\nAlternately you could consolidate some of the commits. I don't think having 12 commits in this PR accomplishes very much when many of the commits introduce functionality that isn't called anywhere and doesn't make sense without context from later commits.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-12T14:34:41Z",
      "diff_hunk" : "@@ -43,7 +43,7 @@ CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n     }\n     else if (request.URI.substr(0, WALLET_ENDPOINT_BASE.size()) == WALLET_ENDPOINT_BASE) {\n         // wallet endpoint was used\n-        std::string requestedWallet = request.URI.substr(WALLET_ENDPOINT_BASE.size());\n+        std::string requestedWallet = urlDecode(request.URI.substr(WALLET_ENDPOINT_BASE.size()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126971554",
      "id" : 126971554,
      "original_commit_id" : "ea785096c052abf6d7211ebb52d758cca89a972b",
      "original_position" : 5,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 49453724,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126971554",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126972266"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126972266"
         }
      },
      "body" : "In commit \"Add urlencode/decode via libevent2\"\r\n\r\nMemory leak here, need to free `encodedURI`.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-12T14:37:10Z",
      "diff_hunk" : "@@ -237,9 +237,13 @@ UniValue CallRPC(const std::string& strMethod, const UniValue& params)\n \n     // check if we should use a special wallet endpoint\n     std::string endpoint = \"/\";\n-    if (GetArg(\"-wallet\", \"\") != \"\") {\n+    std::string walletName = GetArg(\"-wallet\", \"\");\n+    if (walletName != \"\") {\n         // always use v1 endpoint if -wallet has been provided\n-        endpoint = \"/v1/wallet/\"+urlEncode(GetArg(\"-wallet\", \"\"));\n+        char *encodedURI = evhttp_uriencode(walletName.c_str(), walletName.size(), false);\n+        if (encodedURI) {\n+            endpoint = \"/v1/wallet/\"+ std::string(encodedURI);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126972266",
      "id" : 126972266,
      "original_commit_id" : "73dbe48ced5c75cf827da54881c011ad95b4abdb",
      "original_position" : 11,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 49453724,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126972266",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126972541"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126972541"
         }
      },
      "body" : "In commit \"Add urlencode/decode via libevent2\"\r\n\r\nMore idiomatic / efficient to write `!walletName.empty()`",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-12T14:38:06Z",
      "diff_hunk" : "@@ -237,9 +237,13 @@ UniValue CallRPC(const std::string& strMethod, const UniValue& params)\n \n     // check if we should use a special wallet endpoint\n     std::string endpoint = \"/\";\n-    if (GetArg(\"-wallet\", \"\") != \"\") {\n+    std::string walletName = GetArg(\"-wallet\", \"\");\n+    if (walletName != \"\") {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126972541",
      "id" : 126972541,
      "original_commit_id" : "73dbe48ced5c75cf827da54881c011ad95b4abdb",
      "original_position" : 6,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 49453724,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126972541",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126973678"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126973678"
         }
      },
      "body" : "In commit \"Add urlencode/decode via libevent2\"\r\n\r\nMore idiomatic / efficient to just use the default string constructor (write `std::string res;`).",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-12T14:42:06Z",
      "diff_hunk" : "@@ -665,3 +665,14 @@ void UnregisterHTTPHandler(const std::string &prefix, bool exactMatch)\n     }\n }\n \n+std::string urlDecode(const std::string &urlEncoded) {\n+    std::string res = \"\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126973678",
      "id" : 126973678,
      "original_commit_id" : "73dbe48ced5c75cf827da54881c011ad95b4abdb",
      "original_position" : 5,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 49453724,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126973678",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126974112"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126974112"
         }
      },
      "body" : "In commit \"Add urlencode/decode via libevent2\"\r\n\r\nSomething seems to have gone a little haywire in the rebased history. This commit seems to be inlining a nonexistent `urlEncode` function, which I think would be a step backwards from having a reusable `urlEncode` function that complements `urlDecode`.\r\n\r\nAlso this commit has unrelated changes to `src/utilstrencodings.cpp` and `src/wallet/rpcwallet.cpp` which should be reverted.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-12T14:43:39Z",
      "diff_hunk" : "@@ -237,9 +237,13 @@ UniValue CallRPC(const std::string& strMethod, const UniValue& params)\n \n     // check if we should use a special wallet endpoint\n     std::string endpoint = \"/\";\n-    if (GetArg(\"-wallet\", \"\") != \"\") {\n+    std::string walletName = GetArg(\"-wallet\", \"\");\n+    if (walletName != \"\") {\n         // always use v1 endpoint if -wallet has been provided\n-        endpoint = \"/v1/wallet/\"+urlEncode(GetArg(\"-wallet\", \"\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126974112",
      "id" : 126974112,
      "original_commit_id" : "73dbe48ced5c75cf827da54881c011ad95b4abdb",
      "original_position" : 8,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 49453724,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126974112",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126976236"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126976236"
         }
      },
      "body" : "In commit \"[QA] Add support for wallet endpoints in Authproxy\"\r\n\r\nIt's fragile, over complicated, and not necessary to add multiwallet code and hardcoded url fragments in authproxy. I suggested a simpler approach here: https://github.com/bitcoin/bitcoin/pull/10650#discussion_r123484826, adding a one-line `__idiv__` method.\r\n",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-12T14:49:56Z",
      "diff_hunk" : "@@ -139,17 +139,24 @@ def _request(self, method, path, postdata):\n             return self._get_response()\n \n     def __call__(self, *args, **argsn):\n-        AuthServiceProxy.__id_count += 1\n+        # check for a possible wallet endpoint\n+        urlAdd = \"\"\n+        method = self._service_name\n+        elements = self._service_name.split(\".\")\n+        if len(elements) > 1:\n+            urlAdd = \"/v1/wallet/\" + '.'.join(elements[:-1])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126976236",
      "id" : 126976236,
      "original_commit_id" : "72fee26bc417aebe6c5d59c3ea975f630920d0a1",
      "original_position" : 10,
      "path" : "test/functional/test_framework/authproxy.py",
      "position" : null,
      "pull_request_review_id" : 49453724,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126976236",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126988589"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126988589"
         }
      },
      "body" : "In commit \"Split node / wallet RPC calls based on the endpoint\"\r\n\r\nI don't see what this has to do with multiwallet support and I think this commit and previous commit should go into a separate PR if we want to introduce a more heavily embroidered URL scheme beyond `/v1/wallet/filename`.\r\n\r\nAlso if there's going to be a JSON-RPC URL scheme, it needs to be documented and explained somewhere (maybe a new `doc/JSONRPC-interface.md` file), and should probably get a some more discussion. Personally I don't see why people seem to be in love with convoluted URL schemes. We are **not** implementing a REST API which is centered around URLs. We are implementing a RPC API where you call a method, pass JSON arguments, and get a JSON return value. I don't think it's good to be adding restrictions and side-channels around the JSON requests without explicit reason.\r\n\r\nSupporting a `?wallet=filename` query option or `/wallet/filename` path selector makes a certain amount of sense if we think JSON-RPC named arguments are too awkward, or because we want to implement a multiprocess framework like the one John described where the RPC handler has \"superuser access\" to all wallets and forwards calls to them (https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-311669411).\r\n\r\nSupporting `/v1`, `/v2` path selectors maybe also makes sense if we want to be able to make breaking changes to RPC methods. And maybe requiring node / wallet URL endpoints also makes sense for reasons that I don't understand, but I definitely think those reasons deserve to be discussed, and to get some documentation, and not to be shoehorned into the last 2 commits of a tangentially related PR.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-12T15:30:49Z",
      "diff_hunk" : "@@ -493,7 +493,12 @@ UniValue CRPCTable::execute(const JSONRPCRequest &request) const\n     const CRPCCommand *pcmd = tableRPC[request.strMethod];\n     if (!pcmd)\n         throw JSONRPCError(RPC_METHOD_NOT_FOUND, \"Method not found\");\n-\n+    if (request.URI != \"\" && request.URI != \"/\") {\n+        // enforce correct endpoint usage",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126988589",
      "id" : 126988589,
      "original_commit_id" : "b62a4bbcb160757453a95552bc27b3a6d05cc1b3",
      "original_position" : 19,
      "path" : "src/rpc/server.cpp",
      "position" : null,
      "pull_request_review_id" : 49453724,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126988589",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126989883"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126989883"
         }
      },
      "body" : "In commit \"Add walletid to getwalletinfo\"\r\n\r\nShould be called `wallet_path` as in #10733, or `walletname` as in #10604 and use the `GetName` method, unless we actually do want to introduce a new wallet id concept. This commit could be also be dropped and left for the other prs.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-12T15:35:03Z",
      "diff_hunk" : "@@ -2434,6 +2434,7 @@ UniValue getwalletinfo(const JSONRPCRequest& request)\n     UniValue obj(UniValue::VOBJ);\n \n     size_t kpExternalSize = pwallet->KeypoolCountExternalKeys();\n+    obj.push_back(Pair(\"walletid\", pwallet->GetWalletID()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126989883",
      "id" : 126989883,
      "original_commit_id" : "6fe03854abb796f995e07af9c43b5545d4dcb241",
      "original_position" : 4,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 49453724,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126989883",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "body" : "@jonasschnelli build change looks fine.",
      "created_at" : "2017-07-12T18:25:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-314855793",
      "id" : 314855793,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-12T18:25:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/314855793",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "Concept ACK on this approach for multiwallet, but needs rebase and addressing of comments.",
      "created_at" : "2017-07-12T19:18:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-314869863",
      "id" : 314869863,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-12T19:18:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/314869863",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127068342"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127068342"
         }
      },
      "body" : "Free `encodedURI`.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-12T20:51:27Z",
      "diff_hunk" : "@@ -235,7 +235,17 @@ UniValue CallRPC(const std::string& strMethod, const UniValue& params)\n     assert(output_buffer);\n     evbuffer_add(output_buffer, strRequest.data(), strRequest.size());\n \n-    int r = evhttp_make_request(evcon.get(), req.get(), EVHTTP_REQ_POST, \"/\");\n+    // check if we should use a special wallet endpoint\n+    std::string endpoint = \"/\";\n+    std::string walletName = GetArg(\"-wallet\", \"\");\n+    if (walletName != \"\") {\n+        // always use v1 endpoint if -wallet has been provided\n+        char *encodedURI = evhttp_uriencode(walletName.c_str(), walletName.size(), false);\n+        if (encodedURI) {\n+            endpoint = \"/v1/wallet/\"+ std::string(encodedURI);\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127068342",
      "id" : 127068342,
      "original_commit_id" : "386c299270cd955aebc7984b319805ac7403e906",
      "original_position" : 13,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 49615846,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127068342",
      "user" : {
         "avatar_url" : "https://avatars5.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127068584"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127068584"
         }
      },
      "body" : "Else should fail?",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-12T20:52:24Z",
      "diff_hunk" : "@@ -235,7 +235,17 @@ UniValue CallRPC(const std::string& strMethod, const UniValue& params)\n     assert(output_buffer);\n     evbuffer_add(output_buffer, strRequest.data(), strRequest.size());\n \n-    int r = evhttp_make_request(evcon.get(), req.get(), EVHTTP_REQ_POST, \"/\");\n+    // check if we should use a special wallet endpoint\n+    std::string endpoint = \"/\";\n+    std::string walletName = GetArg(\"-wallet\", \"\");\n+    if (walletName != \"\") {\n+        // always use v1 endpoint if -wallet has been provided\n+        char *encodedURI = evhttp_uriencode(walletName.c_str(), walletName.size(), false);\n+        if (encodedURI) {\n+            endpoint = \"/v1/wallet/\"+ std::string(encodedURI);\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127068584",
      "id" : 127068584,
      "original_commit_id" : "386c299270cd955aebc7984b319805ac7403e906",
      "original_position" : 13,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 49615846,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127068584",
      "user" : {
         "avatar_url" : "https://avatars5.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127068888"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127068888"
         }
      },
      "body" : " ",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-12T20:53:36Z",
      "diff_hunk" : "@@ -10,6 +10,7 @@\n #include <cstdlib>\n #include <cstring>\n #include <errno.h>\n+#include <iomanip>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127068888",
      "id" : 127068888,
      "original_commit_id" : "386c299270cd955aebc7984b319805ac7403e906",
      "original_position" : 4,
      "path" : "src/utilstrencodings.cpp",
      "position" : null,
      "pull_request_review_id" : 49615846,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127068888",
      "user" : {
         "avatar_url" : "https://avatars5.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "It'd be great to get this in for 0.15. I'm holding off on my review until @TheBlueMatt and @ryanofsky comments are addressed.\r\n\r\nIf there's anything I can do to help this be ready in time for feature freeze, let me know.",
      "created_at" : "2017-07-12T21:02:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-314896184",
      "id" : 314896184,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-12T21:02:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/314896184",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1063656?v=3",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127191606"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127191606"
         }
      },
      "body" : "In the last weeks IRC meeting I had the feeling we had consensus about splitting the calls into node non node.\r\nIMO the v1 approach (while still supporting / [v0]) gives us the chance to eventually clean up some APIs (accounts?!). Not sure if we are going to do this but at least we would have the chance.\r\nThis is why I think we should mark the V1 api as \"experimental\" and \"unstable\" which then allows us to remove/add things without caring to much about API compatibility.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T11:26:06Z",
      "diff_hunk" : "@@ -493,7 +493,12 @@ UniValue CRPCTable::execute(const JSONRPCRequest &request) const\n     const CRPCCommand *pcmd = tableRPC[request.strMethod];\n     if (!pcmd)\n         throw JSONRPCError(RPC_METHOD_NOT_FOUND, \"Method not found\");\n-\n+    if (request.URI != \"\" && request.URI != \"/\") {\n+        // enforce correct endpoint usage",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127191606",
      "id" : 127191606,
      "original_commit_id" : "b62a4bbcb160757453a95552bc27b3a6d05cc1b3",
      "original_position" : 19,
      "path" : "src/rpc/server.cpp",
      "position" : null,
      "pull_request_review_id" : 49748842,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127191606",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127195223"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127195223"
         }
      },
      "body" : "Oh,. yes. This is a relict of a custom URIencode/decode implementation. Will remove.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T11:49:05Z",
      "diff_hunk" : "@@ -10,6 +10,7 @@\n #include <cstdlib>\n #include <cstring>\n #include <errno.h>\n+#include <iomanip>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127195223",
      "id" : 127195223,
      "original_commit_id" : "386c299270cd955aebc7984b319805ac7403e906",
      "original_position" : 4,
      "path" : "src/utilstrencodings.cpp",
      "position" : null,
      "pull_request_review_id" : 49752836,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127195223",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127196983"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127196983"
         }
      },
      "body" : "a) I think we don't want an `#ifdef ENABLE_WALLE` in `httpserver.cpp`\r\nb) Using `RegisterHTTPHandler(endpoint, exactMatch, HTTPReq_JSONRPC);` from the point where we can register based on RPC-tables endpoints would result in exposing `RegisterHTTPHandler` and `HTTPReq_JSONRPC` which seems unideal.\r\n\r\nBut the idea of register based on the tables endpoints makes sense, will implement but will also keep the `RegisterJSONEndpoint` function.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T11:58:50Z",
      "diff_hunk" : "@@ -226,6 +226,11 @@ static bool InitRPCAuthentication()\n     return true;\n }\n \n+void RegisterJSONEndpoint(const std::string& endpoint, bool exactMatch)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127196983",
      "id" : 127196983,
      "original_commit_id" : "617ce96f11a988d89837a0119f1eb954f6af47a3",
      "original_position" : 4,
      "path" : "src/httprpc.cpp",
      "position" : 4,
      "pull_request_review_id" : 49754840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127196983",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127198003"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127198003"
         }
      },
      "body" : "Thread https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127191606\r\n\r\nBut why do those two commits need to be in this PR? All I am saying is move these to a separate PR. These changes aren't needed for multiwallet, add a bunch of boilerplate to the code and complexity to review, and introduce a bunch of rules and design details (even if marked \"experimental\") that have never been discussed anywhere and aren't documented at all.\r\n\r\nWe are right before the deadline for 0.15 features and trying to get some kind of multiwallet support in, which only requires support for `/v1/wallet/filename` urls which the other 10 commits in your PR implement. The 2 commits which expand the URL scheme and change the way RPC calls are dispatched should be moved to a separate PR and not rushed in before 0.15 because they greatly increase complexity of the PR and are not needed for multiwallet RPC access.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T12:04:35Z",
      "diff_hunk" : "@@ -493,7 +493,12 @@ UniValue CRPCTable::execute(const JSONRPCRequest &request) const\n     const CRPCCommand *pcmd = tableRPC[request.strMethod];\n     if (!pcmd)\n         throw JSONRPCError(RPC_METHOD_NOT_FOUND, \"Method not found\");\n-\n+    if (request.URI != \"\" && request.URI != \"/\") {\n+        // enforce correct endpoint usage",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127198003",
      "id" : 127198003,
      "original_commit_id" : "b62a4bbcb160757453a95552bc27b3a6d05cc1b3",
      "original_position" : 19,
      "path" : "src/rpc/server.cpp",
      "position" : null,
      "pull_request_review_id" : 49755955,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127198003",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127201118"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127201118"
         }
      },
      "body" : "They are in this PR because I thought we have decided to not support node command on `/v1/wallet`.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T12:23:24Z",
      "diff_hunk" : "@@ -493,7 +493,12 @@ UniValue CRPCTable::execute(const JSONRPCRequest &request) const\n     const CRPCCommand *pcmd = tableRPC[request.strMethod];\n     if (!pcmd)\n         throw JSONRPCError(RPC_METHOD_NOT_FOUND, \"Method not found\");\n-\n+    if (request.URI != \"\" && request.URI != \"/\") {\n+        // enforce correct endpoint usage",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127201118",
      "id" : 127201118,
      "original_commit_id" : "b62a4bbcb160757453a95552bc27b3a6d05cc1b3",
      "original_position" : 19,
      "path" : "src/rpc/server.cpp",
      "position" : null,
      "pull_request_review_id" : 49759739,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127201118",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127203928"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127203928"
         }
      },
      "body" : "Thread https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127191606\r\n\r\n> They are in this PR because I thought we have decided to not support node command on /v1/wallet.\r\n\r\nInteresting. So will wallet-optional methods like validateaddress and createmultisig then only work on vpwallet[0] and not other wallets?\r\n\r\nIn any case, I am trying to suggest that you can significantly simplify this PR and focus it to the task at hand (adding multiwallet RPC support) by not doing this.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T12:37:20Z",
      "diff_hunk" : "@@ -493,7 +493,12 @@ UniValue CRPCTable::execute(const JSONRPCRequest &request) const\n     const CRPCCommand *pcmd = tableRPC[request.strMethod];\n     if (!pcmd)\n         throw JSONRPCError(RPC_METHOD_NOT_FOUND, \"Method not found\");\n-\n+    if (request.URI != \"\" && request.URI != \"/\") {\n+        // enforce correct endpoint usage",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127203928",
      "id" : 127203928,
      "original_commit_id" : "b62a4bbcb160757453a95552bc27b3a6d05cc1b3",
      "original_position" : 19,
      "path" : "src/rpc/server.cpp",
      "position" : null,
      "pull_request_review_id" : 49762944,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127203928",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "body" : "I just want to point out again that while I am fine with adding support for multiwallet RPC calls via URL endpoints, we do have a vastly simpler alternative available which in my opinion (still) it would be better to roll out first: multiwallet RPC access via named argument https://github.com/bitcoin/bitcoin/compare/master...ryanofsky:pr/multiparam.\r\n\r\nDisadvantages of https://github.com/bitcoin/bitcoin/compare/master...ryanofsky:pr/multiparam:\r\n\r\n- No support for positional arguments. Requires use of named JSONRPC parameters to access multiple wallets.\r\n- Adds a few lines of wallet-specific code to src/rpc/server.cpp.\r\n- Change will be unnecessary in the future if wallet RPC handling is moved to separate processes (https://github.com/bitcoin/bitcoin/pull/10653#issuecomment-311532389), though this criticism applies to all current changes implementing multiwallet RPC support, including the changes in this PR.\r\n\r\nAdvantages of https://github.com/bitcoin/bitcoin/compare/master...ryanofsky:pr/multiparam \r\n- Extremely simple implementation.\r\n- Does not require any changes to bitcoin-cli, python test framework, or any other JSON-RPC client that already supports named arguments.\r\n- Compatible with all future new URL schemes, **including the one implemented in this PR**.\r\n- Has test, documentation, and is ready for review and merge into 0.15.0. Unlike this PR, the multiwallet RPC interface is actually documented in `bitcoin-cli -help` and in RPC `help` method output`.\r\n\r\n",
      "created_at" : "2017-07-13T12:43:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315066331",
      "id" : 315066331,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-13T12:49:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315066331",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127207869"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127207869"
         }
      },
      "body" : "Thread https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126926410\r\n\r\nSilently ignoring invalid requestedWallet values not (yet) addressed.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T12:56:01Z",
      "diff_hunk" : "@@ -36,8 +36,26 @@ static const std::string WALLET_ENDPOINT_BASE = \"/v1/wallet/\";\n \n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    // TODO: Some way to access secondary wallets\n-    return vpwallets.empty() ? nullptr : vpwallets[0];\n+    LOCK(cs_main); // for now, protect vpwallets via cs_main\n+\n+    if (vpwallets.empty()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127207869",
      "id" : 127207869,
      "original_commit_id" : "0e7d0c129abfca17ecaa48b8d8b2c39ec8a7f903",
      "original_position" : 8,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 49767454,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127207869",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127208085"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127208085"
         }
      },
      "body" : "Thread https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126968651\r\n\r\nAdding percent decoding not (yet) addressed.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T12:56:56Z",
      "diff_hunk" : "@@ -36,8 +36,26 @@ static const std::string WALLET_ENDPOINT_BASE = \"/v1/wallet/\";\n \n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    // TODO: Some way to access secondary wallets\n-    return vpwallets.empty() ? nullptr : vpwallets[0];\n+    LOCK(cs_main); // for now, protect vpwallets via cs_main\n+\n+    if (vpwallets.empty()) {\n+        return nullptr;\n+    }\n+    else if (request.URI.substr(0, WALLET_ENDPOINT_BASE.size()) == WALLET_ENDPOINT_BASE) {\n+        // wallet endpoint was used\n+        std::string requestedWallet = request.URI.substr(WALLET_ENDPOINT_BASE.size());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127208085",
      "id" : 127208085,
      "original_commit_id" : "0e7d0c129abfca17ecaa48b8d8b2c39ec8a7f903",
      "original_position" : 13,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 49767454,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127208085",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127208287"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127208287"
         }
      },
      "body" : "Thread https://github.com/bitcoin/bitcoin/pull/10650#discussion_r123543935\r\n\r\nError string cleanup not (yet) addressed.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T12:57:53Z",
      "diff_hunk" : "@@ -31,10 +31,30 @@\n \n #include <univalue.h>\n \n+static const std::string WALLET_ENDPOINT_BASE = \"/wallet/\";\n+\n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    // TODO: Some way to access secondary wallets\n-    return vpwallets.empty() ? nullptr : vpwallets[0];\n+    LOCK(cs_main); // for now, protect vpwallets via cs_main\n+\n+    if (vpwallets.empty()) {\n+        return nullptr;\n+    }\n+    else if (request.URI.substr(0, WALLET_ENDPOINT_BASE.size()) == WALLET_ENDPOINT_BASE) {\n+        // wallet endpoint was used\n+        std::string requestedWallet = request.URI.substr(WALLET_ENDPOINT_BASE.size());\n+        for(CWallet* pwallet : vpwallets) {\n+            if (pwallet->GetWalletID() == requestedWallet) {\n+                return pwallet;\n+            }\n+        }\n+        // no wallet found with the given endpoint\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Requested wallet not found (\"+SanitizeString(requestedWallet)+\")\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127208287",
      "id" : 127208287,
      "original_commit_id" : "1fa7d7e26b5056c66fabd1bec12c208f4dc963c8",
      "original_position" : 24,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 49767454,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127208287",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127208704"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127208704"
         }
      },
      "body" : "Thread https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126928365\r\n\r\nUnsafe fallthrough to default wallet not (yet) addressed.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T12:59:37Z",
      "diff_hunk" : "@@ -36,8 +36,26 @@ static const std::string WALLET_ENDPOINT_BASE = \"/v1/wallet/\";\n \n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    // TODO: Some way to access secondary wallets\n-    return vpwallets.empty() ? nullptr : vpwallets[0];\n+    LOCK(cs_main); // for now, protect vpwallets via cs_main\n+\n+    if (vpwallets.empty()) {\n+        return nullptr;\n+    }\n+    else if (request.URI.substr(0, WALLET_ENDPOINT_BASE.size()) == WALLET_ENDPOINT_BASE) {\n+        // wallet endpoint was used\n+        std::string requestedWallet = request.URI.substr(WALLET_ENDPOINT_BASE.size());\n+        for(CWallet* pwallet : vpwallets) {\n+            if (pwallet->GetWalletID() == requestedWallet) {\n+                return pwallet;\n+            }\n+        }\n+        // no wallet found with the given endpoint\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Requested wallet not found (\"+SanitizeString(requestedWallet)+\")\");\n+    }\n+    else {\n+        // default endpoint, use first wallet\n+        return vpwallets[0];",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127208704",
      "id" : 127208704,
      "original_commit_id" : "0e7d0c129abfca17ecaa48b8d8b2c39ec8a7f903",
      "original_position" : 24,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 49767454,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127208704",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127209376"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127209376"
         }
      },
      "body" : "In commit \"Add urlencode/decode via libevent2\"\r\n\r\nCommit description should be updated to reflect that this is adding a new option to bitcoin-cl. Or maybe this commit should solely update bitcoin-cli, and the urldecode should be moved to the \"Select wallet based on the given endpoint\" commit.\r\n\r\nAlso the new bitcoin-cli option needs to be documented, see https://github.com/bitcoin/bitcoin/pull/10650#discussion_r123489861",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T13:02:40Z",
      "diff_hunk" : "@@ -235,7 +235,21 @@ UniValue CallRPC(const std::string& strMethod, const UniValue& params)\n     assert(output_buffer);\n     evbuffer_add(output_buffer, strRequest.data(), strRequest.size());\n \n-    int r = evhttp_make_request(evcon.get(), req.get(), EVHTTP_REQ_POST, \"/\");\n+    // check if we should use a special wallet endpoint\n+    std::string endpoint = \"/\";\n+    std::string walletName = GetArg(\"-wallet\", \"\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127209376",
      "id" : 127209376,
      "original_commit_id" : "26c259d0885ce7457602d947d78838dc02c06dec",
      "original_position" : 7,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 49767454,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127209376",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127209852"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127209852"
         }
      },
      "body" : "Thread https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126976236\r\n\r\nTest framework comment not (yet) addressed.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T13:04:46Z",
      "diff_hunk" : "@@ -139,17 +139,24 @@ def _request(self, method, path, postdata):\n             return self._get_response()\n \n     def __call__(self, *args, **argsn):\n-        AuthServiceProxy.__id_count += 1\n+        # check for a possible wallet endpoint\n+        urlAdd = \"\"\n+        method = self._service_name\n+        elements = self._service_name.split(\".\")\n+        if len(elements) > 1:\n+            urlAdd = \"/v1/wallet/\" + '.'.join(elements[:-1])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127209852",
      "id" : 127209852,
      "original_commit_id" : "72fee26bc417aebe6c5d59c3ea975f630920d0a1",
      "original_position" : 10,
      "path" : "test/functional/test_framework/authproxy.py",
      "position" : null,
      "pull_request_review_id" : 49767454,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127209852",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127213593"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127213593"
         }
      },
      "body" : "I think this actually should use `__truediv__` not `__idiv__`,\r\n which is for python 2.x (https://docs.python.org/3/reference/datamodel.html?highlight=truediv#object.__truediv__)",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T13:20:18Z",
      "diff_hunk" : "@@ -139,17 +139,24 @@ def _request(self, method, path, postdata):\n             return self._get_response()\n \n     def __call__(self, *args, **argsn):\n-        AuthServiceProxy.__id_count += 1\n+        # check for a possible wallet endpoint\n+        urlAdd = \"\"\n+        method = self._service_name\n+        elements = self._service_name.split(\".\")\n+        if len(elements) > 1:\n+            urlAdd = \"/wallet/\" + '.'.join(elements[:-1])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127213593",
      "id" : 127213593,
      "original_commit_id" : "8775248d0699f433c983fb986d86186ff1cab94f",
      "original_position" : 10,
      "path" : "test/functional/test_framework/authproxy.py",
      "position" : null,
      "pull_request_review_id" : 49774049,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127213593",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127217666"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127217666"
         }
      },
      "body" : "I agree - we should try to make minimal changes to authproxy.\r\n\r\nLater, once TestNode is merged, it'll be very straightforward to add wallet methods to the TestNode class, which is where I think they should live - not in the authproxy layer.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T13:35:50Z",
      "diff_hunk" : "@@ -139,17 +139,24 @@ def _request(self, method, path, postdata):\n             return self._get_response()\n \n     def __call__(self, *args, **argsn):\n-        AuthServiceProxy.__id_count += 1\n+        # check for a possible wallet endpoint\n+        urlAdd = \"\"\n+        method = self._service_name\n+        elements = self._service_name.split(\".\")\n+        if len(elements) > 1:\n+            urlAdd = \"/wallet/\" + '.'.join(elements[:-1])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127217666",
      "id" : 127217666,
      "original_commit_id" : "8775248d0699f433c983fb986d86186ff1cab94f",
      "original_position" : 10,
      "path" : "test/functional/test_framework/authproxy.py",
      "position" : null,
      "pull_request_review_id" : 49778721,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127217666",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127227774"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127227774"
         }
      },
      "body" : "For what it's worth, I agree with @ryanofsky here. It'd be good to keep this PR to the minimal functionality needed for RPC multiwallet access. We can easily add `/v1/node` later if people want it.\r\n\r\n> will wallet-optional methods like validateaddress and createmultisig...\r\n\r\nHopefully those will all be split into wallet/non-wallet methods by 0.16. See #10583, #10570, etc",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T14:11:33Z",
      "diff_hunk" : "@@ -493,7 +493,12 @@ UniValue CRPCTable::execute(const JSONRPCRequest &request) const\n     const CRPCCommand *pcmd = tableRPC[request.strMethod];\n     if (!pcmd)\n         throw JSONRPCError(RPC_METHOD_NOT_FOUND, \"Method not found\");\n-\n+    if (request.URI != \"\" && request.URI != \"/\") {\n+        // enforce correct endpoint usage",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127227774",
      "id" : 127227774,
      "original_commit_id" : "b62a4bbcb160757453a95552bc27b3a6d05cc1b3",
      "original_position" : 19,
      "path" : "src/rpc/server.cpp",
      "position" : null,
      "pull_request_review_id" : 49790115,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127227774",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127250167"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127250167"
         }
      },
      "body" : "I'm not sure about that one.\r\nThe GUI also has a default wallet. Wouldn't throwing an exception also not work when someone runs with `-disablewallet`?",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T15:28:35Z",
      "diff_hunk" : "@@ -36,8 +36,26 @@ static const std::string WALLET_ENDPOINT_BASE = \"/v1/wallet/\";\n \n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    // TODO: Some way to access secondary wallets\n-    return vpwallets.empty() ? nullptr : vpwallets[0];\n+    LOCK(cs_main); // for now, protect vpwallets via cs_main\n+\n+    if (vpwallets.empty()) {\n+        return nullptr;\n+    }\n+    else if (request.URI.substr(0, WALLET_ENDPOINT_BASE.size()) == WALLET_ENDPOINT_BASE) {\n+        // wallet endpoint was used\n+        std::string requestedWallet = request.URI.substr(WALLET_ENDPOINT_BASE.size());\n+        for(CWallet* pwallet : vpwallets) {\n+            if (pwallet->GetWalletID() == requestedWallet) {\n+                return pwallet;\n+            }\n+        }\n+        // no wallet found with the given endpoint\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Requested wallet not found (\"+SanitizeString(requestedWallet)+\")\");\n+    }\n+    else {\n+        // default endpoint, use first wallet\n+        return vpwallets[0];",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127250167",
      "id" : 127250167,
      "original_commit_id" : "0e7d0c129abfca17ecaa48b8d8b2c39ec8a7f903",
      "original_position" : 24,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 49815722,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127250167",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127253273"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127253273"
         }
      },
      "body" : "Thread https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126928365\r\n\r\nI think you could change this line to something like `return vpwallets.size() == 1 ? vpwallets[0] : nullptr;` without bad side effects for the gui or disablewallet. This would also let you drop the early return for vpwallet.empty() above, which would make sure the `requestedWallet` value is always properly validated (https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126926410).",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T15:40:23Z",
      "diff_hunk" : "@@ -36,8 +36,26 @@ static const std::string WALLET_ENDPOINT_BASE = \"/v1/wallet/\";\n \n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    // TODO: Some way to access secondary wallets\n-    return vpwallets.empty() ? nullptr : vpwallets[0];\n+    LOCK(cs_main); // for now, protect vpwallets via cs_main\n+\n+    if (vpwallets.empty()) {\n+        return nullptr;\n+    }\n+    else if (request.URI.substr(0, WALLET_ENDPOINT_BASE.size()) == WALLET_ENDPOINT_BASE) {\n+        // wallet endpoint was used\n+        std::string requestedWallet = request.URI.substr(WALLET_ENDPOINT_BASE.size());\n+        for(CWallet* pwallet : vpwallets) {\n+            if (pwallet->GetWalletID() == requestedWallet) {\n+                return pwallet;\n+            }\n+        }\n+        // no wallet found with the given endpoint\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Requested wallet not found (\"+SanitizeString(requestedWallet)+\")\");\n+    }\n+    else {\n+        // default endpoint, use first wallet\n+        return vpwallets[0];",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127253273",
      "id" : 127253273,
      "original_commit_id" : "0e7d0c129abfca17ecaa48b8d8b2c39ec8a7f903",
      "original_position" : 24,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 49819242,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127253273",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "body" : "Rebased and tried to address ~~nits~~points.\r\nAdded @jnewbery's AuthProxy approach.",
      "created_at" : "2017-07-13T15:58:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315122371",
      "id" : 315122371,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-13T15:58:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315122371",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127261546"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127261546"
         }
      },
      "body" : "This is still not addressed. If you're going to add extra options to bitcoin-cli, please also update the help text.\r\n\r\nStrongly recommend this change goes in its own commit.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T16:12:23Z",
      "diff_hunk" : "@@ -235,7 +235,21 @@ UniValue CallRPC(const std::string& strMethod, const UniValue& params)\n     assert(output_buffer);\n     evbuffer_add(output_buffer, strRequest.data(), strRequest.size());\n \n-    int r = evhttp_make_request(evcon.get(), req.get(), EVHTTP_REQ_POST, \"/\");\n+    // check if we should use a special wallet endpoint\n+    std::string endpoint = \"/\";\n+    std::string walletName = GetArg(\"-wallet\", \"\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127261546",
      "id" : 127261546,
      "original_commit_id" : "26c259d0885ce7457602d947d78838dc02c06dec",
      "original_position" : 7,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 49828741,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127261546",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127261594"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127261594"
         }
      },
      "body" : "In commit \"Split node / wallet RPC calls based on the endpoint\"\r\n\r\nWhy the first check? I don't think requesting an empty URI is possible over HTTP. Definitely add a comment if this is needed for something.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T16:12:35Z",
      "diff_hunk" : "@@ -493,7 +497,12 @@ UniValue CRPCTable::execute(const JSONRPCRequest &request) const\n     const CRPCCommand *pcmd = tableRPC[request.strMethod];\n     if (!pcmd)\n         throw JSONRPCError(RPC_METHOD_NOT_FOUND, \"Method not found\");\n-\n+    if (request.URI != \"\" && request.URI != \"/\") {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127261594",
      "id" : 127261594,
      "original_commit_id" : "37258d6bf3856218343e98b2c858c1f394b65fb0",
      "original_position" : 36,
      "path" : "src/rpc/server.cpp",
      "position" : null,
      "pull_request_review_id" : 49828793,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127261594",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127263779"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127263779"
         }
      },
      "body" : "Please see @ryanofsky's previous comment: https://github.com/bitcoin/bitcoin/pull/10650#discussion_r126928365\r\n\r\nReturning a 'default' wallet is dangerous for users. If there is more than one wallet loaded and the RPC does not specify a wallet endpoint, then the call should fail.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T16:21:07Z",
      "diff_hunk" : "@@ -30,10 +31,27 @@\n \n #include <univalue.h>\n \n+static const std::string WALLET_ENDPOINT_BASE = \"/v1/wallet/\";\n+\n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    // TODO: Some way to access secondary wallets\n-    return vpwallets.empty() ? nullptr : vpwallets[0];\n+    LOCK(cs_main); // for now, protect vpwallets via cs_main\n+\n+    if (request.URI.substr(0, WALLET_ENDPOINT_BASE.size()) == WALLET_ENDPOINT_BASE) {\n+        // wallet endpoint was used\n+        std::string requestedWallet = urlDecode(request.URI.substr(WALLET_ENDPOINT_BASE.size()));\n+        for(CWallet* pwallet : vpwallets) {\n+            if (pwallet->GetName() == requestedWallet) {\n+                return pwallet;\n+            }\n+        }\n+        // no wallet found with the given endpoint\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet file does not exist or is not loaded\");\n+    }\n+    else {\n+        // default endpoint, use first wallet if possible\n+        return vpwallets.empty() ? nullptr : vpwallets[0];",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127263779",
      "id" : 127263779,
      "original_commit_id" : "37258d6bf3856218343e98b2c858c1f394b65fb0",
      "original_position" : 33,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 49831199,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127263779",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127264161"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127264161"
         }
      },
      "body" : "In commit \"Select wallet based on the given endpoint\"\r\n\r\nWould be good to either expand comment, or have it reference an issue, or just drop this locking statement because it isn't needed yet and isn't used in any other places where vpwallets is accessed.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T16:22:35Z",
      "diff_hunk" : "@@ -30,10 +31,27 @@\n \n #include <univalue.h>\n \n+static const std::string WALLET_ENDPOINT_BASE = \"/v1/wallet/\";\n+\n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    // TODO: Some way to access secondary wallets\n-    return vpwallets.empty() ? nullptr : vpwallets[0];\n+    LOCK(cs_main); // for now, protect vpwallets via cs_main",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127264161",
      "id" : 127264161,
      "original_commit_id" : "37258d6bf3856218343e98b2c858c1f394b65fb0",
      "original_position" : 18,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 49828793,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127264161",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127264291"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127264291"
         }
      },
      "body" : "In commit \"Select wallet based on the given endpoint\"\r\n\r\nMaybe use Luke's `CWalletRef` syntax to be consistent & portable.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T16:23:04Z",
      "diff_hunk" : "@@ -30,10 +31,27 @@\n \n #include <univalue.h>\n \n+static const std::string WALLET_ENDPOINT_BASE = \"/v1/wallet/\";\n+\n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    // TODO: Some way to access secondary wallets\n-    return vpwallets.empty() ? nullptr : vpwallets[0];\n+    LOCK(cs_main); // for now, protect vpwallets via cs_main\n+\n+    if (request.URI.substr(0, WALLET_ENDPOINT_BASE.size()) == WALLET_ENDPOINT_BASE) {\n+        // wallet endpoint was used\n+        std::string requestedWallet = urlDecode(request.URI.substr(WALLET_ENDPOINT_BASE.size()));\n+        for(CWallet* pwallet : vpwallets) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127264291",
      "id" : 127264291,
      "original_commit_id" : "37258d6bf3856218343e98b2c858c1f394b65fb0",
      "original_position" : 23,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 49828793,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127264291",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127264334"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127264334"
         }
      },
      "body" : "In commit 'Fix AuthProxy multiwallet support'.\r\n\r\nI think using / \"path is slightly better since it's consistent with the Python path API, as @ryanofsky mentioned in IRC, but I don't care too strongly.\r\n\r\nIf you do chose to make this change, please squash with the previous commit.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T16:23:17Z",
      "diff_hunk" : "@@ -191,3 +191,6 @@ def _get_response(self):\n         else:\n             log.debug(\"<-- [%.6f] %s\"%(elapsed,responsedata))\n         return response\n+\n+    def __truediv__(self, relative_uri):\n+        return AuthServiceProxy(\"{}{}\".format(self.__service_url, relative_uri), self._service_name, connection=self.__conn)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127264334",
      "id" : 127264334,
      "original_commit_id" : "37258d6bf3856218343e98b2c858c1f394b65fb0",
      "original_position" : 6,
      "path" : "test/functional/test_framework/authproxy.py",
      "position" : null,
      "pull_request_review_id" : 49831782,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127264334",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127264802"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127264802"
         }
      },
      "body" : "the `w3` assignment is wrong, and this line doesn't appear to be testing anything",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T16:25:08Z",
      "diff_hunk" : "@@ -0,0 +1,51 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the wallet.\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import *\n+\n+class MultiWalletTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+        self.extra_args = [['-wallet=w1', '-wallet=w2','-wallet=w3']]\n+\n+    def setup_network(self):\n+        self.nodes = self.start_nodes(1, self.options.tmpdir, self.extra_args[:1])\n+\n+    def run_test(self):\n+        self.nodes[0].generate(1)\n+\n+        #check default wallet balance\n+        walletinfo = self.nodes[0].getwalletinfo()\n+        assert_equal(walletinfo['immature_balance'], 50)\n+\n+        #check w1 wallet balance\n+        w1 = self.nodes[0] / \"/v1/wallet/w1\"\n+        walletinfo = w1.getwalletinfo()\n+        assert_equal(walletinfo['immature_balance'], 50)\n+\n+        #check w1 wallet balance\n+        w2 = self.nodes[0] / \"/v1/wallet/w2\"\n+        walletinfo = w2.getwalletinfo()\n+        assert_equal(walletinfo['immature_balance'], 0)\n+\n+        w3 = self.nodes[0] / \"/v1/wallet/w2\"\n+        walletinfo = w2.getwalletinfo()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127264802",
      "id" : 127264802,
      "original_commit_id" : "37258d6bf3856218343e98b2c858c1f394b65fb0",
      "original_position" : 38,
      "path" : "test/functional/multiwallet.py",
      "position" : null,
      "pull_request_review_id" : 49832301,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127264802",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127266534"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127266534"
         }
      },
      "body" : "Fixed.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T16:32:03Z",
      "diff_hunk" : "@@ -0,0 +1,51 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the wallet.\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import *\n+\n+class MultiWalletTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+        self.extra_args = [['-wallet=w1', '-wallet=w2','-wallet=w3']]\n+\n+    def setup_network(self):\n+        self.nodes = self.start_nodes(1, self.options.tmpdir, self.extra_args[:1])\n+\n+    def run_test(self):\n+        self.nodes[0].generate(1)\n+\n+        #check default wallet balance\n+        walletinfo = self.nodes[0].getwalletinfo()\n+        assert_equal(walletinfo['immature_balance'], 50)\n+\n+        #check w1 wallet balance\n+        w1 = self.nodes[0] / \"/v1/wallet/w1\"\n+        walletinfo = w1.getwalletinfo()\n+        assert_equal(walletinfo['immature_balance'], 50)\n+\n+        #check w1 wallet balance\n+        w2 = self.nodes[0] / \"/v1/wallet/w2\"\n+        walletinfo = w2.getwalletinfo()\n+        assert_equal(walletinfo['immature_balance'], 0)\n+\n+        w3 = self.nodes[0] / \"/v1/wallet/w2\"\n+        walletinfo = w2.getwalletinfo()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127266534",
      "id" : 127266534,
      "original_commit_id" : "37258d6bf3856218343e98b2c858c1f394b65fb0",
      "original_position" : 38,
      "path" : "test/functional/multiwallet.py",
      "position" : null,
      "pull_request_review_id" : 49834168,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127266534",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127266614"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127266614"
         }
      },
      "body" : "`generate` is a wallet call, so should specify a wallet endpoint.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T16:32:22Z",
      "diff_hunk" : "@@ -0,0 +1,51 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the wallet.\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import *\n+\n+class MultiWalletTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+        self.extra_args = [['-wallet=w1', '-wallet=w2','-wallet=w3']]\n+\n+    def setup_network(self):\n+        self.nodes = self.start_nodes(1, self.options.tmpdir, self.extra_args[:1])\n+\n+    def run_test(self):\n+        self.nodes[0].generate(1)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127266614",
      "id" : 127266614,
      "original_commit_id" : "37258d6bf3856218343e98b2c858c1f394b65fb0",
      "original_position" : 21,
      "path" : "test/functional/multiwallet.py",
      "position" : null,
      "pull_request_review_id" : 49834248,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127266614",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "Also added the bitcoin-cli help string for `-wallet`.",
      "created_at" : "2017-07-13T16:33:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315132140",
      "id" : 315132140,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-13T16:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315132140",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127267171"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127267171"
         }
      },
      "body" : "it's a bit strange that the `help` RPC returns help for non-wallet commands when called on a wallet endpoint",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T16:34:28Z",
      "diff_hunk" : "@@ -280,9 +281,9 @@ static const CRPCCommand vRPCCommands[] =\n { //  category              name                      actor (function)         okSafe argNames\n   //  --------------------- ------------------------  -----------------------  ------ ----------\n     /* Overall control/query calls */\n-    { \"control\",            \"help\",                   &help,                   true,  {\"command\"}  },\n-    { \"control\",            \"stop\",                   &stop,                   true,  {}  },\n-    { \"control\",            \"uptime\",                 &uptime,                 true,  {}  },\n+    { \"control\",            \"/v1/*\"    , \"help\",                   &help,                   true,  {\"command\"}  },",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127267171",
      "id" : 127267171,
      "original_commit_id" : "37258d6bf3856218343e98b2c858c1f394b65fb0",
      "original_position" : 15,
      "path" : "src/rpc/server.cpp",
      "position" : 15,
      "pull_request_review_id" : 49834810,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127267171",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127267192"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127267192"
         }
      },
      "body" : "Fixed.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T16:34:34Z",
      "diff_hunk" : "@@ -0,0 +1,51 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the wallet.\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import *\n+\n+class MultiWalletTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+        self.extra_args = [['-wallet=w1', '-wallet=w2','-wallet=w3']]\n+\n+    def setup_network(self):\n+        self.nodes = self.start_nodes(1, self.options.tmpdir, self.extra_args[:1])\n+\n+    def run_test(self):\n+        self.nodes[0].generate(1)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127267192",
      "id" : 127267192,
      "original_commit_id" : "37258d6bf3856218343e98b2c858c1f394b65fb0",
      "original_position" : 21,
      "path" : "test/functional/multiwallet.py",
      "position" : null,
      "pull_request_review_id" : 49834833,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127267192",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127269863"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127269863"
         }
      },
      "body" : "In commit \"Split node / wallet RPC calls based on the endpoint\"\r\n\r\n@morcos pointed out that the endpoints get added to a vector (`std::vector<HTTPPathHandler> pathHandlers`) which will now contain the same handlers dozens of times. Should consider converting `pathHandlers` to a map or set to avoid this, or adding a todo comment to address it later.\r\n",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T16:46:04Z",
      "diff_hunk" : "@@ -310,6 +311,9 @@ bool CRPCTable::appendCommand(const std::string& name, const CRPCCommand* pcmd)\n     if (IsRPCRunning())\n         return false;\n \n+    // make sure we register the command endpoint\n+    RegisterJSONEndpoint(pcmd->endpoint, false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127269863",
      "id" : 127269863,
      "original_commit_id" : "37258d6bf3856218343e98b2c858c1f394b65fb0",
      "original_position" : 26,
      "path" : "src/rpc/server.cpp",
      "position" : 26,
      "pull_request_review_id" : 49828793,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127269863",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127271400"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127271400"
         }
      },
      "body" : "nit: This seems pretty inefficient since so many of the commands have the same endpoint, they'll be registered over and over.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T16:52:59Z",
      "diff_hunk" : "@@ -310,6 +311,9 @@ bool CRPCTable::appendCommand(const std::string& name, const CRPCCommand* pcmd)\n     if (IsRPCRunning())\n         return false;\n \n+    // make sure we register the command endpoint\n+    RegisterJSONEndpoint(pcmd->endpoint, false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127271400",
      "id" : 127271400,
      "original_commit_id" : "acdd224718ca44f52193061825b3093be4fc8676",
      "original_position" : 26,
      "path" : "src/rpc/server.cpp",
      "position" : 26,
      "pull_request_review_id" : 49839643,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127271400",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/4360349?v=4",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127272854"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127272854"
         }
      },
      "body" : "Until wallet and server RPCs are fully separated, the following RPCs should also allow wildcard endpoints:\r\n\r\n- `validateaddress`\r\n- `createmultisig`\r\n\r\nWe can leave `getinfo` since it's deprecated.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T16:59:09Z",
      "diff_hunk" : "@@ -898,17 +898,17 @@ UniValue sendrawtransaction(const JSONRPCRequest& request)\n }\n \n static const CRPCCommand commands[] =\n-{ //  category              name                      actor (function)         okSafeMode\n-  //  --------------------- ------------------------  -----------------------  ----------\n-    { \"rawtransactions\",    \"getrawtransaction\",      &getrawtransaction,      true,  {\"txid\",\"verbose\"} },\n-    { \"rawtransactions\",    \"createrawtransaction\",   &createrawtransaction,   true,  {\"inputs\",\"outputs\",\"locktime\",\"replaceable\"} },\n-    { \"rawtransactions\",    \"decoderawtransaction\",   &decoderawtransaction,   true,  {\"hexstring\"} },\n-    { \"rawtransactions\",    \"decodescript\",           &decodescript,           true,  {\"hexstring\"} },\n-    { \"rawtransactions\",    \"sendrawtransaction\",     &sendrawtransaction,     false, {\"hexstring\",\"allowhighfees\"} },\n-    { \"rawtransactions\",    \"signrawtransaction\",     &signrawtransaction,     false, {\"hexstring\",\"prevtxs\",\"privkeys\",\"sighashtype\"} }, /* uses wallet if enabled */\n-\n-    { \"blockchain\",         \"gettxoutproof\",          &gettxoutproof,          true,  {\"txids\", \"blockhash\"} },\n-    { \"blockchain\",         \"verifytxoutproof\",       &verifytxoutproof,       true,  {\"proof\"} },\n+{ //  category              endpoint      name                      actor (function)         okSafeMode  named args\n+  //  ------------------    ------------  ----------------------    -----------------------  ----------  ------------------\n+    { \"rawtransactions\",    \"/v1/node/\",  \"getrawtransaction\",      &getrawtransaction,      true,       {\"txid\",\"verbose\"} },\n+    { \"rawtransactions\",    \"/v1/node/\",  \"createrawtransaction\",   &createrawtransaction,   true,       {\"inputs\",\"outputs\",\"locktime\",\"replaceable\"} },\n+    { \"rawtransactions\",    \"/v1/node/\",  \"decoderawtransaction\",   &decoderawtransaction,   true,       {\"hexstring\"} },\n+    { \"rawtransactions\",    \"/v1/node/\",  \"decodescript\",           &decodescript,           true,       {\"hexstring\"} },\n+    { \"rawtransactions\",    \"/v1/node/\",  \"sendrawtransaction\",     &sendrawtransaction,     false,      {\"hexstring\",\"allowhighfees\"} },\n+    { \"rawtransactions\",    \"/v1/*\",      \"signrawtransaction\",     &signrawtransaction,     false,      {\"hexstring\",\"prevtxs\",\"privkeys\",\"sighashtype\"} }, /* uses wallet if enabled */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127272854",
      "id" : 127272854,
      "original_commit_id" : "37258d6bf3856218343e98b2c858c1f394b65fb0",
      "original_position" : 22,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 22,
      "pull_request_review_id" : 49841277,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127272854",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127272920"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127272920"
         }
      },
      "body" : "nit: Could be more descriptive",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T16:59:22Z",
      "diff_hunk" : "@@ -46,6 +46,7 @@ std::string HelpMessageCli()\n     strUsage += HelpMessageOpt(\"-rpcpassword=<pw>\", _(\"Password for JSON-RPC connections\"));\n     strUsage += HelpMessageOpt(\"-rpcclienttimeout=<n>\", strprintf(_(\"Timeout in seconds during HTTP requests, or 0 for no timeout. (default: %d)\"), DEFAULT_HTTP_CLIENT_TIMEOUT));\n     strUsage += HelpMessageOpt(\"-stdin\", _(\"Read extra arguments from standard input, one per line until EOF/Ctrl-D (recommended for sensitive information such as passphrases)\"));\n+    strUsage += HelpMessageOpt(\"-wallet=<walletname>\", _(\"Use wallet endpoint for given <walletname>\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127272920",
      "id" : 127272920,
      "original_commit_id" : "619a298759dbb0cb92f03e49e07de95c9301d8dd",
      "original_position" : 4,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 49839643,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127272920",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/4360349?v=4",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127273014"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127273014"
         }
      },
      "body" : "Thread https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127191606\r\n\r\nI'm not going to keep objecting, but will just note that I'd still prefer to see this commit (\"Split node / wallet RPC calls based on the endpoint\") dropped from the PR because of the complexity it adds. (Also because of my general failure to understand why people seem to want to overlay a REST-style url scheme on top of an RPC-style API, https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315066331.)",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T16:59:39Z",
      "diff_hunk" : "@@ -493,7 +493,12 @@ UniValue CRPCTable::execute(const JSONRPCRequest &request) const\n     const CRPCCommand *pcmd = tableRPC[request.strMethod];\n     if (!pcmd)\n         throw JSONRPCError(RPC_METHOD_NOT_FOUND, \"Method not found\");\n-\n+    if (request.URI != \"\" && request.URI != \"/\") {\n+        // enforce correct endpoint usage",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127273014",
      "id" : 127273014,
      "original_commit_id" : "b62a4bbcb160757453a95552bc27b3a6d05cc1b3",
      "original_position" : 19,
      "path" : "src/rpc/server.cpp",
      "position" : null,
      "pull_request_review_id" : 49828793,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127273014",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127274387"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127274387"
         }
      },
      "body" : "`urlEncode` doesn't exist.  I think if you just squashed 6a99141 (the following commit) into this one, you'd be ok.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T17:05:15Z",
      "diff_hunk" : "@@ -235,7 +236,13 @@ UniValue CallRPC(const std::string& strMethod, const UniValue& params)\n     assert(output_buffer);\n     evbuffer_add(output_buffer, strRequest.data(), strRequest.size());\n \n-    int r = evhttp_make_request(evcon.get(), req.get(), EVHTTP_REQ_POST, \"/\");\n+    // check if we should use a special wallet endpoint\n+    std::string endpoint = \"/\";\n+    if (GetArg(\"-wallet\", \"\") != \"\") {\n+        // always use v1 endpoint if -wallet has been provided\n+        endpoint = \"/v1/wallet/\"+urlEncode(GetArg(\"-wallet\", \"\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127274387",
      "id" : 127274387,
      "original_commit_id" : "619a298759dbb0cb92f03e49e07de95c9301d8dd",
      "original_position" : 17,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 49839643,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127274387",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/4360349?v=4",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127274408"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127274408"
         }
      },
      "body" : "In commit \"Add -wallet endpoint support to bitcoin-cli\"\r\n\r\nThis doesn't compile because urlEncode function isn't defined. You should fix by moving bitcoin-cli changes from \"Add urlencode/decode via libevent2\" commit to this commit.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T17:05:22Z",
      "diff_hunk" : "@@ -235,7 +236,13 @@ UniValue CallRPC(const std::string& strMethod, const UniValue& params)\n     assert(output_buffer);\n     evbuffer_add(output_buffer, strRequest.data(), strRequest.size());\n \n-    int r = evhttp_make_request(evcon.get(), req.get(), EVHTTP_REQ_POST, \"/\");\n+    // check if we should use a special wallet endpoint\n+    std::string endpoint = \"/\";\n+    if (GetArg(\"-wallet\", \"\") != \"\") {\n+        // always use v1 endpoint if -wallet has been provided\n+        endpoint = \"/v1/wallet/\"+urlEncode(GetArg(\"-wallet\", \"\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127274408",
      "id" : 127274408,
      "original_commit_id" : "619a298759dbb0cb92f03e49e07de95c9301d8dd",
      "original_position" : 17,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 49828793,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127274408",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127274620"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127274620"
         }
      },
      "body" : "Can we establish whether vpwallets is supposed to be protected by cs_main or not?",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T17:06:18Z",
      "diff_hunk" : "@@ -30,10 +31,27 @@\n \n #include <univalue.h>\n \n+static const std::string WALLET_ENDPOINT_BASE = \"/v1/wallet/\";\n+\n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    // TODO: Some way to access secondary wallets\n-    return vpwallets.empty() ? nullptr : vpwallets[0];\n+    LOCK(cs_main); // for now, protect vpwallets via cs_main",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127274620",
      "id" : 127274620,
      "original_commit_id" : "57bef69dccb2a7ee8cf070925d21bfd48fa3a2b1",
      "original_position" : 18,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 49839643,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127274620",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/4360349?v=4",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127274947"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127274947"
         }
      },
      "body" : "In commit \"Add urlencode/decode via libevent2\"\r\n\r\nShould move these bitcoin-cli changes to prior \"Add -wallet endpoint support to bitcoin-cli\" commit (which doesn't currently) compile.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T17:07:42Z",
      "diff_hunk" : "@@ -238,9 +238,17 @@ UniValue CallRPC(const std::string& strMethod, const UniValue& params)\n \n     // check if we should use a special wallet endpoint\n     std::string endpoint = \"/\";\n-    if (GetArg(\"-wallet\", \"\") != \"\") {\n+    std::string walletName = GetArg(\"-wallet\", \"\");\n+    if (walletName != \"\") {\n         // always use v1 endpoint if -wallet has been provided\n-        endpoint = \"/v1/wallet/\"+urlEncode(GetArg(\"-wallet\", \"\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127274947",
      "id" : 127274947,
      "original_commit_id" : "6a99141a41ced476c244d376e22b24524d3369b0",
      "original_position" : 8,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 49828793,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127274947",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127275786"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127275786"
         }
      },
      "body" : "In commit \"[QA] Fix AuthProxy multiwallet support\"\r\n\r\nShould drop this commit. This should be {}/{} for consistency with python's pathlib API, and you should change all the / \"/path\" expressions to / \"path\" again for consistency with normal python path expressions. (Personally also I think the double slashes look strange).",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T17:11:28Z",
      "diff_hunk" : "@@ -191,3 +191,6 @@ def _get_response(self):\n         else:\n             log.debug(\"<-- [%.6f] %s\"%(elapsed,responsedata))\n         return response\n+\n+    def __truediv__(self, relative_uri):\n+        return AuthServiceProxy(\"{}{}\".format(self.__service_url, relative_uri), self._service_name, connection=self.__conn)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127275786",
      "id" : 127275786,
      "original_commit_id" : "37258d6bf3856218343e98b2c858c1f394b65fb0",
      "original_position" : 6,
      "path" : "test/functional/test_framework/authproxy.py",
      "position" : null,
      "pull_request_review_id" : 49828793,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127275786",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127276164"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127276164"
         }
      },
      "body" : "This should break if you have multiple wallets defined",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T17:13:09Z",
      "diff_hunk" : "@@ -0,0 +1,51 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the wallet.\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import *\n+\n+class MultiWalletTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+        self.extra_args = [['-wallet=w1', '-wallet=w2','-wallet=w3']]\n+\n+    def setup_network(self):\n+        self.nodes = self.start_nodes(1, self.options.tmpdir, self.extra_args[:1])\n+\n+    def run_test(self):\n+        w1 = self.nodes[0] / \"/v1/wallet/w1\"\n+        w1.generate(1)\n+\n+        #check default wallet balance\n+        walletinfo = self.nodes[0].getwalletinfo()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127276164",
      "id" : 127276164,
      "original_commit_id" : "edc0668ea8b7e49e995f27ae987d3f8ed890ddf5",
      "original_position" : 25,
      "path" : "test/functional/multiwallet.py",
      "position" : null,
      "pull_request_review_id" : 49839643,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127276164",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/4360349?v=4",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "body" : "Fixed reported points:\r\n* Disabled default wallet selecting when multiple wallets are present\r\n* Avoid registering multiple of the same endpoints\r\n* Removed cs_main lock for `vpwallets` (lock can be added once we can load wallets outside of init)\r\n* Fixed AuthProxy endpoint \"/\" problem",
      "created_at" : "2017-07-13T19:27:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315178047",
      "id" : 315178047,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-13T19:27:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315178047",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127311827"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127311827"
         }
      },
      "body" : "duplicate. Not required",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T19:39:25Z",
      "diff_hunk" : "@@ -0,0 +1,49 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the wallet.\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import *\n+\n+class MultiWalletTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+        self.extra_args = [['-wallet=w1', '-wallet=w2','-wallet=w3']]\n+\n+    def setup_network(self):\n+        self.nodes = self.start_nodes(1, self.options.tmpdir, self.extra_args[:1])\n+\n+    def run_test(self):\n+        w1 = self.nodes[0] / \"v1/wallet/w1\"\n+        w1.generate(1)\n+\n+        #accessing default wallet must be impossible\n+        assert_raises(JSONRPCException, self.nodes[0].getwalletinfo)\n+\n+        #check w1 wallet balance\n+        w1 = self.nodes[0] / \"v1/wallet/w1\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127311827",
      "id" : 127311827,
      "original_commit_id" : "741b8a6d1e4e86473b06c60a004393d15ed9f846",
      "original_position" : 28,
      "path" : "test/functional/multiwallet.py",
      "position" : null,
      "pull_request_review_id" : 49884399,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127311827",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127311909"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127311909"
         }
      },
      "body" : "seems like `w3` isn't really adding any value to this test. Suggest you remove it.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T19:39:51Z",
      "diff_hunk" : "@@ -0,0 +1,49 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the wallet.\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import *\n+\n+class MultiWalletTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+        self.extra_args = [['-wallet=w1', '-wallet=w2','-wallet=w3']]\n+\n+    def setup_network(self):\n+        self.nodes = self.start_nodes(1, self.options.tmpdir, self.extra_args[:1])\n+\n+    def run_test(self):\n+        w1 = self.nodes[0] / \"v1/wallet/w1\"\n+        w1.generate(1)\n+\n+        #accessing default wallet must be impossible\n+        assert_raises(JSONRPCException, self.nodes[0].getwalletinfo)\n+\n+        #check w1 wallet balance\n+        w1 = self.nodes[0] / \"v1/wallet/w1\"\n+        walletinfo = w1.getwalletinfo()\n+        assert_equal(walletinfo['immature_balance'], 50)\n+\n+        #check w1 wallet balance\n+        w2 = self.nodes[0] / \"v1/wallet/w2\"\n+        walletinfo = w2.getwalletinfo()\n+        assert_equal(walletinfo['immature_balance'], 0)\n+\n+        w3 = self.nodes[0] / \"v1/wallet/w3\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127311909",
      "id" : 127311909,
      "original_commit_id" : "741b8a6d1e4e86473b06c60a004393d15ed9f846",
      "original_position" : 37,
      "path" : "test/functional/multiwallet.py",
      "position" : 33,
      "pull_request_review_id" : 49884399,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127311909",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127312306"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127312306"
         }
      },
      "body" : "nit: please fix docstring",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T19:41:46Z",
      "diff_hunk" : "@@ -0,0 +1,49 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the wallet.\"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127312306",
      "id" : 127312306,
      "original_commit_id" : "741b8a6d1e4e86473b06c60a004393d15ed9f846",
      "original_position" : 5,
      "path" : "test/functional/multiwallet.py",
      "position" : null,
      "pull_request_review_id" : 49884399,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127312306",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127312371"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127312371"
         }
      },
      "body" : "This method override is not required (it's doing the same thing as the base method would do)",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T19:42:06Z",
      "diff_hunk" : "@@ -0,0 +1,49 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the wallet.\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import *\n+\n+class MultiWalletTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+        self.extra_args = [['-wallet=w1', '-wallet=w2','-wallet=w3']]\n+\n+    def setup_network(self):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127312371",
      "id" : 127312371,
      "original_commit_id" : "741b8a6d1e4e86473b06c60a004393d15ed9f846",
      "original_position" : 17,
      "path" : "test/functional/multiwallet.py",
      "position" : null,
      "pull_request_review_id" : 49884399,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127312371",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127312751"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127312751"
         }
      },
      "body" : "nit: there's no such thing as default wallet. Comment should say `accessing wallet RPC without using wallet endpoint fails`",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T19:43:48Z",
      "diff_hunk" : "@@ -0,0 +1,49 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the wallet.\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import *\n+\n+class MultiWalletTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+        self.extra_args = [['-wallet=w1', '-wallet=w2','-wallet=w3']]\n+\n+    def setup_network(self):\n+        self.nodes = self.start_nodes(1, self.options.tmpdir, self.extra_args[:1])\n+\n+    def run_test(self):\n+        w1 = self.nodes[0] / \"v1/wallet/w1\"\n+        w1.generate(1)\n+\n+        #accessing default wallet must be impossible",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127312751",
      "id" : 127312751,
      "original_commit_id" : "741b8a6d1e4e86473b06c60a004393d15ed9f846",
      "original_position" : 24,
      "path" : "test/functional/multiwallet.py",
      "position" : null,
      "pull_request_review_id" : 49884399,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127312751",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127313159"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127313159"
         }
      },
      "body" : "In commit \"Split node / wallet RPC calls based on the endpoint\"\r\n\r\nThis is a dangerous operator to define because it ignores the contents of handler member. Please drop this and just pass a lambda to std::find to do the comparison you want.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T19:45:32Z",
      "diff_hunk" : "@@ -155,6 +155,10 @@ struct HTTPPathHandler\n         prefix(_prefix), exactMatch(_exactMatch), handler(_handler)\n     {\n     }\n+    friend bool operator==(const HTTPPathHandler& a, const HTTPPathHandler& b)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127313159",
      "id" : 127313159,
      "original_commit_id" : "2a9b15a7c80a6dbd2d8415e6d0bd65b084fb80cf",
      "original_position" : 4,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 49885872,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127313159",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127313668"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127313668"
         }
      },
      "body" : "In commit \"Split node / wallet RPC calls based on the endpoint\"\r\n\r\nIf std::find returns an item and item's handler is not identical to `handler` this should throw or assert. Otherwise code trying to register a different handler will silently fail.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T19:47:53Z",
      "diff_hunk" : "@@ -648,7 +652,11 @@ HTTPRequest::RequestMethod HTTPRequest::GetRequestMethod()\n void RegisterHTTPHandler(const std::string &prefix, bool exactMatch, const HTTPRequestHandler &handler)\n {\n     LogPrint(BCLog::HTTP, \"Registering HTTP handler for %s (exactmatch %d)\\n\", prefix, exactMatch);\n-    pathHandlers.push_back(HTTPPathHandler(prefix, exactMatch, handler));\n+    HTTPPathHandler pathHandler(prefix, exactMatch, handler);\n+    if (std::find(pathHandlers.begin(), pathHandlers.end(), pathHandler) == pathHandlers.end()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127313668",
      "id" : 127313668,
      "original_commit_id" : "2a9b15a7c80a6dbd2d8415e6d0bd65b084fb80cf",
      "original_position" : 17,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 49885872,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127313668",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127314126"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127314126"
         }
      },
      "body" : "As discussed in IRC, `-usewallet` might be better here",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T19:50:07Z",
      "diff_hunk" : "@@ -46,6 +46,7 @@ std::string HelpMessageCli()\n     strUsage += HelpMessageOpt(\"-rpcpassword=<pw>\", _(\"Password for JSON-RPC connections\"));\n     strUsage += HelpMessageOpt(\"-rpcclienttimeout=<n>\", strprintf(_(\"Timeout in seconds during HTTP requests, or 0 for no timeout. (default: %d)\"), DEFAULT_HTTP_CLIENT_TIMEOUT));\n     strUsage += HelpMessageOpt(\"-stdin\", _(\"Read extra arguments from standard input, one per line until EOF/Ctrl-D (recommended for sensitive information such as passphrases)\"));\n+    strUsage += HelpMessageOpt(\"-wallet=<walletname>\", _(\"Defines which wallet should be used if a wallet related command gets executed (default: default-wallet if only one present, non-optional if running multiple wallets)\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127314126",
      "id" : 127314126,
      "original_commit_id" : "741b8a6d1e4e86473b06c60a004393d15ed9f846",
      "original_position" : 4,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 49884399,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127314126",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127314276"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127314276"
         }
      },
      "body" : "Thread https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127272854\r\n\r\nWildcard endpoints for wallet-optional rpc not yet addressed.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T19:50:48Z",
      "diff_hunk" : "@@ -898,17 +898,17 @@ UniValue sendrawtransaction(const JSONRPCRequest& request)\n }\n \n static const CRPCCommand commands[] =\n-{ //  category              name                      actor (function)         okSafeMode\n-  //  --------------------- ------------------------  -----------------------  ----------\n-    { \"rawtransactions\",    \"getrawtransaction\",      &getrawtransaction,      true,  {\"txid\",\"verbose\"} },\n-    { \"rawtransactions\",    \"createrawtransaction\",   &createrawtransaction,   true,  {\"inputs\",\"outputs\",\"locktime\",\"replaceable\"} },\n-    { \"rawtransactions\",    \"decoderawtransaction\",   &decoderawtransaction,   true,  {\"hexstring\"} },\n-    { \"rawtransactions\",    \"decodescript\",           &decodescript,           true,  {\"hexstring\"} },\n-    { \"rawtransactions\",    \"sendrawtransaction\",     &sendrawtransaction,     false, {\"hexstring\",\"allowhighfees\"} },\n-    { \"rawtransactions\",    \"signrawtransaction\",     &signrawtransaction,     false, {\"hexstring\",\"prevtxs\",\"privkeys\",\"sighashtype\"} }, /* uses wallet if enabled */\n-\n-    { \"blockchain\",         \"gettxoutproof\",          &gettxoutproof,          true,  {\"txids\", \"blockhash\"} },\n-    { \"blockchain\",         \"verifytxoutproof\",       &verifytxoutproof,       true,  {\"proof\"} },\n+{ //  category              endpoint      name                      actor (function)         okSafeMode  named args\n+  //  ------------------    ------------  ----------------------    -----------------------  ----------  ------------------\n+    { \"rawtransactions\",    \"/v1/node/\",  \"getrawtransaction\",      &getrawtransaction,      true,       {\"txid\",\"verbose\"} },\n+    { \"rawtransactions\",    \"/v1/node/\",  \"createrawtransaction\",   &createrawtransaction,   true,       {\"inputs\",\"outputs\",\"locktime\",\"replaceable\"} },\n+    { \"rawtransactions\",    \"/v1/node/\",  \"decoderawtransaction\",   &decoderawtransaction,   true,       {\"hexstring\"} },\n+    { \"rawtransactions\",    \"/v1/node/\",  \"decodescript\",           &decodescript,           true,       {\"hexstring\"} },\n+    { \"rawtransactions\",    \"/v1/node/\",  \"sendrawtransaction\",     &sendrawtransaction,     false,      {\"hexstring\",\"allowhighfees\"} },\n+    { \"rawtransactions\",    \"/v1/*\",      \"signrawtransaction\",     &signrawtransaction,     false,      {\"hexstring\",\"prevtxs\",\"privkeys\",\"sighashtype\"} }, /* uses wallet if enabled */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127314276",
      "id" : 127314276,
      "original_commit_id" : "37258d6bf3856218343e98b2c858c1f394b65fb0",
      "original_position" : 22,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 22,
      "pull_request_review_id" : 49885872,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127314276",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127315280"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127315280"
         }
      },
      "body" : "In commit \"Select wallet based on the given endpoint\":\r\n\r\nI think this will prevent wallet commands from showing up in `bitcoin-cli help` when multiple wallets are loaded. You may need to add `&& !request.fHelp.`",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T19:55:10Z",
      "diff_hunk" : "@@ -30,10 +31,29 @@\n \n #include <univalue.h>\n \n+static const std::string WALLET_ENDPOINT_BASE = \"/v1/wallet/\";\n+\n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    // TODO: Some way to access secondary wallets\n-    return vpwallets.empty() ? nullptr : vpwallets[0];\n+    if (request.URI.substr(0, WALLET_ENDPOINT_BASE.size()) == WALLET_ENDPOINT_BASE) {\n+        // wallet endpoint was used\n+        std::string requestedWallet = urlDecode(request.URI.substr(WALLET_ENDPOINT_BASE.size()));\n+        for (CWalletRef pwallet : vpwallets) {\n+            if (pwallet->GetName() == requestedWallet) {\n+                return pwallet;\n+            }\n+        }\n+        // no wallet found with the given endpoint\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet file does not exist or is not loaded\");\n+    }\n+    else {\n+        if (vpwallets.size() > 1) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127315280",
      "id" : 127315280,
      "original_commit_id" : "1177da005ed3cd3ada715721e2458257acf08e76",
      "original_position" : 30,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 49885872,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127315280",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127315683"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127315683"
         }
      },
      "body" : "In commit \"Select wallet based on the given endpoint\":\r\n\r\nI think it's preferable just to return nullptr in this case. That way commands that don't need a wallet can still function (validateaddress, createmultisig).\r\n",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T19:57:06Z",
      "diff_hunk" : "@@ -30,10 +31,29 @@\n \n #include <univalue.h>\n \n+static const std::string WALLET_ENDPOINT_BASE = \"/v1/wallet/\";\n+\n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    // TODO: Some way to access secondary wallets\n-    return vpwallets.empty() ? nullptr : vpwallets[0];\n+    if (request.URI.substr(0, WALLET_ENDPOINT_BASE.size()) == WALLET_ENDPOINT_BASE) {\n+        // wallet endpoint was used\n+        std::string requestedWallet = urlDecode(request.URI.substr(WALLET_ENDPOINT_BASE.size()));\n+        for (CWalletRef pwallet : vpwallets) {\n+            if (pwallet->GetName() == requestedWallet) {\n+                return pwallet;\n+            }\n+        }\n+        // no wallet found with the given endpoint\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet file does not exist or is not loaded\");\n+    }\n+    else {\n+        if (vpwallets.size() > 1) {\n+            // don't allow to use a default wallet in multiwallet\n+            throw JSONRPCError(RPC_WALLET_ERROR, \"No wallet was defined but multiple wallets are present\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127315683",
      "id" : 127315683,
      "original_commit_id" : "1177da005ed3cd3ada715721e2458257acf08e76",
      "original_position" : 32,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 49885872,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127315683",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "body" : "`FAIL!  : RPCNestedTests::rpcNestedTests() Caught unhandled exception` in travis",
      "created_at" : "2017-07-13T20:00:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315186141",
      "id" : 315186141,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-13T20:00:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315186141",
      "user" : {
         "avatar_url" : "https://avatars4.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "body" : "Fixed the travis error.\r\nWe indeed need to exclude the empty endpoint `\"\"` from endpoint enforcement. The GUI uses that.\r\nSo reverted that part in `server.cpp`.",
      "created_at" : "2017-07-13T20:09:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315188466",
      "id" : 315188466,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-13T20:09:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315188466",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127321605"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127321605"
         }
      },
      "body" : "Good point. Will fix.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T20:24:05Z",
      "diff_hunk" : "@@ -155,6 +155,10 @@ struct HTTPPathHandler\n         prefix(_prefix), exactMatch(_exactMatch), handler(_handler)\n     {\n     }\n+    friend bool operator==(const HTTPPathHandler& a, const HTTPPathHandler& b)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127321605",
      "id" : 127321605,
      "original_commit_id" : "2a9b15a7c80a6dbd2d8415e6d0bd65b084fb80cf",
      "original_position" : 4,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 49895544,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127321605",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127321789"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127321789"
         }
      },
      "body" : "I think that is something we can change later. Or do you think its crucial?",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T20:24:43Z",
      "diff_hunk" : "@@ -648,7 +652,11 @@ HTTPRequest::RequestMethod HTTPRequest::GetRequestMethod()\n void RegisterHTTPHandler(const std::string &prefix, bool exactMatch, const HTTPRequestHandler &handler)\n {\n     LogPrint(BCLog::HTTP, \"Registering HTTP handler for %s (exactmatch %d)\\n\", prefix, exactMatch);\n-    pathHandlers.push_back(HTTPPathHandler(prefix, exactMatch, handler));\n+    HTTPPathHandler pathHandler(prefix, exactMatch, handler);\n+    if (std::find(pathHandlers.begin(), pathHandlers.end(), pathHandler) == pathHandlers.end()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127321789",
      "id" : 127321789,
      "original_commit_id" : "2a9b15a7c80a6dbd2d8415e6d0bd65b084fb80cf",
      "original_position" : 17,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 49895544,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127321789",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127322386"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127322386"
         }
      },
      "body" : "Just fixed.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T20:27:21Z",
      "diff_hunk" : "@@ -898,17 +898,17 @@ UniValue sendrawtransaction(const JSONRPCRequest& request)\n }\n \n static const CRPCCommand commands[] =\n-{ //  category              name                      actor (function)         okSafeMode\n-  //  --------------------- ------------------------  -----------------------  ----------\n-    { \"rawtransactions\",    \"getrawtransaction\",      &getrawtransaction,      true,  {\"txid\",\"verbose\"} },\n-    { \"rawtransactions\",    \"createrawtransaction\",   &createrawtransaction,   true,  {\"inputs\",\"outputs\",\"locktime\",\"replaceable\"} },\n-    { \"rawtransactions\",    \"decoderawtransaction\",   &decoderawtransaction,   true,  {\"hexstring\"} },\n-    { \"rawtransactions\",    \"decodescript\",           &decodescript,           true,  {\"hexstring\"} },\n-    { \"rawtransactions\",    \"sendrawtransaction\",     &sendrawtransaction,     false, {\"hexstring\",\"allowhighfees\"} },\n-    { \"rawtransactions\",    \"signrawtransaction\",     &signrawtransaction,     false, {\"hexstring\",\"prevtxs\",\"privkeys\",\"sighashtype\"} }, /* uses wallet if enabled */\n-\n-    { \"blockchain\",         \"gettxoutproof\",          &gettxoutproof,          true,  {\"txids\", \"blockhash\"} },\n-    { \"blockchain\",         \"verifytxoutproof\",       &verifytxoutproof,       true,  {\"proof\"} },\n+{ //  category              endpoint      name                      actor (function)         okSafeMode  named args\n+  //  ------------------    ------------  ----------------------    -----------------------  ----------  ------------------\n+    { \"rawtransactions\",    \"/v1/node/\",  \"getrawtransaction\",      &getrawtransaction,      true,       {\"txid\",\"verbose\"} },\n+    { \"rawtransactions\",    \"/v1/node/\",  \"createrawtransaction\",   &createrawtransaction,   true,       {\"inputs\",\"outputs\",\"locktime\",\"replaceable\"} },\n+    { \"rawtransactions\",    \"/v1/node/\",  \"decoderawtransaction\",   &decoderawtransaction,   true,       {\"hexstring\"} },\n+    { \"rawtransactions\",    \"/v1/node/\",  \"decodescript\",           &decodescript,           true,       {\"hexstring\"} },\n+    { \"rawtransactions\",    \"/v1/node/\",  \"sendrawtransaction\",     &sendrawtransaction,     false,      {\"hexstring\",\"allowhighfees\"} },\n+    { \"rawtransactions\",    \"/v1/*\",      \"signrawtransaction\",     &signrawtransaction,     false,      {\"hexstring\",\"prevtxs\",\"privkeys\",\"sighashtype\"} }, /* uses wallet if enabled */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127322386",
      "id" : 127322386,
      "original_commit_id" : "37258d6bf3856218343e98b2c858c1f394b65fb0",
      "original_position" : 22,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 22,
      "pull_request_review_id" : 49895544,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127322386",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "* Fixed the std::find / == operator issue reported by @ryanofsky.\r\n* Switch `validateaddress`, `createmultisig` to the wildcard `v1` endpoint `/v1/*`.",
      "created_at" : "2017-07-13T20:28:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315192800",
      "id" : 315192800,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-13T20:28:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315192800",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127324604"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127324604"
         }
      },
      "body" : "Thread https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127313668\r\n\r\n> I think that is something we can change later. Or do you think its crucial?\r\n\r\nNot crucial (this isn't a bug and I already acked), but this seems very easy, unless I'm missing something?\r\n\r\n```\r\nauto it = find_if();\r\nif (it == end) push_back(handler); else assert (it->handler == handler.handler);\r\n```",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T20:38:14Z",
      "diff_hunk" : "@@ -648,7 +652,11 @@ HTTPRequest::RequestMethod HTTPRequest::GetRequestMethod()\n void RegisterHTTPHandler(const std::string &prefix, bool exactMatch, const HTTPRequestHandler &handler)\n {\n     LogPrint(BCLog::HTTP, \"Registering HTTP handler for %s (exactmatch %d)\\n\", prefix, exactMatch);\n-    pathHandlers.push_back(HTTPPathHandler(prefix, exactMatch, handler));\n+    HTTPPathHandler pathHandler(prefix, exactMatch, handler);\n+    if (std::find(pathHandlers.begin(), pathHandlers.end(), pathHandler) == pathHandlers.end()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127324604",
      "id" : 127324604,
      "original_commit_id" : "2a9b15a7c80a6dbd2d8415e6d0bd65b084fb80cf",
      "original_position" : 17,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 49899046,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127324604",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127327125"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127327125"
         }
      },
      "body" : "please use the `assert_raises_jsonrpc()` function to check the error code and message",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T20:49:35Z",
      "diff_hunk" : "@@ -0,0 +1,49 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the wallet.\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import *\n+\n+class MultiWalletTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+        self.extra_args = [['-wallet=w1', '-wallet=w2','-wallet=w3']]\n+\n+    def setup_network(self):\n+        self.nodes = self.start_nodes(1, self.options.tmpdir, self.extra_args[:1])\n+\n+    def run_test(self):\n+        w1 = self.nodes[0] / \"v1/wallet/w1\"\n+        w1.generate(1)\n+\n+        #accessing default wallet must be impossible\n+        assert_raises(JSONRPCException, self.nodes[0].getwalletinfo)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127327125",
      "id" : 127327125,
      "original_commit_id" : "d350a16ceeedca8cb65c57b21c3f6acd41fb5173",
      "original_position" : 25,
      "path" : "test/functional/multiwallet.py",
      "position" : null,
      "pull_request_review_id" : 49884399,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127327125",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127329553"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127329553"
         }
      },
      "body" : "Guess I missed this. I think `-usewallet` is worse because it is inconsistent with existing bitcoin `-wallet` parameter which this mirrors. I also think my suggested documentation https://github.com/bitcoin/bitcoin/pull/10650#discussion_r123489861 is better because it keeps this consistency and won't leave the user scratching their head about what \"walletname\" is supposed to mean:\r\n\r\n```\r\nstrUsage += HelpMessageOpt(\"-wallet=<file>\", _(\"Send RPC for non-default wallet on RPC server (argument is wallet filename in bitcoind directory)\"));\r\n```",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T21:00:07Z",
      "diff_hunk" : "@@ -46,6 +46,7 @@ std::string HelpMessageCli()\n     strUsage += HelpMessageOpt(\"-rpcpassword=<pw>\", _(\"Password for JSON-RPC connections\"));\n     strUsage += HelpMessageOpt(\"-rpcclienttimeout=<n>\", strprintf(_(\"Timeout in seconds during HTTP requests, or 0 for no timeout. (default: %d)\"), DEFAULT_HTTP_CLIENT_TIMEOUT));\n     strUsage += HelpMessageOpt(\"-stdin\", _(\"Read extra arguments from standard input, one per line until EOF/Ctrl-D (recommended for sensitive information such as passphrases)\"));\n+    strUsage += HelpMessageOpt(\"-wallet=<walletname>\", _(\"Defines which wallet should be used if a wallet related command gets executed (default: default-wallet if only one present, non-optional if running multiple wallets)\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127329553",
      "id" : 127329553,
      "original_commit_id" : "741b8a6d1e4e86473b06c60a004393d15ed9f846",
      "original_position" : 4,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 49904666,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127329553",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127332592"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127332592"
         }
      },
      "body" : "we want `-usewallet`. If there are multiple `-wallet` parameters in bitcoin.conf, then I don't think it'll be possible to specify which wallet bitcoin-cli should use.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T21:14:39Z",
      "diff_hunk" : "@@ -46,6 +46,7 @@ std::string HelpMessageCli()\n     strUsage += HelpMessageOpt(\"-rpcpassword=<pw>\", _(\"Password for JSON-RPC connections\"));\n     strUsage += HelpMessageOpt(\"-rpcclienttimeout=<n>\", strprintf(_(\"Timeout in seconds during HTTP requests, or 0 for no timeout. (default: %d)\"), DEFAULT_HTTP_CLIENT_TIMEOUT));\n     strUsage += HelpMessageOpt(\"-stdin\", _(\"Read extra arguments from standard input, one per line until EOF/Ctrl-D (recommended for sensitive information such as passphrases)\"));\n+    strUsage += HelpMessageOpt(\"-wallet=<walletname>\", _(\"Defines which wallet should be used if a wallet related command gets executed (default: default-wallet if only one present, non-optional if running multiple wallets)\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127332592",
      "id" : 127332592,
      "original_commit_id" : "741b8a6d1e4e86473b06c60a004393d15ed9f846",
      "original_position" : 4,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 49908204,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127332592",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127333306"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127333306"
         }
      },
      "body" : "further, I get \"trapped\" if I have a `wallet` entry in my conf file, since any subsequent `-cli` call will use that parameter, including `stop`, etc, and throw `Incorrect endpoint used` errors. (unless I'm misunderstanding how it's used)",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T21:18:03Z",
      "diff_hunk" : "@@ -46,6 +46,7 @@ std::string HelpMessageCli()\n     strUsage += HelpMessageOpt(\"-rpcpassword=<pw>\", _(\"Password for JSON-RPC connections\"));\n     strUsage += HelpMessageOpt(\"-rpcclienttimeout=<n>\", strprintf(_(\"Timeout in seconds during HTTP requests, or 0 for no timeout. (default: %d)\"), DEFAULT_HTTP_CLIENT_TIMEOUT));\n     strUsage += HelpMessageOpt(\"-stdin\", _(\"Read extra arguments from standard input, one per line until EOF/Ctrl-D (recommended for sensitive information such as passphrases)\"));\n+    strUsage += HelpMessageOpt(\"-wallet=<walletname>\", _(\"Defines which wallet should be used if a wallet related command gets executed (default: default-wallet if only one present, non-optional if running multiple wallets)\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127333306",
      "id" : 127333306,
      "original_commit_id" : "741b8a6d1e4e86473b06c60a004393d15ed9f846",
      "original_position" : 4,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 49909033,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127333306",
      "user" : {
         "avatar_url" : "https://avatars4.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127335254"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127335254"
         }
      },
      "body" : "Thread https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127314126.\r\n\r\nI see, yeah. I guess `-wallet` won't work unless bitcoin-cli is changed to explicitly ignore `-wallet` values that come from the conf file, which might not be a bad idea, but I'm not advocating for.\r\n\r\nInterestingly, I guess if if `bitcoin-cli` is changed to accept `-usewallet` and support for node calls on the wallet endpoint is added, users will be able to specify a \"default wallet\" in their configs.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T21:25:22Z",
      "diff_hunk" : "@@ -46,6 +46,7 @@ std::string HelpMessageCli()\n     strUsage += HelpMessageOpt(\"-rpcpassword=<pw>\", _(\"Password for JSON-RPC connections\"));\n     strUsage += HelpMessageOpt(\"-rpcclienttimeout=<n>\", strprintf(_(\"Timeout in seconds during HTTP requests, or 0 for no timeout. (default: %d)\"), DEFAULT_HTTP_CLIENT_TIMEOUT));\n     strUsage += HelpMessageOpt(\"-stdin\", _(\"Read extra arguments from standard input, one per line until EOF/Ctrl-D (recommended for sensitive information such as passphrases)\"));\n+    strUsage += HelpMessageOpt(\"-wallet=<walletname>\", _(\"Defines which wallet should be used if a wallet related command gets executed (default: default-wallet if only one present, non-optional if running multiple wallets)\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127335254",
      "id" : 127335254,
      "original_commit_id" : "741b8a6d1e4e86473b06c60a004393d15ed9f846",
      "original_position" : 4,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 49910978,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127335254",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127336662"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127336662"
         }
      },
      "body" : "> users will be able to specify a \"default wallet\" in their configs\r\n\r\nshhhh. Don't tell anyone about the secret hidden default wallet feature.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-13T21:30:18Z",
      "diff_hunk" : "@@ -46,6 +46,7 @@ std::string HelpMessageCli()\n     strUsage += HelpMessageOpt(\"-rpcpassword=<pw>\", _(\"Password for JSON-RPC connections\"));\n     strUsage += HelpMessageOpt(\"-rpcclienttimeout=<n>\", strprintf(_(\"Timeout in seconds during HTTP requests, or 0 for no timeout. (default: %d)\"), DEFAULT_HTTP_CLIENT_TIMEOUT));\n     strUsage += HelpMessageOpt(\"-stdin\", _(\"Read extra arguments from standard input, one per line until EOF/Ctrl-D (recommended for sensitive information such as passphrases)\"));\n+    strUsage += HelpMessageOpt(\"-wallet=<walletname>\", _(\"Defines which wallet should be used if a wallet related command gets executed (default: default-wallet if only one present, non-optional if running multiple wallets)\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127336662",
      "id" : 127336662,
      "original_commit_id" : "741b8a6d1e4e86473b06c60a004393d15ed9f846",
      "original_position" : 4,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 49912292,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T07:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127336662",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "* Changed bitcoin-cli's parameter to `-usewallet`\r\n* Fixed @jnewbery nits on the RPC test",
      "created_at" : "2017-07-14T07:55:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315296455",
      "id" : 315296455,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-14T07:55:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315296455",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Changes look great. Manually tested ACK https://github.com/bitcoin/bitcoin/pull/10650/commits/759dc37f3de53f660c73650c0678f1ee6544490b\r\n\r\nI think this is ready for merge.\r\n\r\nThanks for your work on this!",
      "created_at" : "2017-07-14T14:29:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315374064",
      "id" : 315374064,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-14T14:29:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315374064",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "tACK https://github.com/bitcoin/bitcoin/pull/10650/commits/759dc37f3de53f660c73650c0678f1ee6544490b\r\n\r\nTo recap behavior:\r\n~~- first `-wallet` is used when no endpoint is given~~\r\n- `-wallet` is ignored -cli side\r\n- `-usewallet` correctly complains when file isn't loaded\r\n- empty `-usewallet` allows non-wallet functionality calls, ala `bitcoin-cli -usewallet=\"\" getinfo`\r\n\r\n\r\nnit: The behavior of `-usewallet=\"\"` is inconsistent when used with wallet functionality. Gives `Method not found (disabled)` error, which isn't very clear. This can be fixed later...",
      "created_at" : "2017-07-14T14:57:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315381320",
      "id" : 315381320,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-14T15:40:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315381320",
      "user" : {
         "avatar_url" : "https://avatars4.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127477737"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127477737"
         }
      },
      "body" : "```cpp\r\nif (request.URI.compare(0, WALLET_ENDPOINT_BASE.size(), WALLET_ENDPOINT_BASE) == 0)\r\n```",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-14T15:04:30Z",
      "diff_hunk" : "@@ -30,10 +31,29 @@\n \n #include <univalue.h>\n \n+static const std::string WALLET_ENDPOINT_BASE = \"/v1/wallet/\";\n+\n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    // TODO: Some way to access secondary wallets\n-    return vpwallets.empty() ? nullptr : vpwallets[0];\n+    if (request.URI.substr(0, WALLET_ENDPOINT_BASE.size()) == WALLET_ENDPOINT_BASE) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127477737",
      "id" : 127477737,
      "original_commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "original_position" : 18,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 18,
      "pull_request_review_id" : 50070877,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T15:31:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127477737",
      "user" : {
         "avatar_url" : "https://avatars5.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "> first -wallet is \"default wallet\"\r\n\r\nThere is no default wallet. There should be no functional difference between wallets when multiple wallets are loaded.",
      "created_at" : "2017-07-14T15:06:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315383601",
      "id" : 315383601,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-14T15:06:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315383601",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127478666"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127478666"
         }
      },
      "body" : "The `} else {` can be removed since the `if` blocks always exists the function.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-14T15:08:14Z",
      "diff_hunk" : "@@ -30,10 +31,29 @@\n \n #include <univalue.h>\n \n+static const std::string WALLET_ENDPOINT_BASE = \"/v1/wallet/\";\n+\n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    // TODO: Some way to access secondary wallets\n-    return vpwallets.empty() ? nullptr : vpwallets[0];\n+    if (request.URI.substr(0, WALLET_ENDPOINT_BASE.size()) == WALLET_ENDPOINT_BASE) {\n+        // wallet endpoint was used\n+        std::string requestedWallet = urlDecode(request.URI.substr(WALLET_ENDPOINT_BASE.size()));\n+        for (CWalletRef pwallet : vpwallets) {\n+            if (pwallet->GetName() == requestedWallet) {\n+                return pwallet;\n+            }\n+        }\n+        // no wallet found with the given endpoint\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet file does not exist or is not loaded\");\n+    }\n+    else {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127478666",
      "id" : 127478666,
      "original_commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "original_position" : 29,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 29,
      "pull_request_review_id" : 50070877,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T15:31:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127478666",
      "user" : {
         "avatar_url" : "https://avatars5.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "@jnewbery ok let me rephrase: non-endpoint calls will still use that wallet(just like before).",
      "created_at" : "2017-07-14T15:08:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315384107",
      "id" : 315384107,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-14T15:08:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315384107",
      "user" : {
         "avatar_url" : "https://avatars4.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127479720"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127479720"
         }
      },
      "body" : "`} else {`?",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-14T15:12:40Z",
      "diff_hunk" : "@@ -665,3 +669,14 @@ void UnregisterHTTPHandler(const std::string &prefix, bool exactMatch)\n     }\n }\n \n+std::string urlDecode(const std::string &urlEncoded) {\n+    std::string res;\n+    if (!urlEncoded.empty()) {\n+        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, NULL);\n+        if (decoded) {\n+            res = std::string(decoded);\n+            free(decoded);\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127479720",
      "id" : 127479720,
      "original_commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "original_position" : 24,
      "path" : "src/httpserver.cpp",
      "position" : 24,
      "pull_request_review_id" : 50070877,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T15:31:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127479720",
      "user" : {
         "avatar_url" : "https://avatars5.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127480814"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127480814"
         }
      },
      "body" : "`evhttp_uridecode` works with an empty string, as such this `if` can be removed.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-14T15:17:22Z",
      "diff_hunk" : "@@ -665,3 +669,14 @@ void UnregisterHTTPHandler(const std::string &prefix, bool exactMatch)\n     }\n }\n \n+std::string urlDecode(const std::string &urlEncoded) {\n+    std::string res;\n+    if (!urlEncoded.empty()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127480814",
      "id" : 127480814,
      "original_commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "original_position" : 19,
      "path" : "src/httpserver.cpp",
      "position" : 19,
      "pull_request_review_id" : 50070877,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T15:31:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127480814",
      "user" : {
         "avatar_url" : "https://avatars5.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127481167"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127481167"
         }
      },
      "body" : "```cpp\r\nif (!request.URI.empty() && ...)\r\n```",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-14T15:19:03Z",
      "diff_hunk" : "@@ -494,6 +498,13 @@ UniValue CRPCTable::execute(const JSONRPCRequest &request) const\n     if (!pcmd)\n         throw JSONRPCError(RPC_METHOD_NOT_FOUND, \"Method not found\");\n \n+    // enfore endpoint only for non / and \"\" endpoint (the later is used by the GUI)\n+    if (request.URI != \"\" && request.URI != \"/\") {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127481167",
      "id" : 127481167,
      "original_commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "original_position" : 36,
      "path" : "src/rpc/server.cpp",
      "position" : 36,
      "pull_request_review_id" : 50070877,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T15:31:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127481167",
      "user" : {
         "avatar_url" : "https://avatars5.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "I think this PR started off bad and has gotten worse, and I'm writing another post to go into what I think the new problems are. But because I think there's a good chance that post will be ignored or disputed, I want to suggest 2 more changes that I think would make this PR less bad.\r\n\r\n1. Rename `-usewallet` to `-rpcwallet` or similar. Prefix \"use\" is kind of ridiculous unless you think someone is going to go through the trouble of setting an option that they don't actually want to be used.\r\n\r\n2. Rename `/v1` endpoint to `/v1-unstable` or `/rpc/v1-unstable`. I think the `/rpc` prefix would be good to add because now that the RPC handler is annexing uri-path space, it should try to leave other parts of the space open for different applications like a possible web interface. But I think the `-unstable` suffix is more important because plain `v1` `v2` could imply that we have some kind of plan for versioning and backwards compatibility, which we don't, given the fact that that we have talked about the  `v1` namespace being \"EXPERIMENTAL\" https://botbot.me/freenode/bitcoin-core-dev/msg/88537348/ and as recently as yesterday have discussed making incompatible changes.",
      "created_at" : "2017-07-14T15:22:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315387672",
      "id" : 315387672,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-14T15:22:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315387672",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "body" : "> non-endpoint calls will still use that wallet(just like before).\r\n\r\nHuh? No. That's the point. We want to avoid RPCs defaulting to any wallet when they're called without endpoints. Having a 'default' wallet risks users accidentally calling a method on the wrong wallet.",
      "created_at" : "2017-07-14T15:23:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315388068",
      "id" : 315388068,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-14T15:23:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315388068",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127483516"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127483516"
         }
      },
      "body" : "nit: should your lambda capture list and argument be references?",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-14T15:29:36Z",
      "diff_hunk" : "@@ -648,7 +648,11 @@ HTTPRequest::RequestMethod HTTPRequest::GetRequestMethod()\n void RegisterHTTPHandler(const std::string &prefix, bool exactMatch, const HTTPRequestHandler &handler)\n {\n     LogPrint(BCLog::HTTP, \"Registering HTTP handler for %s (exactmatch %d)\\n\", prefix, exactMatch);\n-    pathHandlers.push_back(HTTPPathHandler(prefix, exactMatch, handler));\n+    HTTPPathHandler pathHandler(prefix, exactMatch, handler);\n+    if (std::find_if(pathHandlers.begin(), pathHandlers.end(), [pathHandler](const HTTPPathHandler a){ return (a.prefix == pathHandler.prefix && a.exactMatch == pathHandler.exactMatch); }) == pathHandlers.end()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127483516",
      "id" : 127483516,
      "original_commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "original_position" : 6,
      "path" : "src/httpserver.cpp",
      "position" : 6,
      "pull_request_review_id" : 50077411,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T15:43:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127483516",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/4360349?v=4",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "body" : "@jnewbery My mistake, I probably iterated too fast through options. Can confirm that it gives `Method not found (disabled)` when 2+ wallets are loaded.",
      "created_at" : "2017-07-14T15:39:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315392120",
      "id" : 315392120,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-14T15:39:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315392120",
      "user" : {
         "avatar_url" : "https://avatars4.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127490929"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127490929"
         }
      },
      "body" : "What about something along these lines:\r\n```cpp\r\n// only add handlers if they do not exists yet\r\nfor (auto handler : pathHandlers) {\r\n    if (handler.prefix == prefix && handler.exactMatch == exactMath) {\r\n        return;\r\n    }\r\n}\r\n\r\npathHandlers.push_back(HTTPPathHandler(prefix, exactMatch, handler));\r\n```",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-14T16:04:20Z",
      "diff_hunk" : "@@ -648,7 +648,11 @@ HTTPRequest::RequestMethod HTTPRequest::GetRequestMethod()\n void RegisterHTTPHandler(const std::string &prefix, bool exactMatch, const HTTPRequestHandler &handler)\n {\n     LogPrint(BCLog::HTTP, \"Registering HTTP handler for %s (exactmatch %d)\\n\", prefix, exactMatch);\n-    pathHandlers.push_back(HTTPPathHandler(prefix, exactMatch, handler));\n+    HTTPPathHandler pathHandler(prefix, exactMatch, handler);\n+    if (std::find_if(pathHandlers.begin(), pathHandlers.end(), [pathHandler](const HTTPPathHandler a){ return (a.prefix == pathHandler.prefix && a.exactMatch == pathHandler.exactMatch); }) == pathHandlers.end()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127490929",
      "id" : 127490929,
      "original_commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "original_position" : 6,
      "path" : "src/httpserver.cpp",
      "position" : 6,
      "pull_request_review_id" : 50085851,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T16:04:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127490929",
      "user" : {
         "avatar_url" : "https://avatars5.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127491102"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127491102"
         }
      },
      "body" : "Another option is to implement `HTTPPathHandler::operator==`?",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-14T16:05:18Z",
      "diff_hunk" : "@@ -648,7 +648,11 @@ HTTPRequest::RequestMethod HTTPRequest::GetRequestMethod()\n void RegisterHTTPHandler(const std::string &prefix, bool exactMatch, const HTTPRequestHandler &handler)\n {\n     LogPrint(BCLog::HTTP, \"Registering HTTP handler for %s (exactmatch %d)\\n\", prefix, exactMatch);\n-    pathHandlers.push_back(HTTPPathHandler(prefix, exactMatch, handler));\n+    HTTPPathHandler pathHandler(prefix, exactMatch, handler);\n+    if (std::find_if(pathHandlers.begin(), pathHandlers.end(), [pathHandler](const HTTPPathHandler a){ return (a.prefix == pathHandler.prefix && a.exactMatch == pathHandler.exactMatch); }) == pathHandlers.end()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127491102",
      "id" : 127491102,
      "original_commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "original_position" : 6,
      "path" : "src/httpserver.cpp",
      "position" : 6,
      "pull_request_review_id" : 50086069,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T16:05:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127491102",
      "user" : {
         "avatar_url" : "https://avatars5.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "This PR is looking worse than before. This is bad engineering and interface design, which creates usability problems with confusing errors and restrictions, and will lead to hacks, workarounds, and churn in the future. All of which is pointless because we have a much simpler alternative in https://github.com/bitcoin/bitcoin/compare/master...ryanofsky:pr/multiparam which has none of these problems and is 100% compatible with endpoints if we want to add them later.\r\n\r\nPreviously and with https://github.com/bitcoin/bitcoin/compare/master...ryanofsky:pr/multiparam, to perform an operation you would call a RPC _method_ on the server, pass it a set of JSON _parameters_, and get back a JSON _result_. This is a simple, straightforward paradigm familiar to anyone with any background in programming. Now, for no one's benefit, we want to overlay complexity and restrictions on top of this when [we haven't actually figured out what the restrictions should be](https://botbot.me/freenode/bitcoin-core-dev/msg/88537489/) and are still discussing [different](https://botbot.me/freenode/bitcoin-core-dev/msg/88537218/) [possible](https://botbot.me/freenode/bitcoin-core-dev/msg/88537228/) workarounds for the usability problems this change causes.\r\n\r\nInstead of having method calls with simple parameters, we are now throwing a REST URL scheme into the mix (without adopting other REST principles, which don't make sense for a non-REST RPC interface to begin with), so instead of (_method_ + _params_ -> _result_) we now have (_method_ + _params_ + _uri-path with some redundant information already derivable from method and params and incomplete and changing consistency requirements_ -> _result_). But this has been my objection all along, so here is why I now think this change is worse than before:\r\n\r\n* By passing the wallet out of band, instead of like any other normal RPC parameter, we have to give it special treatment that adds complexity to bitcoin client. We have to make it a command line option, but we can't make it consistent with bitcoind's `-wallet=filename` option, because then it will get picked up from the config file and create a [trapped in wallet situation](https://botbot.me/freenode/bitcoin-core-dev/msg/88541566/) where it is impossible to call node methods. Workaround is to introduce a pointless \"use\" prefix that exists for no other bitcoin-cli option so we now have `-usewallet=filename` alongside `-wallet=filename`. (Perhaps in the future we could add `-dontusewallet=filename` and `-maybeusewallet=filename` to expand the variety of ways our tools take their wallet filenames.)\r\n\r\n* To avoid more cases of the _trapped in wallet_ problem above, it was proposed to have `bitcoin-cli` look at the method name and determine whether to [silently drop](https://botbot.me/freenode/bitcoin-core-dev/msg/88537218/) the `-usewallet` option in `bitcoin-cli`. Third party RPC utils and some future QT multiwallet RPC console will have to do something similar, and these changes are going to be messy. I'm not looking forward to reviewing them, and they would be unnecessary if we just treated the wallet name like any other normal RPC parameter.\r\n\r\n- As an alternate solution to _trapped in wallet_ problems, it was proposed to allow `/v1/wallet/filename` endpoint to actually accept [both wallet AND node RPCs](https://botbot.me/freenode/bitcoin-core-dev/msg/88537228/). This of course makes sense on some level, but it would seem to **undermine any motivation for adding these restrictions in the first place**. If I'm supposed to believe that we live in an upside-down world where [creating confusing interface restrictions for no reason now](https://github.com/bitcoin/bitcoin/pull/10653#issuecomment-315164126) is good for users because it will teach them to send node and wallet requests to different endpoints in the future, isn't that goal undermined by creating a brand new endpoint that's in a different place than before but still accepts both node and wallet commands?\r\n\r\nI'm maybe just failing to understand what is motivating this change. I think there is a boiling frog thing going on because this PR started off simpler without encoding, and node endpoints, and default wallet restrictions, and the `-usewallet` inconsistency, and sort of metastasized over time into it's current state. But meanwhile we have a [simpler alternative](https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315066331) (that without help and tests [adds exactly 11 lines of code](https://github.com/bitcoin/bitcoin/compare/master...ryanofsky:pr/multiparam)) and requires no changes to RPC clients, and is completely compatible with endpoints if we ever wanted to add them later. Obviously, if you accept the [pleasure is pain, pain is pleasure](https://github.com/bitcoin/bitcoin/pull/10653#issuecomment-315170318) rationale for uri-path restrictions, then #10650 is pretty ideal. But otherwise I think https://github.com/bitcoin/bitcoin/compare/master...ryanofsky:pr/multiparam is a much simpler and saner way to roll out multiwallet support.",
      "created_at" : "2017-07-14T17:03:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315412302",
      "id" : 315412302,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-14T17:07:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315412302",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "body" : "Thanks @ryanofsky - I think those are all good points, and I'm sympathetic to them.\r\n\r\nAt this point, I think we should go ahead with merging this PR. It's had lots of review, and already has 4 ACKs.\r\n\r\nWe still have some freedom with the interface after this is merged. The feature is going to be marked as experimental, and anyone who uses multiwallet should be prepared for the interface to be tweaked as the feature becomes more mature. For example, in bitcoin.cli, we could just ignore any `-wallet` arguments in the .conf file, and have the user explicitly have to set `-wallet` on the command line. I think that would allay your concerns there. Should we do that in this PR? Perhaps, but at this point there's already been so much churn in this PR, that I think we can delay that until a later PR.\r\n\r\nSo in order to get something merged which is now very well reviewed and tested, we should go ahead with this PR and tidy up the rough edges later.",
      "created_at" : "2017-07-14T17:56:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315425015",
      "id" : 315425015,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-14T17:57:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315425015",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "> So in order to get something merged which is now very well reviewed and tested, we should go ahead with this PR and tidy up the rough edges later.\r\n\r\nOk but these changes are never going to happen later if they don't get done before merging this PR: https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315387672, so please say something if there is a problem with `-unstable` or `-rpcwallet`\r\n\r\n",
      "created_at" : "2017-07-14T18:01:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315426144",
      "id" : 315426144,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-14T18:01:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315426144",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "body" : "- `-unstable` : I disagree that there is an implication that `v1` commits us to backwards compatibility, so I don't think this is necessary\r\n- `-rpcwallet` vs `-usewallet` : Yours is slightly better, but I don't think it matters that much.",
      "created_at" : "2017-07-14T18:11:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315428792",
      "id" : 315428792,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-14T18:11:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315428792",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127518189"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127518189"
         }
      },
      "body" : "I guess there is no need for an else, it will just return an empty string if URLencode failed which is fine IMO.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-14T18:16:49Z",
      "diff_hunk" : "@@ -665,3 +669,14 @@ void UnregisterHTTPHandler(const std::string &prefix, bool exactMatch)\n     }\n }\n \n+std::string urlDecode(const std::string &urlEncoded) {\n+    std::string res;\n+    if (!urlEncoded.empty()) {\n+        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, NULL);\n+        if (decoded) {\n+            res = std::string(decoded);\n+            free(decoded);\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127518189",
      "id" : 127518189,
      "original_commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "original_position" : 24,
      "path" : "src/httpserver.cpp",
      "position" : 24,
      "pull_request_review_id" : 50116625,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T18:16:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127518189",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127519034"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127519034"
         }
      },
      "body" : "@promag: I think your solution would be a slower find algorithm (but doesn't matter). I had the `==` operator in an earlier version but @ryanofsky said (and I agreed) that this may be dangerous if we not check all of the instance variables (including the handler).\r\n\r\n@morcos: Yes, Should be referenced.",
      "commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "created_at" : "2017-07-14T18:20:43Z",
      "diff_hunk" : "@@ -648,7 +648,11 @@ HTTPRequest::RequestMethod HTTPRequest::GetRequestMethod()\n void RegisterHTTPHandler(const std::string &prefix, bool exactMatch, const HTTPRequestHandler &handler)\n {\n     LogPrint(BCLog::HTTP, \"Registering HTTP handler for %s (exactmatch %d)\\n\", prefix, exactMatch);\n-    pathHandlers.push_back(HTTPPathHandler(prefix, exactMatch, handler));\n+    HTTPPathHandler pathHandler(prefix, exactMatch, handler);\n+    if (std::find_if(pathHandlers.begin(), pathHandlers.end(), [pathHandler](const HTTPPathHandler a){ return (a.prefix == pathHandler.prefix && a.exactMatch == pathHandler.exactMatch); }) == pathHandlers.end()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#discussion_r127519034",
      "id" : 127519034,
      "original_commit_id" : "759dc37f3de53f660c73650c0678f1ee6544490b",
      "original_position" : 6,
      "path" : "src/httpserver.cpp",
      "position" : 6,
      "pull_request_review_id" : 50117570,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10650",
      "updated_at" : "2017-07-14T18:20:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/127519034",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "I agree with most nits from @promag and @morcos but for the sake of getting this merged before the freeze I'm no longer force-push fixing nits.",
      "created_at" : "2017-07-14T18:22:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315431518",
      "id" : 315431518,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-14T18:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315431518",
      "user" : {
         "avatar_url" : "https://avatars7.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "> -unstable : I disagree that there is an implication that v1 commits us to backwards compatibility, so I don't think this is necessary\r\n\r\nI might have misunderstood what was meant by the `v1` endpoint being \"experimental.\" If experimental just means that the endpoint might go away in the future (to be replaced by `v2` `v3` etc), then agree it doesn't have to be specially marked, though, it would be nicer if it were.\r\n\r\nBut if \"experimental\" means that behavior of the endpoint is unstable and can change without concern for backward compatibility then it definitely should be marked `-unstable`, because when you use the same version number for two different things you definitely are implying that the new thing is compatible with the old thing.\r\n",
      "created_at" : "2017-07-14T18:54:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315439185",
      "id" : 315439185,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-14T18:54:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315439185",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "body" : "@ryanofsky's commit looks so simple that I'm inclined at this point to go with that, and push the v1 API to a later version...",
      "created_at" : "2017-07-14T19:43:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315450034",
      "id" : 315450034,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-14T19:43:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315450034",
      "user" : {
         "avatar_url" : "https://avatars5.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa I think I'm also fine with that.\r\nThis appears merge ready, lets get a few quick reviews of #10653 and then we could merge either one",
      "created_at" : "2017-07-14T19:57:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315452985",
      "id" : 315452985,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-14T19:57:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315452985",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/4360349?v=4",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "body" : "> This appears merge ready, lets get a few quick reviews of #10653 and then we could merge either one\r\n\r\nGithub won't let me reopen #10653 (and contained an old snapshot of the branch) so I opened #10829.",
      "created_at" : "2017-07-14T20:00:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315453599",
      "id" : 315453599,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-14T20:00:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315453599",
      "user" : {
         "avatar_url" : "https://avatars6.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "body" : "It looks like this implementation is still too controversial to make it into 0.15, so removing the milestone (sorry, this is a very painful decision for me too).",
      "created_at" : "2017-07-17T07:17:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-315682641",
      "id" : 315682641,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-17T07:20:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315682641",
      "user" : {
         "avatar_url" : "https://avatars4.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Should be closed or rebased. One part of this PR which I think is good and didn't make it in with #10849 was addition of the RPC_WALLET_NOT_FOUND error code.",
      "created_at" : "2017-07-25T16:02:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-317785777",
      "id" : 317785777,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-07-25T16:02:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/317785777",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Closing for now... seems no longer required (or at least controversial).",
      "created_at" : "2017-09-05T22:50:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10650#issuecomment-327325447",
      "id" : 327325447,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10650",
      "updated_at" : "2017-09-05T22:50:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/327325447",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   }
]
