[
   {
      "body" : "ACK concept, and code looks good to me.\r\n\r\nNeeds at least a sketch of a test plan that exercises all of the signals.\r\n",
      "created_at" : "2013-10-20T05:54:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3115#issuecomment-26665663",
      "id" : 26665663,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3115",
      "updated_at" : "2013-10-20T05:54:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/26665663",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/3115#discussion_r7081970"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3115"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7081970"
         }
      },
      "body" : "By declaring the signals as void, we do lose error reporting from the wallets. Not sure this is a big loss, but in case we'd like to keep this, boost::signals2 has various ways of combining the results from the handlers.\r\n",
      "commit_id" : "722fa283d04dfe9c70418e69535a08eea06b4377",
      "created_at" : "2013-10-20T10:07:12Z",
      "diff_hunk" : "@@ -544,16 +544,20 @@ bool CWallet::AddToWalletIfInvolvingMe(const uint256 &hash, const CTransaction&\n     return false;\n }\n \n-bool CWallet::EraseFromWallet(uint256 hash)\n+void CWallet::SyncTransaction(const uint256 &hash, const CTransaction& tx, const CBlock* pblock) {\n+    AddToWalletIfInvolvingMe(hash, tx, pblock, true);\n+}\n+\n+void CWallet::EraseFromWallet(const uint256 &hash)\n {\n     if (!fFileBacked)\n-        return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3115#discussion_r7081970",
      "id" : 7081970,
      "original_commit_id" : "334e15a06d60f90fe78b3d3527bffe6647c584d5",
      "original_position" : 21,
      "path" : "src/wallet.cpp",
      "position" : 21,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3115",
      "updated_at" : "2013-10-26T12:52:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7081970",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Haven't tested yet, but code lookg good and I like the approach.\r\n",
      "created_at" : "2013-10-20T10:07:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3115#issuecomment-26670132",
      "id" : 26670132,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3115",
      "updated_at" : "2013-10-20T10:07:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/26670132",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@laanwj The reasoning is that there are callbacks from the node/validation to the wallet; they're really just notifications in general, as the node code shouldn't care about what the wallet does with it (in fact, the signal names shouldn't contain \"wallet\" even, though I chose not to change them here). As EraseFromWallet was _only_ called as a callback, I just simplified the method here. In the case of AddToWalletIfInvolvingMe (which is called internally inside the wallet as well, with a relevant return code), I added a wrapper to use as signal handler.",
      "created_at" : "2013-10-20T11:35:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3115#issuecomment-26671293",
      "id" : 26671293,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3115",
      "updated_at" : "2013-10-20T11:35:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/26671293",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Ok, thanks, that makes it clear, I was just not sure if it was overlooked or on purpose.\r\n\r\nI like the idea of renaming the signals to be more general (so that theoretically non-wallets could also use the API to keep track)\r\n\r\n    SyncWithWallets -> SyncTransactions\r\n    EraseFromWallets -> EraseTransaction\r\n    SetBestChain -> stays the same\r\n    UpdatedTransaction -> stays the same\r\n    Inventory -> stays the same\r\n    ResendWalletTransactions -> ResendTransactions\r\n",
      "created_at" : "2013-10-20T12:17:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3115#issuecomment-26671932",
      "id" : 26671932,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3115",
      "updated_at" : "2013-10-20T12:17:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/26671932",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@laanwj Modified the signal names a bit, and added comments.",
      "created_at" : "2013-10-20T15:09:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3115#issuecomment-26674796",
      "id" : 26674796,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3115",
      "updated_at" : "2013-10-20T15:09:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/26674796",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Rebased.",
      "created_at" : "2013-10-26T12:56:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3115#issuecomment-27145711",
      "id" : 27145711,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3115",
      "updated_at" : "2013-10-26T12:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27145711",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/722fa283d04dfe9c70418e69535a08eea06b4377 for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\nContact BlueMatt on freenode if something looks broken.",
      "created_at" : "2013-10-26T13:34:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3115#issuecomment-27146331",
      "id" : 27146331,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3115",
      "updated_at" : "2013-10-26T13:34:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27146331",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "body" : "@gavinandresen Test plan:\r\n* Create a transaction in the GUI, and check whether the number of peers that have seen it goes up. This exercises the Inventory signal.\r\n  * Leave the client open until it confirms. This exercises the SyncTransaction signal.\r\n* Every at most 30 minutes, ResendWalletTransactions should be called (LogPrintf'ed). This exercises the Broadcast signal.\r\n* Mine a block yourself, and wait until another on top is mined, while leaving the GUI open. The block's payout should appear only when the second block is mined. This exercises the UpdatedTransaction signal.\r\n* After being fully synchronized, wait for a block whose height is a multiple of 144, and forcibly kill the client. At startup, the automatic rescan shouldn't go back beyond that 144-multiple block. This exercises the SetBestChain signal.\r\n  * Alternatively, do a -reindex, and wait until a block whose height is a multiple of 20160 is crossed, and do the same kill/restart cycle.",
      "created_at" : "2013-10-26T17:49:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3115#issuecomment-27151500",
      "id" : 27151500,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3115",
      "updated_at" : "2013-10-26T17:51:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27151500",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "ACK.  Ran through test plan with a Bitcoin-Qt in regtest mode and two -regtest bitcoind's, all tests passed.\r\n",
      "created_at" : "2013-10-30T01:01:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3115#issuecomment-27357628",
      "id" : 27357628,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3115",
      "updated_at" : "2013-10-30T01:01:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27357628",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   }
]
