[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#24455](https://github.com/bitcoin/bitcoin/pull/24455) (refactor: Split ArgsManager out of util/system by Empact)\n* [#24341](https://github.com/bitcoin/bitcoin/pull/24341) (build: remove some no-longer-needed var unexporting from configure by fanquake)\n* [#23432](https://github.com/bitcoin/bitcoin/pull/23432) (BIP324: CPubKey encode/decode to elligator-squared by dhruv)\n* [#23233](https://github.com/bitcoin/bitcoin/pull/23233) (BIP324: Add encrypted p2p transport {de}serializer by dhruv)\n* [#20196](https://github.com/bitcoin/bitcoin/pull/20196) (net: fix GetListenPort() to derive the proper port by vasild)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-11-21T10:27:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-974790491",
      "id" : 974790491,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23561",
      "node_id" : "IC_kwDOABII5846Gh9b",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/974790491/reactions"
      },
      "updated_at" : "2022-03-02T14:54:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/974790491",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.\r\nMoving forward with BIP324 is a good idea, and this code seems to not have any negative/unexpected side-effects.",
      "created_at" : "2021-11-22T07:14:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-975194275",
      "id" : 975194275,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23561",
      "node_id" : "IC_kwDOABII5846IEij",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/975194275/reactions"
      },
      "updated_at" : "2021-11-22T07:14:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/975194275",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755498657"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755498657"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The case of secp256k1_ecdh returning 0 corresponds to invalid input. That won't happen here; I think you can assert instead and avoid the `std::optional` in the return type.",
      "commit_id" : "00142e1cf85995c15e1990005240ebc9725773e4",
      "created_at" : "2021-11-23T20:58:40Z",
      "diff_hunk" : "@@ -332,6 +333,23 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     return ret;\n }\n \n+std::optional<ECDHSecret> CKey::ComputeECDHSecret(const CPubKey& pubkey) const\n+{\n+    secp256k1_pubkey pubkey_internal;\n+    if (!secp256k1_ec_pubkey_parse(secp256k1_context_sign, &pubkey_internal, pubkey.data(), pubkey.size())) {\n+        return {};\n+    }\n+\n+    ECDHSecret secret;\n+    secret.resize(ECDH_SECRET_SIZE);\n+\n+    if (secp256k1_ecdh(secp256k1_context_sign, secret.data(), &pubkey_internal,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755498657",
      "id" : 755498657,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584tB_6h",
      "original_commit_id" : "2d58b293461c0b8890ce82eb5683c06ff805b85e",
      "original_line" : 346,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/key.cpp",
      "position" : null,
      "pull_request_review_id" : 814167558,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755498657/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-23T21:19:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755498657",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755500261"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755500261"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You could do a much stronger test: take two private keys as input fuzz data, compute the corresponding public keys, and compute the ecdh secrets from (sec1,pub2) and (sec2,pub1), and check that they match.\r\n\r\nIt's cryptographic data (hashes and EC operations), so this is very unlikely to actually uncover any bugs unless they're very apparent, but this way the fuzz test actually verifies the full behavior we desire from these functions.",
      "commit_id" : "00142e1cf85995c15e1990005240ebc9725773e4",
      "created_at" : "2021-11-23T21:01:18Z",
      "diff_hunk" : "@@ -305,4 +305,20 @@ FUZZ_TARGET_INIT(key, initialize_key)\n             assert(key == loaded_key);\n         }\n     }\n+\n+    {\n+        // Test ECDH computation with another key",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755500261",
      "id" : 755500261,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584tCATl",
      "original_commit_id" : "042f771e16f887b1364291bb05b9da9d74c9f45c",
      "original_line" : 310,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/test/fuzz/key.cpp",
      "position" : null,
      "pull_request_review_id" : 814167558,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755500261/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-23T21:19:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755500261",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755501124"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755501124"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nit: pass Spans by value.",
      "commit_id" : "00142e1cf85995c15e1990005240ebc9725773e4",
      "created_at" : "2021-11-23T21:02:47Z",
      "diff_hunk" : "@@ -0,0 +1,32 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_UTIL_BIP324_H\n+#define BITCOIN_UTIL_BIP324_H\n+\n+#include <key.h>\n+#include <span.h>\n+\n+#include <array>\n+\n+constexpr size_t BIP324_KEY_LEN = 32;\n+\n+class BIP324Keys\n+{\n+public:\n+    std::array<uint8_t, BIP324_KEY_LEN> initiator_F; // k1a\n+    std::array<uint8_t, BIP324_KEY_LEN> initiator_V; // k2a\n+    std::array<uint8_t, BIP324_KEY_LEN> responder_F; // k1b\n+    std::array<uint8_t, BIP324_KEY_LEN> responder_V; // k2b\n+    std::array<uint8_t, BIP324_KEY_LEN> session_id;\n+\n+    // Takes ownership of the ECDH secret and wipes the ephemeral secret once\n+    // the derivation is complete.\n+    explicit BIP324Keys(ECDHSecret&& ecdh_secret, const Span<uint8_t>& initiator_hdata, const Span<uint8_t>& responder_hdata);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755501124",
      "id" : 755501124,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584tCAhE",
      "original_commit_id" : "8d09fb5cc213011f59b7abadb0db7cc7a2abb046",
      "original_line" : 26,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "src/util/bip324.h",
      "position" : null,
      "pull_request_review_id" : 814167558,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755501124/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-23T21:19:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755501124",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755505318"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755505318"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm not sure this belongs in util, it seems pretty specific to Bitcoin.",
      "commit_id" : "00142e1cf85995c15e1990005240ebc9725773e4",
      "created_at" : "2021-11-23T21:10:08Z",
      "diff_hunk" : "@@ -0,0 +1,36 @@\n+// Copyright (c) 2021 The Bitcoin Core developers",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755505318",
      "id" : 755505318,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584tCBim",
      "original_commit_id" : "8d09fb5cc213011f59b7abadb0db7cc7a2abb046",
      "original_line" : 1,
      "original_position" : 1,
      "original_start_line" : null,
      "path" : "src/util/bip324.cpp",
      "position" : null,
      "pull_request_review_id" : 814167558,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755505318/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-23T21:19:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755505318",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755510650"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755510650"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Not sure if a class for this is desirable in the first place. These keys shouldn't be long-lived in any case (they're only used to initialize the stream ciphers, and then destroyed). That can just as well be done with a simple function call?",
      "commit_id" : "00142e1cf85995c15e1990005240ebc9725773e4",
      "created_at" : "2021-11-23T21:19:41Z",
      "diff_hunk" : "@@ -0,0 +1,32 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_UTIL_BIP324_H\n+#define BITCOIN_UTIL_BIP324_H\n+\n+#include <key.h>\n+#include <span.h>\n+\n+#include <array>\n+\n+constexpr size_t BIP324_KEY_LEN = 32;\n+\n+class BIP324Keys",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755510650",
      "id" : 755510650,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584tCC16",
      "original_commit_id" : "8d09fb5cc213011f59b7abadb0db7cc7a2abb046",
      "original_line" : 15,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/util/bip324.h",
      "position" : null,
      "pull_request_review_id" : 814167558,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755510650/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-23T21:19:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755510650",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757114972"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757114972"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done - still needed a boolean return value due to the other failure case above.",
      "commit_id" : "00142e1cf85995c15e1990005240ebc9725773e4",
      "created_at" : "2021-11-25T20:24:19Z",
      "diff_hunk" : "@@ -332,6 +333,23 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     return ret;\n }\n \n+std::optional<ECDHSecret> CKey::ComputeECDHSecret(const CPubKey& pubkey) const\n+{\n+    secp256k1_pubkey pubkey_internal;\n+    if (!secp256k1_ec_pubkey_parse(secp256k1_context_sign, &pubkey_internal, pubkey.data(), pubkey.size())) {\n+        return {};\n+    }\n+\n+    ECDHSecret secret;\n+    secret.resize(ECDH_SECRET_SIZE);\n+\n+    if (secp256k1_ecdh(secp256k1_context_sign, secret.data(), &pubkey_internal,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757114972",
      "id" : 757114972,
      "in_reply_to_id" : 755498657,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584tIKhc",
      "original_commit_id" : "2d58b293461c0b8890ce82eb5683c06ff805b85e",
      "original_line" : 346,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/key.cpp",
      "position" : null,
      "pull_request_review_id" : 816282146,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757114972/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-25T20:24:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757114972",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757114984"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757114984"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done!",
      "commit_id" : "00142e1cf85995c15e1990005240ebc9725773e4",
      "created_at" : "2021-11-25T20:24:23Z",
      "diff_hunk" : "@@ -305,4 +305,20 @@ FUZZ_TARGET_INIT(key, initialize_key)\n             assert(key == loaded_key);\n         }\n     }\n+\n+    {\n+        // Test ECDH computation with another key",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757114984",
      "id" : 757114984,
      "in_reply_to_id" : 755500261,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584tIKho",
      "original_commit_id" : "042f771e16f887b1364291bb05b9da9d74c9f45c",
      "original_line" : 310,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/test/fuzz/key.cpp",
      "position" : null,
      "pull_request_review_id" : 816282165,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757114984/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-25T20:24:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757114984",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757115000"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115000"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done.",
      "commit_id" : "00142e1cf85995c15e1990005240ebc9725773e4",
      "created_at" : "2021-11-25T20:24:26Z",
      "diff_hunk" : "@@ -0,0 +1,32 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_UTIL_BIP324_H\n+#define BITCOIN_UTIL_BIP324_H\n+\n+#include <key.h>\n+#include <span.h>\n+\n+#include <array>\n+\n+constexpr size_t BIP324_KEY_LEN = 32;\n+\n+class BIP324Keys\n+{\n+public:\n+    std::array<uint8_t, BIP324_KEY_LEN> initiator_F; // k1a\n+    std::array<uint8_t, BIP324_KEY_LEN> initiator_V; // k2a\n+    std::array<uint8_t, BIP324_KEY_LEN> responder_F; // k1b\n+    std::array<uint8_t, BIP324_KEY_LEN> responder_V; // k2b\n+    std::array<uint8_t, BIP324_KEY_LEN> session_id;\n+\n+    // Takes ownership of the ECDH secret and wipes the ephemeral secret once\n+    // the derivation is complete.\n+    explicit BIP324Keys(ECDHSecret&& ecdh_secret, const Span<uint8_t>& initiator_hdata, const Span<uint8_t>& responder_hdata);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757115000",
      "id" : 757115000,
      "in_reply_to_id" : 755501124,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584tIKh4",
      "original_commit_id" : "8d09fb5cc213011f59b7abadb0db7cc7a2abb046",
      "original_line" : 26,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "src/util/bip324.h",
      "position" : null,
      "pull_request_review_id" : 816282189,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115000/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-25T20:24:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115000",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757115010"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115010"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I moved this into `net.{h|cpp}` as that's where it will be used. I didn't particularly want to increase the length of those files, so please let me know if the right thing to do is to have it in `src/bip324.{h|cpp}`",
      "commit_id" : "00142e1cf85995c15e1990005240ebc9725773e4",
      "created_at" : "2021-11-25T20:24:30Z",
      "diff_hunk" : "@@ -0,0 +1,36 @@\n+// Copyright (c) 2021 The Bitcoin Core developers",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757115010",
      "id" : 757115010,
      "in_reply_to_id" : 755505318,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584tIKiC",
      "original_commit_id" : "8d09fb5cc213011f59b7abadb0db7cc7a2abb046",
      "original_line" : 1,
      "original_position" : 1,
      "original_start_line" : null,
      "path" : "src/util/bip324.cpp",
      "position" : null,
      "pull_request_review_id" : 816282205,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115010/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-25T20:24:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115010",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757115092"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115092"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done.",
      "commit_id" : "00142e1cf85995c15e1990005240ebc9725773e4",
      "created_at" : "2021-11-25T20:24:44Z",
      "diff_hunk" : "@@ -0,0 +1,32 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_UTIL_BIP324_H\n+#define BITCOIN_UTIL_BIP324_H\n+\n+#include <key.h>\n+#include <span.h>\n+\n+#include <array>\n+\n+constexpr size_t BIP324_KEY_LEN = 32;\n+\n+class BIP324Keys",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757115092",
      "id" : 757115092,
      "in_reply_to_id" : 755510650,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584tIKjU",
      "original_commit_id" : "8d09fb5cc213011f59b7abadb0db7cc7a2abb046",
      "original_line" : 15,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/util/bip324.h",
      "position" : null,
      "pull_request_review_id" : 816282312,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115092/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-25T20:24:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115092",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Addressed review comments from @sipa. Ready for further review.",
      "created_at" : "2021-11-25T20:25:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-979455585",
      "id" : 979455585,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23561",
      "node_id" : "IC_kwDOABII5846YU5h",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/979455585/reactions"
      },
      "updated_at" : "2021-11-25T20:25:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/979455585",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r762791112"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762791112"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why snake case for function name `derive_bip324_keys` here?",
      "commit_id" : "00142e1cf85995c15e1990005240ebc9725773e4",
      "created_at" : "2021-12-06T08:31:47Z",
      "diff_hunk" : "@@ -399,6 +401,38 @@ static CAddress GetBindAddress(SOCKET sock)\n     return addr_bind;\n }\n \n+bool derive_bip324_keys(ECDHSecret&& ecdh_secret, const Span<uint8_t> initiator_hdata, const Span<uint8_t> responder_hdata, BIP324Keys& derived_keys)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r762791112",
      "id" : 762791112,
      "line" : 404,
      "node_id" : "PRRC_kwDOABII584td0TI",
      "original_commit_id" : "88185dc13bcb992b2bfef95c7bf12f2efca2d07b",
      "original_line" : 404,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 20,
      "pull_request_review_id" : 823656777,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762791112/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-06T08:31:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762791112",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r762793756"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762793756"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The BIP currently refers to `BitcoinSharedSecret`. I guess to ack this, i'd have to see a new bip :)",
      "commit_id" : "00142e1cf85995c15e1990005240ebc9725773e4",
      "created_at" : "2021-12-06T08:35:55Z",
      "diff_hunk" : "@@ -399,6 +401,38 @@ static CAddress GetBindAddress(SOCKET sock)\n     return addr_bind;\n }\n \n+bool derive_bip324_keys(ECDHSecret&& ecdh_secret, const Span<uint8_t> initiator_hdata, const Span<uint8_t> responder_hdata, BIP324Keys& derived_keys)\n+{\n+    if (ecdh_secret.size() != ECDH_SECRET_SIZE) {\n+        return false;\n+    }\n+\n+    std::string salt{\"bitcoin_v2_shared_secret\"};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r762793756",
      "id" : 762793756,
      "line" : 410,
      "node_id" : "PRRC_kwDOABII584td08c",
      "original_commit_id" : "88185dc13bcb992b2bfef95c7bf12f2efca2d07b",
      "original_line" : 410,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 26,
      "pull_request_review_id" : 823660440,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762793756/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-06T08:35:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762793756",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r765397863"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765397863"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : ":) I am working on re-structuring it. It's close. Will keep you updated here.",
      "commit_id" : "e3143a97aacf7ec43b2d4897f43da305491e35c2",
      "created_at" : "2021-12-09T02:58:59Z",
      "diff_hunk" : "@@ -399,6 +401,38 @@ static CAddress GetBindAddress(SOCKET sock)\n     return addr_bind;\n }\n \n+bool derive_bip324_keys(ECDHSecret&& ecdh_secret, const Span<uint8_t> initiator_hdata, const Span<uint8_t> responder_hdata, BIP324Keys& derived_keys)\n+{\n+    if (ecdh_secret.size() != ECDH_SECRET_SIZE) {\n+        return false;\n+    }\n+\n+    std::string salt{\"bitcoin_v2_shared_secret\"};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r765397863",
      "id" : 765397863,
      "in_reply_to_id" : 762793756,
      "line" : 411,
      "node_id" : "PRRC_kwDOABII584tnwtn",
      "original_commit_id" : "88185dc13bcb992b2bfef95c7bf12f2efca2d07b",
      "original_line" : 411,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 26,
      "pull_request_review_id" : 827156754,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765397863/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-09T02:58:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765397863",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Addressed comments; Rebased with master to incorporate #23413. I am still investigating CI failures which seem like a timeout on Cirrus CI but re-running hasn't helped (other recent open PRs seem to be seeing this error as well). Meanwhile, ready for further review.",
      "created_at" : "2021-12-09T03:02:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-989463355",
      "id" : 989463355,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23561",
      "node_id" : "IC_kwDOABII5846-gM7",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989463355/reactions"
      },
      "updated_at" : "2021-12-09T03:05:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989463355",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r765399130"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765399130"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Oh oops. I don't know why I did that. Updated.",
      "commit_id" : "e3143a97aacf7ec43b2d4897f43da305491e35c2",
      "created_at" : "2021-12-09T03:02:56Z",
      "diff_hunk" : "@@ -399,6 +401,38 @@ static CAddress GetBindAddress(SOCKET sock)\n     return addr_bind;\n }\n \n+bool derive_bip324_keys(ECDHSecret&& ecdh_secret, const Span<uint8_t> initiator_hdata, const Span<uint8_t> responder_hdata, BIP324Keys& derived_keys)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r765399130",
      "id" : 765399130,
      "in_reply_to_id" : 762791112,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584tnxBa",
      "original_commit_id" : "88185dc13bcb992b2bfef95c7bf12f2efca2d07b",
      "original_line" : 404,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 827158496,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765399130/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-09T03:02:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765399130",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-12-18T07:51:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-997165305",
      "id" : 997165305,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23561",
      "node_id" : "IC_kwDOABII5847b4j5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/997165305/reactions"
      },
      "updated_at" : "2021-12-18T07:51:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/997165305",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased against master. Ready for further review.",
      "created_at" : "2022-01-22T02:27:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1019020541",
      "id" : 1019020541,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23561",
      "node_id" : "IC_kwDOABII5848vQT9",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019020541/reactions"
      },
      "updated_at" : "2022-01-22T02:27:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019020541",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r800467052"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/800467052"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: if you rebase this at some point, might as well update this",
      "commit_id" : "773cbc93b102a87a3ec8f852e7aca595489222a7",
      "created_at" : "2022-02-07T09:34:54Z",
      "diff_hunk" : "@@ -0,0 +1,30 @@\n+// Copyright (c) 2021 The Bitcoin Core developers",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r800467052",
      "id" : 800467052,
      "line" : 1,
      "node_id" : "PRRC_kwDOABII584vtihs",
      "original_commit_id" : "773cbc93b102a87a3ec8f852e7aca595489222a7",
      "original_line" : 1,
      "original_position" : 1,
      "original_start_line" : null,
      "path" : "src/bench/ecdh.cpp",
      "position" : 1,
      "pull_request_review_id" : 874403910,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/800467052/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-07T09:38:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/800467052",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6443210?v=4",
         "events_url" : "https://api.github.com/users/PastaPastaPasta/events{/privacy}",
         "followers_url" : "https://api.github.com/users/PastaPastaPasta/followers",
         "following_url" : "https://api.github.com/users/PastaPastaPasta/following{/other_user}",
         "gists_url" : "https://api.github.com/users/PastaPastaPasta/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/PastaPastaPasta",
         "id" : 6443210,
         "login" : "PastaPastaPasta",
         "node_id" : "MDQ6VXNlcjY0NDMyMTA=",
         "organizations_url" : "https://api.github.com/users/PastaPastaPasta/orgs",
         "received_events_url" : "https://api.github.com/users/PastaPastaPasta/received_events",
         "repos_url" : "https://api.github.com/users/PastaPastaPasta/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/PastaPastaPasta/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/PastaPastaPasta/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/PastaPastaPasta"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-03-03T14:28:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-1058096793",
      "id" : 1058096793,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23561",
      "node_id" : "IC_kwDOABII584_EUaZ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1058096793/reactions"
      },
      "updated_at" : "2022-03-03T14:28:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1058096793",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   }
]
