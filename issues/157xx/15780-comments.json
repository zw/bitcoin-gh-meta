[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273788021"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273788021"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`4 * sizeof(bool)` -- sizeof(bool) is not required by the standard to be 1. (And even though that would be stupid, the standard is pretty explicit about it.)\r\n\r\nOr perhaps instead, more typesafe / c++ style: `std::fill(std::begin(m_cached), std::end(m_cached), false);`, which I have not tested. This version would also fix the need for the constant \"4\" here.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-10T04:46:11Z",
      "diff_hunk" : "@@ -16,15 +16,31 @@ class CScript;\n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    bool m_cached[4] = {0,0,0,0};\n+    CAmount m_value[4];\n+    void Reset()\n+    {\n+        memset(m_cached, 0, 4);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273788021",
      "id" : 273788021,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3Mzc4ODAyMQ==",
      "original_commit_id" : "17d2688093faf875c9830590044d8b685f794f2d",
      "original_position" : 25,
      "path" : "src/script/ismine.h",
      "position" : null,
      "pull_request_review_id" : 224757553,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273788021",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273790209"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273790209"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I know that various people have different feelings about this practice, but invocations would be more readable and less error-prone if `bool credit` were an `enum class` of `CREDIT` or `DEBIT`.\r\n\r\n(I feel less strongly about `recalculate` because it's unambiguous which direction is \"off\" vs \"on\", and it defaults to \"off\".)\r\n\r\nIn fact, better still -- since any given `CachableAccount` is either credit or debit, why not have the account carry the flag, and remove the error-proneness of passing it by hand entirely?",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-10T05:02:10Z",
      "diff_hunk" : "@@ -1924,33 +1924,25 @@ std::set<uint256> CWalletTx::GetConflicts() const\n     return result;\n }\n \n+CAmount CWalletTx::GetCachable(CachableAccount& acct, bool credit, const isminefilter& filter, bool recalculate) const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273790209",
      "id" : 273790209,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3Mzc5MDIwOQ==",
      "original_commit_id" : "17d2688093faf875c9830590044d8b685f794f2d",
      "original_position" : 4,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 224757553,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273790209",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273790539"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273790539"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I know it seems obvious now, but it would probably help future readers a bit to comment the fact that these correspond to the four values of `isminetype`. (Or you could add `ISMINE_ENUM_ELEMENTS` or the like and use that instead of the constant 4.)\r\n\r\nIn fact, actually, after studying the code -- we aren't really using a bitfield of IsMine types here. Only ISMINE_SPENDABLE and ISMINE_WATCHONLY are valid. Neither ISMINE_NO nor ISMINE_ALL are things we would ever want to cache here. Although I see that in #13756 you are maybe making more use of the fact that this is a bitfield, and I haven't read that one, so I assume that informs your choices here.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-10T05:04:37Z",
      "diff_hunk" : "@@ -16,15 +16,31 @@ class CScript;\n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    bool m_cached[4] = {0,0,0,0};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273790539",
      "id" : 273790539,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3Mzc5MDUzOQ==",
      "original_commit_id" : "17d2688093faf875c9830590044d8b685f794f2d",
      "original_position" : 21,
      "path" : "src/script/ismine.h",
      "position" : null,
      "pull_request_review_id" : 224757553,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273790539",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273791560"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273791560"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The old code appears to always store into the cache, as long as `filter` is `ISMINE_SPENDABLE` or `ISMINE_WATCHONLY`, regardless of the value of `fUseCache`.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-10T05:11:31Z",
      "diff_hunk" : "@@ -2038,22 +2004,20 @@ CAmount CWalletTx::GetAvailableCredit(interfaces::Chain::Lock& locked_chain, boo\n         }\n     }\n \n-    if (cache) {\n-        *cache = nCredit;\n-        assert(cache_used);\n-        *cache_used = true;\n+    if (fUseCache) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273791560",
      "id" : 273791560,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3Mzc5MTU2MA==",
      "original_commit_id" : "17d2688093faf875c9830590044d8b685f794f2d",
      "original_position" : 131,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 224757553,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273791560",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273792224"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273792224"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I don't know this code well enough to speak to the existing semantics of it. But it seems like, in the old code, `GetCredit` and `GetAvailableCredit` had separate caches, whereas now they share one.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-10T05:16:15Z",
      "diff_hunk" : "@@ -2006,23 +1981,14 @@ CAmount CWalletTx::GetAvailableCredit(interfaces::Chain::Lock& locked_chain, boo\n     if (pwallet == nullptr)\n         return 0;\n \n+    fUseCache &= filter == ISMINE_SPENDABLE || filter == ISMINE_WATCH_ONLY;\n+\n     // Must wait until coinbase is safely deep enough in the chain before valuing it\n     if (IsImmatureCoinBase(locked_chain))\n         return 0;\n \n-    CAmount* cache = nullptr;\n-    bool* cache_used = nullptr;\n-\n-    if (filter == ISMINE_SPENDABLE) {\n-        cache = &nAvailableCreditCached;\n-        cache_used = &fAvailableCreditCached;\n-    } else if (filter == ISMINE_WATCH_ONLY) {\n-        cache = &nAvailableWatchCreditCached;\n-        cache_used = &fAvailableWatchCreditCached;\n-    }\n-\n-    if (fUseCache && cache_used && *cache_used) {\n-        return *cache;\n+    if (fUseCache && m_credit.m_cached[filter]) {\n+        return m_credit.m_value[filter];",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273792224",
      "id" : 273792224,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3Mzc5MjIyNA==",
      "original_commit_id" : "17d2688093faf875c9830590044d8b685f794f2d",
      "original_position" : 119,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 224757553,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273792224",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273811159"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273811159"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, there is a tiny bit of waste due to ISMINE_NO and _ALL, and yep I am preparing to use this more extensively for the avoid_reuse feature in #13756. I could make a \"bridge\" that makes use of these more efficiently, but I kind of enjoy the simplicity of the direct mapping.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-10T06:51:35Z",
      "diff_hunk" : "@@ -16,15 +16,31 @@ class CScript;\n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    bool m_cached[4] = {0,0,0,0};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273811159",
      "id" : 273811159,
      "in_reply_to_id" : 273790539,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MzgxMTE1OQ==",
      "original_commit_id" : "17d2688093faf875c9830590044d8b685f794f2d",
      "original_position" : 21,
      "path" : "src/script/ismine.h",
      "position" : null,
      "pull_request_review_id" : 224785715,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273811159",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273811589"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273811589"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oh, you're right. Good catch.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-10T06:53:09Z",
      "diff_hunk" : "@@ -2038,22 +2004,20 @@ CAmount CWalletTx::GetAvailableCredit(interfaces::Chain::Lock& locked_chain, boo\n         }\n     }\n \n-    if (cache) {\n-        *cache = nCredit;\n-        assert(cache_used);\n-        *cache_used = true;\n+    if (fUseCache) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273811589",
      "id" : 273811589,
      "in_reply_to_id" : 273791560,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MzgxMTU4OQ==",
      "original_commit_id" : "17d2688093faf875c9830590044d8b685f794f2d",
      "original_position" : 131,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 224786256,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273811589",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273812282"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273812282"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yep, you're correct! Fixing.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-10T06:55:35Z",
      "diff_hunk" : "@@ -2006,23 +1981,14 @@ CAmount CWalletTx::GetAvailableCredit(interfaces::Chain::Lock& locked_chain, boo\n     if (pwallet == nullptr)\n         return 0;\n \n+    fUseCache &= filter == ISMINE_SPENDABLE || filter == ISMINE_WATCH_ONLY;\n+\n     // Must wait until coinbase is safely deep enough in the chain before valuing it\n     if (IsImmatureCoinBase(locked_chain))\n         return 0;\n \n-    CAmount* cache = nullptr;\n-    bool* cache_used = nullptr;\n-\n-    if (filter == ISMINE_SPENDABLE) {\n-        cache = &nAvailableCreditCached;\n-        cache_used = &fAvailableCreditCached;\n-    } else if (filter == ISMINE_WATCH_ONLY) {\n-        cache = &nAvailableWatchCreditCached;\n-        cache_used = &fAvailableWatchCreditCached;\n-    }\n-\n-    if (fUseCache && cache_used && *cache_used) {\n-        return *cache;\n+    if (fUseCache && m_credit.m_cached[filter]) {\n+        return m_credit.m_value[filter];",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273812282",
      "id" : 273812282,
      "in_reply_to_id" : 273792224,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MzgxMjI4Mg==",
      "original_commit_id" : "17d2688093faf875c9830590044d8b685f794f2d",
      "original_position" : 119,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 224787077,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273812282",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273817178"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273817178"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Great idea, done.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-10T07:11:31Z",
      "diff_hunk" : "@@ -1924,33 +1924,25 @@ std::set<uint256> CWalletTx::GetConflicts() const\n     return result;\n }\n \n+CAmount CWalletTx::GetCachable(CachableAccount& acct, bool credit, const isminefilter& filter, bool recalculate) const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273817178",
      "id" : 273817178,
      "in_reply_to_id" : 273790209,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MzgxNzE3OA==",
      "original_commit_id" : "17d2688093faf875c9830590044d8b685f794f2d",
      "original_position" : 4,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 224792687,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273817178",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273817321"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273817321"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should add that I adopted the `ISMINE_ENUM_ELEMENTS` idea.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-10T07:12:03Z",
      "diff_hunk" : "@@ -16,15 +16,31 @@ class CScript;\n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    bool m_cached[4] = {0,0,0,0};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273817321",
      "id" : 273817321,
      "in_reply_to_id" : 273790539,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MzgxNzMyMQ==",
      "original_commit_id" : "17d2688093faf875c9830590044d8b685f794f2d",
      "original_position" : 21,
      "path" : "src/script/ismine.h",
      "position" : null,
      "pull_request_review_id" : 224792869,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273817321",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@gwillen Thank you for reviewing! I have addressed your comments, I believe.",
      "created_at" : "2019-04-10T07:12:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#issuecomment-481564153",
      "id" : 481564153,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15780",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MTU2NDE1Mw==",
      "updated_at" : "2019-04-10T07:12:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/481564153",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#15778](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15778.html) ([wallet] Move maxtxfee from node to wallet by jnewbery)\n* [#13756](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/13756.html) (wallet: \"avoid_reuse\" wallet flag for improved privacy by kallewoof)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-04-10T07:21:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#issuecomment-481567105",
      "id" : 481567105,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15780",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MTU2NzEwNQ==",
      "updated_at" : "2019-04-11T18:01:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/481567105",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273827890"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273827890"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I may be wrong but I think you can drop ` = ISMINE_ALL + 1`.\r\n\r\nnit, either align all `=` or none?",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-10T07:45:38Z",
      "diff_hunk" : "@@ -16,15 +16,40 @@ class CScript;\n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS = ISMINE_ALL + 1,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273827890",
      "id" : 273827890,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MzgyNzg5MA==",
      "original_commit_id" : "5b4ba107130a9cd54d954044d2766d1a068dea22",
      "original_position" : 12,
      "path" : "src/script/ismine.h",
      "position" : null,
      "pull_request_review_id" : 224806175,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273827890",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273829008"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273829008"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, `m_cached` could be an `int`, or better `std::bitset`.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-10T07:49:00Z",
      "diff_hunk" : "@@ -16,15 +16,40 @@ class CScript;\n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS = ISMINE_ALL + 1,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    enum Type {\n+        CREDIT,\n+        DEBIT,\n+    } m_type{CREDIT};\n+    bool m_cached[ISMINE_ENUM_ELEMENTS];",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r273829008",
      "id" : 273829008,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MzgyOTAwOA==",
      "original_commit_id" : "5b4ba107130a9cd54d954044d2766d1a068dea22",
      "original_position" : 26,
      "path" : "src/script/ismine.h",
      "position" : null,
      "pull_request_review_id" : 224807583,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/273829008",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK! this groups similar functionality together making it, overall, easier to understand.\r\nI was afraid for a bit with the word \"accounts\" though (having just finally deprecated that).",
      "created_at" : "2019-04-10T08:50:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#issuecomment-481601221",
      "id" : 481601221,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15780",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MTYwMTIyMQ==",
      "updated_at" : "2019-04-10T08:51:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/481601221",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for review @promag. I believe I addressed all your comments.",
      "created_at" : "2019-04-10T09:36:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#issuecomment-481617750",
      "id" : 481617750,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15780",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MTYxNzc1MA==",
      "updated_at" : "2019-04-10T09:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/481617750",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@laanwj Maybe I should have picked a different name! I think \"account\" works in this case, though... :)",
      "created_at" : "2019-04-10T09:37:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#issuecomment-481618178",
      "id" : 481618178,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15780",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MTYxODE3OA==",
      "updated_at" : "2019-04-10T09:37:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/481618178",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> @laanwj Maybe I should have picked a different name! I think \"account\" works in this case, though... :)\r\n\r\nYes to be clear it was not a suggestion to change it  :slightly_smiling_face:  Would only have been a potential concern if it would end up in the RPC API.",
      "created_at" : "2019-04-10T12:11:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#issuecomment-481664474",
      "id" : 481664474,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15780",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MTY2NDQ3NA==",
      "updated_at" : "2019-04-10T12:11:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/481664474",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "utACK 3b9a9a4",
      "created_at" : "2019-04-10T21:13:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#issuecomment-481867502",
      "id" : 481867502,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15780",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MTg2NzUwMg==",
      "updated_at" : "2019-04-10T21:13:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/481867502",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r274336507"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274336507"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Add `explicit`. I'd remove ` = CREDIT`.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-11T09:29:32Z",
      "diff_hunk" : "@@ -9,22 +9,48 @@\n #include <script/standard.h>\n \n #include <stdint.h>\n+#include <bitset>\n \n class CKeyStore;\n class CScript;\n \n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL        = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    enum Type {\n+        CREDIT,\n+        DEBIT,\n+    } m_type{CREDIT};\n+    std::bitset<ISMINE_ENUM_ELEMENTS> m_cached;\n+    CAmount m_value[ISMINE_ENUM_ELEMENTS];\n+    CachableAccount(Type type = CREDIT) : m_type(type)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r274336507",
      "id" : 274336507,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDMzNjUwNw==",
      "original_commit_id" : "3b9a9a44f0945cc05d63a3cc3c3a917a6726b38f",
      "original_position" : 36,
      "path" : "src/script/ismine.h",
      "position" : null,
      "pull_request_review_id" : 225424546,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274336507",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r274336626"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274336626"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Remove, it is initialized in the constructor. Also, should be const.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-11T09:29:53Z",
      "diff_hunk" : "@@ -9,22 +9,48 @@\n #include <script/standard.h>\n \n #include <stdint.h>\n+#include <bitset>\n \n class CKeyStore;\n class CScript;\n \n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL        = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    enum Type {\n+        CREDIT,\n+        DEBIT,\n+    } m_type{CREDIT};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r274336626",
      "id" : 274336626,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDMzNjYyNg==",
      "original_commit_id" : "3b9a9a44f0945cc05d63a3cc3c3a917a6726b38f",
      "original_position" : 33,
      "path" : "src/script/ismine.h",
      "position" : null,
      "pull_request_review_id" : 225424546,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274336626",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r274337089"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274337089"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`std::bitset` is already initialized with zeros.\r\n",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-11T09:31:07Z",
      "diff_hunk" : "@@ -9,22 +9,48 @@\n #include <script/standard.h>\n \n #include <stdint.h>\n+#include <bitset>\n \n class CKeyStore;\n class CScript;\n \n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL        = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    enum Type {\n+        CREDIT,\n+        DEBIT,\n+    } m_type{CREDIT};\n+    std::bitset<ISMINE_ENUM_ELEMENTS> m_cached;\n+    CAmount m_value[ISMINE_ENUM_ELEMENTS];\n+    CachableAccount(Type type = CREDIT) : m_type(type)\n+    {\n+        Reset();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r274337089",
      "id" : 274337089,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDMzNzA4OQ==",
      "original_commit_id" : "3b9a9a44f0945cc05d63a3cc3c3a917a6726b38f",
      "original_position" : 38,
      "path" : "src/script/ismine.h",
      "position" : null,
      "pull_request_review_id" : 225424546,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274337089",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r274337396"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274337396"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't see a reason to pass enum values by const reference? (despite the fact there's some occurrences in the code).",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-11T09:31:53Z",
      "diff_hunk" : "@@ -9,22 +9,48 @@\n #include <script/standard.h>\n \n #include <stdint.h>\n+#include <bitset>\n \n class CKeyStore;\n class CScript;\n \n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL        = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    enum Type {\n+        CREDIT,\n+        DEBIT,\n+    } m_type{CREDIT};\n+    std::bitset<ISMINE_ENUM_ELEMENTS> m_cached;\n+    CAmount m_value[ISMINE_ENUM_ELEMENTS];\n+    CachableAccount(Type type = CREDIT) : m_type(type)\n+    {\n+        Reset();\n+    }\n+    void Reset()\n+    {\n+        m_cached.reset();\n+    }\n+    CachableAccount& Set(const isminefilter& filter, CAmount value)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r274337396",
      "id" : 274337396,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDMzNzM5Ng==",
      "original_commit_id" : "3b9a9a44f0945cc05d63a3cc3c3a917a6726b38f",
      "original_position" : 44,
      "path" : "src/script/ismine.h",
      "position" : null,
      "pull_request_review_id" : 225424546,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274337396",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r274338285"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274338285"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't see the return value being used so I'd drop it.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-11T09:34:00Z",
      "diff_hunk" : "@@ -9,22 +9,48 @@\n #include <script/standard.h>\n \n #include <stdint.h>\n+#include <bitset>\n \n class CKeyStore;\n class CScript;\n \n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL        = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    enum Type {\n+        CREDIT,\n+        DEBIT,\n+    } m_type{CREDIT};\n+    std::bitset<ISMINE_ENUM_ELEMENTS> m_cached;\n+    CAmount m_value[ISMINE_ENUM_ELEMENTS];\n+    CachableAccount(Type type = CREDIT) : m_type(type)\n+    {\n+        Reset();\n+    }\n+    void Reset()\n+    {\n+        m_cached.reset();\n+    }\n+    CachableAccount& Set(const isminefilter& filter, CAmount value)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r274338285",
      "id" : 274338285,
      "in_reply_to_id" : 274337396,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDMzODI4NQ==",
      "original_commit_id" : "3b9a9a44f0945cc05d63a3cc3c3a917a6726b38f",
      "original_position" : 44,
      "path" : "src/script/ismine.h",
      "position" : null,
      "pull_request_review_id" : 225424546,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274338285",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r274426928"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274426928"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Could be an `enum class`?",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-11T13:38:27Z",
      "diff_hunk" : "@@ -9,22 +9,48 @@\n #include <script/standard.h>\n \n #include <stdint.h>\n+#include <bitset>\n \n class CKeyStore;\n class CScript;\n \n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL        = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    enum Type {\n+        CREDIT,\n+        DEBIT,\n+    } m_type{CREDIT};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r274426928",
      "id" : 274426928,
      "in_reply_to_id" : 274336626,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDQyNjkyOA==",
      "original_commit_id" : "3b9a9a44f0945cc05d63a3cc3c3a917a6726b38f",
      "original_position" : 33,
      "path" : "src/script/ismine.h",
      "position" : null,
      "pull_request_review_id" : 225540152,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274426928",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@promag @MarcoFalke Thank you for the review! I believe I addressed all your feedback.",
      "created_at" : "2019-04-11T14:34:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#issuecomment-482140060",
      "id" : 482140060,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15780",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MjE0MDA2MA==",
      "updated_at" : "2019-04-11T14:34:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/482140060",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r274460474"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274460474"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Made `enum class` but not `const`. It doesn't look like 'const enum class' ever occurs anywhere else, so assuming it's not a thing you do..",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-11T14:44:41Z",
      "diff_hunk" : "@@ -9,22 +9,48 @@\n #include <script/standard.h>\n \n #include <stdint.h>\n+#include <bitset>\n \n class CKeyStore;\n class CScript;\n \n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL        = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    enum Type {\n+        CREDIT,\n+        DEBIT,\n+    } m_type{CREDIT};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r274460474",
      "id" : 274460474,
      "in_reply_to_id" : 274336626,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDQ2MDQ3NA==",
      "original_commit_id" : "3b9a9a44f0945cc05d63a3cc3c3a917a6726b38f",
      "original_position" : 33,
      "path" : "src/script/ismine.h",
      "position" : null,
      "pull_request_review_id" : 225583500,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274460474",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r274465350"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274465350"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I mean `... const m_type`, meaning it can't change after initialization.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-11T14:53:27Z",
      "diff_hunk" : "@@ -9,22 +9,48 @@\n #include <script/standard.h>\n \n #include <stdint.h>\n+#include <bitset>\n \n class CKeyStore;\n class CScript;\n \n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL        = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    enum Type {\n+        CREDIT,\n+        DEBIT,\n+    } m_type{CREDIT};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r274465350",
      "id" : 274465350,
      "in_reply_to_id" : 274336626,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDQ2NTM1MA==",
      "original_commit_id" : "3b9a9a44f0945cc05d63a3cc3c3a917a6726b38f",
      "original_position" : 33,
      "path" : "src/script/ismine.h",
      "position" : null,
      "pull_request_review_id" : 225589318,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274465350",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r274474278"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274474278"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ah, I see.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-11T15:10:11Z",
      "diff_hunk" : "@@ -9,22 +9,48 @@\n #include <script/standard.h>\n \n #include <stdint.h>\n+#include <bitset>\n \n class CKeyStore;\n class CScript;\n \n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL        = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    enum Type {\n+        CREDIT,\n+        DEBIT,\n+    } m_type{CREDIT};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r274474278",
      "id" : 274474278,
      "in_reply_to_id" : 274336626,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDQ3NDI3OA==",
      "original_commit_id" : "3b9a9a44f0945cc05d63a3cc3c3a917a6726b38f",
      "original_position" : 33,
      "path" : "src/script/ismine.h",
      "position" : null,
      "pull_request_review_id" : 225600565,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274474278",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275149367"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275149367"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, use http://www.cplusplus.com/reference/bitset/bitset/set/:\r\n```cpp\r\nm_cached.set(filter)\r\n```\r\n",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-14T10:09:26Z",
      "diff_hunk" : "@@ -9,22 +9,44 @@\n #include <script/standard.h>\n \n #include <stdint.h>\n+#include <bitset>\n \n class CKeyStore;\n class CScript;\n \n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL        = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    enum class Type : uint8_t {\n+        CREDIT,\n+        DEBIT,\n+    } const m_type;\n+    std::bitset<ISMINE_ENUM_ELEMENTS> m_cached;\n+    CAmount m_value[ISMINE_ENUM_ELEMENTS];\n+    explicit CachableAccount(Type type) : m_type(type) {}\n+    void Reset()\n+    {\n+        m_cached.reset();\n+    }\n+    void Set(isminefilter filter, CAmount value)\n+    {\n+        m_cached[filter] = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275149367",
      "id" : 275149367,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTE0OTM2Nw==",
      "original_commit_id" : "fda0ade00739f30bdfa9d576371a350c1c4ade5f",
      "original_position" : 43,
      "path" : "src/script/ismine.h",
      "position" : null,
      "pull_request_review_id" : 226387825,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275149367",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275149451"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275149451"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Since `CachableAccount` members are public you could ditch `Reset` and call `m_cached.reset()` directly. Otherwise you could make members private and add `IsCached()`,  `Get()` and `Type()` accessors.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-14T10:11:37Z",
      "diff_hunk" : "@@ -9,22 +9,44 @@\n #include <script/standard.h>\n \n #include <stdint.h>\n+#include <bitset>\n \n class CKeyStore;\n class CScript;\n \n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL        = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    enum class Type : uint8_t {\n+        CREDIT,\n+        DEBIT,\n+    } const m_type;\n+    std::bitset<ISMINE_ENUM_ELEMENTS> m_cached;\n+    CAmount m_value[ISMINE_ENUM_ELEMENTS];\n+    explicit CachableAccount(Type type) : m_type(type) {}\n+    void Reset()\n+    {\n+        m_cached.reset();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275149451",
      "id" : 275149451,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTE0OTQ1MQ==",
      "original_commit_id" : "fda0ade00739f30bdfa9d576371a350c1c4ade5f",
      "original_position" : 39,
      "path" : "src/script/ismine.h",
      "position" : 39,
      "pull_request_review_id" : 226387825,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275149451",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275182736"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275182736"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think leaving it public is ok, but I can be convinced to make it private. For now, I made `Reset` inline, which basically has the same effect as what you are suggesting without exposing too many innards.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-15T00:36:36Z",
      "diff_hunk" : "@@ -9,22 +9,44 @@\n #include <script/standard.h>\n \n #include <stdint.h>\n+#include <bitset>\n \n class CKeyStore;\n class CScript;\n \n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL        = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    enum class Type : uint8_t {\n+        CREDIT,\n+        DEBIT,\n+    } const m_type;\n+    std::bitset<ISMINE_ENUM_ELEMENTS> m_cached;\n+    CAmount m_value[ISMINE_ENUM_ELEMENTS];\n+    explicit CachableAccount(Type type) : m_type(type) {}\n+    void Reset()\n+    {\n+        m_cached.reset();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275182736",
      "id" : 275182736,
      "in_reply_to_id" : 275149451,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTE4MjczNg==",
      "original_commit_id" : "fda0ade00739f30bdfa9d576371a350c1c4ade5f",
      "original_position" : 39,
      "path" : "src/script/ismine.h",
      "position" : 39,
      "pull_request_review_id" : 226422791,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275182736",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275224904"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275224904"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why not simplify to just `return GetCachable(m_credit_immature, ISMINE_SPENDABLE, !fUseCache);`? (same in `GetImmatureWatchOnlyCredit`)",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-15T06:51:55Z",
      "diff_hunk" : "@@ -1962,40 +1954,23 @@ CAmount CWalletTx::GetCredit(interfaces::Chain::Lock& locked_chain, const ismine\n         return 0;\n \n     CAmount credit = 0;\n-    if (filter & ISMINE_SPENDABLE)\n-    {\n+    if (filter & ISMINE_SPENDABLE) {\n         // GetBalance can assume transactions in mapWallet won't change\n-        if (fCreditCached)\n-            credit += nCreditCached;\n-        else\n-        {\n-            nCreditCached = pwallet->GetCredit(*tx, ISMINE_SPENDABLE);\n-            fCreditCached = true;\n-            credit += nCreditCached;\n-        }\n+        credit += GetCachable(m_credit, ISMINE_SPENDABLE);\n     }\n-    if (filter & ISMINE_WATCH_ONLY)\n-    {\n-        if (fWatchCreditCached)\n-            credit += nWatchCreditCached;\n-        else\n-        {\n-            nWatchCreditCached = pwallet->GetCredit(*tx, ISMINE_WATCH_ONLY);\n-            fWatchCreditCached = true;\n-            credit += nWatchCreditCached;\n-        }\n+    if (filter & ISMINE_WATCH_ONLY) {\n+        credit += GetCachable(m_credit, ISMINE_WATCH_ONLY);\n     }\n     return credit;\n }\n \n CAmount CWalletTx::GetImmatureCredit(interfaces::Chain::Lock& locked_chain, bool fUseCache) const\n {\n     if (IsImmatureCoinBase(locked_chain) && IsInMainChain(locked_chain)) {\n-        if (fUseCache && fImmatureCreditCached)\n-            return nImmatureCreditCached;\n-        nImmatureCreditCached = pwallet->GetCredit(*tx, ISMINE_SPENDABLE);\n-        fImmatureCreditCached = true;\n-        return nImmatureCreditCached;\n+        if (fUseCache && m_credit_immature.m_cached[ISMINE_SPENDABLE]) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275224904",
      "id" : 275224904,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTIyNDkwNA==",
      "original_commit_id" : "1603501eaa6b292b3dc75e96836568ecc7cc73f6",
      "original_position" : 88,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 226475411,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275224904",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/meshcollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/meshcollider/followers",
         "following_url" : "https://api.github.com/users/meshcollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/meshcollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/meshcollider",
         "id" : 3211283,
         "login" : "meshcollider",
         "node_id" : "MDQ6VXNlcjMyMTEyODM=",
         "organizations_url" : "https://api.github.com/users/meshcollider/orgs",
         "received_events_url" : "https://api.github.com/users/meshcollider/received_events",
         "repos_url" : "https://api.github.com/users/meshcollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/meshcollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/meshcollider"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275228819"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275228819"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good point! Fixed.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-15T07:08:58Z",
      "diff_hunk" : "@@ -1962,40 +1954,23 @@ CAmount CWalletTx::GetCredit(interfaces::Chain::Lock& locked_chain, const ismine\n         return 0;\n \n     CAmount credit = 0;\n-    if (filter & ISMINE_SPENDABLE)\n-    {\n+    if (filter & ISMINE_SPENDABLE) {\n         // GetBalance can assume transactions in mapWallet won't change\n-        if (fCreditCached)\n-            credit += nCreditCached;\n-        else\n-        {\n-            nCreditCached = pwallet->GetCredit(*tx, ISMINE_SPENDABLE);\n-            fCreditCached = true;\n-            credit += nCreditCached;\n-        }\n+        credit += GetCachable(m_credit, ISMINE_SPENDABLE);\n     }\n-    if (filter & ISMINE_WATCH_ONLY)\n-    {\n-        if (fWatchCreditCached)\n-            credit += nWatchCreditCached;\n-        else\n-        {\n-            nWatchCreditCached = pwallet->GetCredit(*tx, ISMINE_WATCH_ONLY);\n-            fWatchCreditCached = true;\n-            credit += nWatchCreditCached;\n-        }\n+    if (filter & ISMINE_WATCH_ONLY) {\n+        credit += GetCachable(m_credit, ISMINE_WATCH_ONLY);\n     }\n     return credit;\n }\n \n CAmount CWalletTx::GetImmatureCredit(interfaces::Chain::Lock& locked_chain, bool fUseCache) const\n {\n     if (IsImmatureCoinBase(locked_chain) && IsInMainChain(locked_chain)) {\n-        if (fUseCache && fImmatureCreditCached)\n-            return nImmatureCreditCached;\n-        nImmatureCreditCached = pwallet->GetCredit(*tx, ISMINE_SPENDABLE);\n-        fImmatureCreditCached = true;\n-        return nImmatureCreditCached;\n+        if (fUseCache && m_credit_immature.m_cached[ISMINE_SPENDABLE]) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275228819",
      "id" : 275228819,
      "in_reply_to_id" : 275224904,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTIyODgxOQ==",
      "original_commit_id" : "1603501eaa6b292b3dc75e96836568ecc7cc73f6",
      "original_position" : 88,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 226480481,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275228819",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 18f23ae0c5599f2246e58e5293f7426471b73e9c, only change is to use `GetCachable` in `GetImmatureCredit` and \r\n GetImmatureWatchOnlyCredit`.",
      "created_at" : "2019-04-15T07:16:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#issuecomment-483135455",
      "id" : 483135455,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15780",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MzEzNTQ1NQ==",
      "updated_at" : "2019-04-15T07:16:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/483135455",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275476568"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275476568"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It doesn't make sense for `CachableAccount` to contain a `Type` enum, or an `m_type` runtime member. The type of cache variable isn't a runtime value that needs to be stored. This is kind of like declaring a fixed width variable to store an int, and then declaring another variable to store the fixed width.\r\n\r\nThe only place `m_type` is used is inside the `GetCachable()` function, so `type` could just be an argument to that function. This would make `GetCachable()` calls more straightforward to understand, because you wouldn't have to look in a separate part of the code for `CachableAccount` object construction to see the type of call. You could also simplify the `GetCachable()` by dropping the cached variable reference argument. So I guess I'm suggesting:\r\n\r\n```c++\r\nenum CacheType { DEBIT, CREDIT, IMMATURE_CREDIT, AVAILABLE_CREDIT };\r\nCAmount GetCachable(CacheType type, const isminefilter& filter, bool recalculate) const;\r\n```\r\n\r\n",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-15T17:54:45Z",
      "diff_hunk" : "@@ -9,22 +9,44 @@\n #include <script/standard.h>\n \n #include <stdint.h>\n+#include <bitset>\n \n class CKeyStore;\n class CScript;\n \n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL        = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    enum class Type : uint8_t {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275476568",
      "id" : 275476568,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTQ3NjU2OA==",
      "original_commit_id" : "18f23ae0c5599f2246e58e5293f7426471b73e9c",
      "original_position" : 30,
      "path" : "src/script/ismine.h",
      "position" : 30,
      "pull_request_review_id" : 226793740,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275476568",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275482649"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275482649"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Is purpose of the got_cache variable just to avoid changing behavior in this PR? If so, would suggest renaming and commenting:\r\n\r\n```c++\r\n// Avoid caching ismine or NONE or ALL cases (could remove this check and simplify in the future).\r\nconst bool allow_cache = filter == ISMINE_SPENDABLE || filter == ISMINE_WATCH_ONLY;\r\n```",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-15T18:11:28Z",
      "diff_hunk" : "@@ -2006,23 +1978,15 @@ CAmount CWalletTx::GetAvailableCredit(interfaces::Chain::Lock& locked_chain, boo\n     if (pwallet == nullptr)\n         return 0;\n \n+    bool got_cache = filter == ISMINE_SPENDABLE || filter == ISMINE_WATCH_ONLY;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275482649",
      "id" : 275482649,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTQ4MjY0OQ==",
      "original_commit_id" : "18f23ae0c5599f2246e58e5293f7426471b73e9c",
      "original_position" : 96,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 226793740,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275482649",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275485831"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275485831"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It seems pointless to overwrite the fUseCache argument. It would seem clearer just to write `fUseCache && allow_cache` in the one place the argument is used below to avoid having its value change in the middle of the function.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-15T18:20:06Z",
      "diff_hunk" : "@@ -2006,23 +1978,15 @@ CAmount CWalletTx::GetAvailableCredit(interfaces::Chain::Lock& locked_chain, boo\n     if (pwallet == nullptr)\n         return 0;\n \n+    bool got_cache = filter == ISMINE_SPENDABLE || filter == ISMINE_WATCH_ONLY;\n+    fUseCache &= got_cache;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275485831",
      "id" : 275485831,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTQ4NTgzMQ==",
      "original_commit_id" : "18f23ae0c5599f2246e58e5293f7426471b73e9c",
      "original_position" : 97,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 226793740,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275485831",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275500873"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275500873"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The code is this way because I specifically objected to passing the CacheType to GetCacheable, which is how it was written before, because the CacheType _is_ in fact a property of the CachableAccount object: any given such object is always either a credit account or a debit account, and it is _always_ an error to call GetCachable with any CacheType other than the correct one for the particular CachableAccount object. Associating the type with the object prevents this error.\r\n\r\nWhat I thought you were getting at in the first paragraph was that the type of a CachableAccount is a static property that is known at compile time. This I agree with, and you could certainly make it a type parameter, although I think that's unusually esoteric for C++ code, and making it an ordinary member is perfectly defensible. But I think not storing it at all, and leaving it implicit, is not defensible.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-15T18:59:51Z",
      "diff_hunk" : "@@ -9,22 +9,44 @@\n #include <script/standard.h>\n \n #include <stdint.h>\n+#include <bitset>\n \n class CKeyStore;\n class CScript;\n \n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL        = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    enum class Type : uint8_t {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275500873",
      "id" : 275500873,
      "in_reply_to_id" : 275476568,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTUwMDg3Mw==",
      "original_commit_id" : "18f23ae0c5599f2246e58e5293f7426471b73e9c",
      "original_position" : 30,
      "path" : "src/script/ismine.h",
      "position" : 30,
      "pull_request_review_id" : 226824402,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275500873",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275509342"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275509342"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "@gwillen it sounds like you are worried about an error that could have occurred in a previous or hypothetical version of the code where GetCacheable function took both CachableAmount and Type arguments. I agree that this would be more error prone than the current code, but it's not what I'm suggesting. \r\n\r\nThe current code avoids one problem (type being inconsistent with CachableAmount variable) but stores extra runtime data for no reason and adds a weird action-at-distance thing where you have to look 3 different places to see what GetCacheable will do (call site, function definition, cache variable construction). I don't there is anything wrong with actual interface I suggested:\r\n\r\n```c++\r\nenum CacheType { DEBIT, CREDIT, IMMATURE_CREDIT, AVAILABLE_CREDIT };\r\nCAmount GetCachable(CacheType type, const isminefilter& filter, bool recalculate) const;\r\n```\r\n\r\nIf you don't like it for some reason, that's fine. I already acked this PR in its current form. But if you want to call my suggestion \"not defensible\" you should be able to point out some actual error or mistake or problem that could it could cause.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-15T19:24:11Z",
      "diff_hunk" : "@@ -9,22 +9,44 @@\n #include <script/standard.h>\n \n #include <stdint.h>\n+#include <bitset>\n \n class CKeyStore;\n class CScript;\n \n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL        = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    enum class Type : uint8_t {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275509342",
      "id" : 275509342,
      "in_reply_to_id" : 275476568,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTUwOTM0Mg==",
      "original_commit_id" : "18f23ae0c5599f2246e58e5293f7426471b73e9c",
      "original_position" : 30,
      "path" : "src/script/ismine.h",
      "position" : 30,
      "pull_request_review_id" : 226835110,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275509342",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275532571"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275532571"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It was not hypothetical, it was indeed the previous version of the code, which I think you can see in the history of the PR (but maybe a rebase wiped it out.) I responded too quickly because I was frustrated that you appeared to be suggesting to go back to a previous version, without addressing my comments discussing why I was opposed to the previous version. In fact I did misunderstand your suggestion, and the thing you actually suggested makes sense to me. Sorry for responding the way I did.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-15T20:30:59Z",
      "diff_hunk" : "@@ -9,22 +9,44 @@\n #include <script/standard.h>\n \n #include <stdint.h>\n+#include <bitset>\n \n class CKeyStore;\n class CScript;\n \n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL        = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    enum class Type : uint8_t {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275532571",
      "id" : 275532571,
      "in_reply_to_id" : 275476568,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTUzMjU3MQ==",
      "original_commit_id" : "18f23ae0c5599f2246e58e5293f7426471b73e9c",
      "original_position" : 30,
      "path" : "src/script/ismine.h",
      "position" : 30,
      "pull_request_review_id" : 226864994,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275532571",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275588760"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275588760"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@ryanofsky That sounds reasonable, but how were you envisioning accessing the corresponding cache type from inside `GetCachable`? I started rewriting the code and ended up with\r\n```diff\r\n-    mutable CachableAccount m_debit{CachableAccount::Type::DEBIT};\r\n-    mutable CachableAccount m_credit{CachableAccount::Type::CREDIT};\r\n-    mutable CachableAccount m_credit_immature{CachableAccount::Type::CREDIT};\r\n-    mutable CachableAccount m_credit_available{CachableAccount::Type::CREDIT};\r\n+    mutable CachableAccount accounts[CACHETYPE_ENUM_ELEMENTS];\r\n```\r\nwhich seems like it will degrade readability.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-16T00:13:06Z",
      "diff_hunk" : "@@ -9,22 +9,44 @@\n #include <script/standard.h>\n \n #include <stdint.h>\n+#include <bitset>\n \n class CKeyStore;\n class CScript;\n \n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL        = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    enum class Type : uint8_t {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275588760",
      "id" : 275588760,
      "in_reply_to_id" : 275476568,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTU4ODc2MA==",
      "original_commit_id" : "18f23ae0c5599f2246e58e5293f7426471b73e9c",
      "original_position" : 30,
      "path" : "src/script/ismine.h",
      "position" : 30,
      "pull_request_review_id" : 226935295,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275588760",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275589477"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275589477"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Makes sense, changed.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-16T00:17:11Z",
      "diff_hunk" : "@@ -2006,23 +1978,15 @@ CAmount CWalletTx::GetAvailableCredit(interfaces::Chain::Lock& locked_chain, boo\n     if (pwallet == nullptr)\n         return 0;\n \n+    bool got_cache = filter == ISMINE_SPENDABLE || filter == ISMINE_WATCH_ONLY;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275589477",
      "id" : 275589477,
      "in_reply_to_id" : 275482649,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTU4OTQ3Nw==",
      "original_commit_id" : "18f23ae0c5599f2246e58e5293f7426471b73e9c",
      "original_position" : 96,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 226936132,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275589477",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275589518"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275589518"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good point, fixed.",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-16T00:17:29Z",
      "diff_hunk" : "@@ -2006,23 +1978,15 @@ CAmount CWalletTx::GetAvailableCredit(interfaces::Chain::Lock& locked_chain, boo\n     if (pwallet == nullptr)\n         return 0;\n \n+    bool got_cache = filter == ISMINE_SPENDABLE || filter == ISMINE_WATCH_ONLY;\n+    fUseCache &= got_cache;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275589518",
      "id" : 275589518,
      "in_reply_to_id" : 275485831,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTU4OTUxOA==",
      "original_commit_id" : "18f23ae0c5599f2246e58e5293f7426471b73e9c",
      "original_position" : 97,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 226936189,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275589518",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275596393"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275596393"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/15780/files#r275588760 from kallewoof\r\n\r\n> I started rewriting the code and ended up with\r\n\r\nYes, I would probably implement this with an array. But a smaller change would be to use a conditional:\r\n\r\n```c++\r\nauto& cache = type == CREDIT ? m_credit : type == DEBIT ? m_debit : ...;\r\n```\r\n\r\n> which seems like it will degrade readability.\r\n\r\nWhere specifically do you think this decreases readability?\r\n\r\n- Readability outside the GetCached function is improved by this suggestion because it replaces a complicated in/out parameter with a simple enum mode argument.\r\n- Readability inside the GetCached function should be improved even if the code is longer by a line or two because a layer of indirection is gone and you can see the actual objects that are being read and written to instead of having to trace through aliases.\r\n- Overall readability should be improved because instead of cache struct instances being accessed from many parts of wallet code they are accessed only in one place.\r\n\r\n\r\n ",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-16T01:01:23Z",
      "diff_hunk" : "@@ -9,22 +9,44 @@\n #include <script/standard.h>\n \n #include <stdint.h>\n+#include <bitset>\n \n class CKeyStore;\n class CScript;\n \n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL        = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount\n+{\n+    enum class Type : uint8_t {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275596393",
      "id" : 275596393,
      "in_reply_to_id" : 275476568,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTU5NjM5Mw==",
      "original_commit_id" : "18f23ae0c5599f2246e58e5293f7426471b73e9c",
      "original_position" : 30,
      "path" : "src/script/ismine.h",
      "position" : 30,
      "pull_request_review_id" : 226944353,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T01:22:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275596393",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275597994"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275597994"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I just noticed the struct is called `CachableAccount` and not `CachableAmount`. This seems like an unusual choice, because while it is clear this struct is a wrapper around an amount (subdivided into spendable and watchonly parts), it's at all not clear why we'd ever think of instances of these structs as \"accounts.\" Not even to mention in the past history of accounts in the wallet...\r\n\r\nI'd suggest at least renaming `CachableAccount` to `CachableAmount`, though I think more ideally this would:\r\n\r\n- Rename `CacheableAccount` to `CachedAmount`  and add doxygen comment: \"Cached amount subdivided into watchonly and spendable parts.\"\r\n- Rename `GetCachable` to `GetAmount`\r\n\r\n\r\n",
      "commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "created_at" : "2019-04-16T01:11:30Z",
      "diff_hunk" : "@@ -9,22 +9,44 @@\n #include <script/standard.h>\n \n #include <stdint.h>\n+#include <bitset>\n \n class CKeyStore;\n class CScript;\n \n /** IsMine() return codes */\n enum isminetype\n {\n-    ISMINE_NO = 0,\n-    ISMINE_WATCH_ONLY = 1,\n-    ISMINE_SPENDABLE = 2,\n-    ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE\n+    ISMINE_NO         = 0,\n+    ISMINE_WATCH_ONLY = 1 << 0,\n+    ISMINE_SPENDABLE  = 1 << 1,\n+    ISMINE_ALL        = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE,\n+    ISMINE_ENUM_ELEMENTS,\n };\n /** used for bitflags of isminetype */\n typedef uint8_t isminefilter;\n \n isminetype IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n isminetype IsMine(const CKeyStore& keystore, const CTxDestination& dest);\n \n+struct CachableAccount",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15780#discussion_r275597994",
      "id" : 275597994,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTU5Nzk5NA==",
      "original_commit_id" : "d7e11440052f44507a1b658350ee899986d1721d",
      "original_position" : 28,
      "path" : "src/script/ismine.h",
      "position" : 28,
      "pull_request_review_id" : 226944353,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15780",
      "updated_at" : "2019-04-16T01:22:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275597994",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   }
]
