{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "NONE",
   "body" : "## issue sumary \r\nI specificed `datadir` in conf file and run bitcoind with `-conf` option, but data is writing to default `~/.bitcoin` dir , not the dir I want  \r\n\r\n## steps to reproduce\r\n**bitcoind version 0.17.1**\r\n```\r\nroot@MNG-BC Ã¢ÂÂ  .bitcoin bitcoind --version\r\nBitcoin Core Daemon version v0.17.1.0-gef70f9b52b851c7997a9f1a0834714e3eebc1fd8\r\n```\r\n\r\n### step1: configrations\r\n**bitcoind conf file path `/root/.bitcoin/bitcoin.conf`**\r\ndatadir for testnet : **datadir=/mnt/data/bitcoin**\r\n```\r\n# [core]\r\n# Specify the location of the configuration file. To use non-default location, create a default location config file containing this setting.\r\nconf=/root/.bitcoin/bitcoin.conf\r\n\r\n# [debug]\r\n# Enable debug logging for all categories.\r\n#debug=1\r\n# Log IP Addresses in debug output.\r\n#logips=1\r\n# Run this node on the Bitcoin Test Network.\r\n#testnet=1\r\n\r\n# [rpc]\r\n# Accept command line and JSON-RPC commands.\r\nserver=1\r\n# Accept public REST requests.\r\nrest=1\r\n# RPC user\r\nrpcuser=rpcuser\r\n# RPC password\r\nrpcpassword=rpcpass\r\n# RPC allow ip (allow all)\r\nrpcallowip=0.0.0.0/0\r\n# RPC bind\r\n#rpcbind=127.0.0.1\r\n# get all transaction\r\ntxindex=1\r\n\r\n\r\n# [Sections]\r\n# Most options automatically apply to mainnet, testnet, and regtest networks.\r\n# If you want to confine an option to just one network, you should add it in the relevant section.\r\n# EXCEPTIONS: The options addnode, connect, port, bind, rpcport, rpcbind and wallet\r\n# only apply to mainnet unless they appear in the appropriate section below.\r\n\r\n# Options only for mainnet\r\n[main]\r\n# datadir\r\ndatadir=/mnt/data/bitcoin/mainnet\r\n# Listen for incoming connections on non-default port.(default: 8333 or testnet: 18333)\r\nport=8333\r\n# RPC port(default:8332 or testnet:18332)\r\nrpcport=8332\r\n\r\n# Options only for testnet\r\n[test]\r\n# datadir\r\ndatadir=/mnt/data/bitcoin\r\n# Listen for incoming connections on non-default port.(default: 8333 or testnet: 18333)\r\nport=18333\r\n# RPC port(default:8332 or testnet:18332)\r\nrpcport=18332\r\n\r\n# Options only for regtest\r\n[regtest]\r\n```\r\n\r\n### step2 : run bitcoind\r\nrun bitcoind with below command  \r\n```\r\nbitcoind -conf=/root/.bitcoin/bitcoin.conf -testnet=1\r\n```\r\n\r\n### step3 : check the data\r\nexpected all the data write to /mnt/data/bitcoin/testnet3  \r\nbut actually block data is been wroted to /root/.bitcoin/   \r\n```\r\ndrwx------  2 root root 4096 Apr  4 16:51 blocks\r\ndrwx------  3 root root 4096 Apr  4 16:51 testnet3\r\n```\r\n\r\nmore info about the contents in /root/.bitcoin \r\n```\r\nroot@MNG-BC Ã¢ÂÂ  .bitcoin du --max-depth=1 -h\r\n1.1G    ./testnet3\r\n4.0K    ./blocks\r\n1.1G    .\r\nroot@MNG-BC Ã¢ÂÂ  .bitcoin cd testnet3\r\nroot@MNG-BC Ã¢ÂÂ  testnet3 ls\r\nblocks\r\nroot@MNG-BC Ã¢ÂÂ  testnet3 cd blocks\r\nroot@MNG-BC Ã¢ÂÂ  blocks ls\r\nblk00000.dat  blk00001.dat  blk00002.dat  blk00003.dat  blk00004.dat  blk00005.dat  blk00006.dat  blk00007.dat  index  rev00000.dat  rev00001.dat  rev00002.dat  rev00003.dat  rev00004.dat  rev00005.dat  rev00006.dat  rev00007.dat\r\n```\r\n\r\n## question\r\nWhy datadir is not taken effect in conf? Is it a bug or my conf is wrong?  Should I specific `-datadir` option in the command line?  \r\n",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 4,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15745/comments",
   "created_at" : "2019-04-04T09:18:18Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15745/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/15745",
   "id" : 429169110,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15745/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDU6SXNzdWU0MjkxNjkxMTA=",
   "number" : 15745,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "unexpected behavior when specify datadir in config file",
   "updated_at" : "2019-04-09T09:14:33Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15745",
   "user" : {
      "avatar_url" : "https://avatars1.githubusercontent.com/u/1725060?v=4",
      "events_url" : "https://api.github.com/users/huahuayu/events{/privacy}",
      "followers_url" : "https://api.github.com/users/huahuayu/followers",
      "following_url" : "https://api.github.com/users/huahuayu/following{/other_user}",
      "gists_url" : "https://api.github.com/users/huahuayu/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/huahuayu",
      "id" : 1725060,
      "login" : "huahuayu",
      "node_id" : "MDQ6VXNlcjE3MjUwNjA=",
      "organizations_url" : "https://api.github.com/users/huahuayu/orgs",
      "received_events_url" : "https://api.github.com/users/huahuayu/received_events",
      "repos_url" : "https://api.github.com/users/huahuayu/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/huahuayu/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/huahuayu/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/huahuayu"
   }
}
