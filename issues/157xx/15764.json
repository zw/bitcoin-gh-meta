{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "Introducing the wallet of the glorious future: native descriptor wallets. With native descriptor wallet, addresses are generated from descriptors. Instead of generating keys and deriving addresses from keys, addresses come from the scriptPubKeys produced by a descriptor.\r\n\r\nDescriptor wallets will now store only keys, keymetadata, and descriptors. Keys are derived from descriptors but those keys are also stored in order to make signing work faster and be less complicated. In order to allow choosing different address types, 6 descriptors are needed for normal use. There is a pair of primary and change descriptors for each of the 3 address types. With the default keypool size of 1000, each descriptor has 1000 keys and scriptPubKeys pregenerated. This has a side effect of making wallets very large since 6000 keys are generated by default, instead of the current 2000. This can probably be improved in the future as we probably don't need so many addresses for each address type.\r\n\r\nDescriptors can also be imported with a new `importdescriptor` RPC.\r\n\r\nNative descriptor wallets also redefines how ismine and watchonly work. Ismine is changing to the simpler model of \"does this scriptPubKey exist in this wallet\". To facilitate this, all of the scriptPubKeys for all of the descriptors are computed on wallet loading. A scriptPubKey is considered `ISMINE_SPENDABLE` if it appears in the set of scriptPubKeys for the wallet. Because of this ismine change, watchonly is also redefined. A wallet can no longer contains watchonly things and non-watchonly things. Instead wallets are either watchonly (by having private keys disabled) or not. There is no mixing of watchonly and non-watchonly in a wallet. Some tests that relied on watchonly behavior had to be removed (i.e. part of `feature_segwit.py`)\r\n\r\nAdditionally several RPCs related to importing and dumping data from a wallet are incompatible with descriptor wallets. These RPCs (`addmultisigaddress`, `importaddress`, `importpubkey`, `importmulti`, `importprivkey`, and `dumpprivkey`) are disabled for normal use. For tests, shims are added to the RPC proxies for `addmultisigaddress`, `importaddress`, `importpubkey`, and `importprivkey` which convert their respective arguments into a descriptor that `importdescriptors` can accept. Unfortunately `importmulti` is pretty much incompatible with `importdescriptors`, so tests that use `importmulti` are either removed (e.g. `wallet_importmulti.py`) or changed to use `importdescriptors`.\r\n\r\nLastly, wallets can be upgraded to become native descriptor wallets. A current limitation of this is that only wallets that contain no watchonly things or wallets that are only watchonly (i.e. private keys disabled) can be upgraded. Mixed watchonly wallets cannot be upgraded for now.\r\n\r\n***\r\n\r\nThis PR is built on #15741 for batched writing to the wallet so `TopUpKeyPool` works faster, and on #15761 for upgrading wallets with a RPC.",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 0,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15764/comments",
   "created_at" : "2019-04-06T20:38:03Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15764/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/15764",
   "id" : 430074362,
   "labels" : [
      {
         "color" : "02d7e1",
         "default" : false,
         "id" : 135946,
         "name" : "GUI",
         "node_id" : "MDU6TGFiZWwxMzU5NDY=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/GUI"
      },
      {
         "color" : "0052cc",
         "default" : false,
         "id" : 98279177,
         "name" : "RPC/REST/ZMQ",
         "node_id" : "MDU6TGFiZWw5ODI3OTE3Nw==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ"
      },
      {
         "color" : "d4c5f9",
         "default" : false,
         "id" : 62963516,
         "name" : "Tests",
         "node_id" : "MDU6TGFiZWw2Mjk2MzUxNg==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests"
      },
      {
         "color" : "5319e7",
         "default" : false,
         "id" : 241832923,
         "name" : "Utils/log/libs",
         "node_id" : "MDU6TGFiZWwyNDE4MzI5MjM=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Utils/log/libs"
      },
      {
         "color" : "08a781",
         "default" : false,
         "id" : 149424,
         "name" : "Wallet",
         "node_id" : "MDU6TGFiZWwxNDk0MjQ=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15764/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDExOlB1bGxSZXF1ZXN0MjY4MDYxMzYz",
   "number" : 15764,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/15764.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15764",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/15764.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15764"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "Native descriptor wallets",
   "updated_at" : "2019-04-06T21:47:32Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15764",
   "user" : {
      "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
      "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
      "followers_url" : "https://api.github.com/users/achow101/followers",
      "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/achow101",
      "id" : 3782274,
      "login" : "achow101",
      "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
      "organizations_url" : "https://api.github.com/users/achow101/orgs",
      "received_events_url" : "https://api.github.com/users/achow101/received_events",
      "repos_url" : "https://api.github.com/users/achow101/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/achow101"
   }
}
