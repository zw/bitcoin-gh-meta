[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6271#discussion_r32295391"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6271"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/32295391"
         }
      },
      "body" : "I think it should raise an error when the node is not found. e.g.\r\n```c++\r\nif (pNode == NULL)\r\n    throw JSONRPCError(RPC_NOT_FOUND, \"Node not found in connected nodes\");\r\n````\r\nThis makes it possible to see if an operation actually happened.",
      "commit_id" : "b2127d6de3d515a271df9fda03f5ac5628ffd5bf",
      "created_at" : "2015-06-12T07:35:09Z",
      "diff_hunk" : "@@ -214,6 +214,28 @@ UniValue addnode(const UniValue& params, bool fHelp)\n     return NullUniValue;\n }\n \n+UniValue disconnectnode(const UniValue& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\n+            \"disconnectnode \\\"node\\\" \\n\"\n+            \"\\nImmediately disconnects from the specified node.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"node\\\"     (string, required) The node (see getpeerinfo for nodes)\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"disconnectnode\", \"\\\"192.168.0.6:8333\\\"\")\n+            + HelpExampleRpc(\"disconnectnode\", \"\\\"192.168.0.6:8333\\\"\")\n+        );\n+\n+    string strNode = params[0].get_str();\n+\n+    CNode* pNode = FindNode(strNode.c_str());\n+    if (pNode != NULL)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6271#discussion_r32295391",
      "id" : 32295391,
      "original_commit_id" : "7fa826d4642bd1bcbaf10b92b62ec20e8726a829",
      "original_position" : 20,
      "path" : "src/rpcnet.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6271",
      "updated_at" : "2015-06-15T06:10:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/32295391",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6271#discussion_r32295915"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6271"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/32295915"
         }
      },
      "body" : "+1 @laanwj \r\nI would also remove the 'strNode' round trip and directly add params[0].get_str() within FindNode()",
      "commit_id" : "b2127d6de3d515a271df9fda03f5ac5628ffd5bf",
      "created_at" : "2015-06-12T07:45:17Z",
      "diff_hunk" : "@@ -214,6 +214,28 @@ UniValue addnode(const UniValue& params, bool fHelp)\n     return NullUniValue;\n }\n \n+UniValue disconnectnode(const UniValue& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\n+            \"disconnectnode \\\"node\\\" \\n\"\n+            \"\\nImmediately disconnects from the specified node.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"node\\\"     (string, required) The node (see getpeerinfo for nodes)\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"disconnectnode\", \"\\\"192.168.0.6:8333\\\"\")\n+            + HelpExampleRpc(\"disconnectnode\", \"\\\"192.168.0.6:8333\\\"\")\n+        );\n+\n+    string strNode = params[0].get_str();\n+\n+    CNode* pNode = FindNode(strNode.c_str());\n+    if (pNode != NULL)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6271#discussion_r32295915",
      "id" : 32295915,
      "original_commit_id" : "7fa826d4642bd1bcbaf10b92b62ec20e8726a829",
      "original_position" : 20,
      "path" : "src/rpcnet.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6271",
      "updated_at" : "2015-06-15T06:10:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/32295915",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "utACK",
      "created_at" : "2015-06-12T11:55:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6271#issuecomment-111467877",
      "id" : 111467877,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6271",
      "updated_at" : "2015-06-12T11:55:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/111467877",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Tested ACK.\r\nWould be cool if you could pull in this RPC test (two commits):\r\nhttps://github.com/jonasschnelli/bitcoin/commit/ef4647a8ae2973cd02662752add7e7ba2e926de2 and https://github.com/jonasschnelli/bitcoin/commit/d20a3896460370f0f2564cd4db8d2ee16834a836\r\nfrom https://github.com/jonasschnelli/bitcoin/tree/DisconnectNode\r\n",
      "created_at" : "2015-06-12T20:17:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6271#issuecomment-111603267",
      "id" : 111603267,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6271",
      "updated_at" : "2015-06-12T20:17:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/111603267",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "@jonasschelli Just to avoid git confusion, you're asking me to add a source in git for your branch, merge the changes into mine and push it back? That's ok, I won't see my dev machine untli Monday though.",
      "created_at" : "2015-06-13T02:04:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6271#issuecomment-111654960",
      "id" : 111654960,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6271",
      "updated_at" : "2015-06-13T02:04:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/111654960",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2569494?v=3",
         "events_url" : "https://api.github.com/users/Alex-van-der-Peet/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Alex-van-der-Peet/followers",
         "following_url" : "https://api.github.com/users/Alex-van-der-Peet/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Alex-van-der-Peet/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Alex-van-der-Peet",
         "id" : 2569494,
         "login" : "Alex-van-der-Peet",
         "organizations_url" : "https://api.github.com/users/Alex-van-der-Peet/orgs",
         "received_events_url" : "https://api.github.com/users/Alex-van-der-Peet/received_events",
         "repos_url" : "https://api.github.com/users/Alex-van-der-Peet/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Alex-van-der-Peet/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Alex-van-der-Peet/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Alex-van-der-Peet"
      }
   },
   {
      "body" : "@Alex-van-der-Peet yes, except you should use `git cherry-pick` instead of merging; git merges and github pulls interact very badly. If it's too much trouble we can add the tests in another pull.\r\n",
      "created_at" : "2015-06-13T05:01:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6271#issuecomment-111670305",
      "id" : 111670305,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6271",
      "updated_at" : "2015-06-13T05:01:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/111670305",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@Alex-van-der-Peet: right. You need to add my remote `git remote add jonasschnelli https://github.com/jonasschnelli/bitcoin`, then you can fetch via `git fetch jonasschnelli`, then you can cherry pick the two commits: `git cherry-pick ef4647a8ae2973cd02662752add7e7ba2e926de2` and `git cherry-pick d20a3896460370f0f2564cd4db8d2ee16834a836`",
      "created_at" : "2015-06-13T07:47:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6271#issuecomment-111685320",
      "id" : 111685320,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6271",
      "updated_at" : "2015-06-13T07:47:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/111685320",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6271#discussion_r32396969"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6271"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/32396969"
         }
      },
      "body" : "@jonasschnelli\r\nI don't see the connection to add these tests in `httpbasics.py` (even renaming it). Let's add a seperate test script for (upcoming) RPC node disconnect/ban/etc handling?",
      "commit_id" : "b2127d6de3d515a271df9fda03f5ac5628ffd5bf",
      "created_at" : "2015-06-15T07:37:04Z",
      "diff_hunk" : "@@ -20,83 +20,99 @@\n except ImportError:\n     import urlparse\n \n-class HTTPBasicsTest (BitcoinTestFramework):        \n+class HTTPBasicsTest (BitcoinTestFramework):\n     def setup_nodes(self):\n         return start_nodes(4, self.options.tmpdir, extra_args=[['-rpckeepalive=1'], ['-rpckeepalive=0'], [], []])\n \n-    def run_test(self):        \n-        \n+    def run_test(self):\n+\n         #################################################\n         # lowlevel check for http persistent connection #\n         #################################################\n         url = urlparse.urlparse(self.nodes[0].url)\n         authpair = url.username + ':' + url.password\n         headers = {\"Authorization\": \"Basic \" + base64.b64encode(authpair)}\n-        \n+\n         conn = httplib.HTTPConnection(url.hostname, url.port)\n         conn.connect()\n         conn.request('POST', '/', '{\"method\": \"getbestblockhash\"}', headers)\n         out1 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True)\n         assert_equal(conn.sock!=None, True) #according to http/1.1 connection must still be open!\n-        \n+\n         #send 2nd request without closing connection\n         conn.request('POST', '/', '{\"method\": \"getchaintips\"}', headers)\n         out2 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True) #must also response with a correct json-rpc message\n         assert_equal(conn.sock!=None, True) #according to http/1.1 connection must still be open!\n         conn.close()\n-        \n+\n         #same should be if we add keep-alive because this should be the std. behaviour\n         headers = {\"Authorization\": \"Basic \" + base64.b64encode(authpair), \"Connection\": \"keep-alive\"}\n-        \n+\n         conn = httplib.HTTPConnection(url.hostname, url.port)\n         conn.connect()\n         conn.request('POST', '/', '{\"method\": \"getbestblockhash\"}', headers)\n         out1 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True)\n         assert_equal(conn.sock!=None, True) #according to http/1.1 connection must still be open!\n-        \n+\n         #send 2nd request without closing connection\n         conn.request('POST', '/', '{\"method\": \"getchaintips\"}', headers)\n         out2 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True) #must also response with a correct json-rpc message\n         assert_equal(conn.sock!=None, True) #according to http/1.1 connection must still be open!\n         conn.close()\n-        \n+\n         #now do the same with \"Connection: close\"\n         headers = {\"Authorization\": \"Basic \" + base64.b64encode(authpair), \"Connection\":\"close\"}\n-        \n+\n         conn = httplib.HTTPConnection(url.hostname, url.port)\n         conn.connect()\n         conn.request('POST', '/', '{\"method\": \"getbestblockhash\"}', headers)\n         out1 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True)\n-        assert_equal(conn.sock!=None, False) #now the connection must be closed after the response        \n-        \n+        assert_equal(conn.sock!=None, False) #now the connection must be closed after the response\n+\n         #node1 (2nd node) is running with disabled keep-alive option\n         urlNode1 = urlparse.urlparse(self.nodes[1].url)\n         authpair = urlNode1.username + ':' + urlNode1.password\n         headers = {\"Authorization\": \"Basic \" + base64.b64encode(authpair)}\n-                \n+\n         conn = httplib.HTTPConnection(urlNode1.hostname, urlNode1.port)\n         conn.connect()\n         conn.request('POST', '/', '{\"method\": \"getbestblockhash\"}', headers)\n         out1 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True)\n         assert_equal(conn.sock!=None, False) #connection must be closed because keep-alive was set to false\n-        \n+\n         #node2 (third node) is running with standard keep-alive parameters which means keep-alive is off\n         urlNode2 = urlparse.urlparse(self.nodes[2].url)\n         authpair = urlNode2.username + ':' + urlNode2.password\n         headers = {\"Authorization\": \"Basic \" + base64.b64encode(authpair)}\n-                \n+\n         conn = httplib.HTTPConnection(urlNode2.hostname, urlNode2.port)\n         conn.connect()\n         conn.request('POST', '/', '{\"method\": \"getbestblockhash\"}', headers)\n         out1 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True)\n         assert_equal(conn.sock!=None, True) #connection must be closed because bitcoind should use keep-alive by default\n-        \n+\n+        ###########################",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6271#discussion_r32396969",
      "id" : 32396969,
      "original_commit_id" : "b2127d6de3d515a271df9fda03f5ac5628ffd5bf",
      "original_position" : 98,
      "path" : "qa/rpc-tests/netbasics.py",
      "position" : 98,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6271",
      "updated_at" : "2015-06-15T07:37:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/32396969",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6271#discussion_r32397769"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6271"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/32397769"
         }
      },
      "body" : "I was trying to save some precious test time because another test will at least add another chain init and maybe mining of 100blocks on the top.\r\nBut right. A separate test could make sense if we look what else could get in there. Will do so.",
      "commit_id" : "b2127d6de3d515a271df9fda03f5ac5628ffd5bf",
      "created_at" : "2015-06-15T07:53:31Z",
      "diff_hunk" : "@@ -20,83 +20,99 @@\n except ImportError:\n     import urlparse\n \n-class HTTPBasicsTest (BitcoinTestFramework):        \n+class HTTPBasicsTest (BitcoinTestFramework):\n     def setup_nodes(self):\n         return start_nodes(4, self.options.tmpdir, extra_args=[['-rpckeepalive=1'], ['-rpckeepalive=0'], [], []])\n \n-    def run_test(self):        \n-        \n+    def run_test(self):\n+\n         #################################################\n         # lowlevel check for http persistent connection #\n         #################################################\n         url = urlparse.urlparse(self.nodes[0].url)\n         authpair = url.username + ':' + url.password\n         headers = {\"Authorization\": \"Basic \" + base64.b64encode(authpair)}\n-        \n+\n         conn = httplib.HTTPConnection(url.hostname, url.port)\n         conn.connect()\n         conn.request('POST', '/', '{\"method\": \"getbestblockhash\"}', headers)\n         out1 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True)\n         assert_equal(conn.sock!=None, True) #according to http/1.1 connection must still be open!\n-        \n+\n         #send 2nd request without closing connection\n         conn.request('POST', '/', '{\"method\": \"getchaintips\"}', headers)\n         out2 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True) #must also response with a correct json-rpc message\n         assert_equal(conn.sock!=None, True) #according to http/1.1 connection must still be open!\n         conn.close()\n-        \n+\n         #same should be if we add keep-alive because this should be the std. behaviour\n         headers = {\"Authorization\": \"Basic \" + base64.b64encode(authpair), \"Connection\": \"keep-alive\"}\n-        \n+\n         conn = httplib.HTTPConnection(url.hostname, url.port)\n         conn.connect()\n         conn.request('POST', '/', '{\"method\": \"getbestblockhash\"}', headers)\n         out1 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True)\n         assert_equal(conn.sock!=None, True) #according to http/1.1 connection must still be open!\n-        \n+\n         #send 2nd request without closing connection\n         conn.request('POST', '/', '{\"method\": \"getchaintips\"}', headers)\n         out2 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True) #must also response with a correct json-rpc message\n         assert_equal(conn.sock!=None, True) #according to http/1.1 connection must still be open!\n         conn.close()\n-        \n+\n         #now do the same with \"Connection: close\"\n         headers = {\"Authorization\": \"Basic \" + base64.b64encode(authpair), \"Connection\":\"close\"}\n-        \n+\n         conn = httplib.HTTPConnection(url.hostname, url.port)\n         conn.connect()\n         conn.request('POST', '/', '{\"method\": \"getbestblockhash\"}', headers)\n         out1 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True)\n-        assert_equal(conn.sock!=None, False) #now the connection must be closed after the response        \n-        \n+        assert_equal(conn.sock!=None, False) #now the connection must be closed after the response\n+\n         #node1 (2nd node) is running with disabled keep-alive option\n         urlNode1 = urlparse.urlparse(self.nodes[1].url)\n         authpair = urlNode1.username + ':' + urlNode1.password\n         headers = {\"Authorization\": \"Basic \" + base64.b64encode(authpair)}\n-                \n+\n         conn = httplib.HTTPConnection(urlNode1.hostname, urlNode1.port)\n         conn.connect()\n         conn.request('POST', '/', '{\"method\": \"getbestblockhash\"}', headers)\n         out1 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True)\n         assert_equal(conn.sock!=None, False) #connection must be closed because keep-alive was set to false\n-        \n+\n         #node2 (third node) is running with standard keep-alive parameters which means keep-alive is off\n         urlNode2 = urlparse.urlparse(self.nodes[2].url)\n         authpair = urlNode2.username + ':' + urlNode2.password\n         headers = {\"Authorization\": \"Basic \" + base64.b64encode(authpair)}\n-                \n+\n         conn = httplib.HTTPConnection(urlNode2.hostname, urlNode2.port)\n         conn.connect()\n         conn.request('POST', '/', '{\"method\": \"getbestblockhash\"}', headers)\n         out1 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True)\n         assert_equal(conn.sock!=None, True) #connection must be closed because bitcoind should use keep-alive by default\n-        \n+\n+        ###########################",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6271#discussion_r32397769",
      "id" : 32397769,
      "original_commit_id" : "b2127d6de3d515a271df9fda03f5ac5628ffd5bf",
      "original_position" : 98,
      "path" : "qa/rpc-tests/netbasics.py",
      "position" : 98,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6271",
      "updated_at" : "2015-06-15T07:53:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/32397769",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6271#discussion_r32399551"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6271"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/32399551"
         }
      },
      "body" : "Saving time is not worth it at the expense of sanity :)\r\nMaybe the chain init can be avoided for tests like this that don't need a chain?",
      "commit_id" : "b2127d6de3d515a271df9fda03f5ac5628ffd5bf",
      "created_at" : "2015-06-15T08:25:49Z",
      "diff_hunk" : "@@ -20,83 +20,99 @@\n except ImportError:\n     import urlparse\n \n-class HTTPBasicsTest (BitcoinTestFramework):        \n+class HTTPBasicsTest (BitcoinTestFramework):\n     def setup_nodes(self):\n         return start_nodes(4, self.options.tmpdir, extra_args=[['-rpckeepalive=1'], ['-rpckeepalive=0'], [], []])\n \n-    def run_test(self):        \n-        \n+    def run_test(self):\n+\n         #################################################\n         # lowlevel check for http persistent connection #\n         #################################################\n         url = urlparse.urlparse(self.nodes[0].url)\n         authpair = url.username + ':' + url.password\n         headers = {\"Authorization\": \"Basic \" + base64.b64encode(authpair)}\n-        \n+\n         conn = httplib.HTTPConnection(url.hostname, url.port)\n         conn.connect()\n         conn.request('POST', '/', '{\"method\": \"getbestblockhash\"}', headers)\n         out1 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True)\n         assert_equal(conn.sock!=None, True) #according to http/1.1 connection must still be open!\n-        \n+\n         #send 2nd request without closing connection\n         conn.request('POST', '/', '{\"method\": \"getchaintips\"}', headers)\n         out2 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True) #must also response with a correct json-rpc message\n         assert_equal(conn.sock!=None, True) #according to http/1.1 connection must still be open!\n         conn.close()\n-        \n+\n         #same should be if we add keep-alive because this should be the std. behaviour\n         headers = {\"Authorization\": \"Basic \" + base64.b64encode(authpair), \"Connection\": \"keep-alive\"}\n-        \n+\n         conn = httplib.HTTPConnection(url.hostname, url.port)\n         conn.connect()\n         conn.request('POST', '/', '{\"method\": \"getbestblockhash\"}', headers)\n         out1 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True)\n         assert_equal(conn.sock!=None, True) #according to http/1.1 connection must still be open!\n-        \n+\n         #send 2nd request without closing connection\n         conn.request('POST', '/', '{\"method\": \"getchaintips\"}', headers)\n         out2 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True) #must also response with a correct json-rpc message\n         assert_equal(conn.sock!=None, True) #according to http/1.1 connection must still be open!\n         conn.close()\n-        \n+\n         #now do the same with \"Connection: close\"\n         headers = {\"Authorization\": \"Basic \" + base64.b64encode(authpair), \"Connection\":\"close\"}\n-        \n+\n         conn = httplib.HTTPConnection(url.hostname, url.port)\n         conn.connect()\n         conn.request('POST', '/', '{\"method\": \"getbestblockhash\"}', headers)\n         out1 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True)\n-        assert_equal(conn.sock!=None, False) #now the connection must be closed after the response        \n-        \n+        assert_equal(conn.sock!=None, False) #now the connection must be closed after the response\n+\n         #node1 (2nd node) is running with disabled keep-alive option\n         urlNode1 = urlparse.urlparse(self.nodes[1].url)\n         authpair = urlNode1.username + ':' + urlNode1.password\n         headers = {\"Authorization\": \"Basic \" + base64.b64encode(authpair)}\n-                \n+\n         conn = httplib.HTTPConnection(urlNode1.hostname, urlNode1.port)\n         conn.connect()\n         conn.request('POST', '/', '{\"method\": \"getbestblockhash\"}', headers)\n         out1 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True)\n         assert_equal(conn.sock!=None, False) #connection must be closed because keep-alive was set to false\n-        \n+\n         #node2 (third node) is running with standard keep-alive parameters which means keep-alive is off\n         urlNode2 = urlparse.urlparse(self.nodes[2].url)\n         authpair = urlNode2.username + ':' + urlNode2.password\n         headers = {\"Authorization\": \"Basic \" + base64.b64encode(authpair)}\n-                \n+\n         conn = httplib.HTTPConnection(urlNode2.hostname, urlNode2.port)\n         conn.connect()\n         conn.request('POST', '/', '{\"method\": \"getbestblockhash\"}', headers)\n         out1 = conn.getresponse().read();\n         assert_equal('\"error\":null' in out1, True)\n         assert_equal(conn.sock!=None, True) #connection must be closed because bitcoind should use keep-alive by default\n-        \n+\n+        ###########################",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6271#discussion_r32399551",
      "id" : 32399551,
      "original_commit_id" : "b2127d6de3d515a271df9fda03f5ac5628ffd5bf",
      "original_position" : 98,
      "path" : "qa/rpc-tests/netbasics.py",
      "position" : 98,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6271",
      "updated_at" : "2015-06-15T08:25:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/32399551",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
