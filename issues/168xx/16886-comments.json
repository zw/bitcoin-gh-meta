[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "It's not a bug, but rather a missed performance improvement: the purpose of `CBloomFilter::UpdateEmptyFull()` is to set the flags `isEmpty` (filter is all zero-bits) and `isFull` (filter is all one-bits) which in turn are checked in the in-set function `CBloomFilter::contains()` to avoid unnecessarily wasting time for those two corner-cases.\r\nSince the `CBloomFilter::insert()` operation could lead to a full bloom filter, it makes in my opinion perfect sense to update the `isFull` flag after via calling `UpdateEmptyFull()`.",
      "created_at" : "2019-09-19T12:51:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16886#issuecomment-533116589",
      "id" : 533116589,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16886",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzMzExNjU4OQ==",
      "updated_at" : "2019-09-19T12:51:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/533116589",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Guess, UpdateEmptyFull must be private method and called from insert/add/copy filter from inside class CBloomFilter. That could make impossible such \"forgot\".\r\n",
      "created_at" : "2019-09-20T18:39:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16886#issuecomment-533666500",
      "id" : 533666500,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16886",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzMzY2NjUwMA==",
      "updated_at" : "2019-09-20T18:39:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/533666500",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/4589845?v=4",
         "events_url" : "https://api.github.com/users/alexzk1/events{/privacy}",
         "followers_url" : "https://api.github.com/users/alexzk1/followers",
         "following_url" : "https://api.github.com/users/alexzk1/following{/other_user}",
         "gists_url" : "https://api.github.com/users/alexzk1/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/alexzk1",
         "id" : 4589845,
         "login" : "alexzk1",
         "node_id" : "MDQ6VXNlcjQ1ODk4NDU=",
         "organizations_url" : "https://api.github.com/users/alexzk1/orgs",
         "received_events_url" : "https://api.github.com/users/alexzk1/received_events",
         "repos_url" : "https://api.github.com/users/alexzk1/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/alexzk1/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/alexzk1/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/alexzk1"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@alexzk1 note that `insert()` is called in a loop so `UpdateEmptyFull` would be called unnecessarily.",
      "created_at" : "2019-09-22T09:50:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16886#issuecomment-533866175",
      "id" : 533866175,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16886",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzMzg2NjE3NQ==",
      "updated_at" : "2019-09-22T09:50:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/533866175",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> @alexzk1 note that `insert()` is called in a loop so `UpdateEmptyFull` would be called unnecessarily.\r\n\r\nShouldn't it be for each insert ? As I recall inserting into full filter is invalid, so any way must check if full prior next insert. But I can be wrong about.",
      "created_at" : "2019-09-22T19:35:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16886#issuecomment-533911134",
      "id" : 533911134,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16886",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzMzkxMTEzNA==",
      "updated_at" : "2019-09-22T19:35:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/533911134",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/4589845?v=4",
         "events_url" : "https://api.github.com/users/alexzk1/events{/privacy}",
         "followers_url" : "https://api.github.com/users/alexzk1/followers",
         "following_url" : "https://api.github.com/users/alexzk1/following{/other_user}",
         "gists_url" : "https://api.github.com/users/alexzk1/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/alexzk1",
         "id" : 4589845,
         "login" : "alexzk1",
         "node_id" : "MDQ6VXNlcjQ1ODk4NDU=",
         "organizations_url" : "https://api.github.com/users/alexzk1/orgs",
         "received_events_url" : "https://api.github.com/users/alexzk1/received_events",
         "repos_url" : "https://api.github.com/users/alexzk1/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/alexzk1/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/alexzk1/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/alexzk1"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> > @alexzk1 note that `insert()` is called in a loop so `UpdateEmptyFull` would be called unnecessarily.\r\n> \r\n> Shouldn't it be for each insert ? As I recall inserting into full filter is invalid, so any way must check if full prior next insert. But I can be wrong about.\r\n\r\nNote that explicitely keeping track of whether a filter is full or empty is not necessary for correctness, but is only an optimization (\"to avoid wasting cpu\", as the comment for the update function in `bloom.h` puts it), introduced with commit 37c6389c5a0ca63ae3573440ecdfe95d28ad8f07. Inserting into a full filter is not invalid, but rather a waste of time -- since all bits are already set, setting any bit again doesn't change the state.\r\n\r\n",
      "created_at" : "2019-09-22T21:01:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16886#issuecomment-533918230",
      "id" : 533918230,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16886",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzMzkxODIzMA==",
      "updated_at" : "2019-09-22T21:01:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/533918230",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   }
]
