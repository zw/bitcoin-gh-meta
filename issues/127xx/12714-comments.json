[
   {
      "author_association" : "MEMBER",
      "body" : "Makes sense.\r\nutACK b6cb981e9e62a9886891b200fcf6b144f1e2e2f5",
      "created_at" : "2018-03-18T05:01:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12714#issuecomment-373973221",
      "id" : 373973221,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12714",
      "updated_at" : "2018-03-18T05:01:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/373973221",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2018-03-18T10:07:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12714#issuecomment-373986182",
      "id" : 373986182,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12714",
      "updated_at" : "2018-03-18T10:07:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/373986182",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/MeshCollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MeshCollider/followers",
         "following_url" : "https://api.github.com/users/MeshCollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MeshCollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MeshCollider",
         "id" : 3211283,
         "login" : "MeshCollider",
         "organizations_url" : "https://api.github.com/users/MeshCollider/orgs",
         "received_events_url" : "https://api.github.com/users/MeshCollider/received_events",
         "repos_url" : "https://api.github.com/users/MeshCollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MeshCollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MeshCollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MeshCollider"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "utACK b6cb981e9e62a9886891b200fcf6b144f1e2e2f5.",
      "created_at" : "2018-03-18T23:31:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12714#issuecomment-374066693",
      "id" : 374066693,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12714",
      "updated_at" : "2018-03-18T23:31:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/374066693",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Strong concept ACK. \r\n\r\nI very much appreciate this PR as it promotes the separation of concerns and the use of loosely coupled components.\r\n\r\nSome thoughts:\r\n\r\n- `CKeyStore` can become a pure interface by itself by moving its `cs_KeyStore` member and the AddKey implementation to `CBasicKeyStore` (I am happy to follow up on this if this is desired, but out of scope);\r\n- Declare `SigningProvider` in its own header file;\r\n- Rename the variable names where its type has been refactored from `CKeyStore` to `SigningProvider` to `signingProvider`-like equivalents. ",
      "created_at" : "2018-03-19T11:12:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12714#issuecomment-374177443",
      "id" : 374177443,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12714",
      "updated_at" : "2018-03-19T11:12:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/374177443",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13120787?v=4",
         "events_url" : "https://api.github.com/users/251Labs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/251Labs/followers",
         "following_url" : "https://api.github.com/users/251Labs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/251Labs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/251Labs",
         "id" : 13120787,
         "login" : "251Labs",
         "organizations_url" : "https://api.github.com/users/251Labs/orgs",
         "received_events_url" : "https://api.github.com/users/251Labs/received_events",
         "repos_url" : "https://api.github.com/users/251Labs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/251Labs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/251Labs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/251Labs"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "> CKeyStore can become a pure interface by itself by moving its cs_KeyStore member and the AddKey implementation to CBasicKeyStore (I am happy to follow up on this if this is desired, but out of scope);\r\n\r\nIndeed, this is possible (and has been possible for a while). I have some bigger changes planned, though (see below).\r\n\r\n> Declare `SigningProvider` in its own header file;\r\n\r\nI disagree. `SigningProvider` is part of the signing module. It's the interface you need to implement to use the signing logic. Making keystore a separate module was partly responsible for it gaining many of its unnecessary responsibilities.\r\n\r\n> Rename the variable names where its type has been refactored from `CKeyStore` to `SigningProvider` to `signingProvider`-like equivalents.\r\n\r\nIndeed, but there are many more changes coming here, and I'd like to avoid code churn.\r\n\r\nIn a way, I think, `SigningProvider` is what `CKeyStore` should have been. At the time it was created, it was necessary to break a cyclic dependency between script and wallet, and `SigningProvider` would have been sufficient for that. However, instead of just being the interface to provide information to the signing logic, it became the class that was actually responsible for maintaining that information. Later is was extended with even more responsibilities (maintaining all information to determine whether an output is ours, rather than just information for signing).\r\n\r\nEffectively keystore now manages a rather arbitrary subset of the wallet's data (keys and script and watchonly, but no key chains, pool, labels, metadata) - which isn't even enough to fully control the \"which outputs are ours\" concern now that HD derivation etc are implemented. I think keystore should either be fully merged back into wallet, or be extended to become the storage of all \"record\" related information (see the gist linked to in the PR description).",
      "created_at" : "2018-03-19T18:50:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12714#issuecomment-374324809",
      "id" : 374324809,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12714",
      "updated_at" : "2018-03-19T19:32:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/374324809",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for the feedback @sipa, appreciate it!\r\n\r\nJust to elaborate on the suggestion to decouple the pure interface `SigningProvider`:\r\n\r\nAs far as I can tell with b6cb981 there is a compilation dependency between implementations of the `SigningProvider` and the signing module, meaning that each time when the signing module needs to be compiled, implementations of the `SigningProvider` - which may not have been changed nor care about the recompiled signing module - will be recompiled as a result.\r\n\r\nI took notice of the comment below:\r\n\r\n> `SigningProvider` is part of the signing module. It's the interface you need to implement to use the signing logic.\r\n\r\n`CKeyStore` and `CBasicKeyStore` only seem to use the signing module by way of implementing the `SigningProvider` interface class. Decoupling the `SigningProvider` interface class doesn't conceptually change that design if you would keep the `signingprovider.h` and `sign.h` header files together, but it will break the compilation dependency between the signing module and implementations of the `SigningProvider` interface class.\r\n\r\nPlease note that this is just a friendly clarification. I am not pushing back on the concept (it wouldn't surprise me if I am still missing something very obvious).",
      "created_at" : "2018-03-21T18:16:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12714#issuecomment-375045485",
      "id" : 375045485,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12714",
      "updated_at" : "2018-03-21T18:16:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/375045485",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13120787?v=4",
         "events_url" : "https://api.github.com/users/251Labs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/251Labs/followers",
         "following_url" : "https://api.github.com/users/251Labs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/251Labs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/251Labs",
         "id" : 13120787,
         "login" : "251Labs",
         "organizations_url" : "https://api.github.com/users/251Labs/orgs",
         "received_events_url" : "https://api.github.com/users/251Labs/received_events",
         "repos_url" : "https://api.github.com/users/251Labs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/251Labs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/251Labs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/251Labs"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "@251Labs Sorry if I came across as claiming you're wrong, I'm just voicing my opinion about design. This is a useful discussion in any case.\r\n\r\nYou're certainly right that keeping `SigningProvider` part of the signing module means a possibly unnecessary compilation dependency of provider implementations on `script/sign.h`, but I don't think this is a big issue.\r\n\r\nThe point I was trying to make is that we should see `SigningProvider` as part of the \"script signing interface\", and not a separate thing. This is purely a code organization issue, not more. I believe that having keystore a separate module is partially responsible for it having become overloaded with unnecessary features.",
      "created_at" : "2018-03-21T18:36:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12714#issuecomment-375051963",
      "id" : 375051963,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12714",
      "updated_at" : "2018-03-21T18:36:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/375051963",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "concept ACK, will review",
      "created_at" : "2018-03-22T20:55:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12714#issuecomment-375454445",
      "id" : 375454445,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12714",
      "updated_at" : "2018-03-22T20:55:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/375454445",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12714#discussion_r176611666"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12714"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/176611666"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit, `key stores`:\r\nhttps://github.com/bitcoin/bitcoin/blob/cead84b72d27517338ac3c49eaaed4db07352f41/src/keystore.h#L17-L18",
      "commit_id" : "b6cb981e9e62a9886891b200fcf6b144f1e2e2f5",
      "created_at" : "2018-03-23T00:30:58Z",
      "diff_hunk" : "@@ -8,21 +8,32 @@\n \n #include <script/interpreter.h>\n \n+class CKey;\n class CKeyID;\n-class CKeyStore;\n class CScript;\n+class CScriptID;\n class CTransaction;\n \n struct CMutableTransaction;\n \n+/** An interface to be implemented by keystores that support signing. */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12714#discussion_r176611666",
      "id" : 176611666,
      "original_commit_id" : "b6cb981e9e62a9886891b200fcf6b144f1e2e2f5",
      "original_position" : 13,
      "path" : "src/script/sign.h",
      "position" : 13,
      "pull_request_review_id" : 106347910,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12714",
      "updated_at" : "2018-03-23T00:54:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/176611666",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12714#discussion_r176614651"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12714"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/176614651"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`struct`?\r\n\r\nEdit: sorry, never mind",
      "commit_id" : "b6cb981e9e62a9886891b200fcf6b144f1e2e2f5",
      "created_at" : "2018-03-23T00:54:25Z",
      "diff_hunk" : "@@ -8,21 +8,32 @@\n \n #include <script/interpreter.h>\n \n+class CKey;\n class CKeyID;\n-class CKeyStore;\n class CScript;\n+class CScriptID;\n class CTransaction;\n \n struct CMutableTransaction;\n \n+/** An interface to be implemented by keystores that support signing. */\n+class SigningProvider",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12714#discussion_r176614651",
      "id" : 176614651,
      "original_commit_id" : "b6cb981e9e62a9886891b200fcf6b144f1e2e2f5",
      "original_position" : 14,
      "path" : "src/script/sign.h",
      "position" : 14,
      "pull_request_review_id" : 106347910,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12714",
      "updated_at" : "2018-03-23T01:19:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/176614651",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK https://github.com/bitcoin/bitcoin/pull/12714/commits/b6cb981e9e62a9886891b200fcf6b144f1e2e2f5\r\n\r\nfollow-on renamings always nice in subsequent PRs",
      "created_at" : "2018-03-23T12:37:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12714#issuecomment-375651887",
      "id" : 375651887,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12714",
      "updated_at" : "2018-03-23T12:37:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/375651887",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   }
]
