[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#15649](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15649.html) (Add ChaCha20Poly1305@Bitcoin AEAD by jonasschnelli)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-03-05T10:36:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#issuecomment-469630268",
      "id" : 469630268,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15512",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2OTYzMDI2OA==",
      "updated_at" : "2019-03-27T17:37:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/469630268",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268286916"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268286916"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "A comment would be helpful here: \"If m has fewer than 64 bytes available, copy m to tmp and read from tmp instead\"",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-03-22T18:17:37Z",
      "diff_hunk" : "@@ -100,6 +102,10 @@ void ChaCha20::Output(unsigned char* c, size_t bytes)\n \n     for (;;) {\n         if (bytes < 64) {\n+            if (m != nullptr) {\n+                for (i = 0;i < bytes;++i) tmp[i] = m[i];",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268286916",
      "id" : 268286916,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODI4NjkxNg==",
      "original_commit_id" : "b05bb64dc624c45bf340490db06346cefdbff48a",
      "original_position" : 23,
      "path" : "src/crypto/chacha20.cpp",
      "position" : null,
      "pull_request_review_id" : 217907518,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268286916",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268287371"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268287371"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Just `memcpy(tmp, m, bytes)` might be simpler and easy to read than this for loop.",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-03-22T18:18:51Z",
      "diff_hunk" : "@@ -100,6 +102,10 @@ void ChaCha20::Output(unsigned char* c, size_t bytes)\n \n     for (;;) {\n         if (bytes < 64) {\n+            if (m != nullptr) {\n+                for (i = 0;i < bytes;++i) tmp[i] = m[i];",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268287371",
      "id" : 268287371,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODI4NzM3MQ==",
      "original_commit_id" : "b05bb64dc624c45bf340490db06346cefdbff48a",
      "original_position" : 23,
      "path" : "src/crypto/chacha20.cpp",
      "position" : null,
      "pull_request_review_id" : 217907518,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268287371",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268287967"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268287967"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Not sure what the benefit of defining XOR macro is. Isn't `x0 ^= ReadLE32(m + 0)` more readable and less error-prone than `x0 = XOR(x0, ReadLE32(m + 0))`?",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-03-22T18:20:25Z",
      "diff_hunk" : "@@ -146,6 +152,25 @@ void ChaCha20::Output(unsigned char* c, size_t bytes)\n         x14 += j14;\n         x15 += j15;\n \n+        if (m != nullptr) {\n+            x0 = XOR(x0, ReadLE32(m + 0));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268287967",
      "id" : 268287967,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODI4Nzk2Nw==",
      "original_commit_id" : "b05bb64dc624c45bf340490db06346cefdbff48a",
      "original_position" : 34,
      "path" : "src/crypto/chacha20.cpp",
      "position" : null,
      "pull_request_review_id" : 217907518,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268287967",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268289944"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268289944"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This comment seems imply that output is not written if input is null. Maybe rephrase: \"If \\<input> is non-null, the specified number of \\<bytes> from \\<input> will encrypted and written to \\<output>, otherwise just the keystream will be written to \\<output\\> (which may be useful for random number generation). Either way, the number of bytes written to \\<output> will be \\<bytes>.\"",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-03-22T18:25:42Z",
      "diff_hunk" : "@@ -20,7 +20,9 @@ class ChaCha20\n     void SetKey(const unsigned char* key, size_t keylen);\n     void SetIV(uint64_t iv);\n     void Seek(uint64_t pos);\n-    void Output(unsigned char* output, size_t bytes);\n+\n+    // if <input> is provided, the ciphertext will be written to <output> otherwise the current keystream",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268289944",
      "id" : 268289944,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODI4OTk0NA==",
      "original_commit_id" : "b05bb64dc624c45bf340490db06346cefdbff48a",
      "original_position" : 6,
      "path" : "src/crypto/chacha20.h",
      "position" : null,
      "pull_request_review_id" : 217907518,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268289944",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268293664"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268293664"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Maybe `assert(hex_message.empty() || m.size() == out.size())`",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-03-22T18:36:40Z",
      "diff_hunk" : "@@ -187,16 +187,19 @@ static void TestAES256CBC(const std::string &hexkey, const std::string &hexiv, b\n     }\n }\n \n-static void TestChaCha20(const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n+static void TestChaCha20(const std::string &hex_message, const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n {\n     std::vector<unsigned char> key = ParseHex(hexkey);\n+    std::vector<unsigned char> m = ParseHex(hex_message);\n     ChaCha20 rng(key.data(), key.size());\n     rng.SetIV(nonce);\n     rng.Seek(seek);\n     std::vector<unsigned char> out = ParseHex(hexout);\n     std::vector<unsigned char> outres;\n     outres.resize(out.size());\n-    rng.Output(outres.data(), outres.size());\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268293664",
      "id" : 268293664,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODI5MzY2NA==",
      "original_commit_id" : "4325da919a042dfb4eed87b6d038dbb236959e5b",
      "original_position" : 16,
      "path" : "src/test/crypto_tests.cpp",
      "position" : 17,
      "pull_request_review_id" : 217907518,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268293664",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268298310"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268298310"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It seems like a useful additional test would be call `rng.Output` twice if `hex_message` is nonempty, once with input and once without, and confirm that xoring the two outputs yields the input again.",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-03-22T18:50:31Z",
      "diff_hunk" : "@@ -187,16 +187,19 @@ static void TestAES256CBC(const std::string &hexkey, const std::string &hexiv, b\n     }\n }\n \n-static void TestChaCha20(const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n+static void TestChaCha20(const std::string &hex_message, const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n {\n     std::vector<unsigned char> key = ParseHex(hexkey);\n+    std::vector<unsigned char> m = ParseHex(hex_message);\n     ChaCha20 rng(key.data(), key.size());\n     rng.SetIV(nonce);\n     rng.Seek(seek);\n     std::vector<unsigned char> out = ParseHex(hexout);\n     std::vector<unsigned char> outres;\n     outres.resize(out.size());\n-    rng.Output(outres.data(), outres.size());\n+\n+    // perform the ChaCha20 round(s), if message is provided it will output the encrypted ciphertext otherwise the keystream\n+    rng.Output(hex_message.empty() ? nullptr : m.data(), outres.data(), outres.size());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268298310",
      "id" : 268298310,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODI5ODMxMA==",
      "original_commit_id" : "4325da919a042dfb4eed87b6d038dbb236959e5b",
      "original_position" : 18,
      "path" : "src/test/crypto_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 217907518,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268298310",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268828344"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268828344"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm not to familiar with compiler optimisations and stuff but I just checked the reference implementation by DJB and some other C based ChaCha implementations and all of them seems to use the byte per byte assignment. I prefer to leave it as it is.",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-03-25T20:07:20Z",
      "diff_hunk" : "@@ -100,6 +102,10 @@ void ChaCha20::Output(unsigned char* c, size_t bytes)\n \n     for (;;) {\n         if (bytes < 64) {\n+            if (m != nullptr) {\n+                for (i = 0;i < bytes;++i) tmp[i] = m[i];",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268828344",
      "id" : 268828344,
      "in_reply_to_id" : 268287371,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODgyODM0NA==",
      "original_commit_id" : "b05bb64dc624c45bf340490db06346cefdbff48a",
      "original_position" : 23,
      "path" : "src/crypto/chacha20.cpp",
      "position" : null,
      "pull_request_review_id" : 218556895,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268828344",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268842266"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842266"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good point. Added.",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-03-25T20:43:11Z",
      "diff_hunk" : "@@ -187,16 +187,19 @@ static void TestAES256CBC(const std::string &hexkey, const std::string &hexiv, b\n     }\n }\n \n-static void TestChaCha20(const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n+static void TestChaCha20(const std::string &hex_message, const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n {\n     std::vector<unsigned char> key = ParseHex(hexkey);\n+    std::vector<unsigned char> m = ParseHex(hex_message);\n     ChaCha20 rng(key.data(), key.size());\n     rng.SetIV(nonce);\n     rng.Seek(seek);\n     std::vector<unsigned char> out = ParseHex(hexout);\n     std::vector<unsigned char> outres;\n     outres.resize(out.size());\n-    rng.Output(outres.data(), outres.size());\n+\n+    // perform the ChaCha20 round(s), if message is provided it will output the encrypted ciphertext otherwise the keystream\n+    rng.Output(hex_message.empty() ? nullptr : m.data(), outres.data(), outres.size());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268842266",
      "id" : 268842266,
      "in_reply_to_id" : 268298310,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODg0MjI2Ng==",
      "original_commit_id" : "4325da919a042dfb4eed87b6d038dbb236959e5b",
      "original_position" : 18,
      "path" : "src/test/crypto_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 218574212,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842266",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268842309"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842309"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Added.",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-03-25T20:43:18Z",
      "diff_hunk" : "@@ -187,16 +187,19 @@ static void TestAES256CBC(const std::string &hexkey, const std::string &hexiv, b\n     }\n }\n \n-static void TestChaCha20(const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n+static void TestChaCha20(const std::string &hex_message, const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n {\n     std::vector<unsigned char> key = ParseHex(hexkey);\n+    std::vector<unsigned char> m = ParseHex(hex_message);\n     ChaCha20 rng(key.data(), key.size());\n     rng.SetIV(nonce);\n     rng.Seek(seek);\n     std::vector<unsigned char> out = ParseHex(hexout);\n     std::vector<unsigned char> outres;\n     outres.resize(out.size());\n-    rng.Output(outres.data(), outres.size());\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268842309",
      "id" : 268842309,
      "in_reply_to_id" : 268293664,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODg0MjMwOQ==",
      "original_commit_id" : "4325da919a042dfb4eed87b6d038dbb236959e5b",
      "original_position" : 16,
      "path" : "src/test/crypto_tests.cpp",
      "position" : 17,
      "pull_request_review_id" : 218574257,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842309",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268842397"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842397"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Valid point. Fixed.",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-03-25T20:43:32Z",
      "diff_hunk" : "@@ -20,7 +20,9 @@ class ChaCha20\n     void SetKey(const unsigned char* key, size_t keylen);\n     void SetIV(uint64_t iv);\n     void Seek(uint64_t pos);\n-    void Output(unsigned char* output, size_t bytes);\n+\n+    // if <input> is provided, the ciphertext will be written to <output> otherwise the current keystream",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268842397",
      "id" : 268842397,
      "in_reply_to_id" : 268289944,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODg0MjM5Nw==",
      "original_commit_id" : "b05bb64dc624c45bf340490db06346cefdbff48a",
      "original_position" : 6,
      "path" : "src/crypto/chacha20.h",
      "position" : null,
      "pull_request_review_id" : 218574379,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842397",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268842508"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842508"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Added.",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-03-25T20:43:55Z",
      "diff_hunk" : "@@ -100,6 +102,10 @@ void ChaCha20::Output(unsigned char* c, size_t bytes)\n \n     for (;;) {\n         if (bytes < 64) {\n+            if (m != nullptr) {\n+                for (i = 0;i < bytes;++i) tmp[i] = m[i];",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268842508",
      "id" : 268842508,
      "in_reply_to_id" : 268286916,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODg0MjUwOA==",
      "original_commit_id" : "b05bb64dc624c45bf340490db06346cefdbff48a",
      "original_position" : 23,
      "path" : "src/crypto/chacha20.cpp",
      "position" : null,
      "pull_request_review_id" : 218574552,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842508",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268842649"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842649"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks for the review! Your right. Changed.",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-03-25T20:44:14Z",
      "diff_hunk" : "@@ -146,6 +152,25 @@ void ChaCha20::Output(unsigned char* c, size_t bytes)\n         x14 += j14;\n         x15 += j15;\n \n+        if (m != nullptr) {\n+            x0 = XOR(x0, ReadLE32(m + 0));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268842649",
      "id" : 268842649,
      "in_reply_to_id" : 268287967,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODg0MjY0OQ==",
      "original_commit_id" : "b05bb64dc624c45bf340490db06346cefdbff48a",
      "original_position" : 34,
      "path" : "src/crypto/chacha20.cpp",
      "position" : null,
      "pull_request_review_id" : 218574714,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842649",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r269692281"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/269692281"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think it would be better to duplicate the logic here and turn the stream cipher version into a separate function.\r\n\r\nAs is, it introduces an unnecessary branch in the output version.",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-03-27T17:48:22Z",
      "diff_hunk" : "@@ -71,7 +71,7 @@ void ChaCha20::Seek(uint64_t pos)\n     input[13] = pos >> 32;\n }\n \n-void ChaCha20::Output(unsigned char* c, size_t bytes)\n+void ChaCha20::Output(const unsigned char* m, unsigned char* c, size_t bytes)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r269692281",
      "id" : 269692281,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2OTY5MjI4MQ==",
      "original_commit_id" : "9d3ea6a77693f366c57d6f706665eb989deafb9c",
      "original_position" : 5,
      "path" : "src/crypto/chacha20.cpp",
      "position" : null,
      "pull_request_review_id" : 219628168,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/269692281",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r270180420"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270180420"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good point. Adapted the duplication approach.",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-03-28T20:12:49Z",
      "diff_hunk" : "@@ -71,7 +71,7 @@ void ChaCha20::Seek(uint64_t pos)\n     input[13] = pos >> 32;\n }\n \n-void ChaCha20::Output(unsigned char* c, size_t bytes)\n+void ChaCha20::Output(const unsigned char* m, unsigned char* c, size_t bytes)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r270180420",
      "id" : 270180420,
      "in_reply_to_id" : 269692281,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MDE4MDQyMA==",
      "original_commit_id" : "9d3ea6a77693f366c57d6f706665eb989deafb9c",
      "original_position" : 5,
      "path" : "src/crypto/chacha20.cpp",
      "position" : null,
      "pull_request_review_id" : 220249493,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270180420",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r270206310"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270206310"
         }
      },
      "author_association" : "MEMBER",
      "body" : "No need for this `if`.",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-03-28T21:28:46Z",
      "diff_hunk" : "@@ -178,3 +178,135 @@ void ChaCha20::Output(unsigned char* c, size_t bytes)\n         c += 64;\n     }\n }\n+\n+void ChaCha20::Crypt(const unsigned char* m, unsigned char* c, size_t bytes)\n+{\n+    uint32_t x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14, x15;\n+    uint32_t j0, j1, j2, j3, j4, j5, j6, j7, j8, j9, j10, j11, j12, j13, j14, j15;\n+    unsigned char *ctarget = nullptr;\n+    unsigned char tmp[64];\n+    unsigned int i;\n+\n+    if (!bytes) return;\n+\n+    j0 = input[0];\n+    j1 = input[1];\n+    j2 = input[2];\n+    j3 = input[3];\n+    j4 = input[4];\n+    j5 = input[5];\n+    j6 = input[6];\n+    j7 = input[7];\n+    j8 = input[8];\n+    j9 = input[9];\n+    j10 = input[10];\n+    j11 = input[11];\n+    j12 = input[12];\n+    j13 = input[13];\n+    j14 = input[14];\n+    j15 = input[15];\n+\n+    for (;;) {\n+        if (bytes < 64) {\n+            // if m has fewer than 64 bytes available, copy m to tmp and\n+            // read from tmp instead\n+            for (i = 0;i < bytes;++i) tmp[i] = m[i];\n+            m = tmp;\n+            ctarget = c;\n+            c = tmp;\n+        }\n+        x0 = j0;\n+        x1 = j1;\n+        x2 = j2;\n+        x3 = j3;\n+        x4 = j4;\n+        x5 = j5;\n+        x6 = j6;\n+        x7 = j7;\n+        x8 = j8;\n+        x9 = j9;\n+        x10 = j10;\n+        x11 = j11;\n+        x12 = j12;\n+        x13 = j13;\n+        x14 = j14;\n+        x15 = j15;\n+        for (i = 20;i > 0;i -= 2) {\n+            QUARTERROUND( x0, x4, x8,x12)\n+            QUARTERROUND( x1, x5, x9,x13)\n+            QUARTERROUND( x2, x6,x10,x14)\n+            QUARTERROUND( x3, x7,x11,x15)\n+            QUARTERROUND( x0, x5,x10,x15)\n+            QUARTERROUND( x1, x6,x11,x12)\n+            QUARTERROUND( x2, x7, x8,x13)\n+            QUARTERROUND( x3, x4, x9,x14)\n+        }\n+        x0 += j0;\n+        x1 += j1;\n+        x2 += j2;\n+        x3 += j3;\n+        x4 += j4;\n+        x5 += j5;\n+        x6 += j6;\n+        x7 += j7;\n+        x8 += j8;\n+        x9 += j9;\n+        x10 += j10;\n+        x11 += j11;\n+        x12 += j12;\n+        x13 += j13;\n+        x14 += j14;\n+        x15 += j15;\n+\n+        if (m != nullptr) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r270206310",
      "id" : 270206310,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MDIwNjMxMA==",
      "original_commit_id" : "7f2028f04cd51c944046cf0b664bdd308dcdb397",
      "original_position" : 84,
      "path" : "src/crypto/chacha20.cpp",
      "position" : null,
      "pull_request_review_id" : 220283487,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270206310",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r270323780"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270323780"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes. Fixed.",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-03-29T08:58:14Z",
      "diff_hunk" : "@@ -178,3 +178,135 @@ void ChaCha20::Output(unsigned char* c, size_t bytes)\n         c += 64;\n     }\n }\n+\n+void ChaCha20::Crypt(const unsigned char* m, unsigned char* c, size_t bytes)\n+{\n+    uint32_t x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14, x15;\n+    uint32_t j0, j1, j2, j3, j4, j5, j6, j7, j8, j9, j10, j11, j12, j13, j14, j15;\n+    unsigned char *ctarget = nullptr;\n+    unsigned char tmp[64];\n+    unsigned int i;\n+\n+    if (!bytes) return;\n+\n+    j0 = input[0];\n+    j1 = input[1];\n+    j2 = input[2];\n+    j3 = input[3];\n+    j4 = input[4];\n+    j5 = input[5];\n+    j6 = input[6];\n+    j7 = input[7];\n+    j8 = input[8];\n+    j9 = input[9];\n+    j10 = input[10];\n+    j11 = input[11];\n+    j12 = input[12];\n+    j13 = input[13];\n+    j14 = input[14];\n+    j15 = input[15];\n+\n+    for (;;) {\n+        if (bytes < 64) {\n+            // if m has fewer than 64 bytes available, copy m to tmp and\n+            // read from tmp instead\n+            for (i = 0;i < bytes;++i) tmp[i] = m[i];\n+            m = tmp;\n+            ctarget = c;\n+            c = tmp;\n+        }\n+        x0 = j0;\n+        x1 = j1;\n+        x2 = j2;\n+        x3 = j3;\n+        x4 = j4;\n+        x5 = j5;\n+        x6 = j6;\n+        x7 = j7;\n+        x8 = j8;\n+        x9 = j9;\n+        x10 = j10;\n+        x11 = j11;\n+        x12 = j12;\n+        x13 = j13;\n+        x14 = j14;\n+        x15 = j15;\n+        for (i = 20;i > 0;i -= 2) {\n+            QUARTERROUND( x0, x4, x8,x12)\n+            QUARTERROUND( x1, x5, x9,x13)\n+            QUARTERROUND( x2, x6,x10,x14)\n+            QUARTERROUND( x3, x7,x11,x15)\n+            QUARTERROUND( x0, x5,x10,x15)\n+            QUARTERROUND( x1, x6,x11,x12)\n+            QUARTERROUND( x2, x7, x8,x13)\n+            QUARTERROUND( x3, x4, x9,x14)\n+        }\n+        x0 += j0;\n+        x1 += j1;\n+        x2 += j2;\n+        x3 += j3;\n+        x4 += j4;\n+        x5 += j5;\n+        x6 += j6;\n+        x7 += j7;\n+        x8 += j8;\n+        x9 += j9;\n+        x10 += j10;\n+        x11 += j11;\n+        x12 += j12;\n+        x13 += j13;\n+        x14 += j14;\n+        x15 += j15;\n+\n+        if (m != nullptr) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r270323780",
      "id" : 270323780,
      "in_reply_to_id" : 270206310,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MDMyMzc4MA==",
      "original_commit_id" : "7f2028f04cd51c944046cf0b664bdd308dcdb397",
      "original_position" : 84,
      "path" : "src/crypto/chacha20.cpp",
      "position" : null,
      "pull_request_review_id" : 220429735,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270323780",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280833386"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280833386"
         }
      },
      "author_association" : "MEMBER",
      "body" : "What's the reasoning here? Performance?\r\n\r\nHow does the version in the refrence implementation compare?\r\n\r\n```c\r\nvoid ECRYPT_keystream_bytes(ECRYPT_ctx *x,u8 *stream,u32 bytes)\r\n{\r\n  u32 i;\r\n  for (i = 0;i < bytes;++i) stream[i] = 0;\r\n  ECRYPT_encrypt_bytes(x,stream,stream,bytes);\r\n}\r\n```\r\n\r\nie setting `Output(c, bytes)` to call `Crypt(c, c, bytes)`?",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-05-03T15:58:14Z",
      "diff_hunk" : "@@ -71,7 +71,7 @@ void ChaCha20::Seek(uint64_t pos)\n     input[13] = pos >> 32;\n }\n \n-void ChaCha20::Output(unsigned char* c, size_t bytes)\n+void ChaCha20::Output(const unsigned char* m, unsigned char* c, size_t bytes)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280833386",
      "id" : 280833386,
      "in_reply_to_id" : 269692281,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDgzMzM4Ng==",
      "original_commit_id" : "9d3ea6a77693f366c57d6f706665eb989deafb9c",
      "original_position" : 5,
      "path" : "src/crypto/chacha20.cpp",
      "position" : null,
      "pull_request_review_id" : 233547118,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280833386",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280833698"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280833698"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: why the extra newline?",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-05-03T15:59:08Z",
      "diff_hunk" : "@@ -20,7 +20,9 @@ class ChaCha20\n     void SetKey(const unsigned char* key, size_t keylen);\n     void SetIV(uint64_t iv);\n     void Seek(uint64_t pos);\n-    void Output(unsigned char* output, size_t bytes);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280833698",
      "id" : 280833698,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDgzMzY5OA==",
      "original_commit_id" : "427b49dcdbfb25153ee4228dda49aa07db16d59c",
      "original_position" : 5,
      "path" : "src/crypto/chacha20.h",
      "position" : 21,
      "pull_request_review_id" : 233547521,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280833698",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280834907"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280834907"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Now that this class can encrypt plaintext, the class comment should be updated from \"A PRNG class for ChaCha20.\"\r\n\r\nReally, I'd like to see more commenting for this class in general (ie note that `SetIV` sets the nonce, `Seek` sets the counter, that the counter is 64 bytes and the nonce is 64 bytes as in the original ChaCha20 spec instead of 32 byte counter/96 byte nonce as in the IETF spec).\r\n\r\n(there are a couple of good resources on the different counter/nonce sizes here: https://libsodium.gitbook.io/doc/advanced/stream_ciphers/chacha20 and here: http://loup-vaillant.fr/tutorials/chacha20-design)",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-05-03T16:02:53Z",
      "diff_hunk" : "@@ -20,7 +20,9 @@ class ChaCha20\n     void SetKey(const unsigned char* key, size_t keylen);\n     void SetIV(uint64_t iv);\n     void Seek(uint64_t pos);\n-    void Output(unsigned char* output, size_t bytes);\n+\n+    void Output(unsigned char* c, size_t bytes);\n+    void Crypt(const unsigned char* input, unsigned char* output, size_t bytes);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280834907",
      "id" : 280834907,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDgzNDkwNw==",
      "original_commit_id" : "427b49dcdbfb25153ee4228dda49aa07db16d59c",
      "original_position" : 7,
      "path" : "src/crypto/chacha20.h",
      "position" : 28,
      "pull_request_review_id" : 233547521,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280834907",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280836054"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280836054"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: This function should be renamed `Keystream` now that the class is not just used for PRNG",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-05-03T16:06:32Z",
      "diff_hunk" : "@@ -20,7 +20,9 @@ class ChaCha20\n     void SetKey(const unsigned char* key, size_t keylen);\n     void SetIV(uint64_t iv);\n     void Seek(uint64_t pos);\n-    void Output(unsigned char* output, size_t bytes);\n+\n+    void Output(unsigned char* c, size_t bytes);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280836054",
      "id" : 280836054,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDgzNjA1NA==",
      "original_commit_id" : "427b49dcdbfb25153ee4228dda49aa07db16d59c",
      "original_position" : 6,
      "path" : "src/crypto/chacha20.h",
      "position" : null,
      "pull_request_review_id" : 233547521,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280836054",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280836767"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280836767"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This test seems redundant to me. How could it ever fail if the test above succeeds?",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-05-03T16:08:56Z",
      "diff_hunk" : "@@ -187,17 +187,36 @@ static void TestAES256CBC(const std::string &hexkey, const std::string &hexiv, b\n     }\n }\n \n-static void TestChaCha20(const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n+static void TestChaCha20(const std::string &hex_message, const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n {\n     std::vector<unsigned char> key = ParseHex(hexkey);\n+    std::vector<unsigned char> m = ParseHex(hex_message);\n     ChaCha20 rng(key.data(), key.size());\n     rng.SetIV(nonce);\n     rng.Seek(seek);\n     std::vector<unsigned char> out = ParseHex(hexout);\n     std::vector<unsigned char> outres;\n     outres.resize(out.size());\n-    rng.Output(outres.data(), outres.size());\n+    assert(hex_message.empty() || m.size() == out.size());\n+\n+    // perform the ChaCha20 round(s), if message is provided it will output the encrypted ciphertext otherwise the keystream\n+    if (!hex_message.empty()) {\n+        rng.Crypt(m.data(), outres.data(), outres.size());\n+    } else {\n+        rng.Output(outres.data(), outres.size());\n+    }\n     BOOST_CHECK(out == outres);\n+    if (!hex_message.empty()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280836767",
      "id" : 280836767,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDgzNjc2Nw==",
      "original_commit_id" : "427b49dcdbfb25153ee4228dda49aa07db16d59c",
      "original_position" : 25,
      "path" : "src/test/crypto_tests.cpp",
      "position" : 25,
      "pull_request_review_id" : 233547521,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280836767",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280853494"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280853494"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280836767\r\n\r\nNot sure exactly what you want to get rid of, but if you're talking about the `out == outres` check below, I suggested it and think it'd be better to keep, because it means if the test passes you can be reassured that Crypt() and Output() results are consistent without manually verifying `4c616 ^ 6e2e3 == 224f5`... in the test cases.",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-05-03T17:03:02Z",
      "diff_hunk" : "@@ -187,17 +187,36 @@ static void TestAES256CBC(const std::string &hexkey, const std::string &hexiv, b\n     }\n }\n \n-static void TestChaCha20(const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n+static void TestChaCha20(const std::string &hex_message, const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n {\n     std::vector<unsigned char> key = ParseHex(hexkey);\n+    std::vector<unsigned char> m = ParseHex(hex_message);\n     ChaCha20 rng(key.data(), key.size());\n     rng.SetIV(nonce);\n     rng.Seek(seek);\n     std::vector<unsigned char> out = ParseHex(hexout);\n     std::vector<unsigned char> outres;\n     outres.resize(out.size());\n-    rng.Output(outres.data(), outres.size());\n+    assert(hex_message.empty() || m.size() == out.size());\n+\n+    // perform the ChaCha20 round(s), if message is provided it will output the encrypted ciphertext otherwise the keystream\n+    if (!hex_message.empty()) {\n+        rng.Crypt(m.data(), outres.data(), outres.size());\n+    } else {\n+        rng.Output(outres.data(), outres.size());\n+    }\n     BOOST_CHECK(out == outres);\n+    if (!hex_message.empty()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280853494",
      "id" : 280853494,
      "in_reply_to_id" : 280836767,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDg1MzQ5NA==",
      "original_commit_id" : "427b49dcdbfb25153ee4228dda49aa07db16d59c",
      "original_position" : 25,
      "path" : "src/test/crypto_tests.cpp",
      "position" : 25,
      "pull_request_review_id" : 233573706,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280853494",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280881759"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280881759"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Renamed to `Keystream`",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-05-03T18:27:22Z",
      "diff_hunk" : "@@ -20,7 +20,9 @@ class ChaCha20\n     void SetKey(const unsigned char* key, size_t keylen);\n     void SetIV(uint64_t iv);\n     void Seek(uint64_t pos);\n-    void Output(unsigned char* output, size_t bytes);\n+\n+    void Output(unsigned char* c, size_t bytes);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280881759",
      "id" : 280881759,
      "in_reply_to_id" : 280836054,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDg4MTc1OQ==",
      "original_commit_id" : "427b49dcdbfb25153ee4228dda49aa07db16d59c",
      "original_position" : 6,
      "path" : "src/crypto/chacha20.h",
      "position" : null,
      "pull_request_review_id" : 233610331,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280881759",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280883499"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280883499"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The IETF has a slightly modified recommendation AFAIK.\r\nWe use Bernstein-Vanilly 64bit nonce and 64bit block counter.\r\n\r\n* Changed the class comment\r\n* Added some function comments",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-05-03T18:32:33Z",
      "diff_hunk" : "@@ -20,7 +20,9 @@ class ChaCha20\n     void SetKey(const unsigned char* key, size_t keylen);\n     void SetIV(uint64_t iv);\n     void Seek(uint64_t pos);\n-    void Output(unsigned char* output, size_t bytes);\n+\n+    void Output(unsigned char* c, size_t bytes);\n+    void Crypt(const unsigned char* input, unsigned char* output, size_t bytes);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280883499",
      "id" : 280883499,
      "in_reply_to_id" : 280834907,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDg4MzQ5OQ==",
      "original_commit_id" : "427b49dcdbfb25153ee4228dda49aa07db16d59c",
      "original_position" : 7,
      "path" : "src/crypto/chacha20.h",
      "position" : 28,
      "pull_request_review_id" : 233612626,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280883499",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280897800"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280897800"
         }
      },
      "author_association" : "MEMBER",
      "body" : "micronit: same line or braces for while code block please! Same for while block in `HASH()` below.",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-05-03T19:17:26Z",
      "diff_hunk" : "@@ -0,0 +1,72 @@\n+// Copyright (c) 2019 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <iostream>\n+\n+#include <bench/bench.h>\n+#include <hash.h>\n+#include <crypto/chacha20.h>\n+\n+/* Number of bytes to process per iteration */\n+static const uint64_t BUFFER_SIZE_TINY  = 64;\n+static const uint64_t BUFFER_SIZE_SMALL = 256;\n+static const uint64_t BUFFER_SIZE_LARGE = 1024*1024;\n+\n+static void CHACHA20(benchmark::State& state, size_t buffersize)\n+{\n+    std::vector<uint8_t> key(32,0);\n+    ChaCha20 ctx(key.data(), key.size());\n+    ctx.SetIV(0);\n+    ctx.Seek(0);\n+    std::vector<uint8_t> in(buffersize,0);\n+    std::vector<uint8_t> out(buffersize,0);\n+    while (state.KeepRunning())\n+        ctx.Crypt(in.data(), out.data(), in.size());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280897800",
      "id" : 280897800,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDg5NzgwMA==",
      "original_commit_id" : "66d682bfc3c5d31a84c26d344cbc19897bb26a87",
      "original_position" : 25,
      "path" : "src/bench/chacha20.cpp",
      "position" : 25,
      "pull_request_review_id" : 233630987,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280897800",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280897984"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280897984"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Is a reason you've added these `CHash256` benchmarks to chacha20.cpp?",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-05-03T19:18:10Z",
      "diff_hunk" : "@@ -0,0 +1,72 @@\n+// Copyright (c) 2019 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <iostream>\n+\n+#include <bench/bench.h>\n+#include <hash.h>\n+#include <crypto/chacha20.h>\n+\n+/* Number of bytes to process per iteration */\n+static const uint64_t BUFFER_SIZE_TINY  = 64;\n+static const uint64_t BUFFER_SIZE_SMALL = 256;\n+static const uint64_t BUFFER_SIZE_LARGE = 1024*1024;\n+\n+static void CHACHA20(benchmark::State& state, size_t buffersize)\n+{\n+    std::vector<uint8_t> key(32,0);\n+    ChaCha20 ctx(key.data(), key.size());\n+    ctx.SetIV(0);\n+    ctx.Seek(0);\n+    std::vector<uint8_t> in(buffersize,0);\n+    std::vector<uint8_t> out(buffersize,0);\n+    while (state.KeepRunning())\n+        ctx.Crypt(in.data(), out.data(), in.size());\n+}\n+\n+static void HASH(benchmark::State& state, size_t buffersize)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280897984",
      "id" : 280897984,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDg5Nzk4NA==",
      "original_commit_id" : "66d682bfc3c5d31a84c26d344cbc19897bb26a87",
      "original_position" : 28,
      "path" : "src/bench/chacha20.cpp",
      "position" : null,
      "pull_request_review_id" : 233630987,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280897984",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280922853"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280922853"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I added if for comparison and the impact on the networking... though I think it belong to an extra commit in https://github.com/bitcoin/bitcoin/pull/15649\r\nWill remove it from here.",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-05-03T20:43:27Z",
      "diff_hunk" : "@@ -0,0 +1,72 @@\n+// Copyright (c) 2019 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <iostream>\n+\n+#include <bench/bench.h>\n+#include <hash.h>\n+#include <crypto/chacha20.h>\n+\n+/* Number of bytes to process per iteration */\n+static const uint64_t BUFFER_SIZE_TINY  = 64;\n+static const uint64_t BUFFER_SIZE_SMALL = 256;\n+static const uint64_t BUFFER_SIZE_LARGE = 1024*1024;\n+\n+static void CHACHA20(benchmark::State& state, size_t buffersize)\n+{\n+    std::vector<uint8_t> key(32,0);\n+    ChaCha20 ctx(key.data(), key.size());\n+    ctx.SetIV(0);\n+    ctx.Seek(0);\n+    std::vector<uint8_t> in(buffersize,0);\n+    std::vector<uint8_t> out(buffersize,0);\n+    while (state.KeepRunning())\n+        ctx.Crypt(in.data(), out.data(), in.size());\n+}\n+\n+static void HASH(benchmark::State& state, size_t buffersize)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280922853",
      "id" : 280922853,
      "in_reply_to_id" : 280897984,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDkyMjg1Mw==",
      "original_commit_id" : "66d682bfc3c5d31a84c26d344cbc19897bb26a87",
      "original_position" : 28,
      "path" : "src/bench/chacha20.cpp",
      "position" : null,
      "pull_request_review_id" : 233663959,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280922853",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280923476"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280923476"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I had it in the initial version like @jnewbery just proposed.\r\nAfter @sipa recommended to separate it, I thought that a strict separation may be beneficial for verification and later optimizations. But maybe @sipa can clarify...",
      "commit_id" : "c8df2c065566e2c7fcd41e2fef669420043d6734",
      "created_at" : "2019-05-03T20:45:30Z",
      "diff_hunk" : "@@ -71,7 +71,7 @@ void ChaCha20::Seek(uint64_t pos)\n     input[13] = pos >> 32;\n }\n \n-void ChaCha20::Output(unsigned char* c, size_t bytes)\n+void ChaCha20::Output(const unsigned char* m, unsigned char* c, size_t bytes)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280923476",
      "id" : 280923476,
      "in_reply_to_id" : 269692281,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDkyMzQ3Ng==",
      "original_commit_id" : "9d3ea6a77693f366c57d6f706665eb989deafb9c",
      "original_position" : 5,
      "path" : "src/crypto/chacha20.cpp",
      "position" : null,
      "pull_request_review_id" : 233664806,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
      "updated_at" : "2019-05-03T20:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280923476",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   }
]
