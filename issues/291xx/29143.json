{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "Fixes https://github.com/bitcoin/bitcoin/issues/29073\r\nCalling `unloadwallet` first marks that wallet for unloading and then unloads it. If the unloading does not finish in time and `unloadwallet` is called again for the same wallet an assertion error is thrown `wallet/wallet.cpp:246: void wallet::UnloadWallet(std::shared_ptr<CWallet> &&): Assertion it.second` which is not descriptive. The test in issue https://github.com/bitcoin/bitcoin/issues/29073 is sometimes failing due to that assertion. This pull request fixes that by changing the error returned from RPC to `Wallet already marked for unloading` and takes that into account for the test. Maybe it even makes sense to do nothing if the case above happens which will not require changes to the test since no error is returned.",
   "closed_at" : "2023-12-29T21:19:16Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/33068296?v=4",
      "events_url" : "https://api.github.com/users/dimitaracev/events{/privacy}",
      "followers_url" : "https://api.github.com/users/dimitaracev/followers",
      "following_url" : "https://api.github.com/users/dimitaracev/following{/other_user}",
      "gists_url" : "https://api.github.com/users/dimitaracev/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/dimitaracev",
      "id" : 33068296,
      "login" : "dimitaracev",
      "node_id" : "MDQ6VXNlcjMzMDY4Mjk2",
      "organizations_url" : "https://api.github.com/users/dimitaracev/orgs",
      "received_events_url" : "https://api.github.com/users/dimitaracev/received_events",
      "repos_url" : "https://api.github.com/users/dimitaracev/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/dimitaracev/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/dimitaracev/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/dimitaracev"
   },
   "comments" : 9,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29143/comments",
   "created_at" : "2023-12-26T18:29:52Z",
   "draft" : false,
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29143/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/29143",
   "id" : 2056618881,
   "labels" : [
      {
         "color" : "08a781",
         "default" : false,
         "description" : null,
         "id" : 149424,
         "name" : "Wallet",
         "node_id" : "MDU6TGFiZWwxNDk0MjQ=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet"
      },
      {
         "color" : "cccccc",
         "default" : false,
         "description" : "",
         "id" : 5334691551,
         "name" : "CI failed",
         "node_id" : "LA_kwDOABII588AAAABPfju3w",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29143/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "PR_kwDOABII585iylOb",
   "number" : 29143,
   "performed_via_github_app" : null,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/29143.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29143",
      "merged_at" : null,
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/29143.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29143"
   },
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29143/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "state_reason" : null,
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29143/timeline",
   "title" : "wallet: move lock to the top of ReleaseWallet",
   "updated_at" : "2023-12-29T21:23:12Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29143",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/33068296?v=4",
      "events_url" : "https://api.github.com/users/dimitaracev/events{/privacy}",
      "followers_url" : "https://api.github.com/users/dimitaracev/followers",
      "following_url" : "https://api.github.com/users/dimitaracev/following{/other_user}",
      "gists_url" : "https://api.github.com/users/dimitaracev/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/dimitaracev",
      "id" : 33068296,
      "login" : "dimitaracev",
      "node_id" : "MDQ6VXNlcjMzMDY4Mjk2",
      "organizations_url" : "https://api.github.com/users/dimitaracev/orgs",
      "received_events_url" : "https://api.github.com/users/dimitaracev/received_events",
      "repos_url" : "https://api.github.com/users/dimitaracev/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/dimitaracev/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/dimitaracev/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/dimitaracev"
   }
}
