[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/29198).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept NACK | [michaelfolkson](https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1883319863) |\n| Concept ACK | [jonatack](https://github.com/bitcoin/bitcoin/pull/29198#pullrequestreview-1807864193), [moonsettler](https://github.com/bitcoin/bitcoin/pull/29198#pullrequestreview-1807867192), [hsjoberg](https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1880182827), [niteshbalusu11](https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1882399978), [1440000bytes](https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1882769175), [chrisguida](https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1889953978) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29247](https://github.com/bitcoin/bitcoin/pull/29247) (Reenable OP_CAT by 0xBEEFCAF3)\n* [#29221](https://github.com/bitcoin/bitcoin/pull/29221) (Implement 64 bit arithmetic op codes in the Script interpreter by Christewart)\n* [#29134](https://github.com/bitcoin/bitcoin/pull/29134) (Compressed Bitcoin Transactions by TomBriar)\n* [#29050](https://github.com/bitcoin/bitcoin/pull/29050) (Add OP_TXHASH and OP_CHECKTXHASHVERIFY opcodes by stevenroose)\n* [#29039](https://github.com/bitcoin/bitcoin/pull/29039) (versionbits refactoring by ajtowns)\n* [#28806](https://github.com/bitcoin/bitcoin/pull/28806) (rpc: Add script verification flags to getdeploymentinfo by ajtowns)\n* [#28710](https://github.com/bitcoin/bitcoin/pull/28710) (Remove the legacy wallet and BDB dependency by achow101)\n* [#28550](https://github.com/bitcoin/bitcoin/pull/28550) (Covenant tools softfork by jamesob)\n* [#28334](https://github.com/bitcoin/bitcoin/pull/28334) (policy: Allow non-standard scripts with -acceptnonstdtxn=1 by ajtowns)\n* [#27433](https://github.com/bitcoin/bitcoin/pull/27433) (getblocktemplate improvements for segwit and sigops by Sjors)\n* [#26840](https://github.com/bitcoin/bitcoin/pull/26840) (refactor: importpubkey, importprivkey, importaddress, importmulti, and importdescriptors rpc by KolbyML)\n* [#26201](https://github.com/bitcoin/bitcoin/pull/26201) (Remove Taproot activation height by Sjors)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2024-01-07T18:35:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1880136976",
      "id" : 1880136976,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wEJ0Q",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1880136976/reactions"
      },
      "updated_at" : "2024-01-15T02:50:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1880136976",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This should be opened to bitcoin-inquisition rather than this repo at this stage? I thought that was the whole point of bitcoin-inquisition.\r\n\r\nI'm interested in why you think LN-Symmetry would be better implemented not using APO but perhaps that discussion can be had elsewhere.",
      "created_at" : "2024-01-07T18:47:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1880139852",
      "id" : 1880139852,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wEKhM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 1,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1880139852/reactions"
      },
      "updated_at" : "2024-01-07T18:47:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1880139852",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> This should be opened to bitcoin-inquisition rather than this repo at this stage? I thought that was the whole point of bitcoin-inquisition.\r\n\r\nLet's focus on code review. There is no strict process suggesting that code first flow through inquisition.\r\n\r\n> I'm interested in why you think LN-Symmetry would be better implemented not using APO but perhaps that discussion can be had elsewhere.\r\n\r\nHappy to discuss [on delving](https://delvingbitcoin.org/t/lnhance-bips-and-implementation/376)\r\n\r\n",
      "created_at" : "2024-01-07T19:06:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1880144215",
      "id" : 1880144215,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wELlX",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 2,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 2,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1880144215/reactions"
      },
      "updated_at" : "2024-01-07T19:06:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1880144215",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/730881?v=4",
         "events_url" : "https://api.github.com/users/reardencode/events{/privacy}",
         "followers_url" : "https://api.github.com/users/reardencode/followers",
         "following_url" : "https://api.github.com/users/reardencode/following{/other_user}",
         "gists_url" : "https://api.github.com/users/reardencode/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/reardencode",
         "id" : 730881,
         "login" : "reardencode",
         "node_id" : "MDQ6VXNlcjczMDg4MQ==",
         "organizations_url" : "https://api.github.com/users/reardencode/orgs",
         "received_events_url" : "https://api.github.com/users/reardencode/received_events",
         "repos_url" : "https://api.github.com/users/reardencode/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/reardencode/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/reardencode/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/reardencode"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1444065001"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1444065001"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit 6d93e3a79f42791a8caccf58dc8eb2f1981bace3, the Tidy CI task https://cirrus-ci.com/task/5701906522177536?logs=ci#L3173 wants appeasing\r\n\r\n``` \r\nscript/interpreter.cpp:1320:27: error: use emplace_back instead of push_back [modernize-use-emplace,-warnings-as-errors]\r\n 1320 |                     stack.push_back(std::vector<unsigned char>{execdata.m_internal_key.begin(), execdata.m_internal_key.end()});\r\n      |                           ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                                                              ~\r\n      |                           emplace_back(\r\n```\r\n",
      "commit_id" : "ec96ee5da90bfa04c286781641cfb303bc885503",
      "created_at" : "2024-01-07T20:09:09Z",
      "diff_hunk" : "@@ -1213,6 +1309,56 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n                 }\n                 break;\n \n+                case OP_INTERNALKEY:\n+                {\n+                    // OP_INTERNALKEY is only available in Tapscript\n+                    if (sigversion == SigVersion::BASE || sigversion == SigVersion::WITNESS_V0) return set_error(serror, SCRIPT_ERR_BAD_OPCODE);\n+                    if (flags & SCRIPT_VERIFY_DISCOURAGE_LNHANCE) {\n+                        return set_error(serror, SCRIPT_ERR_DISCOURAGE_OP_SUCCESS);\n+                    }\n+\n+                    stack.push_back(std::vector<unsigned char>{execdata.m_internal_key.begin(), execdata.m_internal_key.end()});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1444065001",
      "id" : 1444065001,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585WEq7p",
      "original_commit_id" : "c677b3ee9f8b61d26d1677edc9afb854ddaf5509",
      "original_line" : 1320,
      "original_position" : 124,
      "original_start_line" : null,
      "path" : "src/script/interpreter.cpp",
      "position" : null,
      "pull_request_review_id" : 1807864193,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1444065001/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-07T20:29:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1444065001",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1444069529"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1444069529"
         }
      },
      "author_association" : "NONE",
      "body" : "tyvm! fixed, rebased, and a couple of formatting things fixed.",
      "commit_id" : "ec96ee5da90bfa04c286781641cfb303bc885503",
      "created_at" : "2024-01-07T20:43:11Z",
      "diff_hunk" : "@@ -1213,6 +1309,56 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n                 }\n                 break;\n \n+                case OP_INTERNALKEY:\n+                {\n+                    // OP_INTERNALKEY is only available in Tapscript\n+                    if (sigversion == SigVersion::BASE || sigversion == SigVersion::WITNESS_V0) return set_error(serror, SCRIPT_ERR_BAD_OPCODE);\n+                    if (flags & SCRIPT_VERIFY_DISCOURAGE_LNHANCE) {\n+                        return set_error(serror, SCRIPT_ERR_DISCOURAGE_OP_SUCCESS);\n+                    }\n+\n+                    stack.push_back(std::vector<unsigned char>{execdata.m_internal_key.begin(), execdata.m_internal_key.end()});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1444069529",
      "id" : 1444069529,
      "in_reply_to_id" : 1444065001,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585WEsCZ",
      "original_commit_id" : "c677b3ee9f8b61d26d1677edc9afb854ddaf5509",
      "original_line" : 1320,
      "original_position" : 124,
      "original_start_line" : null,
      "path" : "src/script/interpreter.cpp",
      "position" : null,
      "pull_request_review_id" : 1807867874,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1444069529/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-07T20:43:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1444069529",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/730881?v=4",
         "events_url" : "https://api.github.com/users/reardencode/events{/privacy}",
         "followers_url" : "https://api.github.com/users/reardencode/followers",
         "following_url" : "https://api.github.com/users/reardencode/following{/other_user}",
         "gists_url" : "https://api.github.com/users/reardencode/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/reardencode",
         "id" : 730881,
         "login" : "reardencode",
         "node_id" : "MDQ6VXNlcjczMDg4MQ==",
         "organizations_url" : "https://api.github.com/users/reardencode/orgs",
         "received_events_url" : "https://api.github.com/users/reardencode/received_events",
         "repos_url" : "https://api.github.com/users/reardencode/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/reardencode/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/reardencode/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/reardencode"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1444070159"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1444070159"
         }
      },
      "author_association" : "NONE",
      "body" : "`case OP_NOP1:` was removed (by accident?). Should it be added back to L691? \r\nEdit: sorry, misread, already done.",
      "commit_id" : "ec96ee5da90bfa04c286781641cfb303bc885503",
      "created_at" : "2024-01-07T20:48:42Z",
      "diff_hunk" : "@@ -591,7 +652,42 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n                     break;\n                 }\n \n-                case OP_NOP1: case OP_NOP4: case OP_NOP5:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1444070159",
      "id" : 1444070159,
      "line" : 594,
      "node_id" : "PRRC_kwDOABII585WEsMP",
      "original_commit_id" : "ec96ee5da90bfa04c286781641cfb303bc885503",
      "original_line" : 594,
      "original_position" : 72,
      "original_start_line" : null,
      "path" : "src/script/interpreter.cpp",
      "position" : 72,
      "pull_request_review_id" : 1807868424,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1444070159/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-07T20:49:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1444070159",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/93376500?v=4",
         "events_url" : "https://api.github.com/users/callebtc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/callebtc/followers",
         "following_url" : "https://api.github.com/users/callebtc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/callebtc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/callebtc",
         "id" : 93376500,
         "login" : "callebtc",
         "node_id" : "U_kgDOBZDP9A",
         "organizations_url" : "https://api.github.com/users/callebtc/orgs",
         "received_events_url" : "https://api.github.com/users/callebtc/received_events",
         "repos_url" : "https://api.github.com/users/callebtc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/callebtc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/callebtc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/callebtc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1444070926"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1444070926"
         }
      },
      "author_association" : "NONE",
      "body" : "Git diff. Making life unnecessarily hard sometimes.",
      "commit_id" : "ec96ee5da90bfa04c286781641cfb303bc885503",
      "created_at" : "2024-01-07T20:54:14Z",
      "diff_hunk" : "@@ -591,7 +652,42 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n                     break;\n                 }\n \n-                case OP_NOP1: case OP_NOP4: case OP_NOP5:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1444070926",
      "id" : 1444070926,
      "in_reply_to_id" : 1444070159,
      "line" : 594,
      "node_id" : "PRRC_kwDOABII585WEsYO",
      "original_commit_id" : "ec96ee5da90bfa04c286781641cfb303bc885503",
      "original_line" : 594,
      "original_position" : 72,
      "original_start_line" : null,
      "path" : "src/script/interpreter.cpp",
      "position" : 72,
      "pull_request_review_id" : 1807869019,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1444070926/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-07T20:54:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1444070926",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/730881?v=4",
         "events_url" : "https://api.github.com/users/reardencode/events{/privacy}",
         "followers_url" : "https://api.github.com/users/reardencode/followers",
         "following_url" : "https://api.github.com/users/reardencode/following{/other_user}",
         "gists_url" : "https://api.github.com/users/reardencode/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/reardencode",
         "id" : 730881,
         "login" : "reardencode",
         "node_id" : "MDQ6VXNlcjczMDg4MQ==",
         "organizations_url" : "https://api.github.com/users/reardencode/orgs",
         "received_events_url" : "https://api.github.com/users/reardencode/received_events",
         "repos_url" : "https://api.github.com/users/reardencode/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/reardencode/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/reardencode/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/reardencode"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit 0ac5cf9141441ea539d2f345d0d516d24a2f77bd\r\n\r\n```\r\n$ ./src/test/test_bitcoin -t transaction_tests\r\nRunning 7 test cases...\r\ntest/transaction_tests.cpp:192: error: in \"transaction_tests/tx_valid\": mapFlagNames is missing a script verification flag\r\n```\r\n\r\nEdit: 4371ffefef2 two commits later appears to contain the missing change. Can wait until next need to push for something else.",
      "created_at" : "2024-01-07T21:29:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1880180224",
      "id" : 1880180224,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wEUYA",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1880180224/reactions"
      },
      "updated_at" : "2024-01-08T19:29:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1880180224",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK; this would make pretty much all sides happy.",
      "created_at" : "2024-01-07T21:35:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1880182827",
      "id" : 1880182827,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wEVAr",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1880182827/reactions"
      },
      "updated_at" : "2024-01-07T21:35:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1880182827",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3824379?v=4",
         "events_url" : "https://api.github.com/users/hsjoberg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hsjoberg/followers",
         "following_url" : "https://api.github.com/users/hsjoberg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hsjoberg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hsjoberg",
         "id" : 3824379,
         "login" : "hsjoberg",
         "node_id" : "MDQ6VXNlcjM4MjQzNzk=",
         "organizations_url" : "https://api.github.com/users/hsjoberg/orgs",
         "received_events_url" : "https://api.github.com/users/hsjoberg/received_events",
         "repos_url" : "https://api.github.com/users/hsjoberg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hsjoberg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hsjoberg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hsjoberg"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Force pushed to fix clean commits.",
      "created_at" : "2024-01-08T19:27:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1881695275",
      "id" : 1881695275,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wKGQr",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1881695275/reactions"
      },
      "updated_at" : "2024-01-08T19:27:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1881695275",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/730881?v=4",
         "events_url" : "https://api.github.com/users/reardencode/events{/privacy}",
         "followers_url" : "https://api.github.com/users/reardencode/followers",
         "following_url" : "https://api.github.com/users/reardencode/following{/other_user}",
         "gists_url" : "https://api.github.com/users/reardencode/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/reardencode",
         "id" : 730881,
         "login" : "reardencode",
         "node_id" : "MDQ6VXNlcjczMDg4MQ==",
         "organizations_url" : "https://api.github.com/users/reardencode/orgs",
         "received_events_url" : "https://api.github.com/users/reardencode/received_events",
         "repos_url" : "https://api.github.com/users/reardencode/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/reardencode/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/reardencode/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/reardencode"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Concept ACK. ",
      "created_at" : "2024-01-09T04:36:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1882399978",
      "id" : 1882399978,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wMyTq",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1882399978/reactions"
      },
      "updated_at" : "2024-01-09T04:36:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1882399978",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/84944042?v=4",
         "events_url" : "https://api.github.com/users/niteshbalusu11/events{/privacy}",
         "followers_url" : "https://api.github.com/users/niteshbalusu11/followers",
         "following_url" : "https://api.github.com/users/niteshbalusu11/following{/other_user}",
         "gists_url" : "https://api.github.com/users/niteshbalusu11/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/niteshbalusu11",
         "id" : 84944042,
         "login" : "niteshbalusu11",
         "node_id" : "MDQ6VXNlcjg0OTQ0MDQy",
         "organizations_url" : "https://api.github.com/users/niteshbalusu11/orgs",
         "received_events_url" : "https://api.github.com/users/niteshbalusu11/received_events",
         "repos_url" : "https://api.github.com/users/niteshbalusu11/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/niteshbalusu11/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/niteshbalusu11/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/niteshbalusu11"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It seems too early in the process to open a pull request like this. It's also possible to open a pull request against your own repo-fork of Bitcoin Core, or Inquisition as suggested above.\r\n\r\nFor comparison, the first Taproot pull request to this repo #17977 was made in early 2020, which was _after_ about year of in person workshops studying the proposal. The BIP's themselves were first proposed in 2018. The first work-in-progress taproot branch, not a pull request, is also from around [2018](https://github.com/sipa/bitcoin/tree/taproot1).\r\n\r\nThen again, being able to use the full Bitcoin Core CI can help in getting the code in good shape, which in turn is useful in improving the proposal. You can run that locally too in Docker. That said, a few extra (draft) PR's for soft-fork proposals is not a significant drain on (paid for by someone) CI capacity.\r\n\r\n\r\nTypically if a pull request depends on another pull request we mark it as draft. That's not the case here, but it does depend on two BIP proposals that were made only two days ago. We could also use some other tag to indicate that the underlying _proposal_ is still in the concept stage.",
      "created_at" : "2024-01-09T09:05:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1882662121",
      "id" : 1882662121,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wNyTp",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 1,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 2,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1882662121/reactions"
      },
      "updated_at" : "2024-01-09T09:05:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1882662121",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "- A few days back Ava Chow had mentioned on twitter that there is no pull request open for CHECKTEMPLATEVERIFY:\r\n\r\n  https://x.com/achow101/status/1742427508488729044\r\n  https://x.com/achow101/status/1742555598003048753\r\n  \r\n- There were some misunderstandings about unaddressed issues related to previous pull request:\r\n   \r\n   https://x.com/JeremyRubin/status/1742582215354019956\r\n   \r\n- Since @reardencode was already working on CHECKSIGFROMSTACK and INTERNALKEY to be used in combination with CHECKTEMPLATEVERIFY, I think it makes sense to open this pull request in bitcoin core repository for code review.\r\n\r\n- There have been several meetings and workshops for CHECKTEMPLATEVERIFY: https://utxos.org/workshops/. I am not sure if CHECKSIGFROMSTACK and INTERNALKEY need workshops or LNHANCE however they could be done with the pull request open as well.\r\n\r\n- For comparison, https://github.com/bitcoin/bitcoin/pull/29050 was opened recently and still looks in conceptual stage with unaddressed comments on BIP, incomplete implementation and still open for code review in bitcoin core repository instead of inquisition.\r\n\r\n> Then again, being able to use the full Bitcoin Core CI can help in getting the code in good shape, which in turn is useful in improving the proposal. You can run that locally too in Docker. That said, a few extra (draft) PR's for soft-fork proposals is not a significant drain on (paid for by someone) CI capacity.\r\n\r\nAgree",
      "created_at" : "2024-01-09T10:06:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1882769175",
      "id" : 1882769175,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wOMcX",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1882769175/reactions"
      },
      "updated_at" : "2024-01-09T10:06:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1882769175",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/147166694?v=4",
         "events_url" : "https://api.github.com/users/1440000bytes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/1440000bytes/followers",
         "following_url" : "https://api.github.com/users/1440000bytes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/1440000bytes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/1440000bytes",
         "id" : 147166694,
         "login" : "1440000bytes",
         "node_id" : "U_kgDOCMWV5g",
         "organizations_url" : "https://api.github.com/users/1440000bytes/orgs",
         "received_events_url" : "https://api.github.com/users/1440000bytes/received_events",
         "repos_url" : "https://api.github.com/users/1440000bytes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/1440000bytes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/1440000bytes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/1440000bytes"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> A few days back Ava Chow had mentioned on twitter that there is no pull request open for CHECKTEMPLATEVERIFY:\r\n\r\nThere is a [pull request](https://github.com/bitcoin/bitcoin/pull/28550) open (in draft) that contains CTV in addition to other opcodes and sighash flags (ie proposed consensus changes).\r\n\r\nYou don't have to be an expert in combinatorics to realize that continuing down this path results in multiple pull requests to this repo from different authors with different combinations of opcodes and sighash flags depending on the PR author's individual preference. That was one of the major motivations for bitcoin-inquisition where multiple opcodes and sighash flags can be activated on the default signet not creating noise in this repo and allowing both review and experimentation with new opcodes and sighash flags that may or may not ever get activated on mainnet. If for some reason bitcoin-inquisition isn't to the PR author's tastes (I\"m not aware of any problems so far) the same can be done on a custom signet with a different fork of this repo. \r\n\r\nI totally agree with Sjors. The approach taken here of avoiding steps other soft fork proposals have gone through and just assuming shortcuts can be taken is a massive backwards step and I suspect won't achieve anything except creating more unnecessary noise in this repo.\r\n\r\n",
      "created_at" : "2024-01-09T10:34:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1882816237",
      "id" : 1882816237,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wOX7t",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1882816237/reactions"
      },
      "updated_at" : "2024-01-09T10:34:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1882816237",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Hi Sjors, thanks for your thoughts!\r\n\r\n> It seems too early in the process to open a pull request like this. It's also possible to open a pull request against your own repo-fork of Bitcoin Core, or Inquisition as suggested above.\r\n\r\nI'm not aware of a well defined process for making changes to bitcoin consensus (nor do I think there should be one), so I'm not sure how we can be too early in the process.\r\n\r\nCTV had (a  year of?) workshops and review with Jeremy Rubin about 2 years ago. OP_INTERNALKEY is a binary in terms of the concept - either we're OK with it or we're not, no discussion, so no reason to delay the code review. CSFS does have a few points that could be discussed (and weren't discussed years ago on the mailing list because Taproot wasn't active at the time) and I'd love to discuss those on my bips PR. Fortunately they'd be just a few lines of code and tests to change whichever direction we go on them.\r\n\r\nEdit to add: CTV is already in inquisition, btw, and is the bulk of this PR.\r\n\r\n> For comparison, the first Taproot pull request to this repo #17977 was made in early 2020, which was _after_ about year of in person workshops studying the proposal. The BIP's themselves were first proposed in 2018. The first work-in-progress taproot branch, not a pull request, is also from around [2018](https://github.com/sipa/bitcoin/tree/taproot1).\r\n\r\nTaproot was a new witness program version, new script system, and new signing system. It is obviously not appropriate to follow the same path here as there.\r\n\r\n> Typically if a pull request depends on another pull request we mark it as draft. That's not the case here, but it does depend on two BIP proposals that were made only two days ago. We could also use some other tag to indicate that the underlying _proposal_ is still in the concept stage.\r\n\r\nI disagree that the underlying proposal is at the concept stage. CTV conceptually was settled years ago, INTERNALKEY (as I said) is a simple binary decision with no room for conceptual discussion really, and CSFS does have a few minor points that can be incorporated here easily if my decisions do not match those of the broader dev community.\r\n\r\nI'd very much appreciate further _code_ review here.",
      "created_at" : "2024-01-09T14:42:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1883175973",
      "id" : 1883175973,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wPvwl",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1883175973/reactions"
      },
      "updated_at" : "2024-01-09T15:16:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1883175973",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/730881?v=4",
         "events_url" : "https://api.github.com/users/reardencode/events{/privacy}",
         "followers_url" : "https://api.github.com/users/reardencode/followers",
         "following_url" : "https://api.github.com/users/reardencode/following{/other_user}",
         "gists_url" : "https://api.github.com/users/reardencode/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/reardencode",
         "id" : 730881,
         "login" : "reardencode",
         "node_id" : "MDQ6VXNlcjczMDg4MQ==",
         "organizations_url" : "https://api.github.com/users/reardencode/orgs",
         "received_events_url" : "https://api.github.com/users/reardencode/received_events",
         "repos_url" : "https://api.github.com/users/reardencode/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/reardencode/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/reardencode/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/reardencode"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "From the [contributing guidelines](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review)\r\n\r\n> **After** conceptual agreement on the change, code review can be provided.\r\n\r\nI can only speak for myself obviously but Concept NACK from me for this repo at the current time. This pull request should be opened to bitcoin-inquisition or a fork of Core with its own custom signet consensus rules. ",
      "created_at" : "2024-01-09T15:02:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1883215894",
      "id" : 1883215894,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wP5gW",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 1,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1883215894/reactions"
      },
      "updated_at" : "2024-01-09T15:02:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1883215894",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> From the [contributing guidelines](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review)\r\n> \r\n> > **After** conceptual agreement on the change, code review can be provided.\r\n> \r\n> I can only speak for myself obviously but Concept NACK from me for this repo at the current time. This pull request should be opened to bitcoin-inquisition or a fork of Core with its own custom signet consensus rules.\r\n\r\nYou are clearly commenting in bad faith. But in the off chance you want to pretend to be consistent, here is an other PR for you to litter with your unsolicited non-technical negativity:\r\n\r\nhttps://github.com/bitcoin/bitcoin/pull/28550",
      "created_at" : "2024-01-09T15:25:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1883258307",
      "id" : 1883258307,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wQD3D",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1883258307/reactions"
      },
      "updated_at" : "2024-01-09T15:25:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1883258307",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/90689674?v=4",
         "events_url" : "https://api.github.com/users/moonsettler/events{/privacy}",
         "followers_url" : "https://api.github.com/users/moonsettler/followers",
         "following_url" : "https://api.github.com/users/moonsettler/following{/other_user}",
         "gists_url" : "https://api.github.com/users/moonsettler/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/moonsettler",
         "id" : 90689674,
         "login" : "moonsettler",
         "node_id" : "MDQ6VXNlcjkwNjg5Njc0",
         "organizations_url" : "https://api.github.com/users/moonsettler/orgs",
         "received_events_url" : "https://api.github.com/users/moonsettler/received_events",
         "repos_url" : "https://api.github.com/users/moonsettler/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/moonsettler/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/moonsettler/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/moonsettler"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@moonsettler: That PR is in draft, was opened to bitcoin-inquisition simultaneously and doesn't seem to have conceptual agreement at the current time either. Everyone opening their own pull request to this repo with their own favorite combination of opcodes and sighash flags wastes people's time. They will have to come to this pull request and tell you exactly what Sjors and I have already told you. But if you insist that is what they will have to do.",
      "created_at" : "2024-01-09T15:35:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1883279066",
      "id" : 1883279066,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wQI7a",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1883279066/reactions"
      },
      "updated_at" : "2024-01-09T15:35:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1883279066",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Hi @michaelfolkson, can you enumerate a concrete dispute with my proposals (on their respective PRs) or my code here? Otherwise, I'm not sure your comments are contributing to the discussion. You've registered your Concept NACK.",
      "created_at" : "2024-01-09T15:52:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1883309957",
      "id" : 1883309957,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wQQeF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1883309957/reactions"
      },
      "updated_at" : "2024-01-09T15:52:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1883309957",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/730881?v=4",
         "events_url" : "https://api.github.com/users/reardencode/events{/privacy}",
         "followers_url" : "https://api.github.com/users/reardencode/followers",
         "following_url" : "https://api.github.com/users/reardencode/following{/other_user}",
         "gists_url" : "https://api.github.com/users/reardencode/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/reardencode",
         "id" : 730881,
         "login" : "reardencode",
         "node_id" : "MDQ6VXNlcjczMDg4MQ==",
         "organizations_url" : "https://api.github.com/users/reardencode/orgs",
         "received_events_url" : "https://api.github.com/users/reardencode/received_events",
         "repos_url" : "https://api.github.com/users/reardencode/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/reardencode/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/reardencode/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/reardencode"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@reardencode: No, registering my Concept NACK is sufficient. I'll leave it to others to rehash what Sjors and I have already advised and you can choose to ignore them too.",
      "created_at" : "2024-01-09T15:57:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1883319863",
      "id" : 1883319863,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wQS43",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1883319863/reactions"
      },
      "updated_at" : "2024-01-09T15:57:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1883319863",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I'm not aware of a well defined process for making changes to bitcoin consensus (nor do I think there should be one), so I'm not sure how we can be too early in the process.\r\n\r\nHere's a good place to start: https://datatracker.ietf.org/doc/html/rfc7282\r\n\r\n(Non draft) pull requests to Bitcoin Core are not a good way to find consensus. Opening before such consensus most likely decreases of anyone being motivated to review it. \r\n \r\n> CTV had (a year of?) workshops and review with Jeremy Rubin about 2 years ago. OP_INTERNALKEY is a binary in terms of the concept - either we're OK with it or we're not, no discussion, so no reason to delay the code review. CSFS does have a few points that could be discussed (and weren't discussed years ago on the mailing list because Taproot wasn't active at the time) and I'd love to discuss those on my bips PR. Fortunately they'd be just a few lines of code and tests to change whichever direction we go on them.\r\n> \r\n> Edit to add: CTV is already in inquisition, btw, and is the bulk of this PR.\r\n\r\nWhy not focus on getting OP_CTV (close to) merged first, before adding more to it?\r\n\r\nThe first PR #21702 was closed by the author. Presumably it's been worked on more over at Inquisition?\r\n\r\nThere's also a draft PR #28550 for vaults (superseeding #26857), which again includes OP_CTV. Are those exactly the same commits? If so, then why not focus on reviewing and improving (the OP_CTV part of) that PR?\r\n",
      "created_at" : "2024-01-12T19:11:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1889817551",
      "id" : 1889817551,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wpFPP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1889817551/reactions"
      },
      "updated_at" : "2024-01-12T19:11:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1889817551",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> > I'm not aware of a well defined process for making changes to bitcoin consensus (nor do I think there should be one), so I'm not sure how we can be too early in the process.\r\n> \r\n> Here's a good place to start: https://datatracker.ietf.org/doc/html/rfc7282\r\n> \r\n> (Non draft) pull requests to Bitcoin Core are not a good way to find consensus. Opening before such consensus most likely decreases of anyone being motivated to review it.\r\n\r\nAs I mentioned on my [post on delving](https://delvingbitcoin.org/t/on-consensus-changes-in-bitcoin-2024/334/9) it's not clear to me how one reaches consensus on changes to bitcoin's consensus rules. People have also said that they need to see well reviewed and ready code before we can begin reaching consensus, so I have made ready code and asked for review.\r\n\r\n> Why not focus on getting OP_CTV (close to) merged first, before adding more to it?\r\n\r\nI had originally intended to do just that actually, but was given the feedback privately that many folks were not interested in reviewing any ideas for consensus changes that did not enable LN-Symmetry. So here I've made a combined PR which enables LN-Symmetry (with [fewer bytes](https://twitter.com/reardencode/status/1745323291194331488) on chain than APO, it turns out).\r\n\r\n> The first PR #21702 was closed by the author. Presumably it's been worked on more over at Inquisition?\r\n\r\nThe code hasn't changed except for rebasing (and adding what turned out to be unnecessary caching in response to an accidentally flawed benchmark by @jamesob) since 2021. Getting CTV ready is not an available task.\r\n\r\n> There's also a draft PR #28550 for vaults (superseeding #26857), which again includes OP_CTV. Are those exactly the same commits? If so, then why not focus on reviewing and improving (the OP_CTV part of) that PR?\r\n\r\nSee above, the CTV part hasn't changed since 2021. That PR includes VAULT and SIGHASH_ANYPREVOUT, this PR includes CHECKSIGFROMSTACK and INTERNALKEY, and those other parts are what need attention. This set of changes is much more limited in scope than CTV+APO+VAULT - not adding deferred checks, and not modifying existing signature checking code paths.\r\n\r\n-------------------------------\r\n\r\nThanks so much for your time in responding Sjors. What path do you personally recommend for gaining consensus on changing bitcoin's consensus rules? I've heard many things from many different people and this combined proposal with ready code and BIPs is my current best attempt to move toward consensus. (Happy to continue this discussion on delving or here at your discretion)",
      "created_at" : "2024-01-12T19:39:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1889850492",
      "id" : 1889850492,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wpNR8",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 1,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 2,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1889850492/reactions"
      },
      "updated_at" : "2024-01-12T19:39:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1889850492",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/730881?v=4",
         "events_url" : "https://api.github.com/users/reardencode/events{/privacy}",
         "followers_url" : "https://api.github.com/users/reardencode/followers",
         "following_url" : "https://api.github.com/users/reardencode/following{/other_user}",
         "gists_url" : "https://api.github.com/users/reardencode/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/reardencode",
         "id" : 730881,
         "login" : "reardencode",
         "node_id" : "MDQ6VXNlcjczMDg4MQ==",
         "organizations_url" : "https://api.github.com/users/reardencode/orgs",
         "received_events_url" : "https://api.github.com/users/reardencode/received_events",
         "repos_url" : "https://api.github.com/users/reardencode/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/reardencode/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/reardencode/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/reardencode"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Concept ACK\r\n\r\nThis PR seems to be the minimal feature set to get:\r\n- LN-Symmetry,\r\n- much better PTLCs, and\r\n- all of the powerful UTXO-sharing protocols that CTV enables\r\n\r\nRegarding LN-Symmetry, this update will FINALLY enable symmetric channel updates and eliminate the risk of losing all your money due to restoring an old backup. It also massively simplifies the channel state machine, makes on-chain resolution in the case of uncooperative channel closes much less painful, and makes watchtowers much more efficient. There are still some mempool-pinning problems with LN-Symmetry, but my understanding is that these can be fixed down the road with additional mempool work in bitcoind and more tx hashing modes added to CTV (or other, more expressive covenants like TXHASH). Regardless, enabling the LN-Symmetry update mechanism should renew developer interest in the Lightning Network and enable much more capital to be deployed therein.\r\n\r\nCTV+CSFS can also substitute for APO to allow much better PTLCs as described in [this gist](https://gist.github.com/instagibbs/1d02d0251640c250ceea1c66665ec163#single-sig-adaptor-sync-with-anyprevout), which should provide a massive boost in privacy and efficiency for Lightning payments.\r\n\r\nRegarding CTV, the feature I'm most interested in is [Non-Interactive Lightning Channels](https://utxos.org/uses/non-interactive-channels/) (which requires some kind of UTXO-sharing mechanism such as [darkpools](https://gist.github.com/moonsettler/6a214f5d01148ea204e9131b86a35382) or [Ark](https://arkdev.info/)), which can make the onboarding experience for new bitcoiners as magical as it was for new bitcoin users a decade ago, without resorting to custodial wallets. Namely, it allows a new bitcoin user to, for instance, send some fiat to a vendor, then receive a lightning payment in a commitment vTXO that is attached to their public key. If the pool coordinator tries to cheat, they can still do an on-chain transaction to claim their UTXO. So basically this allows new bitcoin users to defer on-chain fees until they've done enough transactions to justify an on-chain tx, instead of having to immediately spend an on-chain fee ($10? $100??) before they've even gotten a chance to try bitcoin.\r\n\r\nI'm unaware of anyone who thinks CTV is unsafe, and I'm unaware of anyone who would be against a fork that activates LN-Symmetry, as long as it doesn't enable [drivechains like APO allegedly does](https://rubin.io/bitcoin/2022/09/14/drivechain-apo/). (BitVM may enable drivechains anyway, so this point may be moot).\r\n\r\nCSFS seems to be the only vector this new featureset could potentially have unforeseen consequences, but it's been running on both Liquid and BCH for years now, so its effects should be reasonably well understood at this point.\r\n\r\nWe've worked hard getting Lightning to where it is today (and LN-Symmetry has been a long time coming!), and it's still got a long way to go, but I'm hopeful that this proposal will energize devs to continue building on Lightning and make it into the future of payments it was always meant to be.",
      "created_at" : "2024-01-12T21:10:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1889953978",
      "id" : 1889953978,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wpmi6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 1,
         "hooray" : 1,
         "laugh" : 0,
         "rocket" : 1,
         "total_count" : 4,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1889953978/reactions"
      },
      "updated_at" : "2024-01-12T23:38:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1889953978",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7445670?v=4",
         "events_url" : "https://api.github.com/users/chrisguida/events{/privacy}",
         "followers_url" : "https://api.github.com/users/chrisguida/followers",
         "following_url" : "https://api.github.com/users/chrisguida/following{/other_user}",
         "gists_url" : "https://api.github.com/users/chrisguida/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/chrisguida",
         "id" : 7445670,
         "login" : "chrisguida",
         "node_id" : "MDQ6VXNlcjc0NDU2NzA=",
         "organizations_url" : "https://api.github.com/users/chrisguida/orgs",
         "received_events_url" : "https://api.github.com/users/chrisguida/received_events",
         "repos_url" : "https://api.github.com/users/chrisguida/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/chrisguida/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/chrisguida/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/chrisguida"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Force pushed to deconflict opcodes with VAULT, add deployment info output, and slightly improve tx_invalid tests.",
      "created_at" : "2024-01-14T15:01:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1890976319",
      "id" : 1890976319,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wtgI_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1890976319/reactions"
      },
      "updated_at" : "2024-01-14T15:01:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1890976319",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/730881?v=4",
         "events_url" : "https://api.github.com/users/reardencode/events{/privacy}",
         "followers_url" : "https://api.github.com/users/reardencode/followers",
         "following_url" : "https://api.github.com/users/reardencode/following{/other_user}",
         "gists_url" : "https://api.github.com/users/reardencode/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/reardencode",
         "id" : 730881,
         "login" : "reardencode",
         "node_id" : "MDQ6VXNlcjczMDg4MQ==",
         "organizations_url" : "https://api.github.com/users/reardencode/orgs",
         "received_events_url" : "https://api.github.com/users/reardencode/received_events",
         "repos_url" : "https://api.github.com/users/reardencode/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/reardencode/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/reardencode/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/reardencode"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1451787079"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451787079"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "does this mean you can do schnorr sigs with segwit v0 and p2sh? is that intended?",
      "commit_id" : "2fa22d7a523055c0a6d742fde2d5054d1574b61d",
      "created_at" : "2024-01-14T19:06:34Z",
      "diff_hunk" : "@@ -343,6 +343,67 @@ static bool EvalChecksigPreTapscript(const valtype& vchSig, const valtype& vchPu\n     return true;\n }\n \n+static bool EvalChecksigFromStack(const valtype& sig, const valtype& msg, const valtype& pubkey_in, ScriptExecutionData& execdata, unsigned int flags, SigVersion sigversion, ScriptError* serror, bool& success)\n+{\n+    assert(sigversion == SigVersion::BASE || sigversion == SigVersion::WITNESS_V0 || sigversion == SigVersion::TAPSCRIPT);\n+    /*\n+     *  The following validation sequence is consensus critical. Please note how --\n+     *    upgradable public key versions precede other rules;\n+     *    the script execution fails when using empty signature with invalid public key;\n+     *    the script execution fails when using non-empty invalid signature.\n+     */\n+    success = !sig.empty();\n+    if (success && sigversion == SigVersion::TAPSCRIPT) {\n+        // Implement the sigops/witnesssize ratio test.\n+        // Passing with an upgradable public key version is also counted.\n+        assert(execdata.m_validation_weight_left_init);\n+        execdata.m_validation_weight_left -= VALIDATION_WEIGHT_PER_SIGOP_PASSED;\n+        if (execdata.m_validation_weight_left < 0) {\n+            return set_error(serror, SCRIPT_ERR_TAPSCRIPT_VALIDATION_WEIGHT);\n+        }\n+    }\n+    if (pubkey_in.size() == 0) {\n+        return set_error(serror, SCRIPT_ERR_PUBKEYTYPE);\n+    } else if (pubkey_in.size() == 32) {\n+        if (!success) return true;\n+        if (sig.size() != 64) return set_error(serror, SCRIPT_ERR_SCHNORR_SIG_SIZE);\n+\n+        XOnlyPubKey pubkey{pubkey_in};\n+\n+        if (!pubkey.VerifySchnorr(msg, sig)) return set_error(serror, SCRIPT_ERR_SCHNORR_SIG);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1451787079",
      "id" : 1451787079,
      "line" : 373,
      "node_id" : "PRRC_kwDOABII585WiINH",
      "original_commit_id" : "2fa22d7a523055c0a6d742fde2d5054d1574b61d",
      "original_line" : 373,
      "original_position" : 31,
      "original_start_line" : 367,
      "path" : "src/script/interpreter.cpp",
      "position" : 31,
      "pull_request_review_id" : 1820286185,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451787079/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 367,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-01-14T19:07:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451787079",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1451787098"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451787098"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "if schnorr is allowed in non-taproot then why forbid ecdsa for taproot?\r\n",
      "commit_id" : "2fa22d7a523055c0a6d742fde2d5054d1574b61d",
      "created_at" : "2024-01-14T19:06:46Z",
      "diff_hunk" : "@@ -343,6 +343,67 @@ static bool EvalChecksigPreTapscript(const valtype& vchSig, const valtype& vchPu\n     return true;\n }\n \n+static bool EvalChecksigFromStack(const valtype& sig, const valtype& msg, const valtype& pubkey_in, ScriptExecutionData& execdata, unsigned int flags, SigVersion sigversion, ScriptError* serror, bool& success)\n+{\n+    assert(sigversion == SigVersion::BASE || sigversion == SigVersion::WITNESS_V0 || sigversion == SigVersion::TAPSCRIPT);\n+    /*\n+     *  The following validation sequence is consensus critical. Please note how --\n+     *    upgradable public key versions precede other rules;\n+     *    the script execution fails when using empty signature with invalid public key;\n+     *    the script execution fails when using non-empty invalid signature.\n+     */\n+    success = !sig.empty();\n+    if (success && sigversion == SigVersion::TAPSCRIPT) {\n+        // Implement the sigops/witnesssize ratio test.\n+        // Passing with an upgradable public key version is also counted.\n+        assert(execdata.m_validation_weight_left_init);\n+        execdata.m_validation_weight_left -= VALIDATION_WEIGHT_PER_SIGOP_PASSED;\n+        if (execdata.m_validation_weight_left < 0) {\n+            return set_error(serror, SCRIPT_ERR_TAPSCRIPT_VALIDATION_WEIGHT);\n+        }\n+    }\n+    if (pubkey_in.size() == 0) {\n+        return set_error(serror, SCRIPT_ERR_PUBKEYTYPE);\n+    } else if (pubkey_in.size() == 32) {\n+        if (!success) return true;\n+        if (sig.size() != 64) return set_error(serror, SCRIPT_ERR_SCHNORR_SIG_SIZE);\n+\n+        XOnlyPubKey pubkey{pubkey_in};\n+\n+        if (!pubkey.VerifySchnorr(msg, sig)) return set_error(serror, SCRIPT_ERR_SCHNORR_SIG);\n+    } else if (pubkey_in.size() == 33 && (pubkey_in[0] == 0x02 || pubkey_in[0] == 0x03) && (sigversion == SigVersion::BASE || sigversion == SigVersion::WITNESS_V0)) {\n+        // Pubkeys of length 33 are only constrained in legacy and segwitv0. In these script types only those beginning\n+        // with 0x02 or 0x03 are constrained. Others are unknown pubkey types.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1451787098",
      "id" : 1451787098,
      "line" : 376,
      "node_id" : "PRRC_kwDOABII585WiINa",
      "original_commit_id" : "2fa22d7a523055c0a6d742fde2d5054d1574b61d",
      "original_line" : 376,
      "original_position" : 34,
      "original_start_line" : 375,
      "path" : "src/script/interpreter.cpp",
      "position" : 34,
      "pull_request_review_id" : 1820286185,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 1,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451787098/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 375,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-01-14T19:07:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451787098",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1451787153"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451787153"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "should different message sizes be left for future upgrades\r\n",
      "commit_id" : "2fa22d7a523055c0a6d742fde2d5054d1574b61d",
      "created_at" : "2024-01-14T19:07:06Z",
      "diff_hunk" : "@@ -343,6 +343,67 @@ static bool EvalChecksigPreTapscript(const valtype& vchSig, const valtype& vchPu\n     return true;\n }\n \n+static bool EvalChecksigFromStack(const valtype& sig, const valtype& msg, const valtype& pubkey_in, ScriptExecutionData& execdata, unsigned int flags, SigVersion sigversion, ScriptError* serror, bool& success)\n+{\n+    assert(sigversion == SigVersion::BASE || sigversion == SigVersion::WITNESS_V0 || sigversion == SigVersion::TAPSCRIPT);\n+    /*\n+     *  The following validation sequence is consensus critical. Please note how --\n+     *    upgradable public key versions precede other rules;\n+     *    the script execution fails when using empty signature with invalid public key;\n+     *    the script execution fails when using non-empty invalid signature.\n+     */\n+    success = !sig.empty();\n+    if (success && sigversion == SigVersion::TAPSCRIPT) {\n+        // Implement the sigops/witnesssize ratio test.\n+        // Passing with an upgradable public key version is also counted.\n+        assert(execdata.m_validation_weight_left_init);\n+        execdata.m_validation_weight_left -= VALIDATION_WEIGHT_PER_SIGOP_PASSED;\n+        if (execdata.m_validation_weight_left < 0) {\n+            return set_error(serror, SCRIPT_ERR_TAPSCRIPT_VALIDATION_WEIGHT);\n+        }\n+    }\n+    if (pubkey_in.size() == 0) {\n+        return set_error(serror, SCRIPT_ERR_PUBKEYTYPE);\n+    } else if (pubkey_in.size() == 32) {\n+        if (!success) return true;\n+        if (sig.size() != 64) return set_error(serror, SCRIPT_ERR_SCHNORR_SIG_SIZE);\n+\n+        XOnlyPubKey pubkey{pubkey_in};\n+\n+        if (!pubkey.VerifySchnorr(msg, sig)) return set_error(serror, SCRIPT_ERR_SCHNORR_SIG);\n+    } else if (pubkey_in.size() == 33 && (pubkey_in[0] == 0x02 || pubkey_in[0] == 0x03) && (sigversion == SigVersion::BASE || sigversion == SigVersion::WITNESS_V0)) {\n+        // Pubkeys of length 33 are only constrained in legacy and segwitv0. In these script types only those beginning\n+        // with 0x02 or 0x03 are constrained. Others are unknown pubkey types.\n+        if (!success) return true;\n+\n+        // Add sighash flag to pass format validation\n+        valtype vchSig{sig.begin(), sig.begin() + sig.size()};\n+        vchSig.emplace_back(SIGHASH_ALL);\n+        if (!CheckSignatureEncoding(vchSig, flags | SCRIPT_VERIFY_LOW_S, serror)) {\n+            // serror is set\n+            return false;\n+        }\n+\n+        if (msg.size() != 32) return set_error(serror, SCRIPT_ERR_INVALID_DATA_LENGTH);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1451787153",
      "id" : 1451787153,
      "line" : 387,
      "node_id" : "PRRC_kwDOABII585WiIOR",
      "original_commit_id" : "2fa22d7a523055c0a6d742fde2d5054d1574b61d",
      "original_line" : 387,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/script/interpreter.cpp",
      "position" : 45,
      "pull_request_review_id" : 1820286185,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 1,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451787153/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-14T19:07:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451787153",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1451787208"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451787208"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "msg size is also not verifiied here",
      "commit_id" : "2fa22d7a523055c0a6d742fde2d5054d1574b61d",
      "created_at" : "2024-01-14T19:07:23Z",
      "diff_hunk" : "@@ -343,6 +343,67 @@ static bool EvalChecksigPreTapscript(const valtype& vchSig, const valtype& vchPu\n     return true;\n }\n \n+static bool EvalChecksigFromStack(const valtype& sig, const valtype& msg, const valtype& pubkey_in, ScriptExecutionData& execdata, unsigned int flags, SigVersion sigversion, ScriptError* serror, bool& success)\n+{\n+    assert(sigversion == SigVersion::BASE || sigversion == SigVersion::WITNESS_V0 || sigversion == SigVersion::TAPSCRIPT);\n+    /*\n+     *  The following validation sequence is consensus critical. Please note how --\n+     *    upgradable public key versions precede other rules;\n+     *    the script execution fails when using empty signature with invalid public key;\n+     *    the script execution fails when using non-empty invalid signature.\n+     */\n+    success = !sig.empty();\n+    if (success && sigversion == SigVersion::TAPSCRIPT) {\n+        // Implement the sigops/witnesssize ratio test.\n+        // Passing with an upgradable public key version is also counted.\n+        assert(execdata.m_validation_weight_left_init);\n+        execdata.m_validation_weight_left -= VALIDATION_WEIGHT_PER_SIGOP_PASSED;\n+        if (execdata.m_validation_weight_left < 0) {\n+            return set_error(serror, SCRIPT_ERR_TAPSCRIPT_VALIDATION_WEIGHT);\n+        }\n+    }\n+    if (pubkey_in.size() == 0) {\n+        return set_error(serror, SCRIPT_ERR_PUBKEYTYPE);\n+    } else if (pubkey_in.size() == 32) {\n+        if (!success) return true;\n+        if (sig.size() != 64) return set_error(serror, SCRIPT_ERR_SCHNORR_SIG_SIZE);\n+\n+        XOnlyPubKey pubkey{pubkey_in};\n+\n+        if (!pubkey.VerifySchnorr(msg, sig)) return set_error(serror, SCRIPT_ERR_SCHNORR_SIG);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1451787208",
      "id" : 1451787208,
      "in_reply_to_id" : 1451787079,
      "line" : 373,
      "node_id" : "PRRC_kwDOABII585WiIPI",
      "original_commit_id" : "2fa22d7a523055c0a6d742fde2d5054d1574b61d",
      "original_line" : 373,
      "original_position" : 31,
      "original_start_line" : 367,
      "path" : "src/script/interpreter.cpp",
      "position" : 31,
      "pull_request_review_id" : 1820286185,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451787208/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 367,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-01-14T19:07:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451787208",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1451788888"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451788888"
         }
      },
      "author_association" : "NONE",
      "body" : "Yes, intended to support both ECDSA and BIP340 sigs in segwitv0 and legacy.\r\n\r\nNo need for message size check here because BIP340 supports arbitrary length message.",
      "commit_id" : "2fa22d7a523055c0a6d742fde2d5054d1574b61d",
      "created_at" : "2024-01-14T19:19:58Z",
      "diff_hunk" : "@@ -343,6 +343,67 @@ static bool EvalChecksigPreTapscript(const valtype& vchSig, const valtype& vchPu\n     return true;\n }\n \n+static bool EvalChecksigFromStack(const valtype& sig, const valtype& msg, const valtype& pubkey_in, ScriptExecutionData& execdata, unsigned int flags, SigVersion sigversion, ScriptError* serror, bool& success)\n+{\n+    assert(sigversion == SigVersion::BASE || sigversion == SigVersion::WITNESS_V0 || sigversion == SigVersion::TAPSCRIPT);\n+    /*\n+     *  The following validation sequence is consensus critical. Please note how --\n+     *    upgradable public key versions precede other rules;\n+     *    the script execution fails when using empty signature with invalid public key;\n+     *    the script execution fails when using non-empty invalid signature.\n+     */\n+    success = !sig.empty();\n+    if (success && sigversion == SigVersion::TAPSCRIPT) {\n+        // Implement the sigops/witnesssize ratio test.\n+        // Passing with an upgradable public key version is also counted.\n+        assert(execdata.m_validation_weight_left_init);\n+        execdata.m_validation_weight_left -= VALIDATION_WEIGHT_PER_SIGOP_PASSED;\n+        if (execdata.m_validation_weight_left < 0) {\n+            return set_error(serror, SCRIPT_ERR_TAPSCRIPT_VALIDATION_WEIGHT);\n+        }\n+    }\n+    if (pubkey_in.size() == 0) {\n+        return set_error(serror, SCRIPT_ERR_PUBKEYTYPE);\n+    } else if (pubkey_in.size() == 32) {\n+        if (!success) return true;\n+        if (sig.size() != 64) return set_error(serror, SCRIPT_ERR_SCHNORR_SIG_SIZE);\n+\n+        XOnlyPubKey pubkey{pubkey_in};\n+\n+        if (!pubkey.VerifySchnorr(msg, sig)) return set_error(serror, SCRIPT_ERR_SCHNORR_SIG);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1451788888",
      "id" : 1451788888,
      "in_reply_to_id" : 1451787079,
      "line" : 373,
      "node_id" : "PRRC_kwDOABII585WiIpY",
      "original_commit_id" : "2fa22d7a523055c0a6d742fde2d5054d1574b61d",
      "original_line" : 373,
      "original_position" : 31,
      "original_start_line" : 367,
      "path" : "src/script/interpreter.cpp",
      "position" : 31,
      "pull_request_review_id" : 1820287979,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 1,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451788888/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 367,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-01-14T19:19:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451788888",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/730881?v=4",
         "events_url" : "https://api.github.com/users/reardencode/events{/privacy}",
         "followers_url" : "https://api.github.com/users/reardencode/followers",
         "following_url" : "https://api.github.com/users/reardencode/following{/other_user}",
         "gists_url" : "https://api.github.com/users/reardencode/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/reardencode",
         "id" : 730881,
         "login" : "reardencode",
         "node_id" : "MDQ6VXNlcjczMDg4MQ==",
         "organizations_url" : "https://api.github.com/users/reardencode/orgs",
         "received_events_url" : "https://api.github.com/users/reardencode/received_events",
         "repos_url" : "https://api.github.com/users/reardencode/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/reardencode/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/reardencode/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/reardencode"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1451789060"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451789060"
         }
      },
      "author_association" : "NONE",
      "body" : "Decision was somewhat arbitrary on my part. ECDSA doesn't really add anything in Tapscrpit where Schnorr adds ability to use well specified MPC protocols like MuSig2 and FROST in legacy, so I settled on adding Schnorr for legacy but not adding ECDSA for Tapscript.\r\n\r\nIn Tapscript, I wonder if we'll eventually want to fork in 33-byte 02/03 keys as x-y Schnorr, so I was a bit hesitant to consume those prefixes now.",
      "commit_id" : "2fa22d7a523055c0a6d742fde2d5054d1574b61d",
      "created_at" : "2024-01-14T19:21:29Z",
      "diff_hunk" : "@@ -343,6 +343,67 @@ static bool EvalChecksigPreTapscript(const valtype& vchSig, const valtype& vchPu\n     return true;\n }\n \n+static bool EvalChecksigFromStack(const valtype& sig, const valtype& msg, const valtype& pubkey_in, ScriptExecutionData& execdata, unsigned int flags, SigVersion sigversion, ScriptError* serror, bool& success)\n+{\n+    assert(sigversion == SigVersion::BASE || sigversion == SigVersion::WITNESS_V0 || sigversion == SigVersion::TAPSCRIPT);\n+    /*\n+     *  The following validation sequence is consensus critical. Please note how --\n+     *    upgradable public key versions precede other rules;\n+     *    the script execution fails when using empty signature with invalid public key;\n+     *    the script execution fails when using non-empty invalid signature.\n+     */\n+    success = !sig.empty();\n+    if (success && sigversion == SigVersion::TAPSCRIPT) {\n+        // Implement the sigops/witnesssize ratio test.\n+        // Passing with an upgradable public key version is also counted.\n+        assert(execdata.m_validation_weight_left_init);\n+        execdata.m_validation_weight_left -= VALIDATION_WEIGHT_PER_SIGOP_PASSED;\n+        if (execdata.m_validation_weight_left < 0) {\n+            return set_error(serror, SCRIPT_ERR_TAPSCRIPT_VALIDATION_WEIGHT);\n+        }\n+    }\n+    if (pubkey_in.size() == 0) {\n+        return set_error(serror, SCRIPT_ERR_PUBKEYTYPE);\n+    } else if (pubkey_in.size() == 32) {\n+        if (!success) return true;\n+        if (sig.size() != 64) return set_error(serror, SCRIPT_ERR_SCHNORR_SIG_SIZE);\n+\n+        XOnlyPubKey pubkey{pubkey_in};\n+\n+        if (!pubkey.VerifySchnorr(msg, sig)) return set_error(serror, SCRIPT_ERR_SCHNORR_SIG);\n+    } else if (pubkey_in.size() == 33 && (pubkey_in[0] == 0x02 || pubkey_in[0] == 0x03) && (sigversion == SigVersion::BASE || sigversion == SigVersion::WITNESS_V0)) {\n+        // Pubkeys of length 33 are only constrained in legacy and segwitv0. In these script types only those beginning\n+        // with 0x02 or 0x03 are constrained. Others are unknown pubkey types.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1451789060",
      "id" : 1451789060,
      "in_reply_to_id" : 1451787098,
      "line" : 376,
      "node_id" : "PRRC_kwDOABII585WiIsE",
      "original_commit_id" : "2fa22d7a523055c0a6d742fde2d5054d1574b61d",
      "original_line" : 376,
      "original_position" : 34,
      "original_start_line" : 375,
      "path" : "src/script/interpreter.cpp",
      "position" : 34,
      "pull_request_review_id" : 1820288194,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 1,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451789060/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 375,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-01-14T19:21:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451789060",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/730881?v=4",
         "events_url" : "https://api.github.com/users/reardencode/events{/privacy}",
         "followers_url" : "https://api.github.com/users/reardencode/followers",
         "following_url" : "https://api.github.com/users/reardencode/following{/other_user}",
         "gists_url" : "https://api.github.com/users/reardencode/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/reardencode",
         "id" : 730881,
         "login" : "reardencode",
         "node_id" : "MDQ6VXNlcjczMDg4MQ==",
         "organizations_url" : "https://api.github.com/users/reardencode/orgs",
         "received_events_url" : "https://api.github.com/users/reardencode/received_events",
         "repos_url" : "https://api.github.com/users/reardencode/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/reardencode/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/reardencode/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/reardencode"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1451789140"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451789140"
         }
      },
      "author_association" : "NONE",
      "body" : "ECDSA requires 32-byte message. OP_SHA256 ahead would enable scripts to handle other data sizes. Making that explicit seems like the better option for ECDSA to enable shorter scripts when pre-hashing is not needed, but also allow pre-hashed data when needed.",
      "commit_id" : "2fa22d7a523055c0a6d742fde2d5054d1574b61d",
      "created_at" : "2024-01-14T19:22:22Z",
      "diff_hunk" : "@@ -343,6 +343,67 @@ static bool EvalChecksigPreTapscript(const valtype& vchSig, const valtype& vchPu\n     return true;\n }\n \n+static bool EvalChecksigFromStack(const valtype& sig, const valtype& msg, const valtype& pubkey_in, ScriptExecutionData& execdata, unsigned int flags, SigVersion sigversion, ScriptError* serror, bool& success)\n+{\n+    assert(sigversion == SigVersion::BASE || sigversion == SigVersion::WITNESS_V0 || sigversion == SigVersion::TAPSCRIPT);\n+    /*\n+     *  The following validation sequence is consensus critical. Please note how --\n+     *    upgradable public key versions precede other rules;\n+     *    the script execution fails when using empty signature with invalid public key;\n+     *    the script execution fails when using non-empty invalid signature.\n+     */\n+    success = !sig.empty();\n+    if (success && sigversion == SigVersion::TAPSCRIPT) {\n+        // Implement the sigops/witnesssize ratio test.\n+        // Passing with an upgradable public key version is also counted.\n+        assert(execdata.m_validation_weight_left_init);\n+        execdata.m_validation_weight_left -= VALIDATION_WEIGHT_PER_SIGOP_PASSED;\n+        if (execdata.m_validation_weight_left < 0) {\n+            return set_error(serror, SCRIPT_ERR_TAPSCRIPT_VALIDATION_WEIGHT);\n+        }\n+    }\n+    if (pubkey_in.size() == 0) {\n+        return set_error(serror, SCRIPT_ERR_PUBKEYTYPE);\n+    } else if (pubkey_in.size() == 32) {\n+        if (!success) return true;\n+        if (sig.size() != 64) return set_error(serror, SCRIPT_ERR_SCHNORR_SIG_SIZE);\n+\n+        XOnlyPubKey pubkey{pubkey_in};\n+\n+        if (!pubkey.VerifySchnorr(msg, sig)) return set_error(serror, SCRIPT_ERR_SCHNORR_SIG);\n+    } else if (pubkey_in.size() == 33 && (pubkey_in[0] == 0x02 || pubkey_in[0] == 0x03) && (sigversion == SigVersion::BASE || sigversion == SigVersion::WITNESS_V0)) {\n+        // Pubkeys of length 33 are only constrained in legacy and segwitv0. In these script types only those beginning\n+        // with 0x02 or 0x03 are constrained. Others are unknown pubkey types.\n+        if (!success) return true;\n+\n+        // Add sighash flag to pass format validation\n+        valtype vchSig{sig.begin(), sig.begin() + sig.size()};\n+        vchSig.emplace_back(SIGHASH_ALL);\n+        if (!CheckSignatureEncoding(vchSig, flags | SCRIPT_VERIFY_LOW_S, serror)) {\n+            // serror is set\n+            return false;\n+        }\n+\n+        if (msg.size() != 32) return set_error(serror, SCRIPT_ERR_INVALID_DATA_LENGTH);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#discussion_r1451789140",
      "id" : 1451789140,
      "in_reply_to_id" : 1451787153,
      "line" : 387,
      "node_id" : "PRRC_kwDOABII585WiItU",
      "original_commit_id" : "2fa22d7a523055c0a6d742fde2d5054d1574b61d",
      "original_line" : 387,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/script/interpreter.cpp",
      "position" : 45,
      "pull_request_review_id" : 1820288296,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29198",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 1,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451789140/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-14T19:22:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1451789140",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/730881?v=4",
         "events_url" : "https://api.github.com/users/reardencode/events{/privacy}",
         "followers_url" : "https://api.github.com/users/reardencode/followers",
         "following_url" : "https://api.github.com/users/reardencode/following{/other_user}",
         "gists_url" : "https://api.github.com/users/reardencode/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/reardencode",
         "id" : 730881,
         "login" : "reardencode",
         "node_id" : "MDQ6VXNlcjczMDg4MQ==",
         "organizations_url" : "https://api.github.com/users/reardencode/orgs",
         "received_events_url" : "https://api.github.com/users/reardencode/received_events",
         "repos_url" : "https://api.github.com/users/reardencode/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/reardencode/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/reardencode/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/reardencode"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Thanks for the comments @benthecarman !",
      "created_at" : "2024-01-14T19:22:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1891047926",
      "id" : 1891047926,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wtxn2",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1891047926/reactions"
      },
      "updated_at" : "2024-01-14T19:22:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1891047926",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/730881?v=4",
         "events_url" : "https://api.github.com/users/reardencode/events{/privacy}",
         "followers_url" : "https://api.github.com/users/reardencode/followers",
         "following_url" : "https://api.github.com/users/reardencode/following{/other_user}",
         "gists_url" : "https://api.github.com/users/reardencode/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/reardencode",
         "id" : 730881,
         "login" : "reardencode",
         "node_id" : "MDQ6VXNlcjczMDg4MQ==",
         "organizations_url" : "https://api.github.com/users/reardencode/orgs",
         "received_events_url" : "https://api.github.com/users/reardencode/received_events",
         "repos_url" : "https://api.github.com/users/reardencode/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/reardencode/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/reardencode/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/reardencode"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I think [consensus ](https://github.com/bitcoin/bitcoin/labels/Consensus) label should be added for this pull request",
      "created_at" : "2024-01-15T13:29:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1892179472",
      "id" : 1892179472,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585wyF4Q",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1892179472/reactions"
      },
      "updated_at" : "2024-01-15T13:29:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1892179472",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/147166694?v=4",
         "events_url" : "https://api.github.com/users/1440000bytes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/1440000bytes/followers",
         "following_url" : "https://api.github.com/users/1440000bytes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/1440000bytes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/1440000bytes",
         "id" : 147166694,
         "login" : "1440000bytes",
         "node_id" : "U_kgDOCMWV5g",
         "organizations_url" : "https://api.github.com/users/1440000bytes/orgs",
         "received_events_url" : "https://api.github.com/users/1440000bytes/received_events",
         "repos_url" : "https://api.github.com/users/1440000bytes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/1440000bytes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/1440000bytes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/1440000bytes"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Converted this to a draft while I work through AJ's review on my similar PR to inquisition. Will port those changes over here and undraft when the time comes.",
      "created_at" : "2024-01-16T06:34:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29198#issuecomment-1893147139",
      "id" : 1893147139,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29198",
      "node_id" : "IC_kwDOABII585w1yID",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1893147139/reactions"
      },
      "updated_at" : "2024-01-16T06:34:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1893147139",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/730881?v=4",
         "events_url" : "https://api.github.com/users/reardencode/events{/privacy}",
         "followers_url" : "https://api.github.com/users/reardencode/followers",
         "following_url" : "https://api.github.com/users/reardencode/following{/other_user}",
         "gists_url" : "https://api.github.com/users/reardencode/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/reardencode",
         "id" : 730881,
         "login" : "reardencode",
         "node_id" : "MDQ6VXNlcjczMDg4MQ==",
         "organizations_url" : "https://api.github.com/users/reardencode/orgs",
         "received_events_url" : "https://api.github.com/users/reardencode/received_events",
         "repos_url" : "https://api.github.com/users/reardencode/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/reardencode/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/reardencode/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/reardencode"
      }
   }
]
