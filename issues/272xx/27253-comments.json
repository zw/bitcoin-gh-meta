[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [brunoerg](https://github.com/bitcoin/bitcoin/pull/27253#pullrequestreview-1339187663) |\n| Stale ACK | [stickies-v](https://github.com/bitcoin/bitcoin/pull/27253#pullrequestreview-1352688865), [vasild](https://github.com/bitcoin/bitcoin/pull/27253#pullrequestreview-1385842606) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#28051](https://github.com/bitcoin/bitcoin/pull/28051) (Get rid of shutdown.cpp/shutdown.h, use SignalInterrupt directly by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-03-14T04:22:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1467334860",
      "id" : 1467334860,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585XdcDM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1467334860/reactions"
      },
      "updated_at" : "2023-12-05T04:56:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1467334860",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> What do you think?\r\n\r\nAs @stickies-v explained to me outside this PR: \"... by moving the uri parsing to http_request_cb we're failing super early, and even when the query parameter would never be called by the endpoint... \", this makes more sense.\r\n\r\nI'm working on this approach which I think it's better as well.",
      "created_at" : "2023-03-14T21:14:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1468854086",
      "id" : 1468854086,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585XjO9G",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1468854086/reactions"
      },
      "updated_at" : "2023-03-14T21:14:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1468854086",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1139143140"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139143140"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit\r\n```suggestion\r\n    if (!m_uri_parsed) return std::nullopt;\r\n```",
      "commit_id" : "d16effe8cb2c18b72eeda596c4d3cf0c38b93263",
      "created_at" : "2023-03-16T17:46:13Z",
      "diff_hunk" : "@@ -663,17 +674,10 @@ HTTPRequest::RequestMethod HTTPRequest::GetRequestMethod() const\n     }\n }\n \n-std::optional<std::string> HTTPRequest::GetQueryParameter(const std::string& key) const\n+std::optional<std::string> HTTPRequest::GetQueryParameter(const std::string& key)\n {\n-    const char* uri{evhttp_request_get_uri(req)};\n-\n-    return GetQueryParameterFromUri(uri, key);\n-}\n-\n-std::optional<std::string> GetQueryParameterFromUri(const char* uri, const std::string& key)\n-{\n-    evhttp_uri* uri_parsed{evhttp_uri_parse(uri)};\n-    const char* query{evhttp_uri_get_query(uri_parsed)};\n+    if (!m_uri_parsed) { return std::nullopt; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1139143140",
      "id" : 1139143140,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585D5fHk",
      "original_commit_id" : "02cbb583271cabe1b4062525dea785ea21796462",
      "original_line" : 679,
      "original_position" : 55,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 1344413373,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139143140/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-16T18:12:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139143140",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated changes:\r\n- move the validation/parsing logic up in the stack as soon as the request is initiated even before the work item thread is created\r\n- updated unit and functional tests",
      "created_at" : "2023-03-16T17:59:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1472457091",
      "id" : 1472457091,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585Xw-mD",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1472457091/reactions"
      },
      "updated_at" : "2023-03-16T17:59:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1472457091",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1139180604"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139180604"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "See https://github.com/bitcoin/bitcoin/pull/24012 - I couldn't get mocking an `evhttp_request*` past the ASan test, and it looks like they're failing again here too. That's why in #24098 I introduced the `GetQueryParameterFromUri()` helper function: it could easily be unit tested, and then `HTTPRequest::GetQueryParameter()` was just a simple wrapper left untested.",
      "commit_id" : "d16effe8cb2c18b72eeda596c4d3cf0c38b93263",
      "created_at" : "2023-03-16T18:10:30Z",
      "diff_hunk" : "@@ -13,26 +15,34 @@ BOOST_AUTO_TEST_CASE(test_query_parameters)\n {\n     std::string uri {};\n \n+    evhttp_request* evreq = evhttp_request_new(nullptr, nullptr);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1139180604",
      "id" : 1139180604,
      "line" : 18,
      "node_id" : "PRRC_kwDOABII585D5oQ8",
      "original_commit_id" : "213554cb97c9c89bca56b56e8d0af473102e3061",
      "original_line" : 18,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/test/httpserver_tests.cpp",
      "position" : 13,
      "pull_request_review_id" : 1344413373,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139180604/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-16T18:12:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139180604",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1139181920"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139181920"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Seems like unrelated/unnecessary churn imo, and redefining HTTP status codes in a single functional test doesn't seem like a productive approach. Would leave this out?",
      "commit_id" : "d16effe8cb2c18b72eeda596c4d3cf0c38b93263",
      "created_at" : "2023-03-16T18:11:36Z",
      "diff_hunk" : "@@ -44,6 +44,11 @@ class RetType(Enum):\n     BYTES = 2\n     JSON = 3\n \n+class HTTPStatusCode(Enum):\n+    HTTP_OK = 200\n+    HTTP_BAD_REQUEST = 400\n+    HTTP_NOT_FOUND = 404\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1139181920",
      "id" : 1139181920,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585D5olg",
      "original_commit_id" : "213554cb97c9c89bca56b56e8d0af473102e3061",
      "original_line" : 51,
      "original_position" : 8,
      "original_start_line" : 47,
      "path" : "test/functional/interface_rest.py",
      "position" : null,
      "pull_request_review_id" : 1344413373,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139181920/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-03-16T18:13:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139181920",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1139308077"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139308077"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "thanks, corrected other similar 2.",
      "commit_id" : "d16effe8cb2c18b72eeda596c4d3cf0c38b93263",
      "created_at" : "2023-03-16T20:14:52Z",
      "diff_hunk" : "@@ -663,17 +674,10 @@ HTTPRequest::RequestMethod HTTPRequest::GetRequestMethod() const\n     }\n }\n \n-std::optional<std::string> HTTPRequest::GetQueryParameter(const std::string& key) const\n+std::optional<std::string> HTTPRequest::GetQueryParameter(const std::string& key)\n {\n-    const char* uri{evhttp_request_get_uri(req)};\n-\n-    return GetQueryParameterFromUri(uri, key);\n-}\n-\n-std::optional<std::string> GetQueryParameterFromUri(const char* uri, const std::string& key)\n-{\n-    evhttp_uri* uri_parsed{evhttp_uri_parse(uri)};\n-    const char* query{evhttp_uri_get_query(uri_parsed)};\n+    if (!m_uri_parsed) { return std::nullopt; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1139308077",
      "id" : 1139308077,
      "in_reply_to_id" : 1139143140,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585D6HYt",
      "original_commit_id" : "02cbb583271cabe1b4062525dea785ea21796462",
      "original_line" : 679,
      "original_position" : 55,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 1344642054,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139308077/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-16T20:14:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139308077",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1139309346"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139309346"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I'm now reusing the HTTPStatus enum from the python http module in python; there were like 20 places where these codes were introduced as int. I think it makes it clearer but pls let me know if that's not the case.",
      "commit_id" : "d16effe8cb2c18b72eeda596c4d3cf0c38b93263",
      "created_at" : "2023-03-16T20:16:21Z",
      "diff_hunk" : "@@ -44,6 +44,11 @@ class RetType(Enum):\n     BYTES = 2\n     JSON = 3\n \n+class HTTPStatusCode(Enum):\n+    HTTP_OK = 200\n+    HTTP_BAD_REQUEST = 400\n+    HTTP_NOT_FOUND = 404\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1139309346",
      "id" : 1139309346,
      "in_reply_to_id" : 1139181920,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585D6Hsi",
      "original_commit_id" : "213554cb97c9c89bca56b56e8d0af473102e3061",
      "original_line" : 51,
      "original_position" : 8,
      "original_start_line" : 47,
      "path" : "test/functional/interface_rest.py",
      "position" : null,
      "pull_request_review_id" : 1344646552,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139309346/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-03-16T20:16:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139309346",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1139311306"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139311306"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "If I bring it back I won't be able to access to m_uri_parsed from the helper function, unless there's another alternative, I'll have to roll-back to the original approach of the PR.",
      "commit_id" : "d16effe8cb2c18b72eeda596c4d3cf0c38b93263",
      "created_at" : "2023-03-16T20:18:09Z",
      "diff_hunk" : "@@ -13,26 +15,34 @@ BOOST_AUTO_TEST_CASE(test_query_parameters)\n {\n     std::string uri {};\n \n+    evhttp_request* evreq = evhttp_request_new(nullptr, nullptr);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1139311306",
      "id" : 1139311306,
      "in_reply_to_id" : 1139180604,
      "line" : 18,
      "node_id" : "PRRC_kwDOABII585D6ILK",
      "original_commit_id" : "213554cb97c9c89bca56b56e8d0af473102e3061",
      "original_line" : 18,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/test/httpserver_tests.cpp",
      "position" : 13,
      "pull_request_review_id" : 1344651093,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139311306/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-16T20:18:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139311306",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1139348308"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139348308"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Every line of code that you change needs review. If those changed lines of code are unrelated to what you're trying to achieve, you risk unnecessarily slowing doing the PR or even getting NACKs for reasons unrelated to what you're really trying to do. I'd strongly suggest keeping the scope as small as possible.\r\n\r\nI'm not saying it's necessarily a bad idea to use enumerated HTTP status codes, but it would be better off in a separate PR/issue (and have you checked if it's been suggested before?)",
      "commit_id" : "d16effe8cb2c18b72eeda596c4d3cf0c38b93263",
      "created_at" : "2023-03-16T20:53:48Z",
      "diff_hunk" : "@@ -44,6 +44,11 @@ class RetType(Enum):\n     BYTES = 2\n     JSON = 3\n \n+class HTTPStatusCode(Enum):\n+    HTTP_OK = 200\n+    HTTP_BAD_REQUEST = 400\n+    HTTP_NOT_FOUND = 404\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1139348308",
      "id" : 1139348308,
      "in_reply_to_id" : 1139181920,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585D6RNU",
      "original_commit_id" : "213554cb97c9c89bca56b56e8d0af473102e3061",
      "original_line" : 51,
      "original_position" : 8,
      "original_start_line" : 47,
      "path" : "test/functional/interface_rest.py",
      "position" : null,
      "pull_request_review_id" : 1344697393,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139348308/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-03-16T20:53:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1139348308",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "https://cirrus-ci.com/task/4643666984173568:\r\n```bash\r\n test  2023-03-16T20:06:03.567000Z TestFramework (ERROR): Unexpected exception caught during testing \r\n                                   Traceback (most recent call last):\r\n                                     File \"/private/var/folders/v7/fs2b0v3s0lz1n57gj9y4xb5m0000gn/T/cirrus-ci-build/ci/scratch/build/bitcoin-arm64-apple-darwin/test/functional/test_framework/test_framework.py\", line 132, in main\r\n                                       self.run_test()\r\n                                     File \"/private/var/folders/v7/fs2b0v3s0lz1n57gj9y4xb5m0000gn/T/cirrus-ci-build/ci/scratch/build/bitcoin-arm64-apple-darwin/test/functional/interface_rest.py\", line 372, in run_test\r\n                                       resp = self.test_rest_request(\"/mempool/contents\", ret_type=RetType.OBJ, status=400, query_params={\"verbose\": \"true\", \"mempool_sequence\": \"true\"})\r\n                                     File \"/private/var/folders/v7/fs2b0v3s0lz1n57gj9y4xb5m0000gn/T/cirrus-ci-build/ci/scratch/build/bitcoin-arm64-apple-darwin/test/functional/interface_rest.py\", line 86, in test_rest_request\r\n                                       assert_equal(resp.status, status.value)\r\n                                   AttributeError: 'int' object has no attribute 'value'\r\n```",
      "created_at" : "2023-03-16T21:01:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1472733580",
      "id" : 1472733580,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585XyCGM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1472733580/reactions"
      },
      "updated_at" : "2023-03-16T21:01:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1472733580",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@fanquake that's something perhaps I've introduced with my last push, I'm on it, thanks. Weird, it's not failing locally for me:\r\n```\r\n$ ./test/functional/interface_rest.py \r\n2023-03-16T21:14:11.025000Z TestFramework (INFO): PRNG seed is: 326626678636704986\r\n2023-03-16T21:14:11.026000Z TestFramework (INFO): Initializing test directory /tmp/bitcoin_func_test_vwqauy2g\r\n2023-03-16T21:14:11.812000Z TestFramework (INFO): Broadcast test transaction and sync nodes\r\n2023-03-16T21:14:12.865000Z TestFramework (INFO): Test the /tx URI\r\n2023-03-16T21:14:12.876000Z TestFramework (INFO): Query an unspent TXO using the /getutxos URI\r\n2023-03-16T21:14:12.934000Z TestFramework (INFO): Query a spent TXO using the /getutxos URI\r\n2023-03-16T21:14:12.935000Z TestFramework (INFO): Query two TXOs using the /getutxos URI\r\n2023-03-16T21:14:12.938000Z TestFramework (INFO): Query the TXOs using the /getutxos URI with a binary response\r\n2023-03-16T21:14:12.939000Z TestFramework (INFO): Test the /getutxos URI with and without /checkmempool\r\n2023-03-16T21:14:14.065000Z TestFramework (INFO): Test the /block, /blockhashbyheight, /headers, and /blockfilterheaders URIs\r\n2023-03-16T21:14:15.221000Z TestFramework (INFO): Test tx inclusion in the /mempool and /block URIs\r\n2023-03-16T21:14:16.326000Z TestFramework (INFO): Test the /chaininfo URI\r\n2023-03-16T21:14:16.334000Z TestFramework (INFO): Test compatibility of deprecated and newer endpoints\r\n2023-03-16T21:14:16.341000Z TestFramework (INFO): Test the /deploymentinfo URI\r\n2023-03-16T21:14:16.404000Z TestFramework (INFO): Stopping nodes\r\n2023-03-16T21:14:16.611000Z TestFramework (INFO): Cleaning up /tmp/bitcoin_func_test_vwqauy2g on exit\r\n2023-03-16T21:14:16.612000Z TestFramework (INFO): Tests successful\r\n\r\n```\r\n\r\nI think this was the issue: Python Enums were introduced in version 3.4, and the value attribute was added in version 3.6. I'm fixing it.",
      "created_at" : "2023-03-16T21:13:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1472748621",
      "id" : 1472748621,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585XyFxN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1472748621/reactions"
      },
      "updated_at" : "2023-03-16T21:26:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1472748621",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1140271032"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1140271032"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "What do you think about this approach? I think it's quite minimal:\r\n\r\n<details>\r\n<summary>git diff</summary>\r\n\r\n```diff\r\ndiff --git a/src/httpserver.cpp b/src/httpserver.cpp\r\nindex 942caa042..6a6176a78 100644\r\n--- a/src/httpserver.cpp\r\n+++ b/src/httpserver.cpp\r\n@@ -15,6 +15,7 @@\r\n #include <rpc/protocol.h> // For HTTP status codes\r\n #include <shutdown.h>\r\n #include <sync.h>\r\n+#include <util/check.h>\r\n #include <util/strencodings.h>\r\n #include <util/syscall_sandbox.h>\r\n #include <util/system.h>\r\n@@ -253,6 +254,14 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\r\n         return;\r\n     }\r\n \r\n+    // Early reject invalid URI\r\n+    if (!hreq->GetURIParsed()) {\r\n+        LogPrint(BCLog::HTTP, \"HTTP request from %s rejected: Invalid URI\\n\",\r\n+                 hreq->GetPeer().ToStringAddrPort());\r\n+        hreq->WriteReply(HTTP_BAD_REQUEST, \"Invalid URI\");\r\n+        return;\r\n+    }\r\n+\r\n     LogPrint(BCLog::HTTP, \"Received a %s request for %s from %s\\n\",\r\n              RequestMethodString(hreq->GetRequestMethod()), SanitizeString(hreq->GetURI(), SAFE_CHARS_URI).substr(0, 100), hreq->GetPeer().ToStringAddrPort());\r\n \r\n@@ -535,18 +544,22 @@ void HTTPEvent::trigger(struct timeval* tv)\r\n     else\r\n         evtimer_add(ev, tv); // trigger after timeval passed\r\n }\r\n-HTTPRequest::HTTPRequest(struct evhttp_request* _req, bool _replySent) : req(_req), replySent(_replySent)\r\n+HTTPRequest::HTTPRequest(struct evhttp_request* _req, bool _replySent) :\r\n+        req{_req},\r\n+        m_uri_parsed{evhttp_uri_parse(evhttp_request_get_uri(req))},\r\n+        replySent{_replySent}\r\n {\r\n }\r\n \r\n HTTPRequest::~HTTPRequest()\r\n {\r\n+    // evhttpd cleans up the request, as long as a reply was sent.\r\n     if (!replySent) {\r\n         // Keep track of whether reply was sent to avoid request leaks\r\n         LogPrintf(\"%s: Unhandled request\\n\", __func__);\r\n         WriteReply(HTTP_INTERNAL_SERVER_ERROR, \"Unhandled request\");\r\n     }\r\n-    // evhttpd cleans up the request, as long as a reply was sent.\r\n+    if(m_uri_parsed) evhttp_uri_free(m_uri_parsed);\r\n }\r\n \r\n std::pair<bool, std::string> HTTPRequest::GetHeader(const std::string& hdr) const\r\n@@ -665,14 +678,13 @@ HTTPRequest::RequestMethod HTTPRequest::GetRequestMethod() const\r\n \r\n std::optional<std::string> HTTPRequest::GetQueryParameter(const std::string& key) const\r\n {\r\n-    const char* uri{evhttp_request_get_uri(req)};\r\n-\r\n-    return GetQueryParameterFromUri(uri, key);\r\n+    if (!Assume(m_uri_parsed)) return std::nullopt;  // http_request_cb should have checked that m_uri_parsed is not nullptr\r\n+    return GetQueryParameterFromUri(m_uri_parsed, key);\r\n }\r\n \r\n-std::optional<std::string> GetQueryParameterFromUri(const char* uri, const std::string& key)\r\n+std::optional<std::string> GetQueryParameterFromUri(const evhttp_uri* uri_parsed, const std::string& key)\r\n {\r\n-    evhttp_uri* uri_parsed{evhttp_uri_parse(uri)};\r\n+    assert(uri_parsed);\r\n     const char* query{evhttp_uri_get_query(uri_parsed)};\r\n     std::optional<std::string> result;\r\n \r\n@@ -689,7 +701,6 @@ std::optional<std::string> GetQueryParameterFromUri(const char* uri, const std::\r\n         }\r\n         evhttp_clear_headers(&params_q);\r\n     }\r\n-    evhttp_uri_free(uri_parsed);\r\n \r\n     return result;\r\n }\r\ndiff --git a/src/httpserver.h b/src/httpserver.h\r\nindex 036a39a02..84906e121 100644\r\n--- a/src/httpserver.h\r\n+++ b/src/httpserver.h\r\n@@ -14,6 +14,7 @@ static const int DEFAULT_HTTP_WORKQUEUE=16;\r\n static const int DEFAULT_HTTP_SERVER_TIMEOUT=30;\r\n \r\n struct evhttp_request;\r\n+struct evhttp_uri;\r\n struct event_base;\r\n class CService;\r\n class HTTPRequest;\r\n@@ -57,6 +58,7 @@ class HTTPRequest\r\n {\r\n private:\r\n     struct evhttp_request* req;\r\n+    evhttp_uri* m_uri_parsed;\r\n     bool replySent;\r\n \r\n public:\r\n@@ -75,6 +77,9 @@ public:\r\n      */\r\n     std::string GetURI() const;\r\n \r\n+    /** Get libevent parsed URI, which is nullptr if uri parsing failed */\r\n+    const evhttp_uri* GetURIParsed() const { return m_uri_parsed; }\r\n+\r\n     /** Get CService (address:ip) for the origin of the http request.\r\n      */\r\n     CService GetPeer() const;\r\n@@ -135,10 +140,10 @@ public:\r\n  *\r\n  * Helper function for HTTPRequest::GetQueryParameter.\r\n  *\r\n- * @param[in] uri is the entire request uri\r\n+ * @param[in] uri_parsed is the request uri after parsing it with evhttp_uri_parse\r\n  * @param[in] key represents the query parameter of which the value is returned\r\n  */\r\n-std::optional<std::string> GetQueryParameterFromUri(const char* uri, const std::string& key);\r\n+std::optional<std::string> GetQueryParameterFromUri(const evhttp_uri* uri_parsed, const std::string& key);\r\n \r\n /** Event handler closure.\r\n  */\r\n\r\n```\r\n</details>",
      "commit_id" : "d16effe8cb2c18b72eeda596c4d3cf0c38b93263",
      "created_at" : "2023-03-17T13:56:15Z",
      "diff_hunk" : "@@ -13,26 +15,34 @@ BOOST_AUTO_TEST_CASE(test_query_parameters)\n {\n     std::string uri {};\n \n+    evhttp_request* evreq = evhttp_request_new(nullptr, nullptr);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1140271032",
      "id" : 1140271032,
      "in_reply_to_id" : 1139180604,
      "line" : 18,
      "node_id" : "PRRC_kwDOABII585D9ye4",
      "original_commit_id" : "213554cb97c9c89bca56b56e8d0af473102e3061",
      "original_line" : 18,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/test/httpserver_tests.cpp",
      "position" : 13,
      "pull_request_review_id" : 1346000963,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1140271032/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-17T13:56:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1140271032",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1140471392"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1140471392"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok, got it now and I agree. Thanks.",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-17T16:46:05Z",
      "diff_hunk" : "@@ -44,6 +44,11 @@ class RetType(Enum):\n     BYTES = 2\n     JSON = 3\n \n+class HTTPStatusCode(Enum):\n+    HTTP_OK = 200\n+    HTTP_BAD_REQUEST = 400\n+    HTTP_NOT_FOUND = 404\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1140471392",
      "id" : 1140471392,
      "in_reply_to_id" : 1139181920,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585D-jZg",
      "original_commit_id" : "213554cb97c9c89bca56b56e8d0af473102e3061",
      "original_line" : 51,
      "original_position" : 8,
      "original_start_line" : 47,
      "path" : "test/functional/interface_rest.py",
      "position" : null,
      "pull_request_review_id" : 1346316209,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1140471392/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-03-17T16:46:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1140471392",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1140471811"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1140471811"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I see, ok, it makes sense, let me make some changes.",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-17T16:46:29Z",
      "diff_hunk" : "@@ -13,26 +15,34 @@ BOOST_AUTO_TEST_CASE(test_query_parameters)\n {\n     std::string uri {};\n \n+    evhttp_request* evreq = evhttp_request_new(nullptr, nullptr);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1140471811",
      "id" : 1140471811,
      "in_reply_to_id" : 1139180604,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585D-jgD",
      "original_commit_id" : "213554cb97c9c89bca56b56e8d0af473102e3061",
      "original_line" : 18,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/test/httpserver_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 1346316825,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1140471811/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-17T16:46:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1140471811",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142370781"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142370781"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "A simple getter is best implemented in the header",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-20T16:11:30Z",
      "diff_hunk" : "@@ -689,11 +703,12 @@ std::optional<std::string> GetQueryParameterFromUri(const char* uri, const std::\n         }\n         evhttp_clear_headers(&params_q);\n     }\n-    evhttp_uri_free(uri_parsed);\n \n     return result;\n }\n \n+evhttp_uri* HTTPRequest::GetURIParsed() { return m_uri_parsed; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142370781",
      "id" : 1142370781,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EFzHd",
      "original_commit_id" : "0115dccef675c62d1c7f1b0df4c94827737de4a3",
      "original_line" : 710,
      "original_position" : 92,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 1348929370,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142370781/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-20T16:26:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142370781",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142371332"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142371332"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "```suggestion\r\n    const evhttp_uri* GetURIParsed() const;\r\n```",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-20T16:11:54Z",
      "diff_hunk" : "@@ -124,21 +126,10 @@ class HTTPRequest\n      * main thread, do not call any other HTTPRequest methods after calling this.\n      */\n     void WriteReply(int nStatus, const std::string& strReply = \"\");\n-};\n \n-/** Get the query parameter value from request uri for a specified key, or std::nullopt if the key\n- * is not found.\n- *\n- * If the query string contains duplicate keys, the first value is returned. Many web frameworks\n- * would instead parse this as an array of values, but this is not (yet) implemented as it is\n- * currently not needed in any of the endpoints.\n- *\n- * Helper function for HTTPRequest::GetQueryParameter.\n- *\n- * @param[in] uri is the entire request uri\n- * @param[in] key represents the query parameter of which the value is returned\n- */\n-std::optional<std::string> GetQueryParameterFromUri(const char* uri, const std::string& key);\n+    /** Get libevent parsed URI, which is nullptr if uri parsing failed */\n+    evhttp_uri* GetURIParsed();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142371332",
      "id" : 1142371332,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EFzQE",
      "original_commit_id" : "0115dccef675c62d1c7f1b0df4c94827737de4a3",
      "original_line" : 131,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "src/httpserver.h",
      "position" : null,
      "pull_request_review_id" : 1348929370,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142371332/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-20T16:26:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142371332",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142374618"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142374618"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "After some tweaks around the unit tests (can't [test an assertion failure on`BOOST`](https://stackoverflow.com/questions/270542/testing-for-assert-in-the-boost-test-framework) and the a solution using`BOOST_REQUIRE_THROW(function_w_failing_assert(), boost::execution_exception);`works only on windows), this is done now.",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-20T16:14:22Z",
      "diff_hunk" : "@@ -13,26 +15,34 @@ BOOST_AUTO_TEST_CASE(test_query_parameters)\n {\n     std::string uri {};\n \n+    evhttp_request* evreq = evhttp_request_new(nullptr, nullptr);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142374618",
      "id" : 1142374618,
      "in_reply_to_id" : 1139180604,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EF0Da",
      "original_commit_id" : "213554cb97c9c89bca56b56e8d0af473102e3061",
      "original_line" : 18,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/test/httpserver_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 1348935012,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142374618/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-20T16:14:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142374618",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142376537"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142376537"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "What's the rationale behind moving all this code? I don't think it's necessary?",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-20T16:15:52Z",
      "diff_hunk" : "@@ -172,4 +163,19 @@ class HTTPEvent\n     struct event* ev;\n };\n \n+\n+/** Get the query parameter value from a evhttp_uri (parsed) object for a specified key, or std::nullopt\n+ * if the key is not found or uri_parsed parameter is nullptr (most probably from a failed parsing).\n+ *\n+ * If the query string contains duplicate keys, the first value is returned. Many web frameworks\n+ * would instead parse this as an array of values, but this is not (yet) implemented as it is\n+ * currently not needed in any of the endpoints.\n+ *\n+ * Helper function for HTTPRequest::GetQueryParameter.\n+ *\n+ * @param[in] uri_parsed is the evhttp_uri object (obtained from evhttp_uri_parse - libevent function)\n+ * @param[in] key represents the query parameter of which the value is returned\n+ */\n+std::optional<std::string> GetQueryParameterFromUri(const evhttp_uri* uri_parsed, const std::string& key);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142376537",
      "id" : 1142376537,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EF0hZ",
      "original_commit_id" : "0115dccef675c62d1c7f1b0df4c94827737de4a3",
      "original_line" : 180,
      "original_position" : 70,
      "original_start_line" : 166,
      "path" : "src/httpserver.h",
      "position" : null,
      "pull_request_review_id" : 1348929370,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142376537/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-03-20T16:26:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142376537",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142378663"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142378663"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "seems unrelated to this PR, and no need to touch this otherwise?",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-20T16:17:27Z",
      "diff_hunk" : "@@ -56,7 +57,8 @@ struct event_base* EventBase();\n class HTTPRequest\n {\n private:\n-    struct evhttp_request* req;\n+    struct evhttp_request* req{nullptr};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142378663",
      "id" : 1142378663,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EF1Cn",
      "original_commit_id" : "0115dccef675c62d1c7f1b0df4c94827737de4a3",
      "original_line" : 60,
      "original_position" : 13,
      "original_start_line" : 59,
      "path" : "src/httpserver.h",
      "position" : null,
      "pull_request_review_id" : 1348929370,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142378663/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "LEFT",
      "subject_type" : "line",
      "updated_at" : "2023-03-20T16:26:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142378663",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142379157"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142379157"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Why remove `const`?",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-20T16:17:50Z",
      "diff_hunk" : "@@ -92,7 +94,7 @@ class HTTPRequest\n      *\n      * @param[in] key represents the query parameter of which the value is returned\n      */\n-    std::optional<std::string> GetQueryParameter(const std::string& key) const;\n+    std::optional<std::string> GetQueryParameter(const std::string& key);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142379157",
      "id" : 1142379157,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EF1KV",
      "original_commit_id" : "0115dccef675c62d1c7f1b0df4c94827737de4a3",
      "original_line" : 97,
      "original_position" : 23,
      "original_start_line" : 95,
      "path" : "src/httpserver.h",
      "position" : null,
      "pull_request_review_id" : 1348929370,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142379157/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "LEFT",
      "subject_type" : "line",
      "updated_at" : "2023-03-20T16:26:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142379157",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142382188"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142382188"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think this would benefit from helper function(s) to avoid duplicating all the parsing/memclearing logic and make the tests easier to read.",
      "commit_id" : "9b0a0dc92308fa069ffc03ebe93eff2de317d59a",
      "created_at" : "2023-03-20T16:19:56Z",
      "diff_hunk" : "",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142382188",
      "id" : 1142382188,
      "line" : 1,
      "node_id" : "PRRC_kwDOABII585EF15s",
      "original_commit_id" : "9b0a0dc92308fa069ffc03ebe93eff2de317d59a",
      "original_line" : 1,
      "original_position" : 1,
      "original_start_line" : null,
      "path" : "src/test/httpserver_tests.cpp",
      "position" : 1,
      "pull_request_review_id" : 1348929370,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142382188/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "file",
      "updated_at" : "2023-03-20T16:26:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142382188",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142386023"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142386023"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "These changes are unrelated to the segmentation fault and at the very least need to be in a separate commit",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-20T16:22:20Z",
      "diff_hunk" : "@@ -205,16 +206,16 @@ def run_test(self):\n         assert_equal(len(json_obj['utxos']), 1)\n \n         # Do some invalid requests\n-        self.test_rest_request(\"/getutxos\", http_method='POST', req_type=ReqType.JSON, body='{\"checkmempool', status=400, ret_type=RetType.OBJ)\n-        self.test_rest_request(\"/getutxos\", http_method='POST', req_type=ReqType.BIN, body='{\"checkmempool', status=400, ret_type=RetType.OBJ)\n-        self.test_rest_request(\"/getutxos/checkmempool\", http_method='POST', req_type=ReqType.JSON, status=400, ret_type=RetType.OBJ)\n+        self.test_rest_request(\"/getutxos\", http_method='POST', req_type=ReqType.JSON, body='{\"checkmempool', status=HTTPStatus.BAD_REQUEST, ret_type=RetType.OBJ)\n+        self.test_rest_request(\"/getutxos\", http_method='POST', req_type=ReqType.BIN, body='{\"checkmempool', status=HTTPStatus.BAD_REQUEST, ret_type=RetType.OBJ)\n+        self.test_rest_request(\"/getutxos/checkmempool\", http_method='POST', req_type=ReqType.JSON, status=HTTPStatus.BAD_REQUEST, ret_type=RetType.OBJ)\n \n         # Test limits\n         long_uri = '/'.join([f\"{txid}-{n_}\" for n_ in range(20)])\n-        self.test_rest_request(f\"/getutxos/checkmempool/{long_uri}\", http_method='POST', status=400, ret_type=RetType.OBJ)\n+        self.test_rest_request(f\"/getutxos/checkmempool/{long_uri}\", http_method='POST', status=HTTPStatus.BAD_REQUEST, ret_type=RetType.OBJ)\n \n         long_uri = '/'.join([f'{txid}-{n_}' for n_ in range(15)])\n-        self.test_rest_request(f\"/getutxos/checkmempool/{long_uri}\", http_method='POST', status=200)\n+        self.test_rest_request(f\"/getutxos/checkmempool/{long_uri}\", http_method='POST', status=HTTPStatus.OK)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142386023",
      "id" : 1142386023,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EF21n",
      "original_commit_id" : "9b0a0dc92308fa069ffc03ebe93eff2de317d59a",
      "original_line" : 218,
      "original_position" : 47,
      "original_start_line" : 217,
      "path" : "test/functional/interface_rest.py",
      "position" : null,
      "pull_request_review_id" : 1348929370,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142386023/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "LEFT",
      "subject_type" : "line",
      "updated_at" : "2023-03-20T16:26:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142386023",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated changes:\r\n- Updated the code with a new workaround to avoid failures on unit tests (`httpserver_tests`).\r\n\r\nThanks @stickies-v for your prompt response and your support on quick workarounds on issues raised.",
      "created_at" : "2023-03-20T16:24:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1476552873",
      "id" : 1476552873,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585YAmip",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1476552873/reactions"
      },
      "updated_at" : "2023-03-20T16:24:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1476552873",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142420455"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142420455"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Sorry, forgot to remove all that.",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-20T16:48:13Z",
      "diff_hunk" : "@@ -205,16 +206,16 @@ def run_test(self):\n         assert_equal(len(json_obj['utxos']), 1)\n \n         # Do some invalid requests\n-        self.test_rest_request(\"/getutxos\", http_method='POST', req_type=ReqType.JSON, body='{\"checkmempool', status=400, ret_type=RetType.OBJ)\n-        self.test_rest_request(\"/getutxos\", http_method='POST', req_type=ReqType.BIN, body='{\"checkmempool', status=400, ret_type=RetType.OBJ)\n-        self.test_rest_request(\"/getutxos/checkmempool\", http_method='POST', req_type=ReqType.JSON, status=400, ret_type=RetType.OBJ)\n+        self.test_rest_request(\"/getutxos\", http_method='POST', req_type=ReqType.JSON, body='{\"checkmempool', status=HTTPStatus.BAD_REQUEST, ret_type=RetType.OBJ)\n+        self.test_rest_request(\"/getutxos\", http_method='POST', req_type=ReqType.BIN, body='{\"checkmempool', status=HTTPStatus.BAD_REQUEST, ret_type=RetType.OBJ)\n+        self.test_rest_request(\"/getutxos/checkmempool\", http_method='POST', req_type=ReqType.JSON, status=HTTPStatus.BAD_REQUEST, ret_type=RetType.OBJ)\n \n         # Test limits\n         long_uri = '/'.join([f\"{txid}-{n_}\" for n_ in range(20)])\n-        self.test_rest_request(f\"/getutxos/checkmempool/{long_uri}\", http_method='POST', status=400, ret_type=RetType.OBJ)\n+        self.test_rest_request(f\"/getutxos/checkmempool/{long_uri}\", http_method='POST', status=HTTPStatus.BAD_REQUEST, ret_type=RetType.OBJ)\n \n         long_uri = '/'.join([f'{txid}-{n_}' for n_ in range(15)])\n-        self.test_rest_request(f\"/getutxos/checkmempool/{long_uri}\", http_method='POST', status=200)\n+        self.test_rest_request(f\"/getutxos/checkmempool/{long_uri}\", http_method='POST', status=HTTPStatus.OK)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142420455",
      "id" : 1142420455,
      "in_reply_to_id" : 1142386023,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EF_Pn",
      "original_commit_id" : "9b0a0dc92308fa069ffc03ebe93eff2de317d59a",
      "original_line" : 218,
      "original_position" : 47,
      "original_start_line" : 217,
      "path" : "test/functional/interface_rest.py",
      "position" : null,
      "pull_request_review_id" : 1349011567,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142420455/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "LEFT",
      "subject_type" : "line",
      "updated_at" : "2023-03-20T16:48:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142420455",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142421537"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142421537"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Was unintentional, going to place it on its original location.",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-20T16:49:05Z",
      "diff_hunk" : "@@ -172,4 +163,19 @@ class HTTPEvent\n     struct event* ev;\n };\n \n+\n+/** Get the query parameter value from a evhttp_uri (parsed) object for a specified key, or std::nullopt\n+ * if the key is not found or uri_parsed parameter is nullptr (most probably from a failed parsing).\n+ *\n+ * If the query string contains duplicate keys, the first value is returned. Many web frameworks\n+ * would instead parse this as an array of values, but this is not (yet) implemented as it is\n+ * currently not needed in any of the endpoints.\n+ *\n+ * Helper function for HTTPRequest::GetQueryParameter.\n+ *\n+ * @param[in] uri_parsed is the evhttp_uri object (obtained from evhttp_uri_parse - libevent function)\n+ * @param[in] key represents the query parameter of which the value is returned\n+ */\n+std::optional<std::string> GetQueryParameterFromUri(const evhttp_uri* uri_parsed, const std::string& key);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142421537",
      "id" : 1142421537,
      "in_reply_to_id" : 1142376537,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EF_gh",
      "original_commit_id" : "0115dccef675c62d1c7f1b0df4c94827737de4a3",
      "original_line" : 180,
      "original_position" : 70,
      "original_start_line" : 166,
      "path" : "src/httpserver.h",
      "position" : null,
      "pull_request_review_id" : 1349013127,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142421537/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-03-20T16:49:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142421537",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142422788"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142422788"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "ok",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-20T16:50:02Z",
      "diff_hunk" : "@@ -689,11 +703,12 @@ std::optional<std::string> GetQueryParameterFromUri(const char* uri, const std::\n         }\n         evhttp_clear_headers(&params_q);\n     }\n-    evhttp_uri_free(uri_parsed);\n \n     return result;\n }\n \n+evhttp_uri* HTTPRequest::GetURIParsed() { return m_uri_parsed; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142422788",
      "id" : 1142422788,
      "in_reply_to_id" : 1142370781,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EF_0E",
      "original_commit_id" : "0115dccef675c62d1c7f1b0df4c94827737de4a3",
      "original_line" : 710,
      "original_position" : 92,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 1349014880,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142422788/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-20T16:50:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142422788",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142437445"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142437445"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit:\r\n```suggestion\r\n    const std::string uri{\"localhost:8080/rest/headers/someresource.json\"};\r\n```",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-20T17:01:25Z",
      "diff_hunk" : "@@ -5,34 +5,50 @@\n #include <httpserver.h>\n #include <test/util/setup_common.h>\n \n+#include <event2/http.h>\n+\n #include <boost/test/unit_test.hpp>\n \n BOOST_FIXTURE_TEST_SUITE(httpserver_tests, BasicTestingSetup)\n \n BOOST_AUTO_TEST_CASE(test_query_parameters)\n {\n-    std::string uri {};\n-\n     // No parameters\n-    uri = \"localhost:8080/rest/headers/someresource.json\";\n-    BOOST_CHECK(!GetQueryParameterFromUri(uri.c_str(), \"p1\").has_value());\n+    std::string uri = \"localhost:8080/rest/headers/someresource.json\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142437445",
      "id" : 1142437445,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EGDZF",
      "original_commit_id" : "9b0a0dc92308fa069ffc03ebe93eff2de317d59a",
      "original_line" : 17,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/test/httpserver_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 1349035814,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142437445/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-20T17:01:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142437445",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142439278"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142439278"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "right",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-20T17:02:57Z",
      "diff_hunk" : "@@ -5,34 +5,50 @@\n #include <httpserver.h>\n #include <test/util/setup_common.h>\n \n+#include <event2/http.h>\n+\n #include <boost/test/unit_test.hpp>\n \n BOOST_FIXTURE_TEST_SUITE(httpserver_tests, BasicTestingSetup)\n \n BOOST_AUTO_TEST_CASE(test_query_parameters)\n {\n-    std::string uri {};\n-\n     // No parameters\n-    uri = \"localhost:8080/rest/headers/someresource.json\";\n-    BOOST_CHECK(!GetQueryParameterFromUri(uri.c_str(), \"p1\").has_value());\n+    std::string uri = \"localhost:8080/rest/headers/someresource.json\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142439278",
      "id" : 1142439278,
      "in_reply_to_id" : 1142437445,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EGD1u",
      "original_commit_id" : "9b0a0dc92308fa069ffc03ebe93eff2de317d59a",
      "original_line" : 17,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/test/httpserver_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 1349038523,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142439278/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-20T17:02:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142439278",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142447667"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142447667"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I wanted to make sure then to use the free up function for the request in the `HTTPRequest` destructor: `evhttp_request_free`. This was something I was doing while investigating the previous failure of the ASan tests and possible memory leaks. I'll remove it if you think unnecessary, ",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-20T17:10:00Z",
      "diff_hunk" : "@@ -56,7 +57,8 @@ struct event_base* EventBase();\n class HTTPRequest\n {\n private:\n-    struct evhttp_request* req;\n+    struct evhttp_request* req{nullptr};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142447667",
      "id" : 1142447667,
      "in_reply_to_id" : 1142378663,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EGF4z",
      "original_commit_id" : "0115dccef675c62d1c7f1b0df4c94827737de4a3",
      "original_line" : 60,
      "original_position" : 13,
      "original_start_line" : 59,
      "path" : "src/httpserver.h",
      "position" : null,
      "pull_request_review_id" : 1349051248,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142447667/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "LEFT",
      "subject_type" : "line",
      "updated_at" : "2023-03-20T17:10:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142447667",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142449820"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142449820"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "ok, let me add some helper(s) there.",
      "commit_id" : "9b0a0dc92308fa069ffc03ebe93eff2de317d59a",
      "created_at" : "2023-03-20T17:11:51Z",
      "diff_hunk" : "",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142449820",
      "id" : 1142449820,
      "in_reply_to_id" : 1142382188,
      "line" : 1,
      "node_id" : "PRRC_kwDOABII585EGGac",
      "original_commit_id" : "9b0a0dc92308fa069ffc03ebe93eff2de317d59a",
      "original_line" : 1,
      "original_position" : 1,
      "original_start_line" : null,
      "path" : "src/test/httpserver_tests.cpp",
      "position" : 1,
      "pull_request_review_id" : 1349054407,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142449820/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "file",
      "updated_at" : "2023-03-20T17:11:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142449820",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142466765"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142466765"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah, putting it back, before the compiler was complaining as in the previous approach we were modifying m_uri_parsed in this function.",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-20T17:26:12Z",
      "diff_hunk" : "@@ -124,21 +126,10 @@ class HTTPRequest\n      * main thread, do not call any other HTTPRequest methods after calling this.\n      */\n     void WriteReply(int nStatus, const std::string& strReply = \"\");\n-};\n \n-/** Get the query parameter value from request uri for a specified key, or std::nullopt if the key\n- * is not found.\n- *\n- * If the query string contains duplicate keys, the first value is returned. Many web frameworks\n- * would instead parse this as an array of values, but this is not (yet) implemented as it is\n- * currently not needed in any of the endpoints.\n- *\n- * Helper function for HTTPRequest::GetQueryParameter.\n- *\n- * @param[in] uri is the entire request uri\n- * @param[in] key represents the query parameter of which the value is returned\n- */\n-std::optional<std::string> GetQueryParameterFromUri(const char* uri, const std::string& key);\n+    /** Get libevent parsed URI, which is nullptr if uri parsing failed */\n+    evhttp_uri* GetURIParsed();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142466765",
      "id" : 1142466765,
      "in_reply_to_id" : 1142371332,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EGKjN",
      "original_commit_id" : "0115dccef675c62d1c7f1b0df4c94827737de4a3",
      "original_line" : 131,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "src/httpserver.h",
      "position" : null,
      "pull_request_review_id" : 1349078617,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142466765/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-20T17:26:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142466765",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142467803"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142467803"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Similar reason to the above comment on`GetURIParsed()` function, back again. ",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-20T17:27:08Z",
      "diff_hunk" : "@@ -92,7 +94,7 @@ class HTTPRequest\n      *\n      * @param[in] key represents the query parameter of which the value is returned\n      */\n-    std::optional<std::string> GetQueryParameter(const std::string& key) const;\n+    std::optional<std::string> GetQueryParameter(const std::string& key);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142467803",
      "id" : 1142467803,
      "in_reply_to_id" : 1142379157,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EGKzb",
      "original_commit_id" : "0115dccef675c62d1c7f1b0df4c94827737de4a3",
      "original_line" : 97,
      "original_position" : 23,
      "original_start_line" : 95,
      "path" : "src/httpserver.h",
      "position" : null,
      "pull_request_review_id" : 1349080168,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142467803/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "LEFT",
      "subject_type" : "line",
      "updated_at" : "2023-03-20T17:27:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142467803",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142472126"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142472126"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I'll take it back.",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-20T17:30:56Z",
      "diff_hunk" : "@@ -56,7 +57,8 @@ struct event_base* EventBase();\n class HTTPRequest\n {\n private:\n-    struct evhttp_request* req;\n+    struct evhttp_request* req{nullptr};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142472126",
      "id" : 1142472126,
      "in_reply_to_id" : 1142378663,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EGL2-",
      "original_commit_id" : "0115dccef675c62d1c7f1b0df4c94827737de4a3",
      "original_line" : 60,
      "original_position" : 13,
      "original_start_line" : 59,
      "path" : "src/httpserver.h",
      "position" : null,
      "pull_request_review_id" : 1349086453,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142472126/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "LEFT",
      "subject_type" : "line",
      "updated_at" : "2023-03-20T17:30:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142472126",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142506066"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142506066"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done.",
      "commit_id" : "9b0a0dc92308fa069ffc03ebe93eff2de317d59a",
      "created_at" : "2023-03-20T18:01:55Z",
      "diff_hunk" : "",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142506066",
      "id" : 1142506066,
      "in_reply_to_id" : 1142382188,
      "line" : 1,
      "node_id" : "PRRC_kwDOABII585EGUJS",
      "original_commit_id" : "9b0a0dc92308fa069ffc03ebe93eff2de317d59a",
      "original_line" : 1,
      "original_position" : 1,
      "original_start_line" : null,
      "path" : "src/test/httpserver_tests.cpp",
      "position" : 1,
      "pull_request_review_id" : 1349136769,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142506066/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "file",
      "updated_at" : "2023-03-20T18:01:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1142506066",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1143232308"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143232308"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: it's actually an argument, but I would just leave it out\r\n\r\n```suggestion\r\n * if the key is not found or if uri_parsed is nullptr (most probably from a failed parsing).\r\n```",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-21T11:26:13Z",
      "diff_hunk" : "@@ -124,21 +126,24 @@ class HTTPRequest\n      * main thread, do not call any other HTTPRequest methods after calling this.\n      */\n     void WriteReply(int nStatus, const std::string& strReply = \"\");\n+\n+    /** Get libevent parsed URI, which is nullptr if uri parsing failed */\n+    const evhttp_uri* GetURIParsed() const { return m_uri_parsed; }\n };\n \n-/** Get the query parameter value from request uri for a specified key, or std::nullopt if the key\n- * is not found.\n+/** Get the query parameter value from a evhttp_uri (parsed) object for a specified key, or std::nullopt\n+ * if the key is not found or uri_parsed parameter is nullptr (most probably from a failed parsing).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1143232308",
      "id" : 1143232308,
      "line" : 135,
      "node_id" : "PRRC_kwDOABII585EJFc0",
      "original_commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "original_line" : 135,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/httpserver.h",
      "position" : 28,
      "pull_request_review_id" : 1350217812,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143232308/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-21T12:12:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143232308",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1143234062"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143234062"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit\r\n```suggestion\r\n * @param[in] uri_parsed is the uri parsed with libevent's evhttp_uri_parse\r\n```",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-21T11:27:55Z",
      "diff_hunk" : "@@ -124,21 +126,24 @@ class HTTPRequest\n      * main thread, do not call any other HTTPRequest methods after calling this.\n      */\n     void WriteReply(int nStatus, const std::string& strReply = \"\");\n+\n+    /** Get libevent parsed URI, which is nullptr if uri parsing failed */\n+    const evhttp_uri* GetURIParsed() const { return m_uri_parsed; }\n };\n \n-/** Get the query parameter value from request uri for a specified key, or std::nullopt if the key\n- * is not found.\n+/** Get the query parameter value from a evhttp_uri (parsed) object for a specified key, or std::nullopt\n+ * if the key is not found or uri_parsed parameter is nullptr (most probably from a failed parsing).\n  *\n  * If the query string contains duplicate keys, the first value is returned. Many web frameworks\n  * would instead parse this as an array of values, but this is not (yet) implemented as it is\n  * currently not needed in any of the endpoints.\n  *\n  * Helper function for HTTPRequest::GetQueryParameter.\n  *\n- * @param[in] uri is the entire request uri\n+ * @param[in] uri_parsed is the evhttp_uri object (obtained from evhttp_uri_parse - libevent function)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1143234062",
      "id" : 1143234062,
      "line" : 143,
      "node_id" : "PRRC_kwDOABII585EJF4O",
      "original_commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "original_line" : 143,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "src/httpserver.h",
      "position" : 37,
      "pull_request_review_id" : 1350217812,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143234062/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-21T12:12:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143234062",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1143273441"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143273441"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think the tests are still more complex than necessary. How about this:\r\n\r\n<details>\r\n<summary>git diff</summary>\r\n\r\n```diff\r\ndiff --git a/src/test/httpserver_tests.cpp b/src/test/httpserver_tests.cpp\r\nindex 0462d3ae3..6ae57bdf0 100644\r\n--- a/src/test/httpserver_tests.cpp\r\n+++ b/src/test/httpserver_tests.cpp\r\n@@ -11,42 +11,46 @@\r\n \r\n BOOST_FIXTURE_TEST_SUITE(httpserver_tests, BasicTestingSetup)\r\n \r\n-static evhttp_uri* GetURIParsed(const std::string uri){\r\n-    return evhttp_uri_parse(uri.c_str());\r\n+/** Test if query parameter exists in the provided uri. */\r\n+bool QueryParameterExists(std::string_view uri, const std::string& key)\r\n+{\r\n+    auto uri_parsed{evhttp_uri_parse(uri.data())};\r\n+    const bool exists{GetQueryParameterFromUri(uri_parsed, key).has_value()};\r\n+    if(uri_parsed) evhttp_uri_free(uri_parsed);\r\n+    return exists;\r\n+}\r\n+\r\n+/** Test if query parameter exists in the provided uri and if its value matches the expected_value. */\r\n+bool QueryParameterEquals(std::string_view uri, const std::string& key, std::string_view expected_value)\r\n+{\r\n+    auto uri_parsed{evhttp_uri_parse(uri.data())};\r\n+    const auto param_value{GetQueryParameterFromUri(uri_parsed, key)};\r\n+    const bool is_equal{param_value.has_value() && *param_value == expected_value};\r\n+    if(uri_parsed) evhttp_uri_free(uri_parsed);\r\n+    return is_equal;\r\n }\r\n \r\n BOOST_AUTO_TEST_CASE(test_query_parameters)\r\n {\r\n     // No parameters\r\n-    evhttp_uri* uri_parsed{GetURIParsed(\"localhost:8080/rest/headers/someresource.json\")};\r\n-    BOOST_CHECK(!GetQueryParameterFromUri(uri_parsed, \"p1\").has_value());\r\n-    evhttp_uri_free(uri_parsed);\r\n+    BOOST_CHECK(!QueryParameterExists(\"localhost:8080/rest/headers/someresource.json\", \"p1\"));\r\n \r\n     // Single parameter\r\n-    uri_parsed = GetURIParsed(\"localhost:8080/rest/endpoint/someresource.json?p1=v1\");\r\n-    BOOST_CHECK_EQUAL(GetQueryParameterFromUri(uri_parsed, \"p1\").value(), \"v1\");\r\n-    BOOST_CHECK(!GetQueryParameterFromUri(uri_parsed, \"p2\").has_value());\r\n-    evhttp_uri_free(uri_parsed);\r\n+    BOOST_CHECK(QueryParameterEquals(\"localhost:8080/rest/endpoint/someresource.json?p1=v1\", \"p1\", \"v1\"));\r\n+    BOOST_CHECK(!QueryParameterExists(\"localhost:8080/rest/endpoint/someresource.json?p1=v1\", \"p2\"));\r\n \r\n     // Multiple parameters\r\n-    uri_parsed = GetURIParsed(\"/rest/endpoint/someresource.json?p1=v1&p2=v2\");\r\n-    BOOST_CHECK_EQUAL(GetQueryParameterFromUri(uri_parsed, \"p1\").value(), \"v1\");\r\n-    BOOST_CHECK_EQUAL(GetQueryParameterFromUri(uri_parsed, \"p2\").value(), \"v2\");\r\n-    evhttp_uri_free(uri_parsed);\r\n+    BOOST_CHECK(QueryParameterEquals(\"/rest/endpoint/someresource.json?p1=v1&p2=v2\", \"p1\", \"v1\"));\r\n+    BOOST_CHECK(QueryParameterEquals(\"/rest/endpoint/someresource.json?p1=v1&p2=v2\", \"p2\", \"v2\"));\r\n \r\n     // If the query string contains duplicate keys, the first value is returned\r\n-    uri_parsed = GetURIParsed(\"/rest/endpoint/someresource.json?p1=v1&p1=v2\");\r\n-    BOOST_CHECK_EQUAL(GetQueryParameterFromUri(uri_parsed, \"p1\").value(), \"v1\");\r\n-    evhttp_uri_free(uri_parsed);\r\n+    BOOST_CHECK(QueryParameterEquals(\"/rest/endpoint/someresource.json?p1=v1&p1=v2\", \"p1\", \"v1\"));\r\n \r\n     // Invalid query string syntax is the same as not having parameters\r\n-    uri_parsed = GetURIParsed(\"/rest/endpoint/someresource.json&p1=v1&p2=v2\");\r\n-    BOOST_CHECK(!GetQueryParameterFromUri(uri_parsed, \"p1\").has_value());\r\n-    evhttp_uri_free(uri_parsed);\r\n+    BOOST_CHECK(!QueryParameterExists(\"/rest/endpoint/someresource.json&p1=v1&p2=v2\", \"p1\"));\r\n \r\n     // Invalid URI with % symbol won't return any values as not having parameters at all\r\n-    uri_parsed = GetURIParsed(\"/rest/endpoint/someresource.json&p1=v1&p2=v2%\");\r\n-    BOOST_CHECK_EQUAL(uri_parsed, nullptr);\r\n-    BOOST_CHECK(!GetQueryParameterFromUri(uri_parsed, \"p1\").has_value());\r\n+    BOOST_CHECK(!QueryParameterExists(\"/rest/endpoint/someresource.json&p1=v1&p2=v2%\", \"p1\"));\r\n+\r\n }\r\n BOOST_AUTO_TEST_SUITE_END()\r\n\r\n```\r\n</details>\r\n\r\nCan probably still be deduplicated a bit more using an RAII wrapper for uri_parsed, if you like.",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-21T12:04:40Z",
      "diff_hunk" : "",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1143273441",
      "id" : 1143273441,
      "line" : 1,
      "node_id" : "PRRC_kwDOABII585EJPfh",
      "original_commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "original_line" : 1,
      "original_position" : 1,
      "original_start_line" : null,
      "path" : "src/test/httpserver_tests.cpp",
      "position" : 1,
      "pull_request_review_id" : 1350217812,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143273441/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "file",
      "updated_at" : "2023-03-21T12:12:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143273441",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1143875114"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143875114"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done.",
      "commit_id" : "0aa0626c502b70244da8dfd519612635a8e90f3b",
      "created_at" : "2023-03-21T19:04:52Z",
      "diff_hunk" : "@@ -124,21 +126,24 @@ class HTTPRequest\n      * main thread, do not call any other HTTPRequest methods after calling this.\n      */\n     void WriteReply(int nStatus, const std::string& strReply = \"\");\n+\n+    /** Get libevent parsed URI, which is nullptr if uri parsing failed */\n+    const evhttp_uri* GetURIParsed() const { return m_uri_parsed; }\n };\n \n-/** Get the query parameter value from request uri for a specified key, or std::nullopt if the key\n- * is not found.\n+/** Get the query parameter value from a evhttp_uri (parsed) object for a specified key, or std::nullopt\n+ * if the key is not found or uri_parsed parameter is nullptr (most probably from a failed parsing).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1143875114",
      "id" : 1143875114,
      "in_reply_to_id" : 1143232308,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585ELiYq",
      "original_commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "original_line" : 135,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/httpserver.h",
      "position" : null,
      "pull_request_review_id" : 1351215452,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143875114/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-21T19:04:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143875114",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1143875257"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143875257"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done.",
      "commit_id" : "0aa0626c502b70244da8dfd519612635a8e90f3b",
      "created_at" : "2023-03-21T19:05:02Z",
      "diff_hunk" : "@@ -124,21 +126,24 @@ class HTTPRequest\n      * main thread, do not call any other HTTPRequest methods after calling this.\n      */\n     void WriteReply(int nStatus, const std::string& strReply = \"\");\n+\n+    /** Get libevent parsed URI, which is nullptr if uri parsing failed */\n+    const evhttp_uri* GetURIParsed() const { return m_uri_parsed; }\n };\n \n-/** Get the query parameter value from request uri for a specified key, or std::nullopt if the key\n- * is not found.\n+/** Get the query parameter value from a evhttp_uri (parsed) object for a specified key, or std::nullopt\n+ * if the key is not found or uri_parsed parameter is nullptr (most probably from a failed parsing).\n  *\n  * If the query string contains duplicate keys, the first value is returned. Many web frameworks\n  * would instead parse this as an array of values, but this is not (yet) implemented as it is\n  * currently not needed in any of the endpoints.\n  *\n  * Helper function for HTTPRequest::GetQueryParameter.\n  *\n- * @param[in] uri is the entire request uri\n+ * @param[in] uri_parsed is the evhttp_uri object (obtained from evhttp_uri_parse - libevent function)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1143875257",
      "id" : 1143875257,
      "in_reply_to_id" : 1143234062,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585ELia5",
      "original_commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "original_line" : 143,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "src/httpserver.h",
      "position" : null,
      "pull_request_review_id" : 1351215697,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143875257/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-21T19:05:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143875257",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1143958464"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143958464"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done with one more tweak. I'll use an RAII wrapper if I have to touch the code again, and if that's the case, could you pls point me to an example already here in the bitcoin core code if already exists? Thanks.",
      "commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "created_at" : "2023-03-21T20:32:06Z",
      "diff_hunk" : "",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1143958464",
      "id" : 1143958464,
      "in_reply_to_id" : 1143273441,
      "line" : 1,
      "node_id" : "PRRC_kwDOABII585EL2vA",
      "original_commit_id" : "36be160a9b4863c59c6be4bc41d6ffa29903da17",
      "original_line" : 1,
      "original_position" : 1,
      "original_start_line" : null,
      "path" : "src/test/httpserver_tests.cpp",
      "position" : 1,
      "pull_request_review_id" : 1351338825,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143958464/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "file",
      "updated_at" : "2023-03-21T20:32:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143958464",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1144885003"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1144885003"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Missing `#include <string>` and `#include <string_view>`",
      "commit_id" : "0aa0626c502b70244da8dfd519612635a8e90f3b",
      "created_at" : "2023-03-22T14:15:26Z",
      "diff_hunk" : "@@ -5,34 +5,52 @@\n #include <httpserver.h>\n #include <test/util/setup_common.h>\n \n+#include <event2/http.h>\n+\n #include <boost/test/unit_test.hpp>\n \n BOOST_FIXTURE_TEST_SUITE(httpserver_tests, BasicTestingSetup)\n \n-BOOST_AUTO_TEST_CASE(test_query_parameters)\n+std::optional<std::string> GetParameterFromURI(const std::string_view uri, const std::string& key){",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1144885003",
      "id" : 1144885003,
      "line" : 17,
      "node_id" : "PRRC_kwDOABII585EPY8L",
      "original_commit_id" : "729287530e458febf32e01e542a36e7be4a74fbf",
      "original_line" : 17,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/test/httpserver_tests.cpp",
      "position" : 14,
      "pull_request_review_id" : 1352688865,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1144885003/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-22T14:18:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1144885003",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1144930961"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1144930961"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```\r\ntest/httpserver_tests.cpp:18:12: error: constness of 'param_value' prevents automatic move [performance-no-automatic-move,-warnings-as-errors]\r\n    return param_value;\r\n           ^\r\nclang-tidy-14 --us",
      "commit_id" : "0aa0626c502b70244da8dfd519612635a8e90f3b",
      "created_at" : "2023-03-22T14:44:12Z",
      "diff_hunk" : "@@ -5,34 +5,52 @@\n #include <httpserver.h>\n #include <test/util/setup_common.h>\n \n+#include <event2/http.h>\n+\n #include <boost/test/unit_test.hpp>\n \n BOOST_FIXTURE_TEST_SUITE(httpserver_tests, BasicTestingSetup)\n \n-BOOST_AUTO_TEST_CASE(test_query_parameters)\n+std::optional<std::string> GetParameterFromURI(const std::string_view uri, const std::string& key){\n+    auto uri_parsed{evhttp_uri_parse(uri.data())};\n+    const auto param_value{GetQueryParameterFromUri(uri_parsed, key)};\n+    if(uri_parsed) evhttp_uri_free(uri_parsed);\n+    return param_value;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1144930961",
      "id" : 1144930961,
      "line" : 21,
      "node_id" : "PRRC_kwDOABII585EPkKR",
      "original_commit_id" : "729287530e458febf32e01e542a36e7be4a74fbf",
      "original_line" : 21,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/test/httpserver_tests.cpp",
      "position" : 18,
      "pull_request_review_id" : 1352757174,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 1,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1144930961/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-22T14:44:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1144930961",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1144975901"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1144975901"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I'll fix this.",
      "commit_id" : "0aa0626c502b70244da8dfd519612635a8e90f3b",
      "created_at" : "2023-03-22T15:12:33Z",
      "diff_hunk" : "@@ -5,34 +5,52 @@\n #include <httpserver.h>\n #include <test/util/setup_common.h>\n \n+#include <event2/http.h>\n+\n #include <boost/test/unit_test.hpp>\n \n BOOST_FIXTURE_TEST_SUITE(httpserver_tests, BasicTestingSetup)\n \n-BOOST_AUTO_TEST_CASE(test_query_parameters)\n+std::optional<std::string> GetParameterFromURI(const std::string_view uri, const std::string& key){\n+    auto uri_parsed{evhttp_uri_parse(uri.data())};\n+    const auto param_value{GetQueryParameterFromUri(uri_parsed, key)};\n+    if(uri_parsed) evhttp_uri_free(uri_parsed);\n+    return param_value;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1144975901",
      "id" : 1144975901,
      "in_reply_to_id" : 1144930961,
      "line" : 21,
      "node_id" : "PRRC_kwDOABII585EPvId",
      "original_commit_id" : "729287530e458febf32e01e542a36e7be4a74fbf",
      "original_line" : 21,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/test/httpserver_tests.cpp",
      "position" : 18,
      "pull_request_review_id" : 1352828665,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1144975901/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-22T15:12:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1144975901",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1144977982"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1144977982"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok, thanks.",
      "commit_id" : "0aa0626c502b70244da8dfd519612635a8e90f3b",
      "created_at" : "2023-03-22T15:14:01Z",
      "diff_hunk" : "@@ -5,34 +5,52 @@\n #include <httpserver.h>\n #include <test/util/setup_common.h>\n \n+#include <event2/http.h>\n+\n #include <boost/test/unit_test.hpp>\n \n BOOST_FIXTURE_TEST_SUITE(httpserver_tests, BasicTestingSetup)\n \n-BOOST_AUTO_TEST_CASE(test_query_parameters)\n+std::optional<std::string> GetParameterFromURI(const std::string_view uri, const std::string& key){",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1144977982",
      "id" : 1144977982,
      "in_reply_to_id" : 1144885003,
      "line" : 17,
      "node_id" : "PRRC_kwDOABII585EPvo-",
      "original_commit_id" : "729287530e458febf32e01e542a36e7be4a74fbf",
      "original_line" : 17,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/test/httpserver_tests.cpp",
      "position" : 14,
      "pull_request_review_id" : 1352832771,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1144977982/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-22T15:14:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1144977982",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> but I think the commit message [should be updated](https://github.com/bitcoin/bitcoin/pull/27253#pullrequestreview-1348929370) to better describe the bug, the fix, and the behaviour change introduced\r\n\r\nYes, I have that pending to do asap.",
      "created_at" : "2023-03-22T15:15:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1479758216",
      "id" : 1479758216,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585YM1GI",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1479758216/reactions"
      },
      "updated_at" : "2023-03-22T15:15:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1479758216",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK\r\n\r\nThe code as of 8bdea6316c looks ok, but it seems to be mixing the fix with an optimization to only parse once (instead of every time a parameter is retrieved). It would be better to have two separate commits - one with the non-functional optimization and one with the fix.\r\n\r\nIdea: I think it would be better to disallow the creation of `HTTPRequest` if the request is invalid/unparsable. This would avoid having a `nullptr` member `m_uri_parsed` and having to handle the nullness. Would it work to check the sanity in the `HTTPRequest` constructor and if a problem is detected, then `throw` some object that contains an error code and a string (to convey e.g. `HTTP_BAD_REQUEST, \"Invalid URI\"`)? Then catch this in `http_request_cb()` and return early.\r\n\r\nThere are other similar bugs in this code which exist in `master` and remain unfixed by this PR:\r\n* `evhttp_request_get_uri()` may return `nullptr` which we pass unconditionally to `evhttp_uri_parse()` which will crash on `nullptr`.\r\n* In `HTTPRequest::GetURI()` we implicitly create `std::string` from the return value of `evhttp_request_get_uri()`. Creating a string from `nullptr` is undefined behavior.\r\n\r\nI am not sure under what circumstances would `evhttp_request_get_uri()` return `nullptr`, but it is not documented that it will never return `nullptr` and also [its source code](https://github.com/libevent/libevent/blob/6e1826dd7730330536e1838824bddd0d4d8adb0d/http.c#L4465-L4469) implies that it can, so better safe than sorry. I don't think fixing those is a requirement for this PR. If they are not, then I will follow up with a subsequent PR.\r\n",
      "created_at" : "2023-03-23T10:11:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1480921094",
      "id" : 1480921094,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585YRRAG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1480921094/reactions"
      },
      "updated_at" : "2023-03-23T10:11:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1480921094",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> It would be better to have two separate commits - one with the non-functional optimization and one with the fix.\r\n\r\nAgreed, that could probably be improved.\r\n\r\n> Idea: I think it would be better to disallow the creation of HTTPRequest if the request is invalid/unparsable.\r\n\r\nThis was the first approach I considered, but I think it's better not to. A request with an invalid URI is still a request, and thus it should be representable. Moving the URI validation to the constructor feels like a shortcut and coupling we don't need to take?\r\n\r\n> `evhttp_request_get_uri()` may return `nullptr`\r\n\r\nLike you, I don't see how that can happen in practice but can never hurt to make more robust. I think it's orthogonal to this PR but happy to review your PR - feel free to ping me?",
      "created_at" : "2023-03-23T13:06:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1481163868",
      "id" : 1481163868,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585YSMRc",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1481163868/reactions"
      },
      "updated_at" : "2023-03-23T13:06:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1481163868",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Moving the URI validation to the constructor feels like a shortcut and coupling we don't need to take?\r\n\r\nI do not have a strong opinion. This PR moved the parsing to the constructor, but left the checking of the parsing result for later. Now the code looks like (simplified):\r\n\r\n```cpp\r\n// constructs the object, does the parsing, leaves null m_uri_parsed if it fails\r\nHTTPRequest hreq(...);\r\n\r\nif (hreq.m_uri_parsed == nullptr) {\r\n    handle error and dispose hreq\r\n}\r\n\r\n// elsewhere a soft assert is needed to ensure hreq.m_uri_parsed != nullptr\r\n```\r\n\r\nI find the following more robust and compact:\r\n\r\n```cpp\r\nstd::unique_ptr<HTTPRequest> hreq;\r\ntry {\r\n    hreq = std::make_unique<HTTPRequest>(...);\r\n} catch (e) {\r\n    handle error e.code + e.msg\r\n}\r\n\r\n// no need for further error handling or checking here or elsewhere\r\n```\r\n\r\n> happy to review your PR - feel free to ping me\r\n\r\nSure, lets first see what happens with this PR. Maybe @pablomartin4btc would decide to check the return value of `evhttp_request_get_uri()` in this PR.",
      "created_at" : "2023-03-23T13:48:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1481229146",
      "id" : 1481229146,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585YScNa",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1481229146/reactions"
      },
      "updated_at" : "2023-03-23T13:48:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1481229146",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> >  It would be better to have two separate commits - one with the non-functional optimization and one with the fix.\r\n\r\n> Agreed, that could probably be improved.\r\n\r\nI can do this.\r\n\r\n\r\n> > Sure, lets first see what happens with this PR. Maybe @pablomartin4btc would decide to check the return value of evhttp_request_get_uri() in this PR.\r\n\r\nIt was under my radar and I thought to do it in a follow up, but I could do it here if it's more practical (need to update title and description of this PR).\r\n\r\n\r\n> > I find the following more robust and compact:\r\n```\r\nstd::unique_ptr<HTTPRequest> hreq;\r\ntry {\r\n    hreq = std::make_unique<HTTPRequest>(...);\r\n} catch (e) {\r\n    handle error e.code + e.msg\r\n}\r\n\r\n// no need for further error handling or checking here or elsewhere\r\n\r\n```\r\n\r\nI like this approach, let me check and play a bit with the code as if I need to raise an exception or can return the `HTTP_BAD_REQUEST` from there, and how the consumer (rest obj) would behave/ interact with it.\r\n",
      "created_at" : "2023-03-23T15:21:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1481390885",
      "id" : 1481390885,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585YTDsl",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1481390885/reactions"
      },
      "updated_at" : "2023-03-23T15:21:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1481390885",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "If you decide to go this way, something like this should work:\r\n\r\n```cpp\r\n// in HTTPRequest::HTTPRequest():\r\nif (cannot parse uri) {\r\n    const int code{HTTP_BAD_METHOD};\r\n    const char* what{\"Invalid URI\"};\r\n    WriteReply(code, what);\r\n    throw std::system_error(code, std::generic_category(), what);\r\n}\r\n\r\n// in http_request_cb():\r\nstd::unique_ptr<HTTPRequest> hreq;\r\ntry {\r\n    hreq = std::make_unique<HTTPRequest>(...);\r\n} catch (const std::system_error& e) {\r\n    LogPrint(BCLog::HTTP, \"%d %s\\n\", e.code().value(), e.what());\r\n    return;\r\n}",
      "created_at" : "2023-03-24T09:01:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1482465778",
      "id" : 1482465778,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585YXKHy",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1482465778/reactions"
      },
      "updated_at" : "2023-03-24T09:01:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1482465778",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated changes:\r\n\r\n- Moving the uri parsing validation from the http_request_cb to the HTTPRequest constructor, while doing this realised that it's better to validate the result of `evhttp_request_get_uri()` also at that time.\r\n\r\n@vasild, @stickies-v: please let me know what you think and I'll update title & description of the PR and will separate the code in 2 commits (proper fix & non-functional optimisation).\r\n",
      "created_at" : "2023-03-25T04:12:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1483714301",
      "id" : 1483714301,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585Yb679",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1483714301/reactions"
      },
      "updated_at" : "2023-03-25T04:12:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1483714301",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Regarding CI failures:\r\n\r\n- `./test/functional/wallet_create_tx.py` passes locally, actioned manually re-run and it passes too.\r\n- checking the fuzzer one `cirrus-ci-build/ci/scratch/qa-assets/fuzz_seed_corpus/http_request\" failed with exit code 77` - `fuzz: httpserver.cpp:618: void HTTPRequest::WriteReply(int, const std::string &): Assertion '!replySent && req' failed`. (crash-75d231d5e022cc38377bbbf4549058d37b7c59a3)\r\n     - it passes locally when I perform manually (following [fuzzing instructions](https://github.com/bitcoin/bitcoin/blob/master/doc/fuzzing.md)):\r\n```\r\nFUZZ=process_message ./src/test/fuzz/fuzz ../qa-assets/fuzz_seed_corpus/http_request/75d231d5e022cc38377bbbf4549058d37b7c59a3\r\nprocess_message: succeeded against 1 files in 0s.\r\n```",
      "created_at" : "2023-03-25T17:52:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1483882249",
      "id" : 1483882249,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585Ycj8J",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1483882249/reactions"
      },
      "updated_at" : "2023-03-27T04:26:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1483882249",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> FUZZ=process_message ./src/test/fuzz/fuzz ../qa-assets/fuzz_seed_corpus/http_request/75d231d5e022cc38377bbbf4549058d37b7c59a3\r\n\r\nYou'll need to set the correct fuzz target:\r\n\r\n\r\n`FUZZ=http_request ./src/test/fuzz/fuzz ../qa-assets/fuzz_seed_corpus/http_request/75d231d5e022cc38377bbbf4549058d37b7c59a3`",
      "created_at" : "2023-03-27T07:51:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1484668108",
      "id" : 1484668108,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585YfjzM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1484668108/reactions"
      },
      "updated_at" : "2023-03-27T07:51:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1484668108",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1149028723"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1149028723"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit:\r\n```suggestion\r\n    const std::string strURI{hreq->GetURI()};\r\n```",
      "commit_id" : "0aa0626c502b70244da8dfd519612635a8e90f3b",
      "created_at" : "2023-03-27T09:18:15Z",
      "diff_hunk" : "@@ -253,11 +262,11 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n         return;\n     }\n \n+    std::string strURI{hreq->GetURI()};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1149028723",
      "id" : 1149028723,
      "line" : 265,
      "node_id" : "PRRC_kwDOABII585EfMlz",
      "original_commit_id" : "0aa0626c502b70244da8dfd519612635a8e90f3b",
      "original_line" : 265,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : 29,
      "pull_request_review_id" : 1358692325,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1149028723/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-27T11:11:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1149028723",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1149034300"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1149034300"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "```suggestion\r\n    /** Get requested URI. Will always return non-nullptr.\r\n```",
      "commit_id" : "0aa0626c502b70244da8dfd519612635a8e90f3b",
      "created_at" : "2023-03-27T09:23:05Z",
      "diff_hunk" : "@@ -73,7 +75,7 @@ class HTTPRequest\n \n     /** Get requested URI.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1149034300",
      "id" : 1149034300,
      "line" : 76,
      "node_id" : "PRRC_kwDOABII585EfN88",
      "original_commit_id" : "0aa0626c502b70244da8dfd519612635a8e90f3b",
      "original_line" : 76,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/httpserver.h",
      "position" : 18,
      "pull_request_review_id" : 1358692325,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1149034300/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-27T11:11:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1149034300",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1149108682"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1149108682"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It is possible to enforce that this argument will never be null - if changed to reference. Simplifies the code a bit:\r\n\r\n```diff\r\ndiff --git i/src/httpserver.cpp w/src/httpserver.cpp\r\nindex e9b68a36c1..1dccb196be 100644\r\n--- i/src/httpserver.cpp\r\n+++ w/src/httpserver.cpp\r\n@@ -683,20 +683,18 @@ HTTPRequest::RequestMethod HTTPRequest::GetRequestMethod() const\r\n         return UNKNOWN;\r\n     }\r\n }\r\n \r\n std::optional<std::string> HTTPRequest::GetQueryParameter(const std::string& key) const\r\n {\r\n-    if (!Assume(m_uri_parsed)) return std::nullopt;  // HTTPRequest constructor should have checked that m_uri_parsed is not nullptr\r\n-    return GetQueryParameterFromUri(m_uri_parsed, key);\r\n+    return GetQueryParameterFromUri(*m_uri_parsed, key);\r\n }\r\n \r\n-std::optional<std::string> GetQueryParameterFromUri(const evhttp_uri* uri_parsed, const std::string& key)\r\n+std::optional<std::string> GetQueryParameterFromUri(const evhttp_uri& uri_parsed, const std::string& key)\r\n {\r\n-    if (!uri_parsed) return std::nullopt;\r\n-    const char* query{evhttp_uri_get_query(uri_parsed)};\r\n+    const char* query{evhttp_uri_get_query(&uri_parsed)};\r\n     std::optional<std::string> result;\r\n \r\n     if (query) {\r\n         // Parse the query string into a key-value queue and iterate over it\r\n         struct evkeyvalq params_q;\r\n         evhttp_parse_query_str(query, &params_q);\r\ndiff --git i/src/httpserver.h w/src/httpserver.h\r\nindex 5b21a678c5..3f2ef06c11 100644\r\n--- i/src/httpserver.h\r\n+++ w/src/httpserver.h\r\n@@ -126,24 +126,24 @@ public:\r\n      * main thread, do not call any other HTTPRequest methods after calling this.\r\n      */\r\n     void WriteReply(int nStatus, const std::string& strReply = \"\");\r\n };\r\n \r\n /** Get the query parameter value from a evhttp_uri (parsed) object for a specified key, or std::nullopt\r\n- * if the key is not found or if uri_parsed argument is nullptr (most probably from a failed parsing).\r\n+ * if the key is not found.\r\n  *\r\n  * If the query string contains duplicate keys, the first value is returned. Many web frameworks\r\n  * would instead parse this as an array of values, but this is not (yet) implemented as it is\r\n  * currently not needed in any of the endpoints.\r\n  *\r\n  * Helper function for HTTPRequest::GetQueryParameter.\r\n  *\r\n  * @param[in] uri_parsed is the uri parsed with libevent's evhttp_uri_parse\r\n  * @param[in] key represents the query parameter of which the value is returned\r\n  */\r\n-std::optional<std::string> GetQueryParameterFromUri(const evhttp_uri* uri_parsed, const std::string& key);\r\n+std::optional<std::string> GetQueryParameterFromUri(const evhttp_uri& uri_parsed, const std::string& key);\r\n \r\n /** Event handler closure.\r\n  */\r\n class HTTPClosure\r\n {\r\n public:\r\ndiff --git i/src/test/httpserver_tests.cpp w/src/test/httpserver_tests.cpp\r\nindex 120c6d102f..6e2128863d 100644\r\n--- i/src/test/httpserver_tests.cpp\r\n+++ w/src/test/httpserver_tests.cpp\r\n@@ -13,13 +13,13 @@\r\n #include <boost/test/unit_test.hpp>\r\n \r\n BOOST_FIXTURE_TEST_SUITE(httpserver_tests, BasicTestingSetup)\r\n \r\n std::optional<std::string> GetParameterFromURI(const std::string_view uri, const std::string& key){\r\n     auto uri_parsed{evhttp_uri_parse(uri.data())};\r\n-    auto param_value{GetQueryParameterFromUri(uri_parsed, key)};\r\n+    auto param_value{GetQueryParameterFromUri(*uri_parsed, key)};\r\n     if(uri_parsed) evhttp_uri_free(uri_parsed);\r\n     return param_value;\r\n }\r\n \r\n /** Test if query parameter exists in the provided uri. */\r\n bool QueryParameterExists(const std::string_view uri, const std::string& key)\r\n```",
      "commit_id" : "0aa0626c502b70244da8dfd519612635a8e90f3b",
      "created_at" : "2023-03-27T10:25:07Z",
      "diff_hunk" : "@@ -126,19 +128,19 @@ class HTTPRequest\n     void WriteReply(int nStatus, const std::string& strReply = \"\");\n };\n \n-/** Get the query parameter value from request uri for a specified key, or std::nullopt if the key\n- * is not found.\n+/** Get the query parameter value from a evhttp_uri (parsed) object for a specified key, or std::nullopt\n+ * if the key is not found or if uri_parsed argument is nullptr (most probably from a failed parsing).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1149108682",
      "id" : 1149108682,
      "line" : 132,
      "node_id" : "PRRC_kwDOABII585EfgHK",
      "original_commit_id" : "0aa0626c502b70244da8dfd519612635a8e90f3b",
      "original_line" : 132,
      "original_position" : 32,
      "original_start_line" : null,
      "path" : "src/httpserver.h",
      "position" : 32,
      "pull_request_review_id" : 1358692325,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1149108682/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-27T11:12:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1149108682",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1149110958"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1149110958"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`GetURI()` (which calls `evhttp_request_get_uri()`) could still return null. It seems too indirect to that we rely that we have called `evhttp_request_get_uri()` before on the same input and back then it returned non-null (from the constructor) so it must also return non-null now.\r\n\r\nI think it would be better to save the result in a variable and document that it will never be null. This will also avoid calling `evhttp_request_get_uri()` two times. Like this:\r\n\r\n```diff\r\ndiff --git i/src/httpserver.h w/src/httpserver.h\r\nindex 5b21a678c5..d7cd81be7e 100644\r\n--- i/src/httpserver.h\r\n+++ w/src/httpserver.h\r\n@@ -55,13 +55,16 @@ struct event_base* EventBase();\r\n  * Thin C++ wrapper around evhttp_request.\r\n  */\r\n class HTTPRequest\r\n {\r\n private:\r\n     struct evhttp_request* req;\r\n-    evhttp_uri* m_uri_parsed{nullptr};\r\n+    /// The URI, as returned by `evhttp_request_get_uri()`. Will never be `nullptr`.\r\n+    const char* const m_uri;\r\n+    /// The parsed URI, as returned by `evhttp_uri_parse()`. Will never be `nullptr`.\r\n+    evhttp_uri* const m_uri_parsed;\r\n     bool replySent;\r\n \r\n public:\r\n     explicit HTTPRequest(struct evhttp_request* req, bool replySent = false);\r\n     ~HTTPRequest();\r\n \r\ndiff --git i/src/httpserver.cpp w/src/httpserver.cpp\r\nindex e9b68a36c1..45d25bc32f 100644\r\n--- i/src/httpserver.cpp\r\n+++ w/src/httpserver.cpp\r\n@@ -238,14 +238,14 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\r\n     }\r\n \r\n     std::unique_ptr<HTTPRequest> hreq;\r\n \r\n     try {\r\n         hreq = std::make_unique<HTTPRequest>(req);\r\n-    } catch (const std::system_error& e) {\r\n-        LogPrint(BCLog::HTTP, \"%d %s\\n\", e.code().value(), e.what());\r\n+    } catch (const std::runtime_error& e) {\r\n+        LogPrint(BCLog::HTTP, \"%s\\n\", e.what());\r\n         return;\r\n     }\r\n \r\n     // Early address-based allow check\r\n     if (!ClientAllowed(hreq->GetPeer())) {\r\n         LogPrint(BCLog::HTTP, \"HTTP request from %s rejected: Client network is not allowed RPC access\\n\",\r\n@@ -543,34 +543,33 @@ void HTTPEvent::trigger(struct timeval* tv)\r\n         event_active(ev, 0, 0); // immediately trigger event in main thread\r\n     else\r\n         evtimer_add(ev, tv); // trigger after timeval passed\r\n }\r\n HTTPRequest::HTTPRequest(struct evhttp_request* _req, bool _replySent) :\r\n         req{_req},\r\n+        m_uri{evhttp_request_get_uri(req)},\r\n+        m_uri_parsed{m_uri != nullptr && m_uri[0] != '\\0' ? evhttp_uri_parse(m_uri) : nullptr},\r\n         replySent{_replySent}\r\n {\r\n-    const char* uri_to_parse{GetURI()};\r\n-    if (uri_to_parse != nullptr && uri_to_parse[0] != '\\0') m_uri_parsed = evhttp_uri_parse(uri_to_parse);\r\n-\r\n-    if (!m_uri_parsed) {\r\n-        const int code{HTTP_BAD_REQUEST};\r\n-        const char* what{\"Invalid URI\"};\r\n-        WriteReply(code, what);\r\n-        throw std::system_error(code, std::generic_category(), what);\r\n+    if (m_uri_parsed == nullptr) {\r\n+        const char* err{\"Invalid URI\"};\r\n+        WriteReply(HTTP_BAD_REQUEST, err);\r\n+        throw std::runtime_error(\r\n+            strprintf(\"HTTP request from %s rejected: %s\", GetPeer().ToStringAddr(), err));\r\n     }\r\n }\r\n \r\n HTTPRequest::~HTTPRequest()\r\n {\r\n     // evhttpd cleans up the request, as long as a reply was sent.\r\n     if (!replySent) {\r\n         // Keep track of whether reply was sent to avoid request leaks\r\n         LogPrintf(\"%s: Unhandled request\\n\", __func__);\r\n         WriteReply(HTTP_INTERNAL_SERVER_ERROR, \"Unhandled request\");\r\n     }\r\n-    if (m_uri_parsed) evhttp_uri_free(m_uri_parsed);\r\n+    evhttp_uri_free(m_uri_parsed);\r\n }\r\n \r\n std::pair<bool, std::string> HTTPRequest::GetHeader(const std::string& hdr) const\r\n {\r\n     const struct evkeyvalq* headers = evhttp_request_get_input_headers(req);\r\n     assert(headers);\r\n@@ -662,13 +661,13 @@ CService HTTPRequest::GetPeer() const\r\n     }\r\n     return peer;\r\n }\r\n \r\n const char* HTTPRequest::GetURI() const\r\n {\r\n-    return evhttp_request_get_uri(req);\r\n+    return m_uri;\r\n }\r\n \r\n HTTPRequest::RequestMethod HTTPRequest::GetRequestMethod() const\r\n {\r\n     switch (evhttp_request_get_command(req)) {\r\n     case EVHTTP_REQ_GET:\r\n```\r\n\r\n",
      "commit_id" : "0aa0626c502b70244da8dfd519612635a8e90f3b",
      "created_at" : "2023-03-27T10:27:19Z",
      "diff_hunk" : "@@ -253,11 +262,11 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n         return;\n     }\n \n+    std::string strURI{hreq->GetURI()};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1149110958",
      "id" : 1149110958,
      "line" : 265,
      "node_id" : "PRRC_kwDOABII585Efgqu",
      "original_commit_id" : "0aa0626c502b70244da8dfd519612635a8e90f3b",
      "original_line" : 265,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : 29,
      "pull_request_review_id" : 1358692325,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1149110958/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-27T11:11:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1149110958",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1149975805"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1149975805"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I see, changing a pointer to a reference does not inherently prevent null pointer dereferences at runtime. However, by changing a pointer to a reference and documenting that the reference is expected to be non-null, we are effectively enforcing a contract that the caller of the function must provide a valid (non-null) reference. Suggestion taken, thanks!",
      "commit_id" : "94df0d11810bda6fb9c1a27a7a14f5ca8fe8cd85",
      "created_at" : "2023-03-28T03:03:14Z",
      "diff_hunk" : "@@ -126,19 +128,19 @@ class HTTPRequest\n     void WriteReply(int nStatus, const std::string& strReply = \"\");\n };\n \n-/** Get the query parameter value from request uri for a specified key, or std::nullopt if the key\n- * is not found.\n+/** Get the query parameter value from a evhttp_uri (parsed) object for a specified key, or std::nullopt\n+ * if the key is not found or if uri_parsed argument is nullptr (most probably from a failed parsing).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1149975805",
      "id" : 1149975805,
      "in_reply_to_id" : 1149108682,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Eizz9",
      "original_commit_id" : "0aa0626c502b70244da8dfd519612635a8e90f3b",
      "original_line" : 132,
      "original_position" : 32,
      "original_start_line" : null,
      "path" : "src/httpserver.h",
      "position" : null,
      "pull_request_review_id" : 1360132776,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1149975805/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-28T03:03:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1149975805",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1149977087"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1149977087"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I agree with this suggestion, first the manipulation of null values, mainly its return, and also removing the extra call to `evhttp_request_get_uri()`.",
      "commit_id" : "94df0d11810bda6fb9c1a27a7a14f5ca8fe8cd85",
      "created_at" : "2023-03-28T03:06:21Z",
      "diff_hunk" : "@@ -253,11 +262,11 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n         return;\n     }\n \n+    std::string strURI{hreq->GetURI()};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1149977087",
      "id" : 1149977087,
      "in_reply_to_id" : 1149110958,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Ei0H_",
      "original_commit_id" : "0aa0626c502b70244da8dfd519612635a8e90f3b",
      "original_line" : 265,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 1360134747,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1149977087/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-28T03:06:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1149977087",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1150023699"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1150023699"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The problem removing `if (!uri_parsed) return std::nullopt;` line from `GetQueryParameterFromUri()` is that passing nullptr as the uri_parsed (from an invalid uri), as in the last test case in `httpserver_test.cpp` will produce the `segfault`, so I could opt that in the test but I dont think it's the real intention of testing `GetQueryParameterFromUri()`.",
      "commit_id" : "e17cfba19b341c56de31f1e99f2cd88f943b6fb6",
      "created_at" : "2023-03-28T04:51:44Z",
      "diff_hunk" : "@@ -126,19 +128,19 @@ class HTTPRequest\n     void WriteReply(int nStatus, const std::string& strReply = \"\");\n };\n \n-/** Get the query parameter value from request uri for a specified key, or std::nullopt if the key\n- * is not found.\n+/** Get the query parameter value from a evhttp_uri (parsed) object for a specified key, or std::nullopt\n+ * if the key is not found or if uri_parsed argument is nullptr (most probably from a failed parsing).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1150023699",
      "id" : 1150023699,
      "in_reply_to_id" : 1149108682,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Ei_gT",
      "original_commit_id" : "0aa0626c502b70244da8dfd519612635a8e90f3b",
      "original_line" : 132,
      "original_position" : 32,
      "original_start_line" : null,
      "path" : "src/httpserver.h",
      "position" : null,
      "pull_request_review_id" : 1360200538,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1150023699/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-28T04:51:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1150023699",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Working on functional failure`interface_rest`on the invalid uri case, something didn't like from latest changes.\r\n\r\nI think I've found the issue!\r\n\r\nBoth, .py and fuzz were getting the same failure `Assertion '!replySent && req' failed`.\r\n \r\nThe problem for the functional was that`GeetPeer()`was called while throwing the runtime exception, so moved it before.\r\n\r\nOn the fuzz `./src/test/fuzz/test http_request.cpp`, the issue is that the test itself is passing `replySent `as `true`, so the `WriteReply()` call on the httpserver constructor when the uri_parse is invalid. I'm investigating the rest of the test if we need to change anything there. Also, not sure, in which cases we need to create an instance of the `HTTPRequest` obj passing `replySent` as `true`, I didn't find a case in the entire code, unless as in the current fuzz we are talking about. ",
      "created_at" : "2023-03-28T05:24:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1486236260",
      "id" : 1486236260,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585Ylipk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1486236260/reactions"
      },
      "updated_at" : "2023-03-28T20:24:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1486236260",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1151145374"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1151145374"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit\r\n```suggestion\r\n    if (uri_parsed) evhttp_uri_free(uri_parsed);\r\n```",
      "commit_id" : "1c278adc1af97f5140a12a5d04a6232cd9966201",
      "created_at" : "2023-03-28T20:58:11Z",
      "diff_hunk" : "@@ -5,34 +5,55 @@\n #include <httpserver.h>\n #include <test/util/setup_common.h>\n \n+#include <event2/http.h>\n+\n+#include <string>\n+#include <string_view>\n+\n #include <boost/test/unit_test.hpp>\n \n BOOST_FIXTURE_TEST_SUITE(httpserver_tests, BasicTestingSetup)\n \n-BOOST_AUTO_TEST_CASE(test_query_parameters)\n+std::optional<std::string> GetParameterFromURI(const std::string_view uri, const std::string& key){\n+    auto uri_parsed{evhttp_uri_parse(uri.data())};\n+    if (uri_parsed == nullptr) return std::nullopt;\n+    auto param_value{GetQueryParameterFromUri(*uri_parsed, key)};\n+    if(uri_parsed) evhttp_uri_free(uri_parsed);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1151145374",
      "id" : 1151145374,
      "line" : 21,
      "node_id" : "PRRC_kwDOABII585EnRWe",
      "original_commit_id" : "1c278adc1af97f5140a12a5d04a6232cd9966201",
      "original_line" : 21,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/test/httpserver_tests.cpp",
      "position" : 18,
      "pull_request_review_id" : 1361896588,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1151145374/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-28T20:58:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1151145374",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> On the fuzz ./src/test/fuzz/test http_request.cpp, the issue is that the test itself is passing replySent as true, so the WriteReply() call on the httpserver constructor when the uri_parse is invalid. I'm investigating the rest of the test if we need to change anything there. Also, not sure, in which cases we need to create an instance of the HTTPRequest obj passing replySent as true, I didn't find a case in the entire code, unless as in the current fuzz we are talking about.\r\n\r\nTry to set it to `false` since we are calling `ReadBody()` to read and process the result.",
      "created_at" : "2023-03-28T21:00:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1487585480",
      "id" : 1487585480,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585YqsDI",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1487585480/reactions"
      },
      "updated_at" : "2023-03-28T21:00:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1487585480",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Try to set it to `false` since we are calling `ReadBody()` to read and process the result.\r\n\r\nI think we need to re-think this fuzz test (`http_request.cpp`), as due to the new approach we have these issues with it:\r\n- `replySent` is set to `true` from test and it will fail in WriteReply() as assert(!replySent && req);.\r\n- even we set the above to `false`, later during `GetPeer()` as the connection is null (we can see in the fuzz test checking later `assert(service.ToStringAddrPort() == \"[::]:0\");`) the assignment of GetPeer().ToStringAddr(); will result into `<incomplete type>` and it will error when throwing the runtime exception.\r\n- but even we solve the above issues going around the code, now as in the HTTPRequest constructor we are raising the runtime exception, as there's no call into `http_request_cb` (because there's no InitHTTPServer) nothing is catching the error and the test will fail unless we catch the error but then we won't be able to perform all the other checks the fuzz test does. ",
      "created_at" : "2023-03-28T22:22:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1487679446",
      "id" : 1487679446,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585YrC_W",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1487679446/reactions"
      },
      "updated_at" : "2023-03-28T22:22:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1487679446",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1152902779"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1152902779"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It is not possible to pass `nullptr` as an argument to `GetQueryParameterFromUri(const evhttp_uri& uri_parsed, const std::string& key)`. This is the point. Inside the function there is no need to worry about null pointer.\r\n\r\nThe crash occurs inside the test:\r\n\r\n```cpp\r\n    auto uri_parsed{evhttp_uri_parse(uri.data())}; // ends up nullptr\r\n    auto param_value{GetQueryParameterFromUri(*uri_parsed, key)}; // crash here, before calling GetQueryParameterFromUri().\r\n```\r\n\r\nThe function is safe, the caller has to be adjusted.",
      "commit_id" : "1c278adc1af97f5140a12a5d04a6232cd9966201",
      "created_at" : "2023-03-30T08:18:39Z",
      "diff_hunk" : "@@ -126,19 +128,19 @@ class HTTPRequest\n     void WriteReply(int nStatus, const std::string& strReply = \"\");\n };\n \n-/** Get the query parameter value from request uri for a specified key, or std::nullopt if the key\n- * is not found.\n+/** Get the query parameter value from a evhttp_uri (parsed) object for a specified key, or std::nullopt\n+ * if the key is not found or if uri_parsed argument is nullptr (most probably from a failed parsing).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1152902779",
      "id" : 1152902779,
      "in_reply_to_id" : 1149108682,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Et-Z7",
      "original_commit_id" : "0aa0626c502b70244da8dfd519612635a8e90f3b",
      "original_line" : 132,
      "original_position" : 32,
      "original_start_line" : null,
      "path" : "src/httpserver.h",
      "position" : null,
      "pull_request_review_id" : 1364578780,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1152902779/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-30T08:18:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1152902779",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1152924472"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1152924472"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I see you have adjusted the test in the latest push, I think that is the right approach. Thanks!",
      "commit_id" : "1c278adc1af97f5140a12a5d04a6232cd9966201",
      "created_at" : "2023-03-30T08:36:13Z",
      "diff_hunk" : "@@ -126,19 +128,19 @@ class HTTPRequest\n     void WriteReply(int nStatus, const std::string& strReply = \"\");\n };\n \n-/** Get the query parameter value from request uri for a specified key, or std::nullopt if the key\n- * is not found.\n+/** Get the query parameter value from a evhttp_uri (parsed) object for a specified key, or std::nullopt\n+ * if the key is not found or if uri_parsed argument is nullptr (most probably from a failed parsing).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1152924472",
      "id" : 1152924472,
      "in_reply_to_id" : 1149108682,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585EuDs4",
      "original_commit_id" : "0aa0626c502b70244da8dfd519612635a8e90f3b",
      "original_line" : 132,
      "original_position" : 32,
      "original_start_line" : null,
      "path" : "src/httpserver.h",
      "position" : null,
      "pull_request_review_id" : 1364610866,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1152924472/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-30T08:36:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1152924472",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Since the `replySent` parameter of the `HTTPRequest` constructor is used only from the tests, I would suggest to remove it and adjust the test as needed. I believe the tests should be testing the same API that is used by the real code, otherwise they may end up testing scenarios that never happen in real code and missing real code scenarios.\r\n\r\nFurthermore that `replySent = true` from the test is a hack to workaround another problem. It is actually a lie - the reply has not been sent. The problem being workedaround is that the `WriteReply()` will be called from the `HTTPRequest` destructor from the test function, after `ev*free()` functions have freed the buffers and it will crash due to use-after-free. A convenient way to call the destructor before `ev*free()` is to put it in a narrower scope:\r\n\r\n```cpp\r\n{\r\n    HTTPRequest http_request;\r\n    ...\r\n}\r\nevbuffer_free(evbuf);\r\nevhttp_request_free(evreq);\r\n```\r\n\r\nThat's cool because we need to `try/catch` nevertheless. Here is it:\r\n\r\n<details>\r\n<summary>Remove test-only parameter from HTTPRequest constructor and try/catch from the fuzz test</summary>\r\n\r\n```diff\r\ndiff --git i/src/httpserver.cpp w/src/httpserver.cpp\r\nindex 99cf147866..3e97d621ce 100644\r\n--- i/src/httpserver.cpp\r\n+++ w/src/httpserver.cpp\r\n@@ -541,17 +541,17 @@ void HTTPEvent::trigger(struct timeval* tv)\r\n {\r\n     if (tv == nullptr)\r\n         event_active(ev, 0, 0); // immediately trigger event in main thread\r\n     else\r\n         evtimer_add(ev, tv); // trigger after timeval passed\r\n }\r\n-HTTPRequest::HTTPRequest(struct evhttp_request* _req, bool _replySent) :\r\n+HTTPRequest::HTTPRequest(struct evhttp_request* _req) :\r\n         req{_req},\r\n         m_uri{evhttp_request_get_uri(req)},\r\n         m_uri_parsed{m_uri != nullptr && m_uri[0] != '\\0' ? evhttp_uri_parse(m_uri) : nullptr},\r\n-        replySent{_replySent}\r\n+        replySent{false}\r\n {\r\n     if (m_uri_parsed == nullptr) {\r\n         const char* err{\"Invalid URI\"};\r\n         const std::string peerAddress{GetPeer().ToStringAddr()};\r\n         WriteReply(HTTP_BAD_REQUEST, err);\r\n         throw std::runtime_error(\r\ndiff --git i/src/httpserver.h w/src/httpserver.h\r\nindex 00b22bdadc..56a4d89d22 100644\r\n--- i/src/httpserver.h\r\n+++ w/src/httpserver.h\r\n@@ -62,13 +62,13 @@ private:\r\n     const char* const m_uri;\r\n     /// The parsed URI, as returned by `evhttp_uri_parse()`. Will never be `nullptr`.\r\n     evhttp_uri* const m_uri_parsed;\r\n     bool replySent;\r\n \r\n public:\r\n-    explicit HTTPRequest(struct evhttp_request* req, bool replySent = false);\r\n+    explicit HTTPRequest(struct evhttp_request* req);\r\n     ~HTTPRequest();\r\n \r\n     enum RequestMethod {\r\n         UNKNOWN,\r\n         GET,\r\n         POST,\r\ndiff --git i/src/test/fuzz/http_request.cpp w/src/test/fuzz/http_request.cpp\r\nindex 9928c4a1ab..258de7c4cd 100644\r\n--- i/src/test/fuzz/http_request.cpp\r\n+++ w/src/test/fuzz/http_request.cpp\r\n@@ -44,23 +44,26 @@ FUZZ_TARGET(http_request)\r\n         evhttp_parse_firstline_(evreq, evbuf) != 1 || evhttp_parse_headers_(evreq, evbuf) != 1) {\r\n         evbuffer_free(evbuf);\r\n         evhttp_request_free(evreq);\r\n         return;\r\n     }\r\n \r\n-    HTTPRequest http_request{evreq, true};\r\n-    const HTTPRequest::RequestMethod request_method = http_request.GetRequestMethod();\r\n-    (void)RequestMethodString(request_method);\r\n-    (void)http_request.GetURI();\r\n-    (void)http_request.GetHeader(\"Host\");\r\n-    const std::string header = fuzzed_data_provider.ConsumeRandomLengthString(16);\r\n-    (void)http_request.GetHeader(header);\r\n-    (void)http_request.WriteHeader(header, fuzzed_data_provider.ConsumeRandomLengthString(16));\r\n-    (void)http_request.GetHeader(header);\r\n-    const std::string body = http_request.ReadBody();\r\n-    assert(body.empty());\r\n-    const CService service = http_request.GetPeer();\r\n-    assert(service.ToStringAddrPort() == \"[::]:0\");\r\n+    try {\r\n+        HTTPRequest http_request{evreq};\r\n+        const HTTPRequest::RequestMethod request_method = http_request.GetRequestMethod();\r\n+        (void)RequestMethodString(request_method);\r\n+        (void)http_request.GetURI();\r\n+        (void)http_request.GetHeader(\"Host\");\r\n+        const std::string header = fuzzed_data_provider.ConsumeRandomLengthString(16);\r\n+        (void)http_request.GetHeader(header);\r\n+        (void)http_request.WriteHeader(header, fuzzed_data_provider.ConsumeRandomLengthString(16));\r\n+        (void)http_request.GetHeader(header);\r\n+        const std::string body = http_request.ReadBody();\r\n+        assert(body.empty());\r\n+        const CService service = http_request.GetPeer();\r\n+        assert(service.ToStringAddrPort() == \"[::]:0\");\r\n+    } catch (const std::runtime_error&) {\r\n+    }\r\n \r\n     evbuffer_free(evbuf);\r\n     evhttp_request_free(evreq);\r\n }\r\n```\r\n</details>\r\n\r\n> ... but then we won't be able to perform all the other checks the fuzz test does.\r\n\r\nI think that is fine because if the input is such that `HTTPRequest` constructor throws, then we need not to test those because they will never happen in the real code either.",
      "created_at" : "2023-03-30T09:50:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1490015098",
      "id" : 1490015098,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585Yz9N6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1490015098/reactions"
      },
      "updated_at" : "2023-03-30T09:54:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1490015098",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I think that is fine because if the input is such that `HTTPRequest` constructor throws, then we need not to test those because they will never happen in the real code either.\r\n\r\nThanks @vasild, it makes sense what you are saying, I'm still playing with some options and will get back to you soon.\r\n```\r\n$ FUZZ=http_request ./src/test/fuzz/fuzz ../qa-assets/fuzz_seed_corpus/http_request/75d231d5e022cc38377bbbf4549058d37b7c59a3\r\nINFO: Seed: 2298450543\r\nINFO: Loaded 1 modules   (250057 inline 8-bit counters): 250057 [0x565010b53868, 0x565010b90931), \r\nINFO: Loaded 1 PC tables (250057 PCs): 250057 [0x565010b90938,0x565010f615c8), \r\n./src/test/fuzz/fuzz: Running 1 inputs 1 time(s) each.\r\nRunning: ../qa-assets/fuzz_seed_corpus/http_request/75d231d5e022cc38377bbbf4549058d37b7c59a3\r\nExecuted ../qa-assets/fuzz_seed_corpus/http_request/75d231d5e022cc38377bbbf4549058d37b7c59a3 in 2 ms\r\n***\r\n*** NOTE: fuzzing was not performed, you have only\r\n***       executed the target code on a fixed set of inputs.\r\n***\r\n\r\n```",
      "created_at" : "2023-03-30T16:55:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1490626840",
      "id" : 1490626840,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585Y2SkY",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1490626840/reactions"
      },
      "updated_at" : "2023-03-30T19:14:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1490626840",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated changes:\r\n- Fixed fuzz test failing.\r\n\r\n\r\n> Since the replySent parameter of the HTTPRequest constructor is used only from the tests, I would suggest to remove it and adjust the test as needed.\r\n\r\n@vasild I left open the possibility of passing the `replySent` arg as `true`, this way we can \"build\" a \"safer\" \"invalid\" request as @stickies-v mentioned above, so we can test the almost entire protocol of `HTTPRequest` if that was originally the intention of this fuzz.\r\nThen, as part of the above, if `replySent` is passed as `true`, the constructor won't call the `libevent` functions in there but as `m_uri_parsed` is null (in a real use case we won't see this as the exception will be thrown), we need to guard the free of `m_uri_parsed` at the `httpserver` destructor otherwise produces a segfault.\r\n\r\nI've checked another option that would be to create a mock `HTTPRequest` but I had to create another constructor to avoid calling the default and I preferred not to touch the `HTTPRequest` class. I think leaving the `replySent` arg to be optionally passed on the constructor and the fuzz test behaviour as the original commit would be ok for now unless there are other objections.",
      "created_at" : "2023-03-31T05:39:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1491325361",
      "id" : 1491325361,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585Y49Gx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1491325361/reactions"
      },
      "updated_at" : "2023-03-31T06:11:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1491325361",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1160843481"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1160843481"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Remove this unrelated whitespace change.",
      "commit_id" : "4f68c30b2d52f39c7c7465d49ba41c2e70f486ba",
      "created_at" : "2023-04-07T17:16:11Z",
      "diff_hunk" : "@@ -563,8 +588,7 @@ std::pair<bool, std::string> HTTPRequest::GetHeader(const std::string& hdr) cons\n std::string HTTPRequest::ReadBody()\n {\n     struct evbuffer* buf = evhttp_request_get_input_buffer(req);\n-    if (!buf)\n-        return \"\";\n+    if (!buf) return \"\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1160843481",
      "id" : 1160843481,
      "line" : 591,
      "node_id" : "PRRC_kwDOABII585FMRDZ",
      "original_commit_id" : "4f68c30b2d52f39c7c7465d49ba41c2e70f486ba",
      "original_line" : 591,
      "original_position" : 82,
      "original_start_line" : 566,
      "path" : "src/httpserver.cpp",
      "position" : 82,
      "pull_request_review_id" : 1376409023,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1160843481/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 566,
      "start_side" : "LEFT",
      "subject_type" : "line",
      "updated_at" : "2023-04-07T17:24:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1160843481",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1160845066"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1160845066"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This will always be `true` because if `uri_parsed` is `nullptr` we would have returned 2 lines above.",
      "commit_id" : "4f68c30b2d52f39c7c7465d49ba41c2e70f486ba",
      "created_at" : "2023-04-07T17:19:22Z",
      "diff_hunk" : "@@ -5,34 +5,55 @@\n #include <httpserver.h>\n #include <test/util/setup_common.h>\n \n+#include <event2/http.h>\n+\n+#include <string>\n+#include <string_view>\n+\n #include <boost/test/unit_test.hpp>\n \n BOOST_FIXTURE_TEST_SUITE(httpserver_tests, BasicTestingSetup)\n \n-BOOST_AUTO_TEST_CASE(test_query_parameters)\n+std::optional<std::string> GetParameterFromURI(const std::string_view uri, const std::string& key){\n+    auto uri_parsed{evhttp_uri_parse(uri.data())};\n+    if (uri_parsed == nullptr) return std::nullopt;\n+    auto param_value{GetQueryParameterFromUri(*uri_parsed, key)};\n+    if (uri_parsed) evhttp_uri_free(uri_parsed);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1160845066",
      "id" : 1160845066,
      "line" : 21,
      "node_id" : "PRRC_kwDOABII585FMRcK",
      "original_commit_id" : "4f68c30b2d52f39c7c7465d49ba41c2e70f486ba",
      "original_line" : 21,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/test/httpserver_tests.cpp",
      "position" : 18,
      "pull_request_review_id" : 1376409023,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1160845066/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-07T17:24:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1160845066",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1161726047"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1161726047"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "yes, that was something I touched while I was verifying the `req` class member.",
      "commit_id" : "4f68c30b2d52f39c7c7465d49ba41c2e70f486ba",
      "created_at" : "2023-04-10T13:36:07Z",
      "diff_hunk" : "@@ -563,8 +588,7 @@ std::pair<bool, std::string> HTTPRequest::GetHeader(const std::string& hdr) cons\n std::string HTTPRequest::ReadBody()\n {\n     struct evbuffer* buf = evhttp_request_get_input_buffer(req);\n-    if (!buf)\n-        return \"\";\n+    if (!buf) return \"\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1161726047",
      "id" : 1161726047,
      "in_reply_to_id" : 1160843481,
      "line" : 591,
      "node_id" : "PRRC_kwDOABII585FPohf",
      "original_commit_id" : "4f68c30b2d52f39c7c7465d49ba41c2e70f486ba",
      "original_line" : 591,
      "original_position" : 82,
      "original_start_line" : 566,
      "path" : "src/httpserver.cpp",
      "position" : 82,
      "pull_request_review_id" : 1377542888,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1161726047/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 566,
      "start_side" : "LEFT",
      "subject_type" : "line",
      "updated_at" : "2023-04-10T13:36:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1161726047",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1161727508"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1161727508"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I'll change it. Thanks.",
      "commit_id" : "4f68c30b2d52f39c7c7465d49ba41c2e70f486ba",
      "created_at" : "2023-04-10T13:38:04Z",
      "diff_hunk" : "@@ -5,34 +5,55 @@\n #include <httpserver.h>\n #include <test/util/setup_common.h>\n \n+#include <event2/http.h>\n+\n+#include <string>\n+#include <string_view>\n+\n #include <boost/test/unit_test.hpp>\n \n BOOST_FIXTURE_TEST_SUITE(httpserver_tests, BasicTestingSetup)\n \n-BOOST_AUTO_TEST_CASE(test_query_parameters)\n+std::optional<std::string> GetParameterFromURI(const std::string_view uri, const std::string& key){\n+    auto uri_parsed{evhttp_uri_parse(uri.data())};\n+    if (uri_parsed == nullptr) return std::nullopt;\n+    auto param_value{GetQueryParameterFromUri(*uri_parsed, key)};\n+    if (uri_parsed) evhttp_uri_free(uri_parsed);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1161727508",
      "id" : 1161727508,
      "in_reply_to_id" : 1160845066,
      "line" : 21,
      "node_id" : "PRRC_kwDOABII585FPo4U",
      "original_commit_id" : "4f68c30b2d52f39c7c7465d49ba41c2e70f486ba",
      "original_line" : 21,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/test/httpserver_tests.cpp",
      "position" : 18,
      "pull_request_review_id" : 1377545146,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1161727508/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-10T13:38:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1161727508",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Would be nice to split the actual fix from the other changes. I guess it would be easier for other reviewers too.\r\n\r\nI'm working on it.\r\n\r\n> I would have liked to remove the `replySent` argument, but that's secondary to this PR which fixes a serious bug. Let's get the bug fixed and if I feel strong enough about it, then maybe I will open a followup to remove that parameter.\r\n\r\nI agree, later on a follow-up, I'd try to investigate if `evhttp_request* req` can be mocked somehow so the fuzz can go thru all the buffering behaviour and other stuff once the `replySent` argument is removed.",
      "created_at" : "2023-04-11T10:29:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1503076466",
      "id" : 1503076466,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585ZlyBy",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1503076466/reactions"
      },
      "updated_at" : "2023-04-11T10:29:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1503076466",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I'd try to investigate if `evhttp_request* req` can be mocked somehow so the fuzz can go thru all the buffering behaviour and other stuff once the replySent argument is removed.\r\n\r\nThe fuzz _will_ go through this:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/53eb4b7a212db7563291509ff4e53327440a9df2/src/test/fuzz/http_request.cpp#L51-L62\r\n\r\nif the `HTTPRequest` object is created successfully (once `replySent` is removed and the test does `try/catch`). If the input is such that `HTTPRequest:HTTPRequest()` throws, then it does not have to test the above because it will never be executed in the real code.",
      "created_at" : "2023-04-11T12:42:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1503257503",
      "id" : 1503257503,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585ZmeOf",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1503257503/reactions"
      },
      "updated_at" : "2023-04-11T12:42:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1503257503",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> if the `HTTPRequest` object is created successfully (once `replySent` is removed and the test does `try/catch`). If the input is such that `HTTPRequest:HTTPRequest()` throws, then it does not have to test the above because it will never be executed in the real code.\r\n\r\nI'm sorry, I said nonsense, ofc that code won't be executed because the `uri_parsed` will be null and so on, my concern is that we'll lose the test coverage by the current `fuzz`, even it's not a real case scenario, the test is performing 'exhaustive' calls to specific protocol (not sure how 'exhaustive' because, on the other hand, the internal buffer in the `HTTPRequest` instance is empty while testing).",
      "created_at" : "2023-04-12T13:07:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1505248502",
      "id" : 1505248502,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585ZuET2",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1505248502/reactions"
      },
      "updated_at" : "2023-04-12T13:08:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1505248502",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated changes:\r\n- Split commit in 2 (as suggested by @stickies-v and @vasild): one for the fix and one for the logic improvement.\r\n- Added some comments to each commit (as suggested by @stickies-v).",
      "created_at" : "2023-04-14T01:30:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1507805195",
      "id" : 1507805195,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585Z30gL",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1507805195/reactions"
      },
      "updated_at" : "2023-04-14T13:23:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1507805195",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1166625610"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1166625610"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`uri` is unhandled user input so including that in the error seems dangerous to me, would just change it to\r\n\r\n```cpp\r\n        throw std::runtime_error(\"URI parsing failed, it likely contained RFC 3986 invalid characters);\r\n```",
      "commit_id" : "9b9c48cf81549c7eacfbfb78534b7eaba46ecb34",
      "created_at" : "2023-04-14T09:59:40Z",
      "diff_hunk" : "@@ -667,12 +667,21 @@ std::optional<std::string> HTTPRequest::GetQueryParameter(const std::string& key\n {\n     const char* uri{evhttp_request_get_uri(req)};\n \n-    return GetQueryParameterFromUri(uri, key);\n+    try {\n+        return GetQueryParameterFromUri(uri, key);\n+    } catch (const std::runtime_error& e) {\n+        LogPrint(BCLog::HTTP, \"%s\\n\", e.what());\n+        // add additional information and rethrow the exception as we can't send a reply from the worker\n+        throw std::runtime_error(strprintf(\"Error occurred trying to get query param key \\\"%s\\\": \", key) + e.what());\n+    }\n }\n \n std::optional<std::string> GetQueryParameterFromUri(const char* uri, const std::string& key)\n {\n     evhttp_uri* uri_parsed{evhttp_uri_parse(uri)};\n+    if (!uri_parsed) {\n+        throw std::runtime_error(strprintf(\"Invalid uri detected while parsing \\\"%s\\\"\", uri));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1166625610",
      "id" : 1166625610,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585FiUtK",
      "original_commit_id" : "0f9cba3f0745e3b5787e66b2bbe03e328e67b081",
      "original_line" : 683,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 1385130381,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1166625610/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-14T16:41:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1166625610",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1167041616"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167041616"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "What's the benefit of re-handling this error? The error message from `GetQueryParameterFromUri` is enough (or could be updated there to reference query param fetching, but it doesn't really have anything to do with the URI being invalid, so I'd prefer leaving it out). \r\n\r\n<details>\r\n<summary>git diff</summary>\r\n\r\n```diff\r\ndiff --git a/src/httpserver.cpp b/src/httpserver.cpp\r\nindex eb1f0bd93..3f0d82497 100644\r\n--- a/src/httpserver.cpp\r\n+++ b/src/httpserver.cpp\r\n@@ -667,13 +667,7 @@ std::optional<std::string> HTTPRequest::GetQueryParameter(const std::string& key\r\n {\r\n     const char* uri{evhttp_request_get_uri(req)};\r\n \r\n-    try {\r\n-        return GetQueryParameterFromUri(uri, key);\r\n-    } catch (const std::runtime_error& e) {\r\n-        LogPrint(BCLog::HTTP, \"%s\\n\", e.what());\r\n-        // add additional information and rethrow the exception as we can't send a reply from the worker\r\n-        throw std::runtime_error(strprintf(\"Error occurred trying to get query param key \\\"%s\\\": \", key) + e.what());\r\n-    }\r\n+    return GetQueryParameterFromUri(uri, key);\r\n }\r\n \r\n std::optional<std::string> GetQueryParameterFromUri(const char* uri, const std::string& key)\r\ndiff --git a/test/functional/interface_rest.py b/test/functional/interface_rest.py\r\nindex fa6193039..fb647a62f 100755\r\n--- a/test/functional/interface_rest.py\r\n+++ b/test/functional/interface_rest.py\r\n@@ -282,7 +282,7 @@ class RESTTest (BitcoinTestFramework):\r\n \r\n         # Check invalid uri (% symbol at the end of the request)\r\n         resp = self.test_rest_request(f\"/headers/{bb_hash}%\", ret_type=RetType.OBJ, status=400)\r\n-        assert_equal(resp.read().decode('utf-8').rstrip(), f\"Error occurred trying to get query param key \\\"count\\\": Invalid uri detected while parsing \\\"/rest/headers/{bb_hash}%.json\\\"\")\r\n+        assert_equal(resp.read().decode('utf-8').rstrip(), f\"Invalid uri detected while parsing \\\"/rest/headers/{bb_hash}%.json\\\"\")\r\n \r\n         # Compare with normal RPC block response\r\n         rpc_block_json = self.nodes[0].getblock(bb_hash)\r\n\r\n```\r\n</details>",
      "commit_id" : "9b9c48cf81549c7eacfbfb78534b7eaba46ecb34",
      "created_at" : "2023-04-14T16:19:34Z",
      "diff_hunk" : "@@ -667,12 +667,21 @@ std::optional<std::string> HTTPRequest::GetQueryParameter(const std::string& key\n {\n     const char* uri{evhttp_request_get_uri(req)};\n \n-    return GetQueryParameterFromUri(uri, key);\n+    try {\n+        return GetQueryParameterFromUri(uri, key);\n+    } catch (const std::runtime_error& e) {\n+        LogPrint(BCLog::HTTP, \"%s\\n\", e.what());\n+        // add additional information and rethrow the exception as we can't send a reply from the worker\n+        throw std::runtime_error(strprintf(\"Error occurred trying to get query param key \\\"%s\\\": \", key) + e.what());\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1167041616",
      "id" : 1167041616,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Fj6RQ",
      "original_commit_id" : "0f9cba3f0745e3b5787e66b2bbe03e328e67b081",
      "original_line" : 676,
      "original_position" : 11,
      "original_start_line" : 670,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 1385130381,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167041616/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-04-14T16:41:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167041616",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1167045700"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167045700"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I'd rephrase to the below - any invalid character in the URI will trigger this, not just in the query string.\r\n\r\n```\r\n    // URI with invalid characters (%) raises a runtime error regardless of which query parameter is queried\r\n```",
      "commit_id" : "9b9c48cf81549c7eacfbfb78534b7eaba46ecb34",
      "created_at" : "2023-04-14T16:23:37Z",
      "diff_hunk" : "@@ -34,5 +34,9 @@ BOOST_AUTO_TEST_CASE(test_query_parameters)\n     // Invalid query string syntax is the same as not having parameters\n     uri = \"/rest/endpoint/someresource.json&p1=v1&p2=v2\";\n     BOOST_CHECK(!GetQueryParameterFromUri(uri.c_str(), \"p1\").has_value());\n+\n+    // Invalid query string with invalid will raise a runtime error no matter how many parameters passed or their syntax",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1167045700",
      "id" : 1167045700,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Fj7RE",
      "original_commit_id" : "0f9cba3f0745e3b5787e66b2bbe03e328e67b081",
      "original_line" : 38,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/test/httpserver_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 1385130381,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167045700/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-14T16:41:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167045700",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1167076574"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167076574"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Or use `SanitizeString(uri)`.",
      "commit_id" : "9b9c48cf81549c7eacfbfb78534b7eaba46ecb34",
      "created_at" : "2023-04-14T16:54:51Z",
      "diff_hunk" : "@@ -667,12 +667,21 @@ std::optional<std::string> HTTPRequest::GetQueryParameter(const std::string& key\n {\n     const char* uri{evhttp_request_get_uri(req)};\n \n-    return GetQueryParameterFromUri(uri, key);\n+    try {\n+        return GetQueryParameterFromUri(uri, key);\n+    } catch (const std::runtime_error& e) {\n+        LogPrint(BCLog::HTTP, \"%s\\n\", e.what());\n+        // add additional information and rethrow the exception as we can't send a reply from the worker\n+        throw std::runtime_error(strprintf(\"Error occurred trying to get query param key \\\"%s\\\": \", key) + e.what());\n+    }\n }\n \n std::optional<std::string> GetQueryParameterFromUri(const char* uri, const std::string& key)\n {\n     evhttp_uri* uri_parsed{evhttp_uri_parse(uri)};\n+    if (!uri_parsed) {\n+        throw std::runtime_error(strprintf(\"Invalid uri detected while parsing \\\"%s\\\"\", uri));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1167076574",
      "id" : 1167076574,
      "in_reply_to_id" : 1166625610,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585FkCze",
      "original_commit_id" : "0f9cba3f0745e3b5787e66b2bbe03e328e67b081",
      "original_line" : 683,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 1385824656,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167076574/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-14T16:54:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167076574",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1167081733"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167081733"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "That wouldn't prevent someone from passing really long URIs, causing e.g. bloated logs. We're already (debug) logging the full URI in `http_request_cb`. Adding it here introduces risks and little value imo.",
      "commit_id" : "9b9c48cf81549c7eacfbfb78534b7eaba46ecb34",
      "created_at" : "2023-04-14T16:58:32Z",
      "diff_hunk" : "@@ -667,12 +667,21 @@ std::optional<std::string> HTTPRequest::GetQueryParameter(const std::string& key\n {\n     const char* uri{evhttp_request_get_uri(req)};\n \n-    return GetQueryParameterFromUri(uri, key);\n+    try {\n+        return GetQueryParameterFromUri(uri, key);\n+    } catch (const std::runtime_error& e) {\n+        LogPrint(BCLog::HTTP, \"%s\\n\", e.what());\n+        // add additional information and rethrow the exception as we can't send a reply from the worker\n+        throw std::runtime_error(strprintf(\"Error occurred trying to get query param key \\\"%s\\\": \", key) + e.what());\n+    }\n }\n \n std::optional<std::string> GetQueryParameterFromUri(const char* uri, const std::string& key)\n {\n     evhttp_uri* uri_parsed{evhttp_uri_parse(uri)};\n+    if (!uri_parsed) {\n+        throw std::runtime_error(strprintf(\"Invalid uri detected while parsing \\\"%s\\\"\", uri));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1167081733",
      "id" : 1167081733,
      "in_reply_to_id" : 1166625610,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585FkEEF",
      "original_commit_id" : "0f9cba3f0745e3b5787e66b2bbe03e328e67b081",
      "original_line" : 683,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 1385839394,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167081733/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-14T16:58:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167081733",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1167115865"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167115865"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah, it's a clearer message. Thanks.",
      "commit_id" : "9b9c48cf81549c7eacfbfb78534b7eaba46ecb34",
      "created_at" : "2023-04-14T17:33:05Z",
      "diff_hunk" : "@@ -667,12 +667,21 @@ std::optional<std::string> HTTPRequest::GetQueryParameter(const std::string& key\n {\n     const char* uri{evhttp_request_get_uri(req)};\n \n-    return GetQueryParameterFromUri(uri, key);\n+    try {\n+        return GetQueryParameterFromUri(uri, key);\n+    } catch (const std::runtime_error& e) {\n+        LogPrint(BCLog::HTTP, \"%s\\n\", e.what());\n+        // add additional information and rethrow the exception as we can't send a reply from the worker\n+        throw std::runtime_error(strprintf(\"Error occurred trying to get query param key \\\"%s\\\": \", key) + e.what());\n+    }\n }\n \n std::optional<std::string> GetQueryParameterFromUri(const char* uri, const std::string& key)\n {\n     evhttp_uri* uri_parsed{evhttp_uri_parse(uri)};\n+    if (!uri_parsed) {\n+        throw std::runtime_error(strprintf(\"Invalid uri detected while parsing \\\"%s\\\"\", uri));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1167115865",
      "id" : 1167115865,
      "in_reply_to_id" : 1166625610,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585FkMZZ",
      "original_commit_id" : "0f9cba3f0745e3b5787e66b2bbe03e328e67b081",
      "original_line" : 683,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 1385904205,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167115865/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-14T17:33:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167115865",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Left some comments on the bugfix commit. I'd carve that out in a separate PR to get it merged for v25.\r\n\r\nI'll create a new PR linked to this.\r\n \r\n> Also, suggested rephrasing for the commit message:\r\n\r\nSure, I'll take your suggestion, thanks.",
      "created_at" : "2023-04-14T17:34:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1509002838",
      "id" : 1509002838,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585Z8Y5W",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1509002838/reactions"
      },
      "updated_at" : "2023-04-14T17:34:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1509002838",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I agree with suggestions from @stickies-v, would be happy to re-review.\r\n\r\nI'll let you both know ones the new PR is ready, very soon. Thanks.",
      "created_at" : "2023-04-14T17:35:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1509003472",
      "id" : 1509003472,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585Z8ZDQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1509003472/reactions"
      },
      "updated_at" : "2023-04-14T17:35:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1509003472",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1167123408"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167123408"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah, the intention was to add the param key on top of the previous error, adding more details at this level but that info is also available from the caller of `GetQueryParameterFromUri`. Ok, I'll leave it out.",
      "commit_id" : "9b9c48cf81549c7eacfbfb78534b7eaba46ecb34",
      "created_at" : "2023-04-14T17:42:40Z",
      "diff_hunk" : "@@ -667,12 +667,21 @@ std::optional<std::string> HTTPRequest::GetQueryParameter(const std::string& key\n {\n     const char* uri{evhttp_request_get_uri(req)};\n \n-    return GetQueryParameterFromUri(uri, key);\n+    try {\n+        return GetQueryParameterFromUri(uri, key);\n+    } catch (const std::runtime_error& e) {\n+        LogPrint(BCLog::HTTP, \"%s\\n\", e.what());\n+        // add additional information and rethrow the exception as we can't send a reply from the worker\n+        throw std::runtime_error(strprintf(\"Error occurred trying to get query param key \\\"%s\\\": \", key) + e.what());\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1167123408",
      "id" : 1167123408,
      "in_reply_to_id" : 1167041616,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585FkOPQ",
      "original_commit_id" : "0f9cba3f0745e3b5787e66b2bbe03e328e67b081",
      "original_line" : 676,
      "original_position" : 11,
      "original_start_line" : 670,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 1385915335,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167123408/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-04-14T17:42:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167123408",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated changes:\r\n- Created new PR #27468 with a minimal bugfix and single commit in order to merge it faster for 25.0 release, as suggested above by [@stickies-v](https://github.com/bitcoin/bitcoin/pull/27253#pullrequestreview-1385130381) and supported by [@vasild](https://github.com/bitcoin/bitcoin/pull/27253#pullrequestreview-1385842606).\r\n- The new PR contains also the suggested changes from @stickies-v.\r\n- I'll create another PR for the 2nd commit as a follow-up.",
      "created_at" : "2023-04-14T23:52:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1509401910",
      "id" : 1509401910,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585Z96U2",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1509401910/reactions"
      },
      "updated_at" : "2023-04-14T23:56:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1509401910",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-04-17T15:01:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1511536909",
      "id" : 1511536909,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585aGDkN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1511536909/reactions"
      },
      "updated_at" : "2023-04-17T15:01:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1511536909",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated changes:\r\n- First commit of this PR was already merged into 25.0 release branch (#27468).\r\n- Rebased & incorporated some nits & suggestions from latest reviews including above PR.\r\n- Updated original description of this PR.",
      "created_at" : "2023-04-23T13:59:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1519074456",
      "id" : 1519074456,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585aizyY",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1519074456/reactions"
      },
      "updated_at" : "2023-04-23T14:07:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1519074456",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Fuzzing segfaults, see CI",
      "created_at" : "2023-04-24T08:42:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1519637810",
      "id" : 1519637810,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585ak9Uy",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1519637810/reactions"
      },
      "updated_at" : "2023-04-24T08:42:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1519637810",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Fuzzing segfaults, see CI\r\n\r\nSaw it yesterday, working on it, thanks.",
      "created_at" : "2023-04-24T10:30:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1519869383",
      "id" : 1519869383,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585al13H",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1519869383/reactions"
      },
      "updated_at" : "2023-04-24T10:30:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1519869383",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "- Fixed`http_request`fuzz failure and added some relevant comments in the code.",
      "created_at" : "2023-04-29T07:33:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1528701927",
      "id" : 1528701927,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585bHiPn",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1528701927/reactions"
      },
      "updated_at" : "2023-04-29T07:33:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1528701927",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "- Updated 2nd commit message.",
      "created_at" : "2023-04-29T11:08:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1528760293",
      "id" : 1528760293,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585bHwfl",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1528760293/reactions"
      },
      "updated_at" : "2023-04-29T11:08:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1528760293",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "With #27468 merged, I don't really see the need for 8ef940d39bfa7bc4ba867b70495b68c507297694 anymore? Also the PR title and description need updating, this is not a bugfix PR anymore.",
      "created_at" : "2023-05-11T11:32:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1543830285",
      "id" : 1543830285,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585cBPsN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1543830285/reactions"
      },
      "updated_at" : "2023-05-11T11:32:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1543830285",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> With #27468 merged, I don't really see the need for [8ef940d](https://github.com/bitcoin/bitcoin/commit/8ef940d39bfa7bc4ba867b70495b68c507297694) anymore? Also the PR title and description need updating, this is not a bugfix PR anymore.\r\n\r\nUpdated them, thanks!",
      "created_at" : "2023-05-11T12:47:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1543937304",
      "id" : 1543937304,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585cBp0Y",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1543937304/reactions"
      },
      "updated_at" : "2023-05-11T12:47:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1543937304",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1196635667"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1196635667"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Since docs guarantee that GetURI() returns non-nullptr, would add an Assert here\r\n\r\n```suggestion\r\n    return Assert(m_uri);\r\n```",
      "commit_id" : "901b5f2d905606306df588f4f4eea408e8be9cba",
      "created_at" : "2023-05-17T14:44:22Z",
      "diff_hunk" : "@@ -643,9 +669,9 @@ CService HTTPRequest::GetPeer() const\n     return peer;\n }\n \n-std::string HTTPRequest::GetURI() const\n+const char* HTTPRequest::GetURI() const\n {\n-    return evhttp_request_get_uri(req);\n+    return m_uri;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1196635667",
      "id" : 1196635667,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585HUzYT",
      "original_commit_id" : "c72967f48ab9eb02b8dc9231fdcc6ee85d66b7b9",
      "original_line" : 674,
      "original_position" : 85,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 1430879440,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1196635667/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-18T17:43:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1196635667",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1197667936"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197667936"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: clearer language\r\n```suggestion\r\n    /** Get requested URI. Will never return nullptr.\r\n```",
      "commit_id" : "901b5f2d905606306df588f4f4eea408e8be9cba",
      "created_at" : "2023-05-18T10:39:47Z",
      "diff_hunk" : "@@ -71,9 +77,9 @@ class HTTPRequest\n         PUT\n     };\n \n-    /** Get requested URI.\n+    /** Get requested URI. Will always return non-nullptr.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1197667936",
      "id" : 1197667936,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585HYvZg",
      "original_commit_id" : "c72967f48ab9eb02b8dc9231fdcc6ee85d66b7b9",
      "original_line" : 80,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/httpserver.h",
      "position" : null,
      "pull_request_review_id" : 1430879440,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197667936/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-18T17:43:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197667936",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1197670181"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197670181"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The two `req->GetQueryParameter` calls in `rest_mempool` need to be updated as well.",
      "commit_id" : "c72967f48ab9eb02b8dc9231fdcc6ee85d66b7b9",
      "created_at" : "2023-05-18T10:42:28Z",
      "diff_hunk" : "",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1197670181",
      "id" : 1197670181,
      "line" : 1,
      "node_id" : "PRRC_kwDOABII585HYv8l",
      "original_commit_id" : "c72967f48ab9eb02b8dc9231fdcc6ee85d66b7b9",
      "original_line" : 1,
      "original_position" : 1,
      "original_start_line" : null,
      "path" : "src/rest.cpp",
      "position" : 1,
      "pull_request_review_id" : 1430879440,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197670181/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "file",
      "updated_at" : "2023-05-18T17:43:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197670181",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1197688711"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197688711"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Is there a reason we need to check for `m_uri` not being empty (`&& m_uri[0] != '\\0'`)? Doesn't seem to be a documented requirement for `evhttp_uri_parse`.",
      "commit_id" : "901b5f2d905606306df588f4f4eea408e8be9cba",
      "created_at" : "2023-05-18T11:05:01Z",
      "diff_hunk" : "@@ -536,18 +544,36 @@ void HTTPEvent::trigger(struct timeval* tv)\n     else\n         evtimer_add(ev, tv); // trigger after timeval passed\n }\n-HTTPRequest::HTTPRequest(struct evhttp_request* _req, bool _replySent) : req(_req), replySent(_replySent)\n+HTTPRequest::HTTPRequest(struct evhttp_request* _req, bool _replySent) :\n+        req{_req},\n+        m_uri{req != nullptr ? evhttp_request_get_uri(req) : nullptr},\n+        m_uri_parsed{m_uri != nullptr && m_uri[0] != '\\0' ? evhttp_uri_parse(m_uri) : nullptr},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1197688711",
      "id" : 1197688711,
      "line" : 550,
      "node_id" : "PRRC_kwDOABII585HY0eH",
      "original_commit_id" : "c72967f48ab9eb02b8dc9231fdcc6ee85d66b7b9",
      "original_line" : 550,
      "original_position" : 46,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : 46,
      "pull_request_review_id" : 1430879440,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197688711/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-18T17:43:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197688711",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1197694855"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197694855"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "What's the rationale for this change? No callsite seems to be preferring a C-style string, and returning a `std::string` would also make the non-nullptr promise explicit.",
      "commit_id" : "901b5f2d905606306df588f4f4eea408e8be9cba",
      "created_at" : "2023-05-18T11:12:02Z",
      "diff_hunk" : "@@ -71,9 +77,9 @@ class HTTPRequest\n         PUT\n     };\n \n-    /** Get requested URI.\n+    /** Get requested URI. Will always return non-nullptr.\n      */\n-    std::string GetURI() const;\n+    const char* GetURI() const;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1197694855",
      "id" : 1197694855,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585HY1-H",
      "original_commit_id" : "c72967f48ab9eb02b8dc9231fdcc6ee85d66b7b9",
      "original_line" : 82,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/httpserver.h",
      "position" : null,
      "pull_request_review_id" : 1430879440,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197694855/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-18T17:43:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1197694855",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1208014798"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1208014798"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I can't remember tbh, try to find it in the history with no success, not sure if I did it due to matching the consumers(?) or @vasild suggested it at some point...",
      "commit_id" : "901b5f2d905606306df588f4f4eea408e8be9cba",
      "created_at" : "2023-05-27T14:25:33Z",
      "diff_hunk" : "@@ -71,9 +77,9 @@ class HTTPRequest\n         PUT\n     };\n \n-    /** Get requested URI.\n+    /** Get requested URI. Will always return non-nullptr.\n      */\n-    std::string GetURI() const;\n+    const char* GetURI() const;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1208014798",
      "id" : 1208014798,
      "in_reply_to_id" : 1197694855,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585IANfO",
      "original_commit_id" : "c72967f48ab9eb02b8dc9231fdcc6ee85d66b7b9",
      "original_line" : 82,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/httpserver.h",
      "position" : null,
      "pull_request_review_id" : 1447409678,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1208014798/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-27T14:25:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1208014798",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1208014857"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1208014857"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Well, I think that an empty string wouldn't be a valid URI, at least the `scheme component` (the first part of it which is followed by a \":\", which is again followed by the `hier-part` component (which may be empty) must be present according to the [RFC](https://www.rfc-editor.org/rfc/rfc3986#section-3). I thought it was perhaps validated inside the `evhttp_uri_parse` but I couldn't find it [there](https://github.com/libevent/libevent/blob/bca26524fc4cd7a9e79d210c1079baaa7d29835d/http.c#L4464-L4469). I'm happy to remove it if you think it's not worth it.",
      "commit_id" : "901b5f2d905606306df588f4f4eea408e8be9cba",
      "created_at" : "2023-05-27T14:25:44Z",
      "diff_hunk" : "@@ -536,18 +544,36 @@ void HTTPEvent::trigger(struct timeval* tv)\n     else\n         evtimer_add(ev, tv); // trigger after timeval passed\n }\n-HTTPRequest::HTTPRequest(struct evhttp_request* _req, bool _replySent) : req(_req), replySent(_replySent)\n+HTTPRequest::HTTPRequest(struct evhttp_request* _req, bool _replySent) :\n+        req{_req},\n+        m_uri{req != nullptr ? evhttp_request_get_uri(req) : nullptr},\n+        m_uri_parsed{m_uri != nullptr && m_uri[0] != '\\0' ? evhttp_uri_parse(m_uri) : nullptr},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1208014857",
      "id" : 1208014857,
      "in_reply_to_id" : 1197688711,
      "line" : 550,
      "node_id" : "PRRC_kwDOABII585IANgJ",
      "original_commit_id" : "c72967f48ab9eb02b8dc9231fdcc6ee85d66b7b9",
      "original_line" : 550,
      "original_position" : 46,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : 46,
      "pull_request_review_id" : 1447409694,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1208014857/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-27T14:25:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1208014857",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1208015048"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1208015048"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah missed them, done now, thanks!",
      "commit_id" : "c72967f48ab9eb02b8dc9231fdcc6ee85d66b7b9",
      "created_at" : "2023-05-27T14:26:02Z",
      "diff_hunk" : "",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1208015048",
      "id" : 1208015048,
      "in_reply_to_id" : 1197670181,
      "line" : 1,
      "node_id" : "PRRC_kwDOABII585IANjI",
      "original_commit_id" : "c72967f48ab9eb02b8dc9231fdcc6ee85d66b7b9",
      "original_line" : 1,
      "original_position" : 1,
      "original_start_line" : null,
      "path" : "src/rest.cpp",
      "position" : 1,
      "pull_request_review_id" : 1447409864,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1208015048/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "file",
      "updated_at" : "2023-05-27T14:26:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1208015048",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1208015177"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1208015177"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah and also it'll be more consistent with the comments above in the private declaration section.\r\nhttps://github.com/bitcoin/bitcoin/blob/c72967f48ab9eb02b8dc9231fdcc6ee85d66b7b9/src/httpserver.h#L60-L63",
      "commit_id" : "901b5f2d905606306df588f4f4eea408e8be9cba",
      "created_at" : "2023-05-27T14:26:16Z",
      "diff_hunk" : "@@ -71,9 +77,9 @@ class HTTPRequest\n         PUT\n     };\n \n-    /** Get requested URI.\n+    /** Get requested URI. Will always return non-nullptr.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1208015177",
      "id" : 1208015177,
      "in_reply_to_id" : 1197667936,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585IANlJ",
      "original_commit_id" : "c72967f48ab9eb02b8dc9231fdcc6ee85d66b7b9",
      "original_line" : 80,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/httpserver.h",
      "position" : null,
      "pull_request_review_id" : 1447409889,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1208015177/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-27T14:26:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1208015177",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1208015277"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1208015277"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok, done.",
      "commit_id" : "901b5f2d905606306df588f4f4eea408e8be9cba",
      "created_at" : "2023-05-27T14:26:33Z",
      "diff_hunk" : "@@ -643,9 +669,9 @@ CService HTTPRequest::GetPeer() const\n     return peer;\n }\n \n-std::string HTTPRequest::GetURI() const\n+const char* HTTPRequest::GetURI() const\n {\n-    return evhttp_request_get_uri(req);\n+    return m_uri;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1208015277",
      "id" : 1208015277,
      "in_reply_to_id" : 1196635667,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585IANmt",
      "original_commit_id" : "c72967f48ab9eb02b8dc9231fdcc6ee85d66b7b9",
      "original_line" : 674,
      "original_position" : 85,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 1447409963,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1208015277/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-27T14:26:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1208015277",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updates:\r\n- Incorporated most of @stickies-v's suggestions.\r\n- I'll remove the `replySent` argument from the `httpserver` constructor (as @vasild suggested and @stickies-v agrees with), and update the `fuzz` test accordingly. I can squash it later into 1 if you like.",
      "created_at" : "2023-05-27T14:51:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1565460712",
      "id" : 1565460712,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585dTwjo",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1565460712/reactions"
      },
      "updated_at" : "2023-05-29T08:10:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1565460712",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updates:\r\n- Working on `fuzzer` failure.",
      "created_at" : "2023-05-29T17:44:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1567380170",
      "id" : 1567380170,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585dbFLK",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1567380170/reactions"
      },
      "updated_at" : "2023-05-29T17:44:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1567380170",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1210171462"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210171462"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "We don't need `m_uri` to be a valid URI, that's what `evhttp_uri_parse` is checking, we just need it to not behave unexpectedly (eg. segfault) when passed to `evhttp_uri_parse`. \"a\" also would not be a valid URI, but we're not checking that here either, that would just be duplicating what `evhttp_uri_parse` is already doing. \r\n\r\nSo unless there's another reason to not pass an empty char array to `evhttp_uri_parse`, I'd leave it out yeah.",
      "commit_id" : "ca8941100d19fa76e700185db9feb37a04294b71",
      "created_at" : "2023-05-30T12:03:06Z",
      "diff_hunk" : "@@ -536,18 +544,36 @@ void HTTPEvent::trigger(struct timeval* tv)\n     else\n         evtimer_add(ev, tv); // trigger after timeval passed\n }\n-HTTPRequest::HTTPRequest(struct evhttp_request* _req, bool _replySent) : req(_req), replySent(_replySent)\n+HTTPRequest::HTTPRequest(struct evhttp_request* _req, bool _replySent) :\n+        req{_req},\n+        m_uri{req != nullptr ? evhttp_request_get_uri(req) : nullptr},\n+        m_uri_parsed{m_uri != nullptr && m_uri[0] != '\\0' ? evhttp_uri_parse(m_uri) : nullptr},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1210171462",
      "id" : 1210171462,
      "in_reply_to_id" : 1197688711,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585IIcBG",
      "original_commit_id" : "c72967f48ab9eb02b8dc9231fdcc6ee85d66b7b9",
      "original_line" : 550,
      "original_position" : 46,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 1450777413,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210171462/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-30T12:03:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210171462",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1210184105"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210184105"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Don't we need to clean this up regardless of whether an exception was thrown?",
      "commit_id" : "ca8941100d19fa76e700185db9feb37a04294b71",
      "created_at" : "2023-05-30T12:15:08Z",
      "diff_hunk" : "@@ -47,20 +47,23 @@ FUZZ_TARGET(http_request)\n         return;\n     }\n \n-    HTTPRequest http_request{evreq, true};\n-    const HTTPRequest::RequestMethod request_method = http_request.GetRequestMethod();\n-    (void)RequestMethodString(request_method);\n-    (void)http_request.GetURI();\n-    (void)http_request.GetHeader(\"Host\");\n-    const std::string header = fuzzed_data_provider.ConsumeRandomLengthString(16);\n-    (void)http_request.GetHeader(header);\n-    (void)http_request.WriteHeader(header, fuzzed_data_provider.ConsumeRandomLengthString(16));\n-    (void)http_request.GetHeader(header);\n-    const std::string body = http_request.ReadBody();\n-    assert(body.empty());\n-    const CService service = http_request.GetPeer();\n-    assert(service.ToStringAddrPort() == \"[::]:0\");\n+    try {\n+        HTTPRequest http_request{evreq};\n+        const HTTPRequest::RequestMethod request_method = http_request.GetRequestMethod();\n+        (void)RequestMethodString(request_method);\n+        (void)http_request.GetURI();\n+        (void)http_request.GetHeader(\"Host\");\n+        const std::string header = fuzzed_data_provider.ConsumeRandomLengthString(16);\n+        (void)http_request.GetHeader(header);\n+        (void)http_request.WriteHeader(header, fuzzed_data_provider.ConsumeRandomLengthString(16));\n+        (void)http_request.GetHeader(header);\n+        const std::string body = http_request.ReadBody();\n+        assert(body.empty());\n+        const CService service = http_request.GetPeer();\n+        assert(service.ToStringAddrPort() == \"[::]:0\");\n \n-    evbuffer_free(evbuf);\n-    evhttp_request_free(evreq);\n+        evbuffer_free(evbuf);\n+        evhttp_request_free(evreq);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1210184105",
      "id" : 1210184105,
      "line" : 66,
      "node_id" : "PRRC_kwDOABII585IIfGp",
      "original_commit_id" : "ca8941100d19fa76e700185db9feb37a04294b71",
      "original_line" : 66,
      "original_position" : 35,
      "original_start_line" : 65,
      "path" : "src/test/fuzz/http_request.cpp",
      "position" : 35,
      "pull_request_review_id" : 1450797669,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210184105/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 65,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-05-30T12:15:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210184105",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I'm in favour of doing the `replySent` refactoring in a separate commit, but it makes more sense to have that be the first commit imo, to avoid adding logic and then removing it in the very next commit.\r\n\r\nYeah, true, I agree... let me revert the order of the commits.",
      "created_at" : "2023-05-30T12:41:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1568366234",
      "id" : 1568366234,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585de16a",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1568366234/reactions"
      },
      "updated_at" : "2023-05-30T12:41:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1568366234",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1210218266"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210218266"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Let me check again when I do revert the order of the commits, when I tested before those were needed as the fuzz was complaining about memory leaks.",
      "commit_id" : "ca8941100d19fa76e700185db9feb37a04294b71",
      "created_at" : "2023-05-30T12:44:42Z",
      "diff_hunk" : "@@ -47,20 +47,23 @@ FUZZ_TARGET(http_request)\n         return;\n     }\n \n-    HTTPRequest http_request{evreq, true};\n-    const HTTPRequest::RequestMethod request_method = http_request.GetRequestMethod();\n-    (void)RequestMethodString(request_method);\n-    (void)http_request.GetURI();\n-    (void)http_request.GetHeader(\"Host\");\n-    const std::string header = fuzzed_data_provider.ConsumeRandomLengthString(16);\n-    (void)http_request.GetHeader(header);\n-    (void)http_request.WriteHeader(header, fuzzed_data_provider.ConsumeRandomLengthString(16));\n-    (void)http_request.GetHeader(header);\n-    const std::string body = http_request.ReadBody();\n-    assert(body.empty());\n-    const CService service = http_request.GetPeer();\n-    assert(service.ToStringAddrPort() == \"[::]:0\");\n+    try {\n+        HTTPRequest http_request{evreq};\n+        const HTTPRequest::RequestMethod request_method = http_request.GetRequestMethod();\n+        (void)RequestMethodString(request_method);\n+        (void)http_request.GetURI();\n+        (void)http_request.GetHeader(\"Host\");\n+        const std::string header = fuzzed_data_provider.ConsumeRandomLengthString(16);\n+        (void)http_request.GetHeader(header);\n+        (void)http_request.WriteHeader(header, fuzzed_data_provider.ConsumeRandomLengthString(16));\n+        (void)http_request.GetHeader(header);\n+        const std::string body = http_request.ReadBody();\n+        assert(body.empty());\n+        const CService service = http_request.GetPeer();\n+        assert(service.ToStringAddrPort() == \"[::]:0\");\n \n-    evbuffer_free(evbuf);\n-    evhttp_request_free(evreq);\n+        evbuffer_free(evbuf);\n+        evhttp_request_free(evreq);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1210218266",
      "id" : 1210218266,
      "in_reply_to_id" : 1210184105,
      "line" : 66,
      "node_id" : "PRRC_kwDOABII585IInca",
      "original_commit_id" : "ca8941100d19fa76e700185db9feb37a04294b71",
      "original_line" : 66,
      "original_position" : 35,
      "original_start_line" : 65,
      "path" : "src/test/fuzz/http_request.cpp",
      "position" : 35,
      "pull_request_review_id" : 1450851994,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210218266/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 65,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-05-30T12:44:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210218266",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1210497550"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210497550"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "ok",
      "commit_id" : "ca8941100d19fa76e700185db9feb37a04294b71",
      "created_at" : "2023-05-30T15:59:11Z",
      "diff_hunk" : "@@ -536,18 +544,36 @@ void HTTPEvent::trigger(struct timeval* tv)\n     else\n         evtimer_add(ev, tv); // trigger after timeval passed\n }\n-HTTPRequest::HTTPRequest(struct evhttp_request* _req, bool _replySent) : req(_req), replySent(_replySent)\n+HTTPRequest::HTTPRequest(struct evhttp_request* _req, bool _replySent) :\n+        req{_req},\n+        m_uri{req != nullptr ? evhttp_request_get_uri(req) : nullptr},\n+        m_uri_parsed{m_uri != nullptr && m_uri[0] != '\\0' ? evhttp_uri_parse(m_uri) : nullptr},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1210497550",
      "id" : 1210497550,
      "in_reply_to_id" : 1197688711,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585IJroO",
      "original_commit_id" : "c72967f48ab9eb02b8dc9231fdcc6ee85d66b7b9",
      "original_line" : 550,
      "original_position" : 46,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 1451302856,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210497550/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-30T15:59:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1210497550",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updates:\r\n- I've found the issue with the`fuzz`test I'll push a fix with the commits in reverse order.",
      "created_at" : "2023-06-05T08:57:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1576401038",
      "id" : 1576401038,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585d9fiO",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1576401038/reactions"
      },
      "updated_at" : "2023-06-05T08:57:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1576401038",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1217755620"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1217755620"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Those are needed, I've checked the test code line by line. I'll do another check while I fix the current issue/ failure. Thanks!",
      "commit_id" : "68bc89bf9de1e78c5cb9a29d718b1ec3b1efa7b5",
      "created_at" : "2023-06-05T08:59:49Z",
      "diff_hunk" : "@@ -47,20 +47,23 @@ FUZZ_TARGET(http_request)\n         return;\n     }\n \n-    HTTPRequest http_request{evreq, true};\n-    const HTTPRequest::RequestMethod request_method = http_request.GetRequestMethod();\n-    (void)RequestMethodString(request_method);\n-    (void)http_request.GetURI();\n-    (void)http_request.GetHeader(\"Host\");\n-    const std::string header = fuzzed_data_provider.ConsumeRandomLengthString(16);\n-    (void)http_request.GetHeader(header);\n-    (void)http_request.WriteHeader(header, fuzzed_data_provider.ConsumeRandomLengthString(16));\n-    (void)http_request.GetHeader(header);\n-    const std::string body = http_request.ReadBody();\n-    assert(body.empty());\n-    const CService service = http_request.GetPeer();\n-    assert(service.ToStringAddrPort() == \"[::]:0\");\n+    try {\n+        HTTPRequest http_request{evreq};\n+        const HTTPRequest::RequestMethod request_method = http_request.GetRequestMethod();\n+        (void)RequestMethodString(request_method);\n+        (void)http_request.GetURI();\n+        (void)http_request.GetHeader(\"Host\");\n+        const std::string header = fuzzed_data_provider.ConsumeRandomLengthString(16);\n+        (void)http_request.GetHeader(header);\n+        (void)http_request.WriteHeader(header, fuzzed_data_provider.ConsumeRandomLengthString(16));\n+        (void)http_request.GetHeader(header);\n+        const std::string body = http_request.ReadBody();\n+        assert(body.empty());\n+        const CService service = http_request.GetPeer();\n+        assert(service.ToStringAddrPort() == \"[::]:0\");\n \n-    evbuffer_free(evbuf);\n-    evhttp_request_free(evreq);\n+        evbuffer_free(evbuf);\n+        evhttp_request_free(evreq);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1217755620",
      "id" : 1217755620,
      "in_reply_to_id" : 1210184105,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585IlXnk",
      "original_commit_id" : "ca8941100d19fa76e700185db9feb37a04294b71",
      "original_line" : 66,
      "original_position" : 35,
      "original_start_line" : 65,
      "path" : "src/test/fuzz/http_request.cpp",
      "position" : null,
      "pull_request_review_id" : 1462062143,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1217755620/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-06-05T08:59:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1217755620",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updates:\r\n- It seems I broke some functional tests with the `WriteReply` function \"fix\", ha, working on it.",
      "created_at" : "2023-06-05T11:32:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1576619633",
      "id" : 1576619633,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585d-U5x",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1576619633/reactions"
      },
      "updated_at" : "2023-06-05T11:32:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1576619633",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1233097071"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1233097071"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done.",
      "commit_id" : "68bc89bf9de1e78c5cb9a29d718b1ec3b1efa7b5",
      "created_at" : "2023-06-17T17:16:38Z",
      "diff_hunk" : "@@ -536,18 +544,36 @@ void HTTPEvent::trigger(struct timeval* tv)\n     else\n         evtimer_add(ev, tv); // trigger after timeval passed\n }\n-HTTPRequest::HTTPRequest(struct evhttp_request* _req, bool _replySent) : req(_req), replySent(_replySent)\n+HTTPRequest::HTTPRequest(struct evhttp_request* _req, bool _replySent) :\n+        req{_req},\n+        m_uri{req != nullptr ? evhttp_request_get_uri(req) : nullptr},\n+        m_uri_parsed{m_uri != nullptr && m_uri[0] != '\\0' ? evhttp_uri_parse(m_uri) : nullptr},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1233097071",
      "id" : 1233097071,
      "in_reply_to_id" : 1197688711,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Jf5Fv",
      "original_commit_id" : "c72967f48ab9eb02b8dc9231fdcc6ee85d66b7b9",
      "original_line" : 550,
      "original_position" : 46,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_review_id" : 1484860601,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1233097071/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-17T17:16:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1233097071",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updates:\r\n- Reverted order of the commits (now the very first is the `replySent`arg removal then secondly the URI validation enhancement approach) as [suggested](https://github.com/bitcoin/bitcoin/pull/27253#pullrequestreview-1450797669) by @stickies-v.\r\n- `replySent`arg [removed](https://github.com/bitcoin/bitcoin/pull/27253#pullrequestreview-1430879440) from`httprequest`obj constructor in first commit ([rationale](https://github.com/bitcoin/bitcoin/pull/27253#pullrequestreview-1450797669) of the removal added into commits message).\r\nIn order to do the removal, first I had to fix the underlying issue on`WriteReply`which was corrected also in the first commit (I didn't want to split it in a different commit since it was going to be like an isolated change and in order to test that I would have to test the`libevent`and I'm not too sure if what we want to do here regardin the scope of this PR and so on, happy to extend it and follow up in a different PR).\r\n- Went thru previous comments, reviews and suggestions to see if I've missed any nit or anything since this PR changed quite a bit, found this: [simple getter best to be implemented in the header](https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1142370781) by @stickies-v, which I've incorporated in the 2nd, commit. ",
      "created_at" : "2023-06-17T17:37:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1595814315",
      "id" : 1595814315,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585fHjGr",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1595814315/reactions"
      },
      "updated_at" : "2023-06-17T17:37:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1595814315",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1242236262"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1242236262"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: no need to use a C-style string here I think\r\n```suggestion\r\n        const std::string err{\"URI parsing failed, it likely contained RFC 3986 invalid characters\"};\r\n```",
      "commit_id" : "68bc89bf9de1e78c5cb9a29d718b1ec3b1efa7b5",
      "created_at" : "2023-06-26T13:54:21Z",
      "diff_hunk" : "@@ -532,8 +540,18 @@ void HTTPEvent::trigger(struct timeval* tv)\n     else\n         evtimer_add(ev, tv); // trigger after timeval passed\n }\n-HTTPRequest::HTTPRequest(struct evhttp_request* _req, bool _replySent) : req(_req), replySent(_replySent)\n+HTTPRequest::HTTPRequest(struct evhttp_request* _req) :\n+        req{_req},\n+        m_uri{req != nullptr ? evhttp_request_get_uri(req) : nullptr},\n+        m_uri_parsed{m_uri != nullptr ? evhttp_uri_parse(m_uri) : nullptr}\n {\n+    if (m_uri_parsed == nullptr) {\n+        const char* err{\"URI parsing failed, it likely contained RFC 3986 invalid characters\"};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1242236262",
      "id" : 1242236262,
      "line" : 549,
      "node_id" : "PRRC_kwDOABII585KCwVm",
      "original_commit_id" : "68bc89bf9de1e78c5cb9a29d718b1ec3b1efa7b5",
      "original_line" : 549,
      "original_position" : 49,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : 49,
      "pull_request_review_id" : 1498594259,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1242236262/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-28T10:51:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1242236262",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1243780038"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1243780038"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Do we need this?",
      "commit_id" : "68bc89bf9de1e78c5cb9a29d718b1ec3b1efa7b5",
      "created_at" : "2023-06-27T13:48:58Z",
      "diff_hunk" : "@@ -17,6 +17,7 @@\n #include <rpc/protocol.h> // For HTTP status codes\n #include <shutdown.h>\n #include <sync.h>\n+#include <util/check.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1243780038",
      "id" : 1243780038,
      "line" : 20,
      "node_id" : "PRRC_kwDOABII585KIpPG",
      "original_commit_id" : "68bc89bf9de1e78c5cb9a29d718b1ec3b1efa7b5",
      "original_line" : 20,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : 4,
      "pull_request_review_id" : 1498594259,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1243780038/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-28T10:51:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1243780038",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1245038873"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1245038873"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I don't think it's great that we're not doing the address-based checks before anything else. Since we're now adding validation into the constructor, how about we do it consistently and do it for all validation, so we can also control what we validate first? I'm still feeling a bit uneasy about coupling the construction of `HTTPRequest` with validation, but if we're doing it we might as well do it more consistently? Curious to hear @vasild's thoughts on this too.\r\n\r\n<details>\r\n<summary>git diff</summary>\r\n\r\n```diff\r\ndiff --git a/src/httpserver.cpp b/src/httpserver.cpp\r\nindex f7dc344f4..10f8ec24d 100644\r\n--- a/src/httpserver.cpp\r\n+++ b/src/httpserver.cpp\r\n@@ -235,6 +235,7 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\r\n     }\r\n     std::unique_ptr<HTTPRequest> hreq;\r\n \r\n+    // Initializing the HTTPRequest also performs basic validation such as address, method and URI checks\r\n     try {\r\n         hreq = std::make_unique<HTTPRequest>(req);\r\n     } catch (const std::runtime_error& e) {\r\n@@ -242,22 +243,6 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\r\n         return;\r\n     }\r\n \r\n-    // Early address-based allow check\r\n-    if (!ClientAllowed(hreq->GetPeer())) {\r\n-        LogPrint(BCLog::HTTP, \"HTTP request from %s rejected: Client network is not allowed RPC access\\n\",\r\n-                 hreq->GetPeer().ToStringAddrPort());\r\n-        hreq->WriteReply(HTTP_FORBIDDEN);\r\n-        return;\r\n-    }\r\n-\r\n-    // Early reject unknown HTTP methods\r\n-    if (hreq->GetRequestMethod() == HTTPRequest::UNKNOWN) {\r\n-        LogPrint(BCLog::HTTP, \"HTTP request from %s rejected: Unknown HTTP request method\\n\",\r\n-                 hreq->GetPeer().ToStringAddrPort());\r\n-        hreq->WriteReply(HTTP_BAD_METHOD);\r\n-        return;\r\n-    }\r\n-\r\n     const std::string strURI{hreq->GetURI()};\r\n     LogPrint(BCLog::HTTP, \"Received a %s request for %s from %s\\n\",\r\n              RequestMethodString(hreq->GetRequestMethod()), SanitizeString(strURI, SAFE_CHARS_URI).substr(0, 100), hreq->GetPeer().ToStringAddrPort());\r\n@@ -545,13 +530,7 @@ HTTPRequest::HTTPRequest(struct evhttp_request* _req) :\r\n         m_uri{req != nullptr ? evhttp_request_get_uri(req) : nullptr},\r\n         m_uri_parsed{m_uri != nullptr ? evhttp_uri_parse(m_uri) : nullptr}\r\n {\r\n-    if (m_uri_parsed == nullptr) {\r\n-        const char* err{\"URI parsing failed, it likely contained RFC 3986 invalid characters\"};\r\n-        const std::string peerAddress{GetPeer().ToStringAddr()};\r\n-        WriteReply(HTTP_BAD_REQUEST, err);\r\n-        throw std::runtime_error(\r\n-            strprintf(\"HTTP request from %s rejected: %s\", peerAddress, err));\r\n-    }\r\n+    Validate();\r\n }\r\n \r\n HTTPRequest::~HTTPRequest()\r\n@@ -565,6 +544,29 @@ HTTPRequest::~HTTPRequest()\r\n     evhttp_uri_free(m_uri_parsed);\r\n }\r\n \r\n+void HTTPRequest::Validate()\r\n+{\r\n+    const std::string rejected{strprintf(\"HTTP request from %s rejected: \", GetPeer().ToStringAddrPort())};\r\n+    // Early address-based allow check\r\n+    if (!ClientAllowed(GetPeer())) {\r\n+        WriteReply(HTTP_FORBIDDEN);\r\n+        throw std::runtime_error(rejected + \"Client network is not allowed RPC access\");\r\n+    }\r\n+\r\n+    // Early reject unknown HTTP methods\r\n+    if (GetRequestMethod() == HTTPRequest::UNKNOWN) {\r\n+        WriteReply(HTTP_BAD_METHOD);\r\n+        throw std::runtime_error(rejected + \"Unknown HTTP request method\");\r\n+    }\r\n+\r\n+    // Ensure valid URI\r\n+    if (m_uri_parsed == nullptr) {\r\n+        const std::string err{\"URI parsing failed, it likely contained RFC 3986 invalid characters\"};\r\n+        WriteReply(HTTP_BAD_REQUEST, err);\r\n+        throw std::runtime_error(rejected + err);\r\n+    }\r\n+}\r\n+\r\n std::pair<bool, std::string> HTTPRequest::GetHeader(const std::string& hdr) const\r\n {\r\n     const struct evkeyvalq* headers = evhttp_request_get_input_headers(req);\r\ndiff --git a/src/httpserver.h b/src/httpserver.h\r\nindex 77a249a6a..3c5af5b0b 100644\r\n--- a/src/httpserver.h\r\n+++ b/src/httpserver.h\r\n@@ -64,6 +64,9 @@ private:\r\n     /// The parsed URI, as returned by `evhttp_uri_parse()`. Will never be `nullptr`.\r\n     evhttp_uri* const m_uri_parsed;\r\n \r\n+    // Perform early validity checks. Send a response and throw std::runtime_error if invalid.\r\n+    void Validate();\r\n+\r\n public:\r\n     explicit HTTPRequest(struct evhttp_request* req);\r\n     ~HTTPRequest();\r\n\r\n```\r\n</details>",
      "commit_id" : "68bc89bf9de1e78c5cb9a29d718b1ec3b1efa7b5",
      "created_at" : "2023-06-28T10:50:20Z",
      "diff_hunk" : "@@ -232,7 +233,14 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             }\n         }\n     }\n-    std::unique_ptr<HTTPRequest> hreq(new HTTPRequest(req));\n+    std::unique_ptr<HTTPRequest> hreq;\n+\n+    try {\n+        hreq = std::make_unique<HTTPRequest>(req);\n+    } catch (const std::runtime_error& e) {\n+        LogPrint(BCLog::HTTP, \"%s\\n\", e.what());\n+        return;\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1245038873",
      "id" : 1245038873,
      "line" : 243,
      "node_id" : "PRRC_kwDOABII585KNckZ",
      "original_commit_id" : "68bc89bf9de1e78c5cb9a29d718b1ec3b1efa7b5",
      "original_line" : 243,
      "original_position" : 20,
      "original_start_line" : 238,
      "path" : "src/httpserver.cpp",
      "position" : 20,
      "pull_request_review_id" : 1498594259,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1245038873/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 238,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-06-28T10:51:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1245038873",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-06-28T11:44:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1611253349",
      "id" : 1611253349,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585gCcZl",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1611253349/reactions"
      },
      "updated_at" : "2023-06-28T11:44:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1611253349",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1248024010"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1248024010"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Not anymore, there was an `Assume()` somewhere in `HTTPRequest::GetQueryParameter` checking for `m_uri_parsed` at some point. Thanks for checking, I'll remove it.",
      "commit_id" : "68bc89bf9de1e78c5cb9a29d718b1ec3b1efa7b5",
      "created_at" : "2023-06-30T15:53:56Z",
      "diff_hunk" : "@@ -17,6 +17,7 @@\n #include <rpc/protocol.h> // For HTTP status codes\n #include <shutdown.h>\n #include <sync.h>\n+#include <util/check.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1248024010",
      "id" : 1248024010,
      "in_reply_to_id" : 1243780038,
      "line" : 20,
      "node_id" : "PRRC_kwDOABII585KY1XK",
      "original_commit_id" : "68bc89bf9de1e78c5cb9a29d718b1ec3b1efa7b5",
      "original_line" : 20,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/httpserver.cpp",
      "position" : 4,
      "pull_request_review_id" : 1507459358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1248024010/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-30T15:54:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1248024010",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1248139828"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1248139828"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I understand your worries on coupling the validation within the constructor (separation of/ different concerns, error handling, flexibility, etc) but since those validations/ \"early checks\" also would impact into the state of the object itself it would make sense to me to put them together, consistently and cleaner. Happy to make the change if @vasild also agree with it.",
      "commit_id" : "68bc89bf9de1e78c5cb9a29d718b1ec3b1efa7b5",
      "created_at" : "2023-06-30T18:02:32Z",
      "diff_hunk" : "@@ -232,7 +233,14 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             }\n         }\n     }\n-    std::unique_ptr<HTTPRequest> hreq(new HTTPRequest(req));\n+    std::unique_ptr<HTTPRequest> hreq;\n+\n+    try {\n+        hreq = std::make_unique<HTTPRequest>(req);\n+    } catch (const std::runtime_error& e) {\n+        LogPrint(BCLog::HTTP, \"%s\\n\", e.what());\n+        return;\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1248139828",
      "id" : 1248139828,
      "in_reply_to_id" : 1245038873,
      "line" : 243,
      "node_id" : "PRRC_kwDOABII585KZRo0",
      "original_commit_id" : "68bc89bf9de1e78c5cb9a29d718b1ec3b1efa7b5",
      "original_line" : 243,
      "original_position" : 20,
      "original_start_line" : 238,
      "path" : "src/httpserver.cpp",
      "position" : 20,
      "pull_request_review_id" : 1507642805,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27253",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1248139828/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 238,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-06-30T18:02:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1248139828",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updates:\r\n- Rebased\r\n- Implemented refactoring [suggestion](https://github.com/bitcoin/bitcoin/pull/27253#discussion_r1245038873) from @stickies-v, moving other http reject validations into the constructor and regrouping them under a `Validate()` function to make the entire validation more consistent.",
      "created_at" : "2023-07-03T16:32:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1618849607",
      "id" : 1618849607,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585gfa9H",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1618849607/reactions"
      },
      "updated_at" : "2023-07-03T16:32:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1618849607",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updates:\r\n- Checking fuzz test failure",
      "created_at" : "2023-07-03T17:48:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1618940865",
      "id" : 1618940865,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585gfxPB",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1618940865/reactions"
      },
      "updated_at" : "2023-07-03T17:48:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1618940865",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "After a chat with @stickies-v where we were discussing different approaches on this enhancement and other details regarding fuzz testing, libevent functionality and each commit intention, I've decided to put this onto draft. Firstly we would need to define the purpose of the `httprequest` object, do we want/ need the `httprequest` obj to exist even with an invalid request?, as @stickies-v [raised his concerns before](https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1481163868), it seems coupling the validation within the constructor perhaps is not the best approach after all. I'll check the different alternatives of moving the validation out from the constructor and perhaps throwing the error later in the callback, also maybe I'll split the commits in different PRs once I revisit the fuzz test and logic perform some libevent tests. ",
      "created_at" : "2023-07-04T16:53:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1620535396",
      "id" : 1620535396,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585gl2hk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1620535396/reactions"
      },
      "updated_at" : "2023-07-04T16:53:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1620535396",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Are you still working on this?",
      "created_at" : "2023-10-05T09:22:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1748465650",
      "id" : 1748465650,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585oN3fy",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1748465650/reactions"
      },
      "updated_at" : "2023-10-05T09:22:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1748465650",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Are you still working on this?\r\n\r\nI do",
      "created_at" : "2023-10-05T11:44:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1748721409",
      "id" : 1748721409,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585oO18B",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1748721409/reactions"
      },
      "updated_at" : "2023-10-05T11:44:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1748721409",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/110166421?v=4",
         "events_url" : "https://api.github.com/users/pablomartin4btc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pablomartin4btc/followers",
         "following_url" : "https://api.github.com/users/pablomartin4btc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pablomartin4btc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pablomartin4btc",
         "id" : 110166421,
         "login" : "pablomartin4btc",
         "node_id" : "U_kgDOBpEBlQ",
         "organizations_url" : "https://api.github.com/users/pablomartin4btc/orgs",
         "received_events_url" : "https://api.github.com/users/pablomartin4btc/received_events",
         "repos_url" : "https://api.github.com/users/pablomartin4btc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pablomartin4btc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pablomartin4btc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pablomartin4btc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-12-14T21:53:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27253#issuecomment-1856715872",
      "id" : 1856715872,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27253",
      "node_id" : "IC_kwDOABII585uqzxg",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1856715872/reactions"
      },
      "updated_at" : "2023-12-14T21:53:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1856715872",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   }
]
