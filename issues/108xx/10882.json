{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "- Add `keypool_critical` (configurable). If the number of keys in the keypool drops below this limit while the wallet is rescanning, shutdown the node. Do not shutdown the node if the wallet is 'current', ie it is receiving `BlockConnected` calls from the node.\r\n- Add `keypool_min` (configurable). If the number of keys in the keypool drops below this limit, stop advancing the wallet's best block. This forces the wallet to rescan from the point that it dropped below the limit the next time that it starts up. This is a toggle controlled by `m_update_best_block`, which doesn't get unset until the wallet has rescanned with the keypool above keypool_min.\r\n- Add `bypasskeypoolcritical` (command line argument). This disables the keypool_critical behavior, so the user has a chance to top up their keypool.\r\n- don't allow user actions like `getnewaddress` to cause the keypool to drop below the critical limit (return an error telling the user to unlock and topup their keypool).\r\n\r\nThis is a simpler version of #10830 , which caused the node to stop sync'ing if the keypool dropped below a certain limit. It is built on top of #11022 which does the following:\r\n\r\n- if a key in the keypool is used, mark all keys in the keypool up to that key as used\r\n- try to top up the keypool when keys from the keypool are used.\r\n\r\nThis PR couldn't be merged for v0.15 because there are some edge cases that make this dangerous and could result in users not being able to start up the node without onerous recovery steps.",
   "closed_at" : "2017-08-29T18:26:29Z",
   "closed_by" : {
      "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
      "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
      "followers_url" : "https://api.github.com/users/jnewbery/followers",
      "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/jnewbery",
      "id" : 1063656,
      "login" : "jnewbery",
      "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
      "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
      "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
      "repos_url" : "https://api.github.com/users/jnewbery/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/jnewbery"
   },
   "comments" : 56,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10882/comments",
   "created_at" : "2017-07-19T18:20:35Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10882/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/10882",
   "id" : 244130012,
   "labels" : [
      {
         "color" : "08a781",
         "default" : false,
         "id" : 149424,
         "name" : "Wallet",
         "node_id" : "MDU6TGFiZWwxNDk0MjQ=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10882/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDExOlB1bGxSZXF1ZXN0MTMxMzg3Mjg1",
   "number" : 10882,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/10882.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10882",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/10882.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10882"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "[Do not merge] Stop advancing best block and shutdown node if keypool drops below critical threshold",
   "updated_at" : "2017-12-09T15:35:42Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10882",
   "user" : {
      "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
      "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
      "followers_url" : "https://api.github.com/users/jnewbery/followers",
      "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/jnewbery",
      "id" : 1063656,
      "login" : "jnewbery",
      "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
      "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
      "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
      "repos_url" : "https://api.github.com/users/jnewbery/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/jnewbery"
   }
}
