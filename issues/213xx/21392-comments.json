[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589800403"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589800403"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: unneeded",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-08T22:39:29Z",
      "diff_hunk" : "@@ -226,7 +226,6 @@ struct MempoolAcceptResult {\n MempoolAcceptResult AcceptToMemoryPool(CChainState& active_chainstate, CTxMemPool& pool, const CTransactionRef& tx,\n                                        bool bypass_limits, bool test_accept=false) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\n \n-",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589800403",
      "id" : 589800403,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4OTgwMDQwMw==",
      "original_commit_id" : "b16a75572684865e4a54b7cb56f05c028ac98026",
      "original_line" : 226,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : null,
      "pull_request_review_id" : 606773707,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589800403",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589804330"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589804330"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think it'd be worth adding the ability to set the `min_activation_height` for testing as well",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-08T22:44:02Z",
      "diff_hunk" : "@@ -23,7 +23,7 @@ void SetupChainParamsBaseOptions(ArgsManager& argsman)\n                  \"This is intended for regression testing tools and app development. Equivalent to -chain=regtest.\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n     argsman.AddArg(\"-segwitheight=<n>\", \"Set the activation height of segwit. -1 to disable. (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);\n     argsman.AddArg(\"-testnet\", \"Use the test chain. Equivalent to -chain=test.\", ArgsManager::ALLOW_ANY, OptionsCategory::CHAINPARAMS);\n-    argsman.AddArg(\"-vbparams=deployment:start:end\", \"Use given start/end times for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n+    argsman.AddArg(\"-vbparams=deployment:@startheight:@timeoutheight\", \"Use given start/timeout heights for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589804330",
      "id" : 589804330,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4OTgwNDMzMA==",
      "original_commit_id" : "b16a75572684865e4a54b7cb56f05c028ac98026",
      "original_line" : 26,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/chainparamsbase.cpp",
      "position" : null,
      "pull_request_review_id" : 606773707,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589804330",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589808255"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589808255"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "As it stands, `-vbparams` is only used to disable taproot activation to check soft-fork status, so this would only be useful if it came with an actual test.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-08T22:52:02Z",
      "diff_hunk" : "@@ -23,7 +23,7 @@ void SetupChainParamsBaseOptions(ArgsManager& argsman)\n                  \"This is intended for regression testing tools and app development. Equivalent to -chain=regtest.\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n     argsman.AddArg(\"-segwitheight=<n>\", \"Set the activation height of segwit. -1 to disable. (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);\n     argsman.AddArg(\"-testnet\", \"Use the test chain. Equivalent to -chain=test.\", ArgsManager::ALLOW_ANY, OptionsCategory::CHAINPARAMS);\n-    argsman.AddArg(\"-vbparams=deployment:start:end\", \"Use given start/end times for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n+    argsman.AddArg(\"-vbparams=deployment:@startheight:@timeoutheight\", \"Use given start/timeout heights for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589808255",
      "id" : 589808255,
      "in_reply_to_id" : 589804330,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4OTgwODI1NQ==",
      "original_commit_id" : "b16a75572684865e4a54b7cb56f05c028ac98026",
      "original_line" : 26,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/chainparamsbase.cpp",
      "position" : null,
      "pull_request_review_id" : 606782162,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589808255",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Maybe consider rebasing on #21380 ; it adds fuzz testing and removes the need for the `MinActivationHeight()` virtual functions, and should make the \"per-deployment-threshold\" part a bit simpler.",
      "created_at" : "2021-03-08T22:56:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-793147434",
      "id" : 793147434,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MzE0NzQzNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-08T22:56:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/793147434",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589810331"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589810331"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Removed",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-08T22:56:35Z",
      "diff_hunk" : "@@ -226,7 +226,6 @@ struct MempoolAcceptResult {\n MempoolAcceptResult AcceptToMemoryPool(CChainState& active_chainstate, CTxMemPool& pool, const CTransactionRef& tx,\n                                        bool bypass_limits, bool test_accept=false) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\n \n-",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589810331",
      "id" : 589810331,
      "in_reply_to_id" : 589800403,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4OTgxMDMzMQ==",
      "original_commit_id" : "b16a75572684865e4a54b7cb56f05c028ac98026",
      "original_line" : 226,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : null,
      "pull_request_review_id" : 606784846,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589810331",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Maybe consider rebasing on #21380 ; it adds fuzz testing and removes the need for the `MinActivationHeight()` virtual functions, and should make the \"per-deployment-threshold\" part a bit simpler.\r\n\r\nDone. It did indeed make this simpler. The fuzzer also caught one minor issue.",
      "created_at" : "2021-03-09T01:47:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-793254716",
      "id" : 793254716,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MzI1NDcxNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-09T01:47:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/793254716",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589881249"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589881249"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Should this be set to NEVER_ACTIVE?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-09T01:54:18Z",
      "diff_hunk" : "@@ -20,24 +20,37 @@ enum DeploymentPos\n };\n \n /**\n- * Struct for each individual consensus rule change using BIP9.\n+ * Struct for each individual consensus rule change using version bits (BIP 8).\n  */\n-struct BIP9Deployment {\n+struct VBitsDeployment {\n     /** Bit position to select the particular bit in nVersion. */\n     int bit;\n-    /** Start MedianTime for version bits miner confirmation. Can be a date in the past */\n-    int64_t nStartTime;\n-    /** Timeout/expiry MedianTime for the deployment attempt. */\n-    int64_t nTimeout;\n+    /** Start block height for version bits miner confirmation. Must be a retarget block, can be in the past. */\n+    int64_t startheight;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589881249",
      "id" : 589881249,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4OTg4MTI0OQ==",
      "original_commit_id" : "3d6fa014f3f122bbcfcdbe39cc2bd043bf2fe915",
      "original_line" : 29,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/consensus/params.h",
      "position" : null,
      "pull_request_review_id" : 606866335,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589881249",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589886135"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589886135"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "there's not really a great way to rewrite this, but can we comment why it is +1",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-09T02:07:55Z",
      "diff_hunk" : "@@ -30,8 +36,8 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n             cache[pindexPrev] = ThresholdState::DEFINED;\n             break;\n         }\n-        if (pindexPrev->GetMedianTimePast() < nTimeStart) {\n-            // Optimization: don't recompute down further, as we know every earlier block will be before the start time\n+        if (pindexPrev->nHeight + 1 < height_start) {\n+            // Optimization: don't recompute down further, as we know every earlier block will be before the start height",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589886135",
      "id" : 589886135,
      "line" : 42,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4OTg4NjEzNQ==",
      "original_commit_id" : "c25fe127af4e91da541e6d8c5c47ea733994d529",
      "original_line" : 42,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : 30,
      "pull_request_review_id" : 606866335,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589886135",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589886501"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589886501"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "how it is doc'd below is great",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-09T02:08:53Z",
      "diff_hunk" : "@@ -30,8 +36,8 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n             cache[pindexPrev] = ThresholdState::DEFINED;\n             break;\n         }\n-        if (pindexPrev->GetMedianTimePast() < nTimeStart) {\n-            // Optimization: don't recompute down further, as we know every earlier block will be before the start time\n+        if (pindexPrev->nHeight + 1 < height_start) {\n+            // Optimization: don't recompute down further, as we know every earlier block will be before the start height",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589886501",
      "id" : 589886501,
      "in_reply_to_id" : 589886135,
      "line" : 42,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4OTg4NjUwMQ==",
      "original_commit_id" : "c25fe127af4e91da541e6d8c5c47ea733994d529",
      "original_line" : 42,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : 30,
      "pull_request_review_id" : 606866335,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589886501",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589886850"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589886850"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "ibid -- a temporary makes this clearer",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-09T02:09:51Z",
      "diff_hunk" : "@@ -94,50 +103,54 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n     return state;\n }\n \n-BIP9Stats AbstractThresholdConditionChecker::GetStateStatisticsFor(const CBlockIndex* pindex, const Consensus::Params& params) const\n+VBitsStats ThresholdConditionChecker::GetStateStatisticsFor(const CBlockIndex* pindexPrev) const\n {\n-    BIP9Stats stats = {};\n+    VBitsStats stats = {};\n \n-    stats.period = Period(params);\n-    stats.threshold = Threshold(params);\n+    stats.period = m_period;\n+    stats.threshold = m_dep.m_threshold;\n \n-    if (pindex == nullptr)\n+    if (pindexPrev == nullptr || (pindexPrev->nHeight + 1) < stats.period) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589886850",
      "id" : 589886850,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4OTg4Njg1MA==",
      "original_commit_id" : "c25fe127af4e91da541e6d8c5c47ea733994d529",
      "original_line" : 113,
      "original_position" : 105,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 606866335,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589886850",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589891206"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589891206"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The potential for uninitialized members here is concerning to me, so I am working on a followup to deal with those. That may be rolled into this PR.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-09T02:21:54Z",
      "diff_hunk" : "@@ -20,24 +20,37 @@ enum DeploymentPos\n };\n \n /**\n- * Struct for each individual consensus rule change using BIP9.\n+ * Struct for each individual consensus rule change using version bits (BIP 8).\n  */\n-struct BIP9Deployment {\n+struct VBitsDeployment {\n     /** Bit position to select the particular bit in nVersion. */\n     int bit;\n-    /** Start MedianTime for version bits miner confirmation. Can be a date in the past */\n-    int64_t nStartTime;\n-    /** Timeout/expiry MedianTime for the deployment attempt. */\n-    int64_t nTimeout;\n+    /** Start block height for version bits miner confirmation. Must be a retarget block, can be in the past. */\n+    int64_t startheight;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589891206",
      "id" : 589891206,
      "in_reply_to_id" : 589881249,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4OTg5MTIwNg==",
      "original_commit_id" : "3d6fa014f3f122bbcfcdbe39cc2bd043bf2fe915",
      "original_line" : 29,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/consensus/params.h",
      "position" : null,
      "pull_request_review_id" : 606877525,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589891206",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589891266"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589891266"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-09T02:22:00Z",
      "diff_hunk" : "@@ -30,8 +36,8 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n             cache[pindexPrev] = ThresholdState::DEFINED;\n             break;\n         }\n-        if (pindexPrev->GetMedianTimePast() < nTimeStart) {\n-            // Optimization: don't recompute down further, as we know every earlier block will be before the start time\n+        if (pindexPrev->nHeight + 1 < height_start) {\n+            // Optimization: don't recompute down further, as we know every earlier block will be before the start height",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589891266",
      "id" : 589891266,
      "in_reply_to_id" : 589886135,
      "line" : 42,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4OTg5MTI2Ng==",
      "original_commit_id" : "c25fe127af4e91da541e6d8c5c47ea733994d529",
      "original_line" : 42,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : 30,
      "pull_request_review_id" : 606877587,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589891266",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589891296"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589891296"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-09T02:22:04Z",
      "diff_hunk" : "@@ -94,50 +103,54 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n     return state;\n }\n \n-BIP9Stats AbstractThresholdConditionChecker::GetStateStatisticsFor(const CBlockIndex* pindex, const Consensus::Params& params) const\n+VBitsStats ThresholdConditionChecker::GetStateStatisticsFor(const CBlockIndex* pindexPrev) const\n {\n-    BIP9Stats stats = {};\n+    VBitsStats stats = {};\n \n-    stats.period = Period(params);\n-    stats.threshold = Threshold(params);\n+    stats.period = m_period;\n+    stats.threshold = m_dep.m_threshold;\n \n-    if (pindex == nullptr)\n+    if (pindexPrev == nullptr || (pindexPrev->nHeight + 1) < stats.period) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r589891296",
      "id" : 589891296,
      "in_reply_to_id" : 589886850,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4OTg5MTI5Ng==",
      "original_commit_id" : "c25fe127af4e91da541e6d8c5c47ea733994d529",
      "original_line" : 113,
      "original_position" : 105,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 606877624,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589891296",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #21401 (Refactor versionbits deployments to avoid potential uninitialized variables by achow101)\n* #21391 ([Bundle 5/n] Prune g_chainman usage in RPC modules by dongcarl)\n* #21378 (Convert taproot to flag day activation by ajtowns)\n* #21377 (Speedy trial support for versionbits by ajtowns)\n* #20354 (test: Add feature_taproot.py --previous_release by MarcoFalke)\n* #19438 (Introduce deploymentstatus by ajtowns)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-03-09T04:23:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-793365182",
      "id" : 793365182,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MzM2NTE4Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-30T14:23:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/793365182",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590330775"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590330775"
         }
      },
      "author_association" : "MEMBER",
      "body" : "\"The with UASF\" -> \"The UASF fallback with forced signalling (LOT=true) has not been implemented. The current implementation is the equivalent of LOT=false\"",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-09T12:37:42Z",
      "diff_hunk" : "@@ -1,6 +1,7 @@\n BIPs that are implemented by Bitcoin Core (up-to-date up to **v0.21.0**):\n \n-* [`BIP 9`](https://github.com/bitcoin/bips/blob/master/bip-0009.mediawiki): The changes allowing multiple soft-forks to be deployed in parallel have been implemented since **v0.12.1**  ([PR #7575](https://github.com/bitcoin/bitcoin/pull/7575))\n+* [`BIP 8`](https://github.com/bitcoin/bips/blob/master/bip-0008.mediawiki): The changes for parallel, rapid deployment based on block height miner activation have been implemented since **v0.21.1** ([PR #21392](https://github.com/bitcoin/bitcoin/pull/21392)). The  with UASF failover is not yet implemented.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590330775",
      "id" : 590330775,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MDMzMDc3NQ==",
      "original_commit_id" : "3395165dfe6b84e6d04ad134f0135c44e8c8ddc6",
      "original_line" : 3,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "doc/bips.md",
      "position" : null,
      "pull_request_review_id" : 607356173,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590330775",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590339596"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590339596"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is a breaking RPC change, so needs a release note.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-09T12:49:15Z",
      "diff_hunk" : "@@ -1297,24 +1295,24 @@ RPCHelpMan getblockchaininfo()\n                         {\n                             {RPCResult::Type::OBJ, \"xxxx\", \"name of the softfork\",\n                             {\n-                                {RPCResult::Type::STR, \"type\", \"one of \\\"buried\\\", \\\"bip9\\\"\"},\n-                                {RPCResult::Type::OBJ, \"bip9\", \"status of bip9 softforks (only for \\\"bip9\\\" type)\",\n+                                {RPCResult::Type::STR, \"type\", \"one of \\\"buried\\\", \\\"bip8\\\"\"},\n+                                {RPCResult::Type::OBJ, \"bip8\", \"status of BIP 8 softforks (only for \\\"bip8\\\" type)\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590339596",
      "id" : 590339596,
      "line" : 1300,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MDMzOTU5Ng==",
      "original_commit_id" : "3395165dfe6b84e6d04ad134f0135c44e8c8ddc6",
      "original_line" : 1300,
      "original_position" : 71,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 43,
      "pull_request_review_id" : 607356173,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590339596",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590345168"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590345168"
         }
      },
      "author_association" : "MEMBER",
      "body" : "7e47c280b7b5597e4a259f4d4b50d661fccd061a : I would be in favor of such a test, but I suggest introducing the `@min_activation_height` param in a later commit, rather than in this refactor. ",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-09T12:56:59Z",
      "diff_hunk" : "@@ -23,7 +23,7 @@ void SetupChainParamsBaseOptions(ArgsManager& argsman)\n                  \"This is intended for regression testing tools and app development. Equivalent to -chain=regtest.\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n     argsman.AddArg(\"-segwitheight=<n>\", \"Set the activation height of segwit. -1 to disable. (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);\n     argsman.AddArg(\"-testnet\", \"Use the test chain. Equivalent to -chain=test.\", ArgsManager::ALLOW_ANY, OptionsCategory::CHAINPARAMS);\n-    argsman.AddArg(\"-vbparams=deployment:start:end\", \"Use given start/end times for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n+    argsman.AddArg(\"-vbparams=deployment:@startheight:@timeoutheight\", \"Use given start/timeout heights for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590345168",
      "id" : 590345168,
      "in_reply_to_id" : 589804330,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MDM0NTE2OA==",
      "original_commit_id" : "b16a75572684865e4a54b7cb56f05c028ac98026",
      "original_line" : 26,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/chainparamsbase.cpp",
      "position" : null,
      "pull_request_review_id" : 607356173,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590345168",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590347074"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590347074"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Comment needs update.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-09T12:59:29Z",
      "diff_hunk" : "@@ -1229,7 +1229,7 @@ static void BIP9SoftForkDescPushBack(UniValue& softforks, const std::string &nam\n     // Deployments (e.g. testdummy) with timeout value before Jan 1, 2009 are hidden.\n     // A timeout value of 0 guarantees a softfork will never be activated.\n     // This is used when merging logic to implement a proposed softfork without a specified deployment schedule.\n-    if (consensusParams.vDeployments[id].nTimeout <= 1230768000) return;\n+    if (consensusParams.vDeployments[id].timeoutheight == Consensus::VBitsDeployment::NEVER_ACTIVE) return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590347074",
      "id" : 590347074,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MDM0NzA3NA==",
      "original_commit_id" : "7e47c280b7b5597e4a259f4d4b50d661fccd061a",
      "original_line" : 1230,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 607356173,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590347074",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590349951"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590349951"
         }
      },
      "author_association" : "MEMBER",
      "body" : "While you're at it, the comment about which node is active is the wrong way around.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-09T13:03:44Z",
      "diff_hunk" : "@@ -1201,7 +1201,7 @@ def set_test_params(self):\n         self.num_nodes = 2\n         self.setup_clean_chain = True\n         # Node 0 has Taproot inactive, Node 1 active.\n-        self.extra_args = [[\"-par=1\", \"-vbparams=taproot:1:1\"], [\"-par=1\"]]\n+        self.extra_args = [[\"-par=1\", \"-vbparams=taproot:@1:@1\"], [\"-par=1\"]]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590349951",
      "id" : 590349951,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MDM0OTk1MQ==",
      "original_commit_id" : "7e47c280b7b5597e4a259f4d4b50d661fccd061a",
      "original_line" : 1204,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/feature_taproot.py",
      "position" : null,
      "pull_request_review_id" : 607356173,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590349951",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Here you go, a BIP 8 delayed activation functional test for your cherry-picking: https://github.com/Sjors/bitcoin/commits/2021/03/bip8-speedy-trial-test",
      "created_at" : "2021-03-09T15:53:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-794078821",
      "id" : 794078821,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5NDA3ODgyMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-09T15:53:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/794078821",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590580067"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590580067"
         }
      },
      "author_association" : "MEMBER",
      "body" : "No? Node 0 has taproot inactive and setting the vbparams in this way (startheight=1, timeoutheight=1) ensures that it cannot activate on regtest.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-09T17:37:03Z",
      "diff_hunk" : "@@ -1201,7 +1201,7 @@ def set_test_params(self):\n         self.num_nodes = 2\n         self.setup_clean_chain = True\n         # Node 0 has Taproot inactive, Node 1 active.\n-        self.extra_args = [[\"-par=1\", \"-vbparams=taproot:1:1\"], [\"-par=1\"]]\n+        self.extra_args = [[\"-par=1\", \"-vbparams=taproot:@1:@1\"], [\"-par=1\"]]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590580067",
      "id" : 590580067,
      "in_reply_to_id" : 590349951,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MDU4MDA2Nw==",
      "original_commit_id" : "7e47c280b7b5597e4a259f4d4b50d661fccd061a",
      "original_line" : 1204,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/feature_taproot.py",
      "position" : null,
      "pull_request_review_id" : 607682944,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590580067",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590587972"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590587972"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-09T17:47:39Z",
      "diff_hunk" : "@@ -1,6 +1,7 @@\n BIPs that are implemented by Bitcoin Core (up-to-date up to **v0.21.0**):\n \n-* [`BIP 9`](https://github.com/bitcoin/bips/blob/master/bip-0009.mediawiki): The changes allowing multiple soft-forks to be deployed in parallel have been implemented since **v0.12.1**  ([PR #7575](https://github.com/bitcoin/bitcoin/pull/7575))\n+* [`BIP 8`](https://github.com/bitcoin/bips/blob/master/bip-0008.mediawiki): The changes for parallel, rapid deployment based on block height miner activation have been implemented since **v0.21.1** ([PR #21392](https://github.com/bitcoin/bitcoin/pull/21392)). The  with UASF failover is not yet implemented.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590587972",
      "id" : 590587972,
      "in_reply_to_id" : 590330775,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MDU4Nzk3Mg==",
      "original_commit_id" : "3395165dfe6b84e6d04ad134f0135c44e8c8ddc6",
      "original_line" : 3,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "doc/bips.md",
      "position" : null,
      "pull_request_review_id" : 607693014,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590587972",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590588073"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590588073"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-09T17:47:46Z",
      "diff_hunk" : "@@ -1297,24 +1295,24 @@ RPCHelpMan getblockchaininfo()\n                         {\n                             {RPCResult::Type::OBJ, \"xxxx\", \"name of the softfork\",\n                             {\n-                                {RPCResult::Type::STR, \"type\", \"one of \\\"buried\\\", \\\"bip9\\\"\"},\n-                                {RPCResult::Type::OBJ, \"bip9\", \"status of bip9 softforks (only for \\\"bip9\\\" type)\",\n+                                {RPCResult::Type::STR, \"type\", \"one of \\\"buried\\\", \\\"bip8\\\"\"},\n+                                {RPCResult::Type::OBJ, \"bip8\", \"status of BIP 8 softforks (only for \\\"bip8\\\" type)\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590588073",
      "id" : 590588073,
      "in_reply_to_id" : 590339596,
      "line" : 1300,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MDU4ODA3Mw==",
      "original_commit_id" : "3395165dfe6b84e6d04ad134f0135c44e8c8ddc6",
      "original_line" : 1300,
      "original_position" : 71,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 43,
      "pull_request_review_id" : 607693134,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590588073",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590588126"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590588126"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-09T17:47:51Z",
      "diff_hunk" : "@@ -1229,7 +1229,7 @@ static void BIP9SoftForkDescPushBack(UniValue& softforks, const std::string &nam\n     // Deployments (e.g. testdummy) with timeout value before Jan 1, 2009 are hidden.\n     // A timeout value of 0 guarantees a softfork will never be activated.\n     // This is used when merging logic to implement a proposed softfork without a specified deployment schedule.\n-    if (consensusParams.vDeployments[id].nTimeout <= 1230768000) return;\n+    if (consensusParams.vDeployments[id].timeoutheight == Consensus::VBitsDeployment::NEVER_ACTIVE) return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590588126",
      "id" : 590588126,
      "in_reply_to_id" : 590347074,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MDU4ODEyNg==",
      "original_commit_id" : "7e47c280b7b5597e4a259f4d4b50d661fccd061a",
      "original_line" : 1230,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 607693202,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590588126",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Here you go, a BIP 8 delayed activation functional test for your cherry-picking: https://github.com/Sjors/bitcoin/commits/2021/03/bip8-speedy-trial-test\r\n\r\nCherry picked.",
      "created_at" : "2021-03-09T17:48:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-794224457",
      "id" : 794224457,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5NDIyNDQ1Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-09T17:48:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/794224457",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590674111"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590674111"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't think this affects anything other than the docs?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-09T19:54:07Z",
      "diff_hunk" : "@@ -0,0 +1,7 @@\n+Low-level changes\n+=================\n+\n+RPC\n+---\n+\n+* BIP 9 has been replaced with a partial implementation of BIP 8. This change is reflected in `getblockchaininfo` where references to BIP 9 have been replaced with references to BIP 8.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590674111",
      "id" : 590674111,
      "line" : 7,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MDY3NDExMQ==",
      "original_commit_id" : "968bc1e07b4a8a359876f5b8035fb4c369d04bad",
      "original_line" : 7,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "doc/release-notes-21392.md",
      "position" : 7,
      "pull_request_review_id" : 607868995,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590674111",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Linter complains `'time' imported but unused`; my bad, I needed that import during an intermediate struggle (when generating coins on node 1, node 2 refused to sync).",
      "created_at" : "2021-03-09T20:09:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-794391494",
      "id" : 794391494,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5NDM5MTQ5NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-09T20:09:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/794391494",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590687298"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590687298"
         }
      },
      "author_association" : "MEMBER",
      "body" : "~No~ yes, taproot is always active on regtest: https://github.com/bitcoin/bitcoin/blob/968bc1e07b4a8a359876f5b8035fb4c369d04bad/src/chainparams.cpp#L418\r\n\r\nThis had me massively confused ~too~, but you can tell from `testmempoolaccept` if you manually craft a (broken) taproot transaction: https://github.com/BitMEXResearch/forkmonitor/blob/master/spec/models/chaintip_spec.rb#L377 (`mempool_broken_tap` is created by node A, which has no extra_args: https://github.com/BitMEXResearch/forkmonitor/blob/master/spec/models/chaintip_spec.rb#L22)",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-09T20:14:55Z",
      "diff_hunk" : "@@ -1201,7 +1201,7 @@ def set_test_params(self):\n         self.num_nodes = 2\n         self.setup_clean_chain = True\n         # Node 0 has Taproot inactive, Node 1 active.\n-        self.extra_args = [[\"-par=1\", \"-vbparams=taproot:1:1\"], [\"-par=1\"]]\n+        self.extra_args = [[\"-par=1\", \"-vbparams=taproot:@1:@1\"], [\"-par=1\"]]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590687298",
      "id" : 590687298,
      "in_reply_to_id" : 590349951,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MDY4NzI5OA==",
      "original_commit_id" : "7e47c280b7b5597e4a259f4d4b50d661fccd061a",
      "original_line" : 1204,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/feature_taproot.py",
      "position" : null,
      "pull_request_review_id" : 607911197,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590687298",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590689363"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590689363"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ah crap, was reading the brackets wrong. Nvm. This is why I like to indent stuff :-)",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-09T20:18:03Z",
      "diff_hunk" : "@@ -1201,7 +1201,7 @@ def set_test_params(self):\n         self.num_nodes = 2\n         self.setup_clean_chain = True\n         # Node 0 has Taproot inactive, Node 1 active.\n-        self.extra_args = [[\"-par=1\", \"-vbparams=taproot:1:1\"], [\"-par=1\"]]\n+        self.extra_args = [[\"-par=1\", \"-vbparams=taproot:@1:@1\"], [\"-par=1\"]]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r590689363",
      "id" : 590689363,
      "in_reply_to_id" : 590349951,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MDY4OTM2Mw==",
      "original_commit_id" : "7e47c280b7b5597e4a259f4d4b50d661fccd061a",
      "original_line" : 1204,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/feature_taproot.py",
      "position" : null,
      "pull_request_review_id" : 607917745,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/590689363",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Fixed the linter",
      "created_at" : "2021-03-09T20:30:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-794414561",
      "id" : 794414561,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5NDQxNDU2MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-09T20:30:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/794414561",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r591524815"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591524815"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why are you dropping all tests for `DEFINED -> FAILED` and `DEFINED -> STARTED -> FAILED`?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-10T13:47:31Z",
      "diff_hunk" : "@@ -178,65 +178,40 @@ BOOST_FIXTURE_TEST_SUITE(versionbits_tests, TestingSetup)\n BOOST_AUTO_TEST_CASE(versionbits_test)\n {\n     for (int i = 0; i < 64; i++) {\n-        // DEFINED -> FAILED",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r591524815",
      "id" : 591524815,
      "line" : 160,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MTUyNDgxNQ==",
      "original_commit_id" : "d4c40a52cdc0e07647b6543427e621585028fcdd",
      "original_line" : 160,
      "original_position" : 41,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 138,
      "pull_request_review_id" : 608728480,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591524815",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r591529768"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591529768"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why the switch from mainnet to regtest here?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-10T13:52:11Z",
      "diff_hunk" : "@@ -284,100 +259,67 @@ BOOST_AUTO_TEST_CASE(versionbits_params)\n BOOST_AUTO_TEST_CASE(versionbits_computeblockversion)\n {\n     // Check that ComputeBlockVersion will set the appropriate bit correctly\n-    // on mainnet.\n-    const auto chainParams = CreateChainParams(*m_node.args, CBaseChainParams::MAIN);\n+    const auto period = CreateChainParams(*m_node.args, CBaseChainParams::REGTEST)->GetConsensus().nMinerConfirmationWindow;\n+    gArgs.ForceSetArg(\"-vbparams\", strprintf(\"testdummy:@%s:@%s\", period, period * 2));\n+    const auto chainParams = CreateChainParams(*m_node.args, CBaseChainParams::REGTEST);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r591529768",
      "id" : 591529768,
      "line" : 282,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MTUyOTc2OA==",
      "original_commit_id" : "d4c40a52cdc0e07647b6543427e621585028fcdd",
      "original_line" : 282,
      "original_position" : 147,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 283,
      "pull_request_review_id" : 608728480,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591529768",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r591731487"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591731487"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This change is from #19573. I believe it is dropped because BIP 8 specifies that the timeoutheight falls on a retarget block greater than the startheight, so this scenario is supposed to be impossible to occur. With BIP 9, it was possible because there was no guarantee of the number of blocks between the start time and timeout time, but with height, the number of blocks is guaranteed.\r\n\r\n`DEFINE -> STARTED -> FAILED` is still there though. I suppose you mean `DEFINED -> STARTED -> Failed while threshold reached`? In that case, it's because the timeout height is supposed to fall on a retarget block so if the threshold is reached, it will always move to the locked in state.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-10T17:38:16Z",
      "diff_hunk" : "@@ -178,65 +178,40 @@ BOOST_FIXTURE_TEST_SUITE(versionbits_tests, TestingSetup)\n BOOST_AUTO_TEST_CASE(versionbits_test)\n {\n     for (int i = 0; i < 64; i++) {\n-        // DEFINED -> FAILED",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r591731487",
      "id" : 591731487,
      "in_reply_to_id" : 591524815,
      "line" : 160,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MTczMTQ4Nw==",
      "original_commit_id" : "d4c40a52cdc0e07647b6543427e621585028fcdd",
      "original_line" : 160,
      "original_position" : 41,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 138,
      "pull_request_review_id" : 608988516,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591731487",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r591734947"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591734947"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I believe this change was done so that custom activation parameters could be used. Specifically, since mainnet start and timeout heights are in the hundreds of thousands of blocks, the test would just be wasting time building up a chain to reach that those heights. With regtest, it can use a way lower height so the test runs in a timely fashion.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-10T17:43:09Z",
      "diff_hunk" : "@@ -284,100 +259,67 @@ BOOST_AUTO_TEST_CASE(versionbits_params)\n BOOST_AUTO_TEST_CASE(versionbits_computeblockversion)\n {\n     // Check that ComputeBlockVersion will set the appropriate bit correctly\n-    // on mainnet.\n-    const auto chainParams = CreateChainParams(*m_node.args, CBaseChainParams::MAIN);\n+    const auto period = CreateChainParams(*m_node.args, CBaseChainParams::REGTEST)->GetConsensus().nMinerConfirmationWindow;\n+    gArgs.ForceSetArg(\"-vbparams\", strprintf(\"testdummy:@%s:@%s\", period, period * 2));\n+    const auto chainParams = CreateChainParams(*m_node.args, CBaseChainParams::REGTEST);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r591734947",
      "id" : 591734947,
      "in_reply_to_id" : 591529768,
      "line" : 282,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MTczNDk0Nw==",
      "original_commit_id" : "d4c40a52cdc0e07647b6543427e621585028fcdd",
      "original_line" : 282,
      "original_position" : 147,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 283,
      "pull_request_review_id" : 608993233,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591734947",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r592231394"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592231394"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I guess the better question is: why did it use mainnet in the past?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-11T10:13:58Z",
      "diff_hunk" : "@@ -284,100 +259,67 @@ BOOST_AUTO_TEST_CASE(versionbits_params)\n BOOST_AUTO_TEST_CASE(versionbits_computeblockversion)\n {\n     // Check that ComputeBlockVersion will set the appropriate bit correctly\n-    // on mainnet.\n-    const auto chainParams = CreateChainParams(*m_node.args, CBaseChainParams::MAIN);\n+    const auto period = CreateChainParams(*m_node.args, CBaseChainParams::REGTEST)->GetConsensus().nMinerConfirmationWindow;\n+    gArgs.ForceSetArg(\"-vbparams\", strprintf(\"testdummy:@%s:@%s\", period, period * 2));\n+    const auto chainParams = CreateChainParams(*m_node.args, CBaseChainParams::REGTEST);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r592231394",
      "id" : 592231394,
      "in_reply_to_id" : 591529768,
      "line" : 282,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjIzMTM5NA==",
      "original_commit_id" : "d4c40a52cdc0e07647b6543427e621585028fcdd",
      "original_line" : 282,
      "original_position" : 147,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 283,
      "pull_request_review_id" : 609595315,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592231394",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r592588076"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592588076"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I guess it was convenient and doesn't really matter when the time can be faked?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-11T18:10:05Z",
      "diff_hunk" : "@@ -284,100 +259,67 @@ BOOST_AUTO_TEST_CASE(versionbits_params)\n BOOST_AUTO_TEST_CASE(versionbits_computeblockversion)\n {\n     // Check that ComputeBlockVersion will set the appropriate bit correctly\n-    // on mainnet.\n-    const auto chainParams = CreateChainParams(*m_node.args, CBaseChainParams::MAIN);\n+    const auto period = CreateChainParams(*m_node.args, CBaseChainParams::REGTEST)->GetConsensus().nMinerConfirmationWindow;\n+    gArgs.ForceSetArg(\"-vbparams\", strprintf(\"testdummy:@%s:@%s\", period, period * 2));\n+    const auto chainParams = CreateChainParams(*m_node.args, CBaseChainParams::REGTEST);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r592588076",
      "id" : 592588076,
      "in_reply_to_id" : 591529768,
      "line" : 282,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjU4ODA3Ng==",
      "original_commit_id" : "d4c40a52cdc0e07647b6543427e621585028fcdd",
      "original_line" : 282,
      "original_position" : 147,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 283,
      "pull_request_review_id" : 610075033,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592588076",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r592872804"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592872804"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I figured the theory was \"if you're going to test anything, test what's going to happen on mainnet\". Since there's no proof of work in the versionbits unit test, it might be reasonable to test with real heights -- it's just building a skiplist with half a million entries to get to the start height, and going from there?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-12T02:46:19Z",
      "diff_hunk" : "@@ -284,100 +259,67 @@ BOOST_AUTO_TEST_CASE(versionbits_params)\n BOOST_AUTO_TEST_CASE(versionbits_computeblockversion)\n {\n     // Check that ComputeBlockVersion will set the appropriate bit correctly\n-    // on mainnet.\n-    const auto chainParams = CreateChainParams(*m_node.args, CBaseChainParams::MAIN);\n+    const auto period = CreateChainParams(*m_node.args, CBaseChainParams::REGTEST)->GetConsensus().nMinerConfirmationWindow;\n+    gArgs.ForceSetArg(\"-vbparams\", strprintf(\"testdummy:@%s:@%s\", period, period * 2));\n+    const auto chainParams = CreateChainParams(*m_node.args, CBaseChainParams::REGTEST);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r592872804",
      "id" : 592872804,
      "in_reply_to_id" : 591529768,
      "line" : 282,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5Mjg3MjgwNA==",
      "original_commit_id" : "d4c40a52cdc0e07647b6543427e621585028fcdd",
      "original_line" : 282,
      "original_position" : 147,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 283,
      "pull_request_review_id" : 610409091,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592872804",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "There are some compiler warnings for me (GCC 9.3.0).\r\n```\r\ntest/fuzz/versionbits.cpp: In function void versionbits_fuzz_target(FuzzBufferType):\r\ntest/fuzz/versionbits.cpp:150:37: warning: *((void*)& last_stats +16) may be used uninitialized in this function [-Wmaybe-uninitialized]\r\n  150 |                     if (last_stats->possible) {\r\n      |                         ~~~~~~~~~~~~^~~~~~~~\r\ntest/fuzz/versionbits.cpp:149:97: warning: last_stats.VBitsStats::count may be used uninitialized in this function [-Wmaybe-uninitialized]\r\n  149 |                     assert(stats.count == last_stats->count || stats.count == last_stats->count + 1);\r\n      |                                                                                                 ^\r\ntest/fuzz/versionbits.cpp:127:35: warning: last_stats.VBitsStats::elapsed may be used uninitialized in this function [-Wmaybe-uninitialized]\r\n  127 |                 assert(last_stats && last_stats->elapsed == period - 1);\r\n      |                                   ^~\r\n```",
      "created_at" : "2021-03-12T10:06:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-797382764",
      "id" : 797382764,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5NzM4Mjc2NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-12T10:06:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/797382764",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4500994?v=4",
         "events_url" : "https://api.github.com/users/kristapsk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kristapsk/followers",
         "following_url" : "https://api.github.com/users/kristapsk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kristapsk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kristapsk",
         "id" : 4500994,
         "login" : "kristapsk",
         "node_id" : "MDQ6VXNlcjQ1MDA5OTQ=",
         "organizations_url" : "https://api.github.com/users/kristapsk/orgs",
         "received_events_url" : "https://api.github.com/users/kristapsk/received_events",
         "repos_url" : "https://api.github.com/users/kristapsk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kristapsk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kristapsk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kristapsk"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> There are some compiler warnings for me (GCC 9.3.0).\r\n\r\nI believe these are caused by the changes from #21380.\r\n",
      "created_at" : "2021-03-12T17:55:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-797656298",
      "id" : 797656298,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5NzY1NjI5OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-12T17:55:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/797656298",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Hmm, I'm not seeing those warnings, and I think all those statements are protected by an `if (last_stats)` which should ensure it's initialised.",
      "created_at" : "2021-03-13T04:54:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-797866949",
      "id" : 797866949,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5Nzg2Njk0OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-13T04:54:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/797866949",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I see this warnings with gcc 10.2.0",
      "created_at" : "2021-03-13T05:49:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-797872796",
      "id" : 797872796,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5Nzg3Mjc5Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-13T05:49:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/797872796",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Apparently I wasn't seeing those warnings because my fuzz things were being compiled with `-O0`... Seems to be a gcc bug not handling optional very well to me ([80635](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=80635) maybe?) but it's easy enough to not use an optional here, so I've added a patch to do that.",
      "created_at" : "2021-03-14T00:59:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-798810300",
      "id" : 798810300,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5ODgxMDMwMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-14T00:59:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/798810300",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593823167"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593823167"
         }
      },
      "author_association" : "MEMBER",
      "body" : "We had discussed delaying the member/variable renames until after the actual logic changes for better backport/merge/review, and I thought that was a good idea. Are you planning to take that out of the PR? Been waiting to review pending on that...",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T01:07:16Z",
      "diff_hunk" : "@@ -189,22 +193,26 @@ class CTestNetParams : public CChainParams {\n         consensus.BIP66Height = 330776; // 000000002104c8c45e99a8853285a3b592602a3ccde2b832481da85e9e4ba182\n         consensus.CSVHeight = 770112; // 00000000025e930139bac5c6c31a403776da130831ab85be56578f3fa75369bb\n         consensus.SegwitHeight = 834624; // 00000000002b980fcd729daaa248fd9316a5200e9b367f4ff2c42453e84201ca\n-        consensus.MinBIP9WarningHeight = 836640; // segwit activation height + miner confirmation window\n+        consensus.MinVBitsWarningHeight = 836640; // segwit activation height + miner confirmation window",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593823167",
      "id" : 593823167,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzgyMzE2Nw==",
      "original_commit_id" : "7ff01fb91960b029f67fde68de6a9ea0178c8ab3",
      "original_line" : 196,
      "original_position" : 38,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 607868995,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593823167",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593824356"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593824356"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`getblockchaininfo` has a `bip9` field that is changed to `bip8`. This only effects signet and regtest though since those are the only ones that have taproot show up in `getblockchaininfo`.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T01:22:20Z",
      "diff_hunk" : "@@ -0,0 +1,7 @@\n+Low-level changes\n+=================\n+\n+RPC\n+---\n+\n+* BIP 9 has been replaced with a partial implementation of BIP 8. This change is reflected in `getblockchaininfo` where references to BIP 9 have been replaced with references to BIP 8.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593824356",
      "id" : 593824356,
      "in_reply_to_id" : 590674111,
      "line" : 7,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzgyNDM1Ng==",
      "original_commit_id" : "968bc1e07b4a8a359876f5b8035fb4c369d04bad",
      "original_line" : 7,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "doc/release-notes-21392.md",
      "position" : 7,
      "pull_request_review_id" : 611650708,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593824356",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593824410"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593824410"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oh yeah, forgot to do that. I've removed the rename commit that I added in this PR, but #21380 also has a rename commit and it's up to @ajtowns to remove that if desired.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T01:23:07Z",
      "diff_hunk" : "@@ -189,22 +193,26 @@ class CTestNetParams : public CChainParams {\n         consensus.BIP66Height = 330776; // 000000002104c8c45e99a8853285a3b592602a3ccde2b832481da85e9e4ba182\n         consensus.CSVHeight = 770112; // 00000000025e930139bac5c6c31a403776da130831ab85be56578f3fa75369bb\n         consensus.SegwitHeight = 834624; // 00000000002b980fcd729daaa248fd9316a5200e9b367f4ff2c42453e84201ca\n-        consensus.MinBIP9WarningHeight = 836640; // segwit activation height + miner confirmation window\n+        consensus.MinVBitsWarningHeight = 836640; // segwit activation height + miner confirmation window",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593824410",
      "id" : 593824410,
      "in_reply_to_id" : 593823167,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzgyNDQxMA==",
      "original_commit_id" : "7ff01fb91960b029f67fde68de6a9ea0178c8ab3",
      "original_line" : 196,
      "original_position" : 38,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 611650741,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593824410",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593838402"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593838402"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Missing the new `min_activation_height`",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T04:08:12Z",
      "diff_hunk" : "@@ -492,22 +509,25 @@ void CRegTestParams::UpdateActivationParametersFromArgs(const ArgsManager& args)\n     for (const std::string& strDeployment : args.GetArgs(\"-vbparams\")) {\n         std::vector<std::string> vDeploymentParams;\n         boost::split(vDeploymentParams, strDeployment, boost::is_any_of(\":\"));\n-        if (vDeploymentParams.size() != 3) {\n-            throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:start:end\");\n+        if (vDeploymentParams.size() < 3 || vDeploymentParams.size() > 4) {\n+            throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:@start_height:@timeout_height[:@min_activation_height]\");\n         }\n-        int64_t nStartTime, nTimeout;\n-        if (!ParseInt64(vDeploymentParams[1], &nStartTime)) {\n-            throw std::runtime_error(strprintf(\"Invalid nStartTime (%s)\", vDeploymentParams[1]));\n+        int64_t start_height = 0, timeout_height = 0, min_activation_height = 0;\n+        if (vDeploymentParams[1].empty() || vDeploymentParams[1].front() != '@' || !ParseInt64(vDeploymentParams[1].substr(1), &start_height)) {\n+            throw std::runtime_error(strprintf(\"Invalid start_height (%s)\", vDeploymentParams[1]));\n         }\n-        if (!ParseInt64(vDeploymentParams[2], &nTimeout)) {\n-            throw std::runtime_error(strprintf(\"Invalid nTimeout (%s)\", vDeploymentParams[2]));\n+        if (vDeploymentParams[2].empty() || vDeploymentParams[2].front() != '@' || !ParseInt64(vDeploymentParams[2].substr(1), &timeout_height)) {\n+            throw std::runtime_error(strprintf(\"Invalid timeout_height (%s)\", vDeploymentParams[2]));\n+        }\n+        if (vDeploymentParams.size() == 4 && (vDeploymentParams[3].front() != '@' || !ParseInt64(vDeploymentParams[3].substr(1), &min_activation_height))) {\n+            throw std::runtime_error(strprintf(\"Invalid min_activation_height (%s)\", vDeploymentParams[3]));\n         }\n         bool found = false;\n         for (int j=0; j < (int)Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++j) {\n             if (vDeploymentParams[0] == VersionBitsDeploymentInfo[j].name) {\n-                UpdateVersionBitsParameters(Consensus::DeploymentPos(j), nStartTime, nTimeout);\n+                UpdateVersionBitsParameters(Consensus::DeploymentPos(j), start_height, timeout_height, min_activation_height);\n                 found = true;\n-                LogPrintf(\"Setting version bits activation parameters for %s to start=%ld, timeout=%ld\\n\", vDeploymentParams[0], nStartTime, nTimeout);\n+                LogPrintf(\"Setting version bits activation parameters for %s to start_height=%ld, timeout_height=%ld\\n\", vDeploymentParams[0], start_height, timeout_height);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593838402",
      "id" : 593838402,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzgzODQwMg==",
      "original_commit_id" : "9f98cf7dfb11a852b1092ead5af4c400ae82e21d",
      "original_line" : 530,
      "original_position" : 150,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 611657500,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593838402",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593838439"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593838439"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm not sure it's a good idea to use underscores here when everything else uses `startheight`",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T04:08:51Z",
      "diff_hunk" : "@@ -492,22 +509,25 @@ void CRegTestParams::UpdateActivationParametersFromArgs(const ArgsManager& args)\n     for (const std::string& strDeployment : args.GetArgs(\"-vbparams\")) {\n         std::vector<std::string> vDeploymentParams;\n         boost::split(vDeploymentParams, strDeployment, boost::is_any_of(\":\"));\n-        if (vDeploymentParams.size() != 3) {\n-            throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:start:end\");\n+        if (vDeploymentParams.size() < 3 || vDeploymentParams.size() > 4) {\n+            throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:@start_height:@timeout_height[:@min_activation_height]\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593838439",
      "id" : 593838439,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzgzODQzOQ==",
      "original_commit_id" : "9f98cf7dfb11a852b1092ead5af4c400ae82e21d",
      "original_line" : 513,
      "original_position" : 126,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 611657500,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593838439",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593838512"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593838512"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`{0}` here can avoid needing to initialise it everywhere it isn't used (and reduce the risk of ever forgetting to do so)",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T04:09:44Z",
      "diff_hunk" : "@@ -22,22 +22,31 @@ enum DeploymentPos\n /**\n  * Struct for each individual consensus rule change using BIP9.\n  */\n-struct BIP9Deployment {\n+struct VBitsDeployment {\n     /** Bit position to select the particular bit in nVersion. */\n     int bit;\n-    /** Start MedianTime for version bits miner confirmation. Can be a date in the past */\n-    int64_t nStartTime;\n-    /** Timeout/expiry MedianTime for the deployment attempt. */\n-    int64_t nTimeout;\n+    /** Start block height for version bits miner confirmation. Must be a retarget block, can be in the past. */\n+    int startheight;\n+    /** Timeout/expiry block height for the deployment attempt. Must be a retarget block. */\n+    int timeoutheight;\n+    /** Threshold for activation */\n+    int threshold;\n+    /**\n+     * If lock in occurs, delay activation until at least this block height. Activations only occur on retargets.\n+     */\n+    int64_t m_min_activation_height;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593838512",
      "id" : 593838512,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzgzODUxMg==",
      "original_commit_id" : "9f98cf7dfb11a852b1092ead5af4c400ae82e21d",
      "original_line" : 37,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/consensus/params.h",
      "position" : null,
      "pull_request_review_id" : 611657500,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593838512",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593838593"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593838593"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`height_active_min` might be more consistent with the other variables.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T04:10:31Z",
      "diff_hunk" : "@@ -5,15 +5,21 @@\n #include <versionbits.h>\n #include <consensus/params.h>\n \n-ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex* pindexPrev, const Consensus::Params& params, ThresholdConditionCache& cache) const\n+ThresholdState ThresholdConditionChecker::GetStateFor(const CBlockIndex* pindexPrev, ThresholdConditionCache& cache) const\n {\n-    int nPeriod = Period(params);\n-    int nThreshold = Threshold(params);\n-    int64_t nTimeStart = BeginTime(params);\n-    int64_t nTimeTimeout = EndTime(params);\n+    int nPeriod = m_period;\n+    int nThreshold = m_dep.threshold;\n+    int64_t height_start = m_dep.startheight;\n+    int64_t height_timeout = m_dep.timeoutheight;\n+    int64_t min_activation_height = m_dep.m_min_activation_height;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593838593",
      "id" : 593838593,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzgzODU5Mw==",
      "original_commit_id" : "9f98cf7dfb11a852b1092ead5af4c400ae82e21d",
      "original_line" : 14,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 611657500,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593838593",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593838630"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593838630"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: space",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T04:11:06Z",
      "diff_hunk" : "@@ -26,35 +26,65 @@ static const std::string StateName(ThresholdState state)\n     return \"\";\n }\n \n-static const Consensus::Params paramsDummy = Consensus::Params();\n-\n-class TestConditionChecker : public AbstractThresholdConditionChecker\n+class TestConditionChecker : public ThresholdConditionChecker\n {\n private:\n     mutable ThresholdConditionCache cache;\n \n+protected:\n+    Consensus::VBitsDeployment m_dep_storage;\n+\n public:\n-    int64_t BeginTime(const Consensus::Params& params) const override { return TestTime(10000); }\n-    int64_t EndTime(const Consensus::Params& params) const override { return TestTime(20000); }\n-    int Period(const Consensus::Params& params) const override { return 1000; }\n-    int Threshold(const Consensus::Params& params) const override { return 900; }\n-    bool Condition(const CBlockIndex* pindex, const Consensus::Params& params) const override { return (pindex->nVersion & 0x100); }\n-\n-    ThresholdState GetStateFor(const CBlockIndex* pindexPrev) const { return AbstractThresholdConditionChecker::GetStateFor(pindexPrev, paramsDummy, cache); }\n-    int GetStateSinceHeightFor(const CBlockIndex* pindexPrev) const { return AbstractThresholdConditionChecker::GetStateSinceHeightFor(pindexPrev, paramsDummy, cache); }\n+    TestConditionChecker() : ThresholdConditionChecker(m_dep_storage, 10)\n+    {\n+        m_dep_storage.bit = 8;\n+        m_dep_storage.startheight= 100;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593838630",
      "id" : 593838630,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzgzODYzMA==",
      "original_commit_id" : "9f98cf7dfb11a852b1092ead5af4c400ae82e21d",
      "original_line" : 41,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 611657500,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593838630",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593839228"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593839228"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`-vbparams` has been extended to accept min activation height, but the doc here isn't updated with it.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T04:18:42Z",
      "diff_hunk" : "@@ -23,7 +23,7 @@ void SetupChainParamsBaseOptions(ArgsManager& argsman)\n                  \"This is intended for regression testing tools and app development. Equivalent to -chain=regtest.\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n     argsman.AddArg(\"-segwitheight=<n>\", \"Set the activation height of segwit. -1 to disable. (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);\n     argsman.AddArg(\"-testnet\", \"Use the test chain. Equivalent to -chain=test.\", ArgsManager::ALLOW_ANY, OptionsCategory::CHAINPARAMS);\n-    argsman.AddArg(\"-vbparams=deployment:start:end\", \"Use given start/end times for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n+    argsman.AddArg(\"-vbparams=deployment:@startheight:@timeoutheight\", \"Use given start/timeout heights for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593839228",
      "id" : 593839228,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzgzOTIyOA==",
      "original_commit_id" : "9f98cf7dfb11a852b1092ead5af4c400ae82e21d",
      "original_line" : 26,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/chainparamsbase.cpp",
      "position" : null,
      "pull_request_review_id" : 611657938,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593839228",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593839452"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593839452"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: extra space",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T04:21:33Z",
      "diff_hunk" : "@@ -5,15 +5,21 @@\n #include <versionbits.h>\n #include <consensus/params.h>\n \n-ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex* pindexPrev, const Consensus::Params& params, ThresholdConditionCache& cache) const\n+ThresholdState ThresholdConditionChecker::GetStateFor(const CBlockIndex* pindexPrev, ThresholdConditionCache& cache) const\n {\n-    int nPeriod = Period(params);\n-    int nThreshold = Threshold(params);\n-    int64_t nTimeStart = BeginTime(params);\n-    int64_t nTimeTimeout = EndTime(params);\n+    int nPeriod = m_period;\n+    int nThreshold = m_dep.threshold;\n+    int64_t height_start = m_dep.startheight;\n+    int64_t height_timeout = m_dep.timeoutheight;\n+    int64_t min_activation_height = m_dep.m_min_activation_height;\n+\n+    // Check if this deployment is never active.\n+    if (height_start == Consensus::VBitsDeployment::NEVER_ACTIVE && height_timeout == Consensus::VBitsDeployment::NEVER_ACTIVE ) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593839452",
      "id" : 593839452,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzgzOTQ1Mg==",
      "original_commit_id" : "9f98cf7dfb11a852b1092ead5af4c400ae82e21d",
      "original_line" : 17,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 611658059,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593839452",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593887517"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593887517"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: s/retarteting/retargeting",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T11:47:49Z",
      "diff_hunk" : "@@ -0,0 +1,126 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class Bip8Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        self.setup_clean_chain = True\n+        # Node 0 has TestDummy inactive\n+        # Node 1 has a regular activation window\n+        # Node 2 uses speedy trial.\n+        self.extra_args = [\n+            [f'-vbparams=testdummy:@1:@1'],\n+            [f'-vbparams=testdummy:@144:@{144 * 3}'],\n+            [f'-vbparams=testdummy:@144:@{144 * 2}:@{144 * 4}'],\n+        ]\n+\n+    def run_test(self):\n+        self.log.info(\"Test status at genesis...\")\n+        for i, node in enumerate(self.nodes):\n+            self.log.debug(f'Node #{ i }...')\n+            info = node.getblockchaininfo()\n+            assert_equal(info['blocks'], 0)\n+            assert_equal(info[\"softforks\"][\"testdummy\"][\"bip8\"][\"status\"], \"defined\")\n+\n+        # BIP 8 state transitions from \"defined\" to \"started\" or \"failed\" after\n+        # the last block of the retargeting period has been mined. This means\n+        # any new rules apply to transactions currently in the mempool, which\n+        # might be mined in the next block.\n+        #\n+        # The next retarteting period starts at block 144, so nothing should",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593887517",
      "id" : 593887517,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5Mzg4NzUxNw==",
      "original_commit_id" : "9f98cf7dfb11a852b1092ead5af4c400ae82e21d",
      "original_line" : 35,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "test/functional/feature_bip8.py",
      "position" : null,
      "pull_request_review_id" : 611687104,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593887517",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593922180"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593922180"
         }
      },
      "author_association" : "MEMBER",
      "body" : "(and below) f''should be avoided to make backport to 0.21 nicer\r\n\r\n",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T16:01:28Z",
      "diff_hunk" : "@@ -0,0 +1,126 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class Bip8Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        self.setup_clean_chain = True\n+        # Node 0 has TestDummy inactive\n+        # Node 1 has a regular activation window\n+        # Node 2 uses speedy trial.\n+        self.extra_args = [\n+            [f'-vbparams=testdummy:@1:@1'],\n+            [f'-vbparams=testdummy:@144:@{144 * 3}'],\n+            [f'-vbparams=testdummy:@144:@{144 * 2}:@{144 * 4}'],",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593922180",
      "id" : 593922180,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzkyMjE4MA==",
      "original_commit_id" : "9f98cf7dfb11a852b1092ead5af4c400ae82e21d",
      "original_line" : 19,
      "original_position" : 19,
      "original_start_line" : 17,
      "path" : "test/functional/feature_bip8.py",
      "position" : null,
      "pull_request_review_id" : 611711166,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593922180",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593937167"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593937167"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T17:53:15Z",
      "diff_hunk" : "@@ -492,22 +509,25 @@ void CRegTestParams::UpdateActivationParametersFromArgs(const ArgsManager& args)\n     for (const std::string& strDeployment : args.GetArgs(\"-vbparams\")) {\n         std::vector<std::string> vDeploymentParams;\n         boost::split(vDeploymentParams, strDeployment, boost::is_any_of(\":\"));\n-        if (vDeploymentParams.size() != 3) {\n-            throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:start:end\");\n+        if (vDeploymentParams.size() < 3 || vDeploymentParams.size() > 4) {\n+            throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:@start_height:@timeout_height[:@min_activation_height]\");\n         }\n-        int64_t nStartTime, nTimeout;\n-        if (!ParseInt64(vDeploymentParams[1], &nStartTime)) {\n-            throw std::runtime_error(strprintf(\"Invalid nStartTime (%s)\", vDeploymentParams[1]));\n+        int64_t start_height = 0, timeout_height = 0, min_activation_height = 0;\n+        if (vDeploymentParams[1].empty() || vDeploymentParams[1].front() != '@' || !ParseInt64(vDeploymentParams[1].substr(1), &start_height)) {\n+            throw std::runtime_error(strprintf(\"Invalid start_height (%s)\", vDeploymentParams[1]));\n         }\n-        if (!ParseInt64(vDeploymentParams[2], &nTimeout)) {\n-            throw std::runtime_error(strprintf(\"Invalid nTimeout (%s)\", vDeploymentParams[2]));\n+        if (vDeploymentParams[2].empty() || vDeploymentParams[2].front() != '@' || !ParseInt64(vDeploymentParams[2].substr(1), &timeout_height)) {\n+            throw std::runtime_error(strprintf(\"Invalid timeout_height (%s)\", vDeploymentParams[2]));\n+        }\n+        if (vDeploymentParams.size() == 4 && (vDeploymentParams[3].front() != '@' || !ParseInt64(vDeploymentParams[3].substr(1), &min_activation_height))) {\n+            throw std::runtime_error(strprintf(\"Invalid min_activation_height (%s)\", vDeploymentParams[3]));\n         }\n         bool found = false;\n         for (int j=0; j < (int)Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++j) {\n             if (vDeploymentParams[0] == VersionBitsDeploymentInfo[j].name) {\n-                UpdateVersionBitsParameters(Consensus::DeploymentPos(j), nStartTime, nTimeout);\n+                UpdateVersionBitsParameters(Consensus::DeploymentPos(j), start_height, timeout_height, min_activation_height);\n                 found = true;\n-                LogPrintf(\"Setting version bits activation parameters for %s to start=%ld, timeout=%ld\\n\", vDeploymentParams[0], nStartTime, nTimeout);\n+                LogPrintf(\"Setting version bits activation parameters for %s to start_height=%ld, timeout_height=%ld\\n\", vDeploymentParams[0], start_height, timeout_height);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593937167",
      "id" : 593937167,
      "in_reply_to_id" : 593838402,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzkzNzE2Nw==",
      "original_commit_id" : "9f98cf7dfb11a852b1092ead5af4c400ae82e21d",
      "original_line" : 530,
      "original_position" : 150,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 611721448,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593937167",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593937173"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593937173"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T17:53:21Z",
      "diff_hunk" : "@@ -492,22 +509,25 @@ void CRegTestParams::UpdateActivationParametersFromArgs(const ArgsManager& args)\n     for (const std::string& strDeployment : args.GetArgs(\"-vbparams\")) {\n         std::vector<std::string> vDeploymentParams;\n         boost::split(vDeploymentParams, strDeployment, boost::is_any_of(\":\"));\n-        if (vDeploymentParams.size() != 3) {\n-            throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:start:end\");\n+        if (vDeploymentParams.size() < 3 || vDeploymentParams.size() > 4) {\n+            throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:@start_height:@timeout_height[:@min_activation_height]\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593937173",
      "id" : 593937173,
      "in_reply_to_id" : 593838439,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzkzNzE3Mw==",
      "original_commit_id" : "9f98cf7dfb11a852b1092ead5af4c400ae82e21d",
      "original_line" : 513,
      "original_position" : 126,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 611721455,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593937173",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593937178"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593937178"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T17:53:25Z",
      "diff_hunk" : "@@ -22,22 +22,31 @@ enum DeploymentPos\n /**\n  * Struct for each individual consensus rule change using BIP9.\n  */\n-struct BIP9Deployment {\n+struct VBitsDeployment {\n     /** Bit position to select the particular bit in nVersion. */\n     int bit;\n-    /** Start MedianTime for version bits miner confirmation. Can be a date in the past */\n-    int64_t nStartTime;\n-    /** Timeout/expiry MedianTime for the deployment attempt. */\n-    int64_t nTimeout;\n+    /** Start block height for version bits miner confirmation. Must be a retarget block, can be in the past. */\n+    int startheight;\n+    /** Timeout/expiry block height for the deployment attempt. Must be a retarget block. */\n+    int timeoutheight;\n+    /** Threshold for activation */\n+    int threshold;\n+    /**\n+     * If lock in occurs, delay activation until at least this block height. Activations only occur on retargets.\n+     */\n+    int64_t m_min_activation_height;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593937178",
      "id" : 593937178,
      "in_reply_to_id" : 593838512,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzkzNzE3OA==",
      "original_commit_id" : "9f98cf7dfb11a852b1092ead5af4c400ae82e21d",
      "original_line" : 37,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/consensus/params.h",
      "position" : null,
      "pull_request_review_id" : 611721460,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593937178",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593937199"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593937199"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T17:53:28Z",
      "diff_hunk" : "@@ -5,15 +5,21 @@\n #include <versionbits.h>\n #include <consensus/params.h>\n \n-ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex* pindexPrev, const Consensus::Params& params, ThresholdConditionCache& cache) const\n+ThresholdState ThresholdConditionChecker::GetStateFor(const CBlockIndex* pindexPrev, ThresholdConditionCache& cache) const\n {\n-    int nPeriod = Period(params);\n-    int nThreshold = Threshold(params);\n-    int64_t nTimeStart = BeginTime(params);\n-    int64_t nTimeTimeout = EndTime(params);\n+    int nPeriod = m_period;\n+    int nThreshold = m_dep.threshold;\n+    int64_t height_start = m_dep.startheight;\n+    int64_t height_timeout = m_dep.timeoutheight;\n+    int64_t min_activation_height = m_dep.m_min_activation_height;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593937199",
      "id" : 593937199,
      "in_reply_to_id" : 593838593,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzkzNzE5OQ==",
      "original_commit_id" : "9f98cf7dfb11a852b1092ead5af4c400ae82e21d",
      "original_line" : 14,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 611721469,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593937199",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593937219"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593937219"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T17:53:32Z",
      "diff_hunk" : "@@ -26,35 +26,65 @@ static const std::string StateName(ThresholdState state)\n     return \"\";\n }\n \n-static const Consensus::Params paramsDummy = Consensus::Params();\n-\n-class TestConditionChecker : public AbstractThresholdConditionChecker\n+class TestConditionChecker : public ThresholdConditionChecker\n {\n private:\n     mutable ThresholdConditionCache cache;\n \n+protected:\n+    Consensus::VBitsDeployment m_dep_storage;\n+\n public:\n-    int64_t BeginTime(const Consensus::Params& params) const override { return TestTime(10000); }\n-    int64_t EndTime(const Consensus::Params& params) const override { return TestTime(20000); }\n-    int Period(const Consensus::Params& params) const override { return 1000; }\n-    int Threshold(const Consensus::Params& params) const override { return 900; }\n-    bool Condition(const CBlockIndex* pindex, const Consensus::Params& params) const override { return (pindex->nVersion & 0x100); }\n-\n-    ThresholdState GetStateFor(const CBlockIndex* pindexPrev) const { return AbstractThresholdConditionChecker::GetStateFor(pindexPrev, paramsDummy, cache); }\n-    int GetStateSinceHeightFor(const CBlockIndex* pindexPrev) const { return AbstractThresholdConditionChecker::GetStateSinceHeightFor(pindexPrev, paramsDummy, cache); }\n+    TestConditionChecker() : ThresholdConditionChecker(m_dep_storage, 10)\n+    {\n+        m_dep_storage.bit = 8;\n+        m_dep_storage.startheight= 100;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593937219",
      "id" : 593937219,
      "in_reply_to_id" : 593838630,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzkzNzIxOQ==",
      "original_commit_id" : "9f98cf7dfb11a852b1092ead5af4c400ae82e21d",
      "original_line" : 41,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 611721481,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593937219",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593937221"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593937221"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T17:53:36Z",
      "diff_hunk" : "@@ -23,7 +23,7 @@ void SetupChainParamsBaseOptions(ArgsManager& argsman)\n                  \"This is intended for regression testing tools and app development. Equivalent to -chain=regtest.\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n     argsman.AddArg(\"-segwitheight=<n>\", \"Set the activation height of segwit. -1 to disable. (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);\n     argsman.AddArg(\"-testnet\", \"Use the test chain. Equivalent to -chain=test.\", ArgsManager::ALLOW_ANY, OptionsCategory::CHAINPARAMS);\n-    argsman.AddArg(\"-vbparams=deployment:start:end\", \"Use given start/end times for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n+    argsman.AddArg(\"-vbparams=deployment:@startheight:@timeoutheight\", \"Use given start/timeout heights for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593937221",
      "id" : 593937221,
      "in_reply_to_id" : 593839228,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzkzNzIyMQ==",
      "original_commit_id" : "9f98cf7dfb11a852b1092ead5af4c400ae82e21d",
      "original_line" : 26,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/chainparamsbase.cpp",
      "position" : null,
      "pull_request_review_id" : 611721486,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593937221",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593937243"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593937243"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T17:53:47Z",
      "diff_hunk" : "@@ -5,15 +5,21 @@\n #include <versionbits.h>\n #include <consensus/params.h>\n \n-ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex* pindexPrev, const Consensus::Params& params, ThresholdConditionCache& cache) const\n+ThresholdState ThresholdConditionChecker::GetStateFor(const CBlockIndex* pindexPrev, ThresholdConditionCache& cache) const\n {\n-    int nPeriod = Period(params);\n-    int nThreshold = Threshold(params);\n-    int64_t nTimeStart = BeginTime(params);\n-    int64_t nTimeTimeout = EndTime(params);\n+    int nPeriod = m_period;\n+    int nThreshold = m_dep.threshold;\n+    int64_t height_start = m_dep.startheight;\n+    int64_t height_timeout = m_dep.timeoutheight;\n+    int64_t min_activation_height = m_dep.m_min_activation_height;\n+\n+    // Check if this deployment is never active.\n+    if (height_start == Consensus::VBitsDeployment::NEVER_ACTIVE && height_timeout == Consensus::VBitsDeployment::NEVER_ACTIVE ) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593937243",
      "id" : 593937243,
      "in_reply_to_id" : 593839452,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzkzNzI0Mw==",
      "original_commit_id" : "9f98cf7dfb11a852b1092ead5af4c400ae82e21d",
      "original_line" : 17,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 611721496,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593937243",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593937250"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593937250"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T17:53:51Z",
      "diff_hunk" : "@@ -0,0 +1,126 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class Bip8Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        self.setup_clean_chain = True\n+        # Node 0 has TestDummy inactive\n+        # Node 1 has a regular activation window\n+        # Node 2 uses speedy trial.\n+        self.extra_args = [\n+            [f'-vbparams=testdummy:@1:@1'],\n+            [f'-vbparams=testdummy:@144:@{144 * 3}'],\n+            [f'-vbparams=testdummy:@144:@{144 * 2}:@{144 * 4}'],\n+        ]\n+\n+    def run_test(self):\n+        self.log.info(\"Test status at genesis...\")\n+        for i, node in enumerate(self.nodes):\n+            self.log.debug(f'Node #{ i }...')\n+            info = node.getblockchaininfo()\n+            assert_equal(info['blocks'], 0)\n+            assert_equal(info[\"softforks\"][\"testdummy\"][\"bip8\"][\"status\"], \"defined\")\n+\n+        # BIP 8 state transitions from \"defined\" to \"started\" or \"failed\" after\n+        # the last block of the retargeting period has been mined. This means\n+        # any new rules apply to transactions currently in the mempool, which\n+        # might be mined in the next block.\n+        #\n+        # The next retarteting period starts at block 144, so nothing should",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593937250",
      "id" : 593937250,
      "in_reply_to_id" : 593887517,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzkzNzI1MA==",
      "original_commit_id" : "9f98cf7dfb11a852b1092ead5af4c400ae82e21d",
      "original_line" : 35,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "test/functional/feature_bip8.py",
      "position" : null,
      "pull_request_review_id" : 611721500,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593937250",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593937260"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593937260"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-14T17:54:00Z",
      "diff_hunk" : "@@ -0,0 +1,126 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class Bip8Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        self.setup_clean_chain = True\n+        # Node 0 has TestDummy inactive\n+        # Node 1 has a regular activation window\n+        # Node 2 uses speedy trial.\n+        self.extra_args = [\n+            [f'-vbparams=testdummy:@1:@1'],\n+            [f'-vbparams=testdummy:@144:@{144 * 3}'],\n+            [f'-vbparams=testdummy:@144:@{144 * 2}:@{144 * 4}'],",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r593937260",
      "id" : 593937260,
      "in_reply_to_id" : 593922180,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzkzNzI2MA==",
      "original_commit_id" : "9f98cf7dfb11a852b1092ead5af4c400ae82e21d",
      "original_line" : 19,
      "original_position" : 19,
      "original_start_line" : 17,
      "path" : "test/functional/feature_bip8.py",
      "position" : null,
      "pull_request_review_id" : 611721510,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593937260",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-03-15T08:20:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-799215692",
      "id" : 799215692,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5OTIxNTY5Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-15T08:20:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/799215692",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK, Approach ACK. \r\n\r\nThere appears to be considerable community [support](https://gist.github.com/michaelfolkson/92899f27f1ab30aa2ebee82314f8fe7f) for the Speedy Trial proposal and I think this PR is best positioned today to be merged in the near future given that it cherry picks commits from other authors (Luke, AJ, Sjors). \r\n\r\nThis bitcoin-dev mailing list [post](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-March/018594.html) had a startheight of May 1st (and that is the startheight Andrew is going with I think). That doesn't leave much time if this is going to be released well in advance of that startheight with communication to users (including miners). The startheight can be pushed back if needed though ideally it wouldn't need to be. The merge decision is obviously ultimately up to the maintainers. If this PR (or any PR) isn't ready to be merged I wouldn't expect it to be merged regardless of any upcoming planned startheight.\r\n\r\nedit: To be clear I don't think this PR is ready to be merged yet. But hopefully it will be after **at the very least** a couple of weeks of sustained review.",
      "created_at" : "2021-03-15T12:25:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-799378366",
      "id" : 799378366,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5OTM3ODM2Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-15T12:31:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/799378366",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--4a62be1de6b64f3ed646cdc7932c8cf5-->\n @harding @sipa have been requested to review this pull request as specified in the REVIEWERS file.",
      "created_at" : "2021-03-15T16:48:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-799573801",
      "id" : 799573801,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5OTU3MzgwMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-15T16:48:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/799573801",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-03-15T18:54:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-799670222",
      "id" : 799670222,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5OTY3MDIyMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-15T18:54:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/799670222",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Now that #21380 has been revamped to only add a fuzz test (no refactors), probably makes sense to update this PR to match?\r\n\r\nAlso, can you update the OP description to match the commits? OP refers to 5 commits but the branch has 14 ",
      "created_at" : "2021-03-16T20:24:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-800579275",
      "id" : 800579275,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwMDU3OTI3NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-16T20:24:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/800579275",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Now that #21380 has been revamped to only add a fuzz test (no refactors), probably makes sense to update this PR to match?\r\n\r\nI have kept the refactoring commits and dropped the fuzzer commits, as the refactors were the reason this PR was based on #21380.\r\n\r\n> Also, can you update the OP description to match the commits? OP refers to 5 commits but the branch has 14 stuck_out_tongue\r\n\r\nUpdated the description.",
      "created_at" : "2021-03-16T21:10:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-800606952",
      "id" : 800606952,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwMDYwNjk1Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-16T21:10:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/800606952",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It's probably a good idea to extract 524b41ffdb67ebaf1538a39b88344e7d4118b4b8 to 414640fbaf8cf00e8e37451764a77cdec3fdd730 into a seperate PR, and perhaps also incorporate @luke-jr's #21399. That covers all the refactoring and generic-making. This PR, the BIP 9 variant #21377, a BIP 8 (lot=false) and a BIP 9 activation can all build on that.",
      "created_at" : "2021-03-17T16:21:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-801220786",
      "id" : 801220786,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwMTIyMDc4Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-17T16:21:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/801220786",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I've dropped the refactoring and will include it in another PR.",
      "created_at" : "2021-03-17T18:52:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-801328699",
      "id" : 801328699,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwMTMyODY5OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-17T18:54:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/801328699",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597207019"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597207019"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Oh, no -- the reason was that it is possible to test \"TESTDUMMY\" activation on mainnet with MTP because you can fake the block time to be prior to the the genesis block's timestamp; but you can't do that with height because you obviously can't have a block height prior to NEVER_ACTIVE ie -2.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-18T20:07:41Z",
      "diff_hunk" : "@@ -284,100 +259,67 @@ BOOST_AUTO_TEST_CASE(versionbits_params)\n BOOST_AUTO_TEST_CASE(versionbits_computeblockversion)\n {\n     // Check that ComputeBlockVersion will set the appropriate bit correctly\n-    // on mainnet.\n-    const auto chainParams = CreateChainParams(*m_node.args, CBaseChainParams::MAIN);\n+    const auto period = CreateChainParams(*m_node.args, CBaseChainParams::REGTEST)->GetConsensus().nMinerConfirmationWindow;\n+    gArgs.ForceSetArg(\"-vbparams\", strprintf(\"testdummy:@%s:@%s\", period, period * 2));\n+    const auto chainParams = CreateChainParams(*m_node.args, CBaseChainParams::REGTEST);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597207019",
      "id" : 597207019,
      "in_reply_to_id" : 591529768,
      "line" : 282,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzIwNzAxOQ==",
      "original_commit_id" : "d4c40a52cdc0e07647b6543427e621585028fcdd",
      "original_line" : 282,
      "original_position" : 147,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 283,
      "pull_request_review_id" : 615828198,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597207019",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597210855"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597210855"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Comment is wrong",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-18T20:13:59Z",
      "diff_hunk" : "@@ -157,65 +157,40 @@ BOOST_FIXTURE_TEST_SUITE(versionbits_tests, TestingSetup)\n BOOST_AUTO_TEST_CASE(versionbits_test)\n {\n     for (int i = 0; i < 64; i++) {\n-        // DEFINED -> FAILED\n-        VersionBitsTester().TestDefined().TestStateSinceHeight(0)\n-                           .Mine(1, TestTime(1), 0x100).TestDefined().TestStateSinceHeight(0)\n-                           .Mine(11, TestTime(11), 0x100).TestDefined().TestStateSinceHeight(0)\n-                           .Mine(989, TestTime(989), 0x100).TestDefined().TestStateSinceHeight(0)\n-                           .Mine(999, TestTime(20000), 0x100).TestDefined().TestStateSinceHeight(0)\n-                           .Mine(1000, TestTime(20000), 0x100).TestFailed().TestStateSinceHeight(1000)\n-                           .Mine(1999, TestTime(30001), 0x100).TestFailed().TestStateSinceHeight(1000)\n-                           .Mine(2000, TestTime(30002), 0x100).TestFailed().TestStateSinceHeight(1000)\n-                           .Mine(2001, TestTime(30003), 0x100).TestFailed().TestStateSinceHeight(1000)\n-                           .Mine(2999, TestTime(30004), 0x100).TestFailed().TestStateSinceHeight(1000)\n-                           .Mine(3000, TestTime(30005), 0x100).TestFailed().TestStateSinceHeight(1000)\n-\n         // DEFINED -> STARTED -> FAILED\n-                           .Reset().TestDefined().TestStateSinceHeight(0)\n-                           .Mine(1, TestTime(1), 0).TestDefined().TestStateSinceHeight(0)\n-                           .Mine(1000, TestTime(10000) - 1, 0x100).TestDefined().TestStateSinceHeight(0) // One second more and it would be defined\n-                           .Mine(2000, TestTime(10000), 0x100).TestStarted().TestStateSinceHeight(2000) // So that's what happens the next period\n-                           .Mine(2051, TestTime(10010), 0).TestStarted().TestStateSinceHeight(2000) // 51 old blocks\n-                           .Mine(2950, TestTime(10020), 0x100).TestStarted().TestStateSinceHeight(2000) // 899 new blocks\n-                           .Mine(3000, TestTime(20000), 0).TestFailed().TestStateSinceHeight(3000) // 50 old blocks (so 899 out of the past 1000)\n-                           .Mine(4000, TestTime(20010), 0x100).TestFailed().TestStateSinceHeight(3000)\n-\n-        // DEFINED -> STARTED -> FAILED while threshold reached\n-                           .Reset().TestDefined().TestStateSinceHeight(0)\n+        VersionBitsTester().TestDefined().TestStateSinceHeight(0)\n                            .Mine(1, TestTime(1), 0).TestDefined().TestStateSinceHeight(0)\n-                           .Mine(1000, TestTime(10000) - 1, 0x101).TestDefined().TestStateSinceHeight(0) // One second more and it would be defined\n-                           .Mine(2000, TestTime(10000), 0x101).TestStarted().TestStateSinceHeight(2000) // So that's what happens the next period\n-                           .Mine(2999, TestTime(30000), 0x100).TestStarted().TestStateSinceHeight(2000) // 999 new blocks\n-                           .Mine(3000, TestTime(30000), 0x100).TestFailed().TestStateSinceHeight(3000) // 1 new block (so 1000 out of the past 1000 are new)\n-                           .Mine(3999, TestTime(30001), 0).TestFailed().TestStateSinceHeight(3000)\n-                           .Mine(4000, TestTime(30002), 0).TestFailed().TestStateSinceHeight(3000)\n-                           .Mine(14333, TestTime(30003), 0).TestFailed().TestStateSinceHeight(3000)\n-                           .Mine(24000, TestTime(40000), 0).TestFailed().TestStateSinceHeight(3000)\n+                           .Mine(99, TestTime(10000) - 1, 0x100).TestDefined().TestStateSinceHeight(0) // One block more and it would be defined\n+                           .Mine(100, TestTime(10000), 0x100).TestStarted().TestStateSinceHeight(100) // So that's what happens the next period\n+                           .Mine(101, TestTime(10010), 0).TestStarted().TestStateSinceHeight(100) // 1 old block\n+                           .Mine(109, TestTime(10020), 0x100).TestStarted().TestStateSinceHeight(100) // 8 new blocks\n+                           .Mine(110, TestTime(10020), 0).TestStarted().TestStateSinceHeight(100) // 1 old block (so 8 out of the past 10 are new)\n+                           .Mine(151, TestTime(10020), 0).TestStarted().TestStateSinceHeight(100)\n+                           .Mine(200, TestTime(20000), 0).TestFailed().TestStateSinceHeight(200)\n+                           .Mine(300, TestTime(20010), 0x100).TestFailed().TestStateSinceHeight(200)\n \n         // DEFINED -> STARTED -> LOCKEDIN at the last minute -> ACTIVE\n                            .Reset().TestDefined()\n                            .Mine(1, TestTime(1), 0).TestDefined().TestStateSinceHeight(0)\n-                           .Mine(1000, TestTime(10000) - 1, 0x101).TestDefined().TestStateSinceHeight(0) // One second more and it would be defined\n-                           .Mine(2000, TestTime(10000), 0x101).TestStarted().TestStateSinceHeight(2000) // So that's what happens the next period\n-                           .Mine(2050, TestTime(10010), 0x200).TestStarted().TestStateSinceHeight(2000) // 50 old blocks\n-                           .Mine(2950, TestTime(10020), 0x100).TestStarted().TestStateSinceHeight(2000) // 900 new blocks\n-                           .Mine(2999, TestTime(19999), 0x200).TestStarted().TestStateSinceHeight(2000) // 49 old blocks\n-                           .Mine(3000, TestTime(29999), 0x200).TestLockedIn().TestStateSinceHeight(3000) // 1 old block (so 900 out of the past 1000)\n-                           .Mine(3999, TestTime(30001), 0).TestLockedIn().TestStateSinceHeight(3000)\n-                           .Mine(4000, TestTime(30002), 0).TestActive().TestStateSinceHeight(4000)\n-                           .Mine(14333, TestTime(30003), 0).TestActive().TestStateSinceHeight(4000)\n-                           .Mine(24000, TestTime(40000), 0).TestActive().TestStateSinceHeight(4000)\n+                           .Mine(99, TestTime(10000) - 1, 0x101).TestDefined().TestStateSinceHeight(0) // One second more and it would be started\n+                           .Mine(100, TestTime(10000), 0x101).TestStarted().TestStateSinceHeight(100) // So that's what happens the next period",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597210855",
      "id" : 597210855,
      "line" : 211,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzIxMDg1NQ==",
      "original_commit_id" : "2961b34e085787691701fd85b58061c205d489f3",
      "original_line" : 211,
      "original_position" : 95,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 196,
      "pull_request_review_id" : 615833221,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597210855",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597212362"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597212362"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-18T20:16:31Z",
      "diff_hunk" : "@@ -157,65 +157,40 @@ BOOST_FIXTURE_TEST_SUITE(versionbits_tests, TestingSetup)\n BOOST_AUTO_TEST_CASE(versionbits_test)\n {\n     for (int i = 0; i < 64; i++) {\n-        // DEFINED -> FAILED\n-        VersionBitsTester().TestDefined().TestStateSinceHeight(0)\n-                           .Mine(1, TestTime(1), 0x100).TestDefined().TestStateSinceHeight(0)\n-                           .Mine(11, TestTime(11), 0x100).TestDefined().TestStateSinceHeight(0)\n-                           .Mine(989, TestTime(989), 0x100).TestDefined().TestStateSinceHeight(0)\n-                           .Mine(999, TestTime(20000), 0x100).TestDefined().TestStateSinceHeight(0)\n-                           .Mine(1000, TestTime(20000), 0x100).TestFailed().TestStateSinceHeight(1000)\n-                           .Mine(1999, TestTime(30001), 0x100).TestFailed().TestStateSinceHeight(1000)\n-                           .Mine(2000, TestTime(30002), 0x100).TestFailed().TestStateSinceHeight(1000)\n-                           .Mine(2001, TestTime(30003), 0x100).TestFailed().TestStateSinceHeight(1000)\n-                           .Mine(2999, TestTime(30004), 0x100).TestFailed().TestStateSinceHeight(1000)\n-                           .Mine(3000, TestTime(30005), 0x100).TestFailed().TestStateSinceHeight(1000)\n-\n         // DEFINED -> STARTED -> FAILED\n-                           .Reset().TestDefined().TestStateSinceHeight(0)\n-                           .Mine(1, TestTime(1), 0).TestDefined().TestStateSinceHeight(0)\n-                           .Mine(1000, TestTime(10000) - 1, 0x100).TestDefined().TestStateSinceHeight(0) // One second more and it would be defined\n-                           .Mine(2000, TestTime(10000), 0x100).TestStarted().TestStateSinceHeight(2000) // So that's what happens the next period\n-                           .Mine(2051, TestTime(10010), 0).TestStarted().TestStateSinceHeight(2000) // 51 old blocks\n-                           .Mine(2950, TestTime(10020), 0x100).TestStarted().TestStateSinceHeight(2000) // 899 new blocks\n-                           .Mine(3000, TestTime(20000), 0).TestFailed().TestStateSinceHeight(3000) // 50 old blocks (so 899 out of the past 1000)\n-                           .Mine(4000, TestTime(20010), 0x100).TestFailed().TestStateSinceHeight(3000)\n-\n-        // DEFINED -> STARTED -> FAILED while threshold reached\n-                           .Reset().TestDefined().TestStateSinceHeight(0)\n+        VersionBitsTester().TestDefined().TestStateSinceHeight(0)\n                            .Mine(1, TestTime(1), 0).TestDefined().TestStateSinceHeight(0)\n-                           .Mine(1000, TestTime(10000) - 1, 0x101).TestDefined().TestStateSinceHeight(0) // One second more and it would be defined\n-                           .Mine(2000, TestTime(10000), 0x101).TestStarted().TestStateSinceHeight(2000) // So that's what happens the next period\n-                           .Mine(2999, TestTime(30000), 0x100).TestStarted().TestStateSinceHeight(2000) // 999 new blocks\n-                           .Mine(3000, TestTime(30000), 0x100).TestFailed().TestStateSinceHeight(3000) // 1 new block (so 1000 out of the past 1000 are new)\n-                           .Mine(3999, TestTime(30001), 0).TestFailed().TestStateSinceHeight(3000)\n-                           .Mine(4000, TestTime(30002), 0).TestFailed().TestStateSinceHeight(3000)\n-                           .Mine(14333, TestTime(30003), 0).TestFailed().TestStateSinceHeight(3000)\n-                           .Mine(24000, TestTime(40000), 0).TestFailed().TestStateSinceHeight(3000)\n+                           .Mine(99, TestTime(10000) - 1, 0x100).TestDefined().TestStateSinceHeight(0) // One block more and it would be defined\n+                           .Mine(100, TestTime(10000), 0x100).TestStarted().TestStateSinceHeight(100) // So that's what happens the next period\n+                           .Mine(101, TestTime(10010), 0).TestStarted().TestStateSinceHeight(100) // 1 old block\n+                           .Mine(109, TestTime(10020), 0x100).TestStarted().TestStateSinceHeight(100) // 8 new blocks\n+                           .Mine(110, TestTime(10020), 0).TestStarted().TestStateSinceHeight(100) // 1 old block (so 8 out of the past 10 are new)\n+                           .Mine(151, TestTime(10020), 0).TestStarted().TestStateSinceHeight(100)\n+                           .Mine(200, TestTime(20000), 0).TestFailed().TestStateSinceHeight(200)\n+                           .Mine(300, TestTime(20010), 0x100).TestFailed().TestStateSinceHeight(200)\n \n         // DEFINED -> STARTED -> LOCKEDIN at the last minute -> ACTIVE\n                            .Reset().TestDefined()\n                            .Mine(1, TestTime(1), 0).TestDefined().TestStateSinceHeight(0)\n-                           .Mine(1000, TestTime(10000) - 1, 0x101).TestDefined().TestStateSinceHeight(0) // One second more and it would be defined\n-                           .Mine(2000, TestTime(10000), 0x101).TestStarted().TestStateSinceHeight(2000) // So that's what happens the next period\n-                           .Mine(2050, TestTime(10010), 0x200).TestStarted().TestStateSinceHeight(2000) // 50 old blocks\n-                           .Mine(2950, TestTime(10020), 0x100).TestStarted().TestStateSinceHeight(2000) // 900 new blocks\n-                           .Mine(2999, TestTime(19999), 0x200).TestStarted().TestStateSinceHeight(2000) // 49 old blocks\n-                           .Mine(3000, TestTime(29999), 0x200).TestLockedIn().TestStateSinceHeight(3000) // 1 old block (so 900 out of the past 1000)\n-                           .Mine(3999, TestTime(30001), 0).TestLockedIn().TestStateSinceHeight(3000)\n-                           .Mine(4000, TestTime(30002), 0).TestActive().TestStateSinceHeight(4000)\n-                           .Mine(14333, TestTime(30003), 0).TestActive().TestStateSinceHeight(4000)\n-                           .Mine(24000, TestTime(40000), 0).TestActive().TestStateSinceHeight(4000)\n+                           .Mine(99, TestTime(10000) - 1, 0x101).TestDefined().TestStateSinceHeight(0) // One second more and it would be started\n+                           .Mine(100, TestTime(10000), 0x101).TestStarted().TestStateSinceHeight(100) // So that's what happens the next period",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597212362",
      "id" : 597212362,
      "in_reply_to_id" : 597210855,
      "line" : 211,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzIxMjM2Mg==",
      "original_commit_id" : "2961b34e085787691701fd85b58061c205d489f3",
      "original_line" : 211,
      "original_position" : 95,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 196,
      "pull_request_review_id" : 615835078,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597212362",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597213684"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597213684"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Missing `[:]` around min_activation_height",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-18T20:18:33Z",
      "diff_hunk" : "@@ -22,7 +22,7 @@ void SetupChainParamsBaseOptions(ArgsManager& argsman)\n                  \"This is intended for regression testing tools and app development. Equivalent to -chain=regtest.\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n     argsman.AddArg(\"-segwitheight=<n>\", \"Set the activation height of segwit. -1 to disable. (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);\n     argsman.AddArg(\"-testnet\", \"Use the test chain. Equivalent to -chain=test.\", ArgsManager::ALLOW_ANY, OptionsCategory::CHAINPARAMS);\n-    argsman.AddArg(\"-vbparams=deployment:@startheight:@timeoutheight\", \"Use given start/timeout heights for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n+    argsman.AddArg(\"-vbparams=deployment:@startheight:@timeoutheight@min_activation_height\", \"Use given start, timeout, and minimum activation heights for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597213684",
      "id" : 597213684,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzIxMzY4NA==",
      "original_commit_id" : "06b3b4de75376baee14236f1562db5f64137f8d6",
      "original_line" : 25,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/chainparamsbase.cpp",
      "position" : null,
      "pull_request_review_id" : 615835866,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597213684",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597231273"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597231273"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This loop structure is repeated a bunch; might be clearer as:\r\n\r\n```python\r\n    def test_height(self, height, *status, mine=None):\r\n        if height > self.height:\r\n            assert mine is not None\r\n            self.log.info(f\"Test status at height {height}...\")\r\n            self.nodes[mine].generate(height - self.height)\r\n            self.sync_blocks()\r\n        elif height < self.height:\r\n            assert mine is None\r\n            self.log.info(f\"Roll back to {height}...\")\r\n            old_block = self.nodes[0].getblockhash(height + 1)\r\n            for node in self.nodes:\r\n                node.invalidateblock(old_block)\r\n        else:\r\n            assert height == 0 and self.height == 0\r\n            self.log.info(f\"Test status at genesis...\")\r\n\r\n        self.height = height\r\n\r\n        for (i, node), st in zip(enumerate(self.nodes), status):\r\n            self.log.debug('Node #{}...'.format(i))\r\n            info = node.getblockchaininfo()\r\n            assert_equal(info['blocks'], height)\r\n            assert_equal(info[\"softforks\"][\"testdummy\"][\"bip8\"][\"status\"], st)\r\n\r\n    def run_test(self):\r\n        self.test_height(0, \"defined\", \"defined\", \"defined\")\r\n\r\n        # BIP 8 state transitions from \"defined\" to \"started\" or \"failed\" after\r\n        # the last block of the retargeting period has been mined. This means\r\n        # any new rules apply to transactions currently in the mempool, which\r\n        # might be mined in the next block.\r\n        #\r\n        # The next retargeting period starts at block 144, so nothing should\r\n        # happen at 142 and the state should change at 143.\r\n\r\n        self.test_height(144-2, \"defined\", \"defined\", \"defined\", mine=0)\r\n        self.test_height(144-1, \"failed\", \"started\", \"started\", mine=0)\r\n\r\n        self.log.info(\"Test status when not signalling...\")\r\n        self.test_height(144*2-1, \"failed\", \"started\", \"failed\", mine=0)\r\n        self.test_height(144*3-1, \"failed\", \"failed\", \"failed\", mine=0)\r\n\r\n\r\n        self.log.info(\"Test status when signalling...\")\r\n        # The new branch has unique block hashes, because of the signalling and\r\n        # because generate uses a deterministic address that depends on the node\r\n        # index.\r\n\r\n        self.test_height(144-1, \"failed\", \"started\", \"started\")\r\n        self.test_height(144*2-1, \"failed\", \"locked_in\", \"locked_in\", mine=2)\r\n        self.test_height(144*3-1, \"failed\", \"active\", \"locked_in\", mine=2)\r\n        self.test_height(144*4-1, \"failed\", \"active\", \"active\", mine=2)\r\n```",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-18T20:47:34Z",
      "diff_hunk" : "@@ -0,0 +1,126 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class Bip8Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        self.setup_clean_chain = True\n+        # Node 0 has TestDummy inactive\n+        # Node 1 has a regular activation window\n+        # Node 2 uses speedy trial.\n+        self.extra_args = [\n+            ['-vbparams=testdummy:@1:@1'],\n+            ['-vbparams=testdummy:@144:@{}'.format(144 * 3)],\n+            ['-vbparams=testdummy:@144:@{}:@{}'.format(144 * 2, 144 * 4)],\n+        ]\n+\n+    def run_test(self):\n+        self.log.info(\"Test status at genesis...\")\n+        for i, node in enumerate(self.nodes):\n+            self.log.debug('Node #{}...'.format(i))\n+            info = node.getblockchaininfo()\n+            assert_equal(info['blocks'], 0)\n+            assert_equal(info[\"softforks\"][\"testdummy\"][\"bip8\"][\"status\"], \"defined\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597231273",
      "id" : 597231273,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzIzMTI3Mw==",
      "original_commit_id" : "c3093dbc11c4db551ec2b0b4bf6f5c24aa4ee542",
      "original_line" : 28,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "test/functional/feature_bip8.py",
      "position" : null,
      "pull_request_review_id" : 615835866,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597231273",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597232746"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597232746"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Note `@1:@1` gets interpreted equivalently to `@144:@144` and transitions from DEFINED to FAILED for the block at height 144.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-18T20:50:09Z",
      "diff_hunk" : "@@ -0,0 +1,126 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class Bip8Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        self.setup_clean_chain = True\n+        # Node 0 has TestDummy inactive\n+        # Node 1 has a regular activation window\n+        # Node 2 uses speedy trial.\n+        self.extra_args = [\n+            ['-vbparams=testdummy:@1:@1'],",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597232746",
      "id" : 597232746,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzIzMjc0Ng==",
      "original_commit_id" : "c3093dbc11c4db551ec2b0b4bf6f5c24aa4ee542",
      "original_line" : 17,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "test/functional/feature_bip8.py",
      "position" : null,
      "pull_request_review_id" : 615835866,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597232746",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597233603"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597233603"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This doesn't match the BIP 8 spec which specifies that DEFINED always transitions to STARTED and never skips directly to FAILED.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-18T20:51:39Z",
      "diff_hunk" : "@@ -49,20 +56,19 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n         pindexPrev = vToCompute.back();\n         vToCompute.pop_back();\n \n+        // We track state by previous-block, so the height we should be comparing is +1\n+        const int64_t height = pindexPrev->nHeight + 1;\n+\n         switch (state) {\n             case ThresholdState::DEFINED: {\n-                if (pindexPrev->GetMedianTimePast() >= nTimeTimeout) {\n+                if (height >= height_timeout) {\n                     stateNext = ThresholdState::FAILED;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597233603",
      "id" : 597233603,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzIzMzYwMw==",
      "original_commit_id" : "28f82b25ac1dd18bb01e150d14ded687ae264956",
      "original_line" : 65,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 615835866,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597233603",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597236740"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597236740"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Could consider checking that `startheight` and `timeoutheight` (and `min_activation_height`) are either on retarget boundaries or match `-1, max int` or `-2, -2`. (Values not on retarget boundaries will be rounded up implicitly by the versionbits logic)",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-18T20:56:57Z",
      "diff_hunk" : "@@ -501,21 +501,21 @@ void CRegTestParams::UpdateActivationParametersFromArgs(const ArgsManager& args)\n         std::vector<std::string> vDeploymentParams;\n         boost::split(vDeploymentParams, strDeployment, boost::is_any_of(\":\"));\n         if (vDeploymentParams.size() != 3) {\n-            throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:start:end\");\n+            throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:@startheight:@timeoutheight\");\n         }\n-        int64_t nStartTime, nTimeout;\n-        if (!ParseInt64(vDeploymentParams[1], &nStartTime)) {\n-            throw std::runtime_error(strprintf(\"Invalid nStartTime (%s)\", vDeploymentParams[1]));\n+        int64_t startheight = 0, timeoutheight = 0;\n+        if (vDeploymentParams[1].empty() || vDeploymentParams[1].front() != '@' || !ParseInt64(vDeploymentParams[1].substr(1), &startheight)) {\n+            throw std::runtime_error(strprintf(\"Invalid startheight (%s)\", vDeploymentParams[1]));\n         }\n-        if (!ParseInt64(vDeploymentParams[2], &nTimeout)) {\n-            throw std::runtime_error(strprintf(\"Invalid nTimeout (%s)\", vDeploymentParams[2]));\n+        if (vDeploymentParams[2].empty() || vDeploymentParams[2].front() != '@' || !ParseInt64(vDeploymentParams[2].substr(1), &timeoutheight)) {\n+            throw std::runtime_error(strprintf(\"Invalid timeoutheight (%s)\", vDeploymentParams[2]));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597236740",
      "id" : 597236740,
      "line" : 557,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzIzNjc0MA==",
      "original_commit_id" : "28f82b25ac1dd18bb01e150d14ded687ae264956",
      "original_line" : 557,
      "original_position" : 105,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 174,
      "pull_request_review_id" : 615835866,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597236740",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597258950"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597258950"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This condition was actually caught by the fuzzer (back when this PR included it).\r\n\r\nThe scenario is that the timeoutheight is less than one period after the startheight. Without this, such a deployment would transition to the STARTED state, and then potentially to LOCKED_IN. But all of that after the timeoutheight has been passed. That doesn't make any sense and doesn't fit within what we are expecting in any tests.\r\n\r\nI think we need to revisit this case in the BIP.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-18T21:37:01Z",
      "diff_hunk" : "@@ -49,20 +56,19 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n         pindexPrev = vToCompute.back();\n         vToCompute.pop_back();\n \n+        // We track state by previous-block, so the height we should be comparing is +1\n+        const int64_t height = pindexPrev->nHeight + 1;\n+\n         switch (state) {\n             case ThresholdState::DEFINED: {\n-                if (pindexPrev->GetMedianTimePast() >= nTimeTimeout) {\n+                if (height >= height_timeout) {\n                     stateNext = ThresholdState::FAILED;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597258950",
      "id" : 597258950,
      "in_reply_to_id" : 597233603,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzI1ODk1MA==",
      "original_commit_id" : "28f82b25ac1dd18bb01e150d14ded687ae264956",
      "original_line" : 65,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 615894124,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597258950",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597310511"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597310511"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-18T23:34:08Z",
      "diff_hunk" : "@@ -22,7 +22,7 @@ void SetupChainParamsBaseOptions(ArgsManager& argsman)\n                  \"This is intended for regression testing tools and app development. Equivalent to -chain=regtest.\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n     argsman.AddArg(\"-segwitheight=<n>\", \"Set the activation height of segwit. -1 to disable. (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);\n     argsman.AddArg(\"-testnet\", \"Use the test chain. Equivalent to -chain=test.\", ArgsManager::ALLOW_ANY, OptionsCategory::CHAINPARAMS);\n-    argsman.AddArg(\"-vbparams=deployment:@startheight:@timeoutheight\", \"Use given start/timeout heights for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n+    argsman.AddArg(\"-vbparams=deployment:@startheight:@timeoutheight@min_activation_height\", \"Use given start, timeout, and minimum activation heights for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597310511",
      "id" : 597310511,
      "in_reply_to_id" : 597213684,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzMxMDUxMQ==",
      "original_commit_id" : "06b3b4de75376baee14236f1562db5f64137f8d6",
      "original_line" : 25,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/chainparamsbase.cpp",
      "position" : null,
      "pull_request_review_id" : 615955129,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597310511",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597310560"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597310560"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-18T23:34:16Z",
      "diff_hunk" : "@@ -0,0 +1,126 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class Bip8Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        self.setup_clean_chain = True\n+        # Node 0 has TestDummy inactive\n+        # Node 1 has a regular activation window\n+        # Node 2 uses speedy trial.\n+        self.extra_args = [\n+            ['-vbparams=testdummy:@1:@1'],\n+            ['-vbparams=testdummy:@144:@{}'.format(144 * 3)],\n+            ['-vbparams=testdummy:@144:@{}:@{}'.format(144 * 2, 144 * 4)],\n+        ]\n+\n+    def run_test(self):\n+        self.log.info(\"Test status at genesis...\")\n+        for i, node in enumerate(self.nodes):\n+            self.log.debug('Node #{}...'.format(i))\n+            info = node.getblockchaininfo()\n+            assert_equal(info['blocks'], 0)\n+            assert_equal(info[\"softforks\"][\"testdummy\"][\"bip8\"][\"status\"], \"defined\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597310560",
      "id" : 597310560,
      "in_reply_to_id" : 597231273,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzMxMDU2MA==",
      "original_commit_id" : "c3093dbc11c4db551ec2b0b4bf6f5c24aa4ee542",
      "original_line" : 28,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "test/functional/feature_bip8.py",
      "position" : null,
      "pull_request_review_id" : 615955178,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597310560",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597310780"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597310780"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Since this is for a node that has testdummy inactive, I've just changed this to `@-2:@-2`.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-18T23:34:55Z",
      "diff_hunk" : "@@ -0,0 +1,126 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class Bip8Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        self.setup_clean_chain = True\n+        # Node 0 has TestDummy inactive\n+        # Node 1 has a regular activation window\n+        # Node 2 uses speedy trial.\n+        self.extra_args = [\n+            ['-vbparams=testdummy:@1:@1'],",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597310780",
      "id" : 597310780,
      "in_reply_to_id" : 597232746,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzMxMDc4MA==",
      "original_commit_id" : "c3093dbc11c4db551ec2b0b4bf6f5c24aa4ee542",
      "original_line" : 17,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "test/functional/feature_bip8.py",
      "position" : null,
      "pull_request_review_id" : 615955424,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597310780",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597311140"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597311140"
         }
      },
      "author_association" : "MEMBER",
      "body" : "After discussing this with @luke-jr, I've removed this transition. Since there should never be a deployment that has the timeoutheight less than one period after the startheight, I've also added a sanity check to the unit tests for this case.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-18T23:35:48Z",
      "diff_hunk" : "@@ -49,20 +56,19 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n         pindexPrev = vToCompute.back();\n         vToCompute.pop_back();\n \n+        // We track state by previous-block, so the height we should be comparing is +1\n+        const int64_t height = pindexPrev->nHeight + 1;\n+\n         switch (state) {\n             case ThresholdState::DEFINED: {\n-                if (pindexPrev->GetMedianTimePast() >= nTimeTimeout) {\n+                if (height >= height_timeout) {\n                     stateNext = ThresholdState::FAILED;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597311140",
      "id" : 597311140,
      "in_reply_to_id" : 597233603,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzMxMTE0MA==",
      "original_commit_id" : "28f82b25ac1dd18bb01e150d14ded687ae264956",
      "original_line" : 65,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 615955773,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597311140",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597311188"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597311188"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Perhaps for a followup.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-18T23:35:58Z",
      "diff_hunk" : "@@ -501,21 +501,21 @@ void CRegTestParams::UpdateActivationParametersFromArgs(const ArgsManager& args)\n         std::vector<std::string> vDeploymentParams;\n         boost::split(vDeploymentParams, strDeployment, boost::is_any_of(\":\"));\n         if (vDeploymentParams.size() != 3) {\n-            throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:start:end\");\n+            throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:@startheight:@timeoutheight\");\n         }\n-        int64_t nStartTime, nTimeout;\n-        if (!ParseInt64(vDeploymentParams[1], &nStartTime)) {\n-            throw std::runtime_error(strprintf(\"Invalid nStartTime (%s)\", vDeploymentParams[1]));\n+        int64_t startheight = 0, timeoutheight = 0;\n+        if (vDeploymentParams[1].empty() || vDeploymentParams[1].front() != '@' || !ParseInt64(vDeploymentParams[1].substr(1), &startheight)) {\n+            throw std::runtime_error(strprintf(\"Invalid startheight (%s)\", vDeploymentParams[1]));\n         }\n-        if (!ParseInt64(vDeploymentParams[2], &nTimeout)) {\n-            throw std::runtime_error(strprintf(\"Invalid nTimeout (%s)\", vDeploymentParams[2]));\n+        if (vDeploymentParams[2].empty() || vDeploymentParams[2].front() != '@' || !ParseInt64(vDeploymentParams[2].substr(1), &timeoutheight)) {\n+            throw std::runtime_error(strprintf(\"Invalid timeoutheight (%s)\", vDeploymentParams[2]));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597311188",
      "id" : 597311188,
      "in_reply_to_id" : 597236740,
      "line" : 557,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzMxMTE4OA==",
      "original_commit_id" : "28f82b25ac1dd18bb01e150d14ded687ae264956",
      "original_line" : 557,
      "original_position" : 105,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 174,
      "pull_request_review_id" : 615955823,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597311188",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597320691"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597320691"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I don't think that works? \"never active\" means the fork won't show up in getblockchaininfo (to avoid testdummy appearing on mainnet).",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-19T00:02:25Z",
      "diff_hunk" : "@@ -0,0 +1,126 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class Bip8Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        self.setup_clean_chain = True\n+        # Node 0 has TestDummy inactive\n+        # Node 1 has a regular activation window\n+        # Node 2 uses speedy trial.\n+        self.extra_args = [\n+            ['-vbparams=testdummy:@1:@1'],",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597320691",
      "id" : 597320691,
      "in_reply_to_id" : 597232746,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzMyMDY5MQ==",
      "original_commit_id" : "c3093dbc11c4db551ec2b0b4bf6f5c24aa4ee542",
      "original_line" : 17,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "test/functional/feature_bip8.py",
      "position" : null,
      "pull_request_review_id" : 615965771,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597320691",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597322885"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597322885"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I work around that by allowing a status of `None` to indicate that it shouldn't show up in `getblockchaininfo`. The purpose of this node is to generate non-signaling blocks anyways, so the status of testdummy for it doesn't matter that much.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-19T00:08:57Z",
      "diff_hunk" : "@@ -0,0 +1,126 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class Bip8Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        self.setup_clean_chain = True\n+        # Node 0 has TestDummy inactive\n+        # Node 1 has a regular activation window\n+        # Node 2 uses speedy trial.\n+        self.extra_args = [\n+            ['-vbparams=testdummy:@1:@1'],",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597322885",
      "id" : 597322885,
      "in_reply_to_id" : 597232746,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzMyMjg4NQ==",
      "original_commit_id" : "c3093dbc11c4db551ec2b0b4bf6f5c24aa4ee542",
      "original_line" : 17,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "test/functional/feature_bip8.py",
      "position" : null,
      "pull_request_review_id" : 615968236,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597322885",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597327563"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597327563"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, the \"always reach STARTED\" issue was why there's a separate NEVER_ACTIVE setting, I think.\r\n\r\nBIP8 does specify \"timeoutheight must be at least 4096 blocks (2 retarget intervals) after startheight\", so you could treat timeoutheight being reached from DEFINED as an extension to the spec and define it any way you like, similar to the always/never active cases. (The old bip8 code in #19573 didn't do that in order to match the spec in the bip as closely as possible to catch spec/implementation mismatches)\r\n\r\nAs far as the fuzz tester goes, following the bip8 spec exactly should mean something like:\r\n\r\n```c++\r\nswitch (state) {\r\ncase STARTED:\r\n    assert(startheight <= height);\r\n    if (exp_state == STARTED) {\r\n        assert(height <= timeoutheight);\r\n        assert(blocks_sig < threshold);\r\n    } else {\r\n        assert(exp_state == DEFINED);\r\n    }\r\n    break;\r\ncase FAILED:\r\n    assert(exp_state == STARTED || exp_state == FAILED);\r\n    assert(never_active_test || height >= timeoutheight);\r\n} \r\n```   \r\n\r\nor alternatively extending it so you can skip STARTED would probably not change as much but might warrant adding a check along the lines of:\r\n\r\n```c++\r\nstatic int next_boundary(int n, int m) { return (n + m - 1) - ((n - 1) % m); }\r\nif (next_boundary(timeoutheight, period) >= next_boundary(startheight, period)) {\r\n    assert(state == DEFINED || state == FAILED);\r\n    assert(exp_state == DEFINED || exp_state == FAILED);\r\n}\r\n```",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-19T00:23:19Z",
      "diff_hunk" : "@@ -49,20 +56,19 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n         pindexPrev = vToCompute.back();\n         vToCompute.pop_back();\n \n+        // We track state by previous-block, so the height we should be comparing is +1\n+        const int64_t height = pindexPrev->nHeight + 1;\n+\n         switch (state) {\n             case ThresholdState::DEFINED: {\n-                if (pindexPrev->GetMedianTimePast() >= nTimeTimeout) {\n+                if (height >= height_timeout) {\n                     stateNext = ThresholdState::FAILED;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597327563",
      "id" : 597327563,
      "in_reply_to_id" : 597233603,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzMyNzU2Mw==",
      "original_commit_id" : "28f82b25ac1dd18bb01e150d14ded687ae264956",
      "original_line" : 65,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 615973384,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597327563",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597897743"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597897743"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I've decided to add checking for these parameters.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-19T18:35:06Z",
      "diff_hunk" : "@@ -501,21 +501,21 @@ void CRegTestParams::UpdateActivationParametersFromArgs(const ArgsManager& args)\n         std::vector<std::string> vDeploymentParams;\n         boost::split(vDeploymentParams, strDeployment, boost::is_any_of(\":\"));\n         if (vDeploymentParams.size() != 3) {\n-            throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:start:end\");\n+            throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:@startheight:@timeoutheight\");\n         }\n-        int64_t nStartTime, nTimeout;\n-        if (!ParseInt64(vDeploymentParams[1], &nStartTime)) {\n-            throw std::runtime_error(strprintf(\"Invalid nStartTime (%s)\", vDeploymentParams[1]));\n+        int64_t startheight = 0, timeoutheight = 0;\n+        if (vDeploymentParams[1].empty() || vDeploymentParams[1].front() != '@' || !ParseInt64(vDeploymentParams[1].substr(1), &startheight)) {\n+            throw std::runtime_error(strprintf(\"Invalid startheight (%s)\", vDeploymentParams[1]));\n         }\n-        if (!ParseInt64(vDeploymentParams[2], &nTimeout)) {\n-            throw std::runtime_error(strprintf(\"Invalid nTimeout (%s)\", vDeploymentParams[2]));\n+        if (vDeploymentParams[2].empty() || vDeploymentParams[2].front() != '@' || !ParseInt64(vDeploymentParams[2].substr(1), &timeoutheight)) {\n+            throw std::runtime_error(strprintf(\"Invalid timeoutheight (%s)\", vDeploymentParams[2]));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597897743",
      "id" : 597897743,
      "in_reply_to_id" : 597236740,
      "line" : 557,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5Nzg5Nzc0Mw==",
      "original_commit_id" : "28f82b25ac1dd18bb01e150d14ded687ae264956",
      "original_line" : 557,
      "original_position" : 105,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 174,
      "pull_request_review_id" : 616694142,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597897743",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased for hidden merge conflict with the fuzzer. As such, the versionbits fuzzer is updated for heights and min activation height.",
      "created_at" : "2021-03-19T20:27:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-803104973",
      "id" : 803104973,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwMzEwNDk3Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-19T20:27:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/803104973",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598061975"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598061975"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "If `height < checker.m_begin` and `m_begin + period <= m_end` then `height < checker.m_end` is guaranteed. Suggest dropping the `m_end` test here, which then allows removing the `assert(m_begin + period <= m_end)` above, which then allows extending the range for both startheight and timeoutheight to `[0, period*(max_periods-2)]`.  (Really the limit for timeouteight is `period*(max_periods-1)`)",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T04:40:39Z",
      "diff_hunk" : "@@ -276,47 +261,51 @@ FUZZ_TARGET_INIT(versionbits, initialize)\n \n     // since is straightforward:\n     assert(since % period == 0);\n-    assert(0 <= since && since <= current_block->nHeight + 1);\n+    assert(0 <= since && since <= height);\n     if (state == exp_state) {\n         assert(since == exp_since);\n     } else {\n-        assert(since == current_block->nHeight + 1);\n+        assert(since == height);\n     }\n \n     // state is where everything interesting is\n     switch (state) {\n     case ThresholdState::DEFINED:\n         assert(since == 0);\n         assert(exp_state == ThresholdState::DEFINED);\n-        assert(current_block->GetMedianTimePast() < checker.m_begin);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n+        assert(never_active_test || height < checker.m_begin);\n+        assert(never_active_test || height < checker.m_end);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598061975",
      "id" : 598061975,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODA2MTk3NQ==",
      "original_commit_id" : "501e1371a7c122ad8629bc31bfdab7d8195a75fa",
      "original_line" : 277,
      "original_position" : 170,
      "original_start_line" : null,
      "path" : "src/test/fuzz/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 616883132,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598061975",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598062098"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598062098"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Changing this assertion to `assert(always_active_test || height >= checker.m_min_activation)` allows having m_min_activation be fuzzed unconditionally (ie for always/never active tests as well).",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T04:42:22Z",
      "diff_hunk" : "@@ -276,47 +261,51 @@ FUZZ_TARGET_INIT(versionbits, initialize)\n \n     // since is straightforward:\n     assert(since % period == 0);\n-    assert(0 <= since && since <= current_block->nHeight + 1);\n+    assert(0 <= since && since <= height);\n     if (state == exp_state) {\n         assert(since == exp_since);\n     } else {\n-        assert(since == current_block->nHeight + 1);\n+        assert(since == height);\n     }\n \n     // state is where everything interesting is\n     switch (state) {\n     case ThresholdState::DEFINED:\n         assert(since == 0);\n         assert(exp_state == ThresholdState::DEFINED);\n-        assert(current_block->GetMedianTimePast() < checker.m_begin);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n+        assert(never_active_test || height < checker.m_begin);\n+        assert(never_active_test || height < checker.m_end);\n         break;\n     case ThresholdState::STARTED:\n-        assert(current_block->GetMedianTimePast() >= checker.m_begin);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n+        assert(height >= checker.m_begin);\n         if (exp_state == ThresholdState::STARTED) {\n+            assert(height < checker.m_end);\n             assert(blocks_sig < threshold);\n         } else {\n             assert(exp_state == ThresholdState::DEFINED);\n         }\n         break;\n     case ThresholdState::LOCKED_IN:\n-        assert(exp_state == ThresholdState::STARTED);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n-        assert(blocks_sig >= threshold);\n+        if (exp_state == ThresholdState::LOCKED_IN) {\n+            assert(height < checker.m_min_activation);\n+        } else {\n+            assert(exp_state == ThresholdState::STARTED);\n+            assert(blocks_sig >= threshold);\n+        }\n         break;\n     case ThresholdState::ACTIVE:\n+        assert(height >= checker.m_min_activation);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598062098",
      "id" : 598062098,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODA2MjA5OA==",
      "original_commit_id" : "501e1371a7c122ad8629bc31bfdab7d8195a75fa",
      "original_line" : 297,
      "original_position" : 195,
      "original_start_line" : null,
      "path" : "src/test/fuzz/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 616883132,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598062098",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598062187"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598062187"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I'm a bit surprised NEVER_ACTIVE is always DEFINED instead of always FAILED (it was this way in #19573 as well). I don't think it makes any observable difference though.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T04:43:42Z",
      "diff_hunk" : "@@ -334,12 +323,7 @@ FUZZ_TARGET_INIT(versionbits, initialize)\n \n     // \"never active\" does too\n     if (never_active_test) {\n-        assert(state == ThresholdState::FAILED);\n-        assert(since == period);\n-        if (exp_since == 0) {\n-            assert(exp_state == ThresholdState::DEFINED);\n-        } else {\n-            assert(exp_state == ThresholdState::FAILED);\n-        }\n+        assert(state == ThresholdState::DEFINED);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598062187",
      "id" : 598062187,
      "line" : 330,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODA2MjE4Nw==",
      "original_commit_id" : "501e1371a7c122ad8629bc31bfdab7d8195a75fa",
      "original_line" : 330,
      "original_position" : 223,
      "original_start_line" : null,
      "path" : "src/test/fuzz/versionbits.cpp",
      "position" : 224,
      "pull_request_review_id" : 616883132,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598062187",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598066616"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598066616"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't quite follow as to why the range for both startheight and timeoutheight should be ` [0, period*(max_periods-2)]`. I had set the range currently used in order to avoid the issue discussed in https://github.com/bitcoin/bitcoin/pull/21392#discussion_r597258950.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T05:32:16Z",
      "diff_hunk" : "@@ -276,47 +261,51 @@ FUZZ_TARGET_INIT(versionbits, initialize)\n \n     // since is straightforward:\n     assert(since % period == 0);\n-    assert(0 <= since && since <= current_block->nHeight + 1);\n+    assert(0 <= since && since <= height);\n     if (state == exp_state) {\n         assert(since == exp_since);\n     } else {\n-        assert(since == current_block->nHeight + 1);\n+        assert(since == height);\n     }\n \n     // state is where everything interesting is\n     switch (state) {\n     case ThresholdState::DEFINED:\n         assert(since == 0);\n         assert(exp_state == ThresholdState::DEFINED);\n-        assert(current_block->GetMedianTimePast() < checker.m_begin);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n+        assert(never_active_test || height < checker.m_begin);\n+        assert(never_active_test || height < checker.m_end);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598066616",
      "id" : 598066616,
      "in_reply_to_id" : 598061975,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODA2NjYxNg==",
      "original_commit_id" : "501e1371a7c122ad8629bc31bfdab7d8195a75fa",
      "original_line" : 277,
      "original_position" : 170,
      "original_start_line" : null,
      "path" : "src/test/fuzz/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 616885613,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598066616",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598066653"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598066653"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This was surprising to me as well. Since this commit was pulled from #19573, I just left it as it came from there.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T05:32:52Z",
      "diff_hunk" : "@@ -334,12 +323,7 @@ FUZZ_TARGET_INIT(versionbits, initialize)\n \n     // \"never active\" does too\n     if (never_active_test) {\n-        assert(state == ThresholdState::FAILED);\n-        assert(since == period);\n-        if (exp_since == 0) {\n-            assert(exp_state == ThresholdState::DEFINED);\n-        } else {\n-            assert(exp_state == ThresholdState::FAILED);\n-        }\n+        assert(state == ThresholdState::DEFINED);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598066653",
      "id" : 598066653,
      "in_reply_to_id" : 598062187,
      "line" : 330,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODA2NjY1Mw==",
      "original_commit_id" : "501e1371a7c122ad8629bc31bfdab7d8195a75fa",
      "original_line" : 330,
      "original_position" : 223,
      "original_start_line" : null,
      "path" : "src/test/fuzz/versionbits.cpp",
      "position" : 224,
      "pull_request_review_id" : 616885643,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598066653",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598067201"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598067201"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T05:38:22Z",
      "diff_hunk" : "@@ -276,47 +261,51 @@ FUZZ_TARGET_INIT(versionbits, initialize)\n \n     // since is straightforward:\n     assert(since % period == 0);\n-    assert(0 <= since && since <= current_block->nHeight + 1);\n+    assert(0 <= since && since <= height);\n     if (state == exp_state) {\n         assert(since == exp_since);\n     } else {\n-        assert(since == current_block->nHeight + 1);\n+        assert(since == height);\n     }\n \n     // state is where everything interesting is\n     switch (state) {\n     case ThresholdState::DEFINED:\n         assert(since == 0);\n         assert(exp_state == ThresholdState::DEFINED);\n-        assert(current_block->GetMedianTimePast() < checker.m_begin);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n+        assert(never_active_test || height < checker.m_begin);\n+        assert(never_active_test || height < checker.m_end);\n         break;\n     case ThresholdState::STARTED:\n-        assert(current_block->GetMedianTimePast() >= checker.m_begin);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n+        assert(height >= checker.m_begin);\n         if (exp_state == ThresholdState::STARTED) {\n+            assert(height < checker.m_end);\n             assert(blocks_sig < threshold);\n         } else {\n             assert(exp_state == ThresholdState::DEFINED);\n         }\n         break;\n     case ThresholdState::LOCKED_IN:\n-        assert(exp_state == ThresholdState::STARTED);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n-        assert(blocks_sig >= threshold);\n+        if (exp_state == ThresholdState::LOCKED_IN) {\n+            assert(height < checker.m_min_activation);\n+        } else {\n+            assert(exp_state == ThresholdState::STARTED);\n+            assert(blocks_sig >= threshold);\n+        }\n         break;\n     case ThresholdState::ACTIVE:\n+        assert(height >= checker.m_min_activation);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598067201",
      "id" : 598067201,
      "in_reply_to_id" : 598062098,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODA2NzIwMQ==",
      "original_commit_id" : "501e1371a7c122ad8629bc31bfdab7d8195a75fa",
      "original_line" : 297,
      "original_position" : 195,
      "original_start_line" : null,
      "path" : "src/test/fuzz/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 616885911,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598067201",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598068726"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598068726"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "For bip9/mtp versionbits the cache lookup loop will say \"oh, we haven't reach start time yet, must still be DEFINED\" which is inconsistent with the \"DEFINED\" check afterwards that says \"if we reached timeout and start time at the same time, we go to FAILED instead of STARTED\". If the fuzzer tracked the mtp for the previous period, you could capture that logic too, but that seemed a bit messy.\r\n\r\nBecause bip8 versionbits always goes DEFINED to STARTED it doesn't have that inconsistency, so checking a broader range of parameters is easy.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T05:55:56Z",
      "diff_hunk" : "@@ -276,47 +261,51 @@ FUZZ_TARGET_INIT(versionbits, initialize)\n \n     // since is straightforward:\n     assert(since % period == 0);\n-    assert(0 <= since && since <= current_block->nHeight + 1);\n+    assert(0 <= since && since <= height);\n     if (state == exp_state) {\n         assert(since == exp_since);\n     } else {\n-        assert(since == current_block->nHeight + 1);\n+        assert(since == height);\n     }\n \n     // state is where everything interesting is\n     switch (state) {\n     case ThresholdState::DEFINED:\n         assert(since == 0);\n         assert(exp_state == ThresholdState::DEFINED);\n-        assert(current_block->GetMedianTimePast() < checker.m_begin);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n+        assert(never_active_test || height < checker.m_begin);\n+        assert(never_active_test || height < checker.m_end);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598068726",
      "id" : 598068726,
      "in_reply_to_id" : 598061975,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODA2ODcyNg==",
      "original_commit_id" : "501e1371a7c122ad8629bc31bfdab7d8195a75fa",
      "original_line" : 277,
      "original_position" : 170,
      "original_start_line" : null,
      "path" : "src/test/fuzz/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 616886782,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598068726",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598071087"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598071087"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think you should be able to make this:\r\n\r\n```c++\r\n    case ThresholdState::FAILED:\r\n        assert(height >= checker.m_begin);\r\n        assert(height >= checker.m_end);\r\n        assert(exp_state == ThresholdState::FAILED || exp_state == ThresholdState::STARTED);\r\n```",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T06:24:23Z",
      "diff_hunk" : "@@ -276,47 +261,51 @@ FUZZ_TARGET_INIT(versionbits, initialize)\n \n     // since is straightforward:\n     assert(since % period == 0);\n-    assert(0 <= since && since <= current_block->nHeight + 1);\n+    assert(0 <= since && since <= height);\n     if (state == exp_state) {\n         assert(since == exp_since);\n     } else {\n-        assert(since == current_block->nHeight + 1);\n+        assert(since == height);\n     }\n \n     // state is where everything interesting is\n     switch (state) {\n     case ThresholdState::DEFINED:\n         assert(since == 0);\n         assert(exp_state == ThresholdState::DEFINED);\n-        assert(current_block->GetMedianTimePast() < checker.m_begin);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n+        assert(never_active_test || height < checker.m_begin);\n+        assert(never_active_test || height < checker.m_end);\n         break;\n     case ThresholdState::STARTED:\n-        assert(current_block->GetMedianTimePast() >= checker.m_begin);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n+        assert(height >= checker.m_begin);\n         if (exp_state == ThresholdState::STARTED) {\n+            assert(height < checker.m_end);\n             assert(blocks_sig < threshold);\n         } else {\n             assert(exp_state == ThresholdState::DEFINED);\n         }\n         break;\n     case ThresholdState::LOCKED_IN:\n-        assert(exp_state == ThresholdState::STARTED);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n-        assert(blocks_sig >= threshold);\n+        if (exp_state == ThresholdState::LOCKED_IN) {\n+            assert(height < checker.m_min_activation);\n+        } else {\n+            assert(exp_state == ThresholdState::STARTED);\n+            assert(blocks_sig >= threshold);\n+        }\n         break;\n     case ThresholdState::ACTIVE:\n+        assert(always_active_test || height >= checker.m_min_activation);\n         assert(exp_state == ThresholdState::ACTIVE || exp_state == ThresholdState::LOCKED_IN);\n         break;\n     case ThresholdState::FAILED:\n-        assert(current_block->GetMedianTimePast() >= checker.m_end);\n+        assert(height >= checker.m_end);\n         assert(exp_state != ThresholdState::LOCKED_IN && exp_state != ThresholdState::ACTIVE);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598071087",
      "id" : 598071087,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODA3MTA4Nw==",
      "original_commit_id" : "80fc57990b4682bad350e1e7aff0ea4db73fec31",
      "original_line" : 302,
      "original_position" : 201,
      "original_start_line" : null,
      "path" : "src/test/fuzz/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 616888164,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598071087",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598111231"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598111231"
         }
      },
      "author_association" : "MEMBER",
      "body" : "59833ff7118510de7bd2e89d55e074dc23cef8ef : the second condition seems unnecessary, maybe just `assert` it?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T13:21:02Z",
      "diff_hunk" : "@@ -9,11 +9,16 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n {\n     int nPeriod = Period(params);\n     int nThreshold = Threshold(params);\n-    int64_t nTimeStart = BeginTime(params);\n-    int64_t nTimeTimeout = EndTime(params);\n+    int height_start = StartHeight(params);\n+    int height_timeout = TimeoutHeight(params);\n+\n+    // Check if this deployment is never active.\n+    if (height_start == Consensus::BIP9Deployment::NEVER_ACTIVE && height_timeout == Consensus::BIP9Deployment::NEVER_ACTIVE) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598111231",
      "id" : 598111231,
      "line" : 17,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODExMTIzMQ==",
      "original_commit_id" : "59833ff7118510de7bd2e89d55e074dc23cef8ef",
      "original_line" : 17,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : 11,
      "pull_request_review_id" : 616912138,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598111231",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598111704"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598111704"
         }
      },
      "author_association" : "MEMBER",
      "body" : "59833ff7118510de7bd2e89d55e074dc23cef8ef: doc should explain the special values `-1` and `-2`",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T13:25:47Z",
      "diff_hunk" : "@@ -22,7 +22,7 @@ void SetupChainParamsBaseOptions(ArgsManager& argsman)\n                  \"This is intended for regression testing tools and app development. Equivalent to -chain=regtest.\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n     argsman.AddArg(\"-segwitheight=<n>\", \"Set the activation height of segwit. -1 to disable. (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);\n     argsman.AddArg(\"-testnet\", \"Use the test chain. Equivalent to -chain=test.\", ArgsManager::ALLOW_ANY, OptionsCategory::CHAINPARAMS);\n-    argsman.AddArg(\"-vbparams=deployment:start:end\", \"Use given start/end times for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n+    argsman.AddArg(\"-vbparams=deployment:@startheight:@timeoutheight\", \"Use given start/timeout heights for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598111704",
      "id" : 598111704,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODExMTcwNA==",
      "original_commit_id" : "59833ff7118510de7bd2e89d55e074dc23cef8ef",
      "original_line" : 25,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/chainparamsbase.cpp",
      "position" : null,
      "pull_request_review_id" : 616912138,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598111704",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598112205"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598112205"
         }
      },
      "author_association" : "MEMBER",
      "body" : "59833ff7118510de7bd2e89d55e074dc23cef8ef: maybe use the exact terminology. I also find indentation less confusing:\r\n\r\n```python\r\nself.extra_args = [\r\n    [\"-par=1\", \"-vbparams=taproot:@-2:@-2\"], # Node 0 has Taproot NEVER_ACTIVE\r\n    [\"-par=1\"] # Node 1 has Taproot ALWAYS_ACTIVE\r\n]\r\n```\r\n",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T13:30:09Z",
      "diff_hunk" : "@@ -1201,7 +1201,7 @@ def set_test_params(self):\n         self.num_nodes = 2\n         self.setup_clean_chain = True\n         # Node 0 has Taproot inactive, Node 1 active.\n-        self.extra_args = [[\"-par=1\", \"-vbparams=taproot:1:1\"], [\"-par=1\"]]\n+        self.extra_args = [[\"-par=1\", \"-vbparams=taproot:@-2:@-2\"], [\"-par=1\"]]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598112205",
      "id" : 598112205,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODExMjIwNQ==",
      "original_commit_id" : "59833ff7118510de7bd2e89d55e074dc23cef8ef",
      "original_line" : 1204,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/feature_taproot.py",
      "position" : null,
      "pull_request_review_id" : 616912138,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598112205",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598112562"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598112562"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It also impacts mainnet for anyone automatically parsing `getblockchaininfo` for current softfork deployments.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T13:34:23Z",
      "diff_hunk" : "@@ -0,0 +1,7 @@\n+Low-level changes\n+=================\n+\n+RPC\n+---\n+\n+* BIP 9 has been replaced with a partial implementation of BIP 8. This change is reflected in `getblockchaininfo` where references to BIP 9 have been replaced with references to BIP 8.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598112562",
      "id" : 598112562,
      "in_reply_to_id" : 590674111,
      "line" : 7,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODExMjU2Mg==",
      "original_commit_id" : "968bc1e07b4a8a359876f5b8035fb4c369d04bad",
      "original_line" : 7,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "doc/release-notes-21392.md",
      "position" : 7,
      "pull_request_review_id" : 616912138,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598112562",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598138306"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598138306"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think it is fine to leave as is.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T17:35:09Z",
      "diff_hunk" : "@@ -9,11 +9,16 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n {\n     int nPeriod = Period(params);\n     int nThreshold = Threshold(params);\n-    int64_t nTimeStart = BeginTime(params);\n-    int64_t nTimeTimeout = EndTime(params);\n+    int height_start = StartHeight(params);\n+    int height_timeout = TimeoutHeight(params);\n+\n+    // Check if this deployment is never active.\n+    if (height_start == Consensus::BIP9Deployment::NEVER_ACTIVE && height_timeout == Consensus::BIP9Deployment::NEVER_ACTIVE) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598138306",
      "id" : 598138306,
      "in_reply_to_id" : 598111231,
      "line" : 17,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODEzODMwNg==",
      "original_commit_id" : "59833ff7118510de7bd2e89d55e074dc23cef8ef",
      "original_line" : 17,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : 11,
      "pull_request_review_id" : 616930275,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598138306",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598138314"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598138314"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T17:35:17Z",
      "diff_hunk" : "@@ -276,47 +261,51 @@ FUZZ_TARGET_INIT(versionbits, initialize)\n \n     // since is straightforward:\n     assert(since % period == 0);\n-    assert(0 <= since && since <= current_block->nHeight + 1);\n+    assert(0 <= since && since <= height);\n     if (state == exp_state) {\n         assert(since == exp_since);\n     } else {\n-        assert(since == current_block->nHeight + 1);\n+        assert(since == height);\n     }\n \n     // state is where everything interesting is\n     switch (state) {\n     case ThresholdState::DEFINED:\n         assert(since == 0);\n         assert(exp_state == ThresholdState::DEFINED);\n-        assert(current_block->GetMedianTimePast() < checker.m_begin);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n+        assert(never_active_test || height < checker.m_begin);\n+        assert(never_active_test || height < checker.m_end);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598138314",
      "id" : 598138314,
      "in_reply_to_id" : 598061975,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODEzODMxNA==",
      "original_commit_id" : "501e1371a7c122ad8629bc31bfdab7d8195a75fa",
      "original_line" : 277,
      "original_position" : 170,
      "original_start_line" : null,
      "path" : "src/test/fuzz/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 616930285,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598138314",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598138342"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598138342"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T17:35:22Z",
      "diff_hunk" : "@@ -276,47 +261,51 @@ FUZZ_TARGET_INIT(versionbits, initialize)\n \n     // since is straightforward:\n     assert(since % period == 0);\n-    assert(0 <= since && since <= current_block->nHeight + 1);\n+    assert(0 <= since && since <= height);\n     if (state == exp_state) {\n         assert(since == exp_since);\n     } else {\n-        assert(since == current_block->nHeight + 1);\n+        assert(since == height);\n     }\n \n     // state is where everything interesting is\n     switch (state) {\n     case ThresholdState::DEFINED:\n         assert(since == 0);\n         assert(exp_state == ThresholdState::DEFINED);\n-        assert(current_block->GetMedianTimePast() < checker.m_begin);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n+        assert(never_active_test || height < checker.m_begin);\n+        assert(never_active_test || height < checker.m_end);\n         break;\n     case ThresholdState::STARTED:\n-        assert(current_block->GetMedianTimePast() >= checker.m_begin);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n+        assert(height >= checker.m_begin);\n         if (exp_state == ThresholdState::STARTED) {\n+            assert(height < checker.m_end);\n             assert(blocks_sig < threshold);\n         } else {\n             assert(exp_state == ThresholdState::DEFINED);\n         }\n         break;\n     case ThresholdState::LOCKED_IN:\n-        assert(exp_state == ThresholdState::STARTED);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n-        assert(blocks_sig >= threshold);\n+        if (exp_state == ThresholdState::LOCKED_IN) {\n+            assert(height < checker.m_min_activation);\n+        } else {\n+            assert(exp_state == ThresholdState::STARTED);\n+            assert(blocks_sig >= threshold);\n+        }\n         break;\n     case ThresholdState::ACTIVE:\n+        assert(always_active_test || height >= checker.m_min_activation);\n         assert(exp_state == ThresholdState::ACTIVE || exp_state == ThresholdState::LOCKED_IN);\n         break;\n     case ThresholdState::FAILED:\n-        assert(current_block->GetMedianTimePast() >= checker.m_end);\n+        assert(height >= checker.m_end);\n         assert(exp_state != ThresholdState::LOCKED_IN && exp_state != ThresholdState::ACTIVE);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598138342",
      "id" : 598138342,
      "in_reply_to_id" : 598071087,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODEzODM0Mg==",
      "original_commit_id" : "80fc57990b4682bad350e1e7aff0ea4db73fec31",
      "original_line" : 302,
      "original_position" : 201,
      "original_start_line" : null,
      "path" : "src/test/fuzz/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 616930296,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598138342",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598138396"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598138396"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Added documentation for the always active and never active cases.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T17:35:36Z",
      "diff_hunk" : "@@ -22,7 +22,7 @@ void SetupChainParamsBaseOptions(ArgsManager& argsman)\n                  \"This is intended for regression testing tools and app development. Equivalent to -chain=regtest.\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n     argsman.AddArg(\"-segwitheight=<n>\", \"Set the activation height of segwit. -1 to disable. (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);\n     argsman.AddArg(\"-testnet\", \"Use the test chain. Equivalent to -chain=test.\", ArgsManager::ALLOW_ANY, OptionsCategory::CHAINPARAMS);\n-    argsman.AddArg(\"-vbparams=deployment:start:end\", \"Use given start/end times for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n+    argsman.AddArg(\"-vbparams=deployment:@startheight:@timeoutheight\", \"Use given start/timeout heights for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598138396",
      "id" : 598138396,
      "in_reply_to_id" : 598111704,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODEzODM5Ng==",
      "original_commit_id" : "59833ff7118510de7bd2e89d55e074dc23cef8ef",
      "original_line" : 25,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/chainparamsbase.cpp",
      "position" : null,
      "pull_request_review_id" : 616930315,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598138396",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598138411"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598138411"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T17:35:40Z",
      "diff_hunk" : "@@ -1201,7 +1201,7 @@ def set_test_params(self):\n         self.num_nodes = 2\n         self.setup_clean_chain = True\n         # Node 0 has Taproot inactive, Node 1 active.\n-        self.extra_args = [[\"-par=1\", \"-vbparams=taproot:1:1\"], [\"-par=1\"]]\n+        self.extra_args = [[\"-par=1\", \"-vbparams=taproot:@-2:@-2\"], [\"-par=1\"]]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598138411",
      "id" : 598138411,
      "in_reply_to_id" : 598112205,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODEzODQxMQ==",
      "original_commit_id" : "59833ff7118510de7bd2e89d55e074dc23cef8ef",
      "original_line" : 1204,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/feature_taproot.py",
      "position" : null,
      "pull_request_review_id" : 616930318,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598138411",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598144381"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598144381"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Do we really need that level of detail in debug-only options?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T18:31:49Z",
      "diff_hunk" : "@@ -22,7 +22,7 @@ void SetupChainParamsBaseOptions(ArgsManager& argsman)\n                  \"This is intended for regression testing tools and app development. Equivalent to -chain=regtest.\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n     argsman.AddArg(\"-segwitheight=<n>\", \"Set the activation height of segwit. -1 to disable. (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);\n     argsman.AddArg(\"-testnet\", \"Use the test chain. Equivalent to -chain=test.\", ArgsManager::ALLOW_ANY, OptionsCategory::CHAINPARAMS);\n-    argsman.AddArg(\"-vbparams=deployment:start:end\", \"Use given start/end times for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n+    argsman.AddArg(\"-vbparams=deployment:@startheight:@timeoutheight\", \"Use given start/timeout heights for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598144381",
      "id" : 598144381,
      "in_reply_to_id" : 598111704,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODE0NDM4MQ==",
      "original_commit_id" : "59833ff7118510de7bd2e89d55e074dc23cef8ef",
      "original_line" : 25,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/chainparamsbase.cpp",
      "position" : null,
      "pull_request_review_id" : 616934672,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598144381",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598145429"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598145429"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I could imagine some confusion if some sets `height_start` to `NEVER_ACTIVE` but then sets `height_timeout` to some real date. But hopefully this code gets enough review nobody would actually do that.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T18:42:44Z",
      "diff_hunk" : "@@ -9,11 +9,16 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n {\n     int nPeriod = Period(params);\n     int nThreshold = Threshold(params);\n-    int64_t nTimeStart = BeginTime(params);\n-    int64_t nTimeTimeout = EndTime(params);\n+    int height_start = StartHeight(params);\n+    int height_timeout = TimeoutHeight(params);\n+\n+    // Check if this deployment is never active.\n+    if (height_start == Consensus::BIP9Deployment::NEVER_ACTIVE && height_timeout == Consensus::BIP9Deployment::NEVER_ACTIVE) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598145429",
      "id" : 598145429,
      "in_reply_to_id" : 598111231,
      "line" : 17,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODE0NTQyOQ==",
      "original_commit_id" : "59833ff7118510de7bd2e89d55e074dc23cef8ef",
      "original_line" : 17,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : 11,
      "pull_request_review_id" : 616935441,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598145429",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598145462"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598145462"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's confused me more than zero times.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T18:43:11Z",
      "diff_hunk" : "@@ -22,7 +22,7 @@ void SetupChainParamsBaseOptions(ArgsManager& argsman)\n                  \"This is intended for regression testing tools and app development. Equivalent to -chain=regtest.\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n     argsman.AddArg(\"-segwitheight=<n>\", \"Set the activation height of segwit. -1 to disable. (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);\n     argsman.AddArg(\"-testnet\", \"Use the test chain. Equivalent to -chain=test.\", ArgsManager::ALLOW_ANY, OptionsCategory::CHAINPARAMS);\n-    argsman.AddArg(\"-vbparams=deployment:start:end\", \"Use given start/end times for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);\n+    argsman.AddArg(\"-vbparams=deployment:@startheight:@timeoutheight\", \"Use given start/timeout heights for specified version bits deployment (regtest-only)\", ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CHAINPARAMS);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598145462",
      "id" : 598145462,
      "in_reply_to_id" : 598111704,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODE0NTQ2Mg==",
      "original_commit_id" : "59833ff7118510de7bd2e89d55e074dc23cef8ef",
      "original_line" : 25,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/chainparamsbase.cpp",
      "position" : null,
      "pull_request_review_id" : 616935472,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598145462",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598148207"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598148207"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I've added an additional check to the sanity check unit test that the `NEVER_ACTIVE` and `ALWAYS_ACTIVE` parameters are set correctly.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-20T19:08:47Z",
      "diff_hunk" : "@@ -9,11 +9,16 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n {\n     int nPeriod = Period(params);\n     int nThreshold = Threshold(params);\n-    int64_t nTimeStart = BeginTime(params);\n-    int64_t nTimeTimeout = EndTime(params);\n+    int height_start = StartHeight(params);\n+    int height_timeout = TimeoutHeight(params);\n+\n+    // Check if this deployment is never active.\n+    if (height_start == Consensus::BIP9Deployment::NEVER_ACTIVE && height_timeout == Consensus::BIP9Deployment::NEVER_ACTIVE) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598148207",
      "id" : 598148207,
      "in_reply_to_id" : 598111231,
      "line" : 17,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODE0ODIwNw==",
      "original_commit_id" : "59833ff7118510de7bd2e89d55e074dc23cef8ef",
      "original_line" : 17,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : 11,
      "pull_request_review_id" : 616937244,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598148207",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598985924"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598985924"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This isn't true, and specifying NO_TIMEOUT is kinda annoying...?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-22T18:44:43Z",
      "diff_hunk" : "@@ -466,14 +474,57 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t start_height, int64_t timeout_height, int64_t min_activation_height)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = start_height;\n+        consensus.vDeployments[d].timeoutheight = timeout_height;\n+        consensus.vDeployments[d].m_min_activation_height = min_activation_height;\n     }\n+    bool CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight, int64_t min_activation_height);\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CRegTestParams::CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight, int64_t min_activation_height)\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NO_TIMEOUT)) {\n+        return true;\n+    }\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight != Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight != Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)) {\n+        error = strprintf(\"When one of startheight or timeoutheight is %d, both must be %d\", Consensus::BIP9Deployment::NEVER_ACTIVE, Consensus::BIP9Deployment::NEVER_ACTIVE);\n+        return false;\n+    }\n+    if (startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE && timeoutheight != Consensus::BIP9Deployment::NO_TIMEOUT) {\n+        error = strprintf(\"When startheight is %d, timeoutheight must be %d\", Consensus::BIP9Deployment::ALWAYS_ACTIVE, Consensus::BIP9Deployment::NO_TIMEOUT);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598985924",
      "id" : 598985924,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODk4NTkyNA==",
      "original_commit_id" : "52990c109349d7510a98070f07f706a60c6e2b75",
      "original_line" : 500,
      "original_position" : 126,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 617869698,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598985924",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r599151274"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599151274"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Removed it.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-22T23:54:05Z",
      "diff_hunk" : "@@ -466,14 +474,57 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t start_height, int64_t timeout_height, int64_t min_activation_height)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = start_height;\n+        consensus.vDeployments[d].timeoutheight = timeout_height;\n+        consensus.vDeployments[d].m_min_activation_height = min_activation_height;\n     }\n+    bool CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight, int64_t min_activation_height);\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CRegTestParams::CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight, int64_t min_activation_height)\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NO_TIMEOUT)) {\n+        return true;\n+    }\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight != Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight != Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)) {\n+        error = strprintf(\"When one of startheight or timeoutheight is %d, both must be %d\", Consensus::BIP9Deployment::NEVER_ACTIVE, Consensus::BIP9Deployment::NEVER_ACTIVE);\n+        return false;\n+    }\n+    if (startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE && timeoutheight != Consensus::BIP9Deployment::NO_TIMEOUT) {\n+        error = strprintf(\"When startheight is %d, timeoutheight must be %d\", Consensus::BIP9Deployment::ALWAYS_ACTIVE, Consensus::BIP9Deployment::NO_TIMEOUT);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r599151274",
      "id" : 599151274,
      "in_reply_to_id" : 598985924,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5OTE1MTI3NA==",
      "original_commit_id" : "52990c109349d7510a98070f07f706a60c6e2b75",
      "original_line" : 500,
      "original_position" : 126,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 618071283,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599151274",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600001664"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600001664"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Second var is wrong",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-23T22:30:51Z",
      "diff_hunk" : "@@ -466,14 +474,54 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t start_height, int64_t timeout_height, int64_t min_activation_height)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = start_height;\n+        consensus.vDeployments[d].timeoutheight = timeout_height;\n+        consensus.vDeployments[d].m_min_activation_height = min_activation_height;\n     }\n+    bool CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight, int64_t min_activation_height);\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CRegTestParams::CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight, int64_t min_activation_height)\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NO_TIMEOUT)) {\n+        return true;\n+    }\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight != Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight != Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)) {\n+        error = strprintf(\"When one of startheight or timeoutheight is %d, both must be %d\", Consensus::BIP9Deployment::NEVER_ACTIVE, Consensus::BIP9Deployment::NEVER_ACTIVE);\n+        return false;\n+    }\n+    if (startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) return true;\n+\n+    // Actual params must be on retarget block\n+    if (startheight % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid startheight (%d), must be a multiple of %d\", startheight, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (timeoutheight % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid timeoutheight (%d), must be a multiple of %d\", timeoutheight, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (min_activation_height < 0) {\n+        error = strprintf(\"Invalid minimum activation height (%d), cannot be negative\", min_activation_height);\n+        return false;\n+    }\n+    if (min_activation_height % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid minimum activation height (%d), must be a multiple of %d\", min_activation_height, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (timeoutheight <= startheight) {\n+        error = strprintf(\"Invalid timeoutheight (%d), must be greater than the startheight (%d)\", timeoutheight, timeoutheight);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600001664",
      "id" : 600001664,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDAwMTY2NA==",
      "original_commit_id" : "9a8334212bfa557b06d300f49962b3a772b63837",
      "original_line" : 519,
      "original_position" : 145,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 619140029,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600001664",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600049584"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600049584"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed. Also added tests for `-vbparams`.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T00:13:53Z",
      "diff_hunk" : "@@ -466,14 +474,54 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t start_height, int64_t timeout_height, int64_t min_activation_height)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = start_height;\n+        consensus.vDeployments[d].timeoutheight = timeout_height;\n+        consensus.vDeployments[d].m_min_activation_height = min_activation_height;\n     }\n+    bool CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight, int64_t min_activation_height);\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CRegTestParams::CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight, int64_t min_activation_height)\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NO_TIMEOUT)) {\n+        return true;\n+    }\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight != Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight != Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)) {\n+        error = strprintf(\"When one of startheight or timeoutheight is %d, both must be %d\", Consensus::BIP9Deployment::NEVER_ACTIVE, Consensus::BIP9Deployment::NEVER_ACTIVE);\n+        return false;\n+    }\n+    if (startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) return true;\n+\n+    // Actual params must be on retarget block\n+    if (startheight % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid startheight (%d), must be a multiple of %d\", startheight, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (timeoutheight % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid timeoutheight (%d), must be a multiple of %d\", timeoutheight, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (min_activation_height < 0) {\n+        error = strprintf(\"Invalid minimum activation height (%d), cannot be negative\", min_activation_height);\n+        return false;\n+    }\n+    if (min_activation_height % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid minimum activation height (%d), must be a multiple of %d\", min_activation_height, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (timeoutheight <= startheight) {\n+        error = strprintf(\"Invalid timeoutheight (%d), must be greater than the startheight (%d)\", timeoutheight, timeoutheight);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600049584",
      "id" : 600049584,
      "in_reply_to_id" : 600001664,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDA0OTU4NA==",
      "original_commit_id" : "9a8334212bfa557b06d300f49962b3a772b63837",
      "original_line" : 519,
      "original_position" : 145,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 619192063,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600049584",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600087336"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600087336"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In commit \"Migrate versionbits to use height instead of MTP\"\r\n\r\nYou already tested the case start==ALWAYS_ACTIVE && timeout==NO_TIMEOUT above. Would it make sense to enforce timeout==NO_TIMEOUT whenever start==ALWAYS_ACTIVE instead?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T01:31:46Z",
      "diff_hunk" : "@@ -474,14 +474,53 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t startheight, int64_t timeoutheight)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n     }\n+    bool CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight);\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CRegTestParams::CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight)\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NO_TIMEOUT)) {\n+        return true;\n+    }\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight != Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight != Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)) {\n+        error = strprintf(\"When one of startheight or timeoutheight is %d, both must be %d\", Consensus::BIP9Deployment::NEVER_ACTIVE, Consensus::BIP9Deployment::NEVER_ACTIVE);\n+        return false;\n+    }\n+    if (startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) return true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600087336",
      "id" : 600087336,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDA4NzMzNg==",
      "original_commit_id" : "bf4bddaac7db767986d29d22b8d866867bb50220",
      "original_line" : 498,
      "original_position" : 102,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 619229252,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600087336",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600098079"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600098079"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In commit \"Migrate versionbits to use height instead of MTP\"\r\n\r\n`timeoutheight` isn't chosen to be `>= startheight`?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T01:54:41Z",
      "diff_hunk" : "@@ -135,38 +124,25 @@ FUZZ_TARGET_INIT(versionbits, initialize)\n \n     bool always_active_test = false;\n     bool never_active_test = false;\n-    int64_t start_time;\n-    int64_t timeout;\n+    int startheight;\n+    int timeoutheight;\n     if (fuzzed_data_provider.ConsumeBool()) {\n         // pick the timestamp to switch based on a block\n-        // note states will change *after* these blocks because mediantime lags\n-        int start_block = fuzzed_data_provider.ConsumeIntegralInRange<int>(0, period * (max_periods - 3));\n-        int end_block = fuzzed_data_provider.ConsumeIntegralInRange<int>(start_block, period * (max_periods - 3));\n-\n-        start_time = block_start_time + start_block * interval;\n-        timeout = block_start_time + end_block * interval;\n-\n-        assert(start_time <= timeout);\n-\n-        // allow for times to not exactly match a block\n-        if (fuzzed_data_provider.ConsumeBool()) start_time += interval / 2;\n-        if (fuzzed_data_provider.ConsumeBool()) timeout += interval / 2;\n-\n-        // this may make timeout too early; if so, don't run the test\n-        if (start_time > timeout) return;\n+        startheight = fuzzed_data_provider.ConsumeIntegralInRange<int>(0, period * (max_periods - 2));\n+        timeoutheight = fuzzed_data_provider.ConsumeIntegralInRange<int>(0, period * (max_periods - 2));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600098079",
      "id" : 600098079,
      "line" : 138,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDA5ODA3OQ==",
      "original_commit_id" : "bf4bddaac7db767986d29d22b8d866867bb50220",
      "original_line" : 138,
      "original_position" : 101,
      "original_start_line" : null,
      "path" : "src/test/fuzz/versionbits.cpp",
      "position" : 106,
      "pull_request_review_id" : 619229252,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600098079",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600111302"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600111302"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In commit \"Migrate versionbits to use height instead of MTP\", but more general perhaps.\r\n\r\nThere seems to be some overlap here with `sanity_check_params`. Would it make sense to have them merged, and perhaps make it always performed (also for mainnet/testnet, at startup)?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T02:21:39Z",
      "diff_hunk" : "@@ -474,14 +474,53 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t startheight, int64_t timeoutheight)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n     }\n+    bool CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight);\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CRegTestParams::CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600111302",
      "id" : 600111302,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDExMTMwMg==",
      "original_commit_id" : "bf4bddaac7db767986d29d22b8d866867bb50220",
      "original_line" : 486,
      "original_position" : 90,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 619229252,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600111302",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600121543"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600121543"
         }
      },
      "author_association" : "MEMBER",
      "body" : "afaict, the fuzzer is flexible enough to deal with that case. See also: https://github.com/bitcoin/bitcoin/pull/21392#discussion_r598061975",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T02:49:25Z",
      "diff_hunk" : "@@ -135,38 +124,25 @@ FUZZ_TARGET_INIT(versionbits, initialize)\n \n     bool always_active_test = false;\n     bool never_active_test = false;\n-    int64_t start_time;\n-    int64_t timeout;\n+    int startheight;\n+    int timeoutheight;\n     if (fuzzed_data_provider.ConsumeBool()) {\n         // pick the timestamp to switch based on a block\n-        // note states will change *after* these blocks because mediantime lags\n-        int start_block = fuzzed_data_provider.ConsumeIntegralInRange<int>(0, period * (max_periods - 3));\n-        int end_block = fuzzed_data_provider.ConsumeIntegralInRange<int>(start_block, period * (max_periods - 3));\n-\n-        start_time = block_start_time + start_block * interval;\n-        timeout = block_start_time + end_block * interval;\n-\n-        assert(start_time <= timeout);\n-\n-        // allow for times to not exactly match a block\n-        if (fuzzed_data_provider.ConsumeBool()) start_time += interval / 2;\n-        if (fuzzed_data_provider.ConsumeBool()) timeout += interval / 2;\n-\n-        // this may make timeout too early; if so, don't run the test\n-        if (start_time > timeout) return;\n+        startheight = fuzzed_data_provider.ConsumeIntegralInRange<int>(0, period * (max_periods - 2));\n+        timeoutheight = fuzzed_data_provider.ConsumeIntegralInRange<int>(0, period * (max_periods - 2));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600121543",
      "id" : 600121543,
      "in_reply_to_id" : 600098079,
      "line" : 138,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDEyMTU0Mw==",
      "original_commit_id" : "bf4bddaac7db767986d29d22b8d866867bb50220",
      "original_line" : 138,
      "original_position" : 101,
      "original_start_line" : null,
      "path" : "src/test/fuzz/versionbits.cpp",
      "position" : 106,
      "pull_request_review_id" : 619265068,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600121543",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600123560"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600123560"
         }
      },
      "author_association" : "MEMBER",
      "body" : "That was originally required, but unnecessary and since NO_TIMEOUT is a maxint, seems annoying to require for no reason.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T02:54:54Z",
      "diff_hunk" : "@@ -474,14 +474,53 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t startheight, int64_t timeoutheight)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n     }\n+    bool CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight);\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CRegTestParams::CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight)\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NO_TIMEOUT)) {\n+        return true;\n+    }\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight != Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight != Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)) {\n+        error = strprintf(\"When one of startheight or timeoutheight is %d, both must be %d\", Consensus::BIP9Deployment::NEVER_ACTIVE, Consensus::BIP9Deployment::NEVER_ACTIVE);\n+        return false;\n+    }\n+    if (startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) return true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600123560",
      "id" : 600123560,
      "in_reply_to_id" : 600087336,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDEyMzU2MA==",
      "original_commit_id" : "bf4bddaac7db767986d29d22b8d866867bb50220",
      "original_line" : 498,
      "original_position" : 102,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 619267592,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600123560",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600123747"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600123747"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Seems best left for a refactor later IMO.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T02:55:28Z",
      "diff_hunk" : "@@ -474,14 +474,53 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t startheight, int64_t timeoutheight)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n     }\n+    bool CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight);\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CRegTestParams::CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600123747",
      "id" : 600123747,
      "in_reply_to_id" : 600111302,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDEyMzc0Nw==",
      "original_commit_id" : "bf4bddaac7db767986d29d22b8d866867bb50220",
      "original_line" : 486,
      "original_position" : 90,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 619267787,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600123747",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600133553"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600133553"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oops. The requirement was intentionally removed, but I didn't notice I had that earlier check. I've removed this line and dropped `NO_TIMEOUT` from the earlier check.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T03:25:36Z",
      "diff_hunk" : "@@ -474,14 +474,53 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t startheight, int64_t timeoutheight)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n     }\n+    bool CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight);\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CRegTestParams::CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight)\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NO_TIMEOUT)) {\n+        return true;\n+    }\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight != Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight != Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)) {\n+        error = strprintf(\"When one of startheight or timeoutheight is %d, both must be %d\", Consensus::BIP9Deployment::NEVER_ACTIVE, Consensus::BIP9Deployment::NEVER_ACTIVE);\n+        return false;\n+    }\n+    if (startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) return true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600133553",
      "id" : 600133553,
      "in_reply_to_id" : 600087336,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDEzMzU1Mw==",
      "original_commit_id" : "bf4bddaac7db767986d29d22b8d866867bb50220",
      "original_line" : 498,
      "original_position" : 102,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 619278328,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600133553",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600133910"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600133910"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think it is reasonable to have the sanity check always performed at startup, but that can be left for a later PR.\r\n\r\nHowever I have removed the overlap with `sanity_check_params` and have that instead call `CheckVBitsHeights` (now part of `CChainParams`) in the test for the height sanity checks.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T03:26:48Z",
      "diff_hunk" : "@@ -474,14 +474,53 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t startheight, int64_t timeoutheight)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n     }\n+    bool CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight);\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CRegTestParams::CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600133910",
      "id" : 600133910,
      "in_reply_to_id" : 600111302,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDEzMzkxMA==",
      "original_commit_id" : "bf4bddaac7db767986d29d22b8d866867bb50220",
      "original_line" : 486,
      "original_position" : 90,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 619278738,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600133910",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600170128"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600170128"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Why have `startheight` and `timeoutheight` as `int`s but as a `int64_t` for `m_min_activation_height`. For the vbparams you had them all as `int64_t`",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T04:53:22Z",
      "diff_hunk" : "@@ -25,19 +25,28 @@ enum DeploymentPos\n struct BIP9Deployment {\n     /** Bit position to select the particular bit in nVersion. */\n     int bit;\n-    /** Start MedianTime for version bits miner confirmation. Can be a date in the past */\n-    int64_t nStartTime;\n-    /** Timeout/expiry MedianTime for the deployment attempt. */\n-    int64_t nTimeout;\n+    /** Start block height for version bits miner confirmation. Must be a retarget block, can be in the past. */\n+    int startheight;\n+    /** Timeout/expiry block height for the deployment attempt. Must be a retarget block. */\n+    int timeoutheight;\n+    /** Threshold for activation */\n+    int threshold;\n+    /**\n+     * If lock in occurs, delay activation until at least this block height. Activations only occur on retargets.\n+     */\n+    int64_t m_min_activation_height{0};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600170128",
      "id" : 600170128,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDE3MDEyOA==",
      "original_commit_id" : "2cb41863abe59717a199a66030185e2d23226a23",
      "original_line" : 37,
      "original_position" : 17,
      "original_start_line" : 29,
      "path" : "src/consensus/params.h",
      "position" : null,
      "pull_request_review_id" : 619322312,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600170128",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600171667"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600171667"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "not a huge deal but this variable should be renamed eventually",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T04:54:54Z",
      "diff_hunk" : "@@ -1243,8 +1242,8 @@ static void BIP9SoftForkDescPushBack(UniValue& softforks, const std::string &nam\n     {\n         bip9.pushKV(\"bit\", consensusParams.vDeployments[id].bit);\n     }\n-    bip9.pushKV(\"start_time\", consensusParams.vDeployments[id].nStartTime);\n-    bip9.pushKV(\"timeout\", consensusParams.vDeployments[id].nTimeout);\n+    bip9.pushKV(\"startheight\", consensusParams.vDeployments[id].startheight);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600171667",
      "id" : 600171667,
      "line" : 1245,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDE3MTY2Nw==",
      "original_commit_id" : "2cb41863abe59717a199a66030185e2d23226a23",
      "original_line" : 1245,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 19,
      "pull_request_review_id" : 619322312,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600171667",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600192616"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600192616"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It should be `int` here, fixed.\r\n\r\nFor vbparams, the string to int parser returns an int64_t, so that's what I use there.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T05:53:31Z",
      "diff_hunk" : "@@ -25,19 +25,28 @@ enum DeploymentPos\n struct BIP9Deployment {\n     /** Bit position to select the particular bit in nVersion. */\n     int bit;\n-    /** Start MedianTime for version bits miner confirmation. Can be a date in the past */\n-    int64_t nStartTime;\n-    /** Timeout/expiry MedianTime for the deployment attempt. */\n-    int64_t nTimeout;\n+    /** Start block height for version bits miner confirmation. Must be a retarget block, can be in the past. */\n+    int startheight;\n+    /** Timeout/expiry block height for the deployment attempt. Must be a retarget block. */\n+    int timeoutheight;\n+    /** Threshold for activation */\n+    int threshold;\n+    /**\n+     * If lock in occurs, delay activation until at least this block height. Activations only occur on retargets.\n+     */\n+    int64_t m_min_activation_height{0};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600192616",
      "id" : 600192616,
      "in_reply_to_id" : 600170128,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDE5MjYxNg==",
      "original_commit_id" : "2cb41863abe59717a199a66030185e2d23226a23",
      "original_line" : 37,
      "original_position" : 17,
      "original_start_line" : 29,
      "path" : "src/consensus/params.h",
      "position" : null,
      "pull_request_review_id" : 619348678,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600192616",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600194376"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600194376"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "By starting here, are we then ignoring if the latest block is signaling?\r\n\r\ncontext:\r\n```\r\n// We track state by previous-block, so the height we should be comparing is +1\r\nconst int64_t height = pindexPrev->nHeight + 1;\r\n```",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T05:58:37Z",
      "diff_hunk" : "@@ -49,20 +57,17 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n         pindexPrev = vToCompute.back();\n         vToCompute.pop_back();\n \n+        // We track state by previous-block, so the height we should be comparing is +1\n+        const int64_t height = pindexPrev->nHeight + 1;\n+\n         switch (state) {\n             case ThresholdState::DEFINED: {\n-                if (pindexPrev->GetMedianTimePast() >= nTimeTimeout) {\n-                    stateNext = ThresholdState::FAILED;\n-                } else if (pindexPrev->GetMedianTimePast() >= nTimeStart) {\n+                if (height >= height_start) {\n                     stateNext = ThresholdState::STARTED;\n                 }\n                 break;\n             }\n             case ThresholdState::STARTED: {\n-                if (pindexPrev->GetMedianTimePast() >= nTimeTimeout) {\n-                    stateNext = ThresholdState::FAILED;\n-                    break;\n-                }\n                 // We need to count\n                 const CBlockIndex* pindexCount = pindexPrev;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600194376",
      "id" : 600194376,
      "line" : 72,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDE5NDM3Ng==",
      "original_commit_id" : "4a37423700f3432b976ada6adbc19e1ce75c7d9a",
      "original_line" : 72,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : 57,
      "pull_request_review_id" : 619350755,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600194376",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600194837"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600194837"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Also for my sanity, is the reason the height check is moved from the beginning to the end of this case because we are using `pindexPrev->nHeight + 1`",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T05:59:56Z",
      "diff_hunk" : "@@ -49,20 +57,17 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n         pindexPrev = vToCompute.back();\n         vToCompute.pop_back();\n \n+        // We track state by previous-block, so the height we should be comparing is +1\n+        const int64_t height = pindexPrev->nHeight + 1;\n+\n         switch (state) {\n             case ThresholdState::DEFINED: {\n-                if (pindexPrev->GetMedianTimePast() >= nTimeTimeout) {\n-                    stateNext = ThresholdState::FAILED;\n-                } else if (pindexPrev->GetMedianTimePast() >= nTimeStart) {\n+                if (height >= height_start) {\n                     stateNext = ThresholdState::STARTED;\n                 }\n                 break;\n             }\n             case ThresholdState::STARTED: {\n-                if (pindexPrev->GetMedianTimePast() >= nTimeTimeout) {\n-                    stateNext = ThresholdState::FAILED;\n-                    break;\n-                }\n                 // We need to count\n                 const CBlockIndex* pindexCount = pindexPrev;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600194837",
      "id" : 600194837,
      "in_reply_to_id" : 600194376,
      "line" : 72,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDE5NDgzNw==",
      "original_commit_id" : "4a37423700f3432b976ada6adbc19e1ce75c7d9a",
      "original_line" : 72,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : 57,
      "pull_request_review_id" : 619351300,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600194837",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600196720"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600196720"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes. Determining whether the threshold is reached is done at the beginning of each signaling period, and determines the state for the entire signaling period. This is checking for whether the threshold is reached in the previous signaling period to determine whether the current signaling period (starting at block `height`) is locked_in. The current block (at `height`) is not part of the previous signaling period, so it is not counted.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T06:05:56Z",
      "diff_hunk" : "@@ -49,20 +57,17 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n         pindexPrev = vToCompute.back();\n         vToCompute.pop_back();\n \n+        // We track state by previous-block, so the height we should be comparing is +1\n+        const int64_t height = pindexPrev->nHeight + 1;\n+\n         switch (state) {\n             case ThresholdState::DEFINED: {\n-                if (pindexPrev->GetMedianTimePast() >= nTimeTimeout) {\n-                    stateNext = ThresholdState::FAILED;\n-                } else if (pindexPrev->GetMedianTimePast() >= nTimeStart) {\n+                if (height >= height_start) {\n                     stateNext = ThresholdState::STARTED;\n                 }\n                 break;\n             }\n             case ThresholdState::STARTED: {\n-                if (pindexPrev->GetMedianTimePast() >= nTimeTimeout) {\n-                    stateNext = ThresholdState::FAILED;\n-                    break;\n-                }\n                 // We need to count\n                 const CBlockIndex* pindexCount = pindexPrev;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600196720",
      "id" : 600196720,
      "in_reply_to_id" : 600194376,
      "line" : 72,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDE5NjcyMA==",
      "original_commit_id" : "4a37423700f3432b976ada6adbc19e1ce75c7d9a",
      "original_line" : 72,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : 57,
      "pull_request_review_id" : 619353696,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600196720",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600197165"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600197165"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Consider a block B just after a retarget period boundary, ie `B->nHeight % 2016 == 0`, and `pindexPrev = B->pprev`. `pindexPrev` was in state `STARTED`. What state should `B` be in? It depends on the signalling of the prior 2016 blocks -- so we test `pindexPrev->nVersion`, `pindexPrev->pprev->nVersion`, etc. If enough signal, we switch to `LOCKED_IN`. If they don't, we check `B->nHeight` (which is `B->prev->nHeight + 1` aka `pindexPrev->nHeight + 1`) to see if it's reached the timeout, and if so switch to `FAILED`.\r\n\r\nThe reason the height check is moved to the end is so that every retarget period that begins in `STARTED` is allowed to transition to `LOCKED_IN` -- previously, if the final period passed the timeout MTP midway through, it would be too late and would unconditionally transition to `FAILED`.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T06:07:11Z",
      "diff_hunk" : "@@ -49,20 +57,17 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n         pindexPrev = vToCompute.back();\n         vToCompute.pop_back();\n \n+        // We track state by previous-block, so the height we should be comparing is +1\n+        const int64_t height = pindexPrev->nHeight + 1;\n+\n         switch (state) {\n             case ThresholdState::DEFINED: {\n-                if (pindexPrev->GetMedianTimePast() >= nTimeTimeout) {\n-                    stateNext = ThresholdState::FAILED;\n-                } else if (pindexPrev->GetMedianTimePast() >= nTimeStart) {\n+                if (height >= height_start) {\n                     stateNext = ThresholdState::STARTED;\n                 }\n                 break;\n             }\n             case ThresholdState::STARTED: {\n-                if (pindexPrev->GetMedianTimePast() >= nTimeTimeout) {\n-                    stateNext = ThresholdState::FAILED;\n-                    break;\n-                }\n                 // We need to count\n                 const CBlockIndex* pindexCount = pindexPrev;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600197165",
      "id" : 600197165,
      "in_reply_to_id" : 600194376,
      "line" : 72,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDE5NzE2NQ==",
      "original_commit_id" : "4a37423700f3432b976ada6adbc19e1ce75c7d9a",
      "original_line" : 72,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : 57,
      "pull_request_review_id" : 619354216,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600197165",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600198282"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600198282"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Also for my sanity, is the reason the height check is moved from the beginning to the end of this case because we are using `pindexPrev->nHeight + 1`\r\n\r\nNo. The height check is moved because BIP 8 specifies that the threshold being reached takes precedence over the timeoutheight being reached. This is because determining whether the threshold is reached would be done at `timeoutheight`. So if the height check came first, the last signaling period would always fail. Instead, we want to succeed if the threshold is reached in the  last signaling period.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T06:10:00Z",
      "diff_hunk" : "@@ -49,20 +57,17 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n         pindexPrev = vToCompute.back();\n         vToCompute.pop_back();\n \n+        // We track state by previous-block, so the height we should be comparing is +1\n+        const int64_t height = pindexPrev->nHeight + 1;\n+\n         switch (state) {\n             case ThresholdState::DEFINED: {\n-                if (pindexPrev->GetMedianTimePast() >= nTimeTimeout) {\n-                    stateNext = ThresholdState::FAILED;\n-                } else if (pindexPrev->GetMedianTimePast() >= nTimeStart) {\n+                if (height >= height_start) {\n                     stateNext = ThresholdState::STARTED;\n                 }\n                 break;\n             }\n             case ThresholdState::STARTED: {\n-                if (pindexPrev->GetMedianTimePast() >= nTimeTimeout) {\n-                    stateNext = ThresholdState::FAILED;\n-                    break;\n-                }\n                 // We need to count\n                 const CBlockIndex* pindexCount = pindexPrev;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600198282",
      "id" : 600198282,
      "in_reply_to_id" : 600194376,
      "line" : 72,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDE5ODI4Mg==",
      "original_commit_id" : "4a37423700f3432b976ada6adbc19e1ce75c7d9a",
      "original_line" : 72,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : 57,
      "pull_request_review_id" : 619355466,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600198282",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Had to rebase due to fuzzer changes",
      "created_at" : "2021-03-24T06:32:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-805540245",
      "id" : 805540245,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwNTU0MDI0NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-24T06:32:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/805540245",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "reACK 2f457ca73ce33557ecff0d45c37c33957b1b0764",
      "created_at" : "2021-03-24T06:38:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-805542966",
      "id" : 805542966,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwNTU0Mjk2Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-24T06:38:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/805542966",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600435983"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600435983"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Any reason to not enforce NO_TIMEOUT here?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T12:35:34Z",
      "diff_hunk" : "@@ -474,14 +474,51 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t startheight, int64_t timeoutheight)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n     }\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CChainParams::CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight) const\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600435983",
      "id" : 600435983,
      "line" : 490,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDQzNTk4Mw==",
      "original_commit_id" : "ce207a8f161ee50986705e33c8fe6676fde9caf0",
      "original_line" : 490,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 116,
      "pull_request_review_id" : 619663226,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600435983",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600440384"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600440384"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I know this is just regtest, but an integral type of size 64-bit will be truncated if assigned to an integral type of size 32-bit ",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T12:41:47Z",
      "diff_hunk" : "@@ -474,14 +474,51 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t startheight, int64_t timeoutheight)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600440384",
      "id" : 600440384,
      "line" : 480,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDQ0MDM4NA==",
      "original_commit_id" : "ce207a8f161ee50986705e33c8fe6676fde9caf0",
      "original_line" : 480,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 106,
      "pull_request_review_id" : 619663226,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600440384",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600441865"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600441865"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why is this changed?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T12:43:53Z",
      "diff_hunk" : "@@ -25,13 +25,13 @@ class TestConditionChecker : public AbstractThresholdConditionChecker\n     const Consensus::Params dummy_params{};\n \n public:\n-    const int64_t m_begin;\n-    const int64_t m_end;\n-    const int m_period;\n-    const int m_threshold;\n-    const int m_bit;\n+    const int m_begin = 0;\n+    const int m_end = 0;\n+    const int m_period = 0;\n+    const int m_threshold = 0;\n+    const int m_bit = 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600441865",
      "id" : 600441865,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDQ0MTg2NQ==",
      "original_commit_id" : "ce207a8f161ee50986705e33c8fe6676fde9caf0",
      "original_line" : 32,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/test/fuzz/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 619663226,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600441865",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Tested as follows:\r\n\r\n- made unit tests fail by manually breaking the unit test `versionbits_test` in various ways\r\n- made unit tests fail by introducing off-by-one errors in all the relevant spots in `versionbits.cpp`\r\n- ensure no failure if cache is disabled by removing cache store statements in `versionbits.cpp`\r\n- manually tested with a single local regtest node\r\n- manually tested a reorg with two local regtest nodes going from `STARTED` to `LOCKED_IN` and back to `STARTED` when the reorg removes a single signalling block that brought the deployment just over the threshold\r\n",
      "created_at" : "2021-03-24T15:13:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-805910099",
      "id" : 805910099,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwNTkxMDA5OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-24T15:13:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/805910099",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/107096?v=4",
         "events_url" : "https://api.github.com/users/devrandom/events{/privacy}",
         "followers_url" : "https://api.github.com/users/devrandom/followers",
         "following_url" : "https://api.github.com/users/devrandom/following{/other_user}",
         "gists_url" : "https://api.github.com/users/devrandom/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/devrandom",
         "id" : 107096,
         "login" : "devrandom",
         "node_id" : "MDQ6VXNlcjEwNzA5Ng==",
         "organizations_url" : "https://api.github.com/users/devrandom/orgs",
         "received_events_url" : "https://api.github.com/users/devrandom/received_events",
         "repos_url" : "https://api.github.com/users/devrandom/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/devrandom/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/devrandom/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/devrandom"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600599585"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600599585"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Not well-defined, not very friendly (it's  a max int value), and ignored anyway. (third time addressing this)",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T15:34:57Z",
      "diff_hunk" : "@@ -474,14 +474,51 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t startheight, int64_t timeoutheight)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n     }\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CChainParams::CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight) const\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600599585",
      "id" : 600599585,
      "in_reply_to_id" : 600435983,
      "line" : 490,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDU5OTU4NQ==",
      "original_commit_id" : "ce207a8f161ee50986705e33c8fe6676fde9caf0",
      "original_line" : 490,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 116,
      "pull_request_review_id" : 619881059,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600599585",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600600405"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600600405"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe have CheckVBitsHeights check this",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T15:35:49Z",
      "diff_hunk" : "@@ -474,14 +474,51 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t startheight, int64_t timeoutheight)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600600405",
      "id" : 600600405,
      "in_reply_to_id" : 600440384,
      "line" : 480,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDYwMDQwNQ==",
      "original_commit_id" : "ce207a8f161ee50986705e33c8fe6676fde9caf0",
      "original_line" : 480,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 106,
      "pull_request_review_id" : 619882116,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600600405",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600659716"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600659716"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Change these to `int` and changed the parsing to use `ParseInt32` instead. Also added a test for out of range values.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T16:37:06Z",
      "diff_hunk" : "@@ -474,14 +474,51 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t startheight, int64_t timeoutheight)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600659716",
      "id" : 600659716,
      "in_reply_to_id" : 600440384,
      "line" : 480,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDY1OTcxNg==",
      "original_commit_id" : "ce207a8f161ee50986705e33c8fe6676fde9caf0",
      "original_line" : 480,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 106,
      "pull_request_review_id" : 619959905,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600659716",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600659966"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600659966"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Bad rebase conflict resolution, reverted.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T16:37:22Z",
      "diff_hunk" : "@@ -25,13 +25,13 @@ class TestConditionChecker : public AbstractThresholdConditionChecker\n     const Consensus::Params dummy_params{};\n \n public:\n-    const int64_t m_begin;\n-    const int64_t m_end;\n-    const int m_period;\n-    const int m_threshold;\n-    const int m_bit;\n+    const int m_begin = 0;\n+    const int m_end = 0;\n+    const int m_period = 0;\n+    const int m_threshold = 0;\n+    const int m_bit = 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600659966",
      "id" : 600659966,
      "in_reply_to_id" : 600441865,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDY1OTk2Ng==",
      "original_commit_id" : "ce207a8f161ee50986705e33c8fe6676fde9caf0",
      "original_line" : 32,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/test/fuzz/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 619960207,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600659966",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600918273"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600918273"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: `min_activation_height`",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T22:35:12Z",
      "diff_hunk" : "@@ -116,6 +116,9 @@ class CChainParams\n     const MapAssumeutxo& Assumeutxo() const { return m_assumeutxo_data; }\n \n     const ChainTxData& TxData() const { return chainTxData; }\n+\n+    /** Check that the given heights make sense */\n+    bool CheckVBitsHeights(std::string& error, int startheight, int timeoutheight, int min_actvation_height) const;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600918273",
      "id" : 600918273,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDkxODI3Mw==",
      "original_commit_id" : "dd363edd6578a782fcbddbcc57e1446ed7af4f36",
      "original_line" : 121,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/chainparams.h",
      "position" : null,
      "pull_request_review_id" : 620285728,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600918273",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600921169"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600921169"
         }
      },
      "author_association" : "MEMBER",
      "body" : "\"Threshold for lockin. Must be a minimum of block per retarget period\"",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T22:41:41Z",
      "diff_hunk" : "@@ -25,19 +25,28 @@ enum DeploymentPos\n struct BIP9Deployment {\n     /** Bit position to select the particular bit in nVersion. */\n     int bit;\n-    /** Start MedianTime for version bits miner confirmation. Can be a date in the past */\n-    int64_t nStartTime;\n-    /** Timeout/expiry MedianTime for the deployment attempt. */\n-    int64_t nTimeout;\n+    /** Start block height for version bits miner confirmation. Must be a retarget block, can be in the past. */\n+    int startheight;\n+    /** Timeout/expiry block height for the deployment attempt. Must be a retarget block. */\n+    int timeoutheight;\n+    /** Threshold for activation */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600921169",
      "id" : 600921169,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDkyMTE2OQ==",
      "original_commit_id" : "dd363edd6578a782fcbddbcc57e1446ed7af4f36",
      "original_line" : 32,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/consensus/params.h",
      "position" : null,
      "pull_request_review_id" : 620285728,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600921169",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600931062"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600931062"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In commit \"Migrate versionbits to use height instead of MTP\"\r\n\r\nNit: feels a bit strange to have this in CChainParams. Maybe put it in versionbits.{h,cpp}?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-24T23:05:30Z",
      "diff_hunk" : "@@ -116,6 +116,9 @@ class CChainParams\n     const MapAssumeutxo& Assumeutxo() const { return m_assumeutxo_data; }\n \n     const ChainTxData& TxData() const { return chainTxData; }\n+\n+    /** Check that the given heights make sense */\n+    bool CheckVBitsHeights(std::string& error, int startheight, int timeoutheight) const;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600931062",
      "id" : 600931062,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDkzMTA2Mg==",
      "original_commit_id" : "e43c8add3451ac653d306351f50b12942238938e",
      "original_line" : 121,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/chainparams.h",
      "position" : null,
      "pull_request_review_id" : 620300576,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600931062",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600953665"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600953665"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Do you have test coverage for threshold taking precedence over reaching timeout ? This diff doesn't break `feature_bip8.py`\r\n\r\n```\r\n@@ -77,10 +78,11 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\r\n                     }\r\n                     pindexCount = pindexCount->pprev;\r\n                 }\r\n+                if (height >= height_timeout) {\r\n+                    stateNext = ThresholdState::FAILED;\r\n+                }\r\n                 if (count >= nThreshold) {\r\n                     stateNext = ThresholdState::LOCKED_IN;\r\n-                } else if (height >= height_timeout) {\r\n-                    stateNext = ThresholdState::FAILED;\r\n                 }\r\n                 break;\r\n             }\r\n```",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T00:06:06Z",
      "diff_hunk" : "@@ -74,12 +79,16 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n                 }\n                 if (count >= nThreshold) {\n                     stateNext = ThresholdState::LOCKED_IN;\n+                } else if (height >= height_timeout) {\n+                    stateNext = ThresholdState::FAILED;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600953665",
      "id" : 600953665,
      "line" : 83,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDk1MzY2NQ==",
      "original_commit_id" : "dd363edd6578a782fcbddbcc57e1446ed7af4f36",
      "original_line" : 83,
      "original_position" : 64,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : 64,
      "pull_request_review_id" : 620285728,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600953665",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600956176"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600956176"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think you should document \"For all blocks after the LOCKED_IN retarget period, if min activation height has been reached\" ?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T00:13:19Z",
      "diff_hunk" : "@@ -24,10 +24,10 @@ static const int32_t VERSIONBITS_NUM_BITS = 29;\n  */\n enum class ThresholdState {\n     DEFINED,   // First state that each softfork starts out as. The genesis block is by definition in this state for each deployment.\n-    STARTED,   // For blocks past the starttime.\n+    STARTED,   // For blocks past the startheight.\n     LOCKED_IN, // For one retarget period after the first retarget period with STARTED blocks of which at least threshold have the associated bit set in nVersion.\n     ACTIVE,    // For all blocks after the LOCKED_IN retarget period (final state)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600956176",
      "id" : 600956176,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDk1NjE3Ng==",
      "original_commit_id" : "dd363edd6578a782fcbddbcc57e1446ed7af4f36",
      "original_line" : 29,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/versionbits.h",
      "position" : null,
      "pull_request_review_id" : 620285728,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600956176",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600958804"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600958804"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe display \"min_activation_height\" if relevant (!= 0) ?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T00:20:58Z",
      "diff_hunk" : "@@ -1296,24 +1295,24 @@ RPCHelpMan getblockchaininfo()\n                         {\n                             {RPCResult::Type::OBJ, \"xxxx\", \"name of the softfork\",\n                             {\n-                                {RPCResult::Type::STR, \"type\", \"one of \\\"buried\\\", \\\"bip9\\\"\"},\n-                                {RPCResult::Type::OBJ, \"bip9\", \"status of bip9 softforks (only for \\\"bip9\\\" type)\",\n+                                {RPCResult::Type::STR, \"type\", \"one of \\\"buried\\\", \\\"bip8\\\"\"},\n+                                {RPCResult::Type::OBJ, \"bip8\", \"status of BIP 8 softforks (only for \\\"bip8\\\" type)\",\n                                 {\n                                     {RPCResult::Type::STR, \"status\", \"one of \\\"defined\\\", \\\"started\\\", \\\"locked_in\\\", \\\"active\\\", \\\"failed\\\"\"},\n                                     {RPCResult::Type::NUM, \"bit\", \"the bit (0-28) in the block version field used to signal this softfork (only for \\\"started\\\" status)\"},\n-                                    {RPCResult::Type::NUM_TIME, \"start_time\", \"the minimum median time past of a block at which the bit gains its meaning\"},\n-                                    {RPCResult::Type::NUM_TIME, \"timeout\", \"the median time past of a block at which the deployment is considered failed if not yet locked in\"},\n+                                    {RPCResult::Type::NUM, \"startheight\", \"the minimum height of a block at which the bit gains its meaning\"},\n+                                    {RPCResult::Type::NUM, \"timeoutheight\", \"the height of a block at which the deployment is considered failed if not yet locked in\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600958804",
      "id" : 600958804,
      "line" : 1305,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDk1ODgwNA==",
      "original_commit_id" : "dd363edd6578a782fcbddbcc57e1446ed7af4f36",
      "original_line" : 1305,
      "original_position" : 49,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 50,
      "pull_request_review_id" : 620285728,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600958804",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600959256"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600959256"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In commit \"Migrate versionbits to use height instead of MTP\":\r\n\r\nYou could incorporate the later `if (never_active_test) assert(state == ThresholdState::DEFINED);` here as `assert(!never_active_test);`.\r\n\r\n(I found this by drawing the finite state machine based on these tests, and noticed this line was missing before noticing it's done explicitly later)",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T00:22:34Z",
      "diff_hunk" : "@@ -281,47 +260,46 @@ FUZZ_TARGET_INIT(versionbits, initialize)\n \n     // since is straightforward:\n     assert(since % period == 0);\n-    assert(0 <= since && since <= current_block->nHeight + 1);\n+    assert(0 <= since && since <= height);\n     if (state == exp_state) {\n         assert(since == exp_since);\n     } else {\n-        assert(since == current_block->nHeight + 1);\n+        assert(since == height);\n     }\n \n     // state is where everything interesting is\n     switch (state) {\n     case ThresholdState::DEFINED:\n         assert(since == 0);\n         assert(exp_state == ThresholdState::DEFINED);\n-        assert(current_block->GetMedianTimePast() < checker.m_begin);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n+        assert(never_active_test || height < checker.m_begin);\n         break;\n     case ThresholdState::STARTED:\n-        assert(current_block->GetMedianTimePast() >= checker.m_begin);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n+        assert(height >= checker.m_begin);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600959256",
      "id" : 600959256,
      "line" : 282,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDk1OTI1Ng==",
      "original_commit_id" : "e43c8add3451ac653d306351f50b12942238938e",
      "original_line" : 282,
      "original_position" : 167,
      "original_start_line" : null,
      "path" : "src/test/fuzz/versionbits.cpp",
      "position" : 173,
      "pull_request_review_id" : 620300576,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600959256",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600959896"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600959896"
         }
      },
      "author_association" : "MEMBER",
      "body" : "According to BIP 8, \"timeoutheight must be at least 4096 blocks (2 retarget intervals) after startheight\" ?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T00:24:49Z",
      "diff_hunk" : "@@ -466,14 +474,60 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int startheight, int timeoutheight, int min_activation_height)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n+        consensus.vDeployments[d].m_min_activation_height = min_activation_height;\n     }\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CChainParams::CheckVBitsHeights(std::string& error, int startheight, int timeoutheight, int min_activation_height) const\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) {\n+        return true;\n+    }\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight != Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight != Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)) {\n+        error = strprintf(\"When one of startheight or timeoutheight is %d, both must be %d\", Consensus::BIP9Deployment::NEVER_ACTIVE, Consensus::BIP9Deployment::NEVER_ACTIVE);\n+        return false;\n+    }\n+\n+    // Actual params must be on retarget block\n+    if (startheight < 0) {\n+        error = strprintf(\"Invalid startheight (%d), cannot be negative (except for never or always active special cases)\", startheight);\n+        return false;\n+    }\n+    if (timeoutheight < 0) {\n+        error = strprintf(\"Invalid timeoutheight (%d), cannot be negative (except for never or always active special cases)\", timeoutheight);\n+        return false;\n+    }\n+    if (startheight % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid startheight (%d), must be a multiple of %d\", startheight, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (timeoutheight != Consensus::BIP9Deployment::NO_TIMEOUT && timeoutheight % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid timeoutheight (%d), must be a multiple of %d\", timeoutheight, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (min_activation_height < 0) {\n+        error = strprintf(\"Invalid minimum activation height (%d), cannot be negative\", min_activation_height);\n+        return false;\n+    }\n+    if (min_activation_height % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid minimum activation height (%d), must be a multiple of %d\", min_activation_height, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (timeoutheight < startheight + (int)consensus.nMinerConfirmationWindow) {\n+        error = strprintf(\"Invalid timeoutheight (%d), must be at least one period greater than the startheight (%d)\", timeoutheight, startheight);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600959896",
      "id" : 600959896,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDk1OTg5Ng==",
      "original_commit_id" : "dd363edd6578a782fcbddbcc57e1446ed7af4f36",
      "original_line" : 525,
      "original_position" : 151,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 620285728,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600959896",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600959952"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600959952"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In commit \"Migrate versionbits to use height instead of MTP\":\r\n\r\nI believe you should do `assert(exp_state == ThresholdState::FAILED || (exp_state == ThresholdState::STARTED && blocks_sig < threshold));` here instead. As stated, nothing prevents the FSM implementation from going from STARTED->FAILED when the threshold is reached in the last period.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T00:25:02Z",
      "diff_hunk" : "@@ -281,47 +260,46 @@ FUZZ_TARGET_INIT(versionbits, initialize)\n \n     // since is straightforward:\n     assert(since % period == 0);\n-    assert(0 <= since && since <= current_block->nHeight + 1);\n+    assert(0 <= since && since <= height);\n     if (state == exp_state) {\n         assert(since == exp_since);\n     } else {\n-        assert(since == current_block->nHeight + 1);\n+        assert(since == height);\n     }\n \n     // state is where everything interesting is\n     switch (state) {\n     case ThresholdState::DEFINED:\n         assert(since == 0);\n         assert(exp_state == ThresholdState::DEFINED);\n-        assert(current_block->GetMedianTimePast() < checker.m_begin);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n+        assert(never_active_test || height < checker.m_begin);\n         break;\n     case ThresholdState::STARTED:\n-        assert(current_block->GetMedianTimePast() >= checker.m_begin);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n+        assert(height >= checker.m_begin);\n         if (exp_state == ThresholdState::STARTED) {\n+            assert(height < checker.m_end);\n             assert(blocks_sig < threshold);\n         } else {\n             assert(exp_state == ThresholdState::DEFINED);\n         }\n         break;\n     case ThresholdState::LOCKED_IN:\n         assert(exp_state == ThresholdState::STARTED);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n         assert(blocks_sig >= threshold);\n         break;\n     case ThresholdState::ACTIVE:\n         assert(exp_state == ThresholdState::ACTIVE || exp_state == ThresholdState::LOCKED_IN);\n         break;\n     case ThresholdState::FAILED:\n-        assert(current_block->GetMedianTimePast() >= checker.m_end);\n-        assert(exp_state != ThresholdState::LOCKED_IN && exp_state != ThresholdState::ACTIVE);\n+        assert(height >= checker.m_begin);\n+        assert(height >= checker.m_end);\n+        assert(exp_state == ThresholdState::FAILED || exp_state == ThresholdState::STARTED);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600959952",
      "id" : 600959952,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDk1OTk1Mg==",
      "original_commit_id" : "e43c8add3451ac653d306351f50b12942238938e",
      "original_line" : 296,
      "original_position" : 188,
      "original_start_line" : null,
      "path" : "src/test/fuzz/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 620300576,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600959952",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600960472"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600960472"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think BIP 8 implies that if min_activation_height is set, it must be superior to start_height. Though not explicit \"minimum_activation_height should be set to several retarget periods in the future if the startheight is to be very soon after software with parameters is expected to be released.\"",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T00:26:29Z",
      "diff_hunk" : "@@ -466,14 +474,60 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int startheight, int timeoutheight, int min_activation_height)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n+        consensus.vDeployments[d].m_min_activation_height = min_activation_height;\n     }\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CChainParams::CheckVBitsHeights(std::string& error, int startheight, int timeoutheight, int min_activation_height) const\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) {\n+        return true;\n+    }\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight != Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight != Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)) {\n+        error = strprintf(\"When one of startheight or timeoutheight is %d, both must be %d\", Consensus::BIP9Deployment::NEVER_ACTIVE, Consensus::BIP9Deployment::NEVER_ACTIVE);\n+        return false;\n+    }\n+\n+    // Actual params must be on retarget block\n+    if (startheight < 0) {\n+        error = strprintf(\"Invalid startheight (%d), cannot be negative (except for never or always active special cases)\", startheight);\n+        return false;\n+    }\n+    if (timeoutheight < 0) {\n+        error = strprintf(\"Invalid timeoutheight (%d), cannot be negative (except for never or always active special cases)\", timeoutheight);\n+        return false;\n+    }\n+    if (startheight % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid startheight (%d), must be a multiple of %d\", startheight, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (timeoutheight != Consensus::BIP9Deployment::NO_TIMEOUT && timeoutheight % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid timeoutheight (%d), must be a multiple of %d\", timeoutheight, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (min_activation_height < 0) {\n+        error = strprintf(\"Invalid minimum activation height (%d), cannot be negative\", min_activation_height);\n+        return false;\n+    }\n+    if (min_activation_height % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid minimum activation height (%d), must be a multiple of %d\", min_activation_height, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (timeoutheight < startheight + (int)consensus.nMinerConfirmationWindow) {\n+        error = strprintf(\"Invalid timeoutheight (%d), must be at least one period greater than the startheight (%d)\", timeoutheight, startheight);\n+        return false;\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600960472",
      "id" : 600960472,
      "line" : 527,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDk2MDQ3Mg==",
      "original_commit_id" : "dd363edd6578a782fcbddbcc57e1446ed7af4f36",
      "original_line" : 527,
      "original_position" : 153,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 153,
      "pull_request_review_id" : 620285728,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600960472",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600966055"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600966055"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The minimum activation height can be any value, it does not need to be greater than the start_height. If it is less than or equal to the start height, it just means that the locked_in period does not become extended. We use `0` to mean \"no minimum activation height\", but any height less than or equal to the start_height achieves the same effect, and in fact, all are handled the same way.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T00:43:52Z",
      "diff_hunk" : "@@ -466,14 +474,60 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int startheight, int timeoutheight, int min_activation_height)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n+        consensus.vDeployments[d].m_min_activation_height = min_activation_height;\n     }\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CChainParams::CheckVBitsHeights(std::string& error, int startheight, int timeoutheight, int min_activation_height) const\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) {\n+        return true;\n+    }\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight != Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight != Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)) {\n+        error = strprintf(\"When one of startheight or timeoutheight is %d, both must be %d\", Consensus::BIP9Deployment::NEVER_ACTIVE, Consensus::BIP9Deployment::NEVER_ACTIVE);\n+        return false;\n+    }\n+\n+    // Actual params must be on retarget block\n+    if (startheight < 0) {\n+        error = strprintf(\"Invalid startheight (%d), cannot be negative (except for never or always active special cases)\", startheight);\n+        return false;\n+    }\n+    if (timeoutheight < 0) {\n+        error = strprintf(\"Invalid timeoutheight (%d), cannot be negative (except for never or always active special cases)\", timeoutheight);\n+        return false;\n+    }\n+    if (startheight % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid startheight (%d), must be a multiple of %d\", startheight, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (timeoutheight != Consensus::BIP9Deployment::NO_TIMEOUT && timeoutheight % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid timeoutheight (%d), must be a multiple of %d\", timeoutheight, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (min_activation_height < 0) {\n+        error = strprintf(\"Invalid minimum activation height (%d), cannot be negative\", min_activation_height);\n+        return false;\n+    }\n+    if (min_activation_height % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid minimum activation height (%d), must be a multiple of %d\", min_activation_height, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (timeoutheight < startheight + (int)consensus.nMinerConfirmationWindow) {\n+        error = strprintf(\"Invalid timeoutheight (%d), must be at least one period greater than the startheight (%d)\", timeoutheight, startheight);\n+        return false;\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600966055",
      "id" : 600966055,
      "in_reply_to_id" : 600960472,
      "line" : 527,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDk2NjA1NQ==",
      "original_commit_id" : "dd363edd6578a782fcbddbcc57e1446ed7af4f36",
      "original_line" : 527,
      "original_position" : 153,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 153,
      "pull_request_review_id" : 620338978,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600966055",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600981350"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600981350"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T01:32:50Z",
      "diff_hunk" : "@@ -116,6 +116,9 @@ class CChainParams\n     const MapAssumeutxo& Assumeutxo() const { return m_assumeutxo_data; }\n \n     const ChainTxData& TxData() const { return chainTxData; }\n+\n+    /** Check that the given heights make sense */\n+    bool CheckVBitsHeights(std::string& error, int startheight, int timeoutheight, int min_actvation_height) const;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600981350",
      "id" : 600981350,
      "in_reply_to_id" : 600918273,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDk4MTM1MA==",
      "original_commit_id" : "dd363edd6578a782fcbddbcc57e1446ed7af4f36",
      "original_line" : 121,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/chainparams.h",
      "position" : null,
      "pull_request_review_id" : 620363077,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600981350",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600981393"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600981393"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Expanded this comment.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T01:32:58Z",
      "diff_hunk" : "@@ -25,19 +25,28 @@ enum DeploymentPos\n struct BIP9Deployment {\n     /** Bit position to select the particular bit in nVersion. */\n     int bit;\n-    /** Start MedianTime for version bits miner confirmation. Can be a date in the past */\n-    int64_t nStartTime;\n-    /** Timeout/expiry MedianTime for the deployment attempt. */\n-    int64_t nTimeout;\n+    /** Start block height for version bits miner confirmation. Must be a retarget block, can be in the past. */\n+    int startheight;\n+    /** Timeout/expiry block height for the deployment attempt. Must be a retarget block. */\n+    int timeoutheight;\n+    /** Threshold for activation */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600981393",
      "id" : 600981393,
      "in_reply_to_id" : 600921169,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDk4MTM5Mw==",
      "original_commit_id" : "dd363edd6578a782fcbddbcc57e1446ed7af4f36",
      "original_line" : 32,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/consensus/params.h",
      "position" : null,
      "pull_request_review_id" : 620363265,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:32:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600981393",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600981966"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600981966"
         }
      },
      "author_association" : "MEMBER",
      "body" : "A unit test fails, although not because it explicitly tests this behavior. I've added such a test to feature_bip8.py.\r\n\r\nHowever this particular diff wouldn't fail because it still moves to `LOCKED_IN` when the threshold is reached. You need to use `else if` in order for the `height >= height_timeout` check to take precedence.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T01:34:55Z",
      "diff_hunk" : "@@ -74,12 +79,16 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n                 }\n                 if (count >= nThreshold) {\n                     stateNext = ThresholdState::LOCKED_IN;\n+                } else if (height >= height_timeout) {\n+                    stateNext = ThresholdState::FAILED;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600981966",
      "id" : 600981966,
      "in_reply_to_id" : 600953665,
      "line" : 83,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDk4MTk2Ng==",
      "original_commit_id" : "dd363edd6578a782fcbddbcc57e1446ed7af4f36",
      "original_line" : 83,
      "original_position" : 64,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : 64,
      "pull_request_review_id" : 620366344,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:34:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600981966",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600981999"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600981999"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T01:35:04Z",
      "diff_hunk" : "@@ -24,10 +24,10 @@ static const int32_t VERSIONBITS_NUM_BITS = 29;\n  */\n enum class ThresholdState {\n     DEFINED,   // First state that each softfork starts out as. The genesis block is by definition in this state for each deployment.\n-    STARTED,   // For blocks past the starttime.\n+    STARTED,   // For blocks past the startheight.\n     LOCKED_IN, // For one retarget period after the first retarget period with STARTED blocks of which at least threshold have the associated bit set in nVersion.\n     ACTIVE,    // For all blocks after the LOCKED_IN retarget period (final state)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600981999",
      "id" : 600981999,
      "in_reply_to_id" : 600956176,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDk4MTk5OQ==",
      "original_commit_id" : "dd363edd6578a782fcbddbcc57e1446ed7af4f36",
      "original_line" : 29,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/versionbits.h",
      "position" : null,
      "pull_request_review_id" : 620366588,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:35:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600981999",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600982186"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600982186"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Changed to output it always.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T01:35:28Z",
      "diff_hunk" : "@@ -1296,24 +1295,24 @@ RPCHelpMan getblockchaininfo()\n                         {\n                             {RPCResult::Type::OBJ, \"xxxx\", \"name of the softfork\",\n                             {\n-                                {RPCResult::Type::STR, \"type\", \"one of \\\"buried\\\", \\\"bip9\\\"\"},\n-                                {RPCResult::Type::OBJ, \"bip9\", \"status of bip9 softforks (only for \\\"bip9\\\" type)\",\n+                                {RPCResult::Type::STR, \"type\", \"one of \\\"buried\\\", \\\"bip8\\\"\"},\n+                                {RPCResult::Type::OBJ, \"bip8\", \"status of BIP 8 softforks (only for \\\"bip8\\\" type)\",\n                                 {\n                                     {RPCResult::Type::STR, \"status\", \"one of \\\"defined\\\", \\\"started\\\", \\\"locked_in\\\", \\\"active\\\", \\\"failed\\\"\"},\n                                     {RPCResult::Type::NUM, \"bit\", \"the bit (0-28) in the block version field used to signal this softfork (only for \\\"started\\\" status)\"},\n-                                    {RPCResult::Type::NUM_TIME, \"start_time\", \"the minimum median time past of a block at which the bit gains its meaning\"},\n-                                    {RPCResult::Type::NUM_TIME, \"timeout\", \"the median time past of a block at which the deployment is considered failed if not yet locked in\"},\n+                                    {RPCResult::Type::NUM, \"startheight\", \"the minimum height of a block at which the bit gains its meaning\"},\n+                                    {RPCResult::Type::NUM, \"timeoutheight\", \"the height of a block at which the deployment is considered failed if not yet locked in\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600982186",
      "id" : 600982186,
      "in_reply_to_id" : 600958804,
      "line" : 1305,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDk4MjE4Ng==",
      "original_commit_id" : "dd363edd6578a782fcbddbcc57e1446ed7af4f36",
      "original_line" : 1305,
      "original_position" : 49,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 50,
      "pull_request_review_id" : 620367192,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:35:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600982186",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600982212"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600982212"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T01:35:37Z",
      "diff_hunk" : "@@ -466,14 +474,60 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int startheight, int timeoutheight, int min_activation_height)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n+        consensus.vDeployments[d].m_min_activation_height = min_activation_height;\n     }\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CChainParams::CheckVBitsHeights(std::string& error, int startheight, int timeoutheight, int min_activation_height) const\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) {\n+        return true;\n+    }\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight != Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight != Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)) {\n+        error = strprintf(\"When one of startheight or timeoutheight is %d, both must be %d\", Consensus::BIP9Deployment::NEVER_ACTIVE, Consensus::BIP9Deployment::NEVER_ACTIVE);\n+        return false;\n+    }\n+\n+    // Actual params must be on retarget block\n+    if (startheight < 0) {\n+        error = strprintf(\"Invalid startheight (%d), cannot be negative (except for never or always active special cases)\", startheight);\n+        return false;\n+    }\n+    if (timeoutheight < 0) {\n+        error = strprintf(\"Invalid timeoutheight (%d), cannot be negative (except for never or always active special cases)\", timeoutheight);\n+        return false;\n+    }\n+    if (startheight % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid startheight (%d), must be a multiple of %d\", startheight, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (timeoutheight != Consensus::BIP9Deployment::NO_TIMEOUT && timeoutheight % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid timeoutheight (%d), must be a multiple of %d\", timeoutheight, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (min_activation_height < 0) {\n+        error = strprintf(\"Invalid minimum activation height (%d), cannot be negative\", min_activation_height);\n+        return false;\n+    }\n+    if (min_activation_height % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid minimum activation height (%d), must be a multiple of %d\", min_activation_height, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (timeoutheight < startheight + (int)consensus.nMinerConfirmationWindow) {\n+        error = strprintf(\"Invalid timeoutheight (%d), must be at least one period greater than the startheight (%d)\", timeoutheight, startheight);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600982212",
      "id" : 600982212,
      "in_reply_to_id" : 600959896,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDk4MjIxMg==",
      "original_commit_id" : "dd363edd6578a782fcbddbcc57e1446ed7af4f36",
      "original_line" : 525,
      "original_position" : 151,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 620367404,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:35:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600982212",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600982551"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600982551"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Moving it to `versionbits.{h,cpp}` requires adding `versionbits.cpp` to `libbitcoin_common` and this introduces a bunch of other build system issues that I don't want to figure out. I've moved the function out of `CChainParams` though so that it could be moved elsewhere in the future as a move-only.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T01:36:44Z",
      "diff_hunk" : "@@ -116,6 +116,9 @@ class CChainParams\n     const MapAssumeutxo& Assumeutxo() const { return m_assumeutxo_data; }\n \n     const ChainTxData& TxData() const { return chainTxData; }\n+\n+    /** Check that the given heights make sense */\n+    bool CheckVBitsHeights(std::string& error, int startheight, int timeoutheight) const;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600982551",
      "id" : 600982551,
      "in_reply_to_id" : 600931062,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDk4MjU1MQ==",
      "original_commit_id" : "e43c8add3451ac653d306351f50b12942238938e",
      "original_line" : 121,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/chainparams.h",
      "position" : null,
      "pull_request_review_id" : 620369073,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:36:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600982551",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600982730"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600982730"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Added the new assert, but I did not remove the later assert as it seems like it is still useful to have that there.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T01:37:20Z",
      "diff_hunk" : "@@ -281,47 +260,46 @@ FUZZ_TARGET_INIT(versionbits, initialize)\n \n     // since is straightforward:\n     assert(since % period == 0);\n-    assert(0 <= since && since <= current_block->nHeight + 1);\n+    assert(0 <= since && since <= height);\n     if (state == exp_state) {\n         assert(since == exp_since);\n     } else {\n-        assert(since == current_block->nHeight + 1);\n+        assert(since == height);\n     }\n \n     // state is where everything interesting is\n     switch (state) {\n     case ThresholdState::DEFINED:\n         assert(since == 0);\n         assert(exp_state == ThresholdState::DEFINED);\n-        assert(current_block->GetMedianTimePast() < checker.m_begin);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n+        assert(never_active_test || height < checker.m_begin);\n         break;\n     case ThresholdState::STARTED:\n-        assert(current_block->GetMedianTimePast() >= checker.m_begin);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n+        assert(height >= checker.m_begin);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600982730",
      "id" : 600982730,
      "in_reply_to_id" : 600959256,
      "line" : 282,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDk4MjczMA==",
      "original_commit_id" : "e43c8add3451ac653d306351f50b12942238938e",
      "original_line" : 282,
      "original_position" : 167,
      "original_start_line" : null,
      "path" : "src/test/fuzz/versionbits.cpp",
      "position" : 173,
      "pull_request_review_id" : 620369927,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:37:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600982730",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600982858"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600982858"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T01:37:37Z",
      "diff_hunk" : "@@ -281,47 +260,46 @@ FUZZ_TARGET_INIT(versionbits, initialize)\n \n     // since is straightforward:\n     assert(since % period == 0);\n-    assert(0 <= since && since <= current_block->nHeight + 1);\n+    assert(0 <= since && since <= height);\n     if (state == exp_state) {\n         assert(since == exp_since);\n     } else {\n-        assert(since == current_block->nHeight + 1);\n+        assert(since == height);\n     }\n \n     // state is where everything interesting is\n     switch (state) {\n     case ThresholdState::DEFINED:\n         assert(since == 0);\n         assert(exp_state == ThresholdState::DEFINED);\n-        assert(current_block->GetMedianTimePast() < checker.m_begin);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n+        assert(never_active_test || height < checker.m_begin);\n         break;\n     case ThresholdState::STARTED:\n-        assert(current_block->GetMedianTimePast() >= checker.m_begin);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n+        assert(height >= checker.m_begin);\n         if (exp_state == ThresholdState::STARTED) {\n+            assert(height < checker.m_end);\n             assert(blocks_sig < threshold);\n         } else {\n             assert(exp_state == ThresholdState::DEFINED);\n         }\n         break;\n     case ThresholdState::LOCKED_IN:\n         assert(exp_state == ThresholdState::STARTED);\n-        assert(current_block->GetMedianTimePast() < checker.m_end);\n         assert(blocks_sig >= threshold);\n         break;\n     case ThresholdState::ACTIVE:\n         assert(exp_state == ThresholdState::ACTIVE || exp_state == ThresholdState::LOCKED_IN);\n         break;\n     case ThresholdState::FAILED:\n-        assert(current_block->GetMedianTimePast() >= checker.m_end);\n-        assert(exp_state != ThresholdState::LOCKED_IN && exp_state != ThresholdState::ACTIVE);\n+        assert(height >= checker.m_begin);\n+        assert(height >= checker.m_end);\n+        assert(exp_state == ThresholdState::FAILED || exp_state == ThresholdState::STARTED);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r600982858",
      "id" : 600982858,
      "in_reply_to_id" : 600959952,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDk4Mjg1OA==",
      "original_commit_id" : "e43c8add3451ac653d306351f50b12942238938e",
      "original_line" : 296,
      "original_position" : 188,
      "original_start_line" : null,
      "path" : "src/test/fuzz/versionbits.cpp",
      "position" : null,
      "pull_request_review_id" : 620370410,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T01:37:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600982858",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK for all but the unit and functional tests (which I've only casually looked over). I inferred the finite state machine diagram based on the fuzz test code (making a few suggestions), and compared that with the implemented logic.",
      "created_at" : "2021-03-25T02:30:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-806315887",
      "id" : 806315887,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwNjMxNTg4Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-25T02:30:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/806315887",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "re-ACK 2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T14:12:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-806826159",
      "id" : 806826159,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwNjgyNjE1OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-25T14:12:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/806826159",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r601787443"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601787443"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why? Just one period should be enough...",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T19:37:55Z",
      "diff_hunk" : "@@ -466,14 +474,60 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int startheight, int timeoutheight, int min_activation_height)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n+        consensus.vDeployments[d].m_min_activation_height = min_activation_height;\n     }\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CheckVBitsHeights(std::string& error, const Consensus::Params& consensus, int startheight, int timeoutheight, int min_activation_height)\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) {\n+        return true;\n+    }\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight != Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight != Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)) {\n+        error = strprintf(\"When one of startheight or timeoutheight is %d, both must be %d\", Consensus::BIP9Deployment::NEVER_ACTIVE, Consensus::BIP9Deployment::NEVER_ACTIVE);\n+        return false;\n+    }\n+\n+    // Actual params must be on retarget block\n+    if (startheight < 0) {\n+        error = strprintf(\"Invalid startheight (%d), cannot be negative (except for never or always active special cases)\", startheight);\n+        return false;\n+    }\n+    if (timeoutheight < 0) {\n+        error = strprintf(\"Invalid timeoutheight (%d), cannot be negative (except for never or always active special cases)\", timeoutheight);\n+        return false;\n+    }\n+    if (startheight % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid startheight (%d), must be a multiple of %d\", startheight, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (timeoutheight != Consensus::BIP9Deployment::NO_TIMEOUT && timeoutheight % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid timeoutheight (%d), must be a multiple of %d\", timeoutheight, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (min_activation_height < 0) {\n+        error = strprintf(\"Invalid minimum activation height (%d), cannot be negative\", min_activation_height);\n+        return false;\n+    }\n+    if (min_activation_height % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid minimum activation height (%d), must be a multiple of %d\", min_activation_height, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (timeoutheight < startheight + (2 * (int)consensus.nMinerConfirmationWindow)) {\n+        error = strprintf(\"Invalid timeoutheight (%d), must be at least two periods greater than the startheight (%d)\", timeoutheight, startheight);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r601787443",
      "id" : 601787443,
      "line" : 525,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMTc4NzQ0Mw==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 525,
      "original_position" : 151,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 151,
      "pull_request_review_id" : 621511609,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T22:42:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601787443",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK 2e55bcedb8d73e49620a5731196bf7e23bb53ccc\r\n\r\nIdeally a choice on a Speedy Trial PR would have been made by now so I could focus review and testing on one PR and one approach. Spreading review over two competing PRs is doing none of us any favors. I would have liked to have spent more time testing this PR before ACKing it but I think the biggest danger at this point is spreading review too thinly across two PRs. ",
      "created_at" : "2021-03-25T20:46:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-807455957",
      "id" : 807455957,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwNzQ1NTk1Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-25T20:46:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/807455957",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r601844921"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601844921"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think this variable name changed.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T21:16:16Z",
      "diff_hunk" : "@@ -25,19 +25,28 @@ enum DeploymentPos\n struct BIP9Deployment {\n     /** Bit position to select the particular bit in nVersion. */\n     int bit;\n-    /** Start MedianTime for version bits miner confirmation. Can be a date in the past */\n-    int64_t nStartTime;\n-    /** Timeout/expiry MedianTime for the deployment attempt. */\n-    int64_t nTimeout;\n+    /** Start block height for version bits miner confirmation. Must be a retarget block, can be in the past. */\n+    int startheight;\n+    /** Timeout/expiry block height for the deployment attempt. Must be a retarget block. */\n+    int timeoutheight;\n+    /** Threshold for lockin. Must be at least nRuleChangeActivationThreshold for that network. */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r601844921",
      "id" : 601844921,
      "line" : 32,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMTg0NDkyMQ==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 32,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/consensus/params.h",
      "position" : 12,
      "pull_request_review_id" : 621586250,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T21:16:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601844921",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r601850371"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601850371"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Will fix if I retouch.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T21:26:25Z",
      "diff_hunk" : "@@ -25,19 +25,28 @@ enum DeploymentPos\n struct BIP9Deployment {\n     /** Bit position to select the particular bit in nVersion. */\n     int bit;\n-    /** Start MedianTime for version bits miner confirmation. Can be a date in the past */\n-    int64_t nStartTime;\n-    /** Timeout/expiry MedianTime for the deployment attempt. */\n-    int64_t nTimeout;\n+    /** Start block height for version bits miner confirmation. Must be a retarget block, can be in the past. */\n+    int startheight;\n+    /** Timeout/expiry block height for the deployment attempt. Must be a retarget block. */\n+    int timeoutheight;\n+    /** Threshold for lockin. Must be at least nRuleChangeActivationThreshold for that network. */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r601850371",
      "id" : 601850371,
      "in_reply_to_id" : 601844921,
      "line" : 32,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMTg1MDM3MQ==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 32,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/consensus/params.h",
      "position" : 12,
      "pull_request_review_id" : 621593202,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T21:26:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601850371",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r601882419"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601882419"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Probably should either hide this when 0, or use starttime+2*period",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T22:35:32Z",
      "diff_hunk" : "@@ -1243,8 +1242,9 @@ static void BIP9SoftForkDescPushBack(UniValue& softforks, const std::string &nam\n     {\n         bip9.pushKV(\"bit\", consensusParams.vDeployments[id].bit);\n     }\n-    bip9.pushKV(\"start_time\", consensusParams.vDeployments[id].nStartTime);\n-    bip9.pushKV(\"timeout\", consensusParams.vDeployments[id].nTimeout);\n+    bip9.pushKV(\"startheight\", consensusParams.vDeployments[id].startheight);\n+    bip9.pushKV(\"timeoutheight\", consensusParams.vDeployments[id].timeoutheight);\n+    bip9.pushKV(\"minimum_activation_height\", consensusParams.vDeployments[id].m_min_activation_height);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r601882419",
      "id" : 601882419,
      "line" : 1247,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMTg4MjQxOQ==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 1247,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 21,
      "pull_request_review_id" : 621511609,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T22:42:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601882419",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r601888435"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601888435"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Enforces this sentence in BIP 8:\r\n\r\n> timeoutheight must be at least 4096 blocks (2 retarget intervals) after startheight. ",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T22:50:11Z",
      "diff_hunk" : "@@ -466,14 +474,60 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int startheight, int timeoutheight, int min_activation_height)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n+        consensus.vDeployments[d].m_min_activation_height = min_activation_height;\n     }\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CheckVBitsHeights(std::string& error, const Consensus::Params& consensus, int startheight, int timeoutheight, int min_activation_height)\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) {\n+        return true;\n+    }\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight != Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight != Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)) {\n+        error = strprintf(\"When one of startheight or timeoutheight is %d, both must be %d\", Consensus::BIP9Deployment::NEVER_ACTIVE, Consensus::BIP9Deployment::NEVER_ACTIVE);\n+        return false;\n+    }\n+\n+    // Actual params must be on retarget block\n+    if (startheight < 0) {\n+        error = strprintf(\"Invalid startheight (%d), cannot be negative (except for never or always active special cases)\", startheight);\n+        return false;\n+    }\n+    if (timeoutheight < 0) {\n+        error = strprintf(\"Invalid timeoutheight (%d), cannot be negative (except for never or always active special cases)\", timeoutheight);\n+        return false;\n+    }\n+    if (startheight % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid startheight (%d), must be a multiple of %d\", startheight, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (timeoutheight != Consensus::BIP9Deployment::NO_TIMEOUT && timeoutheight % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid timeoutheight (%d), must be a multiple of %d\", timeoutheight, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (min_activation_height < 0) {\n+        error = strprintf(\"Invalid minimum activation height (%d), cannot be negative\", min_activation_height);\n+        return false;\n+    }\n+    if (min_activation_height % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid minimum activation height (%d), must be a multiple of %d\", min_activation_height, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (timeoutheight < startheight + (2 * (int)consensus.nMinerConfirmationWindow)) {\n+        error = strprintf(\"Invalid timeoutheight (%d), must be at least two periods greater than the startheight (%d)\", timeoutheight, startheight);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r601888435",
      "id" : 601888435,
      "in_reply_to_id" : 601787443,
      "line" : 525,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMTg4ODQzNQ==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 525,
      "original_position" : 151,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 151,
      "pull_request_review_id" : 621640065,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T22:50:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601888435",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r601888570"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601888570"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think it's fine to always display.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-25T22:50:29Z",
      "diff_hunk" : "@@ -1243,8 +1242,9 @@ static void BIP9SoftForkDescPushBack(UniValue& softforks, const std::string &nam\n     {\n         bip9.pushKV(\"bit\", consensusParams.vDeployments[id].bit);\n     }\n-    bip9.pushKV(\"start_time\", consensusParams.vDeployments[id].nStartTime);\n-    bip9.pushKV(\"timeout\", consensusParams.vDeployments[id].nTimeout);\n+    bip9.pushKV(\"startheight\", consensusParams.vDeployments[id].startheight);\n+    bip9.pushKV(\"timeoutheight\", consensusParams.vDeployments[id].timeoutheight);\n+    bip9.pushKV(\"minimum_activation_height\", consensusParams.vDeployments[id].m_min_activation_height);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r601888570",
      "id" : 601888570,
      "in_reply_to_id" : 601882419,
      "line" : 1247,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMTg4ODU3MA==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 1247,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 21,
      "pull_request_review_id" : 621640212,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-25T22:50:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601888570",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r601913537"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601913537"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "That's needed for lot=true/MUST_SIGNAL to work consistently with lot=false. Could also be solved by adding a transition directly from DEFINED to MUST_SIGNAL (skipping STARTED) I think.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-26T00:00:54Z",
      "diff_hunk" : "@@ -466,14 +474,60 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int startheight, int timeoutheight, int min_activation_height)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n+        consensus.vDeployments[d].m_min_activation_height = min_activation_height;\n     }\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CheckVBitsHeights(std::string& error, const Consensus::Params& consensus, int startheight, int timeoutheight, int min_activation_height)\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) {\n+        return true;\n+    }\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight != Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight != Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)) {\n+        error = strprintf(\"When one of startheight or timeoutheight is %d, both must be %d\", Consensus::BIP9Deployment::NEVER_ACTIVE, Consensus::BIP9Deployment::NEVER_ACTIVE);\n+        return false;\n+    }\n+\n+    // Actual params must be on retarget block\n+    if (startheight < 0) {\n+        error = strprintf(\"Invalid startheight (%d), cannot be negative (except for never or always active special cases)\", startheight);\n+        return false;\n+    }\n+    if (timeoutheight < 0) {\n+        error = strprintf(\"Invalid timeoutheight (%d), cannot be negative (except for never or always active special cases)\", timeoutheight);\n+        return false;\n+    }\n+    if (startheight % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid startheight (%d), must be a multiple of %d\", startheight, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (timeoutheight != Consensus::BIP9Deployment::NO_TIMEOUT && timeoutheight % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid timeoutheight (%d), must be a multiple of %d\", timeoutheight, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (min_activation_height < 0) {\n+        error = strprintf(\"Invalid minimum activation height (%d), cannot be negative\", min_activation_height);\n+        return false;\n+    }\n+    if (min_activation_height % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid minimum activation height (%d), must be a multiple of %d\", min_activation_height, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (timeoutheight < startheight + (2 * (int)consensus.nMinerConfirmationWindow)) {\n+        error = strprintf(\"Invalid timeoutheight (%d), must be at least two periods greater than the startheight (%d)\", timeoutheight, startheight);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r601913537",
      "id" : 601913537,
      "in_reply_to_id" : 601787443,
      "line" : 525,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMTkxMzUzNw==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 525,
      "original_position" : 151,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 151,
      "pull_request_review_id" : 621668975,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-26T00:00:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601913537",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r601986590"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601986590"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nah, probably not worth changing. One period is probably crazy anyway. And if we ever do need it, we can add the extra logic for it at that time.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-26T03:05:29Z",
      "diff_hunk" : "@@ -466,14 +474,60 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int startheight, int timeoutheight, int min_activation_height)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n+        consensus.vDeployments[d].m_min_activation_height = min_activation_height;\n     }\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CheckVBitsHeights(std::string& error, const Consensus::Params& consensus, int startheight, int timeoutheight, int min_activation_height)\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) {\n+        return true;\n+    }\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight != Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight != Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)) {\n+        error = strprintf(\"When one of startheight or timeoutheight is %d, both must be %d\", Consensus::BIP9Deployment::NEVER_ACTIVE, Consensus::BIP9Deployment::NEVER_ACTIVE);\n+        return false;\n+    }\n+\n+    // Actual params must be on retarget block\n+    if (startheight < 0) {\n+        error = strprintf(\"Invalid startheight (%d), cannot be negative (except for never or always active special cases)\", startheight);\n+        return false;\n+    }\n+    if (timeoutheight < 0) {\n+        error = strprintf(\"Invalid timeoutheight (%d), cannot be negative (except for never or always active special cases)\", timeoutheight);\n+        return false;\n+    }\n+    if (startheight % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid startheight (%d), must be a multiple of %d\", startheight, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (timeoutheight != Consensus::BIP9Deployment::NO_TIMEOUT && timeoutheight % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid timeoutheight (%d), must be a multiple of %d\", timeoutheight, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (min_activation_height < 0) {\n+        error = strprintf(\"Invalid minimum activation height (%d), cannot be negative\", min_activation_height);\n+        return false;\n+    }\n+    if (min_activation_height % consensus.nMinerConfirmationWindow != 0) {\n+        error = strprintf(\"Invalid minimum activation height (%d), must be a multiple of %d\", min_activation_height, consensus.nMinerConfirmationWindow);\n+        return false;\n+    }\n+    if (timeoutheight < startheight + (2 * (int)consensus.nMinerConfirmationWindow)) {\n+        error = strprintf(\"Invalid timeoutheight (%d), must be at least two periods greater than the startheight (%d)\", timeoutheight, startheight);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r601986590",
      "id" : 601986590,
      "in_reply_to_id" : 601787443,
      "line" : 525,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMTk4NjU5MA==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 525,
      "original_position" : 151,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 151,
      "pull_request_review_id" : 621751220,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-26T03:05:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601986590",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "As of commit 2e55bcedb8d73e49620a5731196bf7e23bb53ccc, lightly tested the likely outcomes of ST and confirmed that `getblockchainfo` returned the expected values whether activation was achieved or not, before and after the minimum_activation_period.  I did not check close enough to detect off-by-one errors or other small details.\r\n\r\nTested creating a regtest chain with this branch and `-vbparams=taproot:@144:@576:@1008`, producing enough blocks to lockin and activate taproot, synced them to a taproot-oblivious 0.20.1 node, then upgraded that node to this branch with the same vbparams and confirmed that the upgraded node's `getblockchaininfo` results indicated it would be enforcing taproot.\r\n\r\nI skimmed the code and didn't see any problems, but I don't feel confident enough in my reviewing abilities to say it definitely is fine.",
      "created_at" : "2021-03-26T03:16:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-807905868",
      "id" : 807905868,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwNzkwNTg2OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-26T03:16:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/807905868",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/61096?v=4",
         "events_url" : "https://api.github.com/users/harding/events{/privacy}",
         "followers_url" : "https://api.github.com/users/harding/followers",
         "following_url" : "https://api.github.com/users/harding/following{/other_user}",
         "gists_url" : "https://api.github.com/users/harding/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/harding",
         "id" : 61096,
         "login" : "harding",
         "node_id" : "MDQ6VXNlcjYxMDk2",
         "organizations_url" : "https://api.github.com/users/harding/orgs",
         "received_events_url" : "https://api.github.com/users/harding/received_events",
         "repos_url" : "https://api.github.com/users/harding/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/harding/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/harding/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/harding"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602103259"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602103259"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Any reason to use gArgs in the previous line, then m_node.args here? Might be better to just use a local symbol to avoid potentially polluting other tests",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-26T08:41:35Z",
      "diff_hunk" : "@@ -263,105 +241,72 @@ BOOST_AUTO_TEST_CASE(versionbits_params)\n BOOST_AUTO_TEST_CASE(versionbits_computeblockversion)\n {\n     // Check that ComputeBlockVersion will set the appropriate bit correctly\n-    // on mainnet.\n-    const auto chainParams = CreateChainParams(*m_node.args, CBaseChainParams::MAIN);\n-    const Consensus::Params &mainnetParams = chainParams->GetConsensus();\n+    const auto period = CreateChainParams(*m_node.args, CBaseChainParams::REGTEST)->GetConsensus().nMinerConfirmationWindow;\n+    gArgs.ForceSetArg(\"-vbparams\", strprintf(\"testdummy:@%s:@%s\", period, period * 3));\n+    const auto chainParams = CreateChainParams(*m_node.args, CBaseChainParams::REGTEST);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602103259",
      "id" : 602103259,
      "line" : 282,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjEwMzI1OQ==",
      "original_commit_id" : "c95287e378a4a4a79b9632d7647015e96dc3a21c",
      "original_line" : 246,
      "original_position" : 154,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 283,
      "pull_request_review_id" : 621891984,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-26T10:43:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602103259",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602103976"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602103976"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`ForceSetArg` isn't possible on mainnet? (This discussion thread can be closed?)",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-26T08:42:48Z",
      "diff_hunk" : "@@ -284,100 +259,67 @@ BOOST_AUTO_TEST_CASE(versionbits_params)\n BOOST_AUTO_TEST_CASE(versionbits_computeblockversion)\n {\n     // Check that ComputeBlockVersion will set the appropriate bit correctly\n-    // on mainnet.\n-    const auto chainParams = CreateChainParams(*m_node.args, CBaseChainParams::MAIN);\n+    const auto period = CreateChainParams(*m_node.args, CBaseChainParams::REGTEST)->GetConsensus().nMinerConfirmationWindow;\n+    gArgs.ForceSetArg(\"-vbparams\", strprintf(\"testdummy:@%s:@%s\", period, period * 2));\n+    const auto chainParams = CreateChainParams(*m_node.args, CBaseChainParams::REGTEST);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602103976",
      "id" : 602103976,
      "in_reply_to_id" : 591529768,
      "line" : 282,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjEwMzk3Ng==",
      "original_commit_id" : "d4c40a52cdc0e07647b6543427e621585028fcdd",
      "original_line" : 282,
      "original_position" : 147,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 283,
      "pull_request_review_id" : 621891984,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-26T10:43:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602103976",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602104995"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602104995"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Any reason to not enforce `startheight >= nMinerConfirmationWindow`? Otherwise it is possible to violate the \"2 period rule\" by setting `@0:@288`.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-26T08:44:37Z",
      "diff_hunk" : "@@ -474,14 +474,51 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int startheight, int timeoutheight)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n     }\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CheckVBitsHeights(std::string& error, const Consensus::Params& consensus, int startheight, int timeoutheight)\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) {\n+        return true;\n+    }\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight != Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight != Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)) {\n+        error = strprintf(\"When one of startheight or timeoutheight is %d, both must be %d\", Consensus::BIP9Deployment::NEVER_ACTIVE, Consensus::BIP9Deployment::NEVER_ACTIVE);\n+        return false;\n+    }\n+\n+    // Actual params must be on retarget block\n+    if (startheight < 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602104995",
      "id" : 602104995,
      "line" : 500,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjEwNDk5NQ==",
      "original_commit_id" : "c95287e378a4a4a79b9632d7647015e96dc3a21c",
      "original_line" : 499,
      "original_position" : 103,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 126,
      "pull_request_review_id" : 621891984,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-26T10:43:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602104995",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602109184"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602109184"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Then it could be ignored for NEVER as well or what is the reason to treat ALWAYS different from NEVER?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-26T08:51:28Z",
      "diff_hunk" : "@@ -474,14 +474,51 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t startheight, int64_t timeoutheight)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n     }\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CChainParams::CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight) const\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602109184",
      "id" : 602109184,
      "in_reply_to_id" : 600435983,
      "line" : 490,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjEwOTE4NA==",
      "original_commit_id" : "ce207a8f161ee50986705e33c8fe6676fde9caf0",
      "original_line" : 490,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 116,
      "pull_request_review_id" : 621891984,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-26T10:43:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602109184",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602115708"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602115708"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Any reason to not assert this transition can't happen?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-26T09:01:53Z",
      "diff_hunk" : "@@ -49,20 +56,17 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n         pindexPrev = vToCompute.back();\n         vToCompute.pop_back();\n \n+        // We track state by previous-block, so the height we should be comparing is +1\n+        const int64_t height = pindexPrev->nHeight + 1;\n+\n         switch (state) {\n             case ThresholdState::DEFINED: {\n-                if (pindexPrev->GetMedianTimePast() >= nTimeTimeout) {\n-                    stateNext = ThresholdState::FAILED;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602115708",
      "id" : 602115708,
      "line" : 55,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjExNTcwOA==",
      "original_commit_id" : "c95287e378a4a4a79b9632d7647015e96dc3a21c",
      "original_line" : 55,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : 44,
      "pull_request_review_id" : 621891984,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-26T10:43:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602115708",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "ACK https://github.com/bitcoin/bitcoin/pull/21392/commits/2e55bcedb8d73e49620a5731196bf7e23bb53ccc\r\n\r\nIn addition to the testing in https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-805910099 I also checked that the fuzzer detects various off-by-one errors I manually introduced into the implementation.\r\n",
      "created_at" : "2021-03-26T14:28:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-808263580",
      "id" : 808263580,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwODI2MzU4MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-26T14:28:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/808263580",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/107096?v=4",
         "events_url" : "https://api.github.com/users/devrandom/events{/privacy}",
         "followers_url" : "https://api.github.com/users/devrandom/followers",
         "following_url" : "https://api.github.com/users/devrandom/following{/other_user}",
         "gists_url" : "https://api.github.com/users/devrandom/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/devrandom",
         "id" : 107096,
         "login" : "devrandom",
         "node_id" : "MDQ6VXNlcjEwNzA5Ng==",
         "organizations_url" : "https://api.github.com/users/devrandom/orgs",
         "received_events_url" : "https://api.github.com/users/devrandom/received_events",
         "repos_url" : "https://api.github.com/users/devrandom/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/devrandom/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/devrandom/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/devrandom"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "reACK 2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-26T15:55:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-808329160",
      "id" : 808329160,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwODMyOTE2MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-26T15:55:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/808329160",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602434108"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602434108"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In `GetStateFor`, we are checking that both `startheight` and `timeoutheight` are `NEVER_ACTIVE` in order to return the correct state for never active. It only checks `startheight` is `ALWAYS_ACTIVE` when determining always active. This behavior came from #19573 and I didn't change it. Perhaps @luke-jr or @ajtowns could explain why that is.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-26T16:32:05Z",
      "diff_hunk" : "@@ -474,14 +474,51 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t startheight, int64_t timeoutheight)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n     }\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CChainParams::CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight) const\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602434108",
      "id" : 602434108,
      "in_reply_to_id" : 600435983,
      "line" : 490,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjQzNDEwOA==",
      "original_commit_id" : "ce207a8f161ee50986705e33c8fe6676fde9caf0",
      "original_line" : 490,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 116,
      "pull_request_review_id" : 622334185,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-26T16:32:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602434108",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602434973"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602434973"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think that's being checked by the test cases.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-26T16:33:24Z",
      "diff_hunk" : "@@ -49,20 +56,17 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n         pindexPrev = vToCompute.back();\n         vToCompute.pop_back();\n \n+        // We track state by previous-block, so the height we should be comparing is +1\n+        const int64_t height = pindexPrev->nHeight + 1;\n+\n         switch (state) {\n             case ThresholdState::DEFINED: {\n-                if (pindexPrev->GetMedianTimePast() >= nTimeTimeout) {\n-                    stateNext = ThresholdState::FAILED;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602434973",
      "id" : 602434973,
      "in_reply_to_id" : 602115708,
      "line" : 55,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjQzNDk3Mw==",
      "original_commit_id" : "c95287e378a4a4a79b9632d7647015e96dc3a21c",
      "original_line" : 55,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : 44,
      "pull_request_review_id" : 622335433,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-26T16:33:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602434973",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602435063"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602435063"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If I need to retouch",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-26T16:33:33Z",
      "diff_hunk" : "@@ -263,105 +241,72 @@ BOOST_AUTO_TEST_CASE(versionbits_params)\n BOOST_AUTO_TEST_CASE(versionbits_computeblockversion)\n {\n     // Check that ComputeBlockVersion will set the appropriate bit correctly\n-    // on mainnet.\n-    const auto chainParams = CreateChainParams(*m_node.args, CBaseChainParams::MAIN);\n-    const Consensus::Params &mainnetParams = chainParams->GetConsensus();\n+    const auto period = CreateChainParams(*m_node.args, CBaseChainParams::REGTEST)->GetConsensus().nMinerConfirmationWindow;\n+    gArgs.ForceSetArg(\"-vbparams\", strprintf(\"testdummy:@%s:@%s\", period, period * 3));\n+    const auto chainParams = CreateChainParams(*m_node.args, CBaseChainParams::REGTEST);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602435063",
      "id" : 602435063,
      "in_reply_to_id" : 602103259,
      "line" : 282,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjQzNTA2Mw==",
      "original_commit_id" : "c95287e378a4a4a79b9632d7647015e96dc3a21c",
      "original_line" : 246,
      "original_position" : 154,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 283,
      "pull_request_review_id" : 622335574,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-26T16:33:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602435063",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602435134"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602435134"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If I need to retouch",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-26T16:33:37Z",
      "diff_hunk" : "@@ -474,14 +474,51 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int startheight, int timeoutheight)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n     }\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CheckVBitsHeights(std::string& error, const Consensus::Params& consensus, int startheight, int timeoutheight)\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) {\n+        return true;\n+    }\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight != Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || (startheight != Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)) {\n+        error = strprintf(\"When one of startheight or timeoutheight is %d, both must be %d\", Consensus::BIP9Deployment::NEVER_ACTIVE, Consensus::BIP9Deployment::NEVER_ACTIVE);\n+        return false;\n+    }\n+\n+    // Actual params must be on retarget block\n+    if (startheight < 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602435134",
      "id" : 602435134,
      "in_reply_to_id" : 602104995,
      "line" : 500,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjQzNTEzNA==",
      "original_commit_id" : "c95287e378a4a4a79b9632d7647015e96dc3a21c",
      "original_line" : 499,
      "original_position" : 103,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 126,
      "pull_request_review_id" : 622335617,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-26T16:33:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602435134",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602460624"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602460624"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's simply a non-change from the original BIP9 code.\r\n\r\nI don't see a reason to change it here.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-26T17:11:21Z",
      "diff_hunk" : "@@ -474,14 +474,51 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t startheight, int64_t timeoutheight)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n     }\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CChainParams::CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight) const\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602460624",
      "id" : 602460624,
      "in_reply_to_id" : 600435983,
      "line" : 490,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjQ2MDYyNA==",
      "original_commit_id" : "ce207a8f161ee50986705e33c8fe6676fde9caf0",
      "original_line" : 490,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 116,
      "pull_request_review_id" : 622369827,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-26T17:11:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602460624",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602485622"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602485622"
         }
      },
      "author_association" : "MEMBER",
      "body" : "ALWAYS and NEVER are not specified in any BIP, they are special magic values in our code only (introduced in this pull request). Treating them in the same fashion will be less code, and less code complexity.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-26T17:49:47Z",
      "diff_hunk" : "@@ -474,14 +474,51 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t startheight, int64_t timeoutheight)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n     }\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CChainParams::CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight) const\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602485622",
      "id" : 602485622,
      "in_reply_to_id" : 600435983,
      "line" : 490,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjQ4NTYyMg==",
      "original_commit_id" : "ce207a8f161ee50986705e33c8fe6676fde9caf0",
      "original_line" : 490,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 116,
      "pull_request_review_id" : 622402330,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-26T17:49:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602485622",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602567588"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602567588"
         }
      },
      "author_association" : "MEMBER",
      "body" : "NO_TIMEOUT is not introduced in this PR. Feel free to refactor in a followup... or achow can do it here if you care so strongly. I don't see that it matters either way.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-26T20:25:04Z",
      "diff_hunk" : "@@ -474,14 +474,51 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t startheight, int64_t timeoutheight)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n     }\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CChainParams::CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight) const\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602567588",
      "id" : 602567588,
      "in_reply_to_id" : 600435983,
      "line" : 490,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjU2NzU4OA==",
      "original_commit_id" : "ce207a8f161ee50986705e33c8fe6676fde9caf0",
      "original_line" : 490,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 116,
      "pull_request_review_id" : 622510084,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-26T20:25:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602567588",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602568868"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602568868"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think we can leave this for a followup.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-26T20:27:31Z",
      "diff_hunk" : "@@ -474,14 +474,51 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t startheight, int64_t timeoutheight)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n     }\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CChainParams::CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight) const\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602568868",
      "id" : 602568868,
      "in_reply_to_id" : 600435983,
      "line" : 490,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjU2ODg2OA==",
      "original_commit_id" : "ce207a8f161ee50986705e33c8fe6676fde9caf0",
      "original_line" : 490,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 116,
      "pull_request_review_id" : 622511635,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-26T20:27:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602568868",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602649296"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602649296"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke I think that the rationale is that NO_TIMEOUT *isn't* a special value (unlike `ALWAYS_ACTIVE` and `NEVER_ACTIVE`), it's just a timestamp very far in the future.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-27T01:21:47Z",
      "diff_hunk" : "@@ -474,14 +474,51 @@ class CRegTestParams : public CChainParams {\n     /**\n      * Allows modifying the Version Bits regtest parameters.\n      */\n-    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t startheight, int64_t timeoutheight)\n     {\n-        consensus.vDeployments[d].nStartTime = nStartTime;\n-        consensus.vDeployments[d].nTimeout = nTimeout;\n+        consensus.vDeployments[d].startheight = startheight;\n+        consensus.vDeployments[d].timeoutheight = timeoutheight;\n     }\n     void UpdateActivationParametersFromArgs(const ArgsManager& args);\n };\n \n+bool CChainParams::CheckVBitsHeights(std::string& error, int64_t startheight, int64_t timeoutheight) const\n+{\n+    // Special always or never active cases\n+    if ((startheight == Consensus::BIP9Deployment::NEVER_ACTIVE && timeoutheight == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+        || startheight == Consensus::BIP9Deployment::ALWAYS_ACTIVE) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602649296",
      "id" : 602649296,
      "in_reply_to_id" : 600435983,
      "line" : 490,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjY0OTI5Ng==",
      "original_commit_id" : "ce207a8f161ee50986705e33c8fe6676fde9caf0",
      "original_line" : 490,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 116,
      "pull_request_review_id" : 622605741,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-27T02:13:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602649296",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602649377"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602649377"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@benthecarman To what?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-27T01:22:41Z",
      "diff_hunk" : "@@ -1243,8 +1242,8 @@ static void BIP9SoftForkDescPushBack(UniValue& softforks, const std::string &nam\n     {\n         bip9.pushKV(\"bit\", consensusParams.vDeployments[id].bit);\n     }\n-    bip9.pushKV(\"start_time\", consensusParams.vDeployments[id].nStartTime);\n-    bip9.pushKV(\"timeout\", consensusParams.vDeployments[id].nTimeout);\n+    bip9.pushKV(\"startheight\", consensusParams.vDeployments[id].startheight);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602649377",
      "id" : 602649377,
      "in_reply_to_id" : 600171667,
      "line" : 1245,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjY0OTM3Nw==",
      "original_commit_id" : "2cb41863abe59717a199a66030185e2d23226a23",
      "original_line" : 1245,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 19,
      "pull_request_review_id" : 622605741,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-27T02:13:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602649377",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602655239"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602655239"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The fuzz test has all transitions of the state machine implemented (in a \"come from\" form rather than a \"go to\" form). I don't think it's possible to make incorrect transitions that it won't detect.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-27T02:15:26Z",
      "diff_hunk" : "@@ -49,20 +56,17 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n         pindexPrev = vToCompute.back();\n         vToCompute.pop_back();\n \n+        // We track state by previous-block, so the height we should be comparing is +1\n+        const int64_t height = pindexPrev->nHeight + 1;\n+\n         switch (state) {\n             case ThresholdState::DEFINED: {\n-                if (pindexPrev->GetMedianTimePast() >= nTimeTimeout) {\n-                    stateNext = ThresholdState::FAILED;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602655239",
      "id" : 602655239,
      "in_reply_to_id" : 602115708,
      "line" : 55,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjY1NTIzOQ==",
      "original_commit_id" : "c95287e378a4a4a79b9632d7647015e96dc3a21c",
      "original_line" : 55,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : 44,
      "pull_request_review_id" : 622610198,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-27T02:15:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602655239",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602655356"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602655356"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`bip8` or `vbits` since this is no longer a BIP 9 implementation ",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-27T02:16:27Z",
      "diff_hunk" : "@@ -1243,8 +1242,8 @@ static void BIP9SoftForkDescPushBack(UniValue& softforks, const std::string &nam\n     {\n         bip9.pushKV(\"bit\", consensusParams.vDeployments[id].bit);\n     }\n-    bip9.pushKV(\"start_time\", consensusParams.vDeployments[id].nStartTime);\n-    bip9.pushKV(\"timeout\", consensusParams.vDeployments[id].nTimeout);\n+    bip9.pushKV(\"startheight\", consensusParams.vDeployments[id].startheight);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602655356",
      "id" : 602655356,
      "in_reply_to_id" : 600171667,
      "line" : 1245,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjY1NTM1Ng==",
      "original_commit_id" : "2cb41863abe59717a199a66030185e2d23226a23",
      "original_line" : 1245,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 19,
      "pull_request_review_id" : 622610275,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-27T02:16:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602655356",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602655615"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602655615"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oh, sure, I thought you were talking about \"startheight\". This commit only touches observable names, not internal ones.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-27T02:18:27Z",
      "diff_hunk" : "@@ -1243,8 +1242,8 @@ static void BIP9SoftForkDescPushBack(UniValue& softforks, const std::string &nam\n     {\n         bip9.pushKV(\"bit\", consensusParams.vDeployments[id].bit);\n     }\n-    bip9.pushKV(\"start_time\", consensusParams.vDeployments[id].nStartTime);\n-    bip9.pushKV(\"timeout\", consensusParams.vDeployments[id].nTimeout);\n+    bip9.pushKV(\"startheight\", consensusParams.vDeployments[id].startheight);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602655615",
      "id" : 602655615,
      "in_reply_to_id" : 600171667,
      "line" : 1245,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjY1NTYxNQ==",
      "original_commit_id" : "2cb41863abe59717a199a66030185e2d23226a23",
      "original_line" : 1245,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 19,
      "pull_request_review_id" : 622610439,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-27T02:18:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602655615",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602662943"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602662943"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The mass rename is planned for a followup so that this PR is easier to backport.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-27T03:35:23Z",
      "diff_hunk" : "@@ -1243,8 +1242,8 @@ static void BIP9SoftForkDescPushBack(UniValue& softforks, const std::string &nam\n     {\n         bip9.pushKV(\"bit\", consensusParams.vDeployments[id].bit);\n     }\n-    bip9.pushKV(\"start_time\", consensusParams.vDeployments[id].nStartTime);\n-    bip9.pushKV(\"timeout\", consensusParams.vDeployments[id].nTimeout);\n+    bip9.pushKV(\"startheight\", consensusParams.vDeployments[id].startheight);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602662943",
      "id" : 602662943,
      "in_reply_to_id" : 600171667,
      "line" : 1245,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjY2Mjk0Mw==",
      "original_commit_id" : "2cb41863abe59717a199a66030185e2d23226a23",
      "original_line" : 1245,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 19,
      "pull_request_review_id" : 622615392,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-27T03:35:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602662943",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I think I'm an approach NACK, or at least approach -1, on using heights for activation at this point: they're [incompatible with activating on testnet](https://github.com/bitcoin/bips/pull/1081#pullrequestreview-621934640) due to hash rate inconsistency, and they're incompatible with activation on signet due to custom signets being able to have completely random heights, since anyone can start a new one at any time. They're not especially convenient for activating on mainnet either: we're choosing timeframes and then converting that to expected block heights, but that can have significant errors -- if we want to give people \"3 months\" to review an update before deploying it, and choose block heights to reflect that, we risk both increased hashpower reducing that time substantially, or reduced hashpower introducing unwanted delays.\r\n\r\nThe main arguments I've seen for the height based approach is to avoid the signalling phase being skipped entirely, and to prevent a mandatory signalling phase (UASF/bip148/bip91/etc) from being skipped entirely, even in the event of a substantial loss of hashrate. But those goals can be achieved with the MTP approach as well -- see the top commit on https://github.com/ajtowns/bitcoin/commits/202103-bip9-uasf .\r\n\r\nThere's the additional benefit that it's simpler to explain \"signalling begins at height X and ends at height Y\" than \"signalling begins at the first retarget period after time X, and ends in the last retarget period before time Y\", but that seems like a much lower priority than being able to test activations on testnet and signet prior to activation on mainnet...",
      "created_at" : "2021-03-28T04:56:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-808844563",
      "id" : 808844563,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwODg0NDU2Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-28T04:56:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/808844563",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "For the sake of respecting other reviewers' time, Taproot is already active on the default Signet for testing and experimentation with Taproot transactions. Activating Taproot on testnet seems like a very low priority, certainly a lower priority than ensuring the optimal code is merged for mainnet activation. \r\n\r\nIf you want a summary of the arguments for a consistent use of block height versus using a mix of block height and MTP there is this [SE question](https://bitcoin.stackexchange.com/questions/103854/should-block-height-or-mtp-or-a-mixture-of-both-be-used-in-a-soft-fork-activatio) with two answers, one from harding and one from me summarizing the arguments expressed in the two Speedy Trial PRs. \r\n\r\nThis appears to be the major differentiator between the two PRs. If you would prefer a consistent use of block height I would recommend reviewing this PR. If you would prefer a mix of block height and MTP I would recommend reviewing AJ's alternative Speedy Trial PR.\r\n\r\nAs I've communicated on AJ's PR, spreading review over two competing PRs is doing none of us any favors at this point.\r\n\r\n",
      "created_at" : "2021-03-28T11:55:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-808886402",
      "id" : 808886402,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwODg4NjQwMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-28T11:55:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/808886402",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Also [this](https://github.com/bitcoin/bitcoin/pull/21377#issuecomment-802336038) shows preferences for a consistent use of block height.\r\n\r\n> I don't have a strong view but it appears that @achow101 in #21392 and just by reading the comments in this PR @luke-jr @benthecarman @JeremyRubin @Sjors @roconnor-blockstream @harding all have a preference for a fully height based approach over any use of MTP.\r\n>\r\n> If that isn't the case please correct me. And if anyone else has a view on entirely block height versus some limited use of MTP can you post it on IRC (##taproot-activation)?\r\n>\r\n> The fuzzing PR looks very cool. On that PR @MarcoFalke also expresses an expectation that activation will be based on block heights.\r\n>\r\n> edit: Some additional comments from today's Core dev meeting\r\n>\r\n> \"it comes down to mtp vs block height\" @achow101\r\n>\r\n> \"the main difference between these two PRs are using block height vs MTP \" @amitiuttarwar\r\n>\r\n> \"with mtp, we run the risk of losing 2 signaling periods. with already few signaling periods, this has the possibility of failing to activate due to bad luck\" @achow101\r\n>\r\n> \"the property that achow101's PR improves is a fixed (number) of signals\" @JeremyRubin\r\n\r\nIn addition @JeremyRubin stated [here](https://github.com/bitcoin/bitcoin/pull/21377#issuecomment-802396191) \"I have a preference for fully height based design, correct.\"\r\n\r\nThis is becoming a farce, pure and simple.\r\n\r\n",
      "created_at" : "2021-03-28T12:35:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-808891024",
      "id" : 808891024,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwODg5MTAyNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-28T12:37:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/808891024",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I think I'm an approach NACK, or at least approach -1, on using heights for activation at this point: they're incompatible with activating on testnet due to hash rate inconsistency, and they're incompatible with activation on signet due to custom signets being able to have completely random heights, since anyone can start a new one at any time\r\n\r\nI don't think test networks should be relevant to mainnet's activation mechanisms / consensus rules",
      "created_at" : "2021-03-28T12:48:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-808892479",
      "id" : 808892479,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwODg5MjQ3OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-28T12:48:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/808892479",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602923391"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602923391"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why are you widening height from an `int` (32 bit) to a `int64_t`, and then comparing with `int`s below?",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-28T19:46:59Z",
      "diff_hunk" : "@@ -49,20 +57,17 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n         pindexPrev = vToCompute.back();\n         vToCompute.pop_back();\n \n+        // We track state by previous-block, so the height we should be comparing is +1\n+        const int64_t height = pindexPrev->nHeight + 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602923391",
      "id" : 602923391,
      "line" : 61,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjkyMzM5MQ==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 61,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : 39,
      "pull_request_review_id" : 622776945,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-28T19:46:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602923391",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602924924"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602924924"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Use docstrings for test description to separate from copyright notice",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-28T20:00:02Z",
      "diff_hunk" : "@@ -0,0 +1,124 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602924924",
      "id" : 602924924,
      "line" : 5,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjkyNDkyNA==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 5,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/feature_bip8.py",
      "position" : 5,
      "pull_request_review_id" : 622777889,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-28T20:15:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602924924",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602924979"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602924979"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Separate std library imports from local imports",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-28T20:00:20Z",
      "diff_hunk" : "@@ -0,0 +1,124 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks\n+from collections import namedtuple\n+from test_framework.test_framework import BitcoinTestFramework",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602924979",
      "id" : 602924979,
      "line" : 7,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjkyNDk3OQ==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 7,
      "original_position" : 7,
      "original_start_line" : 6,
      "path" : "test/functional/feature_bip8.py",
      "position" : 7,
      "pull_request_review_id" : 622777889,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : 6,
      "start_side" : "RIGHT",
      "updated_at" : "2021-03-28T20:15:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602924979",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602925055"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602925055"
         }
      },
      "author_association" : "MEMBER",
      "body" : "f-strings are generally preferred in new tests:\r\n\r\n```suggestion\r\n            [f'-vbparams=testdummy:@144:@{144 * 3}'], # Node 1 has regular activation window\r\n```",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-28T20:00:59Z",
      "diff_hunk" : "@@ -0,0 +1,124 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks\n+from collections import namedtuple\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+RestartedNodeInfo = namedtuple(\"RestartedNodeInfo\", (\"node\", \"extra_args\", \"status\"))\n+\n+class Bip8Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 4\n+        self.setup_clean_chain = True\n+        self.extra_args = [\n+            ['-vbparams=testdummy:@-2:@-2'], # Node 0 has TestDummy inactive\n+            ['-vbparams=testdummy:@144:@{}'.format(144 * 3)], # Node 1 has regular activation window",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602925055",
      "id" : 602925055,
      "line" : 18,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjkyNTA1NQ==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 18,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "test/functional/feature_bip8.py",
      "position" : 18,
      "pull_request_review_id" : 622777889,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-28T20:15:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602925055",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602925256"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602925256"
         }
      },
      "author_association" : "MEMBER",
      "body" : "There's a lot of repetition here. You could factor this out into a function.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-28T20:02:54Z",
      "diff_hunk" : "@@ -0,0 +1,124 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks\n+from collections import namedtuple\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+RestartedNodeInfo = namedtuple(\"RestartedNodeInfo\", (\"node\", \"extra_args\", \"status\"))\n+\n+class Bip8Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 4\n+        self.setup_clean_chain = True\n+        self.extra_args = [\n+            ['-vbparams=testdummy:@-2:@-2'], # Node 0 has TestDummy inactive\n+            ['-vbparams=testdummy:@144:@{}'.format(144 * 3)], # Node 1 has regular activation window\n+            ['-vbparams=testdummy:@144:@{}:@{}'.format(144 * 3, 144 * 5)], # Node 2 has minimum activation height\n+            ['-vbparams=testdummy:@-2:@-2'], # Node 3 has TestDummy inactive, but will be restarted with different params\n+        ]\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def test_height(self, height, status, mine_from, restart):\n+        if height > self.height:\n+            self.log.info(\"Test status at height {}...\".format(height))\n+            while self.height < height:\n+                blockhash = self.nodes[mine_from].generate(1)[0]\n+                block = self.nodes[mine_from].getblock(blockhash, 0)\n+                for node in self.nodes:\n+                    node.submitblock(block)\n+                    assert_equal(node.getbestblockhash(), blockhash)\n+                self.height += 1\n+        elif height < self.height:\n+            assert mine_from is None\n+            self.log.info(\"Roll back to height {}...\".format(height))\n+            old_block = self.nodes[0].getblockhash(height + 1)\n+            for node in self.nodes:\n+                node.invalidateblock(old_block)\n+        else:\n+            assert mine_from is None\n+            assert height == 0 and self.height == 0\n+            self.log.info(\"Test status at genesis...\")\n+\n+        self.height = height\n+\n+        for (i, node), st in zip(enumerate(self.nodes), status):\n+            self.log.debug(\"Node #{}...\".format(i))\n+            info = node.getblockchaininfo()\n+            assert_equal(info[\"blocks\"], height)\n+            if st is None:\n+                assert \"testdummy\" not in info[\"softforks\"]\n+            else:\n+                assert_equal(info[\"softforks\"][\"testdummy\"][\"bip8\"][\"status\"], st)\n+\n+        if restart:\n+            # Restart this node and check that the status is what we expect\n+            self.restart_node(restart.node, restart.extra_args)\n+            info = self.nodes[restart.node].getblockchaininfo()\n+            assert_equal(info[\"blocks\"], height)\n+            if restart.status is None:\n+                assert \"testdummy\" not in info[\"softforks\"]\n+            else:\n+                assert_equal(info[\"softforks\"][\"testdummy\"][\"bip8\"][\"status\"], restart.status)\n+\n+            # Now restart again to go back to the original settings\n+            self.restart_node(restart.node, self.extra_args[restart.node])\n+            info = self.nodes[restart.node].getblockchaininfo()\n+            assert_equal(info[\"blocks\"], height)\n+            if status[restart.node] is None:\n+                assert \"testdummy\" not in info[\"softforks\"]\n+            else:\n+                assert_equal(info[\"softforks\"][\"testdummy\"][\"bip8\"][\"status\"], status[restart.node])\n+\n+    def run_test(self):\n+        self.log.info(\"Checking -vbparams\")\n+        self.stop_node(3)\n+        self.nodes[3].assert_start_raises_init_error(extra_args=[\"-vbparams=testdummy:@-2:@1\"], expected_msg=\"Error: When one of startheight or timeoutheight is -2, both must be -2\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602925256",
      "id" : 602925256,
      "line" : 80,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjkyNTI1Ng==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 80,
      "original_position" : 80,
      "original_start_line" : null,
      "path" : "test/functional/feature_bip8.py",
      "position" : 80,
      "pull_request_review_id" : 622777889,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-28T20:15:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602925256",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602926473"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602926473"
         }
      },
      "author_association" : "MEMBER",
      "body" : "unused",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-28T20:13:41Z",
      "diff_hunk" : "@@ -0,0 +1,124 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks\n+from collections import namedtuple\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+RestartedNodeInfo = namedtuple(\"RestartedNodeInfo\", (\"node\", \"extra_args\", \"status\"))\n+\n+class Bip8Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 4\n+        self.setup_clean_chain = True\n+        self.extra_args = [\n+            ['-vbparams=testdummy:@-2:@-2'], # Node 0 has TestDummy inactive\n+            ['-vbparams=testdummy:@144:@{}'.format(144 * 3)], # Node 1 has regular activation window\n+            ['-vbparams=testdummy:@144:@{}:@{}'.format(144 * 3, 144 * 5)], # Node 2 has minimum activation height\n+            ['-vbparams=testdummy:@-2:@-2'], # Node 3 has TestDummy inactive, but will be restarted with different params\n+        ]\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def test_height(self, height, status, mine_from, restart):\n+        if height > self.height:\n+            self.log.info(\"Test status at height {}...\".format(height))\n+            while self.height < height:\n+                blockhash = self.nodes[mine_from].generate(1)[0]\n+                block = self.nodes[mine_from].getblock(blockhash, 0)\n+                for node in self.nodes:\n+                    node.submitblock(block)\n+                    assert_equal(node.getbestblockhash(), blockhash)\n+                self.height += 1\n+        elif height < self.height:\n+            assert mine_from is None\n+            self.log.info(\"Roll back to height {}...\".format(height))\n+            old_block = self.nodes[0].getblockhash(height + 1)\n+            for node in self.nodes:\n+                node.invalidateblock(old_block)\n+        else:\n+            assert mine_from is None\n+            assert height == 0 and self.height == 0\n+            self.log.info(\"Test status at genesis...\")\n+\n+        self.height = height\n+\n+        for (i, node), st in zip(enumerate(self.nodes), status):\n+            self.log.debug(\"Node #{}...\".format(i))\n+            info = node.getblockchaininfo()\n+            assert_equal(info[\"blocks\"], height)\n+            if st is None:\n+                assert \"testdummy\" not in info[\"softforks\"]\n+            else:\n+                assert_equal(info[\"softforks\"][\"testdummy\"][\"bip8\"][\"status\"], st)\n+\n+        if restart:\n+            # Restart this node and check that the status is what we expect\n+            self.restart_node(restart.node, restart.extra_args)\n+            info = self.nodes[restart.node].getblockchaininfo()\n+            assert_equal(info[\"blocks\"], height)\n+            if restart.status is None:\n+                assert \"testdummy\" not in info[\"softforks\"]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602926473",
      "id" : 602926473,
      "line" : 64,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjkyNjQ3Mw==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 64,
      "original_position" : 64,
      "original_start_line" : 63,
      "path" : "test/functional/feature_bip8.py",
      "position" : 64,
      "pull_request_review_id" : 622777889,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : 63,
      "start_side" : "RIGHT",
      "updated_at" : "2021-03-28T20:15:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602926473",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602926581"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602926581"
         }
      },
      "author_association" : "MEMBER",
      "body" : "unused",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-28T20:14:50Z",
      "diff_hunk" : "@@ -0,0 +1,124 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks\n+from collections import namedtuple\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+RestartedNodeInfo = namedtuple(\"RestartedNodeInfo\", (\"node\", \"extra_args\", \"status\"))\n+\n+class Bip8Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 4\n+        self.setup_clean_chain = True\n+        self.extra_args = [\n+            ['-vbparams=testdummy:@-2:@-2'], # Node 0 has TestDummy inactive\n+            ['-vbparams=testdummy:@144:@{}'.format(144 * 3)], # Node 1 has regular activation window\n+            ['-vbparams=testdummy:@144:@{}:@{}'.format(144 * 3, 144 * 5)], # Node 2 has minimum activation height\n+            ['-vbparams=testdummy:@-2:@-2'], # Node 3 has TestDummy inactive, but will be restarted with different params\n+        ]\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def test_height(self, height, status, mine_from, restart):\n+        if height > self.height:\n+            self.log.info(\"Test status at height {}...\".format(height))\n+            while self.height < height:\n+                blockhash = self.nodes[mine_from].generate(1)[0]\n+                block = self.nodes[mine_from].getblock(blockhash, 0)\n+                for node in self.nodes:\n+                    node.submitblock(block)\n+                    assert_equal(node.getbestblockhash(), blockhash)\n+                self.height += 1\n+        elif height < self.height:\n+            assert mine_from is None\n+            self.log.info(\"Roll back to height {}...\".format(height))\n+            old_block = self.nodes[0].getblockhash(height + 1)\n+            for node in self.nodes:\n+                node.invalidateblock(old_block)\n+        else:\n+            assert mine_from is None\n+            assert height == 0 and self.height == 0\n+            self.log.info(\"Test status at genesis...\")\n+\n+        self.height = height\n+\n+        for (i, node), st in zip(enumerate(self.nodes), status):\n+            self.log.debug(\"Node #{}...\".format(i))\n+            info = node.getblockchaininfo()\n+            assert_equal(info[\"blocks\"], height)\n+            if st is None:\n+                assert \"testdummy\" not in info[\"softforks\"]\n+            else:\n+                assert_equal(info[\"softforks\"][\"testdummy\"][\"bip8\"][\"status\"], st)\n+\n+        if restart:\n+            # Restart this node and check that the status is what we expect\n+            self.restart_node(restart.node, restart.extra_args)\n+            info = self.nodes[restart.node].getblockchaininfo()\n+            assert_equal(info[\"blocks\"], height)\n+            if restart.status is None:\n+                assert \"testdummy\" not in info[\"softforks\"]\n+            else:\n+                assert_equal(info[\"softforks\"][\"testdummy\"][\"bip8\"][\"status\"], restart.status)\n+\n+            # Now restart again to go back to the original settings\n+            self.restart_node(restart.node, self.extra_args[restart.node])\n+            info = self.nodes[restart.node].getblockchaininfo()\n+            assert_equal(info[\"blocks\"], height)\n+            if status[restart.node] is None:\n+                assert \"testdummy\" not in info[\"softforks\"]\n+            else:\n+                assert_equal(info[\"softforks\"][\"testdummy\"][\"bip8\"][\"status\"], status[restart.node])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602926581",
      "id" : 602926581,
      "line" : 75,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjkyNjU4MQ==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 75,
      "original_position" : 75,
      "original_start_line" : 74,
      "path" : "test/functional/feature_bip8.py",
      "position" : 75,
      "pull_request_review_id" : 622777889,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : 74,
      "start_side" : "RIGHT",
      "updated_at" : "2021-03-28T20:15:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602926581",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602929655"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602929655"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The warning message emitted when this threshold is reached is \"Warning: unknown new rules activated\", whereas now the threshold being reached really means \"Warning: unknown new rules may be activated soon\" (since 75% doesn't actually indicate that any vbits deployment will activate).\r\n\r\nI think it might make sense to remove the `m_vbits_min_threshold` parameter from chain params and set the threshold to 75% of nMinerConfirmationWindow here.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-28T20:40:31Z",
      "diff_hunk" : "@@ -1837,10 +1837,11 @@ class WarningBitsConditionChecker : public AbstractThresholdConditionChecker\n public:\n     explicit WarningBitsConditionChecker(int bitIn) : bit(bitIn) {}\n \n-    int64_t BeginTime(const Consensus::Params& params) const override { return 0; }\n-    int64_t EndTime(const Consensus::Params& params) const override { return std::numeric_limits<int64_t>::max(); }\n+    int StartHeight(const Consensus::Params& params) const override { return 0; }\n+    int TimeoutHeight(const Consensus::Params& params) const override { return std::numeric_limits<int>::max(); }\n     int Period(const Consensus::Params& params) const override { return params.nMinerConfirmationWindow; }\n-    int Threshold(const Consensus::Params& params) const override { return params.nRuleChangeActivationThreshold; }\n+    int Threshold(const Consensus::Params& params) const override { return params.m_vbits_min_threshold; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602929655",
      "id" : 602929655,
      "line" : 1843,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjkyOTY1NQ==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 1843,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 10,
      "pull_request_review_id" : 622781126,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-28T20:40:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602929655",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602935148"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602935148"
         }
      },
      "author_association" : "MEMBER",
      "body" : "These use this format so that it is easier to backport. 0.21 is using a version python that doesn't support f-strings.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-28T21:28:54Z",
      "diff_hunk" : "@@ -0,0 +1,124 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks\n+from collections import namedtuple\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+RestartedNodeInfo = namedtuple(\"RestartedNodeInfo\", (\"node\", \"extra_args\", \"status\"))\n+\n+class Bip8Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 4\n+        self.setup_clean_chain = True\n+        self.extra_args = [\n+            ['-vbparams=testdummy:@-2:@-2'], # Node 0 has TestDummy inactive\n+            ['-vbparams=testdummy:@144:@{}'.format(144 * 3)], # Node 1 has regular activation window",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602935148",
      "id" : 602935148,
      "in_reply_to_id" : 602925055,
      "line" : 18,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjkzNTE0OA==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 18,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "test/functional/feature_bip8.py",
      "position" : 18,
      "pull_request_review_id" : 622784975,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-28T21:28:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602935148",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602935314"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602935314"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Will fix if I need to retouch.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-28T21:30:17Z",
      "diff_hunk" : "@@ -49,20 +57,17 @@ ThresholdState AbstractThresholdConditionChecker::GetStateFor(const CBlockIndex*\n         pindexPrev = vToCompute.back();\n         vToCompute.pop_back();\n \n+        // We track state by previous-block, so the height we should be comparing is +1\n+        const int64_t height = pindexPrev->nHeight + 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602935314",
      "id" : 602935314,
      "in_reply_to_id" : 602923391,
      "line" : 61,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjkzNTMxNA==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 61,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/versionbits.cpp",
      "position" : 39,
      "pull_request_review_id" : 622785090,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-28T21:30:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602935314",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602935396"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602935396"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If I need to retouch",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-28T21:30:40Z",
      "diff_hunk" : "@@ -0,0 +1,124 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602935396",
      "id" : 602935396,
      "in_reply_to_id" : 602924924,
      "line" : 5,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjkzNTM5Ng==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 5,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/feature_bip8.py",
      "position" : 5,
      "pull_request_review_id" : 622785128,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-28T21:30:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602935396",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602935400"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602935400"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If I need to retouch",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-28T21:30:44Z",
      "diff_hunk" : "@@ -0,0 +1,124 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks\n+from collections import namedtuple\n+from test_framework.test_framework import BitcoinTestFramework",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602935400",
      "id" : 602935400,
      "in_reply_to_id" : 602924979,
      "line" : 7,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjkzNTQwMA==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 7,
      "original_position" : 7,
      "original_start_line" : 6,
      "path" : "test/functional/feature_bip8.py",
      "position" : 7,
      "pull_request_review_id" : 622785131,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : 6,
      "start_side" : "RIGHT",
      "updated_at" : "2021-03-28T21:30:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602935400",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602935505"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602935505"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's about as repetitive if this were a function IMO.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-28T21:32:00Z",
      "diff_hunk" : "@@ -0,0 +1,124 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks\n+from collections import namedtuple\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+RestartedNodeInfo = namedtuple(\"RestartedNodeInfo\", (\"node\", \"extra_args\", \"status\"))\n+\n+class Bip8Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 4\n+        self.setup_clean_chain = True\n+        self.extra_args = [\n+            ['-vbparams=testdummy:@-2:@-2'], # Node 0 has TestDummy inactive\n+            ['-vbparams=testdummy:@144:@{}'.format(144 * 3)], # Node 1 has regular activation window\n+            ['-vbparams=testdummy:@144:@{}:@{}'.format(144 * 3, 144 * 5)], # Node 2 has minimum activation height\n+            ['-vbparams=testdummy:@-2:@-2'], # Node 3 has TestDummy inactive, but will be restarted with different params\n+        ]\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def test_height(self, height, status, mine_from, restart):\n+        if height > self.height:\n+            self.log.info(\"Test status at height {}...\".format(height))\n+            while self.height < height:\n+                blockhash = self.nodes[mine_from].generate(1)[0]\n+                block = self.nodes[mine_from].getblock(blockhash, 0)\n+                for node in self.nodes:\n+                    node.submitblock(block)\n+                    assert_equal(node.getbestblockhash(), blockhash)\n+                self.height += 1\n+        elif height < self.height:\n+            assert mine_from is None\n+            self.log.info(\"Roll back to height {}...\".format(height))\n+            old_block = self.nodes[0].getblockhash(height + 1)\n+            for node in self.nodes:\n+                node.invalidateblock(old_block)\n+        else:\n+            assert mine_from is None\n+            assert height == 0 and self.height == 0\n+            self.log.info(\"Test status at genesis...\")\n+\n+        self.height = height\n+\n+        for (i, node), st in zip(enumerate(self.nodes), status):\n+            self.log.debug(\"Node #{}...\".format(i))\n+            info = node.getblockchaininfo()\n+            assert_equal(info[\"blocks\"], height)\n+            if st is None:\n+                assert \"testdummy\" not in info[\"softforks\"]\n+            else:\n+                assert_equal(info[\"softforks\"][\"testdummy\"][\"bip8\"][\"status\"], st)\n+\n+        if restart:\n+            # Restart this node and check that the status is what we expect\n+            self.restart_node(restart.node, restart.extra_args)\n+            info = self.nodes[restart.node].getblockchaininfo()\n+            assert_equal(info[\"blocks\"], height)\n+            if restart.status is None:\n+                assert \"testdummy\" not in info[\"softforks\"]\n+            else:\n+                assert_equal(info[\"softforks\"][\"testdummy\"][\"bip8\"][\"status\"], restart.status)\n+\n+            # Now restart again to go back to the original settings\n+            self.restart_node(restart.node, self.extra_args[restart.node])\n+            info = self.nodes[restart.node].getblockchaininfo()\n+            assert_equal(info[\"blocks\"], height)\n+            if status[restart.node] is None:\n+                assert \"testdummy\" not in info[\"softforks\"]\n+            else:\n+                assert_equal(info[\"softforks\"][\"testdummy\"][\"bip8\"][\"status\"], status[restart.node])\n+\n+    def run_test(self):\n+        self.log.info(\"Checking -vbparams\")\n+        self.stop_node(3)\n+        self.nodes[3].assert_start_raises_init_error(extra_args=[\"-vbparams=testdummy:@-2:@1\"], expected_msg=\"Error: When one of startheight or timeoutheight is -2, both must be -2\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602935505",
      "id" : 602935505,
      "in_reply_to_id" : 602925256,
      "line" : 80,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjkzNTUwNQ==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 80,
      "original_position" : 80,
      "original_start_line" : null,
      "path" : "test/functional/feature_bip8.py",
      "position" : 80,
      "pull_request_review_id" : 622785228,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-28T21:32:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602935505",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602935514"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602935514"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If I need to retouch",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-28T21:32:07Z",
      "diff_hunk" : "@@ -0,0 +1,124 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks\n+from collections import namedtuple\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+RestartedNodeInfo = namedtuple(\"RestartedNodeInfo\", (\"node\", \"extra_args\", \"status\"))\n+\n+class Bip8Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 4\n+        self.setup_clean_chain = True\n+        self.extra_args = [\n+            ['-vbparams=testdummy:@-2:@-2'], # Node 0 has TestDummy inactive\n+            ['-vbparams=testdummy:@144:@{}'.format(144 * 3)], # Node 1 has regular activation window\n+            ['-vbparams=testdummy:@144:@{}:@{}'.format(144 * 3, 144 * 5)], # Node 2 has minimum activation height\n+            ['-vbparams=testdummy:@-2:@-2'], # Node 3 has TestDummy inactive, but will be restarted with different params\n+        ]\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def test_height(self, height, status, mine_from, restart):\n+        if height > self.height:\n+            self.log.info(\"Test status at height {}...\".format(height))\n+            while self.height < height:\n+                blockhash = self.nodes[mine_from].generate(1)[0]\n+                block = self.nodes[mine_from].getblock(blockhash, 0)\n+                for node in self.nodes:\n+                    node.submitblock(block)\n+                    assert_equal(node.getbestblockhash(), blockhash)\n+                self.height += 1\n+        elif height < self.height:\n+            assert mine_from is None\n+            self.log.info(\"Roll back to height {}...\".format(height))\n+            old_block = self.nodes[0].getblockhash(height + 1)\n+            for node in self.nodes:\n+                node.invalidateblock(old_block)\n+        else:\n+            assert mine_from is None\n+            assert height == 0 and self.height == 0\n+            self.log.info(\"Test status at genesis...\")\n+\n+        self.height = height\n+\n+        for (i, node), st in zip(enumerate(self.nodes), status):\n+            self.log.debug(\"Node #{}...\".format(i))\n+            info = node.getblockchaininfo()\n+            assert_equal(info[\"blocks\"], height)\n+            if st is None:\n+                assert \"testdummy\" not in info[\"softforks\"]\n+            else:\n+                assert_equal(info[\"softforks\"][\"testdummy\"][\"bip8\"][\"status\"], st)\n+\n+        if restart:\n+            # Restart this node and check that the status is what we expect\n+            self.restart_node(restart.node, restart.extra_args)\n+            info = self.nodes[restart.node].getblockchaininfo()\n+            assert_equal(info[\"blocks\"], height)\n+            if restart.status is None:\n+                assert \"testdummy\" not in info[\"softforks\"]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602935514",
      "id" : 602935514,
      "in_reply_to_id" : 602926473,
      "line" : 64,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjkzNTUxNA==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 64,
      "original_position" : 64,
      "original_start_line" : 63,
      "path" : "test/functional/feature_bip8.py",
      "position" : 64,
      "pull_request_review_id" : 622785238,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : 63,
      "start_side" : "RIGHT",
      "updated_at" : "2021-03-28T21:32:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602935514",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602935529"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602935529"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If I need to retouch",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-28T21:32:10Z",
      "diff_hunk" : "@@ -0,0 +1,124 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+# Test BIP 8 softforks\n+from collections import namedtuple\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+RestartedNodeInfo = namedtuple(\"RestartedNodeInfo\", (\"node\", \"extra_args\", \"status\"))\n+\n+class Bip8Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 4\n+        self.setup_clean_chain = True\n+        self.extra_args = [\n+            ['-vbparams=testdummy:@-2:@-2'], # Node 0 has TestDummy inactive\n+            ['-vbparams=testdummy:@144:@{}'.format(144 * 3)], # Node 1 has regular activation window\n+            ['-vbparams=testdummy:@144:@{}:@{}'.format(144 * 3, 144 * 5)], # Node 2 has minimum activation height\n+            ['-vbparams=testdummy:@-2:@-2'], # Node 3 has TestDummy inactive, but will be restarted with different params\n+        ]\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def test_height(self, height, status, mine_from, restart):\n+        if height > self.height:\n+            self.log.info(\"Test status at height {}...\".format(height))\n+            while self.height < height:\n+                blockhash = self.nodes[mine_from].generate(1)[0]\n+                block = self.nodes[mine_from].getblock(blockhash, 0)\n+                for node in self.nodes:\n+                    node.submitblock(block)\n+                    assert_equal(node.getbestblockhash(), blockhash)\n+                self.height += 1\n+        elif height < self.height:\n+            assert mine_from is None\n+            self.log.info(\"Roll back to height {}...\".format(height))\n+            old_block = self.nodes[0].getblockhash(height + 1)\n+            for node in self.nodes:\n+                node.invalidateblock(old_block)\n+        else:\n+            assert mine_from is None\n+            assert height == 0 and self.height == 0\n+            self.log.info(\"Test status at genesis...\")\n+\n+        self.height = height\n+\n+        for (i, node), st in zip(enumerate(self.nodes), status):\n+            self.log.debug(\"Node #{}...\".format(i))\n+            info = node.getblockchaininfo()\n+            assert_equal(info[\"blocks\"], height)\n+            if st is None:\n+                assert \"testdummy\" not in info[\"softforks\"]\n+            else:\n+                assert_equal(info[\"softforks\"][\"testdummy\"][\"bip8\"][\"status\"], st)\n+\n+        if restart:\n+            # Restart this node and check that the status is what we expect\n+            self.restart_node(restart.node, restart.extra_args)\n+            info = self.nodes[restart.node].getblockchaininfo()\n+            assert_equal(info[\"blocks\"], height)\n+            if restart.status is None:\n+                assert \"testdummy\" not in info[\"softforks\"]\n+            else:\n+                assert_equal(info[\"softforks\"][\"testdummy\"][\"bip8\"][\"status\"], restart.status)\n+\n+            # Now restart again to go back to the original settings\n+            self.restart_node(restart.node, self.extra_args[restart.node])\n+            info = self.nodes[restart.node].getblockchaininfo()\n+            assert_equal(info[\"blocks\"], height)\n+            if status[restart.node] is None:\n+                assert \"testdummy\" not in info[\"softforks\"]\n+            else:\n+                assert_equal(info[\"softforks\"][\"testdummy\"][\"bip8\"][\"status\"], status[restart.node])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602935529",
      "id" : 602935529,
      "in_reply_to_id" : 602926581,
      "line" : 75,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjkzNTUyOQ==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 75,
      "original_position" : 75,
      "original_start_line" : 74,
      "path" : "test/functional/feature_bip8.py",
      "position" : 75,
      "pull_request_review_id" : 622785244,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : 74,
      "start_side" : "RIGHT",
      "updated_at" : "2021-03-28T21:32:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602935529",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602935581"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602935581"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Perhaps for a followup, or if I retouch.",
      "commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "created_at" : "2021-03-28T21:32:51Z",
      "diff_hunk" : "@@ -1837,10 +1837,11 @@ class WarningBitsConditionChecker : public AbstractThresholdConditionChecker\n public:\n     explicit WarningBitsConditionChecker(int bitIn) : bit(bitIn) {}\n \n-    int64_t BeginTime(const Consensus::Params& params) const override { return 0; }\n-    int64_t EndTime(const Consensus::Params& params) const override { return std::numeric_limits<int64_t>::max(); }\n+    int StartHeight(const Consensus::Params& params) const override { return 0; }\n+    int TimeoutHeight(const Consensus::Params& params) const override { return std::numeric_limits<int>::max(); }\n     int Period(const Consensus::Params& params) const override { return params.nMinerConfirmationWindow; }\n-    int Threshold(const Consensus::Params& params) const override { return params.nRuleChangeActivationThreshold; }\n+    int Threshold(const Consensus::Params& params) const override { return params.m_vbits_min_threshold; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#discussion_r602935581",
      "id" : 602935581,
      "in_reply_to_id" : 602929655,
      "line" : 1843,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjkzNTU4MQ==",
      "original_commit_id" : "2e55bcedb8d73e49620a5731196bf7e23bb53ccc",
      "original_line" : 1843,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 10,
      "pull_request_review_id" : 622785277,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21392",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-28T21:32:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602935581",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I believe this is the intended state machine:\r\n\r\n![states](https://user-images.githubusercontent.com/548488/112922812-fe08a780-90c1-11eb-99e2-291522811faf.png)\r\n\r\nTo generate:\r\n\r\n```sh\r\n$ dot -Tpng >states.png\r\ndigraph versionbits {\r\n    defined [shape=box,label=\"DEFINED\"];\r\n    started [shape=box,label=\"STARTED\"];\r\n    failed [shape=box,label=\"FAILED\"];\r\n    locked [shape=box,label=\"LOCKED_IN\"];\r\n    active [shape=box,label=\"ACTIVE\"];\r\n\r\n    defined -> defined [label=\"height < begin\"];\r\n    defined -> started [label=\"height >= begin\"];\r\n    started -> started [label=\"sig < thresh\\nheight < end\"];\r\n    started -> failed [label=\"sig < thresh\\nheight >= end\"];\r\n    started -> locked [label=\"sig >= thresh\\n\"];\r\n    locked -> locked [label=\"height < min_active\"];\r\n    locked -> active [label=\"height >= min_active\"];\r\n    active -> active [label=\"always\"];\r\n    failed -> failed [label=\"always\"];\r\n}\r\n```",
      "created_at" : "2021-03-30T02:07:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-809850058",
      "id" : 809850058,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwOTg1MDA1OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-30T02:07:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/809850058",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Should `STARTED` -> `LOCKED_IN` be defined as \"sig >=  thresh &  height  <= end\" ?",
      "created_at" : "2021-04-02T19:56:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-812686881",
      "id" : 812686881,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxMjY4Njg4MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-02T19:56:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/812686881",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/24482484?v=4",
         "events_url" : "https://api.github.com/users/Rspigler/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Rspigler/followers",
         "following_url" : "https://api.github.com/users/Rspigler/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Rspigler/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Rspigler",
         "id" : 24482484,
         "login" : "Rspigler",
         "node_id" : "MDQ6VXNlcjI0NDgyNDg0",
         "organizations_url" : "https://api.github.com/users/Rspigler/orgs",
         "received_events_url" : "https://api.github.com/users/Rspigler/received_events",
         "repos_url" : "https://api.github.com/users/Rspigler/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Rspigler/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Rspigler/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Rspigler"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Closing this for now as #21377 (with some changes) is agreeable to most people.",
      "created_at" : "2021-04-06T23:47:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21392#issuecomment-814503706",
      "id" : 814503706,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21392",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxNDUwMzcwNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-06T23:47:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/814503706",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   }
]
