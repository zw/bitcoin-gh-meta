[
   {
      "body" : "NAK. This potentially breaks the bitcoin distributed algorithm.\n\n(Ignore checkpoints for a moment.)  I mine a long fork with 300,000 diff1 blocks. I feed it to you.  You'll now never fetch the much longer real chain from honest nodes.   Same problem exists later in the chain too, it's just not trivial to pull off as an attack in that case. May also have some weird effects with forks around the retarget (you can have short competing forks with different difficulties, and because the maximum retarget change is >=2x a lower diff chain could have more blocks, even for a fork only a few blocks long)\n",
      "created_at" : "2012-09-19T05:06:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1834#issuecomment-8679441",
      "id" : 8679441,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1834",
      "updated_at" : "2012-09-19T05:12:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/8679441",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "That case is nigh impossible given checkpoints.  You ask to ignore this, to present a theoretical case that does not therefore apply to real world client releases.\n\nOne case _obviously_ can lead to stuck downloads today.  The client sends getblocks to a remote peer that we know in advance does not have the data we need.  nAskedForBlocks is incremented, preventing further queries, directly and immediately leading to a stuck download.\n",
      "created_at" : "2012-09-19T05:29:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1834#issuecomment-8679752",
      "id" : 8679752,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1834",
      "updated_at" : "2012-09-19T05:29:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/8679752",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "It does seem a bit dangerous to rely on pfrom->nStartingHeight so completely. It's very hard to see what effect this will have in edge cases.\n\nCouldn't we address the \"stuck downloads\" problem in another place, ie by detecting stuck downloads actively and requesting from different nodes. After all, even if a node claims to have more blocks, it can still be stuck.\n",
      "created_at" : "2012-09-19T05:43:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1834#issuecomment-8679910",
      "id" : 8679910,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1834",
      "updated_at" : "2012-09-19T05:43:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/8679910",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@jgarzik the download happily continues when we get another block from the network in an average of 10 minutes.\n\nI presented the toy example ignoring checkpoints because its easier to understand.  The same exposure exists at retargets where a forks can be created that differ in difficulty by a factor of two, or if a non-majority but high hashpower (e.g. asics before they are widely adopted) attacker used timewarp to mine a fork down to low difficulty starting anywhere after the highest checkpoint.\n\nI don't think the exposure, even if it is fringe and unexciting is worth avoiding waiting for a block in the rare case that you get a peer which is stuck and behind the chain.",
      "created_at" : "2012-09-19T05:50:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1834#issuecomment-8679990",
      "id" : 8679990,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1834",
      "updated_at" : "2012-09-19T05:51:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/8679990",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "Gah, sorry, I read the title without actually reading the patch. My above concerns aren't an issue here: even in those cases when the real network finds a block again it'll still pull from them, which is adequate and fine.",
      "created_at" : "2012-09-19T07:06:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1834#issuecomment-8681098",
      "id" : 8681098,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1834",
      "updated_at" : "2012-09-19T07:06:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/8681098",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/d5d19c74a5f5cbcaad6869dc7d89bd7077b7d175 for binaries and test log.",
      "created_at" : "2012-09-20T13:44:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1834#issuecomment-8728904",
      "id" : 8728904,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1834",
      "updated_at" : "2012-09-20T13:44:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/8728904",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "body" : "Something like this is useful, but it will fail to fetch the new chain in some edge cases (I know, those will be fetched when a successor block is broadcast, but still). Maybe some flexibility, like (nStartingHeight > nBestHeight - 144) is more safe, and will still prevent against the majority of silly getblocks?",
      "created_at" : "2012-09-21T12:38:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1834#issuecomment-8763202",
      "id" : 8763202,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1834",
      "updated_at" : "2012-09-21T12:38:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/8763202",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Updated commit to offset height count by 144.\n",
      "created_at" : "2012-09-24T17:26:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1834#issuecomment-8826997",
      "id" : 8826997,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1834",
      "updated_at" : "2012-09-24T17:26:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/8826997",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/93dd68e924c7cf24b75bfb5b83b1be1cdc27dbdc for binaries and test log.",
      "created_at" : "2012-09-25T04:08:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1834#issuecomment-8843020",
      "id" : 8843020,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1834",
      "updated_at" : "2012-09-25T04:08:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/8843020",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "body" : "ACK with the 144 offset",
      "created_at" : "2012-09-25T16:28:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1834#issuecomment-8860632",
      "id" : 8860632,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1834",
      "updated_at" : "2012-09-25T16:28:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/8860632",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "ACK",
      "created_at" : "2012-10-07T14:06:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1834#issuecomment-9208267",
      "id" : 9208267,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1834",
      "updated_at" : "2012-10-07T14:06:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/9208267",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
