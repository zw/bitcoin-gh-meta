[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [achow101](https://github.com/bitcoin/bitcoin/pull/26567#pullrequestreview-1283898604) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#27286](https://github.com/bitcoin/bitcoin/pull/27286) (wallet: Keep track of the wallet's own transaction outputs in memory by achow101)\n* [#26728](https://github.com/bitcoin/bitcoin/pull/26728) (wallet: Have the wallet store the key for automatically generated descriptors by achow101)\n* [#26066](https://github.com/bitcoin/bitcoin/pull/26066) (wallet: Refactor and document CoinControl by aureleoules)\n* [#25907](https://github.com/bitcoin/bitcoin/pull/25907) (wallet: rpc to add automatically generated descriptors by achow101)\n* [#25273](https://github.com/bitcoin/bitcoin/pull/25273) (wallet: Pass through transaction locktime and preset input sequences and scripts to CreateTransaction by achow101)\n* [#22838](https://github.com/bitcoin/bitcoin/pull/22838) (descriptors: Be able to specify change and receiving in a single descriptor string by achow101)\n* [#22341](https://github.com/bitcoin/bitcoin/pull/22341) (rpc: add getxpub by Sjors)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2022-11-24T17:15:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#issuecomment-1326701282",
      "id" : 1326701282,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26567",
      "node_id" : "IC_kwDOABII585PE9ri",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1326701282/reactions"
      },
      "updated_at" : "2023-05-02T00:18:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1326701282",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Pushed a commit to accurately compute the serialized size of the witness stack size, cleanup the commits a bit, and add the newly introduced methods in the descriptors to the `descriptor_parse` fuzz target. This is now ready for review.",
      "created_at" : "2022-11-25T10:49:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#issuecomment-1327318921",
      "id" : 1327318921,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26567",
      "node_id" : "IC_kwDOABII585PHUeJ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1327318921/reactions"
      },
      "updated_at" : "2022-11-25T10:49:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1327318921",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1032600553"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1032600553"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Since we want the maximum size, we should probably account for the sighash byte and make it `65` instead.",
      "commit_id" : "052edf8aa48030679aed36dc47937ce459995590",
      "created_at" : "2022-11-25T16:48:08Z",
      "diff_hunk" : "@@ -931,6 +1058,20 @@ class TRDescriptor final : public DescriptorImpl\n     }\n     std::optional<OutputType> GetOutputType() const override { return OutputType::BECH32M; }\n     bool IsSingleType() const final { return true; }\n+\n+    std::optional<int64_t> ScriptSize() const override { return 1 + 1 + 32; }\n+\n+    std::optional<int64_t> MaxSatisfactionWeight(bool) const override {\n+        // FIXME: We assume keypath spend, which can lead to very large underestimations.\n+        return 1 + 64;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1032600553",
      "id" : 1032600553,
      "line" : 1066,
      "node_id" : "PRRC_kwDOABII5849jDvp",
      "original_commit_id" : "052edf8aa48030679aed36dc47937ce459995590",
      "original_line" : 1066,
      "original_position" : 217,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : 217,
      "pull_request_review_id" : 1194648201,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1032600553/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-12-17T00:05:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1032600553",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2022-12-05T18:09:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#issuecomment-1337878696",
      "id" : 1337878696,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26567",
      "node_id" : "IC_kwDOABII585Pvmio",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1337878696/reactions"
      },
      "updated_at" : "2022-12-05T18:09:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1337878696",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1096374791"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096374791"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In c8b0aeb534edce08366176275d5577c1e309eb6f \"descriptor: introduce a method to get the satisfaction size\"\r\n\r\nThis is backwards, should be 32 for `m_xonly`.\r\n\r\n```suggestion\r\n    std::optional<int64_t> ScriptSize() const override { return 1 + (m_xonly ? 32 : 33) + 1; }\r\n```",
      "commit_id" : "052edf8aa48030679aed36dc47937ce459995590",
      "created_at" : "2023-02-03T23:21:05Z",
      "diff_hunk" : "@@ -740,6 +755,17 @@ class PKDescriptor final : public DescriptorImpl\n public:\n     PKDescriptor(std::unique_ptr<PubkeyProvider> prov, bool xonly = false) : DescriptorImpl(Vector(std::move(prov)), \"pk\"), m_xonly(xonly) {}\n     bool IsSingleType() const final { return true; }\n+\n+    std::optional<int64_t> ScriptSize() const override { return 1 + (m_xonly ? 33 : 32) + 1; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1096374791",
      "id" : 1096374791,
      "line" : 761,
      "node_id" : "PRRC_kwDOABII585BWVoH",
      "original_commit_id" : "c8b0aeb534edce08366176275d5577c1e309eb6f",
      "original_line" : 759,
      "original_position" : 41,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : 41,
      "pull_request_review_id" : 1283898604,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096374791/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-03T23:59:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096374791",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1096376718"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096376718"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In c8b0aeb534edce08366176275d5577c1e309eb6f \"descriptor: introduce a method to get the satisfaction size\"\r\n\r\nThis is backwards, should be 64 for `m_xonly`.\r\n\r\n```suggestion\r\n        return 1 + (m_xonly ? 64 : ecdsa_sig_size);\r\n```",
      "commit_id" : "052edf8aa48030679aed36dc47937ce459995590",
      "created_at" : "2023-02-03T23:23:37Z",
      "diff_hunk" : "@@ -740,6 +755,17 @@ class PKDescriptor final : public DescriptorImpl\n public:\n     PKDescriptor(std::unique_ptr<PubkeyProvider> prov, bool xonly = false) : DescriptorImpl(Vector(std::move(prov)), \"pk\"), m_xonly(xonly) {}\n     bool IsSingleType() const final { return true; }\n+\n+    std::optional<int64_t> ScriptSize() const override { return 1 + (m_xonly ? 33 : 32) + 1; }\n+\n+    std::optional<int64_t> MaxSatSize(bool use_max_sig) const override {\n+        const auto ecdsa_sig_size = use_max_sig ? 72 : 71;\n+        return 1 + (m_xonly ? ecdsa_sig_size : 64);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1096376718",
      "id" : 1096376718,
      "line" : 765,
      "node_id" : "PRRC_kwDOABII585BWWGO",
      "original_commit_id" : "c8b0aeb534edce08366176275d5577c1e309eb6f",
      "original_line" : 763,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : 45,
      "pull_request_review_id" : 1283898604,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096376718/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-03T23:59:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096376718",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1096378066"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096378066"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In c8b0aeb534edce08366176275d5577c1e309eb6f \"descriptor: introduce a method to get the satisfaction size\"\r\n\r\nWe could have an uncompressed pubkey, so we should get the size from the `PubkeyProvider`.",
      "commit_id" : "052edf8aa48030679aed36dc47937ce459995590",
      "created_at" : "2023-02-03T23:26:27Z",
      "diff_hunk" : "@@ -756,6 +782,17 @@ class PKHDescriptor final : public DescriptorImpl\n     PKHDescriptor(std::unique_ptr<PubkeyProvider> prov) : DescriptorImpl(Vector(std::move(prov)), \"pkh\") {}\n     std::optional<OutputType> GetOutputType() const override { return OutputType::LEGACY; }\n     bool IsSingleType() const final { return true; }\n+\n+    std::optional<int64_t> ScriptSize() const override { return 1 + 1 + 1 + 20 + 1 + 1; }\n+\n+    std::optional<int64_t> MaxSatSize(bool use_max_sig) const override {\n+        const auto sig_size = use_max_sig ? 72 : 71;\n+        return 1 + sig_size + 1 + 33;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1096378066",
      "id" : 1096378066,
      "line" : 794,
      "node_id" : "PRRC_kwDOABII585BWWbS",
      "original_commit_id" : "c8b0aeb534edce08366176275d5577c1e309eb6f",
      "original_line" : 790,
      "original_position" : 63,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : 63,
      "pull_request_review_id" : 1283898604,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096378066/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-03T23:59:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096378066",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1096378894"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096378894"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In c8b0aeb534edce08366176275d5577c1e309eb6f \"descriptor: introduce a method to get the satisfaction size\"\r\n\r\nSame uncompressed pubkey issue as above.",
      "commit_id" : "052edf8aa48030679aed36dc47937ce459995590",
      "created_at" : "2023-02-03T23:28:17Z",
      "diff_hunk" : "@@ -816,6 +864,20 @@ class MultisigDescriptor final : public DescriptorImpl\n public:\n     MultisigDescriptor(int threshold, std::vector<std::unique_ptr<PubkeyProvider>> providers, bool sorted = false) : DescriptorImpl(std::move(providers), sorted ? \"sortedmulti\" : \"multi\"), m_threshold(threshold), m_sorted(sorted) {}\n     bool IsSingleType() const final { return true; }\n+\n+    std::optional<int64_t> ScriptSize() const override {\n+        const auto n_keys = m_pubkey_args.size();\n+        return 1 + BuildScript(n_keys).size() + BuildScript(m_threshold).size() + 34 * n_keys;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1096378894",
      "id" : 1096378894,
      "line" : 878,
      "node_id" : "PRRC_kwDOABII585BWWoO",
      "original_commit_id" : "c8b0aeb534edce08366176275d5577c1e309eb6f",
      "original_line" : 870,
      "original_position" : 97,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : 97,
      "pull_request_review_id" : 1283898604,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096378894/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-03T23:59:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096378894",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1096741149"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096741149"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Woops. Thanks.",
      "commit_id" : "967795cee4ae9594d1abc6d2ec085dac8c5bf460",
      "created_at" : "2023-02-05T17:07:21Z",
      "diff_hunk" : "@@ -740,6 +755,17 @@ class PKDescriptor final : public DescriptorImpl\n public:\n     PKDescriptor(std::unique_ptr<PubkeyProvider> prov, bool xonly = false) : DescriptorImpl(Vector(std::move(prov)), \"pk\"), m_xonly(xonly) {}\n     bool IsSingleType() const final { return true; }\n+\n+    std::optional<int64_t> ScriptSize() const override { return 1 + (m_xonly ? 33 : 32) + 1; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1096741149",
      "id" : 1096741149,
      "in_reply_to_id" : 1096374791,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585BXvEd",
      "original_commit_id" : "c8b0aeb534edce08366176275d5577c1e309eb6f",
      "original_line" : 759,
      "original_position" : 41,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : null,
      "pull_request_review_id" : 1284299898,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096741149/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-05T17:07:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096741149",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1096743640"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096743640"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ah good catch! Done, thanks.",
      "commit_id" : "967795cee4ae9594d1abc6d2ec085dac8c5bf460",
      "created_at" : "2023-02-05T17:14:06Z",
      "diff_hunk" : "@@ -756,6 +782,17 @@ class PKHDescriptor final : public DescriptorImpl\n     PKHDescriptor(std::unique_ptr<PubkeyProvider> prov) : DescriptorImpl(Vector(std::move(prov)), \"pkh\") {}\n     std::optional<OutputType> GetOutputType() const override { return OutputType::LEGACY; }\n     bool IsSingleType() const final { return true; }\n+\n+    std::optional<int64_t> ScriptSize() const override { return 1 + 1 + 1 + 20 + 1 + 1; }\n+\n+    std::optional<int64_t> MaxSatSize(bool use_max_sig) const override {\n+        const auto sig_size = use_max_sig ? 72 : 71;\n+        return 1 + sig_size + 1 + 33;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1096743640",
      "id" : 1096743640,
      "in_reply_to_id" : 1096378066,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585BXvrY",
      "original_commit_id" : "c8b0aeb534edce08366176275d5577c1e309eb6f",
      "original_line" : 790,
      "original_position" : 63,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : null,
      "pull_request_review_id" : 1284302740,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096743640/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-05T17:14:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096743640",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1096763645"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096763645"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "967795cee4ae9594d1abc6d2ec085dac8c5bf460",
      "created_at" : "2023-02-05T17:45:33Z",
      "diff_hunk" : "@@ -931,6 +1058,20 @@ class TRDescriptor final : public DescriptorImpl\n     }\n     std::optional<OutputType> GetOutputType() const override { return OutputType::BECH32M; }\n     bool IsSingleType() const final { return true; }\n+\n+    std::optional<int64_t> ScriptSize() const override { return 1 + 1 + 32; }\n+\n+    std::optional<int64_t> MaxSatisfactionWeight(bool) const override {\n+        // FIXME: We assume keypath spend, which can lead to very large underestimations.\n+        return 1 + 64;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1096763645",
      "id" : 1096763645,
      "in_reply_to_id" : 1032600553,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585BX0j9",
      "original_commit_id" : "052edf8aa48030679aed36dc47937ce459995590",
      "original_line" : 1066,
      "original_position" : 217,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : null,
      "pull_request_review_id" : 1284319122,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096763645/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-05T17:45:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096763645",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for the review. Addressed your comments and rebased on master.",
      "created_at" : "2023-02-05T17:56:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#issuecomment-1418201630",
      "id" : 1418201630,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26567",
      "node_id" : "IC_kwDOABII585UiAoe",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1418201630/reactions"
      },
      "updated_at" : "2023-02-05T17:56:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1418201630",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1100365109"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1100365109"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 896a560abef52f41dbc12e3fedcd86ab4a657b06 \"wallet: use descriptor satisfaction size to estimate inputs size\"\r\n\r\nI'm not sure if this is actually correct. I think there are some situations where this would return the wrong descriptor.\r\n\r\nConsider a watchonly wallet where the user has imported an `addr()`. When creating a transaction, that user has provided the full `wpkh()` for that `addr()` on the command line. In this scenario, I believe `GetSolvingProvider` would return a `SigningProvider`, but it wouldn't contain anything. This would then result in `InferDescriptor` making us an `addr()` that cannot be used to retrieve the input weight.\r\n\r\nI think this could be solved by combining the retrieved solving provider with the external provider and doing a single `InferDescriptor`. This would also help in cases where the imported descriptor contains incomplete information, e.g. once we can have `tr()` with partial branches.",
      "commit_id" : "967795cee4ae9594d1abc6d2ec085dac8c5bf460",
      "created_at" : "2023-02-08T16:11:07Z",
      "diff_hunk" : "@@ -46,17 +90,65 @@ int CalculateMaximumSignedInputSize(const CTxOut& txout, const CWallet* wallet,\n     return CalculateMaximumSignedInputSize(txout, COutPoint(), provider.get(), coin_control);\n }\n \n+/** Infer a descriptor for the given output script. */\n+static std::unique_ptr<Descriptor> GetDescriptor(const CWallet* wallet, const CCoinControl* coin_control,\n+                                                 const CScript script_pubkey)\n+{\n+    if (const auto provider = wallet->GetSolvingProvider(script_pubkey)) {\n+        return InferDescriptor(script_pubkey, *provider);\n+    }\n+    if (coin_control) {\n+        return InferDescriptor(script_pubkey, coin_control->m_external_provider);\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1100365109",
      "id" : 1100365109,
      "line" : 103,
      "node_id" : "PRRC_kwDOABII585Blj01",
      "original_commit_id" : "896a560abef52f41dbc12e3fedcd86ab4a657b06",
      "original_line" : 102,
      "original_position" : 77,
      "original_start_line" : 97,
      "path" : "src/wallet/spend.cpp",
      "position" : 77,
      "pull_request_review_id" : 1289523983,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1100365109/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 98,
      "start_side" : "RIGHT",
      "updated_at" : "2023-02-08T16:11:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1100365109",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1103646477"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1103646477"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Hmm good point. Unfortunately this is a bit clumsy for the `LegacyScriptPubKeyMan`: since it's not a `FlatSigningProvider` it involves copying all its data in order to merge both providers. I've pushed the change in a separate commit to be squashed if it's not too unreasonable. What do you think?",
      "commit_id" : "67fb46140429a6f5281486d6f0476ec43153bd47",
      "created_at" : "2023-02-11T15:34:48Z",
      "diff_hunk" : "@@ -46,17 +90,65 @@ int CalculateMaximumSignedInputSize(const CTxOut& txout, const CWallet* wallet,\n     return CalculateMaximumSignedInputSize(txout, COutPoint(), provider.get(), coin_control);\n }\n \n+/** Infer a descriptor for the given output script. */\n+static std::unique_ptr<Descriptor> GetDescriptor(const CWallet* wallet, const CCoinControl* coin_control,\n+                                                 const CScript script_pubkey)\n+{\n+    if (const auto provider = wallet->GetSolvingProvider(script_pubkey)) {\n+        return InferDescriptor(script_pubkey, *provider);\n+    }\n+    if (coin_control) {\n+        return InferDescriptor(script_pubkey, coin_control->m_external_provider);\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1103646477",
      "id" : 1103646477,
      "in_reply_to_id" : 1100365109,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585ByE8N",
      "original_commit_id" : "896a560abef52f41dbc12e3fedcd86ab4a657b06",
      "original_line" : 102,
      "original_position" : 77,
      "original_start_line" : 97,
      "path" : "src/wallet/spend.cpp",
      "position" : null,
      "pull_request_review_id" : 1294561908,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1103646477/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2023-02-11T15:34:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1103646477",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-02-16T11:10:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#issuecomment-1432920309",
      "id" : 1432920309,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26567",
      "node_id" : "IC_kwDOABII585VaKD1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1432920309/reactions"
      },
      "updated_at" : "2023-02-16T11:10:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1432920309",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1117183645"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1117183645"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> What do you think?\r\n\r\n@achow101 followup thoughts here?",
      "commit_id" : "67fb46140429a6f5281486d6f0476ec43153bd47",
      "created_at" : "2023-02-24T15:26:15Z",
      "diff_hunk" : "@@ -46,17 +90,65 @@ int CalculateMaximumSignedInputSize(const CTxOut& txout, const CWallet* wallet,\n     return CalculateMaximumSignedInputSize(txout, COutPoint(), provider.get(), coin_control);\n }\n \n+/** Infer a descriptor for the given output script. */\n+static std::unique_ptr<Descriptor> GetDescriptor(const CWallet* wallet, const CCoinControl* coin_control,\n+                                                 const CScript script_pubkey)\n+{\n+    if (const auto provider = wallet->GetSolvingProvider(script_pubkey)) {\n+        return InferDescriptor(script_pubkey, *provider);\n+    }\n+    if (coin_control) {\n+        return InferDescriptor(script_pubkey, coin_control->m_external_provider);\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1117183645",
      "id" : 1117183645,
      "in_reply_to_id" : 1100365109,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Clt6d",
      "original_commit_id" : "896a560abef52f41dbc12e3fedcd86ab4a657b06",
      "original_line" : 102,
      "original_position" : 77,
      "original_start_line" : 97,
      "path" : "src/wallet/spend.cpp",
      "position" : null,
      "pull_request_review_id" : 1313728509,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1117183645/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2023-02-24T15:26:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1117183645",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1180304523"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1180304523"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Pushed a much cleaner version of this: introducing a `MultiSigningProvider` to wrap around both the wallet and external providers. Still as a commit on top, let me know what you think @achow101.",
      "commit_id" : "9c57a61e7d333bc52e1643d04cf35fa4fda06c2e",
      "created_at" : "2023-04-28T11:39:38Z",
      "diff_hunk" : "@@ -46,17 +90,65 @@ int CalculateMaximumSignedInputSize(const CTxOut& txout, const CWallet* wallet,\n     return CalculateMaximumSignedInputSize(txout, COutPoint(), provider.get(), coin_control);\n }\n \n+/** Infer a descriptor for the given output script. */\n+static std::unique_ptr<Descriptor> GetDescriptor(const CWallet* wallet, const CCoinControl* coin_control,\n+                                                 const CScript script_pubkey)\n+{\n+    if (const auto provider = wallet->GetSolvingProvider(script_pubkey)) {\n+        return InferDescriptor(script_pubkey, *provider);\n+    }\n+    if (coin_control) {\n+        return InferDescriptor(script_pubkey, coin_control->m_external_provider);\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1180304523",
      "id" : 1180304523,
      "in_reply_to_id" : 1100365109,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585GWgSL",
      "original_commit_id" : "896a560abef52f41dbc12e3fedcd86ab4a657b06",
      "original_line" : 108,
      "original_position" : 77,
      "original_start_line" : 97,
      "path" : "src/wallet/spend.cpp",
      "position" : null,
      "pull_request_review_id" : 1405780958,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1180304523/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-04-28T11:39:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1180304523",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased, and added Miniscript support since signing support was merged.",
      "created_at" : "2023-04-29T21:10:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#issuecomment-1528873153",
      "id" : 1528873153,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26567",
      "node_id" : "IC_kwDOABII585bIMDB",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1528873153/reactions"
      },
      "updated_at" : "2023-04-29T21:10:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1528873153",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-05-03T16:59:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#issuecomment-1533390913",
      "id" : 1533390913,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26567",
      "node_id" : "IC_kwDOABII585bZbBB",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1533390913/reactions"
      },
      "updated_at" : "2023-05-03T16:59:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1533390913",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1184204984"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1184204984"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 9e8df2de1750b823492c18a924fefbd7d474819e \"descriptor: introduce a method to get the satisfaction size\"\r\n\r\nIs `MultiADescriptor` supposed to be missing a `MaxSatisfactionWeight`?",
      "commit_id" : "9c57a61e7d333bc52e1643d04cf35fa4fda06c2e",
      "created_at" : "2023-05-03T20:08:28Z",
      "diff_hunk" : "@@ -843,6 +907,15 @@ class MultiADescriptor final : public DescriptorImpl\n public:\n     MultiADescriptor(int threshold, std::vector<std::unique_ptr<PubkeyProvider>> providers, bool sorted = false) : DescriptorImpl(std::move(providers), sorted ? \"sortedmulti_a\" : \"multi_a\"), m_threshold(threshold), m_sorted(sorted) {}\n     bool IsSingleType() const final { return true; }\n+\n+    std::optional<int64_t> ScriptSize() const override {\n+        const auto n_keys = m_pubkey_args.size();\n+        return (1 + 32 + 1) * n_keys + BuildScript(m_threshold).size() + 1;\n+    }\n+\n+    std::optional<int64_t> MaxSatSize(bool use_max_sig) const override {\n+        return (1 + 65) * m_threshold + (m_pubkey_args.size() - m_threshold);\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1184204984",
      "id" : 1184204984,
      "line" : 938,
      "node_id" : "PRRC_kwDOABII585GlYi4",
      "original_commit_id" : "9e8df2de1750b823492c18a924fefbd7d474819e",
      "original_line" : 938,
      "original_position" : 125,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : 135,
      "pull_request_review_id" : 1411720143,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1184204984/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-03T20:10:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1184204984",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1232007618"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1232007618"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes. It would never be used as `MaxSatisfactionWeight` is only called on top-level descriptors.",
      "commit_id" : "9c57a61e7d333bc52e1643d04cf35fa4fda06c2e",
      "created_at" : "2023-06-16T09:22:07Z",
      "diff_hunk" : "@@ -843,6 +907,15 @@ class MultiADescriptor final : public DescriptorImpl\n public:\n     MultiADescriptor(int threshold, std::vector<std::unique_ptr<PubkeyProvider>> providers, bool sorted = false) : DescriptorImpl(std::move(providers), sorted ? \"sortedmulti_a\" : \"multi_a\"), m_threshold(threshold), m_sorted(sorted) {}\n     bool IsSingleType() const final { return true; }\n+\n+    std::optional<int64_t> ScriptSize() const override {\n+        const auto n_keys = m_pubkey_args.size();\n+        return (1 + 32 + 1) * n_keys + BuildScript(m_threshold).size() + 1;\n+    }\n+\n+    std::optional<int64_t> MaxSatSize(bool use_max_sig) const override {\n+        return (1 + 65) * m_threshold + (m_pubkey_args.size() - m_threshold);\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1232007618",
      "id" : 1232007618,
      "in_reply_to_id" : 1184204984,
      "line" : 938,
      "node_id" : "PRRC_kwDOABII585JbvHC",
      "original_commit_id" : "9e8df2de1750b823492c18a924fefbd7d474819e",
      "original_line" : 938,
      "original_position" : 125,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : 135,
      "pull_request_review_id" : 1483078333,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1232007618/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-16T09:22:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1232007618",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased, added more test coverage (we must be able to estimate the satisfaction size for any solvable top-level descriptor), properly integrated the `MultiSigningProvider` and removed the `MaxSatisfactionWeight` for `MiniscriptDescriptor` (which would never be called as they are never top-level).",
      "created_at" : "2023-06-16T09:54:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#issuecomment-1594424792",
      "id" : 1594424792,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26567",
      "node_id" : "IC_kwDOABII585fCP3Y",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1594424792/reactions"
      },
      "updated_at" : "2023-06-16T09:54:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1594424792",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1240225981"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1240225981"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 3e3521bf956c4387abe4b6ce12ce55224a9e97ba \"miniscript: introduce a helper to get the maximum witness size\"\r\n\r\nI don't quite follow why `subs[0]` needs an additional `+ 1` that `subs[1]` doesn't have. AFAICT, `subs[0]` just has a `1` in the witness, while `subs[1]` has a `0`, and both should be the same size.",
      "commit_id" : "9c57a61e7d333bc52e1643d04cf35fa4fda06c2e",
      "created_at" : "2023-06-23T19:24:21Z",
      "diff_hunk" : "@@ -846,6 +857,56 @@ struct Node {\n         assert(false);\n     }\n \n+    internal::WitnessSize CalcWitnessSize() const {\n+        switch (fragment) {\n+            case Fragment::JUST_0: return {{}, 0};\n+            case Fragment::JUST_1:\n+            case Fragment::OLDER:\n+            case Fragment::AFTER: return {0, {}};\n+            case Fragment::PK_K: return {1 + 72, 1};\n+            case Fragment::PK_H: return {1 + 72 + 1 + 33, 1 + 1 + 33};\n+            case Fragment::SHA256:\n+            case Fragment::RIPEMD160:\n+            case Fragment::HASH256:\n+            case Fragment::HASH160: return {1 + 32, {}};\n+            case Fragment::ANDOR: {\n+                const auto sat{(subs[0]->ws.sat + subs[1]->ws.sat) | (subs[0]->ws.dsat + subs[2]->ws.sat)};\n+                const auto dsat{subs[0]->ws.dsat + subs[2]->ws.dsat};\n+                return {sat, dsat};\n+            }\n+            case Fragment::AND_V: return {subs[0]->ws.sat + subs[1]->ws.sat, {}};\n+            case Fragment::AND_B: return {subs[0]->ws.sat + subs[1]->ws.sat, subs[0]->ws.dsat + subs[1]->ws.dsat};\n+            case Fragment::OR_B: {\n+                const auto sat{(subs[0]->ws.dsat + subs[1]->ws.sat) | (subs[0]->ws.sat + subs[1]->ws.dsat)};\n+                const auto dsat{subs[0]->ws.dsat + subs[1]->ws.dsat};\n+                return {sat, dsat};\n+            }\n+            case Fragment::OR_C: return {subs[0]->ws.sat | (subs[0]->ws.dsat + subs[1]->ws.sat), {}};\n+            case Fragment::OR_D: return {subs[0]->ws.sat | (subs[0]->ws.dsat + subs[1]->ws.sat), subs[0]->ws.dsat + subs[1]->ws.dsat};\n+            case Fragment::OR_I: return {(subs[0]->ws.sat + 1 + 1) | (subs[1]->ws.sat + 1), (subs[0]->ws.dsat + 1 + 1) | (subs[1]->ws.dsat + 1)};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1240225981",
      "id" : 1240225981,
      "line" : 886,
      "node_id" : "PRRC_kwDOABII585J7Fi9",
      "original_commit_id" : "3e3521bf956c4387abe4b6ce12ce55224a9e97ba",
      "original_line" : 886,
      "original_position" : 55,
      "original_start_line" : null,
      "path" : "src/script/miniscript.h",
      "position" : 55,
      "pull_request_review_id" : 1495781351,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1240225981/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-23T19:44:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1240225981",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1240233314"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1240233314"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This wasn't changed?",
      "commit_id" : "9c57a61e7d333bc52e1643d04cf35fa4fda06c2e",
      "created_at" : "2023-06-23T19:31:47Z",
      "diff_hunk" : "@@ -816,6 +864,20 @@ class MultisigDescriptor final : public DescriptorImpl\n public:\n     MultisigDescriptor(int threshold, std::vector<std::unique_ptr<PubkeyProvider>> providers, bool sorted = false) : DescriptorImpl(std::move(providers), sorted ? \"sortedmulti\" : \"multi\"), m_threshold(threshold), m_sorted(sorted) {}\n     bool IsSingleType() const final { return true; }\n+\n+    std::optional<int64_t> ScriptSize() const override {\n+        const auto n_keys = m_pubkey_args.size();\n+        return 1 + BuildScript(n_keys).size() + BuildScript(m_threshold).size() + 34 * n_keys;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1240233314",
      "id" : 1240233314,
      "in_reply_to_id" : 1096378894,
      "line" : 892,
      "node_id" : "PRRC_kwDOABII585J7HVi",
      "original_commit_id" : "c8b0aeb534edce08366176275d5577c1e309eb6f",
      "original_line" : 892,
      "original_position" : 97,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : 107,
      "pull_request_review_id" : 1495781351,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1240233314/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-23T19:44:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1240233314",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1243598951"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1243598951"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Because serializing a `1` as a witness stack element needs to specify a 1-byte long element and then the value of this byte (serialized `0x0101`) whereas encoding a `0` is simply the empty witness (serialized `0x00`).",
      "commit_id" : "9c57a61e7d333bc52e1643d04cf35fa4fda06c2e",
      "created_at" : "2023-06-27T11:43:01Z",
      "diff_hunk" : "@@ -846,6 +857,56 @@ struct Node {\n         assert(false);\n     }\n \n+    internal::WitnessSize CalcWitnessSize() const {\n+        switch (fragment) {\n+            case Fragment::JUST_0: return {{}, 0};\n+            case Fragment::JUST_1:\n+            case Fragment::OLDER:\n+            case Fragment::AFTER: return {0, {}};\n+            case Fragment::PK_K: return {1 + 72, 1};\n+            case Fragment::PK_H: return {1 + 72 + 1 + 33, 1 + 1 + 33};\n+            case Fragment::SHA256:\n+            case Fragment::RIPEMD160:\n+            case Fragment::HASH256:\n+            case Fragment::HASH160: return {1 + 32, {}};\n+            case Fragment::ANDOR: {\n+                const auto sat{(subs[0]->ws.sat + subs[1]->ws.sat) | (subs[0]->ws.dsat + subs[2]->ws.sat)};\n+                const auto dsat{subs[0]->ws.dsat + subs[2]->ws.dsat};\n+                return {sat, dsat};\n+            }\n+            case Fragment::AND_V: return {subs[0]->ws.sat + subs[1]->ws.sat, {}};\n+            case Fragment::AND_B: return {subs[0]->ws.sat + subs[1]->ws.sat, subs[0]->ws.dsat + subs[1]->ws.dsat};\n+            case Fragment::OR_B: {\n+                const auto sat{(subs[0]->ws.dsat + subs[1]->ws.sat) | (subs[0]->ws.sat + subs[1]->ws.dsat)};\n+                const auto dsat{subs[0]->ws.dsat + subs[1]->ws.dsat};\n+                return {sat, dsat};\n+            }\n+            case Fragment::OR_C: return {subs[0]->ws.sat | (subs[0]->ws.dsat + subs[1]->ws.sat), {}};\n+            case Fragment::OR_D: return {subs[0]->ws.sat | (subs[0]->ws.dsat + subs[1]->ws.sat), subs[0]->ws.dsat + subs[1]->ws.dsat};\n+            case Fragment::OR_I: return {(subs[0]->ws.sat + 1 + 1) | (subs[1]->ws.sat + 1), (subs[0]->ws.dsat + 1 + 1) | (subs[1]->ws.dsat + 1)};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1243598951",
      "id" : 1243598951,
      "in_reply_to_id" : 1240225981,
      "line" : 886,
      "node_id" : "PRRC_kwDOABII585KH9Bn",
      "original_commit_id" : "3e3521bf956c4387abe4b6ce12ce55224a9e97ba",
      "original_line" : 886,
      "original_position" : 55,
      "original_start_line" : null,
      "path" : "src/script/miniscript.h",
      "position" : 55,
      "pull_request_review_id" : 1500646225,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1243598951/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-27T11:43:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1243598951",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1243851964"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1243851964"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oops. Done now.",
      "commit_id" : "f577372b92b797fe0bc642990d631635d1ae7b51",
      "created_at" : "2023-06-27T14:30:43Z",
      "diff_hunk" : "@@ -816,6 +864,20 @@ class MultisigDescriptor final : public DescriptorImpl\n public:\n     MultisigDescriptor(int threshold, std::vector<std::unique_ptr<PubkeyProvider>> providers, bool sorted = false) : DescriptorImpl(std::move(providers), sorted ? \"sortedmulti\" : \"multi\"), m_threshold(threshold), m_sorted(sorted) {}\n     bool IsSingleType() const final { return true; }\n+\n+    std::optional<int64_t> ScriptSize() const override {\n+        const auto n_keys = m_pubkey_args.size();\n+        return 1 + BuildScript(n_keys).size() + BuildScript(m_threshold).size() + 34 * n_keys;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1243851964",
      "id" : 1243851964,
      "in_reply_to_id" : 1096378894,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585KI6y8",
      "original_commit_id" : "c8b0aeb534edce08366176275d5577c1e309eb6f",
      "original_line" : 892,
      "original_position" : 97,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : null,
      "pull_request_review_id" : 1501045919,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1243851964/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-27T14:30:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1243851964",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1243894028"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1243894028"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I thought `1` was `OP_1`?",
      "commit_id" : "f577372b92b797fe0bc642990d631635d1ae7b51",
      "created_at" : "2023-06-27T14:55:06Z",
      "diff_hunk" : "@@ -846,6 +857,56 @@ struct Node {\n         assert(false);\n     }\n \n+    internal::WitnessSize CalcWitnessSize() const {\n+        switch (fragment) {\n+            case Fragment::JUST_0: return {{}, 0};\n+            case Fragment::JUST_1:\n+            case Fragment::OLDER:\n+            case Fragment::AFTER: return {0, {}};\n+            case Fragment::PK_K: return {1 + 72, 1};\n+            case Fragment::PK_H: return {1 + 72 + 1 + 33, 1 + 1 + 33};\n+            case Fragment::SHA256:\n+            case Fragment::RIPEMD160:\n+            case Fragment::HASH256:\n+            case Fragment::HASH160: return {1 + 32, {}};\n+            case Fragment::ANDOR: {\n+                const auto sat{(subs[0]->ws.sat + subs[1]->ws.sat) | (subs[0]->ws.dsat + subs[2]->ws.sat)};\n+                const auto dsat{subs[0]->ws.dsat + subs[2]->ws.dsat};\n+                return {sat, dsat};\n+            }\n+            case Fragment::AND_V: return {subs[0]->ws.sat + subs[1]->ws.sat, {}};\n+            case Fragment::AND_B: return {subs[0]->ws.sat + subs[1]->ws.sat, subs[0]->ws.dsat + subs[1]->ws.dsat};\n+            case Fragment::OR_B: {\n+                const auto sat{(subs[0]->ws.dsat + subs[1]->ws.sat) | (subs[0]->ws.sat + subs[1]->ws.dsat)};\n+                const auto dsat{subs[0]->ws.dsat + subs[1]->ws.dsat};\n+                return {sat, dsat};\n+            }\n+            case Fragment::OR_C: return {subs[0]->ws.sat | (subs[0]->ws.dsat + subs[1]->ws.sat), {}};\n+            case Fragment::OR_D: return {subs[0]->ws.sat | (subs[0]->ws.dsat + subs[1]->ws.sat), subs[0]->ws.dsat + subs[1]->ws.dsat};\n+            case Fragment::OR_I: return {(subs[0]->ws.sat + 1 + 1) | (subs[1]->ws.sat + 1), (subs[0]->ws.dsat + 1 + 1) | (subs[1]->ws.dsat + 1)};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1243894028",
      "id" : 1243894028,
      "in_reply_to_id" : 1240225981,
      "line" : 886,
      "node_id" : "PRRC_kwDOABII585KJFEM",
      "original_commit_id" : "3e3521bf956c4387abe4b6ce12ce55224a9e97ba",
      "original_line" : 886,
      "original_position" : 55,
      "original_start_line" : null,
      "path" : "src/script/miniscript.h",
      "position" : 55,
      "pull_request_review_id" : 1501125885,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1243894028/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-27T14:55:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1243894028",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1243896823"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1243896823"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Not in witnesses. :)",
      "commit_id" : "f577372b92b797fe0bc642990d631635d1ae7b51",
      "created_at" : "2023-06-27T14:56:43Z",
      "diff_hunk" : "@@ -846,6 +857,56 @@ struct Node {\n         assert(false);\n     }\n \n+    internal::WitnessSize CalcWitnessSize() const {\n+        switch (fragment) {\n+            case Fragment::JUST_0: return {{}, 0};\n+            case Fragment::JUST_1:\n+            case Fragment::OLDER:\n+            case Fragment::AFTER: return {0, {}};\n+            case Fragment::PK_K: return {1 + 72, 1};\n+            case Fragment::PK_H: return {1 + 72 + 1 + 33, 1 + 1 + 33};\n+            case Fragment::SHA256:\n+            case Fragment::RIPEMD160:\n+            case Fragment::HASH256:\n+            case Fragment::HASH160: return {1 + 32, {}};\n+            case Fragment::ANDOR: {\n+                const auto sat{(subs[0]->ws.sat + subs[1]->ws.sat) | (subs[0]->ws.dsat + subs[2]->ws.sat)};\n+                const auto dsat{subs[0]->ws.dsat + subs[2]->ws.dsat};\n+                return {sat, dsat};\n+            }\n+            case Fragment::AND_V: return {subs[0]->ws.sat + subs[1]->ws.sat, {}};\n+            case Fragment::AND_B: return {subs[0]->ws.sat + subs[1]->ws.sat, subs[0]->ws.dsat + subs[1]->ws.dsat};\n+            case Fragment::OR_B: {\n+                const auto sat{(subs[0]->ws.dsat + subs[1]->ws.sat) | (subs[0]->ws.sat + subs[1]->ws.dsat)};\n+                const auto dsat{subs[0]->ws.dsat + subs[1]->ws.dsat};\n+                return {sat, dsat};\n+            }\n+            case Fragment::OR_C: return {subs[0]->ws.sat | (subs[0]->ws.dsat + subs[1]->ws.sat), {}};\n+            case Fragment::OR_D: return {subs[0]->ws.sat | (subs[0]->ws.dsat + subs[1]->ws.sat), subs[0]->ws.dsat + subs[1]->ws.dsat};\n+            case Fragment::OR_I: return {(subs[0]->ws.sat + 1 + 1) | (subs[1]->ws.sat + 1), (subs[0]->ws.dsat + 1 + 1) | (subs[1]->ws.dsat + 1)};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1243896823",
      "id" : 1243896823,
      "in_reply_to_id" : 1240225981,
      "line" : 886,
      "node_id" : "PRRC_kwDOABII585KJFv3",
      "original_commit_id" : "3e3521bf956c4387abe4b6ce12ce55224a9e97ba",
      "original_line" : 886,
      "original_position" : 55,
      "original_start_line" : null,
      "path" : "src/script/miniscript.h",
      "position" : 55,
      "pull_request_review_id" : 1501131295,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1243896823/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-27T14:56:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1243896823",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1243922086"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1243922086"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oh right, duh.",
      "commit_id" : "f577372b92b797fe0bc642990d631635d1ae7b51",
      "created_at" : "2023-06-27T15:11:25Z",
      "diff_hunk" : "@@ -846,6 +857,56 @@ struct Node {\n         assert(false);\n     }\n \n+    internal::WitnessSize CalcWitnessSize() const {\n+        switch (fragment) {\n+            case Fragment::JUST_0: return {{}, 0};\n+            case Fragment::JUST_1:\n+            case Fragment::OLDER:\n+            case Fragment::AFTER: return {0, {}};\n+            case Fragment::PK_K: return {1 + 72, 1};\n+            case Fragment::PK_H: return {1 + 72 + 1 + 33, 1 + 1 + 33};\n+            case Fragment::SHA256:\n+            case Fragment::RIPEMD160:\n+            case Fragment::HASH256:\n+            case Fragment::HASH160: return {1 + 32, {}};\n+            case Fragment::ANDOR: {\n+                const auto sat{(subs[0]->ws.sat + subs[1]->ws.sat) | (subs[0]->ws.dsat + subs[2]->ws.sat)};\n+                const auto dsat{subs[0]->ws.dsat + subs[2]->ws.dsat};\n+                return {sat, dsat};\n+            }\n+            case Fragment::AND_V: return {subs[0]->ws.sat + subs[1]->ws.sat, {}};\n+            case Fragment::AND_B: return {subs[0]->ws.sat + subs[1]->ws.sat, subs[0]->ws.dsat + subs[1]->ws.dsat};\n+            case Fragment::OR_B: {\n+                const auto sat{(subs[0]->ws.dsat + subs[1]->ws.sat) | (subs[0]->ws.sat + subs[1]->ws.dsat)};\n+                const auto dsat{subs[0]->ws.dsat + subs[1]->ws.dsat};\n+                return {sat, dsat};\n+            }\n+            case Fragment::OR_C: return {subs[0]->ws.sat | (subs[0]->ws.dsat + subs[1]->ws.sat), {}};\n+            case Fragment::OR_D: return {subs[0]->ws.sat | (subs[0]->ws.dsat + subs[1]->ws.sat), subs[0]->ws.dsat + subs[1]->ws.dsat};\n+            case Fragment::OR_I: return {(subs[0]->ws.sat + 1 + 1) | (subs[1]->ws.sat + 1), (subs[0]->ws.dsat + 1 + 1) | (subs[1]->ws.dsat + 1)};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26567#discussion_r1243922086",
      "id" : 1243922086,
      "in_reply_to_id" : 1240225981,
      "line" : 886,
      "node_id" : "PRRC_kwDOABII585KJL6m",
      "original_commit_id" : "3e3521bf956c4387abe4b6ce12ce55224a9e97ba",
      "original_line" : 886,
      "original_position" : 55,
      "original_start_line" : null,
      "path" : "src/script/miniscript.h",
      "position" : 55,
      "pull_request_review_id" : 1501179923,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26567",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1243922086/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-27T15:11:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1243922086",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   }
]
