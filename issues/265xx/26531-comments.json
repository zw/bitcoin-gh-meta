[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [jamesob](https://github.com/bitcoin/bitcoin/pull/26531#pullrequestreview-1186284786), [glozow](https://github.com/bitcoin/bitcoin/pull/26531#pullrequestreview-1186573943), [dergoegge](https://github.com/bitcoin/bitcoin/pull/26531#issuecomment-1324291258), [0xB10C](https://github.com/bitcoin/bitcoin/pull/26531#issuecomment-1333832906) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26289](https://github.com/bitcoin/bitcoin/pull/26289) (Use util::Result in for calculating mempool ancestors by stickies-v)\n* [#25832](https://github.com/bitcoin/bitcoin/pull/25832) (tracing: network connection tracepoints by 0xB10C)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2022-11-18T14:34:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#issuecomment-1320075744",
      "id" : 1320075744,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26531",
      "node_id" : "IC_kwDOABII585OrsHg",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1320075744/reactions"
      },
      "updated_at" : "2022-12-06T06:35:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1320075744",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2022-11-18T15:02:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#issuecomment-1320139932",
      "id" : 1320139932,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26531",
      "node_id" : "IC_kwDOABII585Or7yc",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1320139932/reactions"
      },
      "updated_at" : "2022-11-18T15:02:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1320139932",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1026553186"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1026553186"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Would it make sense to convey information about the peer (even if just ID) as well? One of the things that I think is potentially valuable e.g. [in bmon](https://github.com/chaincodelabs/bmon/blob/master/bmon/logparse.py#L245) is tracking which peers fed you which transactions.",
      "commit_id" : "c0395b5c1b27af281db1cbaec539c2d9f2ba4e6f",
      "created_at" : "2022-11-18T15:10:47Z",
      "diff_hunk" : "@@ -211,6 +211,58 @@ Arguments passed:\n 4. The expected transaction fee as an `int64`\n 5. The position of the change output as an `int32`\n \n+### Context `mempool`\n+\n+#### Tracepoint `mempool:added`\n+\n+Is called when a transaction is added to the node's mempool. Passes information\n+about the transaction.\n+\n+Arguments passed:\n+1. Transaction ID (hash) as `pointer to unsigned chars` (i.e. 32 bytes in little-endian)\n+2. Transaction virtual size as `uint64`\n+3. Transaction fee as `int64`",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1026553186",
      "id" : 1026553186,
      "line" : 224,
      "node_id" : "PRRC_kwDOABII5849L_Vi",
      "original_commit_id" : "c0395b5c1b27af281db1cbaec539c2d9f2ba4e6f",
      "original_line" : 224,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "doc/tracing.md",
      "position" : 14,
      "pull_request_review_id" : 1186284786,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1026553186/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-18T15:17:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1026553186",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1026742783"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1026742783"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```\r\ntest/functional/interface_usdt_mempool.py:14: error: Cannot find implementation or library stub for module named \"bcc\"  [import]\r\ntest/functional/interface_usdt_mempool.py:14: note: See https://mypy.readthedocs.io/en/stable/running_mypy.html#missing-imports\r\nFound 1 error in 1 file (checked 256 source files)\r\n^---- failure generated from lint-python.py\r\n```\r\n\r\n\r\nI think you may want to do this?\r\n```suggestion\r\n# Test will be skipped if we don't have bcc installed\r\ntry:\r\n    from bcc import BPF, USDT # type: ignore[import]\r\nexcept ImportError:\r\n    pass\r\n```",
      "commit_id" : "c0395b5c1b27af281db1cbaec539c2d9f2ba4e6f",
      "created_at" : "2022-11-18T18:07:53Z",
      "diff_hunk" : "@@ -0,0 +1,361 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\" Example logging Bitcoin Core mempool events using the mempool:added,\n+    mempool:removed, mempool:replaced, and mempool:rejected tracepoints. \"\"\"\n+\n+import curses\n+import sys\n+from datetime import datetime, timezone\n+\n+from bcc import BPF, USDT",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1026742783",
      "id" : 1026742783,
      "line" : 13,
      "node_id" : "PRRC_kwDOABII5849Mtn_",
      "original_commit_id" : "c0395b5c1b27af281db1cbaec539c2d9f2ba4e6f",
      "original_line" : 13,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "contrib/tracing/mempool_monitor.py",
      "position" : 13,
      "pull_request_review_id" : 1186573943,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1026742783/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-18T18:08:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1026742783",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1026753452"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1026753452"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "yes, that's the trick we're using in the other tracepoint tests too",
      "commit_id" : "c0395b5c1b27af281db1cbaec539c2d9f2ba4e6f",
      "created_at" : "2022-11-18T18:21:28Z",
      "diff_hunk" : "@@ -0,0 +1,361 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\" Example logging Bitcoin Core mempool events using the mempool:added,\n+    mempool:removed, mempool:replaced, and mempool:rejected tracepoints. \"\"\"\n+\n+import curses\n+import sys\n+from datetime import datetime, timezone\n+\n+from bcc import BPF, USDT",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1026753452",
      "id" : 1026753452,
      "in_reply_to_id" : 1026742783,
      "line" : 13,
      "node_id" : "PRRC_kwDOABII5849MwOs",
      "original_commit_id" : "c0395b5c1b27af281db1cbaec539c2d9f2ba4e6f",
      "original_line" : 13,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "contrib/tracing/mempool_monitor.py",
      "position" : 13,
      "pull_request_review_id" : 1186590304,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1026753452/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-18T18:21:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1026753452",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1027105344"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1027105344"
         }
      },
      "author_association" : "NONE",
      "body" : "Thanks.",
      "commit_id" : "80a9dc387628ea06fbd8f20ec833b9fc5da419b5",
      "created_at" : "2022-11-19T15:24:00Z",
      "diff_hunk" : "@@ -0,0 +1,361 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\" Example logging Bitcoin Core mempool events using the mempool:added,\n+    mempool:removed, mempool:replaced, and mempool:rejected tracepoints. \"\"\"\n+\n+import curses\n+import sys\n+from datetime import datetime, timezone\n+\n+from bcc import BPF, USDT",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1027105344",
      "id" : 1027105344,
      "in_reply_to_id" : 1026742783,
      "line" : 13,
      "node_id" : "PRRC_kwDOABII5849OGJA",
      "original_commit_id" : "c0395b5c1b27af281db1cbaec539c2d9f2ba4e6f",
      "original_line" : 13,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "contrib/tracing/mempool_monitor.py",
      "position" : 13,
      "pull_request_review_id" : 1187084943,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1027105344/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-19T15:24:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1027105344",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/72414353?v=4",
         "events_url" : "https://api.github.com/users/virtu/events{/privacy}",
         "followers_url" : "https://api.github.com/users/virtu/followers",
         "following_url" : "https://api.github.com/users/virtu/following{/other_user}",
         "gists_url" : "https://api.github.com/users/virtu/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/virtu",
         "id" : 72414353,
         "login" : "virtu",
         "node_id" : "MDQ6VXNlcjcyNDE0MzUz",
         "organizations_url" : "https://api.github.com/users/virtu/orgs",
         "received_events_url" : "https://api.github.com/users/virtu/received_events",
         "repos_url" : "https://api.github.com/users/virtu/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/virtu/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/virtu/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/virtu"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1028048065"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1028048065"
         }
      },
      "author_association" : "NONE",
      "body" : "I think it makes sense.\r\n\r\nHowever, peer information is no longer available in functions that handle low-level mempool operations, so I propose adding a separate `mempool:accepted` tracepoint for this in `PeerManagerImpl::ProcessMessage` [here](https://github.com/bitcoin/bitcoin/blob/master/src/net_processing.cpp#L4042) (which is right where the debug log entries for transactions accepted into the memory pool are created).\r\n\r\nThe rationale for adding a separate `mempool:accepted` tracepoint instead of moving the existing `mempool:added` one from `CTxMemPool::addUnchecked` is to ensure consistency of added and removed transactions.\r\n\r\nDetails: The tracepoint call in `ProcessMessage` would depend on the success of `ProcessTransaction` [here](https://github.com/bitcoin/bitcoin/blob/master/src/net_processing.cpp#L4025). There's an edge case where a transaction added to the mempool in `MemPoolAccept::Finalize` [here](https://github.com/bitcoin/bitcoin/blob/master/src/validation.cpp#L1074) is immediately removed again seven lines below during the call to `LimitMempoolSize`, in which case `MemPoolAccept::Finalize` will return `state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"mempool full\")`. As expected, in this case `ProcessMessage` will not call the tracepoint (or create a debug log entry). `LimitMempoolSize`, however, will at some point call `CTxMemPool::removeUnchecked`, which calls the `mempool:removed` tracepoint, resulting in tracepoint data containing a \"transaction removed\" event without a preceding \"transaction added\" event.\r\n\r\nPlease note that this problem does not arise due to poor placement of the `mempool:removed` tracepoint [here](https://github.com/virtu/bitcoin/blob/add_mempool_tracepoints/src/txmempool.cpp#L481-L488). The tracepoint is positioned right after `GetMainSignals().TransactionRemovedFromMempool`, which leads me to believe that the aforementioned consistency issue currently affects zeromq (cf. [here](https://github.com/bitcoin/bitcoin/blob/master/src/validation.cpp#L1184-L1186)) and the debug log.",
      "commit_id" : "8b6ac488fbf851c006b4a9b45d48ac0ec3d77480",
      "created_at" : "2022-11-21T13:39:31Z",
      "diff_hunk" : "@@ -211,6 +211,58 @@ Arguments passed:\n 4. The expected transaction fee as an `int64`\n 5. The position of the change output as an `int32`\n \n+### Context `mempool`\n+\n+#### Tracepoint `mempool:added`\n+\n+Is called when a transaction is added to the node's mempool. Passes information\n+about the transaction.\n+\n+Arguments passed:\n+1. Transaction ID (hash) as `pointer to unsigned chars` (i.e. 32 bytes in little-endian)\n+2. Transaction virtual size as `uint64`\n+3. Transaction fee as `int64`",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1028048065",
      "id" : 1028048065,
      "in_reply_to_id" : 1026553186,
      "line" : 224,
      "node_id" : "PRRC_kwDOABII5849RsTB",
      "original_commit_id" : "c0395b5c1b27af281db1cbaec539c2d9f2ba4e6f",
      "original_line" : 224,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "doc/tracing.md",
      "position" : 14,
      "pull_request_review_id" : 1188253417,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1028048065/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-21T13:55:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1028048065",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/72414353?v=4",
         "events_url" : "https://api.github.com/users/virtu/events{/privacy}",
         "followers_url" : "https://api.github.com/users/virtu/followers",
         "following_url" : "https://api.github.com/users/virtu/following{/other_user}",
         "gists_url" : "https://api.github.com/users/virtu/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/virtu",
         "id" : 72414353,
         "login" : "virtu",
         "node_id" : "MDQ6VXNlcjcyNDE0MzUz",
         "organizations_url" : "https://api.github.com/users/virtu/orgs",
         "received_events_url" : "https://api.github.com/users/virtu/received_events",
         "repos_url" : "https://api.github.com/users/virtu/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/virtu/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/virtu/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/virtu"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1028068736"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1028068736"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Note that adding transactions we receive over the network is only one option out of several to add something to our mempool. Can also add transactions via RPC, `loadMempool()`, wallet, etc..   \r\n\r\nI agree that it could be useful to have information about peers that send us transactions we end up accepting.  Could call a tracepoint something like `net:tx_accepted`. Not sure if that's in-scope for this PR though.",
      "commit_id" : "8b6ac488fbf851c006b4a9b45d48ac0ec3d77480",
      "created_at" : "2022-11-21T13:54:49Z",
      "diff_hunk" : "@@ -211,6 +211,58 @@ Arguments passed:\n 4. The expected transaction fee as an `int64`\n 5. The position of the change output as an `int32`\n \n+### Context `mempool`\n+\n+#### Tracepoint `mempool:added`\n+\n+Is called when a transaction is added to the node's mempool. Passes information\n+about the transaction.\n+\n+Arguments passed:\n+1. Transaction ID (hash) as `pointer to unsigned chars` (i.e. 32 bytes in little-endian)\n+2. Transaction virtual size as `uint64`\n+3. Transaction fee as `int64`",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1028068736",
      "id" : 1028068736,
      "in_reply_to_id" : 1026553186,
      "line" : 224,
      "node_id" : "PRRC_kwDOABII5849RxWA",
      "original_commit_id" : "c0395b5c1b27af281db1cbaec539c2d9f2ba4e6f",
      "original_line" : 224,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "doc/tracing.md",
      "position" : 14,
      "pull_request_review_id" : 1188280732,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1028068736/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-21T13:54:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1028068736",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1029861158"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1029861158"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Couldn't this be done by using both `net:inbound_message` and `mempool:added` at the same time? That is, correlate the txids from both tracepoints to deduce which peer sent the tx.",
      "commit_id" : "8b6ac488fbf851c006b4a9b45d48ac0ec3d77480",
      "created_at" : "2022-11-22T22:01:20Z",
      "diff_hunk" : "@@ -211,6 +211,58 @@ Arguments passed:\n 4. The expected transaction fee as an `int64`\n 5. The position of the change output as an `int32`\n \n+### Context `mempool`\n+\n+#### Tracepoint `mempool:added`\n+\n+Is called when a transaction is added to the node's mempool. Passes information\n+about the transaction.\n+\n+Arguments passed:\n+1. Transaction ID (hash) as `pointer to unsigned chars` (i.e. 32 bytes in little-endian)\n+2. Transaction virtual size as `uint64`\n+3. Transaction fee as `int64`",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1029861158",
      "id" : 1029861158,
      "in_reply_to_id" : 1026553186,
      "line" : 224,
      "node_id" : "PRRC_kwDOABII5849Ym8m",
      "original_commit_id" : "c0395b5c1b27af281db1cbaec539c2d9f2ba4e6f",
      "original_line" : 224,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "doc/tracing.md",
      "position" : 14,
      "pull_request_review_id" : 1190828014,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1029861158/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-22T22:01:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1029861158",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
         "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dergoegge/followers",
         "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dergoegge",
         "id" : 8077169,
         "login" : "dergoegge",
         "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
         "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
         "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
         "repos_url" : "https://api.github.com/users/dergoegge/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dergoegge"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2022-11-22T22:02:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#issuecomment-1324291258",
      "id" : 1324291258,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26531",
      "node_id" : "IC_kwDOABII585O7xS6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1324291258/reactions"
      },
      "updated_at" : "2022-11-22T22:02:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1324291258",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
         "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dergoegge/followers",
         "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dergoegge",
         "id" : 8077169,
         "login" : "dergoegge",
         "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
         "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
         "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
         "repos_url" : "https://api.github.com/users/dergoegge/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dergoegge"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1029925507"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1029925507"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, that works too. Needs transaction decoding in the tracing script though, but possible ",
      "commit_id" : "8b6ac488fbf851c006b4a9b45d48ac0ec3d77480",
      "created_at" : "2022-11-23T00:06:17Z",
      "diff_hunk" : "@@ -211,6 +211,58 @@ Arguments passed:\n 4. The expected transaction fee as an `int64`\n 5. The position of the change output as an `int32`\n \n+### Context `mempool`\n+\n+#### Tracepoint `mempool:added`\n+\n+Is called when a transaction is added to the node's mempool. Passes information\n+about the transaction.\n+\n+Arguments passed:\n+1. Transaction ID (hash) as `pointer to unsigned chars` (i.e. 32 bytes in little-endian)\n+2. Transaction virtual size as `uint64`\n+3. Transaction fee as `int64`",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1029925507",
      "id" : 1029925507,
      "in_reply_to_id" : 1026553186,
      "line" : 224,
      "node_id" : "PRRC_kwDOABII5849Y2qD",
      "original_commit_id" : "c0395b5c1b27af281db1cbaec539c2d9f2ba4e6f",
      "original_line" : 224,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "doc/tracing.md",
      "position" : 14,
      "pull_request_review_id" : 1190914432,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1029925507/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-23T00:06:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1029925507",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1036914820"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1036914820"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: I'd find it more intuitive to first pass the replaced transaction and then the replacement. ",
      "commit_id" : "3b6d3f0294bca3985458eb97c89c8e07704957e6",
      "created_at" : "2022-12-01T10:02:30Z",
      "diff_hunk" : "@@ -211,6 +211,58 @@ Arguments passed:\n 4. The expected transaction fee as an `int64`\n 5. The position of the change output as an `int32`\n \n+### Context `mempool`\n+\n+#### Tracepoint `mempool:added`\n+\n+Is called when a transaction is added to the node's mempool. Passes information\n+about the transaction.\n+\n+Arguments passed:\n+1. Transaction ID (hash) as `pointer to unsigned chars` (i.e. 32 bytes in little-endian)\n+2. Transaction virtual size as `uint64`\n+3. Transaction fee as `int64`\n+\n+#### Tracepoint `mempool:removed`\n+\n+Is called when a transaction is removed from the node's mempool. Passes information\n+about the transaction.\n+\n+Arguments passed:\n+1. Transaction ID (hash) as `pointer to unsigned chars` (i.e. 32 bytes in little-endian)\n+2. Removal reason as `pointer to C-style String` (max. length 9 characters)\n+3. Transaction virtual size as `uint64`\n+4. Transaction fee as `int64`\n+\n+#### Tracepoint `mempool:replaced`\n+\n+Is called when a transaction in the node's mempool is getting replaced by another.\n+Passed information about the replaced and replacement transactions.\n+\n+Arguments passed:\n+1. Replacement transaction ID (hash) as `pointer to unsigned chars` (i.e. 32 bytes in little-endian)\n+2. Replacement transaction virtual size as `uint64`\n+3. Replacement transaction fee as `int64`\n+4. Replaced transaction ID (hash) as `pointer to unsigned chars` (i.e. 32 bytes in little-endian)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1036914820",
      "id" : 1036914820,
      "line" : 246,
      "node_id" : "PRRC_kwDOABII5849zhCE",
      "original_commit_id" : "3b6d3f0294bca3985458eb97c89c8e07704957e6",
      "original_line" : 246,
      "original_position" : 36,
      "original_start_line" : 245,
      "path" : "doc/tracing.md",
      "position" : 36,
      "pull_request_review_id" : 1200696353,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1036914820/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 245,
      "start_side" : "RIGHT",
      "updated_at" : "2022-12-01T10:02:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1036914820",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "With [#26593: tracing: Only prepare tracepoint arguments when actually tracing](https://github.com/bitcoin/bitcoin/pull/26593), we could also pass the serialized transactions as arguments for the mempool tracepoints. I think this makes these mempool tracepoints even more interesting as we otherwise only have the txids of removed/rejected/replaced transactions and wouldn't need to pair them with e.g. ZMQ `rawtx` data in an extra step.  As demonstration, see the last three commits of [2022-11-virtu-add_mempool_tracepoints-with-rawtx](https://github.com/0xB10C/bitcoin/commits/2022-11-virtu-add_mempool_tracepoints-with-rawtx). I'd be interested in hearing from people that left a Concept ACK here and @virtu if this extension to this PR that makes sense (once we have more Concept ACKs for #26593).\r\n\r\nI'm currently working on monitoring for fullrbf replacements as seen by my node with the above branch (if the replaced transaction didn't signal optin-RBF, it should be a fullrbf replacement). Edit: It's live on https://fullrbf.mempool.observer.\r\n\r\n(also sorry for the \"0xB10C added a commit to 0xB10C/bitcoin that referenced this pull request\" spam. Forgot that this would appear here for every force push...)\r\n",
      "created_at" : "2022-12-01T14:15:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#issuecomment-1333832906",
      "id" : 1333832906,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26531",
      "node_id" : "IC_kwDOABII585PgKzK",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333832906/reactions"
      },
      "updated_at" : "2022-12-09T15:45:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333832906",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Super cool stuff! One note should removal reason 'BLOCK' be logged? It's the one exclusion from even ZMQ because of the resulting data dump.  With eBPF it's the most difficult to log because it will overflow the eBPF ring buffer every time. There is a clever solution to use the eBPF filesystem to store data that would otherwise overflow the ring buffer. \r\n\r\nref. [#24935](https://github.com/bitcoin/bitcoin/pull/24935) ",
      "created_at" : "2022-12-01T14:42:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#issuecomment-1333869334",
      "id" : 1333869334,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26531",
      "node_id" : "IC_kwDOABII585PgTsW",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333869334/reactions"
      },
      "updated_at" : "2022-12-01T14:42:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333869334",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3104223?v=4",
         "events_url" : "https://api.github.com/users/russeree/events{/privacy}",
         "followers_url" : "https://api.github.com/users/russeree/followers",
         "following_url" : "https://api.github.com/users/russeree/following{/other_user}",
         "gists_url" : "https://api.github.com/users/russeree/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/russeree",
         "id" : 3104223,
         "login" : "russeree",
         "node_id" : "MDQ6VXNlcjMxMDQyMjM=",
         "organizations_url" : "https://api.github.com/users/russeree/orgs",
         "received_events_url" : "https://api.github.com/users/russeree/received_events",
         "repos_url" : "https://api.github.com/users/russeree/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/russeree/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/russeree/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/russeree"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> One note should removal reason 'BLOCK' be logged? It's the one exclusion from even ZMQ because of the resulting data dump. With eBPF it's the most difficult to log because it will overflow the eBPF ring buffer every time.\r\n\r\nBlock removal was deliberately included because it makes data collection much easier (inferring removal times from block arrival time involves a certain degree of processing; also, timestamps could be wrong if there was a block reorg and the original block is lost) and the overhead of calling the tracepoint pales in comparison to the rest of the code. But that's not set in stone.\r\n\r\nCheck the `mempool_monitor.py`'s [code](https://github.com/bitcoin/bitcoin/pull/26531/files#diff-f0c928fac39782cb8cefde1f6345d08195e0c359a68aa53d2ed6af6ca45208cbR152-R158) for a possible take on avoiding overflowing the ring buffer.",
      "created_at" : "2022-12-01T15:15:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#issuecomment-1333921682",
      "id" : 1333921682,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26531",
      "node_id" : "IC_kwDOABII585PggeS",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333921682/reactions"
      },
      "updated_at" : "2022-12-01T15:15:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333921682",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/72414353?v=4",
         "events_url" : "https://api.github.com/users/virtu/events{/privacy}",
         "followers_url" : "https://api.github.com/users/virtu/followers",
         "following_url" : "https://api.github.com/users/virtu/following{/other_user}",
         "gists_url" : "https://api.github.com/users/virtu/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/virtu",
         "id" : 72414353,
         "login" : "virtu",
         "node_id" : "MDQ6VXNlcjcyNDE0MzUz",
         "organizations_url" : "https://api.github.com/users/virtu/orgs",
         "received_events_url" : "https://api.github.com/users/virtu/received_events",
         "repos_url" : "https://api.github.com/users/virtu/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/virtu/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/virtu/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/virtu"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1039635761"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1039635761"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Played around with this a bit. Super cool!\r\n\r\nnit: I think these could be a bit more human readable instead of just printing the raw values. Examples:\r\n- added 0356df4450c76d2474eab13fab15bfab843e31617edf9ce88d5d5bea5b19bf3e with 27.14 sat/vbyte (4968 sat in fees at 183 vbyte)\r\n- replaced 0356df4450c76d2474eab13fab15bfab843e31617edf9ce88d5d5bea5b19bf3 (110 vbyte, 16655 sat,  151.40 sat/vbyte) with db3c91d7dfff65ea5b85ca58bc3e9a26556eb6506ccb04a573f920d297060218 (110 vbyte, 23343 sat, 212.20 sat/vbyte)\r\n- rejected 1cd12698577446904e8654372421e1ab5b82bdb8faee3f11f34ed758c17ae85a from peer 2568 (158.69.116.169:8333): bad-txns-inputs-missingorspent  ",
      "commit_id" : "3b6d3f0294bca3985458eb97c89c8e07704957e6",
      "created_at" : "2022-12-05T13:57:19Z",
      "diff_hunk" : "@@ -286,3 +286,49 @@ Spent   a05880b8c77971ed0b9f73062c7c4cdb0ff3856ab14cbf8bc481ed571cd34b83:1\n Added   eb689865f7d957938978d6207918748f74e6aa074f47874724327089445b0960:0            5589696005 2094513 No\n Added   eb689865f7d957938978d6207918748f74e6aa074f47874724327089445b0960:1               1565556 2094513 No\n ```\n+\n+### mempool_monitor.py\n+\n+A BCC Python script producing mempool statistics and an event log. Based on the\n+`mempool:added`, `mempool:removed`, `mempool:replaced`, and `mempool:rejected`\n+tracepoints.\n+\n+Statistics include incidence and rate for each event type since the script was\n+started (`total`) as well as during the last minute (`1 min`) and ten minutes\n+(`10 min`). The event log shows mempool events in real time, each entry\n+comprising a timestamp along with all event data available via the event's\n+tracepoint.\n+\n+```console\n+$ python3 contrib/tracing/log_utxocache_flush.py ./src/bitcoind\n+```\n+\n+```\n+ Mempool Monitor\n+ Press CTRL-C to stop.\n+\n+ ââEvent countââââââââââââââââââââââââ  ââEvent rateâââââââââââââââââââââââââââ\n+ â Event       total   1 min  10 min â  â Event       total    1 min   10 min â\n+ â added      4130tx   218tx  2211tx â  â added     3.9tx/s  3.6tx/s  3.7tx/s â\n+ â removed     201tx     5tx    90tx â  â removed   0.2tx/s  0.1tx/s  0.1tx/s â\n+ â replaced    201tx     5tx    90tx â  â replaced  0.2tx/s  0.1tx/s  0.1tx/s â\n+ â rejected     31tx     5tx    23tx â  â rejected  0.0tx/s  0.1tx/s  0.0tx/s â\n+ âââââââââââââââââââââââââââââââââââââ  âââââââââââââââââââââââââââââââââââââââ\n+\n+ ââEvent logââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââââ\n+ â 17:09:56Z event=added, txid=0a2f2ef84d77a13162f26bb7a544efbab7f09d0b8a965b6f00e85bbd64cd8152, vsize=183, fee=4968   â\n+ â 17:09:56Z event=removed, txid=0356df4450c76d2474eab13fab15bfab843e31617edf9ce88d5d5bea5b19bf3e, reason=replaced, vsiâ\n+ â ze=110, fee=16655                                                                                                   â\n+ â 17:09:56Z event=removed, txid=653db4f9af156626a7359c18f9cb095009583497ef606d7a9d2f093c63d392da, reason=replaced, vsiâ\n+ â ze=110, fee=4037                                                                                                    â\n+ â 17:09:56Z event=rejected, txid=1cd12698577446904e8654372421e1ab5b82bdb8faee3f11f34ed758c17ae85a, reason=bad-txns-inpâ\n+ â uts-missingorspent, peer_id=2568, peer_addr=158.69.116.169:8333                                                     â\n+ â 17:09:56Z event=replaced, replacement_txid=db3c91d7dfff65ea5b85ca58bc3e9a26556eb6506ccb04a573f920d297060218, replaceâ\n+ â ment_vsize=110, replacement_fee=23343, replaced_txid=0356df4450c76d2474eab13fab15bfab843e31617edf9ce88d5d5bea5b19bf3â\n+ â e, replaced_vsize=110, replaced_fee=16655                                                                           â\n+ â 17:09:56Z event=replaced, replacement_txid=9b304b9357df5e2cfcbbbead7ffa67c0efc3c599aac9093362b398478d46a587, replaceâ\n+ â ment_vsize=110, replacement_fee=4268, replaced_txid=653db4f9af156626a7359c18f9cb095009583497ef606d7a9d2f093c63d392daâ\n+ â , replaced_vsize=110, replaced_fee=4037                                                                             â",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1039635761",
      "id" : 1039635761,
      "line" : 331,
      "node_id" : "PRRC_kwDOABII584995Ux",
      "original_commit_id" : "3b6d3f0294bca3985458eb97c89c8e07704957e6",
      "original_line" : 331,
      "original_position" : 46,
      "original_start_line" : 319,
      "path" : "contrib/tracing/README.md",
      "position" : 46,
      "pull_request_review_id" : 1204598091,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1039635761/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 319,
      "start_side" : "RIGHT",
      "updated_at" : "2022-12-05T13:57:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1039635761",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1045624376"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1045624376"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "probably makes sense to also pass the time the transaction was initially added to the mempool here. `CTxMempoolEntry` has a `GetTime()` method.",
      "commit_id" : "3b6d3f0294bca3985458eb97c89c8e07704957e6",
      "created_at" : "2022-12-12T10:05:22Z",
      "diff_hunk" : "@@ -211,6 +211,58 @@ Arguments passed:\n 4. The expected transaction fee as an `int64`\n 5. The position of the change output as an `int32`\n \n+### Context `mempool`\n+\n+#### Tracepoint `mempool:added`\n+\n+Is called when a transaction is added to the node's mempool. Passes information\n+about the transaction.\n+\n+Arguments passed:\n+1. Transaction ID (hash) as `pointer to unsigned chars` (i.e. 32 bytes in little-endian)\n+2. Transaction virtual size as `uint64`\n+3. Transaction fee as `int64`\n+\n+#### Tracepoint `mempool:removed`\n+\n+Is called when a transaction is removed from the node's mempool. Passes information\n+about the transaction.\n+\n+Arguments passed:\n+1. Transaction ID (hash) as `pointer to unsigned chars` (i.e. 32 bytes in little-endian)\n+2. Removal reason as `pointer to C-style String` (max. length 9 characters)\n+3. Transaction virtual size as `uint64`\n+4. Transaction fee as `int64`\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1045624376",
      "id" : 1045624376,
      "line" : 236,
      "node_id" : "PRRC_kwDOABII584-UvY4",
      "original_commit_id" : "3b6d3f0294bca3985458eb97c89c8e07704957e6",
      "original_line" : 236,
      "original_position" : 26,
      "original_start_line" : 231,
      "path" : "doc/tracing.md",
      "position" : 26,
      "pull_request_review_id" : 1213227632,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1045624376/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 231,
      "start_side" : "RIGHT",
      "updated_at" : "2022-12-12T10:05:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1045624376",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1045624415"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1045624415"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "probably makes sense to also pass the time the **`replaced`** transaction was initially added to the mempool here. `CTxMempoolEntry` has a `GetTime()` method. See also https://github.com/0xB10C/mempool-observer-fullrbf-ui/issues/1#issue-1488592350",
      "commit_id" : "3b6d3f0294bca3985458eb97c89c8e07704957e6",
      "created_at" : "2022-12-12T10:05:24Z",
      "diff_hunk" : "@@ -211,6 +211,58 @@ Arguments passed:\n 4. The expected transaction fee as an `int64`\n 5. The position of the change output as an `int32`\n \n+### Context `mempool`\n+\n+#### Tracepoint `mempool:added`\n+\n+Is called when a transaction is added to the node's mempool. Passes information\n+about the transaction.\n+\n+Arguments passed:\n+1. Transaction ID (hash) as `pointer to unsigned chars` (i.e. 32 bytes in little-endian)\n+2. Transaction virtual size as `uint64`\n+3. Transaction fee as `int64`\n+\n+#### Tracepoint `mempool:removed`\n+\n+Is called when a transaction is removed from the node's mempool. Passes information\n+about the transaction.\n+\n+Arguments passed:\n+1. Transaction ID (hash) as `pointer to unsigned chars` (i.e. 32 bytes in little-endian)\n+2. Removal reason as `pointer to C-style String` (max. length 9 characters)\n+3. Transaction virtual size as `uint64`\n+4. Transaction fee as `int64`\n+\n+#### Tracepoint `mempool:replaced`\n+\n+Is called when a transaction in the node's mempool is getting replaced by another.\n+Passed information about the replaced and replacement transactions.\n+\n+Arguments passed:\n+1. Replacement transaction ID (hash) as `pointer to unsigned chars` (i.e. 32 bytes in little-endian)\n+2. Replacement transaction virtual size as `uint64`\n+3. Replacement transaction fee as `int64`\n+4. Replaced transaction ID (hash) as `pointer to unsigned chars` (i.e. 32 bytes in little-endian)\n+5. Replaced transaction virtual size as `uint64`\n+6. Replaced transaction fee as `int64`",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1045624415",
      "id" : 1045624415,
      "line" : 248,
      "node_id" : "PRRC_kwDOABII584-UvZf",
      "original_commit_id" : "3b6d3f0294bca3985458eb97c89c8e07704957e6",
      "original_line" : 248,
      "original_position" : 38,
      "original_start_line" : null,
      "path" : "doc/tracing.md",
      "position" : 38,
      "pull_request_review_id" : 1213227632,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1045624415/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-12-12T10:05:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1045624415",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "- addressed feedback on [argument order of mempool:replaced](https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1036914820) with [2335347](https://github.com/bitcoin/bitcoin/pull/26531/commits/2335347474e87c707008e6ac8b6632a0af751aea): replaced transaction details now passed before replacement transaction details\r\n- addressed feedback on [adding replaced transaction's entry time](https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1045624415) with [bfe4fe4](https://github.com/bitcoin/bitcoin/pull/26531/commits/bfe4fe444345e7d3215d93754de8d1b86e9753cc): added replaced transaction's entry time to `mempool:replaced` tracepoint\r\n- addressed feedback on [making demo script output more human readable](https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1039635761) with [869a749](https://github.com/bitcoin/bitcoin/pull/26531/commits/869a7492df02e85383f55b9bac96a24dadf6d72f): added replaced transaction's entry time to `mempool:replaced` tracepoint\r\n- feedback on [adding serialized tx to tracepoints once they're semaphore-gated](https://github.com/bitcoin/bitcoin/pull/26531#issuecomment-1333832906): Strongly in favor of this, @0xB10C! If  #26593 is merged before this PR, I will make the necessary changes.",
      "created_at" : "2022-12-12T13:28:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#issuecomment-1346500049",
      "id" : 1346500049,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26531",
      "node_id" : "IC_kwDOABII585QQfXR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1346500049/reactions"
      },
      "updated_at" : "2022-12-12T13:28:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1346500049",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/72414353?v=4",
         "events_url" : "https://api.github.com/users/virtu/events{/privacy}",
         "followers_url" : "https://api.github.com/users/virtu/followers",
         "following_url" : "https://api.github.com/users/virtu/following{/other_user}",
         "gists_url" : "https://api.github.com/users/virtu/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/virtu",
         "id" : 72414353,
         "login" : "virtu",
         "node_id" : "MDQ6VXNlcjcyNDE0MzUz",
         "organizations_url" : "https://api.github.com/users/virtu/orgs",
         "received_events_url" : "https://api.github.com/users/virtu/received_events",
         "repos_url" : "https://api.github.com/users/virtu/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/virtu/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/virtu/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/virtu"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1046069472"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046069472"
         }
      },
      "author_association" : "MEMBER",
      "body" : "No huge objection, but what is the reasoning behind only tracing rejected transactions received over p2p, excluding RPC/wallet? If the reason is so we get the peerid, same comment as https://github.com/bitcoin/bitcoin/pull/26531/files#r1029861158 - this can be done by correlating mempool events with p2p inbound messages?",
      "commit_id" : "9d1879c22bea0497e30a69cb1c9ae33880697f82",
      "created_at" : "2022-12-12T16:36:22Z",
      "diff_hunk" : "@@ -4161,6 +4161,12 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             LogPrint(BCLog::MEMPOOLREJ, \"%s from peer=%d was not accepted: %s\\n\", tx.GetHash().ToString(),\n                 pfrom.GetId(),\n                 state.ToString());\n+            TRACE4(mempool, rejected,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1046069472",
      "id" : 1046069472,
      "line" : 4164,
      "node_id" : "PRRC_kwDOABII584-WcDg",
      "original_commit_id" : "869a7492df02e85383f55b9bac96a24dadf6d72f",
      "original_line" : 4164,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 4,
      "pull_request_review_id" : 1213917876,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046069472/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-12-12T17:45:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046069472",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1046100523"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046100523"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Question: is there a purpose for setting `acceptnonstdtxn=1`? Deleting this and having `rejected_test` send a `create_self_transfer(fee_rate=0)` seems to be an equivalent test to me. It would be preferable to test the default mempool behavior if possible, unless I'm missing something?",
      "commit_id" : "9d1879c22bea0497e30a69cb1c9ae33880697f82",
      "created_at" : "2022-12-12T16:57:47Z",
      "diff_hunk" : "@@ -0,0 +1,360 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"  Tests the mempool:* tracepoint API interface.\n+     See https://github.com/bitcoin/bitcoin/blob/master/doc/tracing.md#context-mempool\n+\"\"\"\n+\n+from decimal import Decimal\n+\n+# Test will be skipped if we don't have bcc installed\n+try:\n+    from bcc import BPF, USDT # type: ignore[import]\n+except ImportError:\n+    pass\n+\n+from test_framework.blocktools import COINBASE_MATURITY, MAX_BLOCK_SIGOPS\n+from test_framework.messages import COIN, DEFAULT_MEMPOOL_EXPIRY_HOURS\n+from test_framework.p2p import P2PDataStore\n+from test_framework.script import OP_CHECKSIG, CScript\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+\n+MEMPOOL_TRACEPOINTS_PROGRAM = \"\"\"\n+# include <uapi/linux/ptrace.h>\n+\n+// The longest address type is tor v3 at 62 chars + 6 chars for the port (':12345').\n+#define MAX_PEER_ADDR_LENGTH            (62+6)\n+// The longest rejection reason is 118 chars and is generated in case of SCRIPT_ERR_EVAL_FALSE by\n+// strprintf(\"mandatory-script-verify-flag-failed (%s)\", ScriptErrorString(check.GetScriptError()))\n+#define MAX_REJECT_REASON_LENGTH        118\n+// The longest string returned by RemovalReasonToString() is 'sizelimit'\n+#define MAX_REMOVAL_REASON_LENGTH       9\n+#define HASH_LENGTH                     32\n+\n+struct added_event\n+{\n+  u8    hash[HASH_LENGTH];\n+  u64   vsize;\n+  s64   fee;\n+};\n+\n+struct removed_event\n+{\n+  u8    hash[HASH_LENGTH];\n+  char  reason[MAX_REMOVAL_REASON_LENGTH];\n+  u64   vsize;\n+  s64   fee;\n+};\n+\n+struct rejected_event\n+{\n+  u8    hash[HASH_LENGTH];\n+  char  reason[MAX_REJECT_REASON_LENGTH];\n+  s64   peer_id;\n+  char  peer_addr[MAX_PEER_ADDR_LENGTH];\n+};\n+\n+struct replaced_event\n+{\n+  u8    replaced_hash[HASH_LENGTH];\n+  u64   replaced_vsize;\n+  s64   replaced_fee;\n+  u64   replaced_entry_time;\n+  u8    replacement_hash[HASH_LENGTH];\n+  u64   replacement_vsize;\n+  s64   replacement_fee;\n+};\n+\n+// BPF perf buffer to push the data to user space.\n+BPF_PERF_OUTPUT(added_events);\n+BPF_PERF_OUTPUT(removed_events);\n+BPF_PERF_OUTPUT(rejected_events);\n+BPF_PERF_OUTPUT(replaced_events);\n+\n+int trace_added(struct pt_regs *ctx) {\n+  struct added_event added = {};\n+\n+  bpf_usdt_readarg_p(1, ctx, &added.hash, HASH_LENGTH);\n+  bpf_usdt_readarg(2, ctx, &added.vsize);\n+  bpf_usdt_readarg(3, ctx, &added.fee);\n+\n+  added_events.perf_submit(ctx, &added, sizeof(added));\n+  return 0;\n+}\n+\n+int trace_removed(struct pt_regs *ctx) {\n+  struct removed_event removed = {};\n+\n+  bpf_usdt_readarg_p(1, ctx, &removed.hash, HASH_LENGTH);\n+  bpf_usdt_readarg_p(2, ctx, &removed.reason, MAX_REMOVAL_REASON_LENGTH);\n+  bpf_usdt_readarg(3, ctx, &removed.vsize);\n+  bpf_usdt_readarg(4, ctx, &removed.fee);\n+\n+  removed_events.perf_submit(ctx, &removed, sizeof(removed));\n+  return 0;\n+}\n+\n+int trace_rejected(struct pt_regs *ctx) {\n+  struct rejected_event rejected = {};\n+\n+  bpf_usdt_readarg_p(1, ctx, &rejected.hash, HASH_LENGTH);\n+  bpf_usdt_readarg_p(2, ctx, &rejected.reason, MAX_REJECT_REASON_LENGTH);\n+  bpf_usdt_readarg(3, ctx, &rejected.peer_id);\n+  bpf_usdt_readarg_p(4, ctx, &rejected.peer_addr, MAX_PEER_ADDR_LENGTH);\n+\n+  rejected_events.perf_submit(ctx, &rejected, sizeof(rejected));\n+  return 0;\n+}\n+\n+int trace_replaced(struct pt_regs *ctx) {\n+  struct replaced_event replaced = {};\n+\n+  bpf_usdt_readarg_p(1, ctx, &replaced.replaced_hash, HASH_LENGTH);\n+  bpf_usdt_readarg(2, ctx, &replaced.replaced_vsize);\n+  bpf_usdt_readarg(3, ctx, &replaced.replaced_fee);\n+  bpf_usdt_readarg(4, ctx, &replaced.replaced_entry_time);\n+  bpf_usdt_readarg_p(5, ctx, &replaced.replacement_hash, HASH_LENGTH);\n+  bpf_usdt_readarg(6, ctx, &replaced.replacement_vsize);\n+  bpf_usdt_readarg(7, ctx, &replaced.replacement_fee);\n+\n+  replaced_events.perf_submit(ctx, &replaced, sizeof(replaced));\n+  return 0;\n+}\n+\"\"\"\n+\n+\n+class MempoolTracepointTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+        self.extra_args = [\n+            [\n+                \"-acceptnonstdtxn=1\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1046100523",
      "id" : 1046100523,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584-Wjor",
      "original_commit_id" : "869a7492df02e85383f55b9bac96a24dadf6d72f",
      "original_line" : 135,
      "original_position" : 135,
      "original_start_line" : null,
      "path" : "test/functional/interface_usdt_mempool.py",
      "position" : null,
      "pull_request_review_id" : 1213917876,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046100523/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-12-12T17:45:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1046100523",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1047100870"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1047100870"
         }
      },
      "author_association" : "NONE",
      "body" : "I guess I was too occupied with trying to understand the functional test framework to figure out this solution. \r\n[d890e9a](https://github.com/bitcoin/bitcoin/pull/26531/commits/d890e9ae605de4f8317cd2bdc475a8793dfe6aae) removes `acceptnonstdtxn=1`.",
      "commit_id" : "9d1879c22bea0497e30a69cb1c9ae33880697f82",
      "created_at" : "2022-12-13T12:36:30Z",
      "diff_hunk" : "@@ -0,0 +1,360 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"  Tests the mempool:* tracepoint API interface.\n+     See https://github.com/bitcoin/bitcoin/blob/master/doc/tracing.md#context-mempool\n+\"\"\"\n+\n+from decimal import Decimal\n+\n+# Test will be skipped if we don't have bcc installed\n+try:\n+    from bcc import BPF, USDT # type: ignore[import]\n+except ImportError:\n+    pass\n+\n+from test_framework.blocktools import COINBASE_MATURITY, MAX_BLOCK_SIGOPS\n+from test_framework.messages import COIN, DEFAULT_MEMPOOL_EXPIRY_HOURS\n+from test_framework.p2p import P2PDataStore\n+from test_framework.script import OP_CHECKSIG, CScript\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+\n+MEMPOOL_TRACEPOINTS_PROGRAM = \"\"\"\n+# include <uapi/linux/ptrace.h>\n+\n+// The longest address type is tor v3 at 62 chars + 6 chars for the port (':12345').\n+#define MAX_PEER_ADDR_LENGTH            (62+6)\n+// The longest rejection reason is 118 chars and is generated in case of SCRIPT_ERR_EVAL_FALSE by\n+// strprintf(\"mandatory-script-verify-flag-failed (%s)\", ScriptErrorString(check.GetScriptError()))\n+#define MAX_REJECT_REASON_LENGTH        118\n+// The longest string returned by RemovalReasonToString() is 'sizelimit'\n+#define MAX_REMOVAL_REASON_LENGTH       9\n+#define HASH_LENGTH                     32\n+\n+struct added_event\n+{\n+  u8    hash[HASH_LENGTH];\n+  u64   vsize;\n+  s64   fee;\n+};\n+\n+struct removed_event\n+{\n+  u8    hash[HASH_LENGTH];\n+  char  reason[MAX_REMOVAL_REASON_LENGTH];\n+  u64   vsize;\n+  s64   fee;\n+};\n+\n+struct rejected_event\n+{\n+  u8    hash[HASH_LENGTH];\n+  char  reason[MAX_REJECT_REASON_LENGTH];\n+  s64   peer_id;\n+  char  peer_addr[MAX_PEER_ADDR_LENGTH];\n+};\n+\n+struct replaced_event\n+{\n+  u8    replaced_hash[HASH_LENGTH];\n+  u64   replaced_vsize;\n+  s64   replaced_fee;\n+  u64   replaced_entry_time;\n+  u8    replacement_hash[HASH_LENGTH];\n+  u64   replacement_vsize;\n+  s64   replacement_fee;\n+};\n+\n+// BPF perf buffer to push the data to user space.\n+BPF_PERF_OUTPUT(added_events);\n+BPF_PERF_OUTPUT(removed_events);\n+BPF_PERF_OUTPUT(rejected_events);\n+BPF_PERF_OUTPUT(replaced_events);\n+\n+int trace_added(struct pt_regs *ctx) {\n+  struct added_event added = {};\n+\n+  bpf_usdt_readarg_p(1, ctx, &added.hash, HASH_LENGTH);\n+  bpf_usdt_readarg(2, ctx, &added.vsize);\n+  bpf_usdt_readarg(3, ctx, &added.fee);\n+\n+  added_events.perf_submit(ctx, &added, sizeof(added));\n+  return 0;\n+}\n+\n+int trace_removed(struct pt_regs *ctx) {\n+  struct removed_event removed = {};\n+\n+  bpf_usdt_readarg_p(1, ctx, &removed.hash, HASH_LENGTH);\n+  bpf_usdt_readarg_p(2, ctx, &removed.reason, MAX_REMOVAL_REASON_LENGTH);\n+  bpf_usdt_readarg(3, ctx, &removed.vsize);\n+  bpf_usdt_readarg(4, ctx, &removed.fee);\n+\n+  removed_events.perf_submit(ctx, &removed, sizeof(removed));\n+  return 0;\n+}\n+\n+int trace_rejected(struct pt_regs *ctx) {\n+  struct rejected_event rejected = {};\n+\n+  bpf_usdt_readarg_p(1, ctx, &rejected.hash, HASH_LENGTH);\n+  bpf_usdt_readarg_p(2, ctx, &rejected.reason, MAX_REJECT_REASON_LENGTH);\n+  bpf_usdt_readarg(3, ctx, &rejected.peer_id);\n+  bpf_usdt_readarg_p(4, ctx, &rejected.peer_addr, MAX_PEER_ADDR_LENGTH);\n+\n+  rejected_events.perf_submit(ctx, &rejected, sizeof(rejected));\n+  return 0;\n+}\n+\n+int trace_replaced(struct pt_regs *ctx) {\n+  struct replaced_event replaced = {};\n+\n+  bpf_usdt_readarg_p(1, ctx, &replaced.replaced_hash, HASH_LENGTH);\n+  bpf_usdt_readarg(2, ctx, &replaced.replaced_vsize);\n+  bpf_usdt_readarg(3, ctx, &replaced.replaced_fee);\n+  bpf_usdt_readarg(4, ctx, &replaced.replaced_entry_time);\n+  bpf_usdt_readarg_p(5, ctx, &replaced.replacement_hash, HASH_LENGTH);\n+  bpf_usdt_readarg(6, ctx, &replaced.replacement_vsize);\n+  bpf_usdt_readarg(7, ctx, &replaced.replacement_fee);\n+\n+  replaced_events.perf_submit(ctx, &replaced, sizeof(replaced));\n+  return 0;\n+}\n+\"\"\"\n+\n+\n+class MempoolTracepointTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+        self.extra_args = [\n+            [\n+                \"-acceptnonstdtxn=1\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1047100870",
      "id" : 1047100870,
      "in_reply_to_id" : 1046100523,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584-aX3G",
      "original_commit_id" : "869a7492df02e85383f55b9bac96a24dadf6d72f",
      "original_line" : 135,
      "original_position" : 135,
      "original_start_line" : null,
      "path" : "test/functional/interface_usdt_mempool.py",
      "position" : null,
      "pull_request_review_id" : 1215384963,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1047100870/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-12-13T12:36:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1047100870",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/72414353?v=4",
         "events_url" : "https://api.github.com/users/virtu/events{/privacy}",
         "followers_url" : "https://api.github.com/users/virtu/followers",
         "following_url" : "https://api.github.com/users/virtu/following{/other_user}",
         "gists_url" : "https://api.github.com/users/virtu/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/virtu",
         "id" : 72414353,
         "login" : "virtu",
         "node_id" : "MDQ6VXNlcjcyNDE0MzUz",
         "organizations_url" : "https://api.github.com/users/virtu/orgs",
         "received_events_url" : "https://api.github.com/users/virtu/received_events",
         "repos_url" : "https://api.github.com/users/virtu/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/virtu/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/virtu/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/virtu"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1047108198"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1047108198"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "(I think this is a leftover from when you used ToManySigOps to create an invalid transaction in an earlier version of this PR)",
      "commit_id" : "9d1879c22bea0497e30a69cb1c9ae33880697f82",
      "created_at" : "2022-12-13T12:43:14Z",
      "diff_hunk" : "@@ -0,0 +1,360 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"  Tests the mempool:* tracepoint API interface.\n+     See https://github.com/bitcoin/bitcoin/blob/master/doc/tracing.md#context-mempool\n+\"\"\"\n+\n+from decimal import Decimal\n+\n+# Test will be skipped if we don't have bcc installed\n+try:\n+    from bcc import BPF, USDT # type: ignore[import]\n+except ImportError:\n+    pass\n+\n+from test_framework.blocktools import COINBASE_MATURITY, MAX_BLOCK_SIGOPS\n+from test_framework.messages import COIN, DEFAULT_MEMPOOL_EXPIRY_HOURS\n+from test_framework.p2p import P2PDataStore\n+from test_framework.script import OP_CHECKSIG, CScript\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+\n+MEMPOOL_TRACEPOINTS_PROGRAM = \"\"\"\n+# include <uapi/linux/ptrace.h>\n+\n+// The longest address type is tor v3 at 62 chars + 6 chars for the port (':12345').\n+#define MAX_PEER_ADDR_LENGTH            (62+6)\n+// The longest rejection reason is 118 chars and is generated in case of SCRIPT_ERR_EVAL_FALSE by\n+// strprintf(\"mandatory-script-verify-flag-failed (%s)\", ScriptErrorString(check.GetScriptError()))\n+#define MAX_REJECT_REASON_LENGTH        118\n+// The longest string returned by RemovalReasonToString() is 'sizelimit'\n+#define MAX_REMOVAL_REASON_LENGTH       9\n+#define HASH_LENGTH                     32\n+\n+struct added_event\n+{\n+  u8    hash[HASH_LENGTH];\n+  u64   vsize;\n+  s64   fee;\n+};\n+\n+struct removed_event\n+{\n+  u8    hash[HASH_LENGTH];\n+  char  reason[MAX_REMOVAL_REASON_LENGTH];\n+  u64   vsize;\n+  s64   fee;\n+};\n+\n+struct rejected_event\n+{\n+  u8    hash[HASH_LENGTH];\n+  char  reason[MAX_REJECT_REASON_LENGTH];\n+  s64   peer_id;\n+  char  peer_addr[MAX_PEER_ADDR_LENGTH];\n+};\n+\n+struct replaced_event\n+{\n+  u8    replaced_hash[HASH_LENGTH];\n+  u64   replaced_vsize;\n+  s64   replaced_fee;\n+  u64   replaced_entry_time;\n+  u8    replacement_hash[HASH_LENGTH];\n+  u64   replacement_vsize;\n+  s64   replacement_fee;\n+};\n+\n+// BPF perf buffer to push the data to user space.\n+BPF_PERF_OUTPUT(added_events);\n+BPF_PERF_OUTPUT(removed_events);\n+BPF_PERF_OUTPUT(rejected_events);\n+BPF_PERF_OUTPUT(replaced_events);\n+\n+int trace_added(struct pt_regs *ctx) {\n+  struct added_event added = {};\n+\n+  bpf_usdt_readarg_p(1, ctx, &added.hash, HASH_LENGTH);\n+  bpf_usdt_readarg(2, ctx, &added.vsize);\n+  bpf_usdt_readarg(3, ctx, &added.fee);\n+\n+  added_events.perf_submit(ctx, &added, sizeof(added));\n+  return 0;\n+}\n+\n+int trace_removed(struct pt_regs *ctx) {\n+  struct removed_event removed = {};\n+\n+  bpf_usdt_readarg_p(1, ctx, &removed.hash, HASH_LENGTH);\n+  bpf_usdt_readarg_p(2, ctx, &removed.reason, MAX_REMOVAL_REASON_LENGTH);\n+  bpf_usdt_readarg(3, ctx, &removed.vsize);\n+  bpf_usdt_readarg(4, ctx, &removed.fee);\n+\n+  removed_events.perf_submit(ctx, &removed, sizeof(removed));\n+  return 0;\n+}\n+\n+int trace_rejected(struct pt_regs *ctx) {\n+  struct rejected_event rejected = {};\n+\n+  bpf_usdt_readarg_p(1, ctx, &rejected.hash, HASH_LENGTH);\n+  bpf_usdt_readarg_p(2, ctx, &rejected.reason, MAX_REJECT_REASON_LENGTH);\n+  bpf_usdt_readarg(3, ctx, &rejected.peer_id);\n+  bpf_usdt_readarg_p(4, ctx, &rejected.peer_addr, MAX_PEER_ADDR_LENGTH);\n+\n+  rejected_events.perf_submit(ctx, &rejected, sizeof(rejected));\n+  return 0;\n+}\n+\n+int trace_replaced(struct pt_regs *ctx) {\n+  struct replaced_event replaced = {};\n+\n+  bpf_usdt_readarg_p(1, ctx, &replaced.replaced_hash, HASH_LENGTH);\n+  bpf_usdt_readarg(2, ctx, &replaced.replaced_vsize);\n+  bpf_usdt_readarg(3, ctx, &replaced.replaced_fee);\n+  bpf_usdt_readarg(4, ctx, &replaced.replaced_entry_time);\n+  bpf_usdt_readarg_p(5, ctx, &replaced.replacement_hash, HASH_LENGTH);\n+  bpf_usdt_readarg(6, ctx, &replaced.replacement_vsize);\n+  bpf_usdt_readarg(7, ctx, &replaced.replacement_fee);\n+\n+  replaced_events.perf_submit(ctx, &replaced, sizeof(replaced));\n+  return 0;\n+}\n+\"\"\"\n+\n+\n+class MempoolTracepointTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+        self.extra_args = [\n+            [\n+                \"-acceptnonstdtxn=1\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1047108198",
      "id" : 1047108198,
      "in_reply_to_id" : 1046100523,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584-aZpm",
      "original_commit_id" : "869a7492df02e85383f55b9bac96a24dadf6d72f",
      "original_line" : 135,
      "original_position" : 135,
      "original_start_line" : null,
      "path" : "test/functional/interface_usdt_mempool.py",
      "position" : null,
      "pull_request_review_id" : 1215395370,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1047108198/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-12-13T12:43:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1047108198",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1047117123"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1047117123"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I initially suggested to @virtu to include the peer_id (and thus place it in net_processing.cpp). But based on the 'mempool' scope of this PR might be better to place this tracepoint somewhere transaction source (p2p/wallet/rpc,..) agnostic. ",
      "commit_id" : "9d1879c22bea0497e30a69cb1c9ae33880697f82",
      "created_at" : "2022-12-13T12:52:05Z",
      "diff_hunk" : "@@ -4161,6 +4161,12 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             LogPrint(BCLog::MEMPOOLREJ, \"%s from peer=%d was not accepted: %s\\n\", tx.GetHash().ToString(),\n                 pfrom.GetId(),\n                 state.ToString());\n+            TRACE4(mempool, rejected,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26531#discussion_r1047117123",
      "id" : 1047117123,
      "in_reply_to_id" : 1046069472,
      "line" : 4164,
      "node_id" : "PRRC_kwDOABII584-ab1D",
      "original_commit_id" : "869a7492df02e85383f55b9bac96a24dadf6d72f",
      "original_line" : 4164,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 4,
      "pull_request_review_id" : 1215409047,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26531",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1047117123/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-12-13T12:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1047117123",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   }
]
