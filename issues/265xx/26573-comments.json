[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [achow101](https://github.com/bitcoin/bitcoin/pull/26573#issuecomment-1416543625) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#28212](https://github.com/bitcoin/bitcoin/pull/28212) (test: verify spend from 999-of-999 taproot multisig wallet by eriknylund)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2022-11-25T12:22:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26573#issuecomment-1327408486",
      "id" : 1327408486,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26573",
      "node_id" : "IC_kwDOABII585PHqVm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1327408486/reactions"
      },
      "updated_at" : "2023-09-06T22:08:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1327408486",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">Alternative to https://github.com/bitcoin/bitcoin/pull/23502.\r\n\r\nNot really an alternative, since https://github.com/bitcoin/bitcoin/pull/26567 shouldn't be eligible for backporting, but this is arguably a fix.\r\n\r\nIMO #23502 should still get reviewed & merged first, then let #26567 include this in its refactor.",
      "created_at" : "2022-11-27T00:13:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26573#issuecomment-1328137981",
      "id" : 1328137981,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26573",
      "node_id" : "IC_kwDOABII585PKcb9",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1328137981/reactions"
      },
      "updated_at" : "2022-11-27T00:13:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1328137981",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2022-12-05T18:09:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26573#issuecomment-1337878485",
      "id" : 1337878485,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26573",
      "node_id" : "IC_kwDOABII585PvmfV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1337878485/reactions"
      },
      "updated_at" : "2022-12-05T18:09:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1337878485",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2023-02-04T00:02:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26573#issuecomment-1416543625",
      "id" : 1416543625,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26573",
      "node_id" : "IC_kwDOABII585Ubr2J",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1416543625/reactions"
      },
      "updated_at" : "2023-02-04T00:02:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1416543625",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased.",
      "created_at" : "2023-02-05T18:18:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26573#issuecomment-1418206188",
      "id" : 1418206188,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26573",
      "node_id" : "IC_kwDOABII585UiBvs",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1418206188/reactions"
      },
      "updated_at" : "2023-02-05T18:18:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1418206188",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-02-16T11:09:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26573#issuecomment-1432920202",
      "id" : 1432920202,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26573",
      "node_id" : "IC_kwDOABII585VaKCK",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1432920202/reactions"
      },
      "updated_at" : "2023-02-16T11:09:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1432920202",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Moving this to draft for now, given it's based on #26567.",
      "created_at" : "2023-02-24T15:27:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26573#issuecomment-1443850979",
      "id" : 1443850979,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26573",
      "node_id" : "IC_kwDOABII585WD2rj",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1443850979/reactions"
      },
      "updated_at" : "2023-02-24T15:27:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1443850979",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased. Still based on https://github.com/bitcoin/bitcoin/pull/26567.",
      "created_at" : "2023-07-19T13:18:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26573#issuecomment-1642068632",
      "id" : 1642068632,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26573",
      "node_id" : "IC_kwDOABII585h3_qY",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1642068632/reactions"
      },
      "updated_at" : "2023-07-19T13:18:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1642068632",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-07-27T18:20:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26573#issuecomment-1654172995",
      "id" : 1654172995,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26573",
      "node_id" : "IC_kwDOABII585imK1D",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1654172995/reactions"
      },
      "updated_at" : "2023-07-27T18:20:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1654172995",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased and undrafting now that #26567 is merged.",
      "created_at" : "2023-09-07T08:04:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26573#issuecomment-1709668169",
      "id" : 1709668169,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26573",
      "node_id" : "IC_kwDOABII585l53dJ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1709668169/reactions"
      },
      "updated_at" : "2023-09-07T08:04:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1709668169",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26573#discussion_r1346383709"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26573"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1346383709"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I assume the 1s here are the CompactSize length indicators for the witness items. It seems to me that any of the three could be more than 252 bytes, so perhaps you need to check for that and use 3 bytes for the CompactSize in case the corresponding element is longer?",
      "commit_id" : "1ec49d2c1552b3ba97482cfd2a13dc8d01c58d0e",
      "created_at" : "2023-10-04T19:49:38Z",
      "diff_hunk" : "@@ -1093,13 +1093,37 @@ class TRDescriptor final : public DescriptorImpl\n     std::optional<int64_t> ScriptSize() const override { return 1 + 1 + 32; }\n \n     std::optional<int64_t> MaxSatisfactionWeight(bool) const override {\n-        // FIXME: We assume keypath spend, which can lead to very large underestimations.\n-        return 1 + 65;\n+        // Start from the size of a keypath spend.\n+        int64_t max_weight = 1 + 65;\n+\n+        // Then go through all the existing leaves to check if there is anything more expensive.\n+        const bool dummy_max_sig = true;\n+        for (size_t i = 0; i < m_subdescriptor_args.size(); ++i) {\n+            // Anything inside a Tapscript leave must have its satisfaction and script size set.\n+            const auto sat_size = m_subdescriptor_args[i]->MaxSatSize(dummy_max_sig);\n+            const auto script_size = m_subdescriptor_args[i]->ScriptSize();\n+            const auto control_size = 33 + 32 * m_depths[i];\n+            const auto total_weight = 1 + control_size + 1 + *script_size + 1 + *sat_size;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26573#discussion_r1346383709",
      "id" : 1346383709,
      "line" : 1106,
      "node_id" : "PRRC_kwDOABII585QQC9d",
      "original_commit_id" : "1ec49d2c1552b3ba97482cfd2a13dc8d01c58d0e",
      "original_line" : 1106,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : 16,
      "pull_request_review_id" : 1658373638,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26573",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1346383709/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-04T19:54:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1346383709",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/murchandamus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/murchandamus/followers",
         "following_url" : "https://api.github.com/users/murchandamus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/murchandamus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/murchandamus",
         "id" : 4060799,
         "login" : "murchandamus",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/murchandamus/orgs",
         "received_events_url" : "https://api.github.com/users/murchandamus/received_events",
         "repos_url" : "https://api.github.com/users/murchandamus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/murchandamus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/murchandamus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/murchandamus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26573#discussion_r1346419828"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26573"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1346419828"
         }
      },
      "author_association" : "MEMBER",
      "body" : "One of those 1s should also be for the entire stack size, which could also be larger than 252.",
      "commit_id" : "1ec49d2c1552b3ba97482cfd2a13dc8d01c58d0e",
      "created_at" : "2023-10-04T20:25:29Z",
      "diff_hunk" : "@@ -1093,13 +1093,37 @@ class TRDescriptor final : public DescriptorImpl\n     std::optional<int64_t> ScriptSize() const override { return 1 + 1 + 32; }\n \n     std::optional<int64_t> MaxSatisfactionWeight(bool) const override {\n-        // FIXME: We assume keypath spend, which can lead to very large underestimations.\n-        return 1 + 65;\n+        // Start from the size of a keypath spend.\n+        int64_t max_weight = 1 + 65;\n+\n+        // Then go through all the existing leaves to check if there is anything more expensive.\n+        const bool dummy_max_sig = true;\n+        for (size_t i = 0; i < m_subdescriptor_args.size(); ++i) {\n+            // Anything inside a Tapscript leave must have its satisfaction and script size set.\n+            const auto sat_size = m_subdescriptor_args[i]->MaxSatSize(dummy_max_sig);\n+            const auto script_size = m_subdescriptor_args[i]->ScriptSize();\n+            const auto control_size = 33 + 32 * m_depths[i];\n+            const auto total_weight = 1 + control_size + 1 + *script_size + 1 + *sat_size;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26573#discussion_r1346419828",
      "id" : 1346419828,
      "in_reply_to_id" : 1346383709,
      "line" : 1106,
      "node_id" : "PRRC_kwDOABII585QQLx0",
      "original_commit_id" : "1ec49d2c1552b3ba97482cfd2a13dc8d01c58d0e",
      "original_line" : 1106,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : 16,
      "pull_request_review_id" : 1658425086,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26573",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1346419828/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-04T20:25:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1346419828",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26573#discussion_r1439716924"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26573"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439716924"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Same here.",
      "commit_id" : "52cc58ab3ad0ee9df9ccc5303c7f0ce85cf8afee",
      "created_at" : "2024-01-02T18:40:55Z",
      "diff_hunk" : "@@ -1093,13 +1093,37 @@ class TRDescriptor final : public DescriptorImpl\n     std::optional<int64_t> ScriptSize() const override { return 1 + 1 + 32; }\n \n     std::optional<int64_t> MaxSatisfactionWeight(bool) const override {\n-        // FIXME: We assume keypath spend, which can lead to very large underestimations.\n-        return 1 + 65;\n+        // Start from the size of a keypath spend.\n+        int64_t max_weight = 1 + 65;\n+\n+        // Then go through all the existing leaves to check if there is anything more expensive.\n+        const bool dummy_max_sig = true;\n+        for (size_t i = 0; i < m_subdescriptor_args.size(); ++i) {\n+            // Anything inside a Tapscript leave must have its satisfaction and script size set.\n+            const auto sat_size = m_subdescriptor_args[i]->MaxSatSize(dummy_max_sig);\n+            const auto script_size = m_subdescriptor_args[i]->ScriptSize();\n+            const auto control_size = 33 + 32 * m_depths[i];\n+            const auto total_weight = 1 + control_size + 1 + *script_size + 1 + *sat_size;\n+            if (total_weight > max_weight) max_weight = total_weight;\n+        }\n+\n+        return max_weight;\n     }\n \n     std::optional<int64_t> MaxSatisfactionElems() const override {\n-        // FIXME: See above, we assume keypath spend.\n-        return 1;\n+        // Start from the stack size of a keypath spend.\n+        int64_t max_stack_size = 1;\n+\n+        // Then go through all the existing leaves to check if there is anything more expensive.\n+        for (size_t i = 0; i < m_subdescriptor_args.size(); ++i) {\n+            // Anything inside a Tapscript leave must have its satisfaction stack size set.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26573#discussion_r1439716924",
      "id" : 1439716924,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585V0FY8",
      "original_commit_id" : "1ec49d2c1552b3ba97482cfd2a13dc8d01c58d0e",
      "original_line" : 1119,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : null,
      "pull_request_review_id" : 1800853604,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26573",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439716924/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-02T18:47:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439716924",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26573#discussion_r1439721581"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26573"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439721581"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Seems better to use `GetSizeOfCompactSize` here.",
      "commit_id" : "52cc58ab3ad0ee9df9ccc5303c7f0ce85cf8afee",
      "created_at" : "2024-01-02T18:47:37Z",
      "diff_hunk" : "@@ -1093,13 +1093,37 @@ class TRDescriptor final : public DescriptorImpl\n     std::optional<int64_t> ScriptSize() const override { return 1 + 1 + 32; }\n \n     std::optional<int64_t> MaxSatisfactionWeight(bool) const override {\n-        // FIXME: We assume keypath spend, which can lead to very large underestimations.\n-        return 1 + 65;\n+        // Start from the size of a keypath spend.\n+        int64_t max_weight = 1 + 65;\n+\n+        // Then go through all the existing leaves to check if there is anything more expensive.\n+        const bool dummy_max_sig = true;\n+        for (size_t i = 0; i < m_subdescriptor_args.size(); ++i) {\n+            // Anything inside a Tapscript leave must have its satisfaction and script size set.\n+            const auto sat_size = m_subdescriptor_args[i]->MaxSatSize(dummy_max_sig);\n+            const auto script_size = m_subdescriptor_args[i]->ScriptSize();\n+            const auto control_size = 33 + 32 * m_depths[i];\n+            const auto total_weight = 1 + control_size + 1 + *script_size + 1 + *sat_size;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26573#discussion_r1439721581",
      "id" : 1439721581,
      "in_reply_to_id" : 1346383709,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585V0Ght",
      "original_commit_id" : "1ec49d2c1552b3ba97482cfd2a13dc8d01c58d0e",
      "original_line" : 1106,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : null,
      "pull_request_review_id" : 1800853604,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26573",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439721581/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-02T18:47:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439721581",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26573#discussion_r1439722015"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26573"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439722015"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nit: leave -> leaf",
      "commit_id" : "52cc58ab3ad0ee9df9ccc5303c7f0ce85cf8afee",
      "created_at" : "2024-01-02T18:48:15Z",
      "diff_hunk" : "@@ -1093,13 +1093,37 @@ class TRDescriptor final : public DescriptorImpl\n     std::optional<int64_t> ScriptSize() const override { return 1 + 1 + 32; }\n \n     std::optional<int64_t> MaxSatisfactionWeight(bool) const override {\n-        // FIXME: We assume keypath spend, which can lead to very large underestimations.\n-        return 1 + 65;\n+        // Start from the size of a keypath spend.\n+        int64_t max_weight = 1 + 65;\n+\n+        // Then go through all the existing leaves to check if there is anything more expensive.\n+        const bool dummy_max_sig = true;\n+        for (size_t i = 0; i < m_subdescriptor_args.size(); ++i) {\n+            // Anything inside a Tapscript leave must have its satisfaction and script size set.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26573#discussion_r1439722015",
      "id" : 1439722015,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585V0Gof",
      "original_commit_id" : "1ec49d2c1552b3ba97482cfd2a13dc8d01c58d0e",
      "original_line" : 1102,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : null,
      "pull_request_review_id" : 1800861421,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26573",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439722015/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-02T18:48:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1439722015",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26573#discussion_r1440150443"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26573"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440150443"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "52cc58ab3ad0ee9df9ccc5303c7f0ce85cf8afee",
      "created_at" : "2024-01-03T07:40:07Z",
      "diff_hunk" : "@@ -1093,13 +1093,37 @@ class TRDescriptor final : public DescriptorImpl\n     std::optional<int64_t> ScriptSize() const override { return 1 + 1 + 32; }\n \n     std::optional<int64_t> MaxSatisfactionWeight(bool) const override {\n-        // FIXME: We assume keypath spend, which can lead to very large underestimations.\n-        return 1 + 65;\n+        // Start from the size of a keypath spend.\n+        int64_t max_weight = 1 + 65;\n+\n+        // Then go through all the existing leaves to check if there is anything more expensive.\n+        const bool dummy_max_sig = true;\n+        for (size_t i = 0; i < m_subdescriptor_args.size(); ++i) {\n+            // Anything inside a Tapscript leave must have its satisfaction and script size set.\n+            const auto sat_size = m_subdescriptor_args[i]->MaxSatSize(dummy_max_sig);\n+            const auto script_size = m_subdescriptor_args[i]->ScriptSize();\n+            const auto control_size = 33 + 32 * m_depths[i];\n+            const auto total_weight = 1 + control_size + 1 + *script_size + 1 + *sat_size;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26573#discussion_r1440150443",
      "id" : 1440150443,
      "in_reply_to_id" : 1346383709,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585V1vOr",
      "original_commit_id" : "1ec49d2c1552b3ba97482cfd2a13dc8d01c58d0e",
      "original_line" : 1106,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : null,
      "pull_request_review_id" : 1801499966,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26573",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440150443/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-03T07:40:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440150443",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26573#discussion_r1440150511"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26573"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440150511"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "52cc58ab3ad0ee9df9ccc5303c7f0ce85cf8afee",
      "created_at" : "2024-01-03T07:40:16Z",
      "diff_hunk" : "@@ -1093,13 +1093,37 @@ class TRDescriptor final : public DescriptorImpl\n     std::optional<int64_t> ScriptSize() const override { return 1 + 1 + 32; }\n \n     std::optional<int64_t> MaxSatisfactionWeight(bool) const override {\n-        // FIXME: We assume keypath spend, which can lead to very large underestimations.\n-        return 1 + 65;\n+        // Start from the size of a keypath spend.\n+        int64_t max_weight = 1 + 65;\n+\n+        // Then go through all the existing leaves to check if there is anything more expensive.\n+        const bool dummy_max_sig = true;\n+        for (size_t i = 0; i < m_subdescriptor_args.size(); ++i) {\n+            // Anything inside a Tapscript leave must have its satisfaction and script size set.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26573#discussion_r1440150511",
      "id" : 1440150511,
      "in_reply_to_id" : 1439722015,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585V1vPv",
      "original_commit_id" : "1ec49d2c1552b3ba97482cfd2a13dc8d01c58d0e",
      "original_line" : 1102,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : null,
      "pull_request_review_id" : 1801500096,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26573",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440150511/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-03T07:40:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1440150511",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   }
]
