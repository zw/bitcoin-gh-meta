[
   {
      "body" : "This is an error that only appears with `-DDEBUG_LOCKORDER`, which is enabled by `--enable-debug`. Did you perhaps enable this recently?\r\n\r\nHaven't checked whether this is a real issue or not, but the try_lock deadlock detection seems to sometimes give false positives.\r\n\r\n> I've been considering doing a blockchain redownload, but I don't want to if it won't fix anything.\r\n\r\nNo, this looks like an issue in the networking code redownloading the block chain shouldn't have a single effect on this.\r\n",
      "created_at" : "2016-02-05T02:56:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7470#issuecomment-180169589",
      "id" : 180169589,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7470",
      "updated_at" : "2016-02-05T02:58:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/180169589",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Changes to main.cpp in rc3 versus rc2:\r\n```diff\r\ndiff --git a/src/main.cpp b/src/main.cpp\r\nindex d1b0fba..3591679 100644\r\n--- a/src/main.cpp\r\n+++ b/src/main.cpp\r\n@@ -75,7 +75,7 @@ bool fCheckpointsEnabled = DEFAULT_CHECKPOINTS_ENABLED;\r\n size_t nCoinCacheUsage = 5000 * 300;\r\n uint64_t nPruneTarget = 0;\r\n bool fAlerts = DEFAULT_ALERTS;\r\n-bool fPermitReplacement = DEFAULT_PERMIT_REPLACEMENT;\r\n+bool fEnableReplacement = DEFAULT_ENABLE_REPLACEMENT;\r\n \r\n /** Fees smaller than this (in satoshi) are considered zero fee (for relaying, mining and transaction creation) */\r\n CFeeRate minRelayTxFee = CFeeRate(DEFAULT_MIN_RELAY_TX_FEE);\r\n@@ -866,7 +866,7 @@ bool AcceptToMemoryPoolWorker(CTxMemPool& pool, CValidationState &state, const C\r\n                 // unconfirmed ancestors anyway; doing otherwise is hopelessly\r\n                 // insecure.\r\n                 bool fReplacementOptOut = true;\r\n-                if (fPermitReplacement)\r\n+                if (fEnableReplacement)\r\n                 {\r\n                     BOOST_FOREACH(const CTxIn &txin, ptxConflicting->vin)\r\n                     {\r\n@@ -4497,8 +4497,8 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv,\r\n \r\n         bool fBlocksOnly = GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY);\r\n \r\n-        // Allow whitelisted peers to send data other than blocks in blocks only mode if whitelistalwaysrelay is true\r\n-        if (pfrom->fWhitelisted && GetBoolArg(\"-whitelistalwaysrelay\", DEFAULT_WHITELISTALWAYSRELAY))\r\n+        // Allow whitelisted peers to send data other than blocks in blocks only mode if whitelistrelay is true\r\n+        if (pfrom->fWhitelisted && GetBoolArg(\"-whitelistrelay\", DEFAULT_WHITELISTRELAY))\r\n             fBlocksOnly = false;\r\n \r\n         LOCK(cs_main);\r\n@@ -4677,8 +4677,8 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv,\r\n     else if (strCommand == NetMsgType::TX)\r\n     {\r\n         // Stop processing the transaction early if\r\n-        // We are in blocks only mode and peer is either not whitelisted or whitelistalwaysrelay is off\r\n-        if (GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY) && (!pfrom->fWhitelisted || !GetBoolArg(\"-whitelistalwaysrelay\", DEFAULT_WHITELISTALWAYSRELAY)))\r\n+        // We are in blocks only mode and peer is either not whitelisted or whitelistrelay is off\r\n+        if (GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY) && (!pfrom->fWhitelisted || !GetBoolArg(\"-whitelistrelay\", DEFAULT_WHITELISTRELAY)))\r\n         {\r\n             LogPrint(\"net\", \"transaction sent in violation of protocol peer=%d\\n\", pfrom->id);\r\n             return true;\r\n@@ -4778,7 +4778,7 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv,\r\n             assert(recentRejects);\r\n             recentRejects->insert(tx.GetHash());\r\n \r\n-            if (pfrom->fWhitelisted && GetBoolArg(\"-whitelistalwaysrelay\", DEFAULT_WHITELISTALWAYSRELAY)) {\r\n+            if (pfrom->fWhitelisted && GetBoolArg(\"-whitelistforcerelay\", DEFAULT_WHITELISTFORCERELAY)) {\r\n                 // Always relay transactions received from whitelisted peers, even\r\n                 // if they were already in the mempool or rejected from it due\r\n                 // to policy, allowing the node to function as a gateway for\r\n```\r\nChanges to net.cpp in rc3 versus rc2:\r\n```diff\r\ndiff --git a/src/net.cpp b/src/net.cpp\r\nindex 8abfc4b..2f60cfa 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -884,8 +884,6 @@ static bool AttemptToEvictConnection(bool fPreferNewConnection) {\r\n                 continue;\r\n             if (node->fDisconnect)\r\n                 continue;\r\n-            if (node->addr.IsLocal())\r\n-                continue;\r\n             vEvictionCandidates.push_back(CNodeRef(node));\r\n         }\r\n     }\r\n@@ -916,15 +914,20 @@ static bool AttemptToEvictConnection(bool fPreferNewConnection) {\r\n \r\n     if (vEvictionCandidates.empty()) return false;\r\n \r\n-    // Identify the network group with the most connections\r\n+    // Identify the network group with the most connections and youngest member.\r\n+    // (vEvictionCandidates is already sorted by reverse connect time)\r\n     std::vector<unsigned char> naMostConnections;\r\n     unsigned int nMostConnections = 0;\r\n+    int64_t nMostConnectionsTime = 0;\r\n     std::map<std::vector<unsigned char>, std::vector<CNodeRef> > mapAddrCounts;\r\n     BOOST_FOREACH(const CNodeRef &node, vEvictionCandidates) {\r\n         mapAddrCounts[node->addr.GetGroup()].push_back(node);\r\n+        int64_t grouptime = mapAddrCounts[node->addr.GetGroup()][0]->nTimeConnected;\r\n+        size_t groupsize = mapAddrCounts[node->addr.GetGroup()].size();\r\n \r\n-        if (mapAddrCounts[node->addr.GetGroup()].size() > nMostConnections) {\r\n-            nMostConnections = mapAddrCounts[node->addr.GetGroup()].size();\r\n+        if (groupsize > nMostConnections || (groupsize == nMostConnections && grouptime > nMostConnectionsTime)) {\r\n+            nMostConnections = groupsize;\r\n+            nMostConnectionsTime = grouptime;\r\n             naMostConnections = node->addr.GetGroup();\r\n         }\r\n     }\r\n@@ -932,14 +935,13 @@ static bool AttemptToEvictConnection(bool fPreferNewConnection) {\r\n     // Reduce to the network group with the most connections\r\n     vEvictionCandidates = mapAddrCounts[naMostConnections];\r\n \r\n-    // Do not disconnect peers if there is only 1 connection from their network group\r\n+    // Do not disconnect peers if there is only one unprotected connection from their network group.\r\n     if (vEvictionCandidates.size() <= 1)\r\n         // unless we prefer the new connection (for whitelisted peers)\r\n         if (!fPreferNewConnection)\r\n             return false;\r\n \r\n-    // Disconnect the most recent connection from the network group with the most connections\r\n-    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), ReverseCompareNodeTimeConnected);\r\n+    // Disconnect from the network group with the most connections\r\n     vEvictionCandidates[0]->fDisconnect = true;\r\n \r\n     return true;\r\n```\r\nAs far as I see it, nothing with the locks in question changed.",
      "created_at" : "2016-02-05T03:05:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7470#issuecomment-180171366",
      "id" : 180171366,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7470",
      "updated_at" : "2016-02-05T03:05:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/180171366",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I have two aliases for configuring:\n\nalias configurestd=\"./configure --prefix='$HOME/.local'\"\nalias configuredev=\"./configure --enable-debug --program-prefix=dev --prefix='$HOME/.local'\"\n\nI ran \"configurestd\" before \"make && make install\" so I figured that'd disable \"--enable-debug\". Other than that, I don't have any debugging flags anywhere.",
      "created_at" : "2016-02-05T03:05:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7470#issuecomment-180171403",
      "id" : 180171403,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7470",
      "updated_at" : "2016-02-05T03:05:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/180171403",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16140350?v=3",
         "events_url" : "https://api.github.com/users/GIJensen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/GIJensen/followers",
         "following_url" : "https://api.github.com/users/GIJensen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/GIJensen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/GIJensen",
         "id" : 16140350,
         "login" : "GIJensen",
         "organizations_url" : "https://api.github.com/users/GIJensen/orgs",
         "received_events_url" : "https://api.github.com/users/GIJensen/received_events",
         "repos_url" : "https://api.github.com/users/GIJensen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/GIJensen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/GIJensen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/GIJensen"
      }
   },
   {
      "body" : "Is it possible the issue existed before but never came up because I never reindexed? Should I try to build older commits?",
      "created_at" : "2016-02-05T03:19:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7470#issuecomment-180173276",
      "id" : 180173276,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7470",
      "updated_at" : "2016-02-05T03:19:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/180173276",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16140350?v=3",
         "events_url" : "https://api.github.com/users/GIJensen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/GIJensen/followers",
         "following_url" : "https://api.github.com/users/GIJensen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/GIJensen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/GIJensen",
         "id" : 16140350,
         "login" : "GIJensen",
         "organizations_url" : "https://api.github.com/users/GIJensen/orgs",
         "received_events_url" : "https://api.github.com/users/GIJensen/received_events",
         "repos_url" : "https://api.github.com/users/GIJensen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/GIJensen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/GIJensen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/GIJensen"
      }
   },
   {
      "body" : "Yes, that is possible. Try cleaning your tree then rebuildilng without --enable-debug, then reindexing.\r\n",
      "created_at" : "2016-02-05T03:20:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7470#issuecomment-180173404",
      "id" : 180173404,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7470",
      "updated_at" : "2016-02-05T03:20:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/180173404",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Okay, already doing that!\r\n\r\nBTW I'm running Debian Jessie 64- bit. Just in case that ends up being relevant.",
      "created_at" : "2016-02-05T03:23:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7470#issuecomment-180173805",
      "id" : 180173805,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7470",
      "updated_at" : "2016-02-05T03:23:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/180173805",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16140350?v=3",
         "events_url" : "https://api.github.com/users/GIJensen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/GIJensen/followers",
         "following_url" : "https://api.github.com/users/GIJensen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/GIJensen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/GIJensen",
         "id" : 16140350,
         "login" : "GIJensen",
         "organizations_url" : "https://api.github.com/users/GIJensen/orgs",
         "received_events_url" : "https://api.github.com/users/GIJensen/received_events",
         "repos_url" : "https://api.github.com/users/GIJensen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/GIJensen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/GIJensen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/GIJensen"
      }
   },
   {
      "body" : "I have trouble parsing *which* locks are conflicting from that log message. It's supposed to detect A->B  B->A lock conflicts, but it looks like, except cs_main the two sequences have nothing in common?\r\n\r\n@TheBlueMatt @cfields you touched that deadlock detection code most recently AFAIK, any idea what is going on here?\r\n",
      "created_at" : "2016-02-05T03:27:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7470#issuecomment-180174529",
      "id" : 180174529,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7470",
      "updated_at" : "2016-02-05T03:27:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/180174529",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Seems to run fine now anyways, no crash yet!",
      "created_at" : "2016-02-05T06:02:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7470#issuecomment-180213977",
      "id" : 180213977,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7470",
      "updated_at" : "2016-02-05T06:02:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/180213977",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16140350?v=3",
         "events_url" : "https://api.github.com/users/GIJensen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/GIJensen/followers",
         "following_url" : "https://api.github.com/users/GIJensen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/GIJensen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/GIJensen",
         "id" : 16140350,
         "login" : "GIJensen",
         "organizations_url" : "https://api.github.com/users/GIJensen/orgs",
         "received_events_url" : "https://api.github.com/users/GIJensen/received_events",
         "repos_url" : "https://api.github.com/users/GIJensen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/GIJensen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/GIJensen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/GIJensen"
      }
   },
   {
      "body" : "Other issues about locking in net code:\r\n\r\n- Potential deadlock on {cs_main, pnode->cs_vSend} #4493\r\n- locking inconsistencies in the network code #4091\r\n- Missing cs_main lock in ProcessMessage() #5678\r\n",
      "created_at" : "2016-02-16T17:23:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7470#issuecomment-184785257",
      "id" : 184785257,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7470",
      "updated_at" : "2016-02-16T17:23:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/184785257",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Travis is running `CPPFLAGS=-DDEBUG_LOCKORDER` ( https://github.com/bitcoin/bitcoin/blob/317462123f8e41fd7dd967ab907e59ddffb19898/.travis.yml#L46 ) \r\n\r\nI should try to see if it triggers this bug report on the extended suite maybe...",
      "created_at" : "2016-02-24T15:50:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7470#issuecomment-188313942",
      "id" : 188313942,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7470",
      "updated_at" : "2016-02-24T15:50:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/188313942",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "Just hit this in travis too:\r\n```\r\nRunning testscript walletbackup.py ...\r\nINFO:Initializing test directory /tmp/testATnfBW\r\nstart_node: bitcoind started, calling bitcoin-cli -rpcwait getblockcount\r\nstart_node: calling bitcoin-cli -rpcwait getblockcount returned\r\nstart_node: bitcoind started, calling bitcoin-cli -rpcwait getblockcount\r\nstart_node: calling bitcoin-cli -rpcwait getblockcount returned\r\nstart_node: bitcoind started, calling bitcoin-cli -rpcwait getblockcount\r\nstart_node: calling bitcoin-cli -rpcwait getblockcount returned\r\nstart_node: bitcoind started, calling bitcoin-cli -rpcwait getblockcount\r\nstart_node: calling bitcoin-cli -rpcwait getblockcount returned\r\nINFO:Generating initial blockchain\r\nINFO:Creating transactions\r\nINFO:Backing up\r\nINFO:More transactions\r\nINFO:Restoring using wallet.dat\r\nINFO:Re-starting nodes\r\nstart_node: bitcoind started, calling bitcoin-cli -rpcwait getblockcount\r\nstart_node: calling bitcoin-cli -rpcwait getblockcount returned\r\nstart_node: bitcoind started, calling bitcoin-cli -rpcwait getblockcount\r\nstart_node: calling bitcoin-cli -rpcwait getblockcount returned\r\nstart_node: bitcoind started, calling bitcoin-cli -rpcwait getblockcount\r\nstart_node: calling bitcoin-cli -rpcwait getblockcount returned\r\nbitcoind: sync.cpp:112: void potential_deadlock_detected(const std::pair<void*, void*>&, const LockStack&, const LockStack&): Assertion `onlyMaybeDeadlock' failed.\r\nUnexpected exception caught during testing: [Errno 111] Connection refused\r\n  File \"/home/travis/build/bitcoin/bitcoin/bitcoin-x86_64-unknown-linux-gnu/qa/rpc-tests/test_framework/test_framework.py\", line 135, in main\r\n    self.run_test()\r\n  File \"/home/travis/build/bitcoin/bitcoin/bitcoin-x86_64-unknown-linux-gnu/qa/rpc-tests/walletbackup.py\", line 168, in run_test\r\n    sync_blocks(self.nodes)\r\n  File \"/home/travis/build/bitcoin/bitcoin/bitcoin-x86_64-unknown-linux-gnu/qa/rpc-tests/test_framework/util.py\", line 98, in sync_blocks\r\n    counts = [ x.getblockcount() for x in rpc_connections ]\r\n  File \"/home/travis/build/bitcoin/bitcoin/bitcoin-x86_64-unknown-linux-gnu/qa/rpc-tests/test_framework/coverage.py\", line 50, in __call__\r\n    return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\r\n  File \"/home/travis/build/bitcoin/bitcoin/bitcoin-x86_64-unknown-linux-gnu/qa/rpc-tests/test_framework/authproxy.py\", line 138, in __call__\r\n    response = self._request('POST', self.__url.path, postdata)\r\n  File \"/home/travis/build/bitcoin/bitcoin/bitcoin-x86_64-unknown-linux-gnu/qa/rpc-tests/test_framework/authproxy.py\", line 124, in _request\r\n    self.__conn.request(method, path, postdata, headers)\r\n  File \"/usr/lib/python2.7/httplib.py\", line 958, in request\r\n    self._send_request(method, url, body, headers)\r\n  File \"/usr/lib/python2.7/httplib.py\", line 992, in _send_request\r\n    self.endheaders(body)\r\n  File \"/usr/lib/python2.7/httplib.py\", line 954, in endheaders\r\n    self._send_output(message_body)\r\n  File \"/usr/lib/python2.7/httplib.py\", line 814, in _send_output\r\n    self.send(msg)\r\n  File \"/usr/lib/python2.7/httplib.py\", line 776, in send\r\n    self.connect()\r\n  File \"/usr/lib/python2.7/httplib.py\", line 757, in connect\r\n    self.timeout, self.source_address)\r\n  File \"/usr/lib/python2.7/socket.py\", line 571, in create_connection\r\n    raise err\r\n```",
      "created_at" : "2016-03-28T10:11:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7470#issuecomment-202332354",
      "id" : 202332354,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7470",
      "updated_at" : "2016-03-28T10:11:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/202332354",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Just got one that looks similar here:\r\nhttps://travis-ci.org/theuni/bitcoin/jobs/120764964#L7682",
      "created_at" : "2016-04-05T17:27:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7470#issuecomment-205908476",
      "id" : 205908476,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7470",
      "updated_at" : "2016-04-05T17:27:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/205908476",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "This is, unfortunately, one of the most frequent travis random false positives.\r\n",
      "created_at" : "2016-04-06T12:23:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7470#issuecomment-206346475",
      "id" : 206346475,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7470",
      "updated_at" : "2016-04-06T12:23:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/206346475",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "From the report:\r\n> 2016-02-04 23:51:14 (1) pnode->cs_vRecvMsg net.cpp:1736 (TRY)\r\n> ...\r\n> 2016-02-04 23:51:14 (1) pto->cs_inventory main.cpp:5445\r\n\r\nThis means the lock detection code is thinking that pnode->cs_vRecvMsg and pto->cs_inventory are the same variable. They are not however, and my assumption is that there are enough CNode objects being created and destroyed that the address of a cs_inventory at one point ends up being occupied by a cs_vRecvMsg later.\r\n\r\nA fix requires deleting the lockorders in the table involving a lock that gets destroyed.\r\n",
      "created_at" : "2016-04-08T16:35:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7470#issuecomment-207505959",
      "id" : 207505959,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7470",
      "updated_at" : "2016-04-08T16:35:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/207505959",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
