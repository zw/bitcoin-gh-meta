[
   {
      "body" : "Hello Brandon, welcome to the Bitcoin Core repository.\r\n\r\nChanging the block or transaction format in such fundamental ways is generally a hard fork, breaking compatibility with all older software. This makes it impractical.\r\n\r\nAnother option is to support optional block compression over the P2P protocol, but don't change local handling; see #6973.\r\n\r\nThough isavings add up to a lot (you'd need to quantify them) they could be part of a future hardfork.\r\nSee also https://en.bitcoin.it/wiki/Hardfork_Wishlist\r\n\r\nNote that some of the fields which have been effectively ignored in the past have recently gained a more important role:\r\n- nLockTime is set by the wallet for every transaction to protect against fee sniping\r\n- nSequence in the input is used to signal opting in to RBF\r\n",
      "created_at" : "2016-01-25T16:42:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7412#issuecomment-174575563",
      "id" : 174575563,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7412",
      "updated_at" : "2016-01-25T16:42:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/174575563",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Thanks for the response. I see, having to do a hard fork is troublesome. Is a hard fork likely to ever occur again that it would be worth taking the time to test the space savings of these ideas?",
      "created_at" : "2016-01-25T19:02:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7412#issuecomment-174622416",
      "id" : 174622416,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7412",
      "updated_at" : "2016-01-25T19:02:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/174622416",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8084361?v=3",
         "events_url" : "https://api.github.com/users/yuilleb/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yuilleb/followers",
         "following_url" : "https://api.github.com/users/yuilleb/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yuilleb/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yuilleb",
         "id" : 8084361,
         "login" : "yuilleb",
         "organizations_url" : "https://api.github.com/users/yuilleb/orgs",
         "received_events_url" : "https://api.github.com/users/yuilleb/received_events",
         "repos_url" : "https://api.github.com/users/yuilleb/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yuilleb/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yuilleb/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yuilleb"
      }
   },
   {
      "body" : "@yuilleb My understanding is that even core expects a hard-fork to eventually happen. But they have relegated it behind other more important priorities to make such a fork as safe as possible. Here's a [link](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2015-December/011865.html) to the road-map.\r\n\r\n> WeÃ¢ÂÂll continue to set the stage for non-bandwidth-increase-based\r\nscaling, while building additional tools that would make **bandwidth\r\nincreases safer long term.** (Emphasis mine)\r\n\r\nI think by 'bandwidth increases' @gmaxwell means block-size. But that is just my interpretation.\r\n",
      "created_at" : "2016-01-25T19:44:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7412#issuecomment-174636392",
      "id" : 174636392,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7412",
      "updated_at" : "2016-01-25T19:44:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/174636392",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16512926?v=3",
         "events_url" : "https://api.github.com/users/bityogi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bityogi/followers",
         "following_url" : "https://api.github.com/users/bityogi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bityogi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bityogi",
         "id" : 16512926,
         "login" : "bityogi",
         "organizations_url" : "https://api.github.com/users/bityogi/orgs",
         "received_events_url" : "https://api.github.com/users/bityogi/received_events",
         "repos_url" : "https://api.github.com/users/bityogi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bityogi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bityogi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bityogi"
      }
   },
   {
      "body" : "@bityogi thanks for the follow up. Since there is a chance of a hard fork down the road, I'll write some code to transform blocks into the suggested format and see what the numbers look like.\r\n\r\n@laanwj I spent some time reading #6973. My guess is gzip/deflate is able to perform well because there are so many occurrences of 0x00 bytes and 0xff bytes. My intention is to remove these bytes altogether so more transactions can fit within a single block, before compression is applied for relaying.\r\n\r\nIf someone does have any related ideas, please share them here so I can include those in my test code so we can see the results. Feel free to close this if no one else has any ideas related to this.",
      "created_at" : "2016-01-25T20:25:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7412#issuecomment-174651086",
      "id" : 174651086,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7412",
      "updated_at" : "2016-01-25T20:25:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/174651086",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8084361?v=3",
         "events_url" : "https://api.github.com/users/yuilleb/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yuilleb/followers",
         "following_url" : "https://api.github.com/users/yuilleb/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yuilleb/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yuilleb",
         "id" : 8084361,
         "login" : "yuilleb",
         "organizations_url" : "https://api.github.com/users/yuilleb/orgs",
         "received_events_url" : "https://api.github.com/users/yuilleb/received_events",
         "repos_url" : "https://api.github.com/users/yuilleb/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yuilleb/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yuilleb/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yuilleb"
      }
   },
   {
      "body" : "@yuilleb & @laanwj \r\nAnother data compression library & format of interest along similar lines I've been exploring more recently is Brotli. Have you looked at it?",
      "created_at" : "2016-01-26T06:43:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7412#issuecomment-174859540",
      "id" : 174859540,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7412",
      "updated_at" : "2016-01-26T06:45:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/174859540",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5460972?v=3",
         "events_url" : "https://api.github.com/users/bgorlick/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bgorlick/followers",
         "following_url" : "https://api.github.com/users/bgorlick/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bgorlick/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bgorlick",
         "id" : 5460972,
         "login" : "bgorlick",
         "organizations_url" : "https://api.github.com/users/bgorlick/orgs",
         "received_events_url" : "https://api.github.com/users/bgorlick/received_events",
         "repos_url" : "https://api.github.com/users/bgorlick/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bgorlick/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bgorlick/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bgorlick"
      }
   },
   {
      "body" : "@bgorlick I have not heard of this compression technique, but thanks for the info. This should probably be suggested in #6973 as an optional compression format.",
      "created_at" : "2016-01-26T20:55:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7412#issuecomment-175225744",
      "id" : 175225744,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7412",
      "updated_at" : "2016-01-26T20:55:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/175225744",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8084361?v=3",
         "events_url" : "https://api.github.com/users/yuilleb/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yuilleb/followers",
         "following_url" : "https://api.github.com/users/yuilleb/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yuilleb/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yuilleb",
         "id" : 8084361,
         "login" : "yuilleb",
         "organizations_url" : "https://api.github.com/users/yuilleb/orgs",
         "received_events_url" : "https://api.github.com/users/yuilleb/received_events",
         "repos_url" : "https://api.github.com/users/yuilleb/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yuilleb/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yuilleb/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yuilleb"
      }
   },
   {
      "body" : "I ran some tests with my test code and found that if you enable the following options, the block size is decreased by about 3.5% to 4.1%. All initial testing was done originally on blk00426.dat.\r\n\r\nThe test program was run with the following command: ./txcomp --allinputslocked --txinopt --varintindex --stopbitlocktime --varinttxver blk00426.dat\r\n\r\n--allinputslocked     If all inputs have their sequence fields locked (set to 0xffffffff) then the locktime field is not included.\r\n--txinopt                  A single option byte is included in each tx input using bit flags to signal if the sequence field is locked (set to 0xffffffff) or is set to a value other than 0. If no flags are set then the sequence field is not included.\r\n--varintindex           The index field is encoded as a var_int.\r\n--stopbitlocktime     The lock time field is encoded as a stop bit integer.\r\n--varinttxver            The transaction version field is encoded as a var_int.\r\n\r\nOn the following files here are the original file sizes followed by their new format sizes:\r\nblk00426.dat 133412113 128700565\r\nblk00037.dat 133991669 128130719\r\nblk00137.dat 133895931 128389420\r\n\r\nI have decided not to run the tests over any other out of sample files so as not to have any curve fitting in case other options are explored.\r\n\r\nI also found that the average transaction input count appears to be about 2 inputs as well as the average transaction output count. The average script length seems to be about 72 bytes (scripts seem to be where the most compression could take place).\r\n\r\nI'm not sure if these findings warrant modifying transaction formats in a future hard fork scenario, but if anyone thinks there is merit here please let me know and I'll continue working on this.",
      "created_at" : "2016-01-26T21:18:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7412#issuecomment-175234064",
      "id" : 175234064,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7412",
      "updated_at" : "2016-01-26T21:18:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/175234064",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8084361?v=3",
         "events_url" : "https://api.github.com/users/yuilleb/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yuilleb/followers",
         "following_url" : "https://api.github.com/users/yuilleb/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yuilleb/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yuilleb",
         "id" : 8084361,
         "login" : "yuilleb",
         "organizations_url" : "https://api.github.com/users/yuilleb/orgs",
         "received_events_url" : "https://api.github.com/users/yuilleb/received_events",
         "repos_url" : "https://api.github.com/users/yuilleb/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yuilleb/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yuilleb/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yuilleb"
      }
   }
]
