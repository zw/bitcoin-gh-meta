[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26291](https://github.com/bitcoin/bitcoin/pull/26291) (Update MANDATORY_SCRIPT_VERIFY_FLAGS by ajtowns)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-06-21T11:23:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#issuecomment-1600657838",
      "id" : 1600657838,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27926",
      "node_id" : "IC_kwDOABII585faBmu",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1600657838/reactions"
      },
      "updated_at" : "2023-06-26T12:39:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1600657838",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1237001895"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237001895"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "should this be `if (annex_input_count > 0 && tx.vin.size() != annex_input_count)`?",
      "commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "created_at" : "2023-06-21T13:26:18Z",
      "diff_hunk" : "@@ -289,6 +332,12 @@ bool IsWitnessStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n             }\n         }\n     }\n+\n+    // If any inputs commit to an annex, all inputs must commit to an annex.\n+    if (annex_input_count > 0 && tx.vin.size() != tx.vin.size()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1237001895",
      "id" : 1237001895,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Juyan",
      "original_commit_id" : "0f67fca200136d8862267fe00dc04201211f7547",
      "original_line" : 337,
      "original_position" : 72,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : null,
      "pull_request_review_id" : 1490742245,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237001895/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-21T13:26:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237001895",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1237031249"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237031249"
         }
      },
      "author_association" : "NONE",
      "body" : "fixed",
      "commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "created_at" : "2023-06-21T13:46:30Z",
      "diff_hunk" : "@@ -289,6 +332,12 @@ bool IsWitnessStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n             }\n         }\n     }\n+\n+    // If any inputs commit to an annex, all inputs must commit to an annex.\n+    if (annex_input_count > 0 && tx.vin.size() != tx.vin.size()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1237031249",
      "id" : 1237031249,
      "in_reply_to_id" : 1237001895,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Ju5lR",
      "original_commit_id" : "0f67fca200136d8862267fe00dc04201211f7547",
      "original_line" : 337,
      "original_position" : 72,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : null,
      "pull_request_review_id" : 1490786953,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237031249/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-21T13:46:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237031249",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4638168?v=4",
         "events_url" : "https://api.github.com/users/joostjager/events{/privacy}",
         "followers_url" : "https://api.github.com/users/joostjager/followers",
         "following_url" : "https://api.github.com/users/joostjager/following{/other_user}",
         "gists_url" : "https://api.github.com/users/joostjager/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/joostjager",
         "id" : 4638168,
         "login" : "joostjager",
         "node_id" : "MDQ6VXNlcjQ2MzgxNjg=",
         "organizations_url" : "https://api.github.com/users/joostjager/orgs",
         "received_events_url" : "https://api.github.com/users/joostjager/received_events",
         "repos_url" : "https://api.github.com/users/joostjager/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/joostjager/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/joostjager/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/joostjager"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Think this is failing CI because of an annex nonstandard check https://github.com/bitcoin/bitcoin/blob/f1b4975461364d5d40d2bfafc6b165dd5d7eec30/test/functional/feature_taproot.py#L1209",
      "created_at" : "2023-06-21T15:56:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#issuecomment-1601101903",
      "id" : 1601101903,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27926",
      "node_id" : "IC_kwDOABII585fbuBP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1601101903/reactions"
      },
      "updated_at" : "2023-06-21T15:56:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1601101903",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@Crypt-iQ thanks for pointing that out. I need to get used to this repository still. Will definitely fix tests, but looking for concept ack first.",
      "created_at" : "2023-06-21T16:41:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#issuecomment-1601175336",
      "id" : 1601175336,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27926",
      "node_id" : "IC_kwDOABII585fb_8o",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1601175336/reactions"
      },
      "updated_at" : "2023-06-21T16:41:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1601175336",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4638168?v=4",
         "events_url" : "https://api.github.com/users/joostjager/events{/privacy}",
         "followers_url" : "https://api.github.com/users/joostjager/followers",
         "following_url" : "https://api.github.com/users/joostjager/following{/other_user}",
         "gists_url" : "https://api.github.com/users/joostjager/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/joostjager",
         "id" : 4638168,
         "login" : "joostjager",
         "node_id" : "MDQ6VXNlcjQ2MzgxNjg=",
         "organizations_url" : "https://api.github.com/users/joostjager/orgs",
         "received_events_url" : "https://api.github.com/users/joostjager/received_events",
         "repos_url" : "https://api.github.com/users/joostjager/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/joostjager/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/joostjager/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/joostjager"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Use case?",
      "created_at" : "2023-06-24T14:37:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#issuecomment-1605556983",
      "id" : 1605556983,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27926",
      "node_id" : "IC_kwDOABII585fstr3",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1605556983/reactions"
      },
      "updated_at" : "2023-06-24T14:37:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1605556983",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@luke-jr annex covenants, see link in PR description",
      "created_at" : "2023-06-25T20:38:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#issuecomment-1606255813",
      "id" : 1606255813,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27926",
      "node_id" : "IC_kwDOABII585fvYTF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1606255813/reactions"
      },
      "updated_at" : "2023-06-25T20:38:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1606255813",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4638168?v=4",
         "events_url" : "https://api.github.com/users/joostjager/events{/privacy}",
         "followers_url" : "https://api.github.com/users/joostjager/followers",
         "following_url" : "https://api.github.com/users/joostjager/following{/other_user}",
         "gists_url" : "https://api.github.com/users/joostjager/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/joostjager",
         "id" : 4638168,
         "login" : "joostjager",
         "node_id" : "MDQ6VXNlcjQ2MzgxNjg=",
         "organizations_url" : "https://api.github.com/users/joostjager/orgs",
         "received_events_url" : "https://api.github.com/users/joostjager/received_events",
         "repos_url" : "https://api.github.com/users/joostjager/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/joostjager/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/joostjager/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/joostjager"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241344893"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241344893"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think here we might prefer to _not_ discount the 0x00 signaling byte from the 265 byte anti-annex-inflation-attacks limit, otherwise it sounds to me weâre introducing a coupling effect between the max witness size one can sign for and the tag signaling byte format itself. Such tag signaling byte format might acquire consensus semantic in the future, and I think we would prefer to reserve the evolvability in function of consensus changes here.",
      "commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "created_at" : "2023-06-26T00:29:56Z",
      "diff_hunk" : "@@ -208,11 +208,45 @@ bool AreInputsStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n     return true;\n }\n \n+bool IsAnnexStandard(const std::vector<unsigned char>& annex)\n+{\n+    // Get the size of the annex excluding the tag byte.\n+    size_t annex_size = annex.size() - 1;\n+\n+    // Allow an empty annex. This allows inputs to opt-in to annex\n+    // usage with the minimal number of bytes.\n+    if (annex_size == 0) {\n+        return true;\n+    }\n+\n+    // Annexes are nonstandard as long as they don't start with a\n+    // 0x00 byte which signals unstructured data.\n+    if (annex[1] != 0) {\n+        return false;\n+    }\n+\n+    // Calculate the size of the unstructured data by subtracting\n+    // one for the 0x00 signaling byte.\n+    size_t unstructured_annex_size = annex_size - 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241344893",
      "id" : 1241344893,
      "line" : 230,
      "node_id" : "PRRC_kwDOABII585J_Wt9",
      "original_commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "original_line" : 230,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : 23,
      "pull_request_review_id" : 1497263042,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241344893/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-26T01:17:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241344893",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241352665"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241352665"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think we can constify the value, e.g `PER_INPUT_MAX_ANNEX_SIZE`, generally this is unclear if we would like a per-input annex limit and a max transaction all annexes limits, e.g `MAX_ANNEX_BUDGET`.\r\n\r\nSplitting the limit enables flow where inputs can be combined in a non-deterministic order, e.g BIP174âs [combiner](https://github.com/bitcoin/bips/blob/master/bip-0174.mediawiki#combiner), and reject in function of âwitness weight slotsâ that can be distributed by such combiner, which makes sense to coordinate flows between hardware signers.",
      "commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "created_at" : "2023-06-26T00:51:48Z",
      "diff_hunk" : "@@ -208,11 +208,45 @@ bool AreInputsStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n     return true;\n }\n \n+bool IsAnnexStandard(const std::vector<unsigned char>& annex)\n+{\n+    // Get the size of the annex excluding the tag byte.\n+    size_t annex_size = annex.size() - 1;\n+\n+    // Allow an empty annex. This allows inputs to opt-in to annex\n+    // usage with the minimal number of bytes.\n+    if (annex_size == 0) {\n+        return true;\n+    }\n+\n+    // Annexes are nonstandard as long as they don't start with a\n+    // 0x00 byte which signals unstructured data.\n+    if (annex[1] != 0) {\n+        return false;\n+    }\n+\n+    // Calculate the size of the unstructured data by subtracting\n+    // one for the 0x00 signaling byte.\n+    size_t unstructured_annex_size = annex_size - 1;\n+\n+    // Unstructured annexes are nonstandard if they are larger than\n+    // 256 bytes. This limits the potential of annex inflation\n+    // attacks.\n+    if (unstructured_annex_size > 256) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241352665",
      "id" : 1241352665,
      "line" : 235,
      "node_id" : "PRRC_kwDOABII585J_YnZ",
      "original_commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "original_line" : 235,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : 28,
      "pull_request_review_id" : 1497263042,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241352665/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-26T01:17:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241352665",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241353751"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241353751"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think it makes sense to have a `annexrelay` option in `src/init.cpp` with `DEFAULT_ANNEXRELAY_ENABLE=false`, therefore to have node operators running nodes on performance-constrained hosts to opt-out from DoS concerns arising from the processing of the annex itself.",
      "commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "created_at" : "2023-06-26T00:55:53Z",
      "diff_hunk" : "@@ -266,8 +300,17 @@ bool IsWitnessStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n             // Taproot spend (non-P2SH-wrapped, version 1, witness program size 32; see BIP 341)\n             Span stack{tx.vin[i].scriptWitness.stack};\n             if (stack.size() >= 2 && !stack.back().empty() && stack.back()[0] == ANNEX_TAG) {\n-                // Annexes are nonstandard as long as no semantics are defined for them.\n-                return false;\n+                // An annex is present. Remove it from the stack and save it for\n+                // standardness checks.\n+                const auto& annex = SpanPopBack(stack);\n+\n+                // Check that the annex is standard.\n+                if (!IsAnnexStandard(annex)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241353751",
      "id" : 1241353751,
      "line" : 308,
      "node_id" : "PRRC_kwDOABII585J_Y4X",
      "original_commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "original_line" : 308,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : 57,
      "pull_request_review_id" : 1497263042,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241353751/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-26T01:17:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241353751",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241355849"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241355849"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should we introduce a limit on the number of inputs supported in a transaction opted-in annex ? To make it easier to reason on worst-case scenario from a second-layer perspective in case of multi-party flow e.g dual-funding. This number of inputs could be tied to the transactionâs `nVersion` field. ",
      "commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "created_at" : "2023-06-26T01:02:49Z",
      "diff_hunk" : "@@ -289,6 +332,12 @@ bool IsWitnessStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n             }\n         }\n     }\n+\n+    // If any inputs commit to an annex, all inputs must commit to an annex.\n+    if (annex_input_count > 0 && annex_input_count != tx.vin.size()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241355849",
      "id" : 1241355849,
      "line" : 337,
      "node_id" : "PRRC_kwDOABII585J_ZZJ",
      "original_commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "original_line" : 337,
      "original_position" : 72,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : 72,
      "pull_request_review_id" : 1497263042,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241355849/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-26T01:17:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241355849",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241358413"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241358413"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If we can move the annex policy-only code in its own `src/policy/annex` like we have at the image of `src/policy/packages.h` for code modularity. I think in the discussion of [#1381](https://github.com/bitcoin/bips/pull/1381) there has been question to reuse the annex in the future for [Grafroot](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-February/015700.html). ",
      "commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "created_at" : "2023-06-26T01:07:50Z",
      "diff_hunk" : "@@ -208,11 +208,45 @@ bool AreInputsStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n     return true;\n }\n \n+bool IsAnnexStandard(const std::vector<unsigned char>& annex)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241358413",
      "id" : 1241358413,
      "line" : 211,
      "node_id" : "PRRC_kwDOABII585J_aBN",
      "original_commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "original_line" : 211,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : 4,
      "pull_request_review_id" : 1497263042,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241358413/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-26T01:17:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241358413",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241919261"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241919261"
         }
      },
      "author_association" : "NONE",
      "body" : "My thought was that it might be good to choose a number of actually useable bytes that is a multiple of a commonly used data structure sizes such as 32 bytes. Therefore 256. It is an arbitrary number though that it supposed to strike a balance between the limiting the potency of annex inflation attacks and having enough space to make the annex useful. \r\n\r\nAre you proposing to limit the annex size including any tags to 257 bytes? I see the conceptual difference, but there wouldn't be a functional difference for now?",
      "commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "created_at" : "2023-06-26T09:46:57Z",
      "diff_hunk" : "@@ -208,11 +208,45 @@ bool AreInputsStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n     return true;\n }\n \n+bool IsAnnexStandard(const std::vector<unsigned char>& annex)\n+{\n+    // Get the size of the annex excluding the tag byte.\n+    size_t annex_size = annex.size() - 1;\n+\n+    // Allow an empty annex. This allows inputs to opt-in to annex\n+    // usage with the minimal number of bytes.\n+    if (annex_size == 0) {\n+        return true;\n+    }\n+\n+    // Annexes are nonstandard as long as they don't start with a\n+    // 0x00 byte which signals unstructured data.\n+    if (annex[1] != 0) {\n+        return false;\n+    }\n+\n+    // Calculate the size of the unstructured data by subtracting\n+    // one for the 0x00 signaling byte.\n+    size_t unstructured_annex_size = annex_size - 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241919261",
      "id" : 1241919261,
      "in_reply_to_id" : 1241344893,
      "line" : 230,
      "node_id" : "PRRC_kwDOABII585KBi8d",
      "original_commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "original_line" : 230,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : 23,
      "pull_request_review_id" : 1498106296,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241919261/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-26T09:46:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241919261",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4638168?v=4",
         "events_url" : "https://api.github.com/users/joostjager/events{/privacy}",
         "followers_url" : "https://api.github.com/users/joostjager/followers",
         "following_url" : "https://api.github.com/users/joostjager/following{/other_user}",
         "gists_url" : "https://api.github.com/users/joostjager/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/joostjager",
         "id" : 4638168,
         "login" : "joostjager",
         "node_id" : "MDQ6VXNlcjQ2MzgxNjg=",
         "organizations_url" : "https://api.github.com/users/joostjager/orgs",
         "received_events_url" : "https://api.github.com/users/joostjager/received_events",
         "repos_url" : "https://api.github.com/users/joostjager/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/joostjager/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/joostjager/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/joostjager"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241927265"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241927265"
         }
      },
      "author_association" : "NONE",
      "body" : "With the constant defined as suggested below, this suggestion does seem to make reading easier. Changed.",
      "commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "created_at" : "2023-06-26T09:51:59Z",
      "diff_hunk" : "@@ -208,11 +208,45 @@ bool AreInputsStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n     return true;\n }\n \n+bool IsAnnexStandard(const std::vector<unsigned char>& annex)\n+{\n+    // Get the size of the annex excluding the tag byte.\n+    size_t annex_size = annex.size() - 1;\n+\n+    // Allow an empty annex. This allows inputs to opt-in to annex\n+    // usage with the minimal number of bytes.\n+    if (annex_size == 0) {\n+        return true;\n+    }\n+\n+    // Annexes are nonstandard as long as they don't start with a\n+    // 0x00 byte which signals unstructured data.\n+    if (annex[1] != 0) {\n+        return false;\n+    }\n+\n+    // Calculate the size of the unstructured data by subtracting\n+    // one for the 0x00 signaling byte.\n+    size_t unstructured_annex_size = annex_size - 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241927265",
      "id" : 1241927265,
      "in_reply_to_id" : 1241344893,
      "line" : 230,
      "node_id" : "PRRC_kwDOABII585KBk5h",
      "original_commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "original_line" : 230,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : 23,
      "pull_request_review_id" : 1498115358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241927265/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-26T09:52:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241927265",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4638168?v=4",
         "events_url" : "https://api.github.com/users/joostjager/events{/privacy}",
         "followers_url" : "https://api.github.com/users/joostjager/followers",
         "following_url" : "https://api.github.com/users/joostjager/following{/other_user}",
         "gists_url" : "https://api.github.com/users/joostjager/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/joostjager",
         "id" : 4638168,
         "login" : "joostjager",
         "node_id" : "MDQ6VXNlcjQ2MzgxNjg=",
         "organizations_url" : "https://api.github.com/users/joostjager/orgs",
         "received_events_url" : "https://api.github.com/users/joostjager/received_events",
         "repos_url" : "https://api.github.com/users/joostjager/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/joostjager/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/joostjager/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/joostjager"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241936380"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241936380"
         }
      },
      "author_association" : "NONE",
      "body" : "Added `MAX_PER_INPUT_ANNEX_SIZE`.\r\n\r\nNot sure if a per tx maximum is necessary. I'd say that opting in to annex usage has some risks to be aware of. Maybe you don't want to use it for multi-party protocols at all because of that. To me, `MAX_PER_INPUT_ANNEX_SIZE` is already debatable when you have opt-in, and `MAX_ANNEX_BUDGET` feels even more like an unnecessary precaution. In the end, this is all policy anyway and not a real protection against tx outside of these boundaries appearing.",
      "commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "created_at" : "2023-06-26T09:58:02Z",
      "diff_hunk" : "@@ -208,11 +208,45 @@ bool AreInputsStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n     return true;\n }\n \n+bool IsAnnexStandard(const std::vector<unsigned char>& annex)\n+{\n+    // Get the size of the annex excluding the tag byte.\n+    size_t annex_size = annex.size() - 1;\n+\n+    // Allow an empty annex. This allows inputs to opt-in to annex\n+    // usage with the minimal number of bytes.\n+    if (annex_size == 0) {\n+        return true;\n+    }\n+\n+    // Annexes are nonstandard as long as they don't start with a\n+    // 0x00 byte which signals unstructured data.\n+    if (annex[1] != 0) {\n+        return false;\n+    }\n+\n+    // Calculate the size of the unstructured data by subtracting\n+    // one for the 0x00 signaling byte.\n+    size_t unstructured_annex_size = annex_size - 1;\n+\n+    // Unstructured annexes are nonstandard if they are larger than\n+    // 256 bytes. This limits the potential of annex inflation\n+    // attacks.\n+    if (unstructured_annex_size > 256) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241936380",
      "id" : 1241936380,
      "in_reply_to_id" : 1241352665,
      "line" : 235,
      "node_id" : "PRRC_kwDOABII585KBnH8",
      "original_commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "original_line" : 235,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : 28,
      "pull_request_review_id" : 1498126768,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241936380/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-26T09:58:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241936380",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4638168?v=4",
         "events_url" : "https://api.github.com/users/joostjager/events{/privacy}",
         "followers_url" : "https://api.github.com/users/joostjager/followers",
         "following_url" : "https://api.github.com/users/joostjager/following{/other_user}",
         "gists_url" : "https://api.github.com/users/joostjager/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/joostjager",
         "id" : 4638168,
         "login" : "joostjager",
         "node_id" : "MDQ6VXNlcjQ2MzgxNjg=",
         "organizations_url" : "https://api.github.com/users/joostjager/orgs",
         "received_events_url" : "https://api.github.com/users/joostjager/received_events",
         "repos_url" : "https://api.github.com/users/joostjager/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/joostjager/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/joostjager/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/joostjager"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241938735"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241938735"
         }
      },
      "author_association" : "NONE",
      "body" : "Which DoS concerns are you referring to? Since #24007 hasn't landed yet, the tx can only be accepted once?",
      "commit_id" : "ac119a5cb78df6209a789740cd456dfba951720f",
      "created_at" : "2023-06-26T09:59:59Z",
      "diff_hunk" : "@@ -266,8 +300,17 @@ bool IsWitnessStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n             // Taproot spend (non-P2SH-wrapped, version 1, witness program size 32; see BIP 341)\n             Span stack{tx.vin[i].scriptWitness.stack};\n             if (stack.size() >= 2 && !stack.back().empty() && stack.back()[0] == ANNEX_TAG) {\n-                // Annexes are nonstandard as long as no semantics are defined for them.\n-                return false;\n+                // An annex is present. Remove it from the stack and save it for\n+                // standardness checks.\n+                const auto& annex = SpanPopBack(stack);\n+\n+                // Check that the annex is standard.\n+                if (!IsAnnexStandard(annex)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241938735",
      "id" : 1241938735,
      "in_reply_to_id" : 1241353751,
      "line" : 304,
      "node_id" : "PRRC_kwDOABII585KBnsv",
      "original_commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "original_line" : 304,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : 53,
      "pull_request_review_id" : 1498130444,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241938735/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-26T10:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241938735",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4638168?v=4",
         "events_url" : "https://api.github.com/users/joostjager/events{/privacy}",
         "followers_url" : "https://api.github.com/users/joostjager/followers",
         "following_url" : "https://api.github.com/users/joostjager/following{/other_user}",
         "gists_url" : "https://api.github.com/users/joostjager/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/joostjager",
         "id" : 4638168,
         "login" : "joostjager",
         "node_id" : "MDQ6VXNlcjQ2MzgxNjg=",
         "organizations_url" : "https://api.github.com/users/joostjager/orgs",
         "received_events_url" : "https://api.github.com/users/joostjager/received_events",
         "repos_url" : "https://api.github.com/users/joostjager/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/joostjager/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/joostjager/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/joostjager"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241941706"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241941706"
         }
      },
      "author_association" : "NONE",
      "body" : "My answer here would be the same as in https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241936380. I think you can argue that opt-in is enough protection and multi-party flows with annexes may not be a good idea. Especially if there are no concrete plans for multi-party protocols that require the unique properties of the annex.",
      "commit_id" : "ac119a5cb78df6209a789740cd456dfba951720f",
      "created_at" : "2023-06-26T10:02:40Z",
      "diff_hunk" : "@@ -289,6 +332,12 @@ bool IsWitnessStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n             }\n         }\n     }\n+\n+    // If any inputs commit to an annex, all inputs must commit to an annex.\n+    if (annex_input_count > 0 && annex_input_count != tx.vin.size()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241941706",
      "id" : 1241941706,
      "in_reply_to_id" : 1241355849,
      "line" : 333,
      "node_id" : "PRRC_kwDOABII585KBobK",
      "original_commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "original_line" : 333,
      "original_position" : 72,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : 68,
      "pull_request_review_id" : 1498135191,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241941706/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-26T10:02:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241941706",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4638168?v=4",
         "events_url" : "https://api.github.com/users/joostjager/events{/privacy}",
         "followers_url" : "https://api.github.com/users/joostjager/followers",
         "following_url" : "https://api.github.com/users/joostjager/following{/other_user}",
         "gists_url" : "https://api.github.com/users/joostjager/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/joostjager",
         "id" : 4638168,
         "login" : "joostjager",
         "node_id" : "MDQ6VXNlcjQ2MzgxNjg=",
         "organizations_url" : "https://api.github.com/users/joostjager/orgs",
         "received_events_url" : "https://api.github.com/users/joostjager/received_events",
         "repos_url" : "https://api.github.com/users/joostjager/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/joostjager/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/joostjager/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/joostjager"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241944433"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241944433"
         }
      },
      "author_association" : "NONE",
      "body" : "Happy to do it if others agree that the current annex check isn't too minimal for its own file.",
      "commit_id" : "ac119a5cb78df6209a789740cd456dfba951720f",
      "created_at" : "2023-06-26T10:04:49Z",
      "diff_hunk" : "@@ -208,11 +208,45 @@ bool AreInputsStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n     return true;\n }\n \n+bool IsAnnexStandard(const std::vector<unsigned char>& annex)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1241944433",
      "id" : 1241944433,
      "in_reply_to_id" : 1241358413,
      "line" : 211,
      "node_id" : "PRRC_kwDOABII585KBpFx",
      "original_commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "original_line" : 211,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : 4,
      "pull_request_review_id" : 1498139446,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241944433/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-26T10:04:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1241944433",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4638168?v=4",
         "events_url" : "https://api.github.com/users/joostjager/events{/privacy}",
         "followers_url" : "https://api.github.com/users/joostjager/followers",
         "following_url" : "https://api.github.com/users/joostjager/following{/other_user}",
         "gists_url" : "https://api.github.com/users/joostjager/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/joostjager",
         "id" : 4638168,
         "login" : "joostjager",
         "node_id" : "MDQ6VXNlcjQ2MzgxNjg=",
         "organizations_url" : "https://api.github.com/users/joostjager/orgs",
         "received_events_url" : "https://api.github.com/users/joostjager/received_events",
         "repos_url" : "https://api.github.com/users/joostjager/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/joostjager/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/joostjager/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/joostjager"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Updated `feature_taproot.py` tests",
      "created_at" : "2023-06-26T15:36:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#issuecomment-1607734897",
      "id" : 1607734897,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27926",
      "node_id" : "IC_kwDOABII585f1BZx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1607734897/reactions"
      },
      "updated_at" : "2023-06-26T15:36:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1607734897",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4638168?v=4",
         "events_url" : "https://api.github.com/users/joostjager/events{/privacy}",
         "followers_url" : "https://api.github.com/users/joostjager/followers",
         "following_url" : "https://api.github.com/users/joostjager/following{/other_user}",
         "gists_url" : "https://api.github.com/users/joostjager/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/joostjager",
         "id" : 4638168,
         "login" : "joostjager",
         "node_id" : "MDQ6VXNlcjQ2MzgxNjg=",
         "organizations_url" : "https://api.github.com/users/joostjager/orgs",
         "received_events_url" : "https://api.github.com/users/joostjager/received_events",
         "repos_url" : "https://api.github.com/users/joostjager/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/joostjager/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/joostjager/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/joostjager"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1252291878"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252291878"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Are you proposing to limit the annex size including any tags to 257 bytes? I see the conceptual difference, but there wouldn't be a functional difference for now?\r\n\r\nYes, for now it doesnât make a functional difference. The issue I have in mind is the following, assuming the unstructured annex format is deployed and we see applications building on top of it, the 256 (or 257 now) annex size limit will have to become a max-size data payload, which is going to leak in the all application toolchains (in the same sense than TCPâs 64k bytes max frame is often used as the limit for application transport design).\r\n\r\nAs of today, the signaling byte size is of 1 byte, however if in the future we have a consensus definition of the tag being  _more_ than 1 byte, we might have to swallow the 255 bytes reserved for the application data-payload. Not swallowing on the 255 bytes would mean the consensus-aware application will have to pay the witness cost for the 0x00 signaling byte and this byte will have to be discarded by parsing logic.\r\n\r\nSo if those observations are correct, I think the constant could have some safety margin padding for changes of the âstructured/unstructured guardâ signaling byte size. One can think 256 byte reserved for application-data + 32 byte of padding, from which this 1st byte of padding will be the current `0x00` one ? And I think that way we can guarantee to the application a multiple of a 32-byte based data structure.",
      "commit_id" : "e71f9399d2bee34679a85783431ca98639221293",
      "created_at" : "2023-07-04T18:58:09Z",
      "diff_hunk" : "@@ -208,11 +208,45 @@ bool AreInputsStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n     return true;\n }\n \n+bool IsAnnexStandard(const std::vector<unsigned char>& annex)\n+{\n+    // Get the size of the annex excluding the tag byte.\n+    size_t annex_size = annex.size() - 1;\n+\n+    // Allow an empty annex. This allows inputs to opt-in to annex\n+    // usage with the minimal number of bytes.\n+    if (annex_size == 0) {\n+        return true;\n+    }\n+\n+    // Annexes are nonstandard as long as they don't start with a\n+    // 0x00 byte which signals unstructured data.\n+    if (annex[1] != 0) {\n+        return false;\n+    }\n+\n+    // Calculate the size of the unstructured data by subtracting\n+    // one for the 0x00 signaling byte.\n+    size_t unstructured_annex_size = annex_size - 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1252291878",
      "id" : 1252291878,
      "in_reply_to_id" : 1241344893,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585KpHUm",
      "original_commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "original_line" : 230,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : null,
      "pull_request_review_id" : 1513302409,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252291878/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-04T18:58:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252291878",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1252299556"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252299556"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Maybe you don't want to use it for multi-party protocols at all because of that.\r\n\r\nI think thatâs a good question, there is an annex inflation risk concerning the multi-party protocol users and there is a new CPU DoS risk that is faced by node operators due to the increased in annex data size. I think this CPU DoS risk is coming from the fact that with BIP341, there is a `sha_annex` in the transaction digest if the annex is present and therefore you have a new SHA-256 ops and data bytes to hash that have to get done by the nodes.\r\n\r\nI donât think this CPU DoS risk, if correct, is that much an increase in DoS surface, though a `MAX_ANNEX_BUDGET` can be a good conservative âbelt-and-suspenderâ DoS limits, like we have a lot in Bitcoin Core.\r\n\r\n>  In the end, this is all policy anyway and not a real protection against tx outside of these boundaries appearing.\r\n\r\nYes if youâre considering the risk faced by multi-party protocol users, policy is a shallow protection for transaction appearing outside those boundaries by being directly relayed to the miners. However, if youâre considering the CPU DoS protection for node operators this is a _real_ protection, especially in a world where you might have a lot of hobbyist nodes running on resources-constraint hosts.",
      "commit_id" : "e71f9399d2bee34679a85783431ca98639221293",
      "created_at" : "2023-07-04T19:15:55Z",
      "diff_hunk" : "@@ -208,11 +208,45 @@ bool AreInputsStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n     return true;\n }\n \n+bool IsAnnexStandard(const std::vector<unsigned char>& annex)\n+{\n+    // Get the size of the annex excluding the tag byte.\n+    size_t annex_size = annex.size() - 1;\n+\n+    // Allow an empty annex. This allows inputs to opt-in to annex\n+    // usage with the minimal number of bytes.\n+    if (annex_size == 0) {\n+        return true;\n+    }\n+\n+    // Annexes are nonstandard as long as they don't start with a\n+    // 0x00 byte which signals unstructured data.\n+    if (annex[1] != 0) {\n+        return false;\n+    }\n+\n+    // Calculate the size of the unstructured data by subtracting\n+    // one for the 0x00 signaling byte.\n+    size_t unstructured_annex_size = annex_size - 1;\n+\n+    // Unstructured annexes are nonstandard if they are larger than\n+    // 256 bytes. This limits the potential of annex inflation\n+    // attacks.\n+    if (unstructured_annex_size > 256) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1252299556",
      "id" : 1252299556,
      "in_reply_to_id" : 1241352665,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585KpJMk",
      "original_commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "original_line" : 235,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : null,
      "pull_request_review_id" : 1513312844,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252299556/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-04T19:15:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252299556",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1252300001"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252300001"
         }
      },
      "author_association" : "MEMBER",
      "body" : "See the CPU DoS concerned mentioned above about BIP341âs `sha_annex`, if annexes start to be relayed.",
      "commit_id" : "e71f9399d2bee34679a85783431ca98639221293",
      "created_at" : "2023-07-04T19:17:08Z",
      "diff_hunk" : "@@ -266,8 +300,17 @@ bool IsWitnessStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n             // Taproot spend (non-P2SH-wrapped, version 1, witness program size 32; see BIP 341)\n             Span stack{tx.vin[i].scriptWitness.stack};\n             if (stack.size() >= 2 && !stack.back().empty() && stack.back()[0] == ANNEX_TAG) {\n-                // Annexes are nonstandard as long as no semantics are defined for them.\n-                return false;\n+                // An annex is present. Remove it from the stack and save it for\n+                // standardness checks.\n+                const auto& annex = SpanPopBack(stack);\n+\n+                // Check that the annex is standard.\n+                if (!IsAnnexStandard(annex)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1252300001",
      "id" : 1252300001,
      "in_reply_to_id" : 1241353751,
      "line" : 304,
      "node_id" : "PRRC_kwDOABII585KpJTh",
      "original_commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "original_line" : 304,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : 53,
      "pull_request_review_id" : 1513313477,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252300001/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-04T19:17:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252300001",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1252303541"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252303541"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Especially if there are no concrete plans for multi-party protocols that require the unique properties of the annex.\r\n\r\nIf youâre taking the use-case of unstructured data discussed on the mailing list, I think there is still a leak in term of fee-bumping reserves than a user must provision for, in case of the worst annex inflation attacks being done, under known limits of `PER_INPUT_MAX_ANNEX_SIZE` (and eventual `MAX_ANNEX_BUDGET`).\r\n\r\nOf course, as youâre raising you can always have an adversarial transaction being broadcast directly to the mining pools mempools, though in a world where miners select the block template (i.e more with Stratum V2 deployment), this is a high technical bar for an annex inflation adversary. So the âdefaultâ policy limit on the max annex size is far from second-order considerations on the level of fee-bumping reserves than one must maintained to prevent timevalue DoS.\r\n\r\n(I donât deny this is quite a sophisticated discussion to encompass the impact on fee-bumping reserves, still the kind of realistic threat model weâre considering for LN today).",
      "commit_id" : "e71f9399d2bee34679a85783431ca98639221293",
      "created_at" : "2023-07-04T19:26:12Z",
      "diff_hunk" : "@@ -289,6 +332,12 @@ bool IsWitnessStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n             }\n         }\n     }\n+\n+    // If any inputs commit to an annex, all inputs must commit to an annex.\n+    if (annex_input_count > 0 && annex_input_count != tx.vin.size()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1252303541",
      "id" : 1252303541,
      "in_reply_to_id" : 1241355849,
      "line" : 333,
      "node_id" : "PRRC_kwDOABII585KpKK1",
      "original_commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "original_line" : 333,
      "original_position" : 72,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : 68,
      "pull_request_review_id" : 1513318960,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252303541/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-04T19:26:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252303541",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Left a new round of reviews, I think the following conceptual concerns are pending:\r\n- padding of the signaling byte to preserve evolvability for future consensus validation of the annex data\r\n- adding a `MAX_ANNEX_BUDGET` or not to mitigate potential CPU DoS concerns for full-nodes, and potential impact for fee-bumping reserves\r\n- opted-in of `annexrelay` for node operators\r\n- annex policy limits versioned on the transactionâs `nVersion` field\r\n- [\"all-or-nothing\" annex opted-in mechanism](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-June/021778.html)\r\n\r\nI still have to reply on the latest mail post about standardizing the annex, which Iâm aiming to do so. I think at that stage the proposal would benefit from an âapplications\" BIP draft that would give one or two use-cases in detail, and therefore serves as technical tie-breaker for the conceptual concerns raised above.\r\n\r\nedited to add one concern from the mailing list",
      "created_at" : "2023-07-04T19:34:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#issuecomment-1620650118",
      "id" : 1620650118,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27926",
      "node_id" : "IC_kwDOABII585gmSiG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1620650118/reactions"
      },
      "updated_at" : "2023-07-04T20:20:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1620650118",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1252663074"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252663074"
         }
      },
      "author_association" : "NONE",
      "body" : "I am not sure if I fully get what you mean. Can you give a concrete example of a future extended format that might interfere with the 0x00 + unstructured proposal? My thought was to simply reserve all non-0x00 first bytes for future use.\r\n\r\nWhen adding 32 bytes of padding, do you mean that initially (in a world with only unstructured annex data), 31 of those bytes are wasted but paid for?",
      "commit_id" : "e71f9399d2bee34679a85783431ca98639221293",
      "created_at" : "2023-07-05T07:25:05Z",
      "diff_hunk" : "@@ -208,11 +208,45 @@ bool AreInputsStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n     return true;\n }\n \n+bool IsAnnexStandard(const std::vector<unsigned char>& annex)\n+{\n+    // Get the size of the annex excluding the tag byte.\n+    size_t annex_size = annex.size() - 1;\n+\n+    // Allow an empty annex. This allows inputs to opt-in to annex\n+    // usage with the minimal number of bytes.\n+    if (annex_size == 0) {\n+        return true;\n+    }\n+\n+    // Annexes are nonstandard as long as they don't start with a\n+    // 0x00 byte which signals unstructured data.\n+    if (annex[1] != 0) {\n+        return false;\n+    }\n+\n+    // Calculate the size of the unstructured data by subtracting\n+    // one for the 0x00 signaling byte.\n+    size_t unstructured_annex_size = annex_size - 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1252663074",
      "id" : 1252663074,
      "in_reply_to_id" : 1241344893,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Kqh8i",
      "original_commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "original_line" : 230,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : null,
      "pull_request_review_id" : 1513842677,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252663074/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-05T07:25:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252663074",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4638168?v=4",
         "events_url" : "https://api.github.com/users/joostjager/events{/privacy}",
         "followers_url" : "https://api.github.com/users/joostjager/followers",
         "following_url" : "https://api.github.com/users/joostjager/following{/other_user}",
         "gists_url" : "https://api.github.com/users/joostjager/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/joostjager",
         "id" : 4638168,
         "login" : "joostjager",
         "node_id" : "MDQ6VXNlcjQ2MzgxNjg=",
         "organizations_url" : "https://api.github.com/users/joostjager/orgs",
         "received_events_url" : "https://api.github.com/users/joostjager/received_events",
         "repos_url" : "https://api.github.com/users/joostjager/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/joostjager/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/joostjager/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/joostjager"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1252685430"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252685430"
         }
      },
      "author_association" : "NONE",
      "body" : ">I donât think this CPU DoS risk, if correct, is that much an increase in DoS surface, though a MAX_ANNEX_BUDGET can be a good conservative âbelt-and-suspenderâ DoS limits, like we have a lot in Bitcoin Core.\r\n\r\nIf it isn't that much of an increase, is it worth adding extra code for it? More code, more things to go wrong. In the end, they are also paying for this tx in sats and the computation cost only increases linearly with the number of inputs.",
      "commit_id" : "e71f9399d2bee34679a85783431ca98639221293",
      "created_at" : "2023-07-05T07:39:27Z",
      "diff_hunk" : "@@ -208,11 +208,45 @@ bool AreInputsStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n     return true;\n }\n \n+bool IsAnnexStandard(const std::vector<unsigned char>& annex)\n+{\n+    // Get the size of the annex excluding the tag byte.\n+    size_t annex_size = annex.size() - 1;\n+\n+    // Allow an empty annex. This allows inputs to opt-in to annex\n+    // usage with the minimal number of bytes.\n+    if (annex_size == 0) {\n+        return true;\n+    }\n+\n+    // Annexes are nonstandard as long as they don't start with a\n+    // 0x00 byte which signals unstructured data.\n+    if (annex[1] != 0) {\n+        return false;\n+    }\n+\n+    // Calculate the size of the unstructured data by subtracting\n+    // one for the 0x00 signaling byte.\n+    size_t unstructured_annex_size = annex_size - 1;\n+\n+    // Unstructured annexes are nonstandard if they are larger than\n+    // 256 bytes. This limits the potential of annex inflation\n+    // attacks.\n+    if (unstructured_annex_size > 256) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1252685430",
      "id" : 1252685430,
      "in_reply_to_id" : 1241352665,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585KqnZ2",
      "original_commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "original_line" : 235,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : null,
      "pull_request_review_id" : 1513871704,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252685430/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-05T07:39:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252685430",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4638168?v=4",
         "events_url" : "https://api.github.com/users/joostjager/events{/privacy}",
         "followers_url" : "https://api.github.com/users/joostjager/followers",
         "following_url" : "https://api.github.com/users/joostjager/following{/other_user}",
         "gists_url" : "https://api.github.com/users/joostjager/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/joostjager",
         "id" : 4638168,
         "login" : "joostjager",
         "node_id" : "MDQ6VXNlcjQ2MzgxNjg=",
         "organizations_url" : "https://api.github.com/users/joostjager/orgs",
         "received_events_url" : "https://api.github.com/users/joostjager/received_events",
         "repos_url" : "https://api.github.com/users/joostjager/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/joostjager/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/joostjager/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/joostjager"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1252689789"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252689789"
         }
      },
      "author_association" : "NONE",
      "body" : "Yes, that's clear now. Thanks.\r\n\r\nSame as with `MAX_ANNEX_BUDGET`, my feeling is that this safeguard isn't necessary because the extra cost is only linear and paid for.",
      "commit_id" : "e71f9399d2bee34679a85783431ca98639221293",
      "created_at" : "2023-07-05T07:43:23Z",
      "diff_hunk" : "@@ -266,8 +300,17 @@ bool IsWitnessStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n             // Taproot spend (non-P2SH-wrapped, version 1, witness program size 32; see BIP 341)\n             Span stack{tx.vin[i].scriptWitness.stack};\n             if (stack.size() >= 2 && !stack.back().empty() && stack.back()[0] == ANNEX_TAG) {\n-                // Annexes are nonstandard as long as no semantics are defined for them.\n-                return false;\n+                // An annex is present. Remove it from the stack and save it for\n+                // standardness checks.\n+                const auto& annex = SpanPopBack(stack);\n+\n+                // Check that the annex is standard.\n+                if (!IsAnnexStandard(annex)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1252689789",
      "id" : 1252689789,
      "in_reply_to_id" : 1241353751,
      "line" : 304,
      "node_id" : "PRRC_kwDOABII585Kqod9",
      "original_commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "original_line" : 304,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : 53,
      "pull_request_review_id" : 1513878200,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252689789/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-05T07:43:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252689789",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4638168?v=4",
         "events_url" : "https://api.github.com/users/joostjager/events{/privacy}",
         "followers_url" : "https://api.github.com/users/joostjager/followers",
         "following_url" : "https://api.github.com/users/joostjager/following{/other_user}",
         "gists_url" : "https://api.github.com/users/joostjager/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/joostjager",
         "id" : 4638168,
         "login" : "joostjager",
         "node_id" : "MDQ6VXNlcjQ2MzgxNjg=",
         "organizations_url" : "https://api.github.com/users/joostjager/orgs",
         "received_events_url" : "https://api.github.com/users/joostjager/received_events",
         "repos_url" : "https://api.github.com/users/joostjager/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/joostjager/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/joostjager/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/joostjager"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1252693892"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252693892"
         }
      },
      "author_association" : "NONE",
      "body" : ">If youâre taking the use-case of unstructured data discussed on the mailing list\r\n\r\nWhich one do you refer to exactly, the timelocked vaults using presigned txes? For that there is only a single party, so the inflation attack doesn't apply?",
      "commit_id" : "e71f9399d2bee34679a85783431ca98639221293",
      "created_at" : "2023-07-05T07:46:57Z",
      "diff_hunk" : "@@ -289,6 +332,12 @@ bool IsWitnessStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\n             }\n         }\n     }\n+\n+    // If any inputs commit to an annex, all inputs must commit to an annex.\n+    if (annex_input_count > 0 && annex_input_count != tx.vin.size()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#discussion_r1252693892",
      "id" : 1252693892,
      "in_reply_to_id" : 1241355849,
      "line" : 333,
      "node_id" : "PRRC_kwDOABII585KqpeE",
      "original_commit_id" : "b4421da7c7b07f9d2ec4c119b57bb9e3f06ddc72",
      "original_line" : 333,
      "original_position" : 72,
      "original_start_line" : null,
      "path" : "src/policy/policy.cpp",
      "position" : 68,
      "pull_request_review_id" : 1513884266,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27926",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252693892/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-05T07:46:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1252693892",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4638168?v=4",
         "events_url" : "https://api.github.com/users/joostjager/events{/privacy}",
         "followers_url" : "https://api.github.com/users/joostjager/followers",
         "following_url" : "https://api.github.com/users/joostjager/following{/other_user}",
         "gists_url" : "https://api.github.com/users/joostjager/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/joostjager",
         "id" : 4638168,
         "login" : "joostjager",
         "node_id" : "MDQ6VXNlcjQ2MzgxNjg=",
         "organizations_url" : "https://api.github.com/users/joostjager/orgs",
         "received_events_url" : "https://api.github.com/users/joostjager/received_events",
         "repos_url" : "https://api.github.com/users/joostjager/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/joostjager/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/joostjager/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/joostjager"
      }
   },
   {
      "author_association" : "NONE",
      "body" : ">I think at that stage the proposal would benefit from an âapplications\" BIP draft that would give one or two use-cases in detail, and therefore serves as technical tie-breaker for the conceptual concerns raised above.\r\n\r\nI agree that use cases can help guide the decision making in this PR. That's why I created the demo/explanation mentioned in the PR description: https://github.com/joostjager/annex-covenants.",
      "created_at" : "2023-07-05T07:53:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27926#issuecomment-1621228405",
      "id" : 1621228405,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27926",
      "node_id" : "IC_kwDOABII585goft1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1621228405/reactions"
      },
      "updated_at" : "2023-07-05T07:53:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1621228405",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4638168?v=4",
         "events_url" : "https://api.github.com/users/joostjager/events{/privacy}",
         "followers_url" : "https://api.github.com/users/joostjager/followers",
         "following_url" : "https://api.github.com/users/joostjager/following{/other_user}",
         "gists_url" : "https://api.github.com/users/joostjager/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/joostjager",
         "id" : 4638168,
         "login" : "joostjager",
         "node_id" : "MDQ6VXNlcjQ2MzgxNjg=",
         "organizations_url" : "https://api.github.com/users/joostjager/orgs",
         "received_events_url" : "https://api.github.com/users/joostjager/received_events",
         "repos_url" : "https://api.github.com/users/joostjager/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/joostjager/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/joostjager/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/joostjager"
      }
   }
]
