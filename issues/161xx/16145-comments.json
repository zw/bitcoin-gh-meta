[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16145#discussion_r290326155"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16145"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/290326155"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Note that `isInitialBlockDownload()` already checks `getReindex` and `getImporting`.",
      "commit_id" : "6ad4ad286963e06abab7b6c86dda28aa140f643c",
      "created_at" : "2019-06-04T14:28:41Z",
      "diff_hunk" : "@@ -925,7 +925,7 @@ void BitcoinGUI::setNumBlocks(int count, const QDateTime& blockDate, double nVer\n {\n // Disabling macOS App Nap on initial sync, disk and reindex operations.\n #ifdef Q_OS_MAC\n-    (m_node.isInitialBlockDownload() || m_node.getReindex() || m_node.getImporting()) ? m_app_nap_inhibitor->disableAppNap() : m_app_nap_inhibitor->enableAppNap();\n+    m_app_nap_inhibitor->setAppNapEnabled(!m_node.isInitialBlockDownload());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16145#discussion_r290326155",
      "id" : 290326155,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI5MDMyNjE1NQ==",
      "original_commit_id" : "99547c5d52f53a2dec96b2341cb22ddc80a50d08",
      "original_position" : 5,
      "path" : "src/qt/bitcoingui.cpp",
      "position" : 5,
      "pull_request_review_id" : 245484938,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16145",
      "updated_at" : "2019-06-04T14:28:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/290326155",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16145#discussion_r290326525"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16145"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/290326525"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Also, say goodbye to this ternary.",
      "commit_id" : "6ad4ad286963e06abab7b6c86dda28aa140f643c",
      "created_at" : "2019-06-04T14:29:22Z",
      "diff_hunk" : "@@ -925,7 +925,7 @@ void BitcoinGUI::setNumBlocks(int count, const QDateTime& blockDate, double nVer\n {\n // Disabling macOS App Nap on initial sync, disk and reindex operations.\n #ifdef Q_OS_MAC\n-    (m_node.isInitialBlockDownload() || m_node.getReindex() || m_node.getImporting()) ? m_app_nap_inhibitor->disableAppNap() : m_app_nap_inhibitor->enableAppNap();\n+    m_app_nap_inhibitor->setAppNapEnabled(!m_node.isInitialBlockDownload());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16145#discussion_r290326525",
      "id" : 290326525,
      "in_reply_to_id" : 290326155,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI5MDMyNjUyNQ==",
      "original_commit_id" : "99547c5d52f53a2dec96b2341cb22ddc80a50d08",
      "original_position" : 5,
      "path" : "src/qt/bitcoingui.cpp",
      "position" : 5,
      "pull_request_review_id" : 245485413,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16145",
      "updated_at" : "2019-06-04T14:29:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/290326525",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#16367](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16367.html) (Multiprocess build support by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-06-04T16:20:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16145#issuecomment-498742509",
      "id" : 498742509,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16145",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ5ODc0MjUwOQ==",
      "updated_at" : "2019-07-24T03:00:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/498742509",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2019-06-04T20:10:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16145#issuecomment-498824224",
      "id" : 498824224,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16145",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ5ODgyNDIyNA==",
      "updated_at" : "2019-06-04T20:10:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/498824224",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2019-06-10T02:11:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16145#issuecomment-500269173",
      "id" : 500269173,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16145",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwMDI2OTE3Mw==",
      "updated_at" : "2019-06-10T02:11:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/500269173",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, but I'm having difficulty reliably producing this stuff. So let's make sure this actually works as advertised.\r\n\r\nFrom the Apple Doc, it's important to note that this does not impact \"forced sleep\":\r\n\r\n> Forced sleep occurs when the user takes some sort of direct action to cause the machine to sleep. Closing the lid on a laptop or selecting sleep from the Apple menu both cause forced sleep. The system will also induce forced sleep under certain conditions, for example, a thermal emergency or a low battery.\r\nIdle sleep occurs when the machine is unused for a specific period of time configured in the Energy Saver System Preferences.\r\n\r\nSome hints for testing:\r\n\r\n* use `pmset -g` and `pmgset -g log` ([background info](https://eclecticlight.co/2017/01/20/power-management-in-detail-using-pmset/))\r\n* keep an eye on `(sleep prevented by sharingd)`, you may want to turn off BlueTooth (and ActivityMontor?)\r\n* the network tab can be deceptive, the log file shows gaps more clearly\r\n* `disksleep` (e.g. 10 minutes) is probably the most relevant setting\r\n* I'm not sure how `tcpkeepalive` (e.g. 1 minute) plays into things, IBD usually isn't idle that long\r\n* you can configure a hot corner to turn your display off\r\n\r\nI tested in battery mode and set `disksleep` to 1 minute. I started QT without the PR and let it sync a little bit on a fresh datadir. I moved the app as well as the log Console to the background. I then used the hot corner to turn off the display, and waited 5 minutes. This results in a 4 minute gap in the log, as expected.\r\n\r\nIn other other attempts there was no gap, so maybe it was because I didn't have QT / Console in the background, or something else on my system was interfering.\r\n\r\nI then ran with this PR. I don't see a \"sleep prevented by\" entry in `pmset -g`, but that's perhaps expected. I again turned off the display, and there was a gap.\r\n\r\nPerhaps the hot corner counts as \"forced sleep\". But if I just let the screen go idle, I also get a gap in the log.\r\n\r\nNotably I don't see \"Downloading blockchain\" or even \"bitcoin-qt\" in the `pmset -g log` log.",
      "created_at" : "2019-06-26T02:36:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16145#issuecomment-505693732",
      "id" : 505693732,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16145",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwNTY5MzczMg==",
      "updated_at" : "2019-06-26T02:36:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/505693732",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   }
]
