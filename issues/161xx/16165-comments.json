[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The wiki page mentions \"address types\" lots of places. Can it be updated to clarify specifically what the address types are in each context? I can't figure out which places it is referring to legacy/bech32/p2sh segwit types, or change / non-change types, or both.",
      "created_at" : "2019-06-07T13:32:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16165#issuecomment-499885887",
      "id" : 499885887,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16165",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ5OTg4NTg4Nw==",
      "updated_at" : "2019-06-07T13:32:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/499885887",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@ryanofsky there would be option for all six combinations of change/address. They might all point to the same SPKManager, or all different.",
      "created_at" : "2019-06-07T13:51:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16165#issuecomment-499892734",
      "id" : 499892734,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16165",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ5OTg5MjczNA==",
      "updated_at" : "2019-06-07T14:47:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/499892734",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/meshcollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/meshcollider/followers",
         "following_url" : "https://api.github.com/users/meshcollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/meshcollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/meshcollider",
         "id" : 3211283,
         "login" : "meshcollider",
         "node_id" : "MDQ6VXNlcjMyMTEyODM=",
         "organizations_url" : "https://api.github.com/users/meshcollider/orgs",
         "received_events_url" : "https://api.github.com/users/meshcollider/received_events",
         "repos_url" : "https://api.github.com/users/meshcollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/meshcollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/meshcollider"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks, and concept ACK from me! I think the design description is clear and seems workable. The [prerequisites](https://github.com/bitcoin-core/bitcoin-devwiki/wiki/Wallet-Class-Structure-Changes#prerequisites) section of the page is probably the weakest part and might be confusing to anyone who didn't overhear achow and meshcollider debating it. But it's less important because it's only describing temporary steps.\r\n\r\n@sipa, it's probably be good if you could read the wiki page and provide basic feedback. Like whether it seems fine, or has any obvious problems. And whether it's clear, or are has parts that are confusing or ambiguous.",
      "created_at" : "2019-06-11T18:55:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16165#issuecomment-500976691",
      "id" : 500976691,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16165",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwMDk3NjY5MQ==",
      "updated_at" : "2019-06-11T18:55:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/500976691",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "It might be worth incorporating information from sipa's wallet_and_segwit.md gist https://gist.github.com/sipa/125cfa1615946d0c3f3eec2ad7f250a2 to the new document. Or linking to it. Or updating it and making it a wiki page of its own.",
      "created_at" : "2019-06-12T17:50:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16165#issuecomment-501384411",
      "id" : 501384411,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16165",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwMTM4NDQxMQ==",
      "updated_at" : "2019-06-12T17:50:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/501384411",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think a lot of things in the wiki page cover stuff discussed in that gist. I've added a link to it in the wiki page.",
      "created_at" : "2019-06-12T19:24:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16165#issuecomment-501421345",
      "id" : 501421345,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16165",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwMTQyMTM0NQ==",
      "updated_at" : "2019-06-12T19:24:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/501421345",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.\r\n\r\nI'm not sure that ScriptPubKeyManager needs to inherit SigningProvider directly; doing so may require having a lot of information permanently cached (in order to be able to derive all scripts on the fly, for example).\r\n\r\nAn alternative is to have the box directly expose an IsMine(scriptPubKey) function, but instead of directly implementing SigningProvider, have it expose a GetSigningProvider(scriptPubKey), which would (for descriptor wallets) look up which index the scriptPubKey is constructed with (using the same precomputed table as IsMine uses), and then populate a FlatSigningProvider with just the keys/scripts necessary for that index.",
      "created_at" : "2019-06-18T21:55:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16165#issuecomment-503327032",
      "id" : 503327032,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16165",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwMzMyNzAzMg==",
      "updated_at" : "2019-06-18T22:00:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/503327032",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I think inheritance is over abused in general, so Concept ACK since we are getting rid of inheritance layers. Passing interfaces around is all you really need for 99% of use cases, otherwise you tend to have uncompositional and complect code because your design gets tangled in the inheritance hierarchy.",
      "created_at" : "2019-06-19T18:07:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16165#issuecomment-503669399",
      "id" : 503669399,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16165",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwMzY2OTM5OQ==",
      "updated_at" : "2019-06-19T18:11:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/503669399",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2019-06-19T20:23:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16165#issuecomment-503732577",
      "id" : 503732577,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16165",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwMzczMjU3Nw==",
      "updated_at" : "2019-06-19T20:23:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/503732577",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "From the Wallet-Class-Structure-Changes document:\r\n\r\n> The inheritance chain from SigningProvider should be condensed and the scopes slightly changed\r\n...\r\n> SigningProvider -> CBasicKeyStore (renamed) -> CWallet\r\n\r\nAny thoughts on using composition of `CBasicKeyStore (renamed)` over inheritance by making `CBasicKeyStore (renamed)` a member of `CWallet` that is owned by `CWallet`? \r\n\r\nUsing composition over inheritance feels like a much better design (but it could be that I am missing key design considerations to keep the inheritance).\r\n\r\n",
      "created_at" : "2019-06-30T11:05:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16165#issuecomment-507027227",
      "id" : 507027227,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16165",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwNzAyNzIyNw==",
      "updated_at" : "2019-06-30T11:05:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/507027227",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13120787?v=4",
         "events_url" : "https://api.github.com/users/l2a5b1/events{/privacy}",
         "followers_url" : "https://api.github.com/users/l2a5b1/followers",
         "following_url" : "https://api.github.com/users/l2a5b1/following{/other_user}",
         "gists_url" : "https://api.github.com/users/l2a5b1/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/l2a5b1",
         "id" : 13120787,
         "login" : "l2a5b1",
         "node_id" : "MDQ6VXNlcjEzMTIwNzg3",
         "organizations_url" : "https://api.github.com/users/l2a5b1/orgs",
         "received_events_url" : "https://api.github.com/users/l2a5b1/received_events",
         "repos_url" : "https://api.github.com/users/l2a5b1/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/l2a5b1/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/l2a5b1/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/l2a5b1"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> An alternative is to have the box directly expose an IsMine(scriptPubKey) function, but instead of directly implementing SigningProvider, have it expose a GetSigningProvider(scriptPubKey), which would (for descriptor wallets) look up which index the scriptPubKey is constructed with (using the same precomputed table as IsMine uses), and then populate a FlatSigningProvider with just the keys/scripts necessary for that index.\r\n\r\nI've decided to go with this approach. `ScriptPubKeyMan` will not inherit anything.",
      "created_at" : "2019-07-05T22:27:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16165#issuecomment-508873325",
      "id" : 508873325,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16165",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwODg3MzMyNQ==",
      "updated_at" : "2019-07-05T22:27:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/508873325",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Concept ACK. Love this design direction which makes things more modular and gets rid of inheritance hell.\r\n\r\nI have a few questions. From the proposal:\r\n> At the end of this refactoring, the stack will be:\r\n> SigningProvider -> CBasicKeyStore (renamed) -> CWallet\r\n\r\nAlso:\r\n> CWallet will need to be standalone\r\n> there is no need for CWallet to be a SigningProvider\r\n\r\nSo if CWallet \"is-NOT-a\" SigningProvider, then why have it as part of the inheritance tree at all? \r\n\r\nTaking it further, could we maybe get rid of this inheritance tree altogether by either (a) merging CBasicKeyStore into SigningProvider, just like what @achow101 is proposing for CKeyStore? or (b) converting it to a \"has-a\" relationship? So a SigningProvider could have a CBasicKeyStore to help manage its own keys. But a CBasicKeyStore is-NOT-a SigningProvider (which makes more sense to me, it's not intuitive that a KeyStore is also a SigningProvider).\r\n\r\n(a) makes more sense if a KeyStore always has to be a part of a SigningProvider (and nowhere else). (b) makes more sense if a stand-alone KeyStore could be a useful thing, without the ability to sign.\r\n\r\nIn general, I think most of the class relationships modeled here sound like classic has-a, not is-a relationships.\r\n\r\n",
      "created_at" : "2019-07-10T14:20:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16165#issuecomment-510081976",
      "id" : 510081976,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16165",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxMDA4MTk3Ng==",
      "updated_at" : "2019-07-10T14:36:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/510081976",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/4769925?v=4",
         "events_url" : "https://api.github.com/users/hugohn/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hugohn/followers",
         "following_url" : "https://api.github.com/users/hugohn/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hugohn/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hugohn",
         "id" : 4769925,
         "login" : "hugohn",
         "node_id" : "MDQ6VXNlcjQ3Njk5MjU=",
         "organizations_url" : "https://api.github.com/users/hugohn/orgs",
         "received_events_url" : "https://api.github.com/users/hugohn/received_events",
         "repos_url" : "https://api.github.com/users/hugohn/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hugohn/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hugohn/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hugohn"
      }
   }
]
