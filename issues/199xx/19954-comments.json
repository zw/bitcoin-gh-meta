[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This builds on top of #19031, adding one more commit to complete the [TORv3 puzzle](https://github.com/bitcoin/bitcoin/issues/18884). The dependency to #19031 is because if we create a TORv3 hidden service before #19031 is merged we will not be able to advertise it by gossiping. So, this PR is draft until all of #19031 is merged. Available for early review and testing.",
      "created_at" : "2020-09-14T13:46:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-692063434",
      "id" : 692063434,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MjA2MzQzNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-14T13:49:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/692063434",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r488028133"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488028133"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Linter fails on missing newline here.\r\n```\r\n$ test/lint/lint-logs.sh\r\nAll calls to LogPrintf() and LogPrint() should be terminated with \\n\r\n```",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-14T15:33:21Z",
      "diff_hunk" : "@@ -464,10 +466,23 @@ TorController::TorController(struct event_base* _base, const std::string& _targe\n         LogPrintf(\"tor: Initiating connection to Tor control port %s failed\\n\", _target);\n     }\n     // Read service private key if cached\n-    std::pair<bool,std::string> pkf = ReadBinaryFile(GetPrivateKeyFile());\n-    if (pkf.first) {\n-        LogPrint(BCLog::TOR, \"tor: Reading cached private key from %s\\n\", GetPrivateKeyFile().string());\n-        private_key = pkf.second;\n+    bool read_ok;\n+    std::tie(read_ok, private_key) = ReadBinaryFile(GetPrivateKeyFile());\n+    if (!read_ok) {\n+        return;\n+    }\n+    LogPrint(BCLog::TOR, \"tor: Read cached private key from %s\\n\", GetPrivateKeyFile().string());\n+\n+    // Check if we have an old TORv2 (RSA1024) private key cached and if so move it\n+    // away and assume empty key so that TorController::auth_cb() can create a new\n+    // TORv3 (ED25519-V3) one.\n+    static const char torv2_key_prefix[] = \"RSA1024:\";\n+    if (private_key.substr(0, strlen(torv2_key_prefix)) == torv2_key_prefix) {\n+        auto obsolete_key_file = GetPrivateKeyFile().string() + \"_obsolete_torv2\";\n+        LogPrint(BCLog::TOR, \"tor: Detected an obsolete TORv2 private key, will move it \"\n+                             \"to %s and will create new TORv3 one\\n\", obsolete_key_file);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r488028133",
      "id" : 488028133,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAyODEzMw==",
      "original_commit_id" : "9c9ff0a8c40421b43922a6b211f99b6aaf94a798",
      "original_line" : 483,
      "original_position" : 36,
      "original_start_line" : null,
      "path" : "src/torcontrol.cpp",
      "position" : null,
      "pull_request_review_id" : 487897429,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488028133",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r488055752"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488055752"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: gossiping",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-14T16:13:17Z",
      "diff_hunk" : "@@ -76,6 +76,19 @@ extern const char* VERACK;\n  * network.\n  */\n extern const char* ADDR;\n+/**\n+ * The addrv2 message relays connection information for peers on the network just\n+ * like the addr message, but is extended to allow gossipping of longer node",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r488055752",
      "id" : 488055752,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA1NTc1Mg==",
      "original_commit_id" : "a1b067e0896d5f8a639364494a5707bd536b99f1",
      "original_line" : 81,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : null,
      "pull_request_review_id" : 487933729,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488055752",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r488057593"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488057593"
         }
      },
      "author_association" : "MEMBER",
      "body" : "s/who has indicated ADDRv2 support (has sent SENDADDRV2 himself)/that has signaled ADDRv2 support by sending SENDADDRv2./",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-14T16:15:57Z",
      "diff_hunk" : "@@ -76,6 +76,19 @@ extern const char* VERACK;\n  * network.\n  */\n extern const char* ADDR;\n+/**\n+ * The addrv2 message relays connection information for peers on the network just\n+ * like the addr message, but is extended to allow gossipping of longer node\n+ * addresses (see BIP155).\n+ */\n+extern const char *ADDRv2;\n+/**\n+ * The sendaddrv2 message signals support for receiving ADDRv2 messages (BIP155).\n+ * It also implies that its sender can encode as ADDRv2 and would send ADDRv2\n+ * instead of ADDR to a peer who has indicated ADDRv2 support (has sent\n+ * SENDADDRv2 himself).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r488057593",
      "id" : 488057593,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODA1NzU5Mw==",
      "original_commit_id" : "a1b067e0896d5f8a639364494a5707bd536b99f1",
      "original_line" : 89,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : null,
      "pull_request_review_id" : 487933729,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488057593",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Can we also add the option to delete `onion_private_key` and `onion_private_key_obsolete_torv2`automatically every time bitcoind is restarted? So that it gets new address each time.\r\n\r\nOr is it something out of scope for this PR and will need a new issue or PR to discuss?",
      "created_at" : "2020-09-14T17:45:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-692210055",
      "id" : 692210055,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MjIxMDA1NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-14T17:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/692210055",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13405205?v=4",
         "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prayank23/followers",
         "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prayank23",
         "id" : 13405205,
         "login" : "prayank23",
         "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
         "organizations_url" : "https://api.github.com/users/prayank23/orgs",
         "received_events_url" : "https://api.github.com/users/prayank23/received_events",
         "repos_url" : "https://api.github.com/users/prayank23/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prayank23"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@prayank23 It can take a (very) long time for a node's rumoured address to be picked up, especially Tor ones. Getting a new one every time you restart your node is probably a good way to never get any incoming connections at all.\n\nIt may be useful as an optional feature, but seems out of scope here.",
      "created_at" : "2020-09-14T17:47:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-692211498",
      "id" : 692211498,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MjIxMTQ5OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-14T17:48:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/692211498",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@prayank23\r\n>  Can we also add the option to delete `onion_private_key` and `onion_private_key_obsolete_torv2`automatically every time bitcoind is restarted? So that it gets new address each time.\r\n\r\n> \r\ntyi; #19635 we probably will need that in some form for v3 anyway.  \r\n\r\n\r\n",
      "created_at" : "2020-09-14T18:32:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-692235271",
      "id" : 692235271,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MjIzNTI3MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-14T18:32:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/692235271",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/34917548?v=4",
         "events_url" : "https://api.github.com/users/Saibato/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Saibato/followers",
         "following_url" : "https://api.github.com/users/Saibato/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Saibato/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Saibato",
         "id" : 34917548,
         "login" : "Saibato",
         "node_id" : "MDQ6VXNlcjM0OTE3NTQ4",
         "organizations_url" : "https://api.github.com/users/Saibato/orgs",
         "received_events_url" : "https://api.github.com/users/Saibato/received_events",
         "repos_url" : "https://api.github.com/users/Saibato/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Saibato/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Saibato/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Saibato"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thinking about migration, as a follow-up before release we may need a temporary configuration option to use tor v2/v3. \n\nPerhaps begin with v3 as opt-in, then in the following release look at making it the default.",
      "created_at" : "2020-09-15T06:06:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-692487080",
      "id" : 692487080,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MjQ4NzA4MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-15T06:06:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/692487080",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r488870384"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488870384"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'd slightly prefer creating a new file for v3 instead of moving the old one. This makes it easier to go back and forth to test this (as well as downgrade, when this becomes part of a release).\r\n\r\nIt also makes for amore straightforward path to both v2 and v3 hidden services (as @jonatack suggests).",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-15T18:16:30Z",
      "diff_hunk" : "@@ -57,6 +57,7 @@ Subdirectory       | File(s)               | Description\n `./`               | `guisettings.ini.bak` | Backup of former [GUI settings](#gui-settings) after `-resetguisettings` option is used\n `./`               | `mempool.dat`         | Dump of the mempool's transactions\n `./`               | `onion_private_key`   | Cached Tor onion service private key for `-listenonion` option\n+`./`               | `onion_private_key_obsolete_torv2` | Obsolete Tor onion service private key used to create TORv2 hidden services. This file is automatically created as a backup when new TORv3 private key is generated and saved into `onion_private_key`. Bitcoin Core does not need it and will never attempt to read it. Remove if you do not need the old TORv2 hidden service.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r488870384",
      "id" : 488870384,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg3MDM4NA==",
      "original_commit_id" : "9c9ff0a8c40421b43922a6b211f99b6aaf94a798",
      "original_line" : 60,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "doc/files.md",
      "position" : null,
      "pull_request_review_id" : 488944513,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488870384",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@prayank23 \r\n\r\n> Can we also add the option to delete onion_private_key and onion_private_key_obsolete_torv2automatically every time bitcoind is restarted? So that it gets new address each time.\r\n\r\nYes, but out of scope here. There's an issue for this already: #17491.",
      "created_at" : "2020-09-15T18:18:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-692889834",
      "id" : 692889834,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5Mjg4OTgzNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-15T21:30:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/692889834",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@laanwj \r\n> I'd slightly prefer creating a new file for v3 instead \r\n\r\n@vasild \r\nFeel free to grab there, then i can close that PR \r\n\r\nhttps://github.com/bitcoin/bitcoin/pull/19485\r\n\r\n ",
      "created_at" : "2020-09-15T19:29:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-692929925",
      "id" : 692929925,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MjkyOTkyNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-15T19:31:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/692929925",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/34917548?v=4",
         "events_url" : "https://api.github.com/users/Saibato/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Saibato/followers",
         "following_url" : "https://api.github.com/users/Saibato/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Saibato/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Saibato",
         "id" : 34917548,
         "login" : "Saibato",
         "node_id" : "MDQ6VXNlcjM0OTE3NTQ4",
         "organizations_url" : "https://api.github.com/users/Saibato/orgs",
         "received_events_url" : "https://api.github.com/users/Saibato/received_events",
         "repos_url" : "https://api.github.com/users/Saibato/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Saibato/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Saibato/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Saibato"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "utACK 9c9ff0a8c40421b43922a6b211f99b6aaf94a798. Light code review, code looks great, apart from several uses of `char name[1025]` which seem a bit clunky (oops, just noticed this nit was a refactor and not an addition, am okay with no change). Will need to fire up a test build. Nice work!",
      "created_at" : "2020-09-16T07:05:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-693216828",
      "id" : 693216828,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MzIxNjgyOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-16T07:08:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/693216828",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/8435003?v=4",
         "events_url" : "https://api.github.com/users/tryphe/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tryphe/followers",
         "following_url" : "https://api.github.com/users/tryphe/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tryphe/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tryphe",
         "id" : 8435003,
         "login" : "tryphe",
         "node_id" : "MDQ6VXNlcjg0MzUwMDM=",
         "organizations_url" : "https://api.github.com/users/tryphe/orgs",
         "received_events_url" : "https://api.github.com/users/tryphe/received_events",
         "repos_url" : "https://api.github.com/users/tryphe/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tryphe/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tryphe/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tryphe"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, I share Wladimir's preference for \"creating a new file for v3 instead of moving the old one\". Plus it'll make this change even smaller.\r\n\r\n> Perhaps begin with v3 as opt-in, then in the following release look at making it the default.\r\n\r\nGiven that v2 is deprecated I don't think v3 needs to be opt-in, at least not for new users.\r\n\r\nExisting users might rely on a static v2 address, e.g. because they have another node connected to it, or they paired it with some remote control software. Afaik this only applies to bitcoind users, not QT (unless @luke-jr implemented pairing in Knots?). So this change needs some emphasis in the release notes.\r\n\r\nWe could add an (instantly deprecated) option `-listenonion_v2`.",
      "created_at" : "2020-09-17T11:52:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-694180511",
      "id" : 694180511,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NDE4MDUxMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-17T11:54:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/694180511",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r490922645"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490922645"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Fixed.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-18T12:44:01Z",
      "diff_hunk" : "@@ -76,6 +76,19 @@ extern const char* VERACK;\n  * network.\n  */\n extern const char* ADDR;\n+/**\n+ * The addrv2 message relays connection information for peers on the network just\n+ * like the addr message, but is extended to allow gossipping of longer node",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r490922645",
      "id" : 490922645,
      "in_reply_to_id" : 488055752,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDkyMjY0NQ==",
      "original_commit_id" : "a1b067e0896d5f8a639364494a5707bd536b99f1",
      "original_line" : 81,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : null,
      "pull_request_review_id" : 491429443,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490922645",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r490922857"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490922857"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Changed.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-18T12:44:23Z",
      "diff_hunk" : "@@ -76,6 +76,19 @@ extern const char* VERACK;\n  * network.\n  */\n extern const char* ADDR;\n+/**\n+ * The addrv2 message relays connection information for peers on the network just\n+ * like the addr message, but is extended to allow gossipping of longer node\n+ * addresses (see BIP155).\n+ */\n+extern const char *ADDRv2;\n+/**\n+ * The sendaddrv2 message signals support for receiving ADDRv2 messages (BIP155).\n+ * It also implies that its sender can encode as ADDRv2 and would send ADDRv2\n+ * instead of ADDR to a peer who has indicated ADDRv2 support (has sent\n+ * SENDADDRv2 himself).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r490922857",
      "id" : 490922857,
      "in_reply_to_id" : 488057593,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDkyMjg1Nw==",
      "original_commit_id" : "a1b067e0896d5f8a639364494a5707bd536b99f1",
      "original_line" : 89,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : null,
      "pull_request_review_id" : 491429688,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490922857",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r490923255"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490923255"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Deleted this code altogether.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-18T12:45:03Z",
      "diff_hunk" : "@@ -464,10 +466,23 @@ TorController::TorController(struct event_base* _base, const std::string& _targe\n         LogPrintf(\"tor: Initiating connection to Tor control port %s failed\\n\", _target);\n     }\n     // Read service private key if cached\n-    std::pair<bool,std::string> pkf = ReadBinaryFile(GetPrivateKeyFile());\n-    if (pkf.first) {\n-        LogPrint(BCLog::TOR, \"tor: Reading cached private key from %s\\n\", GetPrivateKeyFile().string());\n-        private_key = pkf.second;\n+    bool read_ok;\n+    std::tie(read_ok, private_key) = ReadBinaryFile(GetPrivateKeyFile());\n+    if (!read_ok) {\n+        return;\n+    }\n+    LogPrint(BCLog::TOR, \"tor: Read cached private key from %s\\n\", GetPrivateKeyFile().string());\n+\n+    // Check if we have an old TORv2 (RSA1024) private key cached and if so move it\n+    // away and assume empty key so that TorController::auth_cb() can create a new\n+    // TORv3 (ED25519-V3) one.\n+    static const char torv2_key_prefix[] = \"RSA1024:\";\n+    if (private_key.substr(0, strlen(torv2_key_prefix)) == torv2_key_prefix) {\n+        auto obsolete_key_file = GetPrivateKeyFile().string() + \"_obsolete_torv2\";\n+        LogPrint(BCLog::TOR, \"tor: Detected an obsolete TORv2 private key, will move it \"\n+                             \"to %s and will create new TORv3 one\\n\", obsolete_key_file);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r490923255",
      "id" : 490923255,
      "in_reply_to_id" : 488028133,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDkyMzI1NQ==",
      "original_commit_id" : "9c9ff0a8c40421b43922a6b211f99b6aaf94a798",
      "original_line" : 483,
      "original_position" : 36,
      "original_start_line" : null,
      "path" : "src/torcontrol.cpp",
      "position" : null,
      "pull_request_review_id" : 491430132,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490923255",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r490923656"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490923656"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Indeed. Done!",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-18T12:45:45Z",
      "diff_hunk" : "@@ -57,6 +57,7 @@ Subdirectory       | File(s)               | Description\n `./`               | `guisettings.ini.bak` | Backup of former [GUI settings](#gui-settings) after `-resetguisettings` option is used\n `./`               | `mempool.dat`         | Dump of the mempool's transactions\n `./`               | `onion_private_key`   | Cached Tor onion service private key for `-listenonion` option\n+`./`               | `onion_private_key_obsolete_torv2` | Obsolete Tor onion service private key used to create TORv2 hidden services. This file is automatically created as a backup when new TORv3 private key is generated and saved into `onion_private_key`. Bitcoin Core does not need it and will never attempt to read it. Remove if you do not need the old TORv2 hidden service.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r490923656",
      "id" : 490923656,
      "in_reply_to_id" : 488870384,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDkyMzY1Ng==",
      "original_commit_id" : "9c9ff0a8c40421b43922a6b211f99b6aaf94a798",
      "original_line" : 60,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "doc/files.md",
      "position" : null,
      "pull_request_review_id" : 491430653,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490923656",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased on latest #19031 and addressed suggestions.\r\n\r\nIndeed creating a new file for the new TORv3 private key seems like a better idea. It also opens up a possibility for the users to continue using the old TORv2 service if needed by copying the contents of the old file to the new file.\r\n\r\nI think Bitcoin Core automatically creating just one Tor service is enough (that will be v3). If more complicated setup is needed, then the users can create static services in the Tor daemon - e.g. it is possible to create 5 TORv2 services and 7 TORv3 services all pointing to the same Bitcoin Core.",
      "created_at" : "2020-09-18T12:59:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-694852846",
      "id" : 694852846,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NDg1Mjg0Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-18T12:59:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/694852846",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Practical testing of this PR with various Tor configuration options by and between @vasild and I today. Will review this weekend.",
      "created_at" : "2020-09-18T18:15:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-695014269",
      "id" : 695014269,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NTAxNDI2OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-18T18:17:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/695014269",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19889 (test: Add consistent formatting for messages.py repr methods by adaminsky)\n* #19315 ([tests] Allow outbound & block-relay-only connections in functional tests. by amitiuttarwar)\n* #19238 (refactor: Replace RecursiveMutex with Mutex in CAddrMan by hebasto)\n* #18788 (tests: Update more tests to work with descriptor wallets by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-09-19T13:33:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-695214133",
      "id" : 695214133,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NTIxNDEzMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-02T20:13:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/695214133",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r492108245"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/492108245"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: add `{`",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-21T14:49:11Z",
      "diff_hunk" : "@@ -533,7 +533,7 @@ void TorController::auth_cb(TorControlConnection& _conn, const TorControlReply&\n \n         // Finally - now create the service\n         if (private_key.empty()) // No private key, generate one",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r492108245",
      "id" : 492108245,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjEwODI0NQ==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 535,
      "original_position" : 3,
      "original_start_line" : null,
      "path" : "src/torcontrol.cpp",
      "position" : null,
      "pull_request_review_id" : 492690290,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/492108245",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I think Bitcoin Core automatically creating just one Tor service is enough (that will be v3). \r\n\r\nThe only worry here would be that old nodes will run out of Tor nodes to connect to. But I don't know. I'm okay with this, it seems there's enough hurry to transition here that backwards compatibility concerns like that are mostly moot.\r\n\r\nEdit: a related concern is that we should start hardcoding TorV3 peers. No need to do so in this PR though. Made a note about this in #17020.",
      "created_at" : "2020-09-23T12:11:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-697322694",
      "id" : 697322694,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NzMyMjY5NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-23T12:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/697322694",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r493521433"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/493521433"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe move this line to `## Legacy subdirectories and files`, if we're no longer going to spin up a v2 service.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-23T12:19:32Z",
      "diff_hunk" : "@@ -56,7 +56,8 @@ Subdirectory       | File(s)               | Description\n `./`               | `fee_estimates.dat`   | Stores statistics used to estimate minimum transaction fees and priorities required for confirmation\n `./`               | `guisettings.ini.bak` | Backup of former [GUI settings](#gui-settings) after `-resetguisettings` option is used\n `./`               | `mempool.dat`         | Dump of the mempool's transactions\n-`./`               | `onion_private_key`   | Cached Tor onion service private key for `-listenonion` option\n+`./`               | `onion_private_key`   | Obsolete: cached Tor onion service private key for `-listenonion` option. Was used for TORv2 services. Bitcoin Core does not need this file and ignores it starting from version 0.21.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r493521433",
      "id" : 493521433,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzUyMTQzMw==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 59,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "doc/files.md",
      "position" : null,
      "pull_request_review_id" : 494597269,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/493521433",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r493535027"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/493535027"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good, looks ilke we already have an implementation of `be16toh` in `src/compat/endian.h`, so it doesn't need to be added.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-23T12:34:08Z",
      "diff_hunk" : "@@ -53,6 +53,13 @@ void static inline WriteLE64(unsigned char* ptr, uint64_t x)\n     memcpy(ptr, (char*)&v, 8);\n }\n \n+uint16_t static inline ReadBE16(const unsigned char* ptr)\n+{\n+    uint16_t x;\n+    memcpy((char*)&x, ptr, 2);\n+    return be16toh(x);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r493535027",
      "id" : 493535027,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzUzNTAyNw==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 60,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/crypto/common.h",
      "position" : null,
      "pull_request_review_id" : 494609645,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/493535027",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r494932190"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/494932190"
         }
      },
      "author_association" : "MEMBER",
      "body" : "1550aa8 suggestions\r\n\r\n- s/TOR/Tor / throughout, e.g. TORv2 -> Tor v2 -- the Tor project even tweeted recently to the community to please write \"Tor\" rather than \"TOR\"\r\n\r\n- s/will be now/will now be/\r\n\r\n- s/Bitcoin Core will not attempt to read it anymore/Bitcoin Core will no longer attempt to read it/ (or \"will henceforth ignore it\")\r\n\r\n- s/If using the old TORv2 service is desirable/To use the deprecated Tor v2 service/ (prefer active voice to passive voice)\r\n\r\n- maybe mention that these cookie auth files are located in the `.bitcoin` directory\r\n\r\n- \"can be copied over\" is unclear (to me)\r\n",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-25T11:44:42Z",
      "diff_hunk" : "@@ -74,6 +74,14 @@ P2P and network changes\n   node using P2P relay. This version reduces the initial broadcast guarantees\n   for wallet transactions submitted via P2P to a node running the wallet. (#18038)\n \n+- The TOR hidden service that is automatically created (`-listenonion`) will be\n+  now created as a TORv3 service instead of TORv2. The private key that was used\n+  for TORv2 (if any) will be left untouched in `onion_private_key` and can be\n+  removed if not needed. Bitcoin Core will not attempt to read it anymore. The\n+  private key for the TORv3 service will be saved in `onion_private_key_torv3`.\n+  If using the old TORv2 service is desirable (not recommended), then\n+  `onion_private_key` can be copied over `onion_private_key_torv3`.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r494932190",
      "id" : 494932190,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDkzMjE5MA==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 83,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "doc/release-notes.md",
      "position" : null,
      "pull_request_review_id" : 496345797,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/494932190",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r494934753"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/494934753"
         }
      },
      "author_association" : "MEMBER",
      "body" : "896a5af style nit, `Format::V3` having the meaning of \"want addrv2\" is somewhat confusing, maybe create a boolean helper function `IsAddrV2Format()` to use both here and line 405 below for the code to be self-explanatory, or use more descriptive enum `Format` names, not sure here.\r\n\r\nIdem for `m_format > Format::V0`, `m_format > Format::V1`,and `m_format >= Format::V2`",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-25T11:50:16Z",
      "diff_hunk" : "@@ -318,8 +329,15 @@ friend class CAddrManTest;\n     {\n         LOCK(cs);\n \n-        unsigned char nVersion = 2;\n-        s << nVersion;\n+        const auto stream_version_orig = s.GetVersion();\n+\n+        if (m_format >= Format::V3) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r494934753",
      "id" : 494934753,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDkzNDc1Mw==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 334,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 496345797,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/494934753",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r494964219"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/494964219"
         }
      },
      "author_association" : "MEMBER",
      "body" : "99047b077 is there test coverage for this new try/catch/Misbehaving/logging unparseable address code? has there been discussion on how much to add to the misbehavior score for this?",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-25T12:49:08Z",
      "diff_hunk" : "@@ -2584,9 +2587,29 @@ void PeerManager::ProcessMessage(CNode& pfrom, const std::string& msg_type, CDat\n         return;\n     }\n \n-    if (msg_type == NetMsgType::ADDR) {\n+    if (msg_type == NetMsgType::ADDR || msg_type == NetMsgType::ADDRv2) {\n+        const auto version_orig = vRecv.GetVersion();\n+        if (msg_type == NetMsgType::ADDRv2) {\n+            // Add ADDRV2_FORMAT to the version so that the CNetAddr and CAddress\n+            // unserialize methods know that an address in v2 format is coming.\n+            vRecv.SetVersion(version_orig | ADDRV2_FORMAT);\n+        }\n         std::vector<CAddress> vAddr;\n-        vRecv >> vAddr;\n+\n+        try {\n+            vRecv >> vAddr;\n+        } catch (const std::exception& e) {\n+            vRecv.SetVersion(version_orig);\n+\n+            LOCK(cs_main);\n+            Misbehaving(pfrom.GetId(), 20,\n+                strprintf(\n+                    \"Supplied us with a message that contains an unparsable address: %s\",\n+                    e.what()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r494964219",
      "id" : 494964219,
      "line" : 2609,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDk2NDIxOQ==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 2609,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 51,
      "pull_request_review_id" : 496345797,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/494964219",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r494966330"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/494966330"
         }
      },
      "author_association" : "MEMBER",
      "body" : "99047b0 covered by a test? ",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-25T12:52:51Z",
      "diff_hunk" : "@@ -2612,6 +2635,11 @@ void PeerManager::ProcessMessage(CNode& pfrom, const std::string& msg_type, CDat\n             if (!MayHaveUsefulAddressDB(addr.nServices) && !HasAllDesirableServiceFlags(addr.nServices))\n                 continue;\n \n+            // Skip invalid addresses, maybe a new BIP155 network id from the future.\n+            if (!addr.IsValid()) {\n+                continue;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r494966330",
      "id" : 494966330,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDk2NjMzMA==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 2640,
      "original_position" : 48,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 496345797,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/494966330",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r494976240"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/494976240"
         }
      },
      "author_association" : "MEMBER",
      "body" : "99047b07 nit, maybe \"gossiping of longer node addresses up to 512 bytes\"",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-25T13:10:37Z",
      "diff_hunk" : "@@ -76,6 +76,18 @@ extern const char* VERACK;\n  * network.\n  */\n extern const char* ADDR;\n+/**\n+ * The addrv2 message relays connection information for peers on the network just\n+ * like the addr message, but is extended to allow gossiping of longer node",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r494976240",
      "id" : 494976240,
      "line" : 81,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDk3NjI0MA==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 81,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : 6,
      "pull_request_review_id" : 496345797,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/494976240",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r494978423"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/494978423"
         }
      },
      "author_association" : "MEMBER",
      "body" : "1550aa8 nits, s/TORv2/Tor v2/ and s/does not need/no longer needs/ (though if you move it to the legacy section, use the \"replaced by\" format instead)",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-25T13:14:22Z",
      "diff_hunk" : "@@ -56,7 +56,8 @@ Subdirectory       | File(s)               | Description\n `./`               | `fee_estimates.dat`   | Stores statistics used to estimate minimum transaction fees and priorities required for confirmation\n `./`               | `guisettings.ini.bak` | Backup of former [GUI settings](#gui-settings) after `-resetguisettings` option is used\n `./`               | `mempool.dat`         | Dump of the mempool's transactions\n-`./`               | `onion_private_key`   | Cached Tor onion service private key for `-listenonion` option\n+`./`               | `onion_private_key`   | Obsolete: cached Tor onion service private key for `-listenonion` option. Was used for TORv2 services. Bitcoin Core does not need this file and ignores it starting from version 0.21.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r494978423",
      "id" : 494978423,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDk3ODQyMw==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 59,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "doc/files.md",
      "position" : null,
      "pull_request_review_id" : 496345797,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/494978423",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r495115151"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/495115151"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Had a look at if this needs a lock; it doesn't seem so.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-25T16:55:53Z",
      "diff_hunk" : "@@ -2637,6 +2665,11 @@ void PeerManager::ProcessMessage(CNode& pfrom, const std::string& msg_type, CDat\n         return;\n     }\n \n+    if (msg_type == NetMsgType::SENDADDRv2) {\n+        pfrom.m_wants_addrv2 = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r495115151",
      "id" : 495115151,
      "line" : 2666,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTExNTE1MQ==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 2666,
      "original_position" : 59,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 73,
      "pull_request_review_id" : 496591006,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/495115151",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> The only worry here would be that old nodes will run out of Tor nodes to connect to. But I don't know. I'm okay with this, it seems there's enough hurry to transition here that backwards compatibility concerns like that are mostly moot.\r\n\r\nMaybe it would be good for the release notes to describe the situation with the planned full removal of v2 by the Tor Project and warn users running older nodes with an onion service that they will have to upgrade within less than a year after the release to v0.21+. It might not need to be in this PR though.",
      "created_at" : "2020-09-25T17:08:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-699045896",
      "id" : 699045896,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5OTA0NTg5Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-25T17:08:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/699045896",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> > I think Bitcoin Core automatically creating just one Tor service is enough (that will be v3).\r\n> \r\n> ... old nodes will run out of Tor nodes to connect to ...\r\n\r\nIf there are `N` old nodes each one of them will be able to connect to the other `N-1`. Only the very last one (when `N=1`) will have nobody to connect to. Also, statically configured Tor v2 services (via `torrc`) will keep operating as long as the Tor network supports them.\r\n\r\nAccording to https://bitnodes.io/nodes/ 37% are running the latest version (0.20.0 or 0.20.1), now, about 2 months before the release of 0.21.",
      "created_at" : "2020-09-28T08:07:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-699850959",
      "id" : 699850959,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5OTg1MDk1OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-28T08:07:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/699850959",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebase on latest #19031",
      "created_at" : "2020-09-28T15:09:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-700068840",
      "id" : 700068840,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMDA2ODg0MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-28T15:09:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700068840",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Address review suggestions.",
      "created_at" : "2020-09-28T15:10:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-700069599",
      "id" : 700069599,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMDA2OTU5OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-28T15:10:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700069599",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r496024495"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/496024495"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-28T15:12:43Z",
      "diff_hunk" : "@@ -533,7 +533,7 @@ void TorController::auth_cb(TorControlConnection& _conn, const TorControlReply&\n \n         // Finally - now create the service\n         if (private_key.empty()) // No private key, generate one",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r496024495",
      "id" : 496024495,
      "in_reply_to_id" : 492108245,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjAyNDQ5NQ==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 535,
      "original_position" : 3,
      "original_start_line" : null,
      "path" : "src/torcontrol.cpp",
      "position" : null,
      "pull_request_review_id" : 497632542,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/496024495",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Address review suggestion.",
      "created_at" : "2020-09-28T15:13:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-700070980",
      "id" : 700070980,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMDA3MDk4MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-28T15:13:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700070980",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r496025807"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/496025807"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-28T15:13:51Z",
      "diff_hunk" : "@@ -56,7 +56,8 @@ Subdirectory       | File(s)               | Description\n `./`               | `fee_estimates.dat`   | Stores statistics used to estimate minimum transaction fees and priorities required for confirmation\n `./`               | `guisettings.ini.bak` | Backup of former [GUI settings](#gui-settings) after `-resetguisettings` option is used\n `./`               | `mempool.dat`         | Dump of the mempool's transactions\n-`./`               | `onion_private_key`   | Cached Tor onion service private key for `-listenonion` option\n+`./`               | `onion_private_key`   | Obsolete: cached Tor onion service private key for `-listenonion` option. Was used for TORv2 services. Bitcoin Core does not need this file and ignores it starting from version 0.21.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r496025807",
      "id" : 496025807,
      "in_reply_to_id" : 493521433,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjAyNTgwNw==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 59,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "doc/files.md",
      "position" : null,
      "pull_request_review_id" : 497633590,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/496025807",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r496027199"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/496027199"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done.\r\n\r\n`cp -f onion_private_key onion_private_key_torv3` is clearer? :)",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-28T15:15:02Z",
      "diff_hunk" : "@@ -74,6 +74,14 @@ P2P and network changes\n   node using P2P relay. This version reduces the initial broadcast guarantees\n   for wallet transactions submitted via P2P to a node running the wallet. (#18038)\n \n+- The TOR hidden service that is automatically created (`-listenonion`) will be\n+  now created as a TORv3 service instead of TORv2. The private key that was used\n+  for TORv2 (if any) will be left untouched in `onion_private_key` and can be\n+  removed if not needed. Bitcoin Core will not attempt to read it anymore. The\n+  private key for the TORv3 service will be saved in `onion_private_key_torv3`.\n+  If using the old TORv2 service is desirable (not recommended), then\n+  `onion_private_key` can be copied over `onion_private_key_torv3`.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r496027199",
      "id" : 496027199,
      "in_reply_to_id" : 494932190,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjAyNzE5OQ==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 83,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "doc/release-notes.md",
      "position" : null,
      "pull_request_review_id" : 497634785,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/496027199",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r496030562"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/496030562"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "AddrMan already had versions on its on-disk database with numbers. So I left the convention as is and just added new version \"3\" since the last one used was \"2\". This has nothing to do with \"addrv2\" or \"torv3\" :)\r\n\r\n`IsAddrV2Format()` would spoil the strict ordering of the AddrMan on-disk versions.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-28T15:18:06Z",
      "diff_hunk" : "@@ -318,8 +329,15 @@ friend class CAddrManTest;\n     {\n         LOCK(cs);\n \n-        unsigned char nVersion = 2;\n-        s << nVersion;\n+        const auto stream_version_orig = s.GetVersion();\n+\n+        if (m_format >= Format::V3) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r496030562",
      "id" : 496030562,
      "in_reply_to_id" : 494934753,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjAzMDU2Mg==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 334,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 497637674,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/496030562",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r496032822"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/496032822"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes! (since the last push with updated tests)\r\n\r\n> has there been discussion on how much to add to the misbehavior score for this?\r\n\r\nI don't think so. It is currently punishing the peer as much as if he sent us an addr message with >1000 addresses. I do not insist on that.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-28T15:20:08Z",
      "diff_hunk" : "@@ -2584,9 +2587,29 @@ void PeerManager::ProcessMessage(CNode& pfrom, const std::string& msg_type, CDat\n         return;\n     }\n \n-    if (msg_type == NetMsgType::ADDR) {\n+    if (msg_type == NetMsgType::ADDR || msg_type == NetMsgType::ADDRv2) {\n+        const auto version_orig = vRecv.GetVersion();\n+        if (msg_type == NetMsgType::ADDRv2) {\n+            // Add ADDRV2_FORMAT to the version so that the CNetAddr and CAddress\n+            // unserialize methods know that an address in v2 format is coming.\n+            vRecv.SetVersion(version_orig | ADDRV2_FORMAT);\n+        }\n         std::vector<CAddress> vAddr;\n-        vRecv >> vAddr;\n+\n+        try {\n+            vRecv >> vAddr;\n+        } catch (const std::exception& e) {\n+            vRecv.SetVersion(version_orig);\n+\n+            LOCK(cs_main);\n+            Misbehaving(pfrom.GetId(), 20,\n+                strprintf(\n+                    \"Supplied us with a message that contains an unparsable address: %s\",\n+                    e.what()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r496032822",
      "id" : 496032822,
      "in_reply_to_id" : 494964219,
      "line" : 2609,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjAzMjgyMg==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 2609,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 51,
      "pull_request_review_id" : 497639580,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/496032822",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r496033072"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/496033072"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes! (since the last push with updated tests)",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-28T15:20:21Z",
      "diff_hunk" : "@@ -2612,6 +2635,11 @@ void PeerManager::ProcessMessage(CNode& pfrom, const std::string& msg_type, CDat\n             if (!MayHaveUsefulAddressDB(addr.nServices) && !HasAllDesirableServiceFlags(addr.nServices))\n                 continue;\n \n+            // Skip invalid addresses, maybe a new BIP155 network id from the future.\n+            if (!addr.IsValid()) {\n+                continue;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r496033072",
      "id" : 496033072,
      "in_reply_to_id" : 494966330,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjAzMzA3Mg==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 2640,
      "original_position" : 48,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 497639774,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/496033072",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r496034538"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/496034538"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I deliberately leave numbers outside of comments - as too much unnecessary details and also could go out of sync if the code is updated and the comment not.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-28T15:21:37Z",
      "diff_hunk" : "@@ -76,6 +76,18 @@ extern const char* VERACK;\n  * network.\n  */\n extern const char* ADDR;\n+/**\n+ * The addrv2 message relays connection information for peers on the network just\n+ * like the addr message, but is extended to allow gossiping of longer node",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r496034538",
      "id" : 496034538,
      "in_reply_to_id" : 494976240,
      "line" : 81,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjAzNDUzOA==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 81,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : 6,
      "pull_request_review_id" : 497640946,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/496034538",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r496034952"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/496034952"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done - \"replaced by ...\"",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-28T15:21:58Z",
      "diff_hunk" : "@@ -56,7 +56,8 @@ Subdirectory       | File(s)               | Description\n `./`               | `fee_estimates.dat`   | Stores statistics used to estimate minimum transaction fees and priorities required for confirmation\n `./`               | `guisettings.ini.bak` | Backup of former [GUI settings](#gui-settings) after `-resetguisettings` option is used\n `./`               | `mempool.dat`         | Dump of the mempool's transactions\n-`./`               | `onion_private_key`   | Cached Tor onion service private key for `-listenonion` option\n+`./`               | `onion_private_key`   | Obsolete: cached Tor onion service private key for `-listenonion` option. Was used for TORv2 services. Bitcoin Core does not need this file and ignores it starting from version 0.21.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r496034952",
      "id" : 496034952,
      "in_reply_to_id" : 494978423,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjAzNDk1Mg==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 59,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "doc/files.md",
      "position" : null,
      "pull_request_review_id" : 497641322,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/496034952",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Ready to move this PR out of Draft status?  Edit: snap!",
      "created_at" : "2020-09-29T08:56:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-700565667",
      "id" : 700565667,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMDU2NTY2Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-29T08:57:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700565667",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Opened for review. This PR supersedes #19031 and completes the TORv3 support.",
      "created_at" : "2020-09-29T08:58:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-700566816",
      "id" : 700566816,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMDU2NjgxNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-29T08:58:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700566816",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.",
      "created_at" : "2020-09-29T09:00:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-700567804",
      "id" : 700567804,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMDU2NzgwNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-29T09:00:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700567804",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r496575638"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/496575638"
         }
      },
      "author_association" : "MEMBER",
      "body" : "e025121c1ca4b86296c6b36386786522bd79a6e1\r\n\r\n```suggestion\r\n        s << static_cast<uint8_t>(m_format);\r\n```",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-29T09:31:35Z",
      "diff_hunk" : "@@ -318,8 +329,15 @@ friend class CAddrManTest;\n     {\n         LOCK(cs);\n \n-        unsigned char nVersion = 2;\n-        s << nVersion;\n+        const auto stream_version_orig = s.GetVersion();\n+\n+        if (m_format >= Format::V3) {\n+            // Add ADDRV2_FORMAT to the version so that the CNetAddr and CAddress\n+            // serialize methods produce an address in v2 format.\n+            s.SetVersion(stream_version_orig | ADDRV2_FORMAT);\n+        }\n+\n+        s << (uint8_t)m_format;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r496575638",
      "id" : 496575638,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjU3NTYzOA==",
      "original_commit_id" : "e025121c1ca4b86296c6b36386786522bd79a6e1",
      "original_line" : 340,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 498284069,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/496575638",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r496579158"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/496579158"
         }
      },
      "author_association" : "MEMBER",
      "body" : "e025121c1ca4b86296c6b36386786522bd79a6e1\r\n```suggestion\r\n        m_format = static_cast<Format>(format_tmp);\r\n```",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-29T09:36:47Z",
      "diff_hunk" : "@@ -376,8 +396,17 @@ friend class CAddrManTest;\n         LOCK(cs);\n \n         Clear();\n-        unsigned char nVersion;\n-        s >> nVersion;\n+\n+        const auto stream_version_orig = s.GetVersion();\n+\n+        uint8_t format_tmp;\n+        s >> format_tmp;\n+        m_format = (Format)format_tmp;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r496579158",
      "id" : 496579158,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjU3OTE1OA==",
      "original_commit_id" : "e025121c1ca4b86296c6b36386786522bd79a6e1",
      "original_line" : 404,
      "original_position" : 67,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 498284069,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/496579158",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Addressed suggestions by @hebasto - always compare `m_format` with `>=` and use `static_cast` instead of C-style cast.",
      "created_at" : "2020-09-30T07:49:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-701224311",
      "id" : 701224311,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMTIyNDMxMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-30T07:49:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/701224311",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r497309187"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/497309187"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-30T07:49:33Z",
      "diff_hunk" : "@@ -376,8 +396,17 @@ friend class CAddrManTest;\n         LOCK(cs);\n \n         Clear();\n-        unsigned char nVersion;\n-        s >> nVersion;\n+\n+        const auto stream_version_orig = s.GetVersion();\n+\n+        uint8_t format_tmp;\n+        s >> format_tmp;\n+        m_format = (Format)format_tmp;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r497309187",
      "id" : 497309187,
      "in_reply_to_id" : 496579158,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzMwOTE4Nw==",
      "original_commit_id" : "e025121c1ca4b86296c6b36386786522bd79a6e1",
      "original_line" : 404,
      "original_position" : 67,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 499167608,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/497309187",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r497309288"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/497309288"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-30T07:49:45Z",
      "diff_hunk" : "@@ -318,8 +329,15 @@ friend class CAddrManTest;\n     {\n         LOCK(cs);\n \n-        unsigned char nVersion = 2;\n-        s << nVersion;\n+        const auto stream_version_orig = s.GetVersion();\n+\n+        if (m_format >= Format::V3) {\n+            // Add ADDRV2_FORMAT to the version so that the CNetAddr and CAddress\n+            // serialize methods produce an address in v2 format.\n+            s.SetVersion(stream_version_orig | ADDRV2_FORMAT);\n+        }\n+\n+        s << (uint8_t)m_format;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r497309288",
      "id" : 497309288,
      "in_reply_to_id" : 496575638,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzMwOTI4OA==",
      "original_commit_id" : "e025121c1ca4b86296c6b36386786522bd79a6e1",
      "original_line" : 340,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 499167734,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/497309288",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "#### Addresses with length > 512 or addresses from one of the BIP155 founding networks (1..6) with wrong length (e.g. IPv4 address with length 5):\r\n\r\nWe throw an exception during unserialize which means that subsequent addresses in the same addrv2 message will not be read and the peer is `Misbehaving()`ed.\r\n\r\n#### Addresses from unknown network id (0 or >= 7), with address length <= 512:\r\n\r\nThose are possibly legit addresses from a future extension of BIP155. We consume the address from the stream and keep parsing subsequent addresses in the same addrv2 message. The unknown address will however not be relayed or added to addrman (it is unserialized as all-0s IPv6 address which is `!IsValid()`).\r\n\r\n#### I2P and CJDNS addresses (BIP155 network ids 5 and 6):\r\n\r\n[Relevant IRC discussion on how to handle those](https://bitcoincore.reviews/19845#l-319). There are concerns whether we should relay or add them to addrman because we can't further verify their validity or check if a node actually exists at that address.\r\n\r\nThe current code actually would [not add such addresses to addrman](https://github.com/bitcoin/bitcoin/blob/1769828684f16b53e5fbf65173f508b9ea1b4b9c/src/net_processing.cpp#L2626-L2628) because they are `!IsReachable()`, so we would not get \"garbage\" in addrman.\r\n\r\nThe current code would however relay such addresses (to 1.5 peers like other `!IsReachable()` addresses).\r\n* This has the downside of garbage gossip traffic. Is it any worse than somebody gossiping garbage IPv6 addresses? Honest nodes don't have a way to verify if there is a node listening on a I2P address (yet). But even now we don't verify if there is a node listening on an address before relaying it.\r\n* The benefit is that once I2P support is added in version 0.2X then older nodes, e.g. 0.21 will relay I2P addresses and help with propagation.\r\n\r\n<details>\r\n<summary>The change to not relay I2P and CJDNS addresses is easy, click here.</summary>\r\n\r\n```diff\r\n--- i/src/net_processing.cpp\r\n+++ w/src/net_processing.cpp\r\n@@ -2643,14 +2643,14 @@ void PeerManager::ProcessMessage(CNode& pfrom, const std::string& msg_type, CDat\r\n             pfrom.AddAddressKnown(addr);\r\n             if (m_banman && (m_banman->IsDiscouraged(addr) || m_banman->IsBanned(addr))) {\r\n                 // Do not process banned/discouraged addresses beyond remembering we received them\r\n                 continue;\r\n             }\r\n             bool fReachable = IsReachable(addr);\r\n-            if (addr.nTime > nSince && !pfrom.fGetAddr && vAddr.size() <= 10 && addr.IsRoutable())\r\n-            {\r\n+            if (addr.nTime > nSince && !pfrom.fGetAddr && vAddr.size() <= 10 &&\r\n+                addr.IsRoutable() && !addr.IsI2P() && !addr.IsCJDNS()) {\r\n                 // Relay to a limited number of other nodes\r\n                 RelayAddress(addr, fReachable, m_connman);\r\n             }\r\n             // Do not store addresses outside our network\r\n             if (fReachable)\r\n                 vAddrOk.push_back(addr);\r\n```\r\n</details>\r\n\r\nWhat are your thoughts?\r\n",
      "created_at" : "2020-09-30T10:34:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-701307791",
      "id" : 701307791,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMTMwNzc5MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-30T10:34:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/701307791",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@vasild \r\n\r\n> Addresses with length > 512 or addresses from one of the BIP155 founding networks (1..6) with wrong length (e.g. IPv4 address with length 5):\r\n> We throw an exception during unserialize which means that subsequent addresses in the same addrv2 message will not be read and the peer is Misbehaving()ed.\r\n\r\nSounds like correct behavior to me. Larger addresses are explicitly forbidden, and can be seen as an indication that the entire message is malformed.\r\n\r\n> Addresses from unknown network id (0 or >= 7), with address length <= 512:\r\n> We consume the address from the stream and keep parsing subsequent addresses in the same addrv2 message. The unknown address will however not be relayed or added to addrman\r\n\r\nSeems good  to me too.\r\n\r\n> The current code would however relay such addresses (to 1.5 peers like other !IsReachable() addresses).\r\n\r\nI'm not sure about this. I'm not sure we should do anything (store, relay) with addresses that we cannot connect to ourselves.\r\nBut as you say this is a broader scope decision. Staying (at least in this PR) with the current behaviour for valid but unreachable addresses doesn't sound unreasonable to me.",
      "created_at" : "2020-09-30T11:40:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-701336262",
      "id" : 701336262,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMTMzNjI2Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-30T14:14:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/701336262",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r497572479"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/497572479"
         }
      },
      "author_association" : "MEMBER",
      "body" : "LGTM",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-30T14:50:00Z",
      "diff_hunk" : "@@ -74,6 +74,14 @@ P2P and network changes\n   node using P2P relay. This version reduces the initial broadcast guarantees\n   for wallet transactions submitted via P2P to a node running the wallet. (#18038)\n \n+- The TOR hidden service that is automatically created (`-listenonion`) will be\n+  now created as a TORv3 service instead of TORv2. The private key that was used\n+  for TORv2 (if any) will be left untouched in `onion_private_key` and can be\n+  removed if not needed. Bitcoin Core will not attempt to read it anymore. The\n+  private key for the TORv3 service will be saved in `onion_private_key_torv3`.\n+  If using the old TORv2 service is desirable (not recommended), then\n+  `onion_private_key` can be copied over `onion_private_key_torv3`.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r497572479",
      "id" : 497572479,
      "in_reply_to_id" : 494932190,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU3MjQ3OQ==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 83,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "doc/release-notes.md",
      "position" : null,
      "pull_request_review_id" : 499515650,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/497572479",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r497573433"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/497573433"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, I understand. Helper functions that replace the various `m_format >= Format::V<n>` may possibly be nice, but opinions can vary and it isn't a blocker.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-30T14:51:12Z",
      "diff_hunk" : "@@ -318,8 +329,15 @@ friend class CAddrManTest;\n     {\n         LOCK(cs);\n \n-        unsigned char nVersion = 2;\n-        s << nVersion;\n+        const auto stream_version_orig = s.GetVersion();\n+\n+        if (m_format >= Format::V3) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r497573433",
      "id" : 497573433,
      "in_reply_to_id" : 494934753,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU3MzQzMw==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 334,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 499516932,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/497573433",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r497574106"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/497574106"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Per https://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines#es49-if-you-must-use-a-cast-use-a-named-cast and *C++ Programming Language 4th Edition*, section 11.5, it might be good to update the next line as well if you retouch.\r\n```diff\r\n         s << static_cast<uint8_t>(m_format);\r\n-        s << ((unsigned char)32);\r\n+        s << static_cast<unsigned char>(32);\r\n```",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-30T14:52:05Z",
      "diff_hunk" : "@@ -318,8 +329,15 @@ friend class CAddrManTest;\n     {\n         LOCK(cs);\n \n-        unsigned char nVersion = 2;\n-        s << nVersion;\n+        const auto stream_version_orig = s.GetVersion();\n+\n+        if (m_format >= Format::V3) {\n+            // Add ADDRV2_FORMAT to the version so that the CNetAddr and CAddress\n+            // serialize methods produce an address in v2 format.\n+            s.SetVersion(stream_version_orig | ADDRV2_FORMAT);\n+        }\n+\n+        s << (uint8_t)m_format;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r497574106",
      "id" : 497574106,
      "in_reply_to_id" : 496575638,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU3NDEwNg==",
      "original_commit_id" : "e025121c1ca4b86296c6b36386786522bd79a6e1",
      "original_line" : 340,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 499517872,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/497574106",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r497578644"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/497578644"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Missing column separator `|`?\r\n```suggestion\r\n`onion_private_key` | Cached Tor onion service private key for `-listenonion` option. Was used for Tor v2 services; replaced by `onion_private_key_torv3` in [0.21.0](https://github.com/bitcoin/bitcoin/blob/master/doc/release-notes/release-notes-0.21.0.md) | [PR #19954](https://github.com/bitcoin/bitcoin/pull/19954)\r\n```",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-30T14:57:33Z",
      "diff_hunk" : "@@ -98,6 +98,7 @@ Path           | Description | Repository notes\n `blkindex.dat` | Blockchain index BDB database; replaced by {`chainstate/`, `blocks/index/`, `blocks/revNNNNN.dat`<sup>[\\[2\\]](#note2)</sup>} in 0.8.0 | [PR #1677](https://github.com/bitcoin/bitcoin/pull/1677)\n `blk000?.dat`  | Block data (custom format, 2 GiB per file); replaced by `blocks/blkNNNNN.dat`<sup>[\\[2\\]](#note2)</sup> in 0.8.0 | [PR #1677](https://github.com/bitcoin/bitcoin/pull/1677)\n `addr.dat`     | Peer IP address BDB database; replaced by `peers.dat` in [0.7.0](https://github.com/bitcoin/bitcoin/blob/master/doc/release-notes/release-notes-0.7.0.md) | [PR #1198](https://github.com/bitcoin/bitcoin/pull/1198), [`928d3a01`](https://github.com/bitcoin/bitcoin/commit/928d3a011cc66c7f907c4d053f674ea77dc611cc)\n+`onion_private_key` | Cached Tor onion service private key for `-listenonion` option. Was used for Tor v2 services; replaced by `onion_private_key_torv3` in [0.21.0](https://github.com/bitcoin/bitcoin/blob/master/doc/release-notes/release-notes-0.21.0.md) [PR #19954](https://github.com/bitcoin/bitcoin/pull/19954)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r497578644",
      "id" : 497578644,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU3ODY0NA==",
      "original_commit_id" : "bb01c77865a565764e4e2f86265afef45506d7d7",
      "original_line" : 101,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "doc/files.md",
      "position" : null,
      "pull_request_review_id" : 499523621,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/497578644",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r497581232"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/497581232"
         }
      },
      "author_association" : "MEMBER",
      "body" : "(`code`) markup inside parentheses; maybe easier to read as: \r\n```suggestion\r\n  , e.g. `cp -f onion_private_key onion_private_key_torv3`.\r\n```",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-30T15:00:39Z",
      "diff_hunk" : "@@ -74,6 +74,15 @@ P2P and network changes\n   node using P2P relay. This version reduces the initial broadcast guarantees\n   for wallet transactions submitted via P2P to a node running the wallet. (#18038)\n \n+- The Tor hidden service that is automatically created (`-listenonion`) will now\n+  be created as a Tor v3 service instead of Tor v2. The private key that was used\n+  for Tor v2 (if any) will be left untouched in `onion_private_key` in `-datadir`\n+  and can be removed if not needed. Bitcoin Core will no longer attempt to read it.\n+  The private key for the Tor v3 service will be saved in `onion_private_key_torv3`.\n+  To use the deprecated Tor v2 service (not recommended), then `onion_private_key`\n+  can be copied over `onion_private_key_torv3`\n+  (`cp -f onion_private_key onion_private_key_torv3`).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r497581232",
      "id" : 497581232,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU4MTIzMg==",
      "original_commit_id" : "bb01c77865a565764e4e2f86265afef45506d7d7",
      "original_line" : 84,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "doc/release-notes.md",
      "position" : null,
      "pull_request_review_id" : 499527127,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/497581232",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r497583701"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/497583701"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should we test for both `msg_addr` and `msg_addrv2`?",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-30T15:03:53Z",
      "diff_hunk" : "@@ -10,7 +10,7 @@\n     CAddress,\n     NODE_NETWORK,\n     NODE_WITNESS,\n-    msg_addr,\n+    msg_addrv2,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r497583701",
      "id" : 497583701,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU4MzcwMQ==",
      "original_commit_id" : "bb01c77865a565764e4e2f86265afef45506d7d7",
      "original_line" : 13,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/p2p_addr_relay.py",
      "position" : null,
      "pull_request_review_id" : 499530501,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/497583701",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r497588719"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/497588719"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nice work on the tests!",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-09-30T15:10:25Z",
      "diff_hunk" : "@@ -2584,9 +2587,29 @@ void PeerManager::ProcessMessage(CNode& pfrom, const std::string& msg_type, CDat\n         return;\n     }\n \n-    if (msg_type == NetMsgType::ADDR) {\n+    if (msg_type == NetMsgType::ADDR || msg_type == NetMsgType::ADDRv2) {\n+        const auto version_orig = vRecv.GetVersion();\n+        if (msg_type == NetMsgType::ADDRv2) {\n+            // Add ADDRV2_FORMAT to the version so that the CNetAddr and CAddress\n+            // unserialize methods know that an address in v2 format is coming.\n+            vRecv.SetVersion(version_orig | ADDRV2_FORMAT);\n+        }\n         std::vector<CAddress> vAddr;\n-        vRecv >> vAddr;\n+\n+        try {\n+            vRecv >> vAddr;\n+        } catch (const std::exception& e) {\n+            vRecv.SetVersion(version_orig);\n+\n+            LOCK(cs_main);\n+            Misbehaving(pfrom.GetId(), 20,\n+                strprintf(\n+                    \"Supplied us with a message that contains an unparsable address: %s\",\n+                    e.what()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r497588719",
      "id" : 497588719,
      "in_reply_to_id" : 494964219,
      "line" : 2609,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU4ODcxOQ==",
      "original_commit_id" : "1550aa82659506ef89db67e482d01f014f6a1977",
      "original_line" : 2609,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 51,
      "pull_request_review_id" : 499537188,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/497588719",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Tested re-ACK bb01c77865a565764e4e2f86265afef45506d7d7\r\n\r\nReviewed the diff since my last review per `git range-diff 301959f 1550aa8 bb01c77`, re-reviewed the changeset, rebuilt, deleted the `onion_private_key_torv3` file from previous testing and relaunched; node seems to be running nominally. The additional tests are great. A few comments above to take or leave; none are blockers.",
      "created_at" : "2020-09-30T15:16:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-701457565",
      "id" : 701457565,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMTQ1NzU2NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-30T15:16:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/701457565",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "~Does `addrv2` code follows https://github.com/bitcoin/bips/pull/967 ?~\r\n\r\nUPDATE: I'v verified that this PR follows BIP 155 with (yet unmerged) https://github.com/bitcoin/bips/pull/967\r\n\r\nUPDATE-2: https://github.com/bitcoin/bips/pull/967 just merged.",
      "created_at" : "2020-10-01T13:20:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-702129772",
      "id" : 702129772,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMjEyOTc3Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-01T14:25:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/702129772",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498327611"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498327611"
         }
      },
      "author_association" : "MEMBER",
      "body" : "76afce803bb5309a69517df5eac68529b7af2d29\r\n```suggestion\r\n        m_connman.PushMessage(&pfrom, CNetMsgMaker(greatest_common_version).Make(NetMsgType::SENDADDRv2));\r\n```",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-01T15:20:26Z",
      "diff_hunk" : "@@ -2414,6 +2414,9 @@ void PeerManager::ProcessMessage(CNode& pfrom, const std::string& msg_type, CDat\n \n         m_connman.PushMessage(&pfrom, CNetMsgMaker(greatest_common_version).Make(NetMsgType::VERACK));\n \n+        // Signal ADDRv2 support (BIP155).\n+        m_connman.PushMessage(&pfrom, CNetMsgMaker(INIT_PROTO_VERSION).Make(NetMsgType::SENDADDRv2));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498327611",
      "id" : 498327611,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODMyNzYxMQ==",
      "original_commit_id" : "76afce803bb5309a69517df5eac68529b7af2d29",
      "original_line" : 2418,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 500460244,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498327611",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498336765"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498336765"
         }
      },
      "author_association" : "MEMBER",
      "body" : "bb01c77865a565764e4e2f86265afef45506d7d7\r\n\r\nThe comment about #9214 seems outdated now:\r\n```suggestion\r\n        if (private_key.empty()) {\r\n            // No private key, generate one.\r\n            private_key = \"NEW:ED25519-V3\";\r\n        }\r\n```\r\n",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-01T15:32:59Z",
      "diff_hunk" : "@@ -532,8 +532,9 @@ void TorController::auth_cb(TorControlConnection& _conn, const TorControlReply&\n         }\n \n         // Finally - now create the service\n-        if (private_key.empty()) // No private key, generate one\n-            private_key = \"NEW:RSA1024\"; // Explicitly request RSA1024 - see issue #9214\n+        if (private_key.empty()) { // No private key, generate one\n+            private_key = \"NEW:ED25519-V3\"; // Explicitly request key type - see issue #9214\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498336765",
      "id" : 498336765,
      "line" : 537,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODMzNjc2NQ==",
      "original_commit_id" : "bb01c77865a565764e4e2f86265afef45506d7d7",
      "original_line" : 537,
      "original_position" : 8,
      "original_start_line" : 535,
      "path" : "src/torcontrol.cpp",
      "position" : 8,
      "pull_request_review_id" : 500460244,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : 535,
      "start_side" : "RIGHT",
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498336765",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498338888"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498338888"
         }
      },
      "author_association" : "MEMBER",
      "body" : "bb01c77865a565764e4e2f86265afef45506d7d7\r\n\r\nSee #19638:\r\n```suggestion\r\n- The Tor onion service that is automatically created (`-listenonion`) will now\r\n```",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-01T15:35:57Z",
      "diff_hunk" : "@@ -74,6 +74,15 @@ P2P and network changes\n   node using P2P relay. This version reduces the initial broadcast guarantees\n   for wallet transactions submitted via P2P to a node running the wallet. (#18038)\n \n+- The Tor hidden service that is automatically created (`-listenonion`) will now",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498338888",
      "id" : 498338888,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODMzODg4OA==",
      "original_commit_id" : "bb01c77865a565764e4e2f86265afef45506d7d7",
      "original_line" : 77,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "doc/release-notes.md",
      "position" : null,
      "pull_request_review_id" : 500460244,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498338888",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> May I suggest to replace s/\"onion_private_key_torv3\"/\"onion_private_key_v3\"/ as \"tor\" substring seems redundant here?\r\n\r\nKind of agree, the same came to mind for me but didn't bother to comment it initially. But a shorter filename that still contains the same information is good I suppose.",
      "created_at" : "2020-10-02T11:47:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-702688812",
      "id" : 702688812,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMjY4ODgxMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-02T11:47:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/702688812",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498799536"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498799536"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Fixed",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-02T12:48:24Z",
      "diff_hunk" : "@@ -98,6 +98,7 @@ Path           | Description | Repository notes\n `blkindex.dat` | Blockchain index BDB database; replaced by {`chainstate/`, `blocks/index/`, `blocks/revNNNNN.dat`<sup>[\\[2\\]](#note2)</sup>} in 0.8.0 | [PR #1677](https://github.com/bitcoin/bitcoin/pull/1677)\n `blk000?.dat`  | Block data (custom format, 2 GiB per file); replaced by `blocks/blkNNNNN.dat`<sup>[\\[2\\]](#note2)</sup> in 0.8.0 | [PR #1677](https://github.com/bitcoin/bitcoin/pull/1677)\n `addr.dat`     | Peer IP address BDB database; replaced by `peers.dat` in [0.7.0](https://github.com/bitcoin/bitcoin/blob/master/doc/release-notes/release-notes-0.7.0.md) | [PR #1198](https://github.com/bitcoin/bitcoin/pull/1198), [`928d3a01`](https://github.com/bitcoin/bitcoin/commit/928d3a011cc66c7f907c4d053f674ea77dc611cc)\n+`onion_private_key` | Cached Tor onion service private key for `-listenonion` option. Was used for Tor v2 services; replaced by `onion_private_key_torv3` in [0.21.0](https://github.com/bitcoin/bitcoin/blob/master/doc/release-notes/release-notes-0.21.0.md) [PR #19954](https://github.com/bitcoin/bitcoin/pull/19954)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498799536",
      "id" : 498799536,
      "in_reply_to_id" : 497578644,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc5OTUzNg==",
      "original_commit_id" : "bb01c77865a565764e4e2f86265afef45506d7d7",
      "original_line" : 101,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "doc/files.md",
      "position" : null,
      "pull_request_review_id" : 501103868,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498799536",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498799651"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498799651"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-02T12:48:38Z",
      "diff_hunk" : "@@ -74,6 +74,15 @@ P2P and network changes\n   node using P2P relay. This version reduces the initial broadcast guarantees\n   for wallet transactions submitted via P2P to a node running the wallet. (#18038)\n \n+- The Tor hidden service that is automatically created (`-listenonion`) will now\n+  be created as a Tor v3 service instead of Tor v2. The private key that was used\n+  for Tor v2 (if any) will be left untouched in `onion_private_key` in `-datadir`\n+  and can be removed if not needed. Bitcoin Core will no longer attempt to read it.\n+  The private key for the Tor v3 service will be saved in `onion_private_key_torv3`.\n+  To use the deprecated Tor v2 service (not recommended), then `onion_private_key`\n+  can be copied over `onion_private_key_torv3`\n+  (`cp -f onion_private_key onion_private_key_torv3`).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498799651",
      "id" : 498799651,
      "in_reply_to_id" : 497581232,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc5OTY1MQ==",
      "original_commit_id" : "bb01c77865a565764e4e2f86265afef45506d7d7",
      "original_line" : 84,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "doc/release-notes.md",
      "position" : null,
      "pull_request_review_id" : 501104027,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498799651",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498801055"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498801055"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Right, `p2p_addr_relay.py` is the only test that exercises `msg_addr` and if we flip it to test `msg_addrv2` then `msg_addr` will be untested.\r\n\r\nI tried to combine both in one test, but it became too convoluted and so I copied the new test to `p2p_addrv2_relay.py` and restored the original `p2p_addr_relay.py`.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-02T12:51:15Z",
      "diff_hunk" : "@@ -10,7 +10,7 @@\n     CAddress,\n     NODE_NETWORK,\n     NODE_WITNESS,\n-    msg_addr,\n+    msg_addrv2,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498801055",
      "id" : 498801055,
      "in_reply_to_id" : 497583701,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgwMTA1NQ==",
      "original_commit_id" : "bb01c77865a565764e4e2f86265afef45506d7d7",
      "original_line" : 13,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/p2p_addr_relay.py",
      "position" : null,
      "pull_request_review_id" : 501105863,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498801055",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498801234"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498801234"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-02T12:51:36Z",
      "diff_hunk" : "@@ -2414,6 +2414,9 @@ void PeerManager::ProcessMessage(CNode& pfrom, const std::string& msg_type, CDat\n \n         m_connman.PushMessage(&pfrom, CNetMsgMaker(greatest_common_version).Make(NetMsgType::VERACK));\n \n+        // Signal ADDRv2 support (BIP155).\n+        m_connman.PushMessage(&pfrom, CNetMsgMaker(INIT_PROTO_VERSION).Make(NetMsgType::SENDADDRv2));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498801234",
      "id" : 498801234,
      "in_reply_to_id" : 498327611,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgwMTIzNA==",
      "original_commit_id" : "76afce803bb5309a69517df5eac68529b7af2d29",
      "original_line" : 2418,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 501106136,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498801234",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498801401"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498801401"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Changed",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-02T12:51:55Z",
      "diff_hunk" : "@@ -74,6 +74,15 @@ P2P and network changes\n   node using P2P relay. This version reduces the initial broadcast guarantees\n   for wallet transactions submitted via P2P to a node running the wallet. (#18038)\n \n+- The Tor hidden service that is automatically created (`-listenonion`) will now",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498801401",
      "id" : 498801401,
      "in_reply_to_id" : 498338888,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgwMTQwMQ==",
      "original_commit_id" : "bb01c77865a565764e4e2f86265afef45506d7d7",
      "original_line" : 77,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "doc/release-notes.md",
      "position" : null,
      "pull_request_review_id" : 501106347,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498801401",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498803183"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498803183"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The comment is still relevant - we want to explicitly request the key type in order to avoid problems like #9214 in the future.\r\n\r\nIn other words - we don't want somebody to change this to `NEW:BEST` because if/when Tor upgrades to v4 then we may have #9214 again.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-02T12:55:32Z",
      "diff_hunk" : "@@ -532,8 +532,9 @@ void TorController::auth_cb(TorControlConnection& _conn, const TorControlReply&\n         }\n \n         // Finally - now create the service\n-        if (private_key.empty()) // No private key, generate one\n-            private_key = \"NEW:RSA1024\"; // Explicitly request RSA1024 - see issue #9214\n+        if (private_key.empty()) { // No private key, generate one\n+            private_key = \"NEW:ED25519-V3\"; // Explicitly request key type - see issue #9214\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498803183",
      "id" : 498803183,
      "in_reply_to_id" : 498336765,
      "line" : 537,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgwMzE4Mw==",
      "original_commit_id" : "bb01c77865a565764e4e2f86265afef45506d7d7",
      "original_line" : 537,
      "original_position" : 8,
      "original_start_line" : 535,
      "path" : "src/torcontrol.cpp",
      "position" : 8,
      "pull_request_review_id" : 501108829,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : 535,
      "start_side" : "RIGHT",
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498803183",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Addressed review suggestions. Notice - I [restored](https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498801055) the original version of `p2p_addr_relay.py` and the test for addrv2 is now in a new test `p2p_addrv2_relay.py`.",
      "created_at" : "2020-10-02T13:00:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-702720508",
      "id" : 702720508,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMjcyMDUwOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-02T13:00:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/702720508",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498807007"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498807007"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "That line is unmodified by the patch. I try to avoid sneaking unrelated improvements to surrounding code in order to ease reviewers and future history observers.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-02T13:03:02Z",
      "diff_hunk" : "@@ -318,8 +329,15 @@ friend class CAddrManTest;\n     {\n         LOCK(cs);\n \n-        unsigned char nVersion = 2;\n-        s << nVersion;\n+        const auto stream_version_orig = s.GetVersion();\n+\n+        if (m_format >= Format::V3) {\n+            // Add ADDRV2_FORMAT to the version so that the CNetAddr and CAddress\n+            // serialize methods produce an address in v2 format.\n+            s.SetVersion(stream_version_orig | ADDRV2_FORMAT);\n+        }\n+\n+        s << (uint8_t)m_format;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498807007",
      "id" : 498807007,
      "in_reply_to_id" : 496575638,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgwNzAwNw==",
      "original_commit_id" : "e025121c1ca4b86296c6b36386786522bd79a6e1",
      "original_line" : 340,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 501114927,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498807007",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498812638"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498812638"
         }
      },
      "author_association" : "MEMBER",
      "body" : "That's fair.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-02T13:13:41Z",
      "diff_hunk" : "@@ -318,8 +329,15 @@ friend class CAddrManTest;\n     {\n         LOCK(cs);\n \n-        unsigned char nVersion = 2;\n-        s << nVersion;\n+        const auto stream_version_orig = s.GetVersion();\n+\n+        if (m_format >= Format::V3) {\n+            // Add ADDRV2_FORMAT to the version so that the CNetAddr and CAddress\n+            // serialize methods produce an address in v2 format.\n+            s.SetVersion(stream_version_orig | ADDRV2_FORMAT);\n+        }\n+\n+        s << (uint8_t)m_format;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498812638",
      "id" : 498812638,
      "in_reply_to_id" : 496575638,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgxMjYzOA==",
      "original_commit_id" : "e025121c1ca4b86296c6b36386786522bd79a6e1",
      "original_line" : 340,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 501122763,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498812638",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I [restored](https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498801055) the original version of `p2p_addr_relay.py` and the test for addrv2 is now in a new test `p2p_addrv2_relay.py`.\r\n\r\nNice!",
      "created_at" : "2020-10-02T13:15:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-702727412",
      "id" : 702727412,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMjcyNzQxMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-02T13:15:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/702727412",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498825564"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498825564"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Correct.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-02T13:36:12Z",
      "diff_hunk" : "@@ -532,8 +532,9 @@ void TorController::auth_cb(TorControlConnection& _conn, const TorControlReply&\n         }\n \n         // Finally - now create the service\n-        if (private_key.empty()) // No private key, generate one\n-            private_key = \"NEW:RSA1024\"; // Explicitly request RSA1024 - see issue #9214\n+        if (private_key.empty()) { // No private key, generate one\n+            private_key = \"NEW:ED25519-V3\"; // Explicitly request key type - see issue #9214\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r498825564",
      "id" : 498825564,
      "in_reply_to_id" : 498336765,
      "line" : 537,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgyNTU2NA==",
      "original_commit_id" : "bb01c77865a565764e4e2f86265afef45506d7d7",
      "original_line" : 537,
      "original_position" : 8,
      "original_start_line" : 535,
      "path" : "src/torcontrol.cpp",
      "position" : 8,
      "pull_request_review_id" : 501140722,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : 535,
      "start_side" : "RIGHT",
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/498825564",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@vasild in the latest push, the `p2p_addr_relay.py` file perms were changed from 755 to 644; could you please revert that?\r\n\r\n<details><summary>a few suggestions for <code>p2p_addrv2_relay.py</code></summary><p>\r\n\r\n```diff\r\ndiff --git a/test/functional/p2p_addrv2_relay.py b/test/functional/p2p_addrv2_relay.py\r\nindex 19cfd0eadb..ca593148cc 100755\r\n--- a/test/functional/p2p_addrv2_relay.py\r\n+++ b/test/functional/p2p_addrv2_relay.py\r\n@@ -6,18 +6,17 @@\r\n@@ -6,18 +6,17 @@\r\n Test addrv2 relay\r\n \"\"\"\r\n \r\n+import time\r\n+\r\n from test_framework.messages import (\r\n     CAddress,\r\n+    msg_addrv2,\r\n     NODE_NETWORK,\r\n     NODE_WITNESS,\r\n-    msg_addrv2,\r\n )\r\n from test_framework.p2p import P2PInterface\r\n from test_framework.test_framework import BitcoinTestFramework\r\n-from test_framework.util import (\r\n-    assert_equal,\r\n-)\r\n-import time\r\n+from test_framework.util import assert_equal\r\n \r\n ADDRS = []\r\n for i in range(10):\r\n@@ -48,11 +47,11 @@ class AddrReceiver(P2PInterface):\r\n \r\n class AddrTest(BitcoinTestFramework):\r\n     def set_test_params(self):\r\n-        self.setup_clean_chain = False\r\n+        self.setup_clean_chain = True\r\n         self.num_nodes = 1\r\n \r\n     def run_test(self):\r\n-        self.log.info('Create connection that sends addr messages')\r\n+        self.log.info('Create connection that sends addrv2 messages')\r\n         addr_source = self.nodes[0].add_p2p_connection(P2PInterface())\r\n         msg = msg_addrv2()\r\n \r\n@@ -61,7 +60,7 @@ class AddrTest(BitcoinTestFramework):\r\n         with self.nodes[0].assert_debug_log(['addr message size = 1010']):\r\n             addr_source.send_and_ping(msg)\r\n \r\n-        self.log.info('Check that addr message content is relayed and added to addrman')\r\n+        self.log.info('Check that addrv2 message content is relayed and added to addrman')\r\n         addr_receiver = self.nodes[0].add_p2p_connection(AddrReceiver())\r\n         msg.addrs = ADDRS\r\n         with self.nodes[0].assert_debug_log([\r\n```\r\n</p></details>\r\n",
      "created_at" : "2020-10-03T11:07:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-703086391",
      "id" : 703086391,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMzA4NjM5MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-03T11:07:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/703086391",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499139208"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499139208"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    return GetDataDir() / \"onion_v3_private_key\";\r\n```",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-03T11:16:44Z",
      "diff_hunk" : "@@ -718,7 +719,7 @@ void TorController::Reconnect()\n \n fs::path TorController::GetPrivateKeyFile()\n {\n-    return GetDataDir() / \"onion_private_key\";\n+    return GetDataDir() / \"onion_private_key_v3\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499139208",
      "id" : 499139208,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTEzOTIwOA==",
      "original_commit_id" : "c212c7eea6c0f67d7c65467c6c93f188aaeb02f3",
      "original_line" : 722,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/torcontrol.cpp",
      "position" : null,
      "pull_request_review_id" : 501539039,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499139208",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499139283"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499139283"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: IIRC, per PEP8, OS-level and stdlib imports go at the top. ",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-03T11:18:10Z",
      "diff_hunk" : "@@ -22,7 +22,12 @@\n     P2PInterface,\n )\n from test_framework.test_framework import BitcoinTestFramework\n-from test_framework.util import assert_equal\n+from test_framework.util import (\n+    assert_equal,\n+    hex_str_to_bytes,\n+)\n+import struct\n+import time",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499139283",
      "id" : 499139283,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTEzOTI4Mw==",
      "original_commit_id" : "c212c7eea6c0f67d7c65467c6c93f188aaeb02f3",
      "original_line" : 30,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "test/functional/p2p_invalid_messages.py",
      "position" : null,
      "pull_request_review_id" : 501539039,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499139283",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499140417"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499140417"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should skipping invalid BIP155 addresses be applied only for `addrv2` messages?\r\n```cpp\r\nif (!addr.IsValid() && msg_type == NetMsgType::ADDRv2) {\r\n    continue;\r\n}\r\n```",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-03T11:35:27Z",
      "diff_hunk" : "@@ -2610,6 +2635,11 @@ void PeerManager::ProcessMessage(CNode& pfrom, const std::string& msg_type, CDat\n             if (!MayHaveUsefulAddressDB(addr.nServices) && !HasAllDesirableServiceFlags(addr.nServices))\n                 continue;\n \n+            // Skip invalid addresses, maybe a new BIP155 network id from the future.\n+            if (!addr.IsValid()) {\n+                continue;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499140417",
      "id" : 499140417,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTE0MDQxNw==",
      "original_commit_id" : "c212c7eea6c0f67d7c65467c6c93f188aaeb02f3",
      "original_line" : 2640,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 501539911,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499140417",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499295620"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499295620"
         }
      },
      "author_association" : "MEMBER",
      "body" : "How about giving these a bit more descriptive names, like `V0_HISTORICAL`, `V1_DETERMINISTIC`, `V2_ASMAP`, `V3_BIP155`?",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-04T22:29:13Z",
      "diff_hunk" : "@@ -264,6 +264,17 @@ friend class CAddrManTest;\n     void SetServices_(const CService &addr, ServiceFlags nServices) EXCLUSIVE_LOCKS_REQUIRED(cs);\n \n public:\n+    //! Serialization versions.\n+    enum class Format : uint8_t {\n+        V0 = 0, //!< historic format, before commit e6b343d88",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499295620",
      "id" : 499295620,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI5NTYyMA==",
      "original_commit_id" : "31876b33894a48f20a8835126faac8f9f4a8aa00",
      "original_line" : 269,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 501664990,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499295620",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499295803"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499295803"
         }
      },
      "author_association" : "MEMBER",
      "body" : "A cleaner approach is using `OverrideStream` here (and elsewhere), which removes the need to undo the version change, or having a mutable version in CHashWriter.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-04T22:31:45Z",
      "diff_hunk" : "@@ -318,8 +329,15 @@ friend class CAddrManTest;\n     {\n         LOCK(cs);\n \n-        unsigned char nVersion = 2;\n-        s << nVersion;\n+        const auto stream_version_orig = s.GetVersion();\n+\n+        if (m_format >= Format::V3) {\n+            // Add ADDRV2_FORMAT to the version so that the CNetAddr and CAddress\n+            // serialize methods produce an address in v2 format.\n+            s.SetVersion(stream_version_orig | ADDRV2_FORMAT);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499295803",
      "id" : 499295803,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI5NTgwMw==",
      "original_commit_id" : "31876b33894a48f20a8835126faac8f9f4a8aa00",
      "original_line" : 337,
      "original_position" : 40,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 501664990,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499295803",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499586890"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499586890"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-05T13:12:01Z",
      "diff_hunk" : "@@ -718,7 +719,7 @@ void TorController::Reconnect()\n \n fs::path TorController::GetPrivateKeyFile()\n {\n-    return GetDataDir() / \"onion_private_key\";\n+    return GetDataDir() / \"onion_private_key_v3\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499586890",
      "id" : 499586890,
      "in_reply_to_id" : 499139208,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTU4Njg5MA==",
      "original_commit_id" : "c212c7eea6c0f67d7c65467c6c93f188aaeb02f3",
      "original_line" : 722,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/torcontrol.cpp",
      "position" : null,
      "pull_request_review_id" : 502039808,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499586890",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499586991"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499586991"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-05T13:12:11Z",
      "diff_hunk" : "@@ -22,7 +22,12 @@\n     P2PInterface,\n )\n from test_framework.test_framework import BitcoinTestFramework\n-from test_framework.util import assert_equal\n+from test_framework.util import (\n+    assert_equal,\n+    hex_str_to_bytes,\n+)\n+import struct\n+import time",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499586991",
      "id" : 499586991,
      "in_reply_to_id" : 499139283,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTU4Njk5MQ==",
      "original_commit_id" : "c212c7eea6c0f67d7c65467c6c93f188aaeb02f3",
      "original_line" : 30,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "test/functional/p2p_invalid_messages.py",
      "position" : null,
      "pull_request_review_id" : 502039960,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499586991",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499588933"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499588933"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I realized that this code is not necessary so I dropped it altogether - an invalid address is not routable and is not reachable, so we are not going to do anything with it.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-05T13:15:04Z",
      "diff_hunk" : "@@ -2610,6 +2635,11 @@ void PeerManager::ProcessMessage(CNode& pfrom, const std::string& msg_type, CDat\n             if (!MayHaveUsefulAddressDB(addr.nServices) && !HasAllDesirableServiceFlags(addr.nServices))\n                 continue;\n \n+            // Skip invalid addresses, maybe a new BIP155 network id from the future.\n+            if (!addr.IsValid()) {\n+                continue;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499588933",
      "id" : 499588933,
      "in_reply_to_id" : 499140417,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTU4ODkzMw==",
      "original_commit_id" : "c212c7eea6c0f67d7c65467c6c93f188aaeb02f3",
      "original_line" : 2640,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 502042603,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499588933",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499589759"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499589759"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Renamed",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-05T13:16:19Z",
      "diff_hunk" : "@@ -264,6 +264,17 @@ friend class CAddrManTest;\n     void SetServices_(const CService &addr, ServiceFlags nServices) EXCLUSIVE_LOCKS_REQUIRED(cs);\n \n public:\n+    //! Serialization versions.\n+    enum class Format : uint8_t {\n+        V0 = 0, //!< historic format, before commit e6b343d88",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499589759",
      "id" : 499589759,
      "in_reply_to_id" : 499295620,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTU4OTc1OQ==",
      "original_commit_id" : "31876b33894a48f20a8835126faac8f9f4a8aa00",
      "original_line" : 269,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 502043799,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499589759",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499590590"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499590590"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Right, changed to `OverrideStream`.\r\n\r\nhttps://github.com/bitcoin/bitcoin/pull/19503 is also an alternative if/when it gets merged.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-05T13:17:31Z",
      "diff_hunk" : "@@ -318,8 +329,15 @@ friend class CAddrManTest;\n     {\n         LOCK(cs);\n \n-        unsigned char nVersion = 2;\n-        s << nVersion;\n+        const auto stream_version_orig = s.GetVersion();\n+\n+        if (m_format >= Format::V3) {\n+            // Add ADDRV2_FORMAT to the version so that the CNetAddr and CAddress\n+            // serialize methods produce an address in v2 format.\n+            s.SetVersion(stream_version_orig | ADDRV2_FORMAT);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499590590",
      "id" : 499590590,
      "in_reply_to_id" : 499295803,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTU5MDU5MA==",
      "original_commit_id" : "31876b33894a48f20a8835126faac8f9f4a8aa00",
      "original_line" : 337,
      "original_position" : 40,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 502044946,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499590590",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Addressed review suggestions.",
      "created_at" : "2020-10-05T13:20:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-703627129",
      "id" : 703627129,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMzYyNzEyOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-05T13:20:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/703627129",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499623542"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499623542"
         }
      },
      "author_association" : "MEMBER",
      "body" : "pico-nit:\r\n```suggestion\r\n    template <typename Stream>\r\n```",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-05T14:04:34Z",
      "diff_hunk" : "@@ -371,13 +390,25 @@ friend class CAddrManTest;\n     }\n \n     template<typename Stream>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499623542",
      "id" : 499623542,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYyMzU0Mg==",
      "original_commit_id" : "bbbc8e4c657e8ea81edb6aca2b1870cd3b7459ad",
      "original_line" : 392,
      "original_position" : 58,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 502090310,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499623542",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499625806"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499625806"
         }
      },
      "author_association" : "MEMBER",
      "body" : "pico-nit, as `clang-format` suggests, and s/V2/V2_ASMAP/ in comment:\r\n```suggestion\r\n        V0_HISTORICAL = 0,    //!< historic format, before commit e6b343d88\r\n        V1_DETERMINISTIC = 1, //!< for pre-asmap files\r\n        V2_ASMAP = 2,         //!< for files including asmap version\r\n        V3_BIP155 = 3,        //!< same as V2_ASMAP plus addresses are in BIP155 format\r\n```",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-05T14:07:54Z",
      "diff_hunk" : "@@ -264,6 +264,17 @@ friend class CAddrManTest;\n     void SetServices_(const CService &addr, ServiceFlags nServices) EXCLUSIVE_LOCKS_REQUIRED(cs);\n \n public:\n+    //! Serialization versions.\n+    enum class Format : uint8_t {\n+        V0_HISTORICAL = 0, //!< historic format, before commit e6b343d88\n+        V1_DETERMINISTIC = 1, //!< for pre-asmap files\n+        V2_ASMAP = 2, //!< for files including asmap version\n+        V3_BIP155 = 3, //!< same as V2 plus addresses are in BIP155 format",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499625806",
      "id" : 499625806,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYyNTgwNg==",
      "original_commit_id" : "bbbc8e4c657e8ea81edb6aca2b1870cd3b7459ad",
      "original_line" : 272,
      "original_position" : 9,
      "original_start_line" : 269,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 502090310,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499625806",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499626217"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499626217"
         }
      },
      "author_association" : "MEMBER",
      "body" : "pico-nit:\r\n```suggestion\r\n    int nVersion;\r\n\r\npublic:\r\n```",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-05T14:08:33Z",
      "diff_hunk" : "@@ -102,13 +102,14 @@ class CHashWriter\n     CSHA256 ctx;\n \n     const int nType;\n-    const int nVersion;\n+    int nVersion;\n public:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499626217",
      "id" : 499626217,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYyNjIxNw==",
      "original_commit_id" : "bbbc8e4c657e8ea81edb6aca2b1870cd3b7459ad",
      "original_line" : 106,
      "original_position" : 6,
      "original_start_line" : 105,
      "path" : "src/hash.h",
      "position" : null,
      "pull_request_review_id" : 502090310,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499626217",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I'd like that `s` and `s_` objects of the `Stream` class were named more descriptive, but I have no particular suggestion.",
      "created_at" : "2020-10-05T14:17:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-703662561",
      "id" : 703662561,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMzY2MjU2MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-05T14:17:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/703662561",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Addressed review suggestions.",
      "created_at" : "2020-10-05T14:41:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-703677160",
      "id" : 703677160,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMzY3NzE2MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-05T14:41:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/703677160",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499650613"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499650613"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-05T14:41:19Z",
      "diff_hunk" : "@@ -102,13 +102,14 @@ class CHashWriter\n     CSHA256 ctx;\n \n     const int nType;\n-    const int nVersion;\n+    int nVersion;\n public:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499650613",
      "id" : 499650613,
      "in_reply_to_id" : 499626217,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY1MDYxMw==",
      "original_commit_id" : "bbbc8e4c657e8ea81edb6aca2b1870cd3b7459ad",
      "original_line" : 106,
      "original_position" : 6,
      "original_start_line" : 105,
      "path" : "src/hash.h",
      "position" : null,
      "pull_request_review_id" : 502127617,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499650613",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499650706"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499650706"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-05T14:41:28Z",
      "diff_hunk" : "@@ -264,6 +264,17 @@ friend class CAddrManTest;\n     void SetServices_(const CService &addr, ServiceFlags nServices) EXCLUSIVE_LOCKS_REQUIRED(cs);\n \n public:\n+    //! Serialization versions.\n+    enum class Format : uint8_t {\n+        V0_HISTORICAL = 0, //!< historic format, before commit e6b343d88\n+        V1_DETERMINISTIC = 1, //!< for pre-asmap files\n+        V2_ASMAP = 2, //!< for files including asmap version\n+        V3_BIP155 = 3, //!< same as V2 plus addresses are in BIP155 format",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499650706",
      "id" : 499650706,
      "in_reply_to_id" : 499625806,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY1MDcwNg==",
      "original_commit_id" : "bbbc8e4c657e8ea81edb6aca2b1870cd3b7459ad",
      "original_line" : 272,
      "original_position" : 9,
      "original_start_line" : 269,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 502127760,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499650706",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499650830"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499650830"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-05T14:41:38Z",
      "diff_hunk" : "@@ -371,13 +390,25 @@ friend class CAddrManTest;\n     }\n \n     template<typename Stream>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499650830",
      "id" : 499650830,
      "in_reply_to_id" : 499623542,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY1MDgzMA==",
      "original_commit_id" : "bbbc8e4c657e8ea81edb6aca2b1870cd3b7459ad",
      "original_line" : 392,
      "original_position" : 58,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 502127927,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499650830",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499714046"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499714046"
         }
      },
      "author_association" : "MEMBER",
      "body" : "03572e9 After `git diff c212c7e 703db15` using `OverrideStream`, it looks like we can now revert these changes in `hash.h` and `streams.h`.\r\n```diff\r\n+++ b/src/hash.h\r\n@@ -102,7 +102,7 @@ private:\r\n     const int nType;\r\n-    int nVersion;\r\n+    const int nVersion;\r\n@@ -110,7 +110,6 @@ public:\r\n     int GetVersion() const { return nVersion; }\r\n-    void SetVersion(int n) { nVersion = n; }\r\n\r\n+++ b/src/streams.h\r\n@@ -603,7 +603,7 @@ class CAutoFile\r\n     const int nType;\r\n-    int nVersion;\r\n+    const int nVersion; \r\n@@ -651,7 +651,6 @@ public:\r\n     int GetVersion() const       { return nVersion; }\r\n-    void SetVersion(int n)       { nVersion = n; }\r\n```",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-05T16:11:14Z",
      "diff_hunk" : "@@ -102,13 +102,15 @@ class CHashWriter\n     CSHA256 ctx;\n \n     const int nType;\n-    const int nVersion;\n+    int nVersion;\n+\n public:\n \n     CHashWriter(int nTypeIn, int nVersionIn) : nType(nTypeIn), nVersion(nVersionIn) {}\n \n     int GetType() const { return nType; }\n     int GetVersion() const { return nVersion; }\n+    void SetVersion(int n) { nVersion = n; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499714046",
      "id" : 499714046,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTcxNDA0Ng==",
      "original_commit_id" : "703db15ae197c6b2e9489c14af441c5d796ff082",
      "original_line" : 113,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/hash.h",
      "position" : null,
      "pull_request_review_id" : 502211628,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499714046",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499926937"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499926937"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You could use `s_ >> Using<CustomUintFormatter<1>>(m_format)` here (and possibly also in `Serialize`, for consistency, though it isn't really a gain there).",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-05T23:32:56Z",
      "diff_hunk" : "@@ -370,14 +389,26 @@ friend class CAddrManTest;\n         s << asmap_version;\n     }\n \n-    template<typename Stream>\n-    void Unserialize(Stream& s)\n+    template <typename Stream>\n+    void Unserialize(Stream& s_)\n     {\n         LOCK(cs);\n \n         Clear();\n-        unsigned char nVersion;\n-        s >> nVersion;\n+\n+        uint8_t format_tmp;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499926937",
      "id" : 499926937,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkyNjkzNw==",
      "original_commit_id" : "03572e94cb7249165cc5333c0785e2694c620785",
      "original_line" : 399,
      "original_position" : 70,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 502489557,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499926937",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499929630"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499929630"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This should be unnecessary as well.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-05T23:43:10Z",
      "diff_hunk" : "@@ -650,6 +651,7 @@ class CAutoFile\n     //\n     int GetType() const          { return nType; }\n     int GetVersion() const       { return nVersion; }\n+    void SetVersion(int n)       { nVersion = n; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499929630",
      "id" : 499929630,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkyOTYzMA==",
      "original_commit_id" : "03572e94cb7249165cc5333c0785e2694c620785",
      "original_line" : 654,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/streams.h",
      "position" : null,
      "pull_request_review_id" : 502489557,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499929630",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499932221"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499932221"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's a bit ugly to make the choice of how addrman is serialized on disk dependent on external code properly setting this m_format variable.\r\n\r\nI think it's fine to just always serialize in the latest format. In that case the `format` variable can be just be local to the deserialization code.\r\n\r\nAlternatively, if you want to focus on retaining backward compatibility as long as no BIP155 has been used, you could make the format decision at serialization depend on whether or not IsAddrV1Compatible() is true for all addresses in it.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-05T23:50:58Z",
      "diff_hunk" : "@@ -264,6 +264,17 @@ friend class CAddrManTest;\n     void SetServices_(const CService &addr, ServiceFlags nServices) EXCLUSIVE_LOCKS_REQUIRED(cs);\n \n public:\n+    //! Serialization versions.\n+    enum class Format : uint8_t {\n+        V0_HISTORICAL = 0,    //!< historic format, before commit e6b343d88\n+        V1_DETERMINISTIC = 1, //!< for pre-asmap files\n+        V2_ASMAP = 2,         //!< for files including asmap version\n+        V3_BIP155 = 3,        //!< same as V2_ASMAP plus addresses are in BIP155 format\n+    };\n+\n+    //! Serialization / unserialization format.\n+    Format m_format = Format::V3_BIP155;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499932221",
      "id" : 499932221,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkzMjIyMQ==",
      "original_commit_id" : "03572e94cb7249165cc5333c0785e2694c620785",
      "original_line" : 276,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 502489557,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499932221",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499952970"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499952970"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If you use the `CNetMsgMaker:: Make(int nFlags, std::string msg_type, Args&&... args)` variant here, you can control the serialization flags, without needing the special casing for ADDRV2 inside `Make`.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-06T01:11:25Z",
      "diff_hunk" : "@@ -4104,14 +4137,14 @@ bool PeerManager::SendMessages(CNode* pto)\n                     // receiver rejects addr messages larger than MAX_ADDR_TO_SEND\n                     if (vAddr.size() >= MAX_ADDR_TO_SEND)\n                     {\n-                        m_connman.PushMessage(pto, msgMaker.Make(NetMsgType::ADDR, vAddr));\n+                        m_connman.PushMessage(pto, msgMaker.Make(msg_type, vAddr));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r499952970",
      "id" : 499952970,
      "line" : 4140,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTk1Mjk3MA==",
      "original_commit_id" : "44364147d739cc4566cd1b202f1effd6f81539d8",
      "original_line" : 4140,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 93,
      "pull_request_review_id" : 502489557,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:27:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499952970",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500134583"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500134583"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Good catch! Removed.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-06T09:28:14Z",
      "diff_hunk" : "@@ -102,13 +102,15 @@ class CHashWriter\n     CSHA256 ctx;\n \n     const int nType;\n-    const int nVersion;\n+    int nVersion;\n+\n public:\n \n     CHashWriter(int nTypeIn, int nVersionIn) : nType(nTypeIn), nVersion(nVersionIn) {}\n \n     int GetType() const { return nType; }\n     int GetVersion() const { return nVersion; }\n+    void SetVersion(int n) { nVersion = n; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500134583",
      "id" : 500134583,
      "in_reply_to_id" : 499714046,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDEzNDU4Mw==",
      "original_commit_id" : "703db15ae197c6b2e9489c14af441c5d796ff082",
      "original_line" : 113,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/hash.h",
      "position" : null,
      "pull_request_review_id" : 502751215,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:28:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500134583",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500135370"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500135370"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Used `CustomUintFormatter` here, but in `Serialize` it did not compile:\r\n```\r\nsrc/serialize.h:504:15: error: invalid operands to binary expression ('CAddrMan::Format' and 'int')\r\n        if (v < 0 || v > MAX) throw std::ios_base::failure(\"CustomUintFormatter value out of range\");\r\n            ~ ^ ~\r\n```\r\nso I left the `static_cast` there.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-06T09:29:31Z",
      "diff_hunk" : "@@ -370,14 +389,26 @@ friend class CAddrManTest;\n         s << asmap_version;\n     }\n \n-    template<typename Stream>\n-    void Unserialize(Stream& s)\n+    template <typename Stream>\n+    void Unserialize(Stream& s_)\n     {\n         LOCK(cs);\n \n         Clear();\n-        unsigned char nVersion;\n-        s >> nVersion;\n+\n+        uint8_t format_tmp;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500135370",
      "id" : 500135370,
      "in_reply_to_id" : 499926937,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDEzNTM3MA==",
      "original_commit_id" : "03572e94cb7249165cc5333c0785e2694c620785",
      "original_line" : 399,
      "original_position" : 70,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 502752290,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:29:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500135370",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500135658"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500135658"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Removed",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-06T09:29:56Z",
      "diff_hunk" : "@@ -650,6 +651,7 @@ class CAutoFile\n     //\n     int GetType() const          { return nType; }\n     int GetVersion() const       { return nVersion; }\n+    void SetVersion(int n)       { nVersion = n; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500135658",
      "id" : 500135658,
      "in_reply_to_id" : 499929630,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDEzNTY1OA==",
      "original_commit_id" : "03572e94cb7249165cc5333c0785e2694c620785",
      "original_line" : 654,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/streams.h",
      "position" : null,
      "pull_request_review_id" : 502752629,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:29:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500135658",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500137462"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500137462"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I agree \"it's fine to just always serialize in the latest format\", changed the code accordingly - now the format variable is a local one in `Unserialize()` while `Serialize()` just serializes the constant `Format::V3_BIP155`.\r\n\r\nThis is also closer to the behavior before this PR (it always serialized in version 2, the latest at the time).",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-06T09:32:53Z",
      "diff_hunk" : "@@ -264,6 +264,17 @@ friend class CAddrManTest;\n     void SetServices_(const CService &addr, ServiceFlags nServices) EXCLUSIVE_LOCKS_REQUIRED(cs);\n \n public:\n+    //! Serialization versions.\n+    enum class Format : uint8_t {\n+        V0_HISTORICAL = 0,    //!< historic format, before commit e6b343d88\n+        V1_DETERMINISTIC = 1, //!< for pre-asmap files\n+        V2_ASMAP = 2,         //!< for files including asmap version\n+        V3_BIP155 = 3,        //!< same as V2_ASMAP plus addresses are in BIP155 format\n+    };\n+\n+    //! Serialization / unserialization format.\n+    Format m_format = Format::V3_BIP155;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500137462",
      "id" : 500137462,
      "in_reply_to_id" : 499932221,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDEzNzQ2Mg==",
      "original_commit_id" : "03572e94cb7249165cc5333c0785e2694c620785",
      "original_line" : 276,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 502754928,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:32:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500137462",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500137760"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500137760"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Does this mean that `peers.dat` becomes unreadable if a user choose to downgrade his node at some point in the future?",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-06T09:33:26Z",
      "diff_hunk" : "@@ -264,6 +264,17 @@ friend class CAddrManTest;\n     void SetServices_(const CService &addr, ServiceFlags nServices) EXCLUSIVE_LOCKS_REQUIRED(cs);\n \n public:\n+    //! Serialization versions.\n+    enum class Format : uint8_t {\n+        V0_HISTORICAL = 0,    //!< historic format, before commit e6b343d88\n+        V1_DETERMINISTIC = 1, //!< for pre-asmap files\n+        V2_ASMAP = 2,         //!< for files including asmap version\n+        V3_BIP155 = 3,        //!< same as V2_ASMAP plus addresses are in BIP155 format\n+    };\n+\n+    //! Serialization / unserialization format.\n+    Format m_format = Format::V3_BIP155;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500137760",
      "id" : 500137760,
      "in_reply_to_id" : 499932221,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDEzNzc2MA==",
      "original_commit_id" : "03572e94cb7249165cc5333c0785e2694c620785",
      "original_line" : 276,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 502755354,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:33:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500137760",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500144970"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500144970"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "A good interface is [hard or impossible to misuse](https://testing.googleblog.com/2018/07/code-health-make-interfaces-hard-to.html). If we add `ADDRV2_FORMAT` to `nFlags` inside `Make()` that makes it impossible for the caller to misuse it like:\r\n\r\n```cpp\r\nmsgMaker.Make(0, NetMsgType::ADDRv2, vAddr); // huh!?\r\n```\r\n\r\nI think it is not good to impose on the caller: \"whenever you pass `NetMsgType::ADDRv2` for `msg_type` you must also pass `ADDRV2_FORMAT` in `nFlags`\".",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-06T09:45:27Z",
      "diff_hunk" : "@@ -4104,14 +4137,14 @@ bool PeerManager::SendMessages(CNode* pto)\n                     // receiver rejects addr messages larger than MAX_ADDR_TO_SEND\n                     if (vAddr.size() >= MAX_ADDR_TO_SEND)\n                     {\n-                        m_connman.PushMessage(pto, msgMaker.Make(NetMsgType::ADDR, vAddr));\n+                        m_connman.PushMessage(pto, msgMaker.Make(msg_type, vAddr));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500144970",
      "id" : 500144970,
      "in_reply_to_id" : 499952970,
      "line" : 4140,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDE0NDk3MA==",
      "original_commit_id" : "44364147d739cc4566cd1b202f1effd6f81539d8",
      "original_line" : 4140,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 93,
      "pull_request_review_id" : 502764808,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T09:56:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500144970",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Addressed review suggestions and extended some tests.",
      "created_at" : "2020-10-06T09:47:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-704157591",
      "id" : 704157591,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwNDE1NzU5MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-06T09:47:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/704157591",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "[Filtered code coverage report](https://people.freebsd.org/~vd/pr19954_946b79a9d_coverage/) (files not modified by this PR are omitted and not modified lines in files that are otherwise modified are dimmed).\r\n\r\n[List of modified and not covered lines](https://people.freebsd.org/~vd/pr19954_946b79a9d_coverage/modified_and_not_covered.html).",
      "created_at" : "2020-10-06T09:53:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-704160646",
      "id" : 704160646,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19954",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwNDE2MDY0Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-06T09:53:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/704160646",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500464672"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500464672"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@vasild I agree with the notion, but this is just the wrong layer to deal with that. The serialization framework (which I'd consider netmessagemaker to be a thin wrapper around) shouldn't have knowledge about the data being serialized, or even about which message types exist.\r\n\r\n> I think it is not good to impose on the caller: \"whenever you pass `NetMsgType::ADDRv2` for `msg_type` you must also pass `ADDRV2_FORMAT` in `nFlags`\".\r\n\r\nI think that's the wrong way to think about it. `CNetMsgMaker` should do as it's told: serializing the object passed with the specified flags, and nothing else. Knowledge about what message types exist, and how data is serialized in them belongs in net_processing.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-06T17:15:12Z",
      "diff_hunk" : "@@ -4104,14 +4137,14 @@ bool PeerManager::SendMessages(CNode* pto)\n                     // receiver rejects addr messages larger than MAX_ADDR_TO_SEND\n                     if (vAddr.size() >= MAX_ADDR_TO_SEND)\n                     {\n-                        m_connman.PushMessage(pto, msgMaker.Make(NetMsgType::ADDR, vAddr));\n+                        m_connman.PushMessage(pto, msgMaker.Make(msg_type, vAddr));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500464672",
      "id" : 500464672,
      "in_reply_to_id" : 499952970,
      "line" : 4140,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ2NDY3Mg==",
      "original_commit_id" : "44364147d739cc4566cd1b202f1effd6f81539d8",
      "original_line" : 4140,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 93,
      "pull_request_review_id" : 503188633,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T17:15:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500464672",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500470051"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500470051"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Testing this branch:\r\n\r\nOne or two restarts (always the first, sometimes a second one as well) after `cp onion_private_key onion_v3_private_key` to run a v2 service\r\n\r\n```\r\nERROR: DeserializeDB: Deserialize or I/O error - ReadCompactSize(): size too large: iostream error \r\nInvalid or missing peers.dat; recreating\r\n```\r\n\r\nOne, and sometimes two, restarts after `rm onion_v3_private_key` to return to v3\r\n\r\n```\r\nERROR: DeserializeDB: Deserialize or I/O error - ReadCompactSize(): size too large: iostream error \r\nInvalid or missing peers.dat; recreating\r\n```\r\n\r\n\r\nEdit: verified that these messages are new in the debug log and were absent from testing of previous versions.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-06T17:24:01Z",
      "diff_hunk" : "@@ -264,6 +264,17 @@ friend class CAddrManTest;\n     void SetServices_(const CService &addr, ServiceFlags nServices) EXCLUSIVE_LOCKS_REQUIRED(cs);\n \n public:\n+    //! Serialization versions.\n+    enum class Format : uint8_t {\n+        V0_HISTORICAL = 0,    //!< historic format, before commit e6b343d88\n+        V1_DETERMINISTIC = 1, //!< for pre-asmap files\n+        V2_ASMAP = 2,         //!< for files including asmap version\n+        V3_BIP155 = 3,        //!< same as V2_ASMAP plus addresses are in BIP155 format\n+    };\n+\n+    //! Serialization / unserialization format.\n+    Format m_format = Format::V3_BIP155;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500470051",
      "id" : 500470051,
      "in_reply_to_id" : 499932221,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ3MDA1MQ==",
      "original_commit_id" : "03572e94cb7249165cc5333c0785e2694c620785",
      "original_line" : 276,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 503195650,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T18:25:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500470051",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500642162"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500642162"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This block shouldn't be needed, `PeerManager::ProcessMessages` will catch exceptions thrown during message processing, and skip to the next message. That doesn't trigger any `Misbehaving`, but whether deserialization failure should have a misbehavior score (and the future of misbehavior scores at all...) seems like an orthogonal issue that needn't be addressed here.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-06T22:57:27Z",
      "diff_hunk" : "@@ -2582,16 +2588,37 @@ void PeerManager::ProcessMessage(CNode& pfrom, const std::string& msg_type, CDat\n         return;\n     }\n \n-    if (msg_type == NetMsgType::ADDR) {\n+    if (msg_type == NetMsgType::ADDR || msg_type == NetMsgType::ADDRv2) {\n+        int stream_version = vRecv.GetVersion();\n+        if (msg_type == NetMsgType::ADDRv2) {\n+            // Add ADDRV2_FORMAT to the version so that the CNetAddr and CAddress\n+            // unserialize methods know that an address in v2 format is coming.\n+            stream_version |= ADDRV2_FORMAT;\n+        }\n+\n+        OverrideStream<CDataStream> s(&vRecv, vRecv.GetType(), stream_version);\n         std::vector<CAddress> vAddr;\n-        vRecv >> vAddr;\n+\n+        try {\n+            s >> vAddr;\n+        } catch (const std::exception& e) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500642162",
      "id" : 500642162,
      "line" : 2604,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY0MjE2Mg==",
      "original_commit_id" : "9502ad10020778722652e41188ae9cdb11e78cf2",
      "original_line" : 2604,
      "original_position" : 46,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 46,
      "pull_request_review_id" : 503416183,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T23:06:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500642162",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500643659"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500643659"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This can instead be:\r\n\r\n```c++\r\nMisbehaving(pfrom.GetId(), 20, strprintf(\"%s message size = %u\", msg_type, vAddr.size()));\r\n```\r\n\r\nAs msg_type is just `const char*`.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-06T23:02:11Z",
      "diff_hunk" : "@@ -2582,16 +2588,37 @@ void PeerManager::ProcessMessage(CNode& pfrom, const std::string& msg_type, CDat\n         return;\n     }\n \n-    if (msg_type == NetMsgType::ADDR) {\n+    if (msg_type == NetMsgType::ADDR || msg_type == NetMsgType::ADDRv2) {\n+        int stream_version = vRecv.GetVersion();\n+        if (msg_type == NetMsgType::ADDRv2) {\n+            // Add ADDRV2_FORMAT to the version so that the CNetAddr and CAddress\n+            // unserialize methods know that an address in v2 format is coming.\n+            stream_version |= ADDRV2_FORMAT;\n+        }\n+\n+        OverrideStream<CDataStream> s(&vRecv, vRecv.GetType(), stream_version);\n         std::vector<CAddress> vAddr;\n-        vRecv >> vAddr;\n+\n+        try {\n+            s >> vAddr;\n+        } catch (const std::exception& e) {\n+            LOCK(cs_main);\n+            Misbehaving(pfrom.GetId(), 20,\n+                strprintf(\n+                    \"Supplied us with a message that contains an unparsable address: %s\",\n+                    e.what()));\n+            return;\n+        }\n \n         if (!pfrom.RelayAddrsWithConn()) {\n             return;\n         }\n         if (vAddr.size() > MAX_ADDR_TO_SEND)\n         {\n-            Misbehaving(pfrom.GetId(), 20, strprintf(\"addr message size = %u\", vAddr.size()));\n+            Misbehaving(pfrom.GetId(), 20,\n+                        strprintf(\"%s message size = %u\",\n+                                  msg_type == NetMsgType::ADDR ? \"addr\" : \"addrv2\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500643659",
      "id" : 500643659,
      "line" : 2620,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY0MzY1OQ==",
      "original_commit_id" : "9502ad10020778722652e41188ae9cdb11e78cf2",
      "original_line" : 2620,
      "original_position" : 63,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 63,
      "pull_request_review_id" : 503416183,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T23:06:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500643659",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500644138"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500644138"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Style nit: constants are all caps, so `ADDRV2`",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-06T23:03:51Z",
      "diff_hunk" : "@@ -76,6 +76,18 @@ extern const char* VERACK;\n  * network.\n  */\n extern const char* ADDR;\n+/**\n+ * The addrv2 message relays connection information for peers on the network just\n+ * like the addr message, but is extended to allow gossiping of longer node\n+ * addresses (see BIP155).\n+ */\n+extern const char *ADDRv2;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500644138",
      "id" : 500644138,
      "line" : 84,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY0NDEzOA==",
      "original_commit_id" : "9502ad10020778722652e41188ae9cdb11e78cf2",
      "original_line" : 84,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : 9,
      "pull_request_review_id" : 503416183,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T23:06:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500644138",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500644218"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500644218"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Style nit: constants are all caps, so `SENDADDRV2`.",
      "commit_id" : "946b79a9d01078b4423a714491ec74a096d16791",
      "created_at" : "2020-10-06T23:04:07Z",
      "diff_hunk" : "@@ -76,6 +76,18 @@ extern const char* VERACK;\n  * network.\n  */\n extern const char* ADDR;\n+/**\n+ * The addrv2 message relays connection information for peers on the network just\n+ * like the addr message, but is extended to allow gossiping of longer node\n+ * addresses (see BIP155).\n+ */\n+extern const char *ADDRv2;\n+/**\n+ * The sendaddrv2 message signals support for receiving ADDRv2 messages (BIP155).\n+ * It also implies that its sender can encode as ADDRv2 and would send ADDRv2\n+ * instead of ADDR to a peer that has signaled ADDRv2 support by sending SENDADDRv2.\n+ */\n+extern const char *SENDADDRv2;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19954#discussion_r500644218",
      "id" : 500644218,
      "line" : 90,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY0NDIxOA==",
      "original_commit_id" : "9502ad10020778722652e41188ae9cdb11e78cf2",
      "original_line" : 90,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : 15,
      "pull_request_review_id" : 503416183,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19954",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-06T23:06:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500644218",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
