[
   {
      "author_association" : "MEMBER",
      "body" : "@vasild you might have some insight here?",
      "created_at" : "2022-11-10T17:26:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26484#issuecomment-1310639387",
      "id" : 1310639387,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26484",
      "node_id" : "IC_kwDOABII585OHsUb",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1310639387/reactions"
      },
      "updated_at" : "2022-11-10T17:26:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1310639387",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Fwiw, if I exec into my container, replace the `bitcoind` string manually with the external IP address and launch bitcoind again, it works â until I restart my container, which assigns a new IP. So it's really just the resolving of the address that doesn't work.",
      "created_at" : "2022-11-10T17:34:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26484#issuecomment-1310650204",
      "id" : 1310650204,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26484",
      "node_id" : "IC_kwDOABII585OHu9c",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1310650204/reactions"
      },
      "updated_at" : "2022-11-10T17:34:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1310650204",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/743306?v=4",
         "events_url" : "https://api.github.com/users/schildbach/events{/privacy}",
         "followers_url" : "https://api.github.com/users/schildbach/followers",
         "following_url" : "https://api.github.com/users/schildbach/following{/other_user}",
         "gists_url" : "https://api.github.com/users/schildbach/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/schildbach",
         "id" : 743306,
         "login" : "schildbach",
         "node_id" : "MDQ6VXNlcjc0MzMwNg==",
         "organizations_url" : "https://api.github.com/users/schildbach/orgs",
         "received_events_url" : "https://api.github.com/users/schildbach/received_events",
         "repos_url" : "https://api.github.com/users/schildbach/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/schildbach/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/schildbach/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/schildbach"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I guess that we do not try to resolve the argument to `-bind` because:\r\n\r\n1. a lookup could return more than one address; yes, we may try to bind to the first one or to all of them, but:\r\n2. a compromised/malicious name server could trick `bitcoind` to bind to an unexpected address, which may have security implications\r\n\r\nThis is not new in 24.0. It was introduced in 2012 in 8f10a2889089af1b2ac64802360494b54c8c7ff1 (see the 3rd argument to `CService()` which equals to `false`, meaning \"no lookup\"). Before that commit it would just bind on all addresses (`-bind` did not exist).\r\n\r\nSince you can set up `/etc/hosts` with the correct address, can you also set up `bitcoin.conf` with the correct address? Or derive the address from `/etc/hosts` before starting `bitcoind`? Something like:\r\n\r\n```sh\r\necho \"bind=$(grep bitcoind /etc/hosts |cut -f 1):8334=onion\" >> bitcoin.conf\r\n```",
      "created_at" : "2022-11-11T09:11:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26484#issuecomment-1311427984",
      "id" : 1311427984,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26484",
      "node_id" : "IC_kwDOABII585OKs2Q",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1311427984/reactions"
      },
      "updated_at" : "2022-11-11T09:11:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1311427984",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I see these options for configuring the bind port of a Tor hidden service:\r\n\r\n1. Use wildcard addresses (`0.0.0.0` and/or `[::]`). This binds correctly, but it seems bitcoind is picking one of them and using that (via Tor control port) for configuration of the target address of the hidden service. This fails, because the wildcard address has a different meaning to the Tor container. To fix this issue, bitcoind could offer a separate configuration option for the target address (which would support hostnames, see below). This issue is tracked in #25094.\r\n2. Use hostnames to bind to a specific external interface, which can be reached via that name or resolved IP from the Tor container. As stated above, bitcoind currently does not support this. I don't get the security argument â it's up to the user to trust their name resolution and configure bitcoind either by hostname or IP as desired.\r\n3. Use fixed numerical IP, which can be reached from the Tor container. However, IPs are typically assigned dynamically (e.g. by Docker). This makes configuration overly complicated, as your workaround clearly shows. For example, Docker containers use arbitrary values in `/etc/hosts` and `/etc/hostname` by default, so your workaround wouldn't work out of the box. I'd rather use `nslookup`, if I were to go that route.\r\n\r\nAs you can see, currently none of the options work with the configuration of a Tor hidden service, managed by bitcoind via control port. Currently I can only revert back to the old method of managing the hidden service in the Tor container.",
      "created_at" : "2022-11-11T09:51:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26484#issuecomment-1311473688",
      "id" : 1311473688,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26484",
      "node_id" : "IC_kwDOABII585OK4AY",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1311473688/reactions"
      },
      "updated_at" : "2022-11-11T09:51:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1311473688",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/743306?v=4",
         "events_url" : "https://api.github.com/users/schildbach/events{/privacy}",
         "followers_url" : "https://api.github.com/users/schildbach/followers",
         "following_url" : "https://api.github.com/users/schildbach/following{/other_user}",
         "gists_url" : "https://api.github.com/users/schildbach/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/schildbach",
         "id" : 743306,
         "login" : "schildbach",
         "node_id" : "MDQ6VXNlcjc0MzMwNg==",
         "organizations_url" : "https://api.github.com/users/schildbach/orgs",
         "received_events_url" : "https://api.github.com/users/schildbach/received_events",
         "repos_url" : "https://api.github.com/users/schildbach/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/schildbach/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/schildbach/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/schildbach"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@schildbach is this behavior something new? Is it a regression since an older version of `bitcoind` which worked \"better\"?\r\n\r\n> ... I don't get the security argument ...\r\n\r\nIf you feel that this should be changed, then you should open an issue for that or even a pull request that flips `false` to `true` on this line:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/7ef730ca84bd71a06f986ae7070e7b2ac8e47582/src/init.cpp#L1720\r\n\r\nDon't be deterred by my opinion - it is just one. Maybe others would think it is ok to change it.\r\n\r\nFWIW I checked the behavior of:\r\n* Tor (`SOCKSPort google.com:9050`)\r\n* Apache (`Listen google.com:80`) and\r\n* sshd (`ListenAddress google.com`)\r\n\r\nAll of them do resolve the name to an IP address and try to bind to it (and of course failed miserably with my examples).\r\n\r\nI guess that `bitcoind` only supports option 3 currently. Somehow is has been assumed that the operator knows their IP address. I understand that Docker makes this difficult. I am not very familiar with it, but does it not provide the option to run some custom setup scripts inside the host OS after setting it up and the IP address to be in some environment variable, available to such a script?\r\n\r\n> Currently I can only revert back to the old method of managing the hidden service in the Tor container.\r\n\r\nWhat is that old method?",
      "created_at" : "2022-11-11T10:43:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26484#issuecomment-1311531762",
      "id" : 1311531762,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26484",
      "node_id" : "IC_kwDOABII585OLGLy",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1311531762/reactions"
      },
      "updated_at" : "2022-11-11T13:08:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1311531762",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> What is that old method?\r\n\r\nRather than letting bitcoind manage the Tor hidden servce via the control port, you'd configure it with tor (look up tor options `HiddenServiceDir`, `HiddenServicePort`). In this case, you configure the target address within tor, and tor has no regrets using hostname resolution. The main downside is the hidden service private key is then managed by Tor.\r\n\r\nBoth approaches are described in `doc/tor.md`, however it is missing documentation of the various pitfalls which come with `-torcontrol` mode.\r\n\r\n> Is this behavior something new?\r\n\r\nWell, I'm trying to get it to work for months now. 24.0 had some other bug fixed that prevented `-torcontrol` mode, but now I'm running into more problems.",
      "created_at" : "2022-11-11T11:50:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26484#issuecomment-1311601037",
      "id" : 1311601037,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26484",
      "node_id" : "IC_kwDOABII585OLXGN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1311601037/reactions"
      },
      "updated_at" : "2022-11-11T11:51:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1311601037",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/743306?v=4",
         "events_url" : "https://api.github.com/users/schildbach/events{/privacy}",
         "followers_url" : "https://api.github.com/users/schildbach/followers",
         "following_url" : "https://api.github.com/users/schildbach/following{/other_user}",
         "gists_url" : "https://api.github.com/users/schildbach/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/schildbach",
         "id" : 743306,
         "login" : "schildbach",
         "node_id" : "MDQ6VXNlcjc0MzMwNg==",
         "organizations_url" : "https://api.github.com/users/schildbach/orgs",
         "received_events_url" : "https://api.github.com/users/schildbach/received_events",
         "repos_url" : "https://api.github.com/users/schildbach/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/schildbach/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/schildbach/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/schildbach"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@michaelfolkson can you fix this?",
      "created_at" : "2022-11-11T17:01:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26484#issuecomment-1311949258",
      "id" : 1311949258,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26484",
      "node_id" : "IC_kwDOABII585OMsHK",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1311949258/reactions"
      },
      "updated_at" : "2022-11-11T17:01:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1311949258",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/94559964?v=4",
         "events_url" : "https://api.github.com/users/1440000bytes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/1440000bytes/followers",
         "following_url" : "https://api.github.com/users/1440000bytes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/1440000bytes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/1440000bytes",
         "id" : 94559964,
         "login" : "1440000bytes",
         "node_id" : "U_kgDOBaLe3A",
         "organizations_url" : "https://api.github.com/users/1440000bytes/orgs",
         "received_events_url" : "https://api.github.com/users/1440000bytes/received_events",
         "repos_url" : "https://api.github.com/users/1440000bytes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/1440000bytes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/1440000bytes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/1440000bytes"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Not completely sure what the status is here, but I've moved this to the 24.1 milestone.",
      "created_at" : "2022-11-17T14:06:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26484#issuecomment-1318689075",
      "id" : 1318689075,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26484",
      "node_id" : "IC_kwDOABII585OmZkz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1318689075/reactions"
      },
      "updated_at" : "2022-11-17T14:06:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1318689075",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   }
]
