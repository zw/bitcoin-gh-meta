[
   {
      "body" : "Waiting for Travis to pass, but needs some review then.\r\n @gavinandresen @laanwj Mind looking at this?",
      "created_at" : "2014-12-12T09:08:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66747915",
      "id" : 66747915,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T09:08:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66747915",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "This was the problem:\r\n<pre>\r\n********* Start testing of PaymentServerTests *********\r\nConfig: Using QTest library 4.6.4, Qt 4.6.4\r\nPASS : PaymentServerTests::initTestCase()\r\nQDEBUG : PaymentServerTests::paymentServerTests() PaymentServer::initNetManager : No active proxy server found.\r\nQDEBUG : PaymentServerTests::paymentServerTests() PaymentServer::processPaymentRequest : Secure payment request from \"testmerchant.org\"\r\nQWARN : PaymentServerTests::paymentServerTests() PaymentRequestPlus::getMerchant : Payment request: certificate expired or not yet active: QSslCertificate( \"3\" , \"3\" , \"LxHILx+N3qwVoAcCmQ5cyw==\" , \"\" , \"Expired Test Merchant\" , QMap() , QDateTime(\"Sat Feb 23 21:26:43 2013\") , QDateTime(\"Sun Feb 24 21:26:43 2013\") )\r\nFAIL! : PaymentServerTests::paymentServerTests() Compared values are not the same\r\nLoc: [qt/test/paymentservertests.cpp(87)]\r\nPASS : PaymentServerTests::cleanupTestCase()\r\nTotals: 2 passed, 1 failed, 0 skipped\r\n********* Finished testing of PaymentServerTests *********\r\n</pre>\r\n\r\nTried to fix by using QVERIFY instead of QCOMPARE, as the return value of getMerchant is a bit field.\r\n\r\nEdit: WoW, we are still using Qt 4.6.4 for verifying and building in Travis!?",
      "created_at" : "2014-12-12T09:41:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66751100",
      "id" : 66751100,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T09:42:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66751100",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "Isn't this the same discussion we had before? Certificate problems should be logged, but not lead to rejection of the payment request or scary messages shown to the user. It just means that the payment request is unvalidated.\r\n",
      "created_at" : "2014-12-12T12:01:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66764407",
      "id" : 66764407,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T12:01:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66764407",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5466#discussion_r21740580"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5466"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/21740580"
         }
      },
      "body" : "Would be clearer as a plain enumeration instead of a bit field?\r\n",
      "commit_id" : "d8087038cb57117e6d6c5128eda5f9e055ecd6dd",
      "created_at" : "2014-12-12T12:04:36Z",
      "diff_hunk" : "@@ -13,6 +13,17 @@\n #include <QList>\n #include <QString>\n \n+// Used in getMerchant() to return state\n+enum GetMerchantStatus {\n+    PR_NOTINITIALIZED = 0,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#discussion_r21740580",
      "id" : 21740580,
      "original_commit_id" : "36e5ada1a181ca428c295b12ccf44bdc3fe6e619",
      "original_position" : 6,
      "path" : "src/qt/paymentrequestplus.h",
      "position" : 6,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5466",
      "updated_at" : "2015-01-15T13:20:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/21740580",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@laanwj You are not serious with your above comment? Current master currently doesn't even explicitly care whats going on if we have cert failures... I'm not sure but perhaps this could potentially be dangerous even. I'm doing my best to improve our code and it feel like this isn't wanted anymore...",
      "created_at" : "2014-12-12T12:31:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66766945",
      "id" : 66766945,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T12:31:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66766945",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "@Diapolo It is dangerous if it is possible to make an invalid signature pass as authenticated merchant. Does that happen?\r\nIf not it makes no sense. An attacker can just as well replace the payment request with an unsigned one as mess up the signature, so from a security perspective there is no reason to treat signature errors differently from unsigned payment requests.",
      "created_at" : "2014-12-12T12:34:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66767204",
      "id" : 66767204,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T12:34:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66767204",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5466#discussion_r21741756"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5466"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/21741756"
         }
      },
      "body" : "Please use authenticated/unauthenticated instead of secure/insecure. \r\nIf we treat certificate errors as 'unauthenticated' those two statuses are enough.\r\n",
      "commit_id" : "d8087038cb57117e6d6c5128eda5f9e055ecd6dd",
      "created_at" : "2014-12-12T12:39:07Z",
      "diff_hunk" : "@@ -13,6 +13,17 @@\n #include <QList>\n #include <QString>\n \n+// Used in getMerchant() to return state\n+enum GetMerchantStatus {\n+    PR_NOTINITIALIZED = 0,\n+    PR_PKIERROR = (1U << 0),\n+    PR_CERTERROR = (1U << 1),\n+    PR_INSECURE = (1U << 2),\n+    PR_SECURE = (1U << 3),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#discussion_r21741756",
      "id" : 21741756,
      "original_commit_id" : "36e5ada1a181ca428c295b12ccf44bdc3fe6e619",
      "original_position" : 10,
      "path" : "src/qt/paymentrequestplus.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5466",
      "updated_at" : "2015-01-15T13:20:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/21741756",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "IMHO the current behaviour can make invalid secure payment (invalid because of cert errors and authenticatedMerchant not set) requests to be treated like valid insecure payment requests, which is bad as they should be rejected directly!",
      "created_at" : "2014-12-12T12:39:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66767689",
      "id" : 66767689,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T12:39:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66767689",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "From BIP70: ``The recipient must verify the certificate chain according to [RFC5280] and reject the PaymentRequest if any validation failure occurs.``\r\n\r\nhttps://github.com/bitcoin/bips/blob/master/bip-0070.mediawiki#Certificates",
      "created_at" : "2014-12-12T12:42:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66767900",
      "id" : 66767900,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T12:42:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66767900",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "As I said: Unauthenticated is unauthenticated, it doesn't matter from a security viewpoint if that's caused by an invalid signature (\"cert errors\") or not having a signature in the first place (\"unsecure\"). Both attacks, so stripping or corrupting the signature, require the same effort to pull off.\r\n\r\nIf getMerchant returns false in the case of errors, that's enough to signal that authentication was not successful and thus not show the payment request in green.\r\n\r\nAlso ping @mikehearn .",
      "created_at" : "2014-12-12T12:46:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66768246",
      "id" : 66768246,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T12:46:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66768246",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@laanwj It's not correct to rely on false to signal errors, as a valid insecure payment request as per BIP70 would also return false with current master in ``getMerchant``.",
      "created_at" : "2014-12-12T12:47:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66768329",
      "id" : 66768329,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T12:47:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66768329",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "Our own protection here currently is a yellow background in the GUI and a tooltip, which sais this is an unverified payment request. Don't you think that could trick our users into a bad situation?",
      "created_at" : "2014-12-12T12:48:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66768440",
      "id" : 66768440,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T12:48:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66768440",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "Yeah, we should be ignoring cert errors and treating the payment request as unsigned. Sounds like BIP70 doesn't say that explicitly, but IMHO it should. I should spend some time refreshing it and working on pp related stuff.\r\n\r\nThe rationale is pretty simple - if we want to introduce a new set of root CAs in future (e.g. that have different requirements from browser root store programs), then we don't want payment requests signed with the new CAs to trigger errors. It's better if they are just not shown as authenticated. In this way, we can do backwards compatible upgrades.",
      "created_at" : "2014-12-12T12:50:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66768618",
      "id" : 66768618,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T12:50:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66768618",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/971089?v=3",
         "events_url" : "https://api.github.com/users/mikehearn/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mikehearn/followers",
         "following_url" : "https://api.github.com/users/mikehearn/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mikehearn/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mikehearn",
         "id" : 971089,
         "login" : "mikehearn",
         "organizations_url" : "https://api.github.com/users/mikehearn/orgs",
         "received_events_url" : "https://api.github.com/users/mikehearn/received_events",
         "repos_url" : "https://api.github.com/users/mikehearn/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mikehearn/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mikehearn/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mikehearn"
      }
   },
   {
      "body" : "@diapolo As I'm now trying to communicate for the third time: **those two cases are equivalent**. No, it cannot trick the user into anything. An attacker can just as well present an unverified payment request as one with an invalid signature. Showing them differently does not add any extra security. It's security theater.\r\nA yellow payment request (which will not have an authenticated merchant) already means \"be very careful, you're probably being tricked\".\r\n",
      "created_at" : "2014-12-12T12:52:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66768771",
      "id" : 66768771,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T12:53:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66768771",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Invalid secure == valid insecure seems not right and is against current spec. If an attacker would be able to manipulate a payment request from a merchant to pay him instead of the merchant and the only precaution is that we treat that invalid secure payment request as a valid insecure one is good? If this is consensus I'm out and out of motivation also... sadly.",
      "created_at" : "2014-12-12T12:58:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66769384",
      "id" : 66769384,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T12:58:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66769384",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "**An attacker can manipulate the signed payment request into a valid insecure one that pays him** just as easily. It would make more sense, even, as a user wouldn't expect that, especially if certificate failures were flagged differently.\r\n",
      "created_at" : "2014-12-12T13:00:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66769548",
      "id" : 66769548,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T13:00:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66769548",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "This needs at least a clarification in the BIP, also in terms of valid unverified payment requests, which have just set pki_type == \"none\", which is not the case for ones that should have been valid verified ones (but are treated like unverified ones).",
      "created_at" : "2014-12-12T13:06:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66770028",
      "id" : 66770028,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T13:06:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66770028",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "> If an attacker would be able to manipulate a payment request from a merchant to pay him instead of the merchant and the only precaution is that we treat that invalid secure payment request as a valid insecure one is good?\r\n\r\nYes, ultimately the *only* way we have to ensure users are secure against MITM attacks is to train users to expect signed requests. That's it. It's like SSL in that respect - if you can be a MITM then you can do SSL stripping attacks and unless the client knows to expect authentication, or the user checks for the padlock, you still win. The joys of backwards compatibility, huh! \r\n\r\nPerhaps one day signed payment requests will be so common that we can actually show unsigned requests in some kind of warning, or red/yellow colour. But that would be very hard to accomplish. The PKI isn't suitable for everyone today. In future additional PKIs might make it so, but that's years off.",
      "created_at" : "2014-12-12T13:53:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66774732",
      "id" : 66774732,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T13:53:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66774732",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/971089?v=3",
         "events_url" : "https://api.github.com/users/mikehearn/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mikehearn/followers",
         "following_url" : "https://api.github.com/users/mikehearn/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mikehearn/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mikehearn",
         "id" : 971089,
         "login" : "mikehearn",
         "organizations_url" : "https://api.github.com/users/mikehearn/orgs",
         "received_events_url" : "https://api.github.com/users/mikehearn/received_events",
         "repos_url" : "https://api.github.com/users/mikehearn/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mikehearn/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mikehearn/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mikehearn"
      }
   },
   {
      "body" : "If we show a warning and the users explicitly chooses to accept that, he can continue by using the invalid verified request as valid unverified request, what about that idea? That would at least be like with browsers and invalid SSL certs or SSL connection problems.",
      "created_at" : "2014-12-12T13:59:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66775340",
      "id" : 66775340,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T13:59:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66775340",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "Error-handling policy does NOT belong in that BIP; e.g. certificate errors will be handled differently in GUI apps than machine-to-machine scenarios.\r\n\r\n\r\n\r\n\r\n\r\n\r\n> On Dec 12, 2014, at 8:06 AM, P. Kaufmann <notifications@github.com> wrote:\r\n> \r\n> This needs at least a clarification in the BIP, also in terms of valid unverified payment requests, which have just set pki_type == \"none\", which is not the case for ones that should have been valid verified ones (but are treated like unverified ones).\r\n> \r\n> Ã¢ÂÂ\r\n> Reply to this email directly or view it on GitHub.\r\n> ",
      "created_at" : "2014-12-12T13:59:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66775352",
      "id" : 66775352,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T13:59:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66775352",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "BIP should not specify a policy but I think UI recommendations are OK, as otherwise we'll keep having these discussions with every wallet dev.\r\n\r\n@Diapolo the way browsers do it is a source of significant discontent in parts of the security community, and generally they try and stop users clicking through or forbid it entirely anyway. The problem with what browsers do is it does make revoking CAs hard, and it makes self signed certs even harder. We all used to believe self signed certs were useless because any MITM could break it, but now we know there are adversaries (like governments) that do passive attacks way more frequently than active attacks. So browser UI is looking less appropriate as time goes on. It would not surprise me if it changed in future.\r\n\r\nUnfortunately there can be no equivalent of HSTS in the Bitcoin world because the user doesn't generally tell their wallet who they want to pay. So we can't know if a request is expected to be signed or not.",
      "created_at" : "2014-12-12T14:07:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66776368",
      "id" : 66776368,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T14:07:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66776368",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/971089?v=3",
         "events_url" : "https://api.github.com/users/mikehearn/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mikehearn/followers",
         "following_url" : "https://api.github.com/users/mikehearn/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mikehearn/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mikehearn",
         "id" : 971089,
         "login" : "mikehearn",
         "organizations_url" : "https://api.github.com/users/mikehearn/orgs",
         "received_events_url" : "https://api.github.com/users/mikehearn/received_events",
         "repos_url" : "https://api.github.com/users/mikehearn/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mikehearn/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mikehearn/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mikehearn"
      }
   },
   {
      "body" : "Fine, so to not make my work obsolete alltogether, what about keeping the code and the added tests but just don't require or add new UX or user interactions needs!? That way it's possible to extend in the future, have more in-depth test cases and speaking return values.",
      "created_at" : "2014-12-12T14:21:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66777890",
      "id" : 66777890,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T14:21:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66777890",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5466#discussion_r21746323"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5466"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/21746323"
         }
      },
      "body" : "Will do, thanks.",
      "commit_id" : "d8087038cb57117e6d6c5128eda5f9e055ecd6dd",
      "created_at" : "2014-12-12T14:24:04Z",
      "diff_hunk" : "@@ -13,6 +13,17 @@\n #include <QList>\n #include <QString>\n \n+// Used in getMerchant() to return state\n+enum GetMerchantStatus {\n+    PR_NOTINITIALIZED = 0,\n+    PR_PKIERROR = (1U << 0),\n+    PR_CERTERROR = (1U << 1),\n+    PR_INSECURE = (1U << 2),\n+    PR_SECURE = (1U << 3),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#discussion_r21746323",
      "id" : 21746323,
      "original_commit_id" : "36e5ada1a181ca428c295b12ccf44bdc3fe6e619",
      "original_position" : 10,
      "path" : "src/qt/paymentrequestplus.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5466",
      "updated_at" : "2015-01-15T13:20:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/21746323",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "Added a commit to achieve some consensus with this :).",
      "created_at" : "2014-12-12T14:46:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-66781092",
      "id" : 66781092,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-12T14:46:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66781092",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "@laanwj Is this mergeable in the state after my second commit?",
      "created_at" : "2014-12-16T13:18:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-67157931",
      "id" : 67157931,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-16T13:18:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/67157931",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "Rebased to be a single commit and updated commit-msg.",
      "created_at" : "2014-12-20T13:32:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-67735909",
      "id" : 67735909,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2014-12-20T13:32:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/67735909",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5466#discussion_r22648402"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5466"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/22648402"
         }
      },
      "body" : "Shouldn't this be `&` instead of `|` ? This will always pass.\r\n",
      "commit_id" : "d8087038cb57117e6d6c5128eda5f9e055ecd6dd",
      "created_at" : "2015-01-08T12:13:41Z",
      "diff_hunk" : "@@ -74,31 +74,31 @@ void PaymentServerTests::paymentServerTests()\n     std::vector<unsigned char> data = DecodeBase64(paymentrequest1_BASE64);\n     SendCoinsRecipient r = handleRequest(server, data);\n     QString merchant;\n-    r.paymentRequest.getMerchant(caStore, merchant);\n+    QVERIFY(r.paymentRequest.getMerchant(caStore, merchant) & PR_AUTHENTICATED);\n     QCOMPARE(merchant, QString(\"testmerchant.org\"));\n \n     // Version of the above, with an expired certificate:\n     data = DecodeBase64(paymentrequest2_BASE64);\n     r = handleRequest(server, data);\n-    r.paymentRequest.getMerchant(caStore, merchant);\n+    QVERIFY(r.paymentRequest.getMerchant(caStore, merchant) | PR_ERROR);\n     QCOMPARE(merchant, QString(\"\"));\n \n     // Long certificate chain:\n     data = DecodeBase64(paymentrequest3_BASE64);\n     r = handleRequest(server, data);\n-    r.paymentRequest.getMerchant(caStore, merchant);\n+    QVERIFY(r.paymentRequest.getMerchant(caStore, merchant) & PR_AUTHENTICATED);\n     QCOMPARE(merchant, QString(\"testmerchant8.org\"));\n \n     // Long certificate chain, with an expired certificate in the middle:\n     data = DecodeBase64(paymentrequest4_BASE64);\n     r = handleRequest(server, data);\n-    r.paymentRequest.getMerchant(caStore, merchant);\n+    QVERIFY(r.paymentRequest.getMerchant(caStore, merchant) | PR_ERROR);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#discussion_r22648402",
      "id" : 22648402,
      "original_commit_id" : "bfb9cf99547dbb3ab12e1791825161ed7ab2ea91",
      "original_position" : 26,
      "path" : "src/qt/test/paymentservertests.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5466",
      "updated_at" : "2015-01-15T13:20:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/22648402",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5466#discussion_r22654406"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5466"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/22654406"
         }
      },
      "body" : "I had the impression because of ``PR_ERROR = (PR_NOTINITIALIZED | PR_PKIERROR | PR_CERTERROR)`` this is correct, no?",
      "commit_id" : "d8087038cb57117e6d6c5128eda5f9e055ecd6dd",
      "created_at" : "2015-01-08T14:39:25Z",
      "diff_hunk" : "@@ -74,31 +74,31 @@ void PaymentServerTests::paymentServerTests()\n     std::vector<unsigned char> data = DecodeBase64(paymentrequest1_BASE64);\n     SendCoinsRecipient r = handleRequest(server, data);\n     QString merchant;\n-    r.paymentRequest.getMerchant(caStore, merchant);\n+    QVERIFY(r.paymentRequest.getMerchant(caStore, merchant) & PR_AUTHENTICATED);\n     QCOMPARE(merchant, QString(\"testmerchant.org\"));\n \n     // Version of the above, with an expired certificate:\n     data = DecodeBase64(paymentrequest2_BASE64);\n     r = handleRequest(server, data);\n-    r.paymentRequest.getMerchant(caStore, merchant);\n+    QVERIFY(r.paymentRequest.getMerchant(caStore, merchant) | PR_ERROR);\n     QCOMPARE(merchant, QString(\"\"));\n \n     // Long certificate chain:\n     data = DecodeBase64(paymentrequest3_BASE64);\n     r = handleRequest(server, data);\n-    r.paymentRequest.getMerchant(caStore, merchant);\n+    QVERIFY(r.paymentRequest.getMerchant(caStore, merchant) & PR_AUTHENTICATED);\n     QCOMPARE(merchant, QString(\"testmerchant8.org\"));\n \n     // Long certificate chain, with an expired certificate in the middle:\n     data = DecodeBase64(paymentrequest4_BASE64);\n     r = handleRequest(server, data);\n-    r.paymentRequest.getMerchant(caStore, merchant);\n+    QVERIFY(r.paymentRequest.getMerchant(caStore, merchant) | PR_ERROR);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#discussion_r22654406",
      "id" : 22654406,
      "original_commit_id" : "bfb9cf99547dbb3ab12e1791825161ed7ab2ea91",
      "original_position" : 26,
      "path" : "src/qt/test/paymentservertests.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5466",
      "updated_at" : "2015-01-15T13:20:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/22654406",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5466#discussion_r22654828"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5466"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/22654828"
         }
      },
      "body" : "QVERIFY(x) where x is not zero will pass.\r\nx = result | PR_PERROR is always non-zero. An OR operation with a non-zero value always results in a non-zero value.\r\n\r\n",
      "commit_id" : "d8087038cb57117e6d6c5128eda5f9e055ecd6dd",
      "created_at" : "2015-01-08T14:45:58Z",
      "diff_hunk" : "@@ -74,31 +74,31 @@ void PaymentServerTests::paymentServerTests()\n     std::vector<unsigned char> data = DecodeBase64(paymentrequest1_BASE64);\n     SendCoinsRecipient r = handleRequest(server, data);\n     QString merchant;\n-    r.paymentRequest.getMerchant(caStore, merchant);\n+    QVERIFY(r.paymentRequest.getMerchant(caStore, merchant) & PR_AUTHENTICATED);\n     QCOMPARE(merchant, QString(\"testmerchant.org\"));\n \n     // Version of the above, with an expired certificate:\n     data = DecodeBase64(paymentrequest2_BASE64);\n     r = handleRequest(server, data);\n-    r.paymentRequest.getMerchant(caStore, merchant);\n+    QVERIFY(r.paymentRequest.getMerchant(caStore, merchant) | PR_ERROR);\n     QCOMPARE(merchant, QString(\"\"));\n \n     // Long certificate chain:\n     data = DecodeBase64(paymentrequest3_BASE64);\n     r = handleRequest(server, data);\n-    r.paymentRequest.getMerchant(caStore, merchant);\n+    QVERIFY(r.paymentRequest.getMerchant(caStore, merchant) & PR_AUTHENTICATED);\n     QCOMPARE(merchant, QString(\"testmerchant8.org\"));\n \n     // Long certificate chain, with an expired certificate in the middle:\n     data = DecodeBase64(paymentrequest4_BASE64);\n     r = handleRequest(server, data);\n-    r.paymentRequest.getMerchant(caStore, merchant);\n+    QVERIFY(r.paymentRequest.getMerchant(caStore, merchant) | PR_ERROR);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#discussion_r22654828",
      "id" : 22654828,
      "original_commit_id" : "bfb9cf99547dbb3ab12e1791825161ed7ab2ea91",
      "original_position" : 26,
      "path" : "src/qt/test/paymentservertests.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5466",
      "updated_at" : "2015-01-15T13:20:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/22654828",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5466#discussion_r22716917"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5466"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/22716917"
         }
      },
      "body" : "Changed to be a ``&``.",
      "commit_id" : "d8087038cb57117e6d6c5128eda5f9e055ecd6dd",
      "created_at" : "2015-01-09T14:04:31Z",
      "diff_hunk" : "@@ -74,31 +74,31 @@ void PaymentServerTests::paymentServerTests()\n     std::vector<unsigned char> data = DecodeBase64(paymentrequest1_BASE64);\n     SendCoinsRecipient r = handleRequest(server, data);\n     QString merchant;\n-    r.paymentRequest.getMerchant(caStore, merchant);\n+    QVERIFY(r.paymentRequest.getMerchant(caStore, merchant) & PR_AUTHENTICATED);\n     QCOMPARE(merchant, QString(\"testmerchant.org\"));\n \n     // Version of the above, with an expired certificate:\n     data = DecodeBase64(paymentrequest2_BASE64);\n     r = handleRequest(server, data);\n-    r.paymentRequest.getMerchant(caStore, merchant);\n+    QVERIFY(r.paymentRequest.getMerchant(caStore, merchant) | PR_ERROR);\n     QCOMPARE(merchant, QString(\"\"));\n \n     // Long certificate chain:\n     data = DecodeBase64(paymentrequest3_BASE64);\n     r = handleRequest(server, data);\n-    r.paymentRequest.getMerchant(caStore, merchant);\n+    QVERIFY(r.paymentRequest.getMerchant(caStore, merchant) & PR_AUTHENTICATED);\n     QCOMPARE(merchant, QString(\"testmerchant8.org\"));\n \n     // Long certificate chain, with an expired certificate in the middle:\n     data = DecodeBase64(paymentrequest4_BASE64);\n     r = handleRequest(server, data);\n-    r.paymentRequest.getMerchant(caStore, merchant);\n+    QVERIFY(r.paymentRequest.getMerchant(caStore, merchant) | PR_ERROR);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#discussion_r22716917",
      "id" : 22716917,
      "original_commit_id" : "bfb9cf99547dbb3ab12e1791825161ed7ab2ea91",
      "original_position" : 26,
      "path" : "src/qt/test/paymentservertests.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5466",
      "updated_at" : "2015-01-15T13:20:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/22716917",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "@zander We recently seem to use the term ``authenticated payment request`` and therefore this change was included by me. IMHO known is not strong or correct enough.",
      "created_at" : "2015-01-13T11:44:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-69732708",
      "id" : 69732708,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2015-01-13T11:44:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/69732708",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "@laanwj What about this here?",
      "created_at" : "2015-03-24T18:15:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5466#issuecomment-85628604",
      "id" : 85628604,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5466",
      "updated_at" : "2015-03-24T18:15:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/85628604",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   }
]
