{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "NONE",
   "body" : "v0.15.1 on Fedora 23 just added `addnode=nkf5e6b7pl4jfd4a.onion` in `bitcoin.conf` and loading is stuck on the splash screen with \"Done loading\" message for many minutes. Regular activity in the debug log but, I am getting new tip's pretty early on without any version messages first. Added node is not showing in the GUI once loading is eventually finished (I suppose it is down?)\r\n\r\n`bitcoin.conf`\r\n```uacomment={redacted}\r\nprune=10239\r\nbanscore=10\r\nbantime=31536000\r\nmaxmempool=900\r\nmempoolexpiry=2160\r\nproxy=127.0.0.1:9050\r\nlisten=1\r\nbind=127.0.0.1\r\naddnode=nkf5e6b7pl4jfd4a.onion\r\n```\r\n\r\n`debug.log`\r\n```2018-02-05 12:52:01 Bitcoin version v0.15.1\r\n2018-02-05 12:52:01 InitParameterInteraction: parameter interaction: -proxy set -> setting -upnp=0\r\n2018-02-05 12:52:01 InitParameterInteraction: parameter interaction: -proxy set -> setting -discover=0\r\n2018-02-05 12:52:01 InitParameterInteraction: parameter interaction: -whitelistforcerelay=1 -> setting -whitelistrelay=1\r\n2018-02-05 12:52:01 Assuming ancestors of block 0000000000000000003b9ce759c2a087d52abc4266f8f4ebd6d768b89defa50a have valid signatures.\r\n2018-02-05 12:52:01 Setting nMinimumChainWork=000000000000000000000000000000000000000000723d3581fe1bd55373540a\r\n2018-02-05 12:52:01 Prune configured to target 10239MiB on disk for block and undo files.\r\n2018-02-05 12:52:01 Using the 'standard' SHA256 implementation\r\n2018-02-05 12:52:01 Using RdRand as an additional entropy source\r\n2018-02-05 12:52:01 Default data directory /{default}/.bitcoin\r\n2018-02-05 12:52:01 Using data directory /{default}/.bitcoin\r\n2018-02-05 12:52:01 Using config file /{default}/.bitcoin/bitcoin.conf\r\n2018-02-05 12:52:01 Using at most 125 automatic connections (1024 file descriptors available)\r\n2018-02-05 12:52:01 Using 16 MiB out of 32/2 requested for signature cache, able to store 524288 elements\r\n2018-02-05 12:52:01 Using 16 MiB out of 32/2 requested for script execution cache, able to store 524288 elements\r\n2018-02-05 12:52:01 Using 2 threads for script verification\r\n2018-02-05 12:52:01 scheduler thread start\r\n2018-02-05 12:52:01 init message: Verifying wallet(s)...\r\n2018-02-05 12:52:01 Using BerkeleyDB version Berkeley DB 4.8.30: (April  9, 2010)\r\n2018-02-05 12:52:01 Using wallet wallet.dat\r\n2018-02-05 12:52:01 CDBEnv::Open: LogDir=/{default}/.bitcoin/database ErrorFile=/{default}/.bitcoin/db.log\r\n2018-02-05 12:52:02 Cache configuration:\r\n2018-02-05 12:52:02 * Using 2.0MiB for block index database\r\n2018-02-05 12:52:02 * Using 8.0MiB for chain state database\r\n2018-02-05 12:52:02 * Using 440.0MiB for in-memory UTXO set (plus up to 858.3MiB of unused mempool space)\r\n2018-02-05 12:52:02 init message: Loading block index...\r\n2018-02-05 12:52:02 Opening LevelDB in /{default}/.bitcoin/blocks/index\r\n2018-02-05 12:52:02 Opened LevelDB successfully\r\n2018-02-05 12:52:02 Using obfuscation key for /{default}/.bitcoin/blocks/index: 0000000000000000\r\n2018-02-05 12:52:09 LoadBlockIndexDB: last block file = 1167\r\n2018-02-05 12:52:09 LoadBlockIndexDB: last block file info: CBlockFileInfo(blocks=55, size=61790110, heights=507638...507772, time=2018-02-04...2018-02-05)\r\n2018-02-05 12:52:09 Checking all blk files are present...\r\n2018-02-05 12:52:09 LoadBlockIndexDB(): Block files have previously been pruned\r\n2018-02-05 12:52:09 LoadBlockIndexDB: transaction index disabled\r\n2018-02-05 12:52:09 Opening LevelDB in /{default}/.bitcoin/chainstate\r\n2018-02-05 12:52:09 Opened LevelDB successfully\r\n2018-02-05 12:52:09 Using obfuscation key for /{default}/.bitcoin/chainstate: {redacted}\r\n2018-02-05 12:52:09 Loaded best chain: hashBestChain=000000000000000000463e98ae2fa6cf30840d8774f80e85e70e819bf731dfba height=507764 date=2018-02-05 10:33:50 progress=0.999914\r\n2018-02-05 12:52:09 init message: Rewinding blocks...\r\n2018-02-05 12:52:11 init message: Verifying blocks...\r\n2018-02-05 12:52:11 Verifying last 6 blocks at level 3\r\n2018-02-05 12:52:11 [0%]...[16%]...[33%]...[50%]...[66%]...[83%]...[99%]...[DONE].\r\n2018-02-05 12:52:26 No coin database inconsistencies in last 7 blocks (7254 transactions)\r\n2018-02-05 12:52:26  block index   24927ms\r\n2018-02-05 12:52:27 init message: Loading wallet...\r\n2018-02-05 12:52:27 nFileVersion = 150100\r\n2018-02-05 12:52:27 Keys: 0 plaintext, 4014 encrypted, 4014 w/ metadata, 4014 total\r\n2018-02-05 12:52:27  wallet  298ms\r\n2018-02-05 12:52:27 setKeyPool.size() = 1997\r\n2018-02-05 12:52:27 mapWallet.size() = 13\r\n2018-02-05 12:52:27 mapAddressBook.size() = 14\r\n2018-02-05 12:52:27 Unsetting NODE_NETWORK on prune mode\r\n2018-02-05 12:52:27 init message: Pruning blockstore...\r\n2018-02-05 12:52:27 mapBlockIndex.size() = 507779\r\n2018-02-05 12:52:27 nBestHeight = 507764\r\n2018-02-05 12:52:27 torcontrol thread start\r\n2018-02-05 12:52:27 Bound to 127.0.0.1:8333\r\n2018-02-05 12:52:27 init message: Loading P2P addresses...\r\n2018-02-05 12:52:27 tor: Got service ID {onion}, advertising service {onion}.onion:8333\r\n2018-02-05 12:52:27 AddLocal({onion}.onion:8333,4)\r\n2018-02-05 12:52:28 Loaded 66259 addresses from peers.dat  1377ms\r\n2018-02-05 12:52:28 init message: Loading banlist...\r\n2018-02-05 12:52:28 init message: Starting network threads...\r\n2018-02-05 12:52:28 init message: Done loading\r\n2018-02-05 12:52:28 net thread start\r\n2018-02-05 12:52:28 dnsseed thread start\r\n2018-02-05 12:52:28 addcon thread start\r\n2018-02-05 12:52:28 opencon thread start\r\n2018-02-05 12:52:28 msghand thread start\r\n2018-02-05 12:52:39 Loading addresses from DNS seeds (could take a while)\r\n2018-02-05 12:52:39 0 addresses found from DNS seeds\r\n2018-02-05 12:52:39 dnsseed thread exit\r\n2018-02-05 12:53:31 UpdateTip: new best=00000000000000000044024fe59374ee53b90ffeec41e7dec6a67883023ffd84 height=507765 version=0x20000000 log2_work=88.048836 tx=297655998 date='2018-02-05 10:44:25' progress=0.999919 cache=1.3MiB(9921txo)\r\n2018-02-05 12:54:27 UpdateTip: new best=00000000000000000063e2d8531fec221ba1cdfd0aa875119c10a871f19aab03 height=507766 version=0x20000000 log2_work=88.048886 tx=297657797 date='2018-02-05 11:01:35' progress=0.999929 cache=2.5MiB(18814txo)\r\n2018-02-05 12:55:50 UpdateTip: new best=0000000000000000006ab064f21d83ec80d68f8e70bb3a5f3f0dd338b31b822f height=507767 version=0x20000000 log2_work=88.048937 tx=297659421 date='2018-02-05 11:08:42' progress=0.999933 cache=3.5MiB(26912txo)\r\n2018-02-05 12:58:55 UpdateTip: new best=000000000000000000089c6abc2ee3a2d95c990c30f6f73ed43ced7619d02250 height=507768 version=0x20000000 log2_work=88.048987 tx=297659962 date='2018-02-05 11:12:09' progress=0.999933 cache=4.6MiB(33664txo)\r\n2018-02-05 12:58:56 socket send error Broken pipe (32)\r\n2018-02-05 12:58:56 socket send error Broken pipe (32)\r\n2018-02-05 12:58:56 GUI: Platform customization: \"other\"\r\n2018-02-05 12:58:58 GUI: PaymentServer::LoadRootCAs: Loaded  161  root certificates\r\n2018-02-05 12:59:25 UpdateTip: new best=0000000000000000002bfbc6a296478cd3f285a2012aa34a78b41f2d01040460 height=507769 version=0x20000000 log2_work=88.049037 tx=297660426 date='2018-02-05 11:15:00' progress=0.999935 cache=4.8MiB(35610txo)\r\n2018-02-05 13:02:28 UpdateTip: new best=0000000000000000003131315e2b122ea05c0bfe40aba2492767a9a38c20f3d6 height=507770 version=0x20000000 log2_work=88.049088 tx=297661080 date='2018-02-05 11:18:26' progress=0.999935 cache=5.5MiB(40979txo)\r\n2018-02-05 13:02:29 socket send error Broken pipe (32)\r\n2018-02-05 13:05:15 Pre-allocating up to position 0x800000 in rev01167.dat\r\n2018-02-05 13:05:16 Prune: UnlinkPrunedFiles deleted blk/rev (01097)\r\n2018-02-05 13:05:16 UpdateTip: new best=000000000000000000390e0c018ae0c4575417461045d782537aa356e703218d height=507771 version=0x20000000 log2_work=88.049138 tx=297661203 date='2018-02-05 11:18:30' progress=0.999933 cache=0.5MiB(0txo)\r\n2018-02-05 13:05:16 socket send error Broken pipe (32)\r\n2018-02-05 13:05:16 socket send error Broken pipe (32)\r\n2018-02-05 13:05:17 Socks5() connect to 2001:0:9d38:953c:249f:5580:20b6:5fbb:8333 failed: connection not allowed\r\n2018-02-05 13:06:27 UpdateTip: new best=0000000000000000001f6cbdfcd5e332439b4eb87a346e23129639242d7e6ffe height=507772 version=0x20000000 log2_work=88.049188 tx=297662713 date='2018-02-05 11:32:45' progress=0.999941 cache=1.6MiB(9438txo)\r\n2018-02-05 13:06:27 Leaving InitialBlockDownload (latching to false)\r\n2018-02-05 13:06:28 Socks5() connect to 2001:0:9d38:90d7:20fe:1526:47e9:88cd:8333 failed: connection not allowed\r\n2018-02-05 13:06:33 receive version message: /Satoshi:0.15.1/: version 70015, blocks=507780, us=77.247.181.162:40332, peer=6\r\n2018-02-05 13:06:39 receive version message: /Satoshi:0.15.1/: version 70015, blocks=507780, us=88.99.191.203:8333, peer=7\r\n2018-02-05 13:06:43 receive version message: /Satoshi:0.15.1/: version 70015, blocks=507780, us=[::]:0, peer=8\r\n2018-02-05 13:06:48 receive version message: /Satoshi:0.15.1/: version 70015, blocks=507780, us=192.36.27.4:26322, peer=9\r\n2018-02-05 13:06:55 ProcessMessages(version, 113 bytes) FAILED peer=10\r\n2018-02-05 13:08:12 UpdateTip: new best=00000000000000000051586a1554ead0413cdc60438b5797c1c9294fa11637bf height=507773 version=0x20000000 log2_work=88.049239 tx=297664837 date='2018-02-05 11:54:00' progress=0.999954 cache=3.7MiB(26032txo)\r\n2018-02-05 13:08:17 socket send error Broken pipe (32)\r\n2018-02-05 13:08:22 version handshake timeout from 11\r\n2018-02-05 13:08:32 version handshake timeout from 12\r\n2018-02-05 13:08:40 Socks5() connect to 188.132.169.88:8333 failed: connection refused\r\n2018-02-05 13:08:41 Socks5() connect to 2001:0:9d38:6ab8:c34:7d5d:c343:2a4b:8333 failed: connection not allowed\r\n2018-02-05 13:09:16 UpdateTip: new best=0000000000000000003fca00e547d6f32341d3c1627c627b8c005345d0196b97 height=507774 version=0x20000000 log2_work=88.049289 tx=297665525 date='2018-02-05 11:58:27' progress=0.999956 cache=4.6MiB(33907txo)\r\n```\r\n\r\nI *thought* `socket send error Broken pipe (32)` just means that Tor route is broken for a particular path and needs to be re-routed?\r\n\r\nIs this behaviour normal? New tips even before version messages? Long wait?\r\n\r\nAlso tried adding four onion nodes with addnode= and loading was accomplished in the usual timeframe, this time with version messages before any update tip messages.",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 2,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12355/comments",
   "created_at" : "2018-02-05T13:34:17Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12355/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/12355",
   "id" : 294394225,
   "labels" : [
      {
         "color" : "006b75",
         "default" : false,
         "id" : 98298007,
         "name" : "P2P",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12355/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 12355,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "Starting with addnode= stuck on splash screen many minutes.",
   "updated_at" : "2018-02-24T01:06:19Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12355",
   "user" : {
      "avatar_url" : "https://avatars2.githubusercontent.com/u/1173622?v=4",
      "events_url" : "https://api.github.com/users/Willtech/events{/privacy}",
      "followers_url" : "https://api.github.com/users/Willtech/followers",
      "following_url" : "https://api.github.com/users/Willtech/following{/other_user}",
      "gists_url" : "https://api.github.com/users/Willtech/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/Willtech",
      "id" : 1173622,
      "login" : "Willtech",
      "organizations_url" : "https://api.github.com/users/Willtech/orgs",
      "received_events_url" : "https://api.github.com/users/Willtech/received_events",
      "repos_url" : "https://api.github.com/users/Willtech/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/Willtech/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/Willtech/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/Willtech"
   }
}
