[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12379#discussion_r166782285"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12379"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/166782285"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nit: Should say stderr in the string?",
      "commit_id" : "f70e7997d26e3e456486ab0a351b8a352de07935",
      "created_at" : "2018-02-07T22:49:54Z",
      "diff_hunk" : "@@ -160,6 +173,38 @@ def is_node_stopped(self):\n     def wait_until_stopped(self, timeout=BITCOIND_PROC_WAIT_TIMEOUT):\n         wait_until(self.is_node_stopped, timeout=timeout)\n \n+    def assert_start_raises_init_error(self, extra_args=None, expected_msg=None, *args, **kwargs):\n+        \"\"\"Attempt to start the node and expect it to raise an error.\n+\n+        extra_args: extra arguments to pass through to bitcoind\n+        expected_msg: regex that stderr should match when bitcoind fails\n+\n+        Will throw if bitcoind starts without an error.\n+        Will throw if an expected_msg is provided and it does not match bitcoind's stdout.\"\"\"\n+        with tempfile.NamedTemporaryFile(dir=os.path.join(self.datadir, 'stderr'), delete=False) as log_stderr, \\\n+             tempfile.NamedTemporaryFile(dir=os.path.join(self.datadir, 'stdout'), delete=False) as log_stdout:\n+            try:\n+                self.start(extra_args, stderr=log_stderr, stdout=log_stdout, *args, **kwargs)\n+                self.wait_for_rpc_connection()\n+                self.stop_node(clean_stderr=False)\n+                self.wait_util_stopped()\n+            except Exception as e:\n+                assert 'bitcoind exited' in str(e)  # node must have shutdown\n+                self.running = False\n+                self.process = None\n+                # Check stderr for expected message\n+                if expected_msg is not None:\n+                    log_stderr.seek(0)\n+                    stderr = log_stderr.read().decode('utf-8')\n+                    if re.fullmatch(expected_msg + '\\n', stderr) is None:\n+                        raise AssertionError('Expected stdout \"{}\" does not match stdout:\\n\"{}'.format(expected_msg, stderr))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12379#discussion_r166782285",
      "id" : 166782285,
      "original_commit_id" : "f70e7997d26e3e456486ab0a351b8a352de07935",
      "original_position" : 99,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : 99,
      "pull_request_review_id" : 94900859,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12379",
      "updated_at" : "2018-02-07T22:50:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/166782285",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "Concept ACK",
      "created_at" : "2018-02-08T19:41:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12379#issuecomment-364225644",
      "id" : 364225644,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12379",
      "updated_at" : "2018-02-08T19:41:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/364225644",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK.",
      "created_at" : "2018-02-15T02:34:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12379#issuecomment-365809738",
      "id" : 365809738,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12379",
      "updated_at" : "2018-02-15T02:34:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/365809738",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/33541170?v=4",
         "events_url" : "https://api.github.com/users/randolf/events{/privacy}",
         "followers_url" : "https://api.github.com/users/randolf/followers",
         "following_url" : "https://api.github.com/users/randolf/following{/other_user}",
         "gists_url" : "https://api.github.com/users/randolf/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/randolf",
         "id" : 33541170,
         "login" : "randolf",
         "organizations_url" : "https://api.github.com/users/randolf/orgs",
         "received_events_url" : "https://api.github.com/users/randolf/received_events",
         "repos_url" : "https://api.github.com/users/randolf/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/randolf/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/randolf/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/randolf"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I ran `test_runner.py` on MacOS 10.13.3. `wallet_encryption.py`, `wallet_multiwallet.py` and `wallet_multiwallet.py --usecli` failed. I ran them again individually and they still failed. See [logs](https://gist.github.com/Sjors/fcd54278678d989e37f8a478c7e01498). The first test fails on master too (see #12375), but those other two pass on master (ffc6e48b2).",
      "created_at" : "2018-02-20T17:57:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12379#issuecomment-367063010",
      "id" : 367063010,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12379",
      "updated_at" : "2018-02-20T17:58:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/367063010",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I've pulled out the first commit into #12728, and the `assert_start_raises_init_error()` commits have been pulled into #12718.\r\n\r\nI'll leave this PR open for now, but will close and replace with a separate PR for the libc/stdout changes once those other two PRs are merged.",
      "created_at" : "2018-03-19T19:04:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12379#issuecomment-374330231",
      "id" : 374330231,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12379",
      "updated_at" : "2018-03-19T19:04:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/374330231",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
