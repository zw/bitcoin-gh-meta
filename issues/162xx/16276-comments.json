[
   {
      "author_association" : "MEMBER",
      "body" : "Can you post an example debug log section of the changes?",
      "created_at" : "2019-06-24T13:05:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16276#issuecomment-505001274",
      "id" : 505001274,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16276",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwNTAwMTI3NA==",
      "updated_at" : "2019-06-24T13:05:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/505001274",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> thank you for your question.  let me try to be clear.\r\n\r\n(1)while thread lock and unlock cs_main, the log show like this, \r\nLOCKCONTENTION: cs_main\r\nLocker: src\\validation.cpp:2383\r\n\r\nbut we do not know which state it is, unlocked,  or keep waiting for the lock.\r\n\r\n\r\n\r\n(2)after insert of PrintLockContentionOwned(), now we know it is unlocked or keep waiting. \r\n\r\nnow the log show like this if it is unlocked:\r\nLOCKCONTENTION: cs_main\r\nLocker: src\\validation.cpp:2383\r\nLOCKOWNED after lock contention: cs_main\r\nLocker: src\\validation.cpp:2383\r\n\r\nAnother case is that,  it is keep waiting:\r\nLOCKCONTENTION: cs_main\r\nLocker: src\\validation.cpp:2383\r\n\r\n(3)in our case, there are many threads has locked cs_main,  thread1, thread2, thread3, thread4, etc...\r\nand there is a deadlock which potential_deadlock_detected() can not decect because another lock is not CCriticalSection, but we could not known which thread keeps waiting for cs_main.\r\n\r\nas LOCKOWNED  log, now we know thread1, thread4, has owned and unlock cs_main,  but thread2 and thread3  keep waiting for cs_main and may be in deadlock state.",
      "created_at" : "2019-06-25T01:41:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16276#issuecomment-505242956",
      "id" : 505242956,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16276",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwNTI0Mjk1Ng==",
      "updated_at" : "2019-06-25T01:41:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/505242956",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3275474?v=4",
         "events_url" : "https://api.github.com/users/orientye/events{/privacy}",
         "followers_url" : "https://api.github.com/users/orientye/followers",
         "following_url" : "https://api.github.com/users/orientye/following{/other_user}",
         "gists_url" : "https://api.github.com/users/orientye/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/orientye",
         "id" : 3275474,
         "login" : "orientye",
         "node_id" : "MDQ6VXNlcjMyNzU0NzQ=",
         "organizations_url" : "https://api.github.com/users/orientye/orgs",
         "received_events_url" : "https://api.github.com/users/orientye/received_events",
         "repos_url" : "https://api.github.com/users/orientye/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/orientye/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/orientye/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/orientye"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Please, change the PR and commit title to something that summarizes the change. \"optimize for diagnosis of deadlock\" is too general, and this doesn't involve any optimization.\r\n\r\nAlso: need someone familiar with hunting down deadlock issues (maybe @TheBlueMatt) to comment on this change.",
      "created_at" : "2019-07-31T07:32:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16276#issuecomment-516733554",
      "id" : 516733554,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16276",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNjczMzU1NA==",
      "updated_at" : "2019-07-31T07:32:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/516733554",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
