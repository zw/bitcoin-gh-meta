{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "This is a different approach to burying csv/segwit deployments -- rather than converting them from `Consensus::BIP9Deployment` to dedicated members, it uses a generalised `Consensus::Deployment` type to cover both BIP9 activations and fixed height activations.\r\n\r\nI think this should make future burials much simpler (it becomes a one-line change), but there's two other benefits: it doesn't change RPC or tests much, and I think it will make it easier to make future changes to activation methods should we wish to do so. The downside is that the activations aren't hardcoded anymore, so there's a function call and a few indirect lookups to determine a fixed-height activation is enabled, rather than just a direct test.\r\n\r\nI've added some extra commits to tidy up the `getblockchaininfo` output. It now changes from:\r\nThe output of `getblockchaininfo` changes from:\r\n\r\n    \"softforks\": [\r\n      {\r\n        \"id\": \"bip34\",\r\n        \"version\": 2,\r\n        \"reject\": {\r\n          \"status\": true\r\n        }\r\n      },\r\n      {\r\n        \"id\": \"bip66\",\r\n        \"version\": 3,\r\n        \"reject\": {\r\n          \"status\": true\r\n        }\r\n      },\r\n      {\r\n        \"id\": \"bip65\",\r\n        \"version\": 4,\r\n        \"reject\": {\r\n          \"status\": true\r\n        }\r\n      }\r\n    ],\r\n    \"bip9_softforks\": {\r\n      \"csv\": {\r\n        \"status\": \"active\",\r\n        \"startTime\": 1462060800,\r\n        \"timeout\": 1493596800,\r\n        \"since\": 419328\r\n      },\r\n      \"segwit\": {\r\n        \"status\": \"active\",\r\n        \"startTime\": 1479168000,\r\n        \"timeout\": 1510704000,\r\n        \"since\": 481824\r\n      }\r\n    },\r\n\r\nto\r\n\r\n    \"softforks\": {\r\n      \"bip34\": {\r\n        \"status\": \"active\",\r\n        \"fixedHeight\": 227931,\r\n        \"since\": 227931\r\n      },\r\n      \"strictder\": {\r\n        \"status\": \"active\",\r\n        \"fixedHeight\": 363725,\r\n        \"since\": 363725\r\n      },\r\n      \"cltv\": {\r\n        \"status\": \"active\",\r\n        \"fixedHeight\": 388381,\r\n        \"since\": 388381\r\n      },\r\n      \"csv\": {\r\n        \"status\": \"active\",\r\n        \"fixedHeight\": 419328,\r\n        \"since\": 419328\r\n      },\r\n      \"segwit\": {\r\n        \"status\": \"active\",\r\n        \"fixedHeight\": 481824,\r\n        \"since\": 481824\r\n      }\r\n    },\r\n\r\nwith this patch set, or, on regtest something like:\r\n\r\n    \"softforks\": {\r\n      \"bip34\": {\r\n        \"status\": \"active\",\r\n        \"fixedHeight\": 500,\r\n        \"since\": 500\r\n      },\r\n      \"testdummy\": {\r\n        \"status\": \"started\",\r\n        \"bit\": 28,\r\n        \"startTime\": 0,\r\n        \"timeout\": 9223372036854775807,\r\n        \"since\": 144,\r\n        \"statistics\": {\r\n          \"period\": 144,\r\n          \"threshold\": 108,\r\n          \"elapsed\": 141,\r\n          \"count\": 141,\r\n          \"possible\": true\r\n        }\r\n      },\r\n      \"strictder\": {\r\n        \"status\": \"defined\",\r\n        \"fixedHeight\": 1251,\r\n        \"since\": 0\r\n      },\r\n      \"cltv\": {\r\n        \"status\": \"defined\",\r\n        \"fixedHeight\": 1351,\r\n        \"since\": 0\r\n      },\r\n      \"csv\": {\r\n        \"status\": \"started\",\r\n        \"bit\": 0,\r\n        \"startTime\": 0,\r\n        \"timeout\": 9223372036854775807,\r\n        \"since\": 144,\r\n        \"statistics\": {\r\n          \"period\": 144,\r\n          \"threshold\": 108,\r\n          \"elapsed\": 141,\r\n          \"count\": 141,\r\n          \"possible\": true\r\n        }\r\n      },\r\n      \"segwit\": {\r\n        \"status\": \"active\",\r\n        \"alwaysActive\": true,\r\n        \"since\": 0\r\n      }\r\n    },\r\n",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 8,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16229/comments",
   "created_at" : "2019-06-18T07:48:23Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16229/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/16229",
   "id" : 457313935,
   "labels" : [
      {
         "color" : "009800",
         "default" : false,
         "id" : 192202000,
         "name" : "Consensus",
         "node_id" : "MDU6TGFiZWwxOTIyMDIwMDA=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Consensus"
      },
      {
         "color" : "fef2c0",
         "default" : false,
         "id" : 1392286103,
         "name" : "Needs Conceptual Review",
         "node_id" : "MDU6TGFiZWwxMzkyMjg2MTAz",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20Conceptual%20Review"
      },
      {
         "color" : "E6F6D6",
         "default" : false,
         "id" : 135961,
         "name" : "Refactoring",
         "node_id" : "MDU6TGFiZWwxMzU5NjE=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16229/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDExOlB1bGxSZXF1ZXN0Mjg5MTQ1NzEz",
   "number" : 16229,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/16229.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16229",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/16229.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16229"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "Standardise deployment handling",
   "updated_at" : "2019-07-27T11:12:58Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16229",
   "user" : {
      "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
      "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
      "followers_url" : "https://api.github.com/users/ajtowns/followers",
      "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
      "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/ajtowns",
      "id" : 127186,
      "login" : "ajtowns",
      "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
      "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
      "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
      "repos_url" : "https://api.github.com/users/ajtowns/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/ajtowns"
   }
}
