[
   {
      "body" : "Very nice! Before looking over the work itself, I wanted to be sure that libevent was viable for all of our build targets.\r\n\r\nSee here for the build-system work. This should be enough to get Travis passing, I'd think:\r\nhttps://github.com/theuni/bitcoin/commits/5677",
      "created_at" : "2015-01-20T03:49:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-70600574",
      "id" : 70600574,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-20T03:49:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/70600574",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "@cfields Will pull that in, thanks a lot!",
      "created_at" : "2015-01-20T05:00:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-70604873",
      "id" : 70604873,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-20T05:00:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/70604873",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Hm, nothing special needed for longpolling?",
      "created_at" : "2015-01-20T05:04:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-70605115",
      "id" : 70605115,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-20T05:04:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/70605115",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "@luke-jr I don't think so. The current implementation should work. Of course it would be more optimal to release the worker thread while longpolling, and change \"new block\" it into an event-trigger, but I leave that as a challenge for later.",
      "created_at" : "2015-01-20T05:14:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-70605676",
      "id" : 70605676,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-20T05:14:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/70605676",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "The fail in \"32-bit + dash\" is strange\r\n\r\n    FAIL: qt/test/test_bitcoin-qt\r\n\r\nI'm not sure how this can be affected at all (passes fine here), but I'll check.\r\n\r\nOn Win32/64 it still tries to link against libevent_pthread. IIRC there is no specific thread library for windows, `evthread_use_windows_threads` is part of the core library there.\r\n\r\n    /usr/bin/x86_64-w64-mingw32-ld: cannot find -levent_pthreads\r\n",
      "created_at" : "2015-01-20T06:37:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-70610849",
      "id" : 70610849,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-20T06:39:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/70610849",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Blah, sorry, missed that one.",
      "created_at" : "2015-01-20T06:45:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-70611391",
      "id" : 70611391,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-20T06:45:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/70611391",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "It's easy to miss those sneaky qt unit tests. Windows passes now!\r\n\r\nThat leaves the `32-bit + dash` case, which is not an intermittent issue\r\n```\r\nFAIL! : PaymentServerTests::paymentServerTests() Compared values are not the same\r\nActual (merchant):\r\nExpected (QString(\"testmerchant.org\")): testmerchant.org\r\nLoc: [qt/test/paymentservertests.cpp(84)]\r\n```\r\n... no clue how this happens yet. The Qt tests don't use the RPC mechanism. My gut feeling is some interaction with OpenSSL which, absent verification, is now an indirect dependency through Qt? Not sure, and why it only happens in this test is a mystery to me.\r\n",
      "created_at" : "2015-01-20T07:21:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-70613765",
      "id" : 70613765,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-20T07:21:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/70613765",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@laanwj Yes, it has some interaction with qt:\r\n- ./configure --with-gui=qt4: fine.\r\n- ./configure --with-gui=qt5: fine.\r\n- make -C depends; ./configure --prefix=\\`pwd\\`/depends/x86_64-unknown-linux-gnu: busted\r\n- make -C depends USE_LINUX_STATIC_QT5=1;  ./configure --prefix=\\`pwd\\`/depends/x86_64-unknown-linux-gnu: fine.",
      "created_at" : "2015-01-20T08:23:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-70619366",
      "id" : 70619366,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-20T08:23:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/70619366",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "tested gitian build.\r\nBinaries to test: https://builds.jonasschnelli.ch/pulls/5677/",
      "created_at" : "2015-01-20T15:11:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-70668199",
      "id" : 70668199,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-20T15:11:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/70668199",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Concept ACK",
      "created_at" : "2015-01-21T14:28:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-70845949",
      "id" : 70845949,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-21T14:28:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/70845949",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "Now that the code is stable it is time for some benchmarking.\r\nI found a nice scriptable framework for HTTP benchmarking, [wrk](https://github.com/wg/wrk). Some results.\r\nThese benchmarks were taken at the default settings (4 worker threads, 16 depth work queue).\r\n\r\n### GET request to invalid URL\r\nThese are handled by evhttp itself, so this is the baseline.\r\n```\r\n$  ./wrk -t12 -c15 -d10s http://127.0.0.1:18332/inv\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency   375.53us   66.86us   6.31ms   93.03%\r\n    Req/Sec     2.67k   121.28     3.11k    80.98%\r\n  303293 requests in 10.00s, 36.73MB read\r\n  Non-2xx or 3xx responses:\r\n    404: 303293\r\nRequests/sec:  30343.08\r\nTransfer/sec:      3.68MB\r\n```\r\nAs expected, we get 404s.\r\n### GET request to /\r\n\r\nThese are dispatched to a worker thread. Some more latency is expected. In the worker thread these error out early, as GET is not a valid method for JSON RPC.\r\n```\r\n$ ./wrk -t12 -c15 -d10s http://127.0.0.1:18332/\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency   472.96us   44.12us   1.28ms   93.31%\r\n    Req/Sec     2.14k   127.02     2.33k    82.90%\r\n  245025 requests in 10.00s, 41.59MB read\r\n  Non-2xx or 3xx responses:\r\n    405: 245025\r\nRequests/sec:  24514.30\r\nTransfer/sec:      4.16MB\r\n```\r\nAs expected: lots of 405 (invalid method for URL) results.\r\n### RPC getgenerate requests\r\nPost `getgenerate` requests. This is an extremely cheap RPC call.\r\nScript:\r\n```lua\r\nwrk.method = \"POST\"\r\nwrk.body   = \"{\\\"method\\\":\\\"getgenerate\\\",\\\"params\\\":[],\\\"id\\\":1}\\n\"\r\nwrk.headers[\"Content-Type\"] = \"application/json\"\r\nwrk.headers[\"Authorization\"] = \"Basic XXX\"\r\n```\r\n```\r\n$ ./wrk -t12 -c15 -d10s -s getgenerate.lua http://127.0.0.1:18332/\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency   571.28us   59.77us   2.09ms   91.89%\r\n    Req/Sec     1.82k   110.56     2.00k    80.32%\r\n  204481 requests in 9.99s, 28.28MB read\r\n  Non-2xx or 3xx responses:\r\nRequests/sec:  20463.77\r\nTransfer/sec:      2.83MB\r\n```\r\nAll responses succesful.\r\n### RPC getinfo requests\r\nPost `getinfo` requests. This is a more expensive RPC call.\r\n```lua\r\nwrk.method = \"POST\"\r\nwrk.body   = \"{\\\"method\\\":\\\"getinfo\\\",\\\"params\\\":[],\\\"id\\\":1}\\n\"\r\nwrk.headers[\"Content-Type\"] = \"application/json\"\r\nwrk.headers[\"Authorization\"] = \"Basic XXX\r\n```\r\n```\r\n$ ./wrk -t12 -c15 -d10s -s getinfo.lua http://127.0.0.1:18332/\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency     1.69ms  572.87us  15.39ms   95.21%\r\n    Req/Sec   626.46     81.57     1.00k    84.26%\r\n  71245 requests in 9.99s, 37.17MB read\r\n  Non-2xx or 3xx responses:\r\nRequests/sec:   7128.48\r\nTransfer/sec:      3.72MB\r\n```\r\nAlthough the performance goes down, no errors happen. The maximum queue depth is never reached.\r\n\r\n### RPC requests w/ invalid authentication\r\nPost `getinfo` requests with invalid authentication. This will trigger a 250ms delay, and thus we can trigger worker queue-full conditions with enough threads.\r\n```lua\r\nwrk.method = \"POST\"\r\nwrk.body   = \"{\\\"method\\\":\\\"getinfo\\\",\\\"params\\\":[],\\\"id\\\":1}\\n\"\r\nwrk.headers[\"Content-Type\"] = \"application/json\"\r\nwrk.headers[\"Authorization\"] = \"Basic YYY\r\n```\r\n```\r\n$ ./wrk -t12 -c15 -d10s -s getinfo_unauth.lua http://127.0.0.1:18332/\r\nThread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency   751.03ms  323.38us 752.15ms   81.82%\r\n    Req/Sec     1.05      0.65     2.00     58.33%\r\n  156 requests in 10.00s, 19.80KB read\r\n  Non-2xx or 3xx responses:\r\n    401: 156\r\nRequests/sec:     15.60\r\nTransfer/sec:      1.98KB\r\n```\r\nIncreasing the load further, we can exceed the work queue depth:\r\n```\r\n$ ./wrk -t12 -c45 -d10s -s getinfo_unauth.lua http://127.0.0.1:18332/\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency   204.35ms  462.08ms   1.25s    83.72%\r\n    Req/Sec     2.42k     1.53k    6.00k    75.64%\r\n  277072 requests in 10.00s, 43.59MB read\r\n  Non-2xx or 3xx responses:\r\n    401: 156\r\n    500: **276916**\r\nRequests/sec:  27706.71\r\nTransfer/sec:      4.36MB\r\n```\r\n\r\nLooks good. Nothing unexpected, it's clear the evhttp is not the bottleneck, and the work queue works as expected. Will try this with the old asio-based HTTP server shortly.\r\n",
      "created_at" : "2015-01-23T10:26:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-71174411",
      "id" : 71174411,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-23T10:26:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/71174411",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "## Old http server\r\nSame steps as above, repeated with the old server as of commit 944c256.\r\n\r\n### GET request to invalid URL\r\n```\r\n$  ./wrk -t12 -c15 -d10s http://127.0.0.1:18332/inv\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency   502.17us   94.60us   2.65ms   74.77%\r\n    Req/Sec     1.89k   119.76     2.33k    83.38%\r\n  214864 requests in 9.99s, 37.50MB read\r\n  Responses:\r\n    404: 214864\r\nRequests/sec:  21502.28\r\nTransfer/sec:      3.75MB\r\n```\r\n### GET request to /\r\n\r\n```\r\n$ ./wrk -t12 -c15 -d10s http://127.0.0.1:18332/\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency   502.58us   92.30us   2.07ms   73.39%\r\n    Req/Sec     1.89k   118.97     2.22k    83.36%\r\n  214269 requests in 9.99s, 103.40MB read\r\n  Responses:\r\n    401: 214269\r\nRequests/sec:  21447.93\r\nTransfer/sec:     10.35MB\r\n```\r\n\r\n### RPC getgenerate requests\r\n```\r\n$ ./wrk -t12 -c15 -d10s -s getgenerate.lua http://127.0.0.1:18332/\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency    93.68us   24.84us   1.27ms   89.23%\r\n    Req/Sec    10.06k   616.30    11.78k    64.49%\r\n  380211 requests in 10.00s, 78.32MB read\r\n  Socket errors: connect 0, read 0, write 0, timeout 39\r\n  Responses:\r\n    200: 380211\r\nRequests/sec:  38006.24\r\nTransfer/sec:      7.83MB\r\n```\r\n### RPC getinfo requests\r\n```\r\n$ ./wrk -t12 -c15 -d10s -s getinfo.lua http://127.0.0.1:18332/\r\nRunning 10s test @ http://127.0.0.1:18332/\r\n  12 threads and 15 connections\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency   544.15us  187.74us   4.03ms   79.81%\r\n    Req/Sec     1.89k   188.50     2.90k    63.09%\r\n  71480 requests in 10.00s, 42.13MB read\r\n  Socket errors: connect 0, read 0, write 0, timeout 39\r\n  Responses:\r\n    200: 71480\r\nRequests/sec:   7144.83\r\nTransfer/sec:      4.21MB\r\n```\r\n### RPC requests w/ invalid authentication\r\n```\r\n$ ./wrk -t12 -c15 -d10s -s getinfo_unauth.lua http://127.0.0.1:18332/\r\n  12 threads and 15 connections\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency   751.75ms  161.83us 752.03ms   73.91%\r\n    Req/Sec     0.94      0.66     2.00     56.52%\r\n  156 requests in 10.00s, 77.09KB read\r\n  Responses:\r\n    401: 156\r\nRequests/sec:     15.60\r\nTransfer/sec:      7.71KB\r\n```\r\n```\r\n$ ./wrk -t12 -c45 -d10s -s getinfo_unauth.lua http://127.0.0.1:18332/\r\nRunning 10s test @ http://127.0.0.1:18332/\r\n  12 threads and 45 connections\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency     2.19s   309.47ms   2.26s    95.24%\r\n    Req/Sec     0.90      1.56     6.00     87.30%\r\n  156 requests in 10.01s, 77.09KB read\r\n  Socket errors: connect 0, read 0, write 0, timeout 24\r\n  Responses:\r\n    401: 156\r\nRequests/sec:     15.59\r\nTransfer/sec:      7.70KB\r\n```\r\n\r\n## Summary\r\n\r\n```\r\nTestcase                      Old (r/s) New (r/s)\r\n================================================\r\nGET request to invalid URL    21502     30343\r\nGET request to /              21448     24514\r\nRPC getgenerate requests      38006*    20463\r\nRPC getinfo requests           7144*     7128\r\nRPC requests w/ invalid auth     16*       16\r\n\r\n* with timeout errors.\r\n```\r\n\r\n- The new server wins on the base http requests front. Even to /, which are dispatched to the worker threads.\r\n\r\n- The old server is currently much faster with `getgenerate` requests. I am curious why. Also: how can getgenerate requests be faster than simple `GET /`'s? I suspect a measurement error that has to do with the timeouts (**edit**: this is because the old server disconnects after errors, so those don't utilize keepalive).\r\n\r\n- `getinfo` requests are, as expected, ~ the same speed. Processing overhead dominates.\r\n\r\n- Same for unauthenticated requests. The requests take 250ms to handle so the number seen is exactly as expected.\r\n\r\nTake into account that it's not entirely a fair comparison: the new http server can service a large number of connections at the same time, whereas the old server can have a maximum of four (or, `-rpcthreads`) and starves additional.connections (thanks to keep-alive). There is some overhead in multiplexing that is absent in a one-to-one scenario. This is also a purely a local benchmark. I/O bandwidth doesn't come into it, and the benchmark tool competes for the same CPU as the server.",
      "created_at" : "2015-01-23T11:09:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-71179035",
      "id" : 71179035,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-23T14:57:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/71179035",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Why are we dropping SSL support for RPC?",
      "created_at" : "2015-01-23T11:20:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-71180158",
      "id" : 71180158,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-23T11:20:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/71180158",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r23444511"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/23444511"
         }
      },
      "body" : "Just to understand why are you explicitly using == NULL here and for base above just !var?",
      "commit_id" : "d52802551752140cf41f0d9a225a43e84404d3e9",
      "created_at" : "2015-01-23T11:25:12Z",
      "diff_hunk" : "@@ -104,48 +143,59 @@ Object CallRPC(const string& strMethod, const Array& params)\n               \"If the file does not exist, create it with owner-readable-only file permissions.\"),\n                 GetConfigFile().string().c_str()));\n \n-    // Connect to localhost\n-    bool fUseSSL = GetBoolArg(\"-rpcssl\", false);\n-    boost::asio::io_service io_service;\n-    boost::asio::ssl::context context(io_service, boost::asio::ssl::context::sslv23);\n-    context.set_options(boost::asio::ssl::context::no_sslv2 | boost::asio::ssl::context::no_sslv3);\n-    boost::asio::ssl::stream<boost::asio::ip::tcp::socket> sslStream(io_service, context);\n-    SSLIOStreamDevice<boost::asio::ip::tcp> d(sslStream, fUseSSL);\n-    boost::iostreams::stream< SSLIOStreamDevice<boost::asio::ip::tcp> > stream(d);\n-\n-    const bool fConnected = d.connect(GetArg(\"-rpcconnect\", \"127.0.0.1\"), GetArg(\"-rpcport\", itostr(BaseParams().RPCPort())));\n-    if (!fConnected)\n+    std::string host = GetArg(\"-rpcconnect\", \"127.0.0.1\");\n+    int port = GetArg(\"-rpcport\", BaseParams().RPCPort());\n+\n+    // Create event base\n+    struct event_base *base = event_base_new(); // XXX RAII\n+    if (!base)\n+        throw runtime_error(\"cannot create event_base\");\n+\n+    // Synchronously look up hostname\n+    struct evhttp_connection *evcon = evhttp_connection_base_new(base, NULL, host.c_str(), port); // XXX RAII\n+    if (evcon == NULL)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r23444511",
      "id" : 23444511,
      "original_commit_id" : "6f1259a8cf186466e113f93175c58663c83f0ecd",
      "original_position" : 94,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677",
      "updated_at" : "2015-09-04T09:02:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/23444511",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r23444540"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/23444540"
         }
      },
      "body" : "Perhaps use some constant or struct for such strings and use a speaking name in the code?",
      "commit_id" : "d52802551752140cf41f0d9a225a43e84404d3e9",
      "created_at" : "2015-01-23T11:26:08Z",
      "diff_hunk" : "@@ -104,48 +143,59 @@ Object CallRPC(const string& strMethod, const Array& params)\n               \"If the file does not exist, create it with owner-readable-only file permissions.\"),\n                 GetConfigFile().string().c_str()));\n \n-    // Connect to localhost\n-    bool fUseSSL = GetBoolArg(\"-rpcssl\", false);\n-    boost::asio::io_service io_service;\n-    boost::asio::ssl::context context(io_service, boost::asio::ssl::context::sslv23);\n-    context.set_options(boost::asio::ssl::context::no_sslv2 | boost::asio::ssl::context::no_sslv3);\n-    boost::asio::ssl::stream<boost::asio::ip::tcp::socket> sslStream(io_service, context);\n-    SSLIOStreamDevice<boost::asio::ip::tcp> d(sslStream, fUseSSL);\n-    boost::iostreams::stream< SSLIOStreamDevice<boost::asio::ip::tcp> > stream(d);\n-\n-    const bool fConnected = d.connect(GetArg(\"-rpcconnect\", \"127.0.0.1\"), GetArg(\"-rpcport\", itostr(BaseParams().RPCPort())));\n-    if (!fConnected)\n+    std::string host = GetArg(\"-rpcconnect\", \"127.0.0.1\");\n+    int port = GetArg(\"-rpcport\", BaseParams().RPCPort());\n+\n+    // Create event base\n+    struct event_base *base = event_base_new(); // XXX RAII\n+    if (!base)\n+        throw runtime_error(\"cannot create event_base\");\n+\n+    // Synchronously look up hostname\n+    struct evhttp_connection *evcon = evhttp_connection_base_new(base, NULL, host.c_str(), port); // XXX RAII\n+    if (evcon == NULL)\n+        throw runtime_error(\"create connection failed\");\n+    evhttp_connection_set_timeout(evcon, GetArg(\"-rpctimeout\", 30));\n+\n+    HTTPReply response;\n+    struct evhttp_request *req = evhttp_request_new(http_request_done, (void*)&response); // XXX RAII\n+    if (req == NULL)\n+        throw runtime_error(\"create http request failed\");\n+\n+    struct evkeyvalq *output_headers = evhttp_request_get_output_headers(req);\n+    assert(output_headers);\n+    evhttp_add_header(output_headers, \"Host\", host.c_str());\n+    evhttp_add_header(output_headers, \"Connection\", \"close\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r23444540",
      "id" : 23444540,
      "original_commit_id" : "6f1259a8cf186466e113f93175c58663c83f0ecd",
      "original_position" : 106,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677",
      "updated_at" : "2015-09-04T09:02:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/23444540",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "@diapolo Re: this pull: because I don't feel like implementing it.\r\n\r\nIn the longer term I (and many others) would also argue it is better to drop it:\r\n- Makes it possible to drop OpenSSL dependency from bitcoind completely, after secp256k1 verification is used. Simplifies the code overall.\r\n- I've never heard of anyone using SSL with RPC. It may also be better not to know; after all, this invites opening up the RPC port reachable to the internet or other untrusted networks. The limited amount of configurability of rpcssl almost guarantees this will be an insecure setup.\r\n- If you *really* need to use RPC remotely over an untrusted network, it is easy enough to set up stunnel or a SSH tunnel, or even e.g. OpenVPN, with the full power of those tools available you may have a chance of doing so securely.\r\n",
      "created_at" : "2015-01-23T11:29:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-71181146",
      "id" : 71181146,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-23T14:52:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/71181146",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r23444766"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/23444766"
         }
      },
      "body" : "@diapolo  `== NULL` and `!evcon` are equivalent in this case so purely a matter to taste.  The pull clearly states [PoC] as for proof-of-concept, please don't report all these minor things but only critical or high-level issues,",
      "commit_id" : "d52802551752140cf41f0d9a225a43e84404d3e9",
      "created_at" : "2015-01-23T11:32:43Z",
      "diff_hunk" : "@@ -104,48 +143,59 @@ Object CallRPC(const string& strMethod, const Array& params)\n               \"If the file does not exist, create it with owner-readable-only file permissions.\"),\n                 GetConfigFile().string().c_str()));\n \n-    // Connect to localhost\n-    bool fUseSSL = GetBoolArg(\"-rpcssl\", false);\n-    boost::asio::io_service io_service;\n-    boost::asio::ssl::context context(io_service, boost::asio::ssl::context::sslv23);\n-    context.set_options(boost::asio::ssl::context::no_sslv2 | boost::asio::ssl::context::no_sslv3);\n-    boost::asio::ssl::stream<boost::asio::ip::tcp::socket> sslStream(io_service, context);\n-    SSLIOStreamDevice<boost::asio::ip::tcp> d(sslStream, fUseSSL);\n-    boost::iostreams::stream< SSLIOStreamDevice<boost::asio::ip::tcp> > stream(d);\n-\n-    const bool fConnected = d.connect(GetArg(\"-rpcconnect\", \"127.0.0.1\"), GetArg(\"-rpcport\", itostr(BaseParams().RPCPort())));\n-    if (!fConnected)\n+    std::string host = GetArg(\"-rpcconnect\", \"127.0.0.1\");\n+    int port = GetArg(\"-rpcport\", BaseParams().RPCPort());\n+\n+    // Create event base\n+    struct event_base *base = event_base_new(); // XXX RAII\n+    if (!base)\n+        throw runtime_error(\"cannot create event_base\");\n+\n+    // Synchronously look up hostname\n+    struct evhttp_connection *evcon = evhttp_connection_base_new(base, NULL, host.c_str(), port); // XXX RAII\n+    if (evcon == NULL)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r23444766",
      "id" : 23444766,
      "original_commit_id" : "6f1259a8cf186466e113f93175c58663c83f0ecd",
      "original_position" : 94,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677",
      "updated_at" : "2015-09-04T09:02:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/23444766",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I agree with @laanwj. SSL support could lead somebody to believe it's \"save\". IMO it currently a bad idea to expose bitcoind RPC to a public accessible area. Nevertheless, If one like to do this, he could still do a apache ssl enable reverse proxy to bitcoind's RPC.",
      "created_at" : "2015-01-23T12:05:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-71184656",
      "id" : 71184656,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-23T12:05:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/71184656",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Also SSL in the RPC massively increases the attack surface we have exposed (if you also expose it to the outside world) and we've had to push updates previously on account of it-- even though we believe its a feature virtually no one uses.  As mentioned it can be better accomplished via stunnel (or any of several other tools)",
      "created_at" : "2015-01-23T14:27:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-71200027",
      "id" : 71200027,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-23T14:27:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/71200027",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "I agree, it was a mistake to add SSL support to the RPC (mea culpa-- I wrote the original version of that code).\r\n",
      "created_at" : "2015-01-23T16:13:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-71217270",
      "id" : 71217270,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-23T16:13:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/71217270",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "concept ACK.\r\nneeds rebase.",
      "created_at" : "2015-02-04T15:07:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-72870617",
      "id" : 72870617,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-02-04T15:07:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/72870617",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "If I might chime in on the SSL discussion: I am not sure whether it should be removed. In terms of integrating bitcoin core into a bigger system, I would expect that it offers SSL in order to protect credentials. This has not much to do with publicly available access, I habitually do this for any service that sends credentials over any network (and I think that this is quite advisable for a bitcoin wallet). Of course, setting up an encrypted tunnel might be an option, but it's cumbersome and error-prone.\r\n\r\nI would maybe propose a different route: leave the core's RPC functions unauthenticated, and add authentication and SSL to the wallet.",
      "created_at" : "2015-02-21T07:47:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-75360870",
      "id" : 75360870,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-02-21T07:47:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/75360870",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/179920?v=3",
         "events_url" : "https://api.github.com/users/arnuschky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/arnuschky/followers",
         "following_url" : "https://api.github.com/users/arnuschky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/arnuschky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/arnuschky",
         "id" : 179920,
         "login" : "arnuschky",
         "organizations_url" : "https://api.github.com/users/arnuschky/orgs",
         "received_events_url" : "https://api.github.com/users/arnuschky/received_events",
         "repos_url" : "https://api.github.com/users/arnuschky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/arnuschky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/arnuschky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/arnuschky"
      }
   },
   {
      "body" : "@arnuschky There is no secure way to expose RPC to an untrusted network, whether you use the wallet or not. Although perhaps with a libevent-based server maybe that changes...",
      "created_at" : "2015-02-21T07:58:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-75361175",
      "id" : 75361175,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-02-21T07:58:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/75361175",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "@arnuschky The HTTP REST interface provides unauthenticated access to public blockchain data: https://github.com/bitcoin/bitcoin/blob/master/doc/REST-interface.md",
      "created_at" : "2015-02-21T15:46:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-75377248",
      "id" : 75377248,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-02-21T15:46:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/75377248",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "@luke-jr What are you referring to? \r\n\r\nSorry, it seems that I haven't made myself clear. I agree that it is advisable to get rid of the openssl dependency in bitcoin core. However, losing the SSL feature for wallet RPC is a bit annoying from the system integrator's point of view - it just makes deployment more complex. I don't agree with the black-and-white consideration of a \"trusted\" vs \"untrusted\" network. Even in a so-called \"trusted\" network, there might be bad actors (hoster, employees, compromised servers etc). Thus, running a wallet RPC access without encryption in a \"trusted\" network is a bad idea, IMO. \r\n\r\nOf course, a tunnel or a reverse proxy is an option, but increases complexity of deployment and is error-prone. Furthermore, if the default is insecure people just run with it. I would even argue the opposite: disable unencrypted RPC (except on 127.0.0.1) - this is also what btcd does, and I find it quite sensible.\r\n\r\nMaybe encrypted RPC could be broken out into the wallet with the upcoming modularization of the wallet code? On the long run, I find the design of btcd or for example the cryptonote coins quite sensible: a unauthenticated RPC for public blockchain data (what is now offered by the REST interface), and on a different port an authenticated, encrypted RPC for wallet access.\r\n\r\nPS: sorry if I am taking this a bit OT here, maybe this should be discussed somewhere else\r\n\r\n",
      "created_at" : "2015-02-22T09:42:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-75427534",
      "id" : 75427534,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-02-22T09:43:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/75427534",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/179920?v=3",
         "events_url" : "https://api.github.com/users/arnuschky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/arnuschky/followers",
         "following_url" : "https://api.github.com/users/arnuschky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/arnuschky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/arnuschky",
         "id" : 179920,
         "login" : "arnuschky",
         "organizations_url" : "https://api.github.com/users/arnuschky/orgs",
         "received_events_url" : "https://api.github.com/users/arnuschky/received_events",
         "repos_url" : "https://api.github.com/users/arnuschky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/arnuschky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/arnuschky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/arnuschky"
      }
   },
   {
      "body" : "Don't let this go unmaintained :)",
      "created_at" : "2015-03-03T12:26:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-76936251",
      "id" : 76936251,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-03-03T12:26:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/76936251",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Needs rebase. I'm willing to help (testing, fixing, etc.).",
      "created_at" : "2015-03-05T08:37:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-77325968",
      "id" : 77325968,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-03-05T08:37:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/77325968",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "I think this also solves https://github.com/bitcoin/bitcoin/issues/5526",
      "created_at" : "2015-03-10T14:15:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-78061333",
      "id" : 78061333,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-03-10T14:15:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/78061333",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Continued +1 on this.\r\n",
      "created_at" : "2015-05-02T19:17:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-98389333",
      "id" : 98389333,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-05-02T19:17:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/98389333",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "This was straightforward to rebase onto master.  While playing with it, this message got printed to the console once:\r\n\r\n    [warn] event_active: event has no event_base set.\r\n\r\nI haven't been able to reproduce it, but I'm banging on it now.",
      "created_at" : "2015-05-05T19:51:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-99201956",
      "id" : 99201956,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-05-05T19:51:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/99201956",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/430315?v=3",
         "events_url" : "https://api.github.com/users/ajweiss/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajweiss/followers",
         "following_url" : "https://api.github.com/users/ajweiss/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajweiss/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajweiss",
         "id" : 430315,
         "login" : "ajweiss",
         "organizations_url" : "https://api.github.com/users/ajweiss/orgs",
         "received_events_url" : "https://api.github.com/users/ajweiss/received_events",
         "repos_url" : "https://api.github.com/users/ajweiss/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajweiss/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajweiss/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajweiss"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r29715775"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/29715775"
         }
      },
      "body" : "I think there's a complicated race condition here.  StartHTTPServer() will bind the HTTP server and start listening, but if requests come in before the RPC/REST servers have called RegisterHTTPHandler(), their requests will result in 404s.  Moreover, if the request comes in before eventBase is set in StartHTTPServer(), HTTPRequest::WriteReply() will attempt to queue an HTTPEvent with an invalid event_base, which results in the server dropping the request on the floor and not replying at all.  (with an ugly libevent warning appearing on the console)  You can reproduce this by adding a MilliSleep(5000) to the end of StartHTTPServer before it assigns eventBase.  With this in place, regression tests will fail.  (It's pretty sporadic without the sleep)  You can catch the null eventBase by adding an assertion to HTTPRequest::WriteReply(), where you should see nStatus being set to 404.  Hope this is helpful!  ",
      "commit_id" : "d52802551752140cf41f0d9a225a43e84404d3e9",
      "created_at" : "2015-05-05T21:35:44Z",
      "diff_hunk" : "@@ -537,6 +536,21 @@ bool InitSanityCheck(void)\n     return true;\n }\n \n+bool AppInitServers(boost::thread_group& threadGroup)\n+{\n+    RPCServer::OnStopped(&OnRPCStopped);\n+    RPCServer::OnPreCommand(&OnRPCPreCommand);\n+    if (!StartHTTPServer(threadGroup))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r29715775",
      "id" : 29715775,
      "original_commit_id" : "e8123ee54c994106cef103ad35226b5ad93e0f30",
      "original_position" : 44,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677",
      "updated_at" : "2015-09-04T09:02:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/29715775",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/430315?v=3",
         "events_url" : "https://api.github.com/users/ajweiss/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajweiss/followers",
         "following_url" : "https://api.github.com/users/ajweiss/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajweiss/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajweiss",
         "id" : 430315,
         "login" : "ajweiss",
         "organizations_url" : "https://api.github.com/users/ajweiss/orgs",
         "received_events_url" : "https://api.github.com/users/ajweiss/received_events",
         "repos_url" : "https://api.github.com/users/ajweiss/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajweiss/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajweiss/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajweiss"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r29833341"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/29833341"
         }
      },
      "body" : "Thanks a lot for testing this! I'll try to track it down",
      "commit_id" : "d52802551752140cf41f0d9a225a43e84404d3e9",
      "created_at" : "2015-05-07T08:35:10Z",
      "diff_hunk" : "@@ -537,6 +536,21 @@ bool InitSanityCheck(void)\n     return true;\n }\n \n+bool AppInitServers(boost::thread_group& threadGroup)\n+{\n+    RPCServer::OnStopped(&OnRPCStopped);\n+    RPCServer::OnPreCommand(&OnRPCPreCommand);\n+    if (!StartHTTPServer(threadGroup))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r29833341",
      "id" : 29833341,
      "original_commit_id" : "e8123ee54c994106cef103ad35226b5ad93e0f30",
      "original_position" : 44,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677",
      "updated_at" : "2015-09-04T09:02:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/29833341",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I attempted to rebase master from the 2015_01_evhttpd branch and ran into a lot of merge conflicts that seemed to have nothing to do with libevent or http.  I'm not an expert in git, but does this indicate a serious problem?\r\n\r\nI've attempted with multiple -s options, but when completed I perform a diff master and I expected to see changes related to evhttpd but instead everything else seems to change.",
      "created_at" : "2015-05-15T00:05:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-102204878",
      "id" : 102204878,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-05-15T00:05:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/102204878",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1366303?v=3",
         "events_url" : "https://api.github.com/users/cheako/events{/privacy}",
         "followers_url" : "https://api.github.com/users/cheako/followers",
         "following_url" : "https://api.github.com/users/cheako/following{/other_user}",
         "gists_url" : "https://api.github.com/users/cheako/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/cheako",
         "id" : 1366303,
         "login" : "cheako",
         "organizations_url" : "https://api.github.com/users/cheako/orgs",
         "received_events_url" : "https://api.github.com/users/cheako/received_events",
         "repos_url" : "https://api.github.com/users/cheako/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/cheako/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/cheako/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/cheako"
      }
   },
   {
      "body" : "@cheako Sometimes the easiest thing to do is cherry pick each commit onto a fresh tree, rather than trying a git merge.\r\n",
      "created_at" : "2015-05-15T00:36:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-102210004",
      "id" : 102210004,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-05-15T00:36:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/102210004",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "@cheako This has become non-trivial to rebase, foremost due to a few REST changes and code moves. \r\nI promise to get back to this after the 0.11.0 release bustle and #6121 is merged.",
      "created_at" : "2015-05-15T10:45:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-102366417",
      "id" : 102366417,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-05-15T10:45:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/102366417",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Here's a branch that was rebased as of about 10 days ago if you want to play:\r\n\r\nhttps://github.com/ajweiss/bitcoin/tree/ajw_libevent_rebase",
      "created_at" : "2015-05-15T18:05:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-102473955",
      "id" : 102473955,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-05-15T18:05:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/102473955",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/430315?v=3",
         "events_url" : "https://api.github.com/users/ajweiss/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajweiss/followers",
         "following_url" : "https://api.github.com/users/ajweiss/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajweiss/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajweiss",
         "id" : 430315,
         "login" : "ajweiss",
         "organizations_url" : "https://api.github.com/users/ajweiss/orgs",
         "received_events_url" : "https://api.github.com/users/ajweiss/received_events",
         "repos_url" : "https://api.github.com/users/ajweiss/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajweiss/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajweiss/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajweiss"
      }
   },
   {
      "body" : "Also, on top of that rebase, here's a quick way to reproduce the race I found.  Just use the listtransactions.py RPC test...  ajweiss/bitcoin@0c008eb017824a21bc711e9e0d1cf52bff3a7b85",
      "created_at" : "2015-05-15T19:07:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-102495733",
      "id" : 102495733,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-05-15T19:07:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/102495733",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/430315?v=3",
         "events_url" : "https://api.github.com/users/ajweiss/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajweiss/followers",
         "following_url" : "https://api.github.com/users/ajweiss/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajweiss/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajweiss",
         "id" : 430315,
         "login" : "ajweiss",
         "organizations_url" : "https://api.github.com/users/ajweiss/orgs",
         "received_events_url" : "https://api.github.com/users/ajweiss/received_events",
         "repos_url" : "https://api.github.com/users/ajweiss/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajweiss/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajweiss/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajweiss"
      }
   },
   {
      "body" : "Continue to want this merged...\r\n",
      "created_at" : "2015-07-23T18:54:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-124210289",
      "id" : 124210289,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-07-23T18:54:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/124210289",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "Finally got around to rebasing this. It was somewhat tricky to rebase, especially over the univalue switch, so I hope I got everything right (the tests pass at least locally...).",
      "created_at" : "2015-08-27T18:38:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-135518027",
      "id" : 135518027,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-27T18:39:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135518027",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "concept ACK",
      "created_at" : "2015-08-27T21:54:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-135566332",
      "id" : 135566332,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-27T21:54:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135566332",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "body" : "Thanks for the work rebasing this.",
      "created_at" : "2015-08-27T23:37:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-135584631",
      "id" : 135584631,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-27T23:37:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135584631",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "re-ACK + \"it works\" test\r\n",
      "created_at" : "2015-08-28T00:34:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-135592135",
      "id" : 135592135,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-28T00:34:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135592135",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "OK, fixed all the issues in the opening post. Also added message to the release notes about removing SSL support (as well as how to use stunnel instead). Removed the [Poc] tag.\r\n\r\nNot sure yet why Travis is failing the RPC tests on Windows (both 32 and 64).\r\n",
      "created_at" : "2015-08-28T15:24:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-135805660",
      "id" : 135805660,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-28T15:24:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135805660",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Nice!\r\nStarted testing now...",
      "created_at" : "2015-08-28T15:39:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-135809661",
      "id" : 135809661,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-28T15:39:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135809661",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Looks like this: http://stackoverflow.com/a/19017158\r\n\r\nPerhaps the URL is getting a \"\\n\\r\" on Windows but a \"\\n\" elsewhere and the trim is not getting both bytes on Windows.",
      "created_at" : "2015-08-28T20:53:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-135885486",
      "id" : 135885486,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-28T20:53:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135885486",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1366303?v=3",
         "events_url" : "https://api.github.com/users/cheako/events{/privacy}",
         "followers_url" : "https://api.github.com/users/cheako/followers",
         "following_url" : "https://api.github.com/users/cheako/following{/other_user}",
         "gists_url" : "https://api.github.com/users/cheako/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/cheako",
         "id" : 1366303,
         "login" : "cheako",
         "organizations_url" : "https://api.github.com/users/cheako/orgs",
         "received_events_url" : "https://api.github.com/users/cheako/received_events",
         "repos_url" : "https://api.github.com/users/cheako/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/cheako/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/cheako/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/cheako"
      }
   },
   {
      "body" : "I tracked down a few of the problems:\r\n\r\nbitcoin-cli's -rpcwait is broken due to the libevent connection model. CallRPC() doesn't return when the connection fails, so the loop doesn't continue, and a new connection isn't tried. Instead it just sits there until the connection times out. This one's easy to test, simply fire up a ```./bitcoin-cli -rpcwait getblockcount``` before starting bitcoind, then run bitcoind and notice that it doesn't return.\r\n\r\nThe \"fix\" is to set the timeout to \"1\" here. https://github.com/bitcoin/bitcoin/pull/5677/files#diff-321303fddcf725df060981d626a05df9R152. I'm sure there's a smarter way to handle it via callbacks. There may be some other interaction with retries, but this didn't seem to make any different for me:\r\n```\r\nevhttp_connection_set_retries(evcon, 0);\r\n```\r\n\r\nAfter that, the next problem is that the server seems to hold the connection in TIME_WAIT after bitcoin-cli has exited. That causes the server to fail to listen on the next invocation and it fails. I tried the usual trick (SO_REUSEADDR) on the client and server sides, but it didn't help. I'm not sure where to go from there.",
      "created_at" : "2015-08-28T22:35:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-135903247",
      "id" : 135903247,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-28T22:35:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135903247",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "Ok, I was able to get to the bottom of this and get the tests passing. I have cobbled together a few hacks with the understanding that they're the _wrong_ things to do, but hopefully @laanwj will quickly see how to fix things up properly.\r\n\r\nThe issues outlined above are indeed the two issues. But to add to that, I think I know what's happening with the SO_REUSEADDR issue.\r\n\r\nI was able to \"fix\" that by hacking libevent itself (see patches below), but that points out the real problem. See this comment from libevent: \r\n```\r\n#ifndef WIN32\r\n        /* REUSEADDR on Unix means, \"don't hang on to this address after the\r\n         * listener is closed.\"  On Windows, though, it means \"don't keep other\r\n         * processes from binding to this address while we're using it. */\r\n```\r\n\r\nSo I think what we're seeing is that  SO_REUSEADDR works differently at runtime on native Windows as opposed to running it in Wine. Which makes sense. In Linux+Wine, it'll still be interacting with native sockets, thus it needs the option set even if it wouldn't be required in Windows. That's just a guess, but I think it's a reasonable one.\r\n\r\nI'm not sure what can be done about that, though. Whatever we decide, though, we need to re-address https://github.com/bitcoin/bitcoin/pull/6590, as that might've done more harm than good.\r\n\r\nHere's what's needed to make the tests happy (note that depends need to be rebuilt):\r\n```patch\r\ncommit 0aec4863b65b1e4f96260dd1b58d0cc8319d9b4e\r\nAuthor: Cory Fields <cory-nospam-@coryfields.com>\r\nDate:   Fri Aug 28 19:45:12 2015 -0400\r\n\r\n    event-http: Fix (hack) Windows tests.\r\n\r\ndiff --git a/depends/packages/libevent.mk b/depends/packages/libevent.mk\r\nindex 524a80f..94741ac 100644\r\n--- a/depends/packages/libevent.mk\r\n+++ b/depends/packages/libevent.mk\r\n@@ -3,6 +3,11 @@ $(package)_version=2.0.22\r\n $(package)_download_path=https://sourceforge.net/projects/levent/files/libevent/libevent-2.0\r\n $(package)_file_name=$(package)-$($(package)_version)-stable.tar.gz\r\n $(package)_sha256_hash=71c2c49f0adadacfdbe6332a372c38cf9c8b7895bb73dabeaa53cdcc1d4e1fa3\r\n+$(package)_patches=reuseaddr.patch\r\n+\r\n+define $(package)_preprocess_cmds\r\n+  patch -p1 < $($(package)_patch_dir)/reuseaddr.patch\r\n+endef\r\n \r\n define $(package)_set_vars\r\n   $(package)_config_opts=--disable-shared --disable-openssl --disable-libevent-regress\r\ndiff --git a/depends/patches/libevent/reuseaddr.patch b/depends/patches/libevent/reuseaddr.patch\r\nnew file mode 100644\r\nindex 0000000..24a6bb7\r\n--- /dev/null\r\n+++ b/depends/patches/libevent/reuseaddr.patch\r\n@@ -0,0 +1,21 @@\r\n+--- old/evutil.c\t2015-08-28 19:26:23.488765923 -0400\r\n++++ new/evutil.c\t2015-08-28 19:27:41.392767019 -0400\r\n+@@ -321,15 +321,16 @@\r\n+ int\r\n+ evutil_make_listen_socket_reuseable(evutil_socket_t sock)\r\n+ {\r\n+-#ifndef WIN32\r\n+ \tint one = 1;\r\n++#ifndef WIN32\r\n+ \t/* REUSEADDR on Unix means, \"don't hang on to this address after the\r\n+ \t * listener is closed.\"  On Windows, though, it means \"don't keep other\r\n+ \t * processes from binding to this address while we're using it. */\r\n+ \treturn setsockopt(sock, SOL_SOCKET, SO_REUSEADDR, (void*) &one,\r\n+ \t    (ev_socklen_t)sizeof(one));\r\n+ #else\r\n+-\treturn 0;\r\n++\treturn setsockopt(sock, SOL_SOCKET, SO_REUSEADDR, (const char*) &one,\r\n++\t    (ev_socklen_t)sizeof(one));\r\n+ #endif\r\n+ }\r\n+ \r\ndiff --git a/src/bitcoin-cli.cpp b/src/bitcoin-cli.cpp\r\nindex 82171a6..3ec3d4f 100644\r\n--- a/src/bitcoin-cli.cpp\r\n+++ b/src/bitcoin-cli.cpp\r\n@@ -149,7 +149,7 @@ UniValue CallRPC(const string& strMethod, const UniValue& params)\r\n     struct evhttp_connection *evcon = evhttp_connection_base_new(base, NULL, host.c_str(), port); // TODO RAII\r\n     if (evcon == NULL)\r\n         throw runtime_error(\"create connection failed\");\r\n-    evhttp_connection_set_timeout(evcon, GetArg(\"-rpctimeout\", 30));\r\n+    evhttp_connection_set_timeout(evcon, GetArg(\"-rpctimeout\", 1));\r\n \r\n     HTTPReply response;\r\n     struct evhttp_request *req = evhttp_request_new(http_request_done, (void*)&response); // TODO RAII\r\n\r\n```",
      "created_at" : "2015-08-29T00:03:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-135918349",
      "id" : 135918349,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-29T00:03:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135918349",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "(sorry for spamming)\r\n\r\nConfirmed the theory above: https://bugs.winehq.org/show_bug.cgi?id=26031\r\n\r\nLooks like the real fix will be to make sure that sockets are properly torn down so that we're not relying on SO_REUSEADDR at all. I tried everything I could think of, though, and couldn't get the socket suitably unbound. Maybe @laanwj will have better luck.",
      "created_at" : "2015-08-29T00:11:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-135919685",
      "id" : 135919685,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-29T00:11:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135919685",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "This might be irrelevant at this point, but was libuv considered for multi platform support?",
      "created_at" : "2015-08-29T01:09:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-135924264",
      "id" : 135924264,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-29T01:09:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135924264",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/288709?v=3",
         "events_url" : "https://api.github.com/users/ruimarinho/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ruimarinho/followers",
         "following_url" : "https://api.github.com/users/ruimarinho/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ruimarinho/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ruimarinho",
         "id" : 288709,
         "login" : "ruimarinho",
         "organizations_url" : "https://api.github.com/users/ruimarinho/orgs",
         "received_events_url" : "https://api.github.com/users/ruimarinho/received_events",
         "repos_url" : "https://api.github.com/users/ruimarinho/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ruimarinho/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ruimarinho/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ruimarinho"
      }
   },
   {
      "body" : "> This might be irrelevant at this point, but was libuv considered for multi platform support?\r\n\r\nHaving used both libraries extensively in commercial applications (using their native API),  I +1 support for libuv over libevent also.  **However, this PR is already ready.**\r\nlibuv is also more frequently updated, and arguably is deployed many thousands times more often in production (node/io.js), and is therefore likely more battle tested.\r\n\r\nFortunately,  swapping between them is a straight forward enough task.",
      "created_at" : "2015-08-29T01:21:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-135924817",
      "id" : 135924817,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-29T10:07:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135924817",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "body" : "@cfields Thanks a lot for looking into this. I don't like the solution of setting the timeout to 1, but it's good to have a way to make the tests pass :)\r\n\r\n@ruimarinho This has been floating around for months. I'd like to merge this when the remaining problems are solved. But if you can do so quickly, feel free to port this to libuv then we can compare performance and such...",
      "created_at" : "2015-08-29T08:11:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-135960413",
      "id" : 135960413,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-29T08:11:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135960413",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "+1 on libevent; having also used it in large highly critical commercial applications it is very widely deployed and reliable.\r\n\r\nLibuv is also very similar, so if there was a need to change in the future it could just be done \"no big deal.\".    Comparison would be neat, I agree, but not a reason to disrupt progress here.",
      "created_at" : "2015-08-29T08:27:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-135961325",
      "id" : 135961325,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-29T08:27:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135961325",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "+1 on libevent. No need to disturb this PR in that stage of progress.",
      "created_at" : "2015-08-29T08:28:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-135961618",
      "id" : 135961618,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-29T08:28:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135961618",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "#### Performance:\r\nPerformance looks good, not much of a difference. Built over gitian for testing (https://builds.jonasschnelli.ch/pulls/5677/). Had much slower results with a local build (osx, --enable-debug, libevent 2.0.22, dynamic linked).\r\n\r\nStats, no very representative, did only once on a non-calm system.\r\nRegtest, 100 blocks chain, OSX 10.10, 2.6 GHz Intel Core i7:\r\n**apache-bench comparison: 1000 `getinfo` requests**:\r\n(slightly slower)\r\nhttps://gist.github.com/jonasschnelli/2b511c62c1d9ed901a9b\r\n\r\n**apache-bench comparison: 10'000 `getinfo` requests**:\r\n(faster ~1.4*)\r\nhttps://gist.github.com/jonasschnelli/d86c552d99dd2d1672d3\r\n\r\n#### Memory:\r\nThe memory behavior looks very similar if i compare current master with the PR.\r\n**No leeks detected.**\r\n10'000 `getchaintips` request looks very similar in terms of CPU load and mem consumption.\r\n\r\n(top chart is current master, bottom chart is libevent)\r\n<img width=\"1002\" alt=\"bildschirmfoto 2015-08-29 um 10 50 19\" src=\"https://cloud.githubusercontent.com/assets/178464/9561193/d425046e-4e3b-11e5-8781-e4988dd6c66d.png\">\r\n\r\n#### Unit Tests\r\nSuccessfully ran on linux and osx multiple times.\r\n",
      "created_at" : "2015-08-29T08:53:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-135964028",
      "id" : 135964028,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-29T08:53:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135964028",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Do i understand this correct, that this PR would no longer support **non**-http-keep-alive request/responses? Do we break existing things if we no longer allow forcing the disabling of http-keep-alive? Maybe some systems request with http keep alive `\"Connection: keep-alive\"` but expect that the connection closes after the first request because they have disabled keep-alive over the `-rpckeepalive` arg.\r\nAnyways the connected system should take care of that. Maybe just for the release notes.",
      "created_at" : "2015-08-29T08:57:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-135964175",
      "id" : 135964175,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-29T08:59:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135964175",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r38260585"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/38260585"
         }
      },
      "body" : "idea: sleep time=*2 per attempt unless a successful auth happened? (although could be done in another PR)",
      "commit_id" : "d52802551752140cf41f0d9a225a43e84404d3e9",
      "created_at" : "2015-08-29T09:13:04Z",
      "diff_hunk" : "@@ -0,0 +1,193 @@\n+#include \"httprpc.h\"\n+\n+#include \"base58.h\"\n+#include \"chainparams.h\"\n+#include \"httpserver.h\"\n+#include \"rpcprotocol.h\"\n+#include \"rpcserver.h\"\n+#include \"random.h\"\n+#include \"sync.h\"\n+#include \"util.h\"\n+#include \"utilstrencodings.h\"\n+#include \"ui_interface.h\"\n+\n+#include <boost/algorithm/string.hpp> // boost::trim\n+\n+/** Simple one-shot callback timer to be used by the RPC mechanism to e.g.\n+ * re-lock the wellet.\n+ */\n+class HTTPRPCTimer : public RPCTimerBase\n+{\n+public:\n+    HTTPRPCTimer(struct event_base* eventBase, boost::function<void(void)>& func, int64_t millis) :\n+        ev(eventBase, false, func)\n+    {\n+        struct timeval tv;\n+        tv.tv_sec = millis/1000;\n+        tv.tv_usec = (millis%1000)*1000;\n+        ev.trigger(&tv);\n+    }\n+private:\n+    HTTPEvent ev;\n+};\n+\n+class HTTPRPCTimerInterface : public RPCTimerInterface\n+{\n+public:\n+    HTTPRPCTimerInterface(struct event_base* base) : base(base)\n+    {\n+    }\n+    const char* Name()\n+    {\n+        return \"HTTP\";\n+    }\n+    RPCTimerBase* NewTimer(boost::function<void(void)>& func, int64_t millis)\n+    {\n+        return new HTTPRPCTimer(base, func, millis);\n+    }\n+private:\n+    struct event_base* base;\n+};\n+\n+\n+/* Pre-base64-encoded authentication token */\n+static std::string strRPCUserColonPass;\n+/* Stored RPC timer interface (for unregistration) */\n+static HTTPRPCTimerInterface* httpRPCTimerInterface = 0;\n+\n+static void JSONErrorReply(HTTPRequest* req, const UniValue& objError, const UniValue& id)\n+{\n+    // Send error reply from json-rpc error object\n+    int nStatus = HTTP_INTERNAL_SERVER_ERROR;\n+    int code = find_value(objError, \"code\").get_int();\n+\n+    if (code == RPC_INVALID_REQUEST)\n+        nStatus = HTTP_BAD_REQUEST;\n+    else if (code == RPC_METHOD_NOT_FOUND)\n+        nStatus = HTTP_NOT_FOUND;\n+\n+    std::string strReply = JSONRPCReply(NullUniValue, objError, id);\n+\n+    req->WriteHeader(\"Content-Type\", \"application/json\");\n+    req->WriteReply(nStatus, strReply);\n+}\n+\n+static bool RPCAuthorized(const std::string& strAuth)\n+{\n+    if (strRPCUserColonPass.empty()) // Belt-and-suspenders measure if InitRPCAuthentication was not called\n+        return false;\n+    if (strAuth.substr(0, 6) != \"Basic \")\n+        return false;\n+    std::string strUserPass64 = strAuth.substr(6);\n+    boost::trim(strUserPass64);\n+    std::string strUserPass = DecodeBase64(strUserPass64);\n+    return TimingResistantEqual(strUserPass, strRPCUserColonPass);\n+}\n+\n+static bool HTTPReq_JSONRPC(HTTPRequest* req, const std::string &)\n+{\n+    // JSONRPC handles only POST\n+    if (req->GetRequestMethod() != HTTPRequest::POST) {\n+        req->WriteReply(HTTP_BAD_METHOD, \"JSONRPC server handles only POST requests\");\n+        return false;\n+    }\n+    // Check authorization\n+    std::pair<bool, std::string> authHeader = req->GetHeader(\"authorization\");\n+    if (!authHeader.first) {\n+        req->WriteReply(HTTP_UNAUTHORIZED);\n+        return false;\n+    }\n+\n+    if (!RPCAuthorized(authHeader.second)) {\n+        LogPrintf(\"ThreadRPCServer incorrect password attempt from %s\\n\", req->GetPeer().ToString());\n+\n+        /* Deter brute-forcing\n+           If this results in a DoS the user really\n+           shouldn't have their RPC port exposed. */\n+        MilliSleep(250);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r38260585",
      "id" : 38260585,
      "original_commit_id" : "fba95dbe0d3690af5a9666bb9b451215e24bfefa",
      "original_position" : 107,
      "path" : "src/httprpc.cpp",
      "position" : 107,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677",
      "updated_at" : "2015-09-04T09:02:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/38260585",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r38260600"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/38260600"
         }
      },
      "body" : "Since one can evade that just by making new connections (in parallel) is it really a gain?",
      "commit_id" : "d52802551752140cf41f0d9a225a43e84404d3e9",
      "created_at" : "2015-08-29T09:15:21Z",
      "diff_hunk" : "@@ -0,0 +1,193 @@\n+#include \"httprpc.h\"\n+\n+#include \"base58.h\"\n+#include \"chainparams.h\"\n+#include \"httpserver.h\"\n+#include \"rpcprotocol.h\"\n+#include \"rpcserver.h\"\n+#include \"random.h\"\n+#include \"sync.h\"\n+#include \"util.h\"\n+#include \"utilstrencodings.h\"\n+#include \"ui_interface.h\"\n+\n+#include <boost/algorithm/string.hpp> // boost::trim\n+\n+/** Simple one-shot callback timer to be used by the RPC mechanism to e.g.\n+ * re-lock the wellet.\n+ */\n+class HTTPRPCTimer : public RPCTimerBase\n+{\n+public:\n+    HTTPRPCTimer(struct event_base* eventBase, boost::function<void(void)>& func, int64_t millis) :\n+        ev(eventBase, false, func)\n+    {\n+        struct timeval tv;\n+        tv.tv_sec = millis/1000;\n+        tv.tv_usec = (millis%1000)*1000;\n+        ev.trigger(&tv);\n+    }\n+private:\n+    HTTPEvent ev;\n+};\n+\n+class HTTPRPCTimerInterface : public RPCTimerInterface\n+{\n+public:\n+    HTTPRPCTimerInterface(struct event_base* base) : base(base)\n+    {\n+    }\n+    const char* Name()\n+    {\n+        return \"HTTP\";\n+    }\n+    RPCTimerBase* NewTimer(boost::function<void(void)>& func, int64_t millis)\n+    {\n+        return new HTTPRPCTimer(base, func, millis);\n+    }\n+private:\n+    struct event_base* base;\n+};\n+\n+\n+/* Pre-base64-encoded authentication token */\n+static std::string strRPCUserColonPass;\n+/* Stored RPC timer interface (for unregistration) */\n+static HTTPRPCTimerInterface* httpRPCTimerInterface = 0;\n+\n+static void JSONErrorReply(HTTPRequest* req, const UniValue& objError, const UniValue& id)\n+{\n+    // Send error reply from json-rpc error object\n+    int nStatus = HTTP_INTERNAL_SERVER_ERROR;\n+    int code = find_value(objError, \"code\").get_int();\n+\n+    if (code == RPC_INVALID_REQUEST)\n+        nStatus = HTTP_BAD_REQUEST;\n+    else if (code == RPC_METHOD_NOT_FOUND)\n+        nStatus = HTTP_NOT_FOUND;\n+\n+    std::string strReply = JSONRPCReply(NullUniValue, objError, id);\n+\n+    req->WriteHeader(\"Content-Type\", \"application/json\");\n+    req->WriteReply(nStatus, strReply);\n+}\n+\n+static bool RPCAuthorized(const std::string& strAuth)\n+{\n+    if (strRPCUserColonPass.empty()) // Belt-and-suspenders measure if InitRPCAuthentication was not called\n+        return false;\n+    if (strAuth.substr(0, 6) != \"Basic \")\n+        return false;\n+    std::string strUserPass64 = strAuth.substr(6);\n+    boost::trim(strUserPass64);\n+    std::string strUserPass = DecodeBase64(strUserPass64);\n+    return TimingResistantEqual(strUserPass, strRPCUserColonPass);\n+}\n+\n+static bool HTTPReq_JSONRPC(HTTPRequest* req, const std::string &)\n+{\n+    // JSONRPC handles only POST\n+    if (req->GetRequestMethod() != HTTPRequest::POST) {\n+        req->WriteReply(HTTP_BAD_METHOD, \"JSONRPC server handles only POST requests\");\n+        return false;\n+    }\n+    // Check authorization\n+    std::pair<bool, std::string> authHeader = req->GetHeader(\"authorization\");\n+    if (!authHeader.first) {\n+        req->WriteReply(HTTP_UNAUTHORIZED);\n+        return false;\n+    }\n+\n+    if (!RPCAuthorized(authHeader.second)) {\n+        LogPrintf(\"ThreadRPCServer incorrect password attempt from %s\\n\", req->GetPeer().ToString());\n+\n+        /* Deter brute-forcing\n+           If this results in a DoS the user really\n+           shouldn't have their RPC port exposed. */\n+        MilliSleep(250);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r38260600",
      "id" : 38260600,
      "original_commit_id" : "fba95dbe0d3690af5a9666bb9b451215e24bfefa",
      "original_position" : 107,
      "path" : "src/httprpc.cpp",
      "position" : 107,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677",
      "updated_at" : "2015-09-04T09:02:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/38260600",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r38260634"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/38260634"
         }
      },
      "body" : "Hmm... the sleep time then could be global (thread safe static uint64_t)?",
      "commit_id" : "d52802551752140cf41f0d9a225a43e84404d3e9",
      "created_at" : "2015-08-29T09:19:08Z",
      "diff_hunk" : "@@ -0,0 +1,193 @@\n+#include \"httprpc.h\"\n+\n+#include \"base58.h\"\n+#include \"chainparams.h\"\n+#include \"httpserver.h\"\n+#include \"rpcprotocol.h\"\n+#include \"rpcserver.h\"\n+#include \"random.h\"\n+#include \"sync.h\"\n+#include \"util.h\"\n+#include \"utilstrencodings.h\"\n+#include \"ui_interface.h\"\n+\n+#include <boost/algorithm/string.hpp> // boost::trim\n+\n+/** Simple one-shot callback timer to be used by the RPC mechanism to e.g.\n+ * re-lock the wellet.\n+ */\n+class HTTPRPCTimer : public RPCTimerBase\n+{\n+public:\n+    HTTPRPCTimer(struct event_base* eventBase, boost::function<void(void)>& func, int64_t millis) :\n+        ev(eventBase, false, func)\n+    {\n+        struct timeval tv;\n+        tv.tv_sec = millis/1000;\n+        tv.tv_usec = (millis%1000)*1000;\n+        ev.trigger(&tv);\n+    }\n+private:\n+    HTTPEvent ev;\n+};\n+\n+class HTTPRPCTimerInterface : public RPCTimerInterface\n+{\n+public:\n+    HTTPRPCTimerInterface(struct event_base* base) : base(base)\n+    {\n+    }\n+    const char* Name()\n+    {\n+        return \"HTTP\";\n+    }\n+    RPCTimerBase* NewTimer(boost::function<void(void)>& func, int64_t millis)\n+    {\n+        return new HTTPRPCTimer(base, func, millis);\n+    }\n+private:\n+    struct event_base* base;\n+};\n+\n+\n+/* Pre-base64-encoded authentication token */\n+static std::string strRPCUserColonPass;\n+/* Stored RPC timer interface (for unregistration) */\n+static HTTPRPCTimerInterface* httpRPCTimerInterface = 0;\n+\n+static void JSONErrorReply(HTTPRequest* req, const UniValue& objError, const UniValue& id)\n+{\n+    // Send error reply from json-rpc error object\n+    int nStatus = HTTP_INTERNAL_SERVER_ERROR;\n+    int code = find_value(objError, \"code\").get_int();\n+\n+    if (code == RPC_INVALID_REQUEST)\n+        nStatus = HTTP_BAD_REQUEST;\n+    else if (code == RPC_METHOD_NOT_FOUND)\n+        nStatus = HTTP_NOT_FOUND;\n+\n+    std::string strReply = JSONRPCReply(NullUniValue, objError, id);\n+\n+    req->WriteHeader(\"Content-Type\", \"application/json\");\n+    req->WriteReply(nStatus, strReply);\n+}\n+\n+static bool RPCAuthorized(const std::string& strAuth)\n+{\n+    if (strRPCUserColonPass.empty()) // Belt-and-suspenders measure if InitRPCAuthentication was not called\n+        return false;\n+    if (strAuth.substr(0, 6) != \"Basic \")\n+        return false;\n+    std::string strUserPass64 = strAuth.substr(6);\n+    boost::trim(strUserPass64);\n+    std::string strUserPass = DecodeBase64(strUserPass64);\n+    return TimingResistantEqual(strUserPass, strRPCUserColonPass);\n+}\n+\n+static bool HTTPReq_JSONRPC(HTTPRequest* req, const std::string &)\n+{\n+    // JSONRPC handles only POST\n+    if (req->GetRequestMethod() != HTTPRequest::POST) {\n+        req->WriteReply(HTTP_BAD_METHOD, \"JSONRPC server handles only POST requests\");\n+        return false;\n+    }\n+    // Check authorization\n+    std::pair<bool, std::string> authHeader = req->GetHeader(\"authorization\");\n+    if (!authHeader.first) {\n+        req->WriteReply(HTTP_UNAUTHORIZED);\n+        return false;\n+    }\n+\n+    if (!RPCAuthorized(authHeader.second)) {\n+        LogPrintf(\"ThreadRPCServer incorrect password attempt from %s\\n\", req->GetPeer().ToString());\n+\n+        /* Deter brute-forcing\n+           If this results in a DoS the user really\n+           shouldn't have their RPC port exposed. */\n+        MilliSleep(250);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r38260634",
      "id" : 38260634,
      "original_commit_id" : "fba95dbe0d3690af5a9666bb9b451215e24bfefa",
      "original_position" : 107,
      "path" : "src/httprpc.cpp",
      "position" : 107,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677",
      "updated_at" : "2015-09-04T09:02:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/38260634",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r38260719"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/38260719"
         }
      },
      "body" : "perhaps, though it turns a auth token probe into a DOS attack then, enh?. That might be preferable though if your token is at all bruteforcable you are in bad shape.\r\n",
      "commit_id" : "d52802551752140cf41f0d9a225a43e84404d3e9",
      "created_at" : "2015-08-29T09:33:00Z",
      "diff_hunk" : "@@ -0,0 +1,193 @@\n+#include \"httprpc.h\"\n+\n+#include \"base58.h\"\n+#include \"chainparams.h\"\n+#include \"httpserver.h\"\n+#include \"rpcprotocol.h\"\n+#include \"rpcserver.h\"\n+#include \"random.h\"\n+#include \"sync.h\"\n+#include \"util.h\"\n+#include \"utilstrencodings.h\"\n+#include \"ui_interface.h\"\n+\n+#include <boost/algorithm/string.hpp> // boost::trim\n+\n+/** Simple one-shot callback timer to be used by the RPC mechanism to e.g.\n+ * re-lock the wellet.\n+ */\n+class HTTPRPCTimer : public RPCTimerBase\n+{\n+public:\n+    HTTPRPCTimer(struct event_base* eventBase, boost::function<void(void)>& func, int64_t millis) :\n+        ev(eventBase, false, func)\n+    {\n+        struct timeval tv;\n+        tv.tv_sec = millis/1000;\n+        tv.tv_usec = (millis%1000)*1000;\n+        ev.trigger(&tv);\n+    }\n+private:\n+    HTTPEvent ev;\n+};\n+\n+class HTTPRPCTimerInterface : public RPCTimerInterface\n+{\n+public:\n+    HTTPRPCTimerInterface(struct event_base* base) : base(base)\n+    {\n+    }\n+    const char* Name()\n+    {\n+        return \"HTTP\";\n+    }\n+    RPCTimerBase* NewTimer(boost::function<void(void)>& func, int64_t millis)\n+    {\n+        return new HTTPRPCTimer(base, func, millis);\n+    }\n+private:\n+    struct event_base* base;\n+};\n+\n+\n+/* Pre-base64-encoded authentication token */\n+static std::string strRPCUserColonPass;\n+/* Stored RPC timer interface (for unregistration) */\n+static HTTPRPCTimerInterface* httpRPCTimerInterface = 0;\n+\n+static void JSONErrorReply(HTTPRequest* req, const UniValue& objError, const UniValue& id)\n+{\n+    // Send error reply from json-rpc error object\n+    int nStatus = HTTP_INTERNAL_SERVER_ERROR;\n+    int code = find_value(objError, \"code\").get_int();\n+\n+    if (code == RPC_INVALID_REQUEST)\n+        nStatus = HTTP_BAD_REQUEST;\n+    else if (code == RPC_METHOD_NOT_FOUND)\n+        nStatus = HTTP_NOT_FOUND;\n+\n+    std::string strReply = JSONRPCReply(NullUniValue, objError, id);\n+\n+    req->WriteHeader(\"Content-Type\", \"application/json\");\n+    req->WriteReply(nStatus, strReply);\n+}\n+\n+static bool RPCAuthorized(const std::string& strAuth)\n+{\n+    if (strRPCUserColonPass.empty()) // Belt-and-suspenders measure if InitRPCAuthentication was not called\n+        return false;\n+    if (strAuth.substr(0, 6) != \"Basic \")\n+        return false;\n+    std::string strUserPass64 = strAuth.substr(6);\n+    boost::trim(strUserPass64);\n+    std::string strUserPass = DecodeBase64(strUserPass64);\n+    return TimingResistantEqual(strUserPass, strRPCUserColonPass);\n+}\n+\n+static bool HTTPReq_JSONRPC(HTTPRequest* req, const std::string &)\n+{\n+    // JSONRPC handles only POST\n+    if (req->GetRequestMethod() != HTTPRequest::POST) {\n+        req->WriteReply(HTTP_BAD_METHOD, \"JSONRPC server handles only POST requests\");\n+        return false;\n+    }\n+    // Check authorization\n+    std::pair<bool, std::string> authHeader = req->GetHeader(\"authorization\");\n+    if (!authHeader.first) {\n+        req->WriteReply(HTTP_UNAUTHORIZED);\n+        return false;\n+    }\n+\n+    if (!RPCAuthorized(authHeader.second)) {\n+        LogPrintf(\"ThreadRPCServer incorrect password attempt from %s\\n\", req->GetPeer().ToString());\n+\n+        /* Deter brute-forcing\n+           If this results in a DoS the user really\n+           shouldn't have their RPC port exposed. */\n+        MilliSleep(250);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r38260719",
      "id" : 38260719,
      "original_commit_id" : "fba95dbe0d3690af5a9666bb9b451215e24bfefa",
      "original_position" : 107,
      "path" : "src/httprpc.cpp",
      "position" : 107,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677",
      "updated_at" : "2015-09-04T09:02:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/38260719",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "@laanwj In case it wasn't clear in all my rambling above, the rpcwait issue will need some sort of fix, not just for the sake of testing. I certainly didn't intend to imply that timeout=1 was any real solution though :)\r\n\r\n@jonasschnelli great testing!",
      "created_at" : "2015-08-29T10:13:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-135968451",
      "id" : 135968451,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-29T10:13:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135968451",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r38261029"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/38261029"
         }
      },
      "body" : "Should evbuffer_drain here for good measure.",
      "commit_id" : "d52802551752140cf41f0d9a225a43e84404d3e9",
      "created_at" : "2015-08-29T10:27:04Z",
      "diff_hunk" : "@@ -92,32 +95,74 @@ static bool AppInitRPC(int argc, char* argv[])\n         fprintf(stderr, \"Error: Invalid combination of -regtest and -testnet.\\n\");\n         return false;\n     }\n+    if (GetBoolArg(\"-rpcssl\", false))\n+    {\n+        fprintf(stderr, \"Error: SSL mode for RPC (-rpcssl) is no longer supported.\\n\");\n+        return false;\n+    }\n     return true;\n }\n \n-UniValue CallRPC(const string& strMethod, const UniValue& params)\n+\n+/** Reply structure for request_done to fill in */\n+struct HTTPReply\n {\n-    // Connect to localhost\n-    bool fUseSSL = GetBoolArg(\"-rpcssl\", false);\n-    boost::asio::io_service io_service;\n-    boost::asio::ssl::context context(io_service, boost::asio::ssl::context::sslv23);\n-    context.set_options(boost::asio::ssl::context::no_sslv2 | boost::asio::ssl::context::no_sslv3);\n-    boost::asio::ssl::stream<boost::asio::ip::tcp::socket> sslStream(io_service, context);\n-    SSLIOStreamDevice<boost::asio::ip::tcp> d(sslStream, fUseSSL);\n-    boost::iostreams::stream< SSLIOStreamDevice<boost::asio::ip::tcp> > stream(d);\n-\n-    const bool fConnected = d.connect(GetArg(\"-rpcconnect\", \"127.0.0.1\"), GetArg(\"-rpcport\", itostr(BaseParams().RPCPort())));\n-    if (!fConnected)\n-        throw CConnectionFailed(\"couldn't connect to server\");\n+    int status;\n+    std::string body;\n+};\n+\n+static void http_request_done(struct evhttp_request *req, void *ctx)\n+{\n+    HTTPReply *reply = static_cast<HTTPReply*>(ctx);\n+\n+    if (req == NULL) {\n+        /* If req is NULL, it means an error occurred while connecting, but\n+         * I'm not sure how to find out which one. We also don't really care.\n+         */\n+        reply->status = 0;\n+        return;\n+    }\n+\n+    reply->status = evhttp_request_get_response_code(req);\n \n-    // Find credentials to use\n+    struct evbuffer *buf = evhttp_request_get_input_buffer(req);\n+    if (buf)\n+    {\n+        size_t size = evbuffer_get_length(buf);\n+        const char *data = (const char*)evbuffer_pullup(buf, size);\n+        if (data)\n+            reply->body = std::string(data, size);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r38261029",
      "id" : 38261029,
      "original_commit_id" : "fba95dbe0d3690af5a9666bb9b451215e24bfefa",
      "original_position" : 77,
      "path" : "src/bitcoin-cli.cpp",
      "position" : 77,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677",
      "updated_at" : "2015-09-04T09:02:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/38261029",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r38295242"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/38295242"
         }
      },
      "body" : "I aimed to keep the behavior here exactly the same. Let's leave improvements for a latter pull.\r\n(there are various practical issues with doing it this way, e.g. sleeping a worker thread to just pause a bit is wasteful - it could be handled with a timed event callback. Then again, this is not *supposed* to ever trigger as people should not leave the RPC port open to the outside world, so don't spend too much time or code on it.)",
      "commit_id" : "d52802551752140cf41f0d9a225a43e84404d3e9",
      "created_at" : "2015-08-31T09:04:27Z",
      "diff_hunk" : "@@ -0,0 +1,193 @@\n+#include \"httprpc.h\"\n+\n+#include \"base58.h\"\n+#include \"chainparams.h\"\n+#include \"httpserver.h\"\n+#include \"rpcprotocol.h\"\n+#include \"rpcserver.h\"\n+#include \"random.h\"\n+#include \"sync.h\"\n+#include \"util.h\"\n+#include \"utilstrencodings.h\"\n+#include \"ui_interface.h\"\n+\n+#include <boost/algorithm/string.hpp> // boost::trim\n+\n+/** Simple one-shot callback timer to be used by the RPC mechanism to e.g.\n+ * re-lock the wellet.\n+ */\n+class HTTPRPCTimer : public RPCTimerBase\n+{\n+public:\n+    HTTPRPCTimer(struct event_base* eventBase, boost::function<void(void)>& func, int64_t millis) :\n+        ev(eventBase, false, func)\n+    {\n+        struct timeval tv;\n+        tv.tv_sec = millis/1000;\n+        tv.tv_usec = (millis%1000)*1000;\n+        ev.trigger(&tv);\n+    }\n+private:\n+    HTTPEvent ev;\n+};\n+\n+class HTTPRPCTimerInterface : public RPCTimerInterface\n+{\n+public:\n+    HTTPRPCTimerInterface(struct event_base* base) : base(base)\n+    {\n+    }\n+    const char* Name()\n+    {\n+        return \"HTTP\";\n+    }\n+    RPCTimerBase* NewTimer(boost::function<void(void)>& func, int64_t millis)\n+    {\n+        return new HTTPRPCTimer(base, func, millis);\n+    }\n+private:\n+    struct event_base* base;\n+};\n+\n+\n+/* Pre-base64-encoded authentication token */\n+static std::string strRPCUserColonPass;\n+/* Stored RPC timer interface (for unregistration) */\n+static HTTPRPCTimerInterface* httpRPCTimerInterface = 0;\n+\n+static void JSONErrorReply(HTTPRequest* req, const UniValue& objError, const UniValue& id)\n+{\n+    // Send error reply from json-rpc error object\n+    int nStatus = HTTP_INTERNAL_SERVER_ERROR;\n+    int code = find_value(objError, \"code\").get_int();\n+\n+    if (code == RPC_INVALID_REQUEST)\n+        nStatus = HTTP_BAD_REQUEST;\n+    else if (code == RPC_METHOD_NOT_FOUND)\n+        nStatus = HTTP_NOT_FOUND;\n+\n+    std::string strReply = JSONRPCReply(NullUniValue, objError, id);\n+\n+    req->WriteHeader(\"Content-Type\", \"application/json\");\n+    req->WriteReply(nStatus, strReply);\n+}\n+\n+static bool RPCAuthorized(const std::string& strAuth)\n+{\n+    if (strRPCUserColonPass.empty()) // Belt-and-suspenders measure if InitRPCAuthentication was not called\n+        return false;\n+    if (strAuth.substr(0, 6) != \"Basic \")\n+        return false;\n+    std::string strUserPass64 = strAuth.substr(6);\n+    boost::trim(strUserPass64);\n+    std::string strUserPass = DecodeBase64(strUserPass64);\n+    return TimingResistantEqual(strUserPass, strRPCUserColonPass);\n+}\n+\n+static bool HTTPReq_JSONRPC(HTTPRequest* req, const std::string &)\n+{\n+    // JSONRPC handles only POST\n+    if (req->GetRequestMethod() != HTTPRequest::POST) {\n+        req->WriteReply(HTTP_BAD_METHOD, \"JSONRPC server handles only POST requests\");\n+        return false;\n+    }\n+    // Check authorization\n+    std::pair<bool, std::string> authHeader = req->GetHeader(\"authorization\");\n+    if (!authHeader.first) {\n+        req->WriteReply(HTTP_UNAUTHORIZED);\n+        return false;\n+    }\n+\n+    if (!RPCAuthorized(authHeader.second)) {\n+        LogPrintf(\"ThreadRPCServer incorrect password attempt from %s\\n\", req->GetPeer().ToString());\n+\n+        /* Deter brute-forcing\n+           If this results in a DoS the user really\n+           shouldn't have their RPC port exposed. */\n+        MilliSleep(250);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r38295242",
      "id" : 38295242,
      "original_commit_id" : "fba95dbe0d3690af5a9666bb9b451215e24bfefa",
      "original_position" : 107,
      "path" : "src/httprpc.cpp",
      "position" : 107,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677",
      "updated_at" : "2015-09-04T09:02:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/38295242",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@jonasschnelli Thanks for testing the memory behavior and performance!\r\n\r\n> Do i understand this correct, that this PR would no longer support non-http-keep-alive request/responses? \r\n\r\nLibevent's http server absolutely supports non-http-keepalive `Connection:close`, and even HTTP 1.0. What it doesn't support is *disabling* keepalive globally (as it is a mandatory feature of HTTP 1.1.) I don't think this is necessary anymore - the `-rpckeepalive=0` workaround was there to work around broken RPC behavior, as well as lack of any kind of timeout.\r\n~~(hmm - it may be possible to force HTTP 1.0 for connections, which sort of amounts to the same thing)~~ (no, no way that I see)\r\n",
      "created_at" : "2015-08-31T09:07:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-136308842",
      "id" : 136308842,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-31T13:38:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/136308842",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r38304671"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/38304671"
         }
      },
      "body" : "Done. Good catch.",
      "commit_id" : "d52802551752140cf41f0d9a225a43e84404d3e9",
      "created_at" : "2015-08-31T11:52:30Z",
      "diff_hunk" : "@@ -92,32 +95,74 @@ static bool AppInitRPC(int argc, char* argv[])\n         fprintf(stderr, \"Error: Invalid combination of -regtest and -testnet.\\n\");\n         return false;\n     }\n+    if (GetBoolArg(\"-rpcssl\", false))\n+    {\n+        fprintf(stderr, \"Error: SSL mode for RPC (-rpcssl) is no longer supported.\\n\");\n+        return false;\n+    }\n     return true;\n }\n \n-UniValue CallRPC(const string& strMethod, const UniValue& params)\n+\n+/** Reply structure for request_done to fill in */\n+struct HTTPReply\n {\n-    // Connect to localhost\n-    bool fUseSSL = GetBoolArg(\"-rpcssl\", false);\n-    boost::asio::io_service io_service;\n-    boost::asio::ssl::context context(io_service, boost::asio::ssl::context::sslv23);\n-    context.set_options(boost::asio::ssl::context::no_sslv2 | boost::asio::ssl::context::no_sslv3);\n-    boost::asio::ssl::stream<boost::asio::ip::tcp::socket> sslStream(io_service, context);\n-    SSLIOStreamDevice<boost::asio::ip::tcp> d(sslStream, fUseSSL);\n-    boost::iostreams::stream< SSLIOStreamDevice<boost::asio::ip::tcp> > stream(d);\n-\n-    const bool fConnected = d.connect(GetArg(\"-rpcconnect\", \"127.0.0.1\"), GetArg(\"-rpcport\", itostr(BaseParams().RPCPort())));\n-    if (!fConnected)\n-        throw CConnectionFailed(\"couldn't connect to server\");\n+    int status;\n+    std::string body;\n+};\n+\n+static void http_request_done(struct evhttp_request *req, void *ctx)\n+{\n+    HTTPReply *reply = static_cast<HTTPReply*>(ctx);\n+\n+    if (req == NULL) {\n+        /* If req is NULL, it means an error occurred while connecting, but\n+         * I'm not sure how to find out which one. We also don't really care.\n+         */\n+        reply->status = 0;\n+        return;\n+    }\n+\n+    reply->status = evhttp_request_get_response_code(req);\n \n-    // Find credentials to use\n+    struct evbuffer *buf = evhttp_request_get_input_buffer(req);\n+    if (buf)\n+    {\n+        size_t size = evbuffer_get_length(buf);\n+        const char *data = (const char*)evbuffer_pullup(buf, size);\n+        if (data)\n+            reply->body = std::string(data, size);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r38304671",
      "id" : 38304671,
      "original_commit_id" : "fba95dbe0d3690af5a9666bb9b451215e24bfefa",
      "original_position" : 77,
      "path" : "src/bitcoin-cli.cpp",
      "position" : 77,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677",
      "updated_at" : "2015-09-04T09:02:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/38304671",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "> CallRPC() doesn't return when the connection fails, so the loop doesn't continue, and a new connection isn't tried. \r\n\r\nMissed this observation @theuni. Yes, that should definitely be solved. I wonder why this only trips up on Wine.E.g. on Linux this returns immediately without hang, if there is no server bound:\r\n```\r\n$ src/bitcoin-cli -rpcpassword='a' getinfo\r\nerror: couldn't connect to server\r\n```\r\n",
      "created_at" : "2015-08-31T15:25:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-136405492",
      "id" : 136405492,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-31T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/136405492",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@laanwj I wondered the same thing. The behavior seemed odd to me, I assumed it was just a timing difference. I'm glad to know it's just a Wine/Windows thing, but now I'm curious to know if it happens in native Win as well. I'll give it a shot on osx and see what happens.\r\n\r\nProbably worth taking a look at the source of evhttp_request_new to see what flags it sets. I also found it odd that a different callback isn't used for a connection failure, that makes it tough to handle.",
      "created_at" : "2015-08-31T16:14:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-136418133",
      "id" : 136418133,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-08-31T16:14:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/136418133",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "Looks like we're chasing emulator rabbits. I've cross-compiled (w/ depends) to win64 locally and ran the RPC tests (just as travis does) against this code, through WINE. No issues. The wine version is wine-1.7.50. Maybe that makes the difference, and Travis runs an old broken version?\r\nIf so I'd propose setting `rpctimeout=1` just for travis-win32/64 to make the test pass until they upgrade to a newer wine.\r\n\r\n@jonasschnelli is going to run the tests on a real windows VM. Those results will be more useful.\r\n",
      "created_at" : "2015-09-01T09:22:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-136646964",
      "id" : 136646964,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-09-01T09:22:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/136646964",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Successfully ran `rcp-test.sh` on \"Windows 8\" (see screen below):\r\nDisabled `p2p-fullbocktest.py` because didn't want to install python/dbm. Also had to disable one test in `rest.py` during getutxo binary request. The python httplib did somehow not sent a proper binary request. Tracked down and seems to be unrelated to this PR (also happens on current master).\r\n\r\n<img width=\"964\" alt=\"bildschirmfoto 2015-09-01 um 15 42 53\" src=\"https://cloud.githubusercontent.com/assets/178464/9605827/3bbd8390-50c0-11e5-9f82-7396a224ec4a.png\">",
      "created_at" : "2015-09-01T13:46:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-136728096",
      "id" : 136728096,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-09-01T13:46:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/136728096",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Post merge tested ACK",
      "created_at" : "2015-09-04T11:24:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-137710094",
      "id" : 137710094,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-09-04T11:24:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/137710094",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Great to have this merged!\n\nOn Friday, September 4, 2015, Jonas Schnelli <notifications@github.com>\nwrote:\n\n> Post merge tested ACK\n>\n> \n> Reply to this email directly or view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-137710094>.\n>\n",
      "created_at" : "2015-09-04T11:25:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-137710217",
      "id" : 137710217,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-09-04T11:25:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/137710217",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=3",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "body" : "Build notes should be extended for at least OS X/brew. I use macports here and:\r\n```\r\nport install libevent\r\n```\r\nwas needed to get it compiled.\r\n",
      "created_at" : "2015-09-04T13:20:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-137736157",
      "id" : 137736157,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-09-04T13:20:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/137736157",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "body" : "@paveljanik: just added `libevent` mentioning for osx in #6635",
      "created_at" : "2015-09-04T13:27:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-137737926",
      "id" : 137737926,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-09-04T13:27:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/137737926",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "post merge tested re-ACK\r\n",
      "created_at" : "2015-09-04T13:32:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-137739062",
      "id" : 137739062,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-09-04T13:32:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/137739062",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   }
]
