[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Resurrected from #24474.\r\n\r\nThe main purpose of this PR is to document the variables we assume are only accessed via one thread, and hence which we don't bother to grab a mutex before accessing. Since these annotations are checked automatically by clang in CI, this should help avoid possible bugs in future.\r\n\r\nTo do this, this PR replaces the per-peer `CNode::cs_sendProcessing` (that was never actually used as a guard annotation for any variables, nor locked from any thread other than the message processing thread, and can only be used to guard other members of the `CNode` class) with a single, global, ~`NetEventsInterface:g_mutex_msgproc_thread`~ `NetEventsInterface:g_msgproc_mutex` that is locked once from the message processing thread and released only when the thread exits.\r\n\r\nIt would also be possible to have a \"dummy\" lockable type and use that to document these variables, rather than an actual mutex. I've done an example of that sort of approach at https://github.com/bitcoin/bitcoin/pull/25174#issuecomment-1230284198 but for this case where the lock is only ever acquired once at startup and has no possible contention, the overhead seems so minimal as to not be worth worrying about.\r\n\r\nIn the long-term, simplifying the locking scheme, and perhaps allowing more things to happen in parallel are obviously still worthwhile; this PR doesn't mean to imply that these things *should* only be used from a single thread in future, rather it's just documenting that they are right now.\r\n\r\nSee also https://github.com/bitcoin/bitcoin/pull/25454#pullrequestreview-1030142634 https://github.com/bitcoin/bitcoin/pull/25557#issuecomment-1182092190  ",
      "created_at" : "2022-09-07T17:59:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26036#issuecomment-1239707930",
      "id" : 1239707930,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26036",
      "node_id" : "IC_kwDOABII585J5HEa",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1239707930/reactions"
      },
      "updated_at" : "2022-09-13T03:44:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1239707930",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25597](https://github.com/bitcoin/bitcoin/pull/25597) (refactor: replace RecursiveMutex `cs_sendProcessing` with Mutex by theStack)\n* [#25572](https://github.com/bitcoin/bitcoin/pull/25572) (refactor: Introduce EvictionManager and use it for the inbound eviction logic by dergoegge)\n* [#24545](https://github.com/bitcoin/bitcoin/pull/24545) (BIP324: Enable v2 P2P encrypted transport by dhruv)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-09-08T17:35:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26036#issuecomment-1241026514",
      "id" : 1241026514,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26036",
      "node_id" : "IC_kwDOABII585J-I_S",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1241026514/reactions"
      },
      "updated_at" : "2022-09-12T09:02:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1241026514",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r967765403"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967765403"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Runtime lock assertions on the definitions for the methods with added annotations on their declarations, e.g. for the first commit (same for the later commits):\r\n\r\n```diff\r\n--- a/src/net_processing.cpp\r\n+++ b/src/net_processing.cpp\r\n@@ -3135,6 +3135,7 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\r\n                                      const std::chrono::microseconds time_received,\r\n                                      const std::atomic<bool>& interruptMsgProc)\r\n {\r\n+    AssertLockHeld(g_mutex_msgproc_thread);\r\n \r\n@@ -4748,6 +4749,7 @@ bool PeerManagerImpl::MaybeDiscourageAndDisconnect(CNode& pnode, Peer& peer)\r\n \r\n bool PeerManagerImpl::ProcessMessages(CNode* pfrom, std::atomic<bool>& interruptMsgProc)\r\n {\r\n+    AssertLockHeld(g_mutex_msgproc_thread);\r\n \r\n@@ -5240,6 +5242,7 @@ bool PeerManagerImpl::SetupAddressRelay(const CNode& node, Peer& peer)\r\n \r\n bool PeerManagerImpl::SendMessages(CNode* pto)\r\n {\r\n+    AssertLockHeld(g_mutex_msgproc_thread);\r\n```\r\n\r\n\r\n ",
      "commit_id" : "f55747fa66afe1dcca242c0903b17c93f0437279",
      "created_at" : "2022-09-11T06:10:24Z",
      "diff_hunk" : "@@ -84,7 +84,7 @@ class PeerManager : public CValidationInterface, public NetEventsInterface\n \n     /** Process a single message from a peer. Public for fuzz testing */\n     virtual void ProcessMessage(CNode& pfrom, const std::string& msg_type, CDataStream& vRecv,\n-                                const std::chrono::microseconds time_received, const std::atomic<bool>& interruptMsgProc) = 0;\n+                                const std::chrono::microseconds time_received, const std::atomic<bool>& interruptMsgProc) EXCLUSIVE_LOCKS_REQUIRED(g_mutex_msgproc_thread) = 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r967765403",
      "id" : 967765403,
      "line" : 87,
      "node_id" : "PRRC_kwDOABII5845ru2b",
      "original_commit_id" : "f55747fa66afe1dcca242c0903b17c93f0437279",
      "original_line" : 87,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.h",
      "position" : 5,
      "pull_request_review_id" : 1103244150,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967765403/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-11T06:14:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/967765403",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r968562054"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/968562054"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: since it is not required that the variables protected by this mutex should only be used from a single thread in future, maybe drop `_thread` from the name of this mutex.\r\n\r\nnit: it seems like unwritten convention to put `_mutex` at the end: `foobar_mutex`, I think this is the first one to use `mutex_foobar`",
      "commit_id" : "22e7c464db9719ebc8eba0143f5a6024aac658c3",
      "created_at" : "2022-09-12T15:27:23Z",
      "diff_hunk" : "@@ -629,6 +627,9 @@ class CNode\n class NetEventsInterface\n {\n public:\n+    /** Mutex for anything that is only accessed via the msg processing thread */\n+    static Mutex g_mutex_msgproc_thread;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r968562054",
      "id" : 968562054,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5845uxWG",
      "original_commit_id" : "f55747fa66afe1dcca242c0903b17c93f0437279",
      "original_line" : 631,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : null,
      "pull_request_review_id" : 1104351136,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/968562054/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-12T15:33:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/968562054",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r969087706"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/969087706"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Renamed",
      "commit_id" : "22e7c464db9719ebc8eba0143f5a6024aac658c3",
      "created_at" : "2022-09-13T02:41:18Z",
      "diff_hunk" : "@@ -629,6 +627,9 @@ class CNode\n class NetEventsInterface\n {\n public:\n+    /** Mutex for anything that is only accessed via the msg processing thread */\n+    static Mutex g_mutex_msgproc_thread;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r969087706",
      "id" : 969087706,
      "in_reply_to_id" : 968562054,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5845wxra",
      "original_commit_id" : "f55747fa66afe1dcca242c0903b17c93f0437279",
      "original_line" : 631,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : null,
      "pull_request_review_id" : 1105052728,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/969087706/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-13T02:41:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/969087706",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Are you planning to actually make the message processing multi-threaded?\r\n\r\nOriginal point of all this was just to be able to make `g_cs_orphans` private to `TxOrphanage` without reducing guard annotations (#21527 and `vExtraTxn*`).\r\n\r\nI don't think multiple `net_processing` threads is likely to help much -- I think blocking mostly happens due to `cs_main` getting locked which would just cause multiple threads to stall if we had them, rather than some node requiring a lot of local processing that holds up some other node's local processing. Having either reader-writer locks for the mempool and `cs_main` or switching to a RCU model might help there, but is probably a lot of work. Either way, it seems helpful in the meantime to make it clearer how we protect things from race conditions.",
      "created_at" : "2022-09-13T03:36:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26036#issuecomment-1244855724",
      "id" : 1244855724,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26036",
      "node_id" : "IC_kwDOABII585KMv2s",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1244855724/reactions"
      },
      "updated_at" : "2022-09-13T03:36:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1244855724",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Any reason https://github.com/bitcoin/bitcoin/pull/26036#discussion_r967765403 wasn't addressed in the last push? It would be helpful to know if the thread safety guidelines in the developer notes should be updated.",
      "created_at" : "2022-09-14T10:52:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26036#issuecomment-1246590210",
      "id" : 1246590210,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26036",
      "node_id" : "IC_kwDOABII585KTXUC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1246590210/reactions"
      },
      "updated_at" : "2022-09-14T10:52:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1246590210",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r970658409"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/970658409"
         }
      },
      "author_association" : "MEMBER",
      "body" : "db5c65bafd6360236e6009cbe4b470606720dce3: Any reason to add the namespace bloat here, but not elsewhere? It seems unlikely that there is another symbol with the same name in the global or another namespace. For that reason I'd also prefer to just make it a global in the global namespace to also de-bloat the other places.\r\n\r\n\r\n```diff\r\ndiff --git a/src/net_processing.cpp b/src/net_processing.cpp\r\nindex 594141ca84..d9a1124b64 100644\r\n--- a/src/net_processing.cpp\r\n+++ b/src/net_processing.cpp\r\n@@ -537,7 +537,7 @@ public:\r\n \r\n private:\r\n     /** Consider evicting an outbound peer based on the amount of time they've been behind our tip */\r\n-    void ConsiderEviction(CNode& pto, Peer& peer, std::chrono::seconds time_in_seconds) EXCLUSIVE_LOCKS_REQUIRED(cs_main, NetEventsInterface::g_msgproc_mutex);\r\n+    void ConsiderEviction(CNode& pto, Peer& peer, std::chrono::seconds time_in_seconds) EXCLUSIVE_LOCKS_REQUIRED(cs_main, g_msgproc_mutex);\r\n \r\n     /** If we have extra outbound peers, try to disconnect the one with the oldest block announcement */\r\n     void EvictExtraOutboundPeers(std::chrono::seconds now) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\r\n@@ -601,7 +601,7 @@ private:\r\n     void ProcessHeadersMessage(CNode& pfrom, Peer& peer,\r\n                                std::vector<CBlockHeader>&& headers,\r\n                                bool via_compact_block)\r\n-        EXCLUSIVE_LOCKS_REQUIRED(!m_peer_mutex, !m_headers_presync_mutex, NetEventsInterface::g_msgproc_mutex);\r\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_peer_mutex, !m_headers_presync_mutex, g_msgproc_mutex);\r\n     /** Various helpers for headers processing, invoked by ProcessHeadersMessage() */\r\n     /** Return true if headers are continuous and have valid proof-of-work (DoS points assigned on failure) */\r\n     bool CheckHeadersPoW(const std::vector<CBlockHeader>& headers, const Consensus::Params& consensusParams, Peer& peer);\r\n@@ -610,7 +610,7 @@ private:\r\n     /** Deal with state tracking and headers sync for peers that send the\r\n      * occasional non-connecting header (this can happen due to BIP 130 headers\r\n      * announcements for blocks interacting with the 2hr (MAX_FUTURE_BLOCK_TIME) rule). */\r\n-    void HandleFewUnconnectingHeaders(CNode& pfrom, Peer& peer, const std::vector<CBlockHeader>& headers) EXCLUSIVE_LOCKS_REQUIRED(NetEventsInterface::g_msgproc_mutex);\r\n+    void HandleFewUnconnectingHeaders(CNode& pfrom, Peer& peer, const std::vector<CBlockHeader>& headers) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\r\n     /** Return true if the headers connect to each other, false otherwise */\r\n     bool CheckHeadersAreContinuous(const std::vector<CBlockHeader>& headers) const;\r\n     /** Try to continue a low-work headers sync that has already begun.\r\n@@ -633,7 +633,7 @@ private:\r\n      */\r\n     bool IsContinuationOfLowWorkHeadersSync(Peer& peer, CNode& pfrom,\r\n             std::vector<CBlockHeader>& headers)\r\n-        EXCLUSIVE_LOCKS_REQUIRED(peer.m_headers_sync_mutex, !m_headers_presync_mutex, NetEventsInterface::g_msgproc_mutex);\r\n+        EXCLUSIVE_LOCKS_REQUIRED(peer.m_headers_sync_mutex, !m_headers_presync_mutex, g_msgproc_mutex);\r\n     /** Check work on a headers chain to be processed, and if insufficient,\r\n      * initiate our anti-DoS headers sync mechanism.\r\n      *\r\n@@ -649,7 +649,7 @@ private:\r\n     bool TryLowWorkHeadersSync(Peer& peer, CNode& pfrom,\r\n                                   const CBlockIndex* chain_start_header,\r\n                                   std::vector<CBlockHeader>& headers)\r\n-        EXCLUSIVE_LOCKS_REQUIRED(!peer.m_headers_sync_mutex, !m_peer_mutex, !m_headers_presync_mutex, NetEventsInterface::g_msgproc_mutex);\r\n+        EXCLUSIVE_LOCKS_REQUIRED(!peer.m_headers_sync_mutex, !m_peer_mutex, !m_headers_presync_mutex, g_msgproc_mutex);\r\n \r\n     /** Return true if the given header is an ancestor of\r\n      *  m_chainman.m_best_header or our current tip */\r\n@@ -659,7 +659,7 @@ private:\r\n      * We don't issue a getheaders message if we have a recent one outstanding.\r\n      * This returns true if a getheaders is actually sent, and false otherwise.\r\n      */\r\n-    bool MaybeSendGetHeaders(CNode& pfrom, const CBlockLocator& locator, Peer& peer) EXCLUSIVE_LOCKS_REQUIRED(NetEventsInterface::g_msgproc_mutex);\r\n+    bool MaybeSendGetHeaders(CNode& pfrom, const CBlockLocator& locator, Peer& peer) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\r\n     /** Potentially fetch blocks from this peer upon receipt of a new headers tip */\r\n     void HeadersDirectFetchBlocks(CNode& pfrom, const Peer& peer, const CBlockIndex* pindexLast);\r\n     /** Update peer state based on received headers message */\r\n@@ -683,10 +683,10 @@ private:\r\n     void MaybeSendPing(CNode& node_to, Peer& peer, std::chrono::microseconds now);\r\n \r\n     /** Send `addr` messages on a regular schedule. */\r\n-    void MaybeSendAddr(CNode& node, Peer& peer, std::chrono::microseconds current_time) EXCLUSIVE_LOCKS_REQUIRED(NetEventsInterface::g_msgproc_mutex);\r\n+    void MaybeSendAddr(CNode& node, Peer& peer, std::chrono::microseconds current_time) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\r\n \r\n     /** Send a single `sendheaders` message, after we have completed headers sync with a peer. */\r\n-    void MaybeSendSendHeaders(CNode& node, Peer& peer) EXCLUSIVE_LOCKS_REQUIRED(NetEventsInterface::g_msgproc_mutex);\r\n+    void MaybeSendSendHeaders(CNode& node, Peer& peer) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\r\n \r\n     /** Relay (gossip) an address to a few randomly chosen nodes.\r\n      *\r\n@@ -695,10 +695,10 @@ private:\r\n      * @param[in] fReachable   Whether the address' network is reachable. We relay unreachable\r\n      *                         addresses less.\r\n      */\r\n-    void RelayAddress(NodeId originator, const CAddress& addr, bool fReachable) EXCLUSIVE_LOCKS_REQUIRED(!m_peer_mutex, NetEventsInterface::g_msgproc_mutex);\r\n+    void RelayAddress(NodeId originator, const CAddress& addr, bool fReachable) EXCLUSIVE_LOCKS_REQUIRED(!m_peer_mutex, g_msgproc_mutex);\r\n \r\n     /** Send `feefilter` message. */\r\n-    void MaybeSendFeefilter(CNode& node, Peer& peer, std::chrono::microseconds current_time) EXCLUSIVE_LOCKS_REQUIRED(NetEventsInterface::g_msgproc_mutex);\r\n+    void MaybeSendFeefilter(CNode& node, Peer& peer, std::chrono::microseconds current_time) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\r\n \r\n     const CChainParams& m_chainparams;\r\n     CConnman& m_connman;\r\n@@ -1010,7 +1010,7 @@ private:\r\n      *  @return   True if address relay is enabled with peer\r\n      *            False if address relay is disallowed\r\n      */\r\n-    bool SetupAddressRelay(const CNode& node, Peer& peer) EXCLUSIVE_LOCKS_REQUIRED(NetEventsInterface::g_msgproc_mutex);\r\n+    bool SetupAddressRelay(const CNode& node, Peer& peer) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\r\n };\r\n \r\n const CNodeState* PeerManagerImpl::State(NodeId pnode) const EXCLUSIVE_LOCKS_REQUIRED(cs_main)\r\n@@ -5099,7 +5099,7 @@ void PeerManagerImpl::MaybeSendAddr(CNode& node, Peer& peer, std::chrono::micros\r\n \r\n     // Remove addr records that the peer already knows about, and add new\r\n     // addrs to the m_addr_known filter on the same pass.\r\n-    auto addr_already_known = [&peer](const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(NetEventsInterface::g_msgproc_mutex) {\r\n+    auto addr_already_known = [&peer](const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex) {\r\n         bool ret = peer.m_addr_known->contains(addr.GetKey());\r\n         if (!ret) peer.m_addr_known->insert(addr.GetKey());\r\n         return ret;\r\n",
      "commit_id" : "22e7c464db9719ebc8eba0143f5a6024aac658c3",
      "created_at" : "2022-09-14T11:01:44Z",
      "diff_hunk" : "@@ -5099,7 +5099,7 @@ void PeerManagerImpl::MaybeSendAddr(CNode& node, Peer& peer, std::chrono::micros\n \n     // Remove addr records that the peer already knows about, and add new\n     // addrs to the m_addr_known filter on the same pass.\n-    auto addr_already_known = [&peer](const CAddress& addr) {\n+    auto addr_already_known = [&peer](const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(NetEventsInterface::g_msgproc_mutex) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r970658409",
      "id" : 970658409,
      "line" : 5102,
      "node_id" : "PRRC_kwDOABII58452xJp",
      "original_commit_id" : "db5c65bafd6360236e6009cbe4b470606720dce3",
      "original_line" : 5102,
      "original_position" : 193,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 193,
      "pull_request_review_id" : 1107263525,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/970658409/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-14T11:04:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/970658409",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r971522360"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971522360"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Added the runtime assertions for these three, but not any of the private/internal methods in `net_processing`, since that doesn't seem likely to have any benefit.",
      "commit_id" : "60682dc1e506f01446ba54b4c41c8f32a9459235",
      "created_at" : "2022-09-15T04:52:39Z",
      "diff_hunk" : "@@ -84,7 +84,7 @@ class PeerManager : public CValidationInterface, public NetEventsInterface\n \n     /** Process a single message from a peer. Public for fuzz testing */\n     virtual void ProcessMessage(CNode& pfrom, const std::string& msg_type, CDataStream& vRecv,\n-                                const std::chrono::microseconds time_received, const std::atomic<bool>& interruptMsgProc) = 0;\n+                                const std::chrono::microseconds time_received, const std::atomic<bool>& interruptMsgProc) EXCLUSIVE_LOCKS_REQUIRED(g_mutex_msgproc_thread) = 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r971522360",
      "id" : 971522360,
      "in_reply_to_id" : 967765403,
      "line" : null,
      "node_id" : "PRRC_kwDOABII58456EE4",
      "original_commit_id" : "f55747fa66afe1dcca242c0903b17c93f0437279",
      "original_line" : 87,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.h",
      "position" : null,
      "pull_request_review_id" : 1108520802,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971522360/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-15T04:52:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971522360",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r971524074"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971524074"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ah, didn't cross my mind that it wasn't necessary here. `m_last_block_inv_triggering_headers_sync` also doesn't need the class name. I've left it in the class since that class essentially defines \"message processing\" so it seems more appropriate than not.",
      "commit_id" : "60682dc1e506f01446ba54b4c41c8f32a9459235",
      "created_at" : "2022-09-15T04:55:47Z",
      "diff_hunk" : "@@ -5099,7 +5099,7 @@ void PeerManagerImpl::MaybeSendAddr(CNode& node, Peer& peer, std::chrono::micros\n \n     // Remove addr records that the peer already knows about, and add new\n     // addrs to the m_addr_known filter on the same pass.\n-    auto addr_already_known = [&peer](const CAddress& addr) {\n+    auto addr_already_known = [&peer](const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(NetEventsInterface::g_msgproc_mutex) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r971524074",
      "id" : 971524074,
      "in_reply_to_id" : 970658409,
      "line" : null,
      "node_id" : "PRRC_kwDOABII58456Efq",
      "original_commit_id" : "db5c65bafd6360236e6009cbe4b470606720dce3",
      "original_line" : 5102,
      "original_position" : 193,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 1108523104,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971524074/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-15T04:55:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971524074",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r971634782"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971634782"
         }
      },
      "author_association" : "MEMBER",
      "body" : "g_msgproc_mutex already clarifies that this is for message processing, so still think the namespace/class can be dropped",
      "commit_id" : "60682dc1e506f01446ba54b4c41c8f32a9459235",
      "created_at" : "2022-09-15T07:37:22Z",
      "diff_hunk" : "@@ -5099,7 +5099,7 @@ void PeerManagerImpl::MaybeSendAddr(CNode& node, Peer& peer, std::chrono::micros\n \n     // Remove addr records that the peer already knows about, and add new\n     // addrs to the m_addr_known filter on the same pass.\n-    auto addr_already_known = [&peer](const CAddress& addr) {\n+    auto addr_already_known = [&peer](const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(NetEventsInterface::g_msgproc_mutex) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r971634782",
      "id" : 971634782,
      "in_reply_to_id" : 970658409,
      "line" : null,
      "node_id" : "PRRC_kwDOABII58456fhe",
      "original_commit_id" : "db5c65bafd6360236e6009cbe4b470606720dce3",
      "original_line" : 5102,
      "original_position" : 193,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 1108683381,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971634782/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-15T07:37:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971634782",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "review ACK 60682dc1e506f01446ba54b4c41c8f32a9459235 ð¤\r\n\r\n<details><summary>Show signature</summary>\r\n\r\nSignature:\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA512\r\n\r\nreview ACK 60682dc1e506f01446ba54b4c41c8f32a9459235 ð¤\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\r\npUgEZgv/f+A8D5L+blHinz1hvX6Lx161mNRj4EjTkO8G6z8T7FAWLAlFjkRUD/px\r\npfjkbSjby0mCk+Qy56q9TnHNeNCvVtl3Qp4bIoQBzG2KfUtkvGHR2c+KsM3XW6F9\r\ngaZfzhQBQsieSluEt0PtJMx9jo4zDEUEIcHg2QRtPaPIf631UtO6MeIRSnwr0V3K\r\n2+A706TTlgJgKP9lFyAM0KjhKtQ61CVY0Drh0C7wuErTP+Pb+WiQ8jDNM5UfGjvi\r\nlF/VqYJXgvAgT/Y6F7ft8BMo39zrlBK9k+/i1KaUOgysp9/TX1e17BWxfFFnBEsh\r\nhbXcL6bYr5qqw9CaWH3qNWHZV9tTGgdLcypdD2gIAiMaLgZeu05YUOk8pXyp3/0o\r\nsGLI3ih7yQ3Hy1S5e0+hDvU+drVgVndEyaxyCZtSn4u+4e9UWl9YVnncfdXDTwXy\r\nKZ1i5SKJbp+pZ3JWBQmJK6HTalIBOC4TDcs/930ym/CChXmVqv4bMAhS1Mkzp8tB\r\nPGnTV0Eb\r\n=AnQA\r\n-----END PGP SIGNATURE-----\r\n```\r\n\r\n\r\n</details>\r\n",
      "created_at" : "2022-09-15T07:37:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26036#issuecomment-1247701321",
      "id" : 1247701321,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26036",
      "node_id" : "IC_kwDOABII585KXmlJ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1247701321/reactions"
      },
      "updated_at" : "2022-09-15T07:37:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1247701321",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r971723009"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971723009"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Then, should it be `GlobalMutex`? I had some plans to eradicate that one.",
      "commit_id" : "60682dc1e506f01446ba54b4c41c8f32a9459235",
      "created_at" : "2022-09-15T09:00:47Z",
      "diff_hunk" : "@@ -5099,7 +5099,7 @@ void PeerManagerImpl::MaybeSendAddr(CNode& node, Peer& peer, std::chrono::micros\n \n     // Remove addr records that the peer already knows about, and add new\n     // addrs to the m_addr_known filter on the same pass.\n-    auto addr_already_known = [&peer](const CAddress& addr) {\n+    auto addr_already_known = [&peer](const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(NetEventsInterface::g_msgproc_mutex) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r971723009",
      "id" : 971723009,
      "in_reply_to_id" : 970658409,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584561EB",
      "original_commit_id" : "db5c65bafd6360236e6009cbe4b470606720dce3",
      "original_line" : 5102,
      "original_position" : 193,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 1108810507,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971723009/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-15T09:00:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971723009",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r971743081"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971743081"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Actually, the guidelines are pretty explicit for this:\r\n\r\n>   - Combine annotations in function declarations with run-time asserts in\r\n    function definitions:\r\n\r\nI think it is better to remove or modify a rule from the guidelines instead of violating it.",
      "commit_id" : "60682dc1e506f01446ba54b4c41c8f32a9459235",
      "created_at" : "2022-09-15T09:18:57Z",
      "diff_hunk" : "@@ -84,7 +84,7 @@ class PeerManager : public CValidationInterface, public NetEventsInterface\n \n     /** Process a single message from a peer. Public for fuzz testing */\n     virtual void ProcessMessage(CNode& pfrom, const std::string& msg_type, CDataStream& vRecv,\n-                                const std::chrono::microseconds time_received, const std::atomic<bool>& interruptMsgProc) = 0;\n+                                const std::chrono::microseconds time_received, const std::atomic<bool>& interruptMsgProc) EXCLUSIVE_LOCKS_REQUIRED(g_mutex_msgproc_thread) = 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r971743081",
      "id" : 971743081,
      "in_reply_to_id" : 967765403,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5845659p",
      "original_commit_id" : "f55747fa66afe1dcca242c0903b17c93f0437279",
      "original_line" : 87,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.h",
      "position" : null,
      "pull_request_review_id" : 1108838727,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971743081/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-15T09:18:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971743081",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r971767290"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971767290"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In the previous incarnation of this PR the commit `net_processing: add thread safety annotations for PeerManagerImpl members accessed only via the msgproc thread` contained just this, 1-line, hunk.\r\n\r\nNow it contains many hunks that change `NetEventsInterface::g_msgproc_mutex` to `g_msgproc_mutex`. Better to use `g_msgproc_mutex` initially and not have to modify it in a subsequent commit.",
      "commit_id" : "60682dc1e506f01446ba54b4c41c8f32a9459235",
      "created_at" : "2022-09-15T09:40:12Z",
      "diff_hunk" : "@@ -751,7 +751,7 @@ class PeerManagerImpl final : public PeerManager\n     int nSyncStarted GUARDED_BY(cs_main) = 0;\n \n     /** Hash of the last block we received via INV */\n-    uint256 m_last_block_inv_triggering_headers_sync{};\n+    uint256 m_last_block_inv_triggering_headers_sync GUARDED_BY(g_msgproc_mutex){};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r971767290",
      "id" : 971767290,
      "line" : 754,
      "node_id" : "PRRC_kwDOABII58456_36",
      "original_commit_id" : "60682dc1e506f01446ba54b4c41c8f32a9459235",
      "original_line" : 754,
      "original_position" : 187,
      "original_start_line" : 754,
      "path" : "src/net_processing.cpp",
      "position" : 187,
      "pull_request_review_id" : 1108872778,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971767290/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 754,
      "start_side" : "LEFT",
      "updated_at" : "2022-09-15T09:40:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971767290",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r971829616"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971829616"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ugh, yes. Fixed",
      "commit_id" : "d575a675cc884b1bebdb6197f2ef45c51788d4a3",
      "created_at" : "2022-09-15T10:45:32Z",
      "diff_hunk" : "@@ -751,7 +751,7 @@ class PeerManagerImpl final : public PeerManager\n     int nSyncStarted GUARDED_BY(cs_main) = 0;\n \n     /** Hash of the last block we received via INV */\n-    uint256 m_last_block_inv_triggering_headers_sync{};\n+    uint256 m_last_block_inv_triggering_headers_sync GUARDED_BY(g_msgproc_mutex){};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r971829616",
      "id" : 971829616,
      "in_reply_to_id" : 971767290,
      "line" : 754,
      "node_id" : "PRRC_kwDOABII58457PFw",
      "original_commit_id" : "60682dc1e506f01446ba54b4c41c8f32a9459235",
      "original_line" : 754,
      "original_position" : 187,
      "original_start_line" : 754,
      "path" : "src/net_processing.cpp",
      "position" : 187,
      "pull_request_review_id" : 1108962100,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971829616/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 754,
      "start_side" : "LEFT",
      "updated_at" : "2022-09-15T10:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971829616",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r971833081"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971833081"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "If it were a normal global rather than a static member of the class it would need to be `GlobalMutex` (otherwise you get an error that `CConnman::ThreadMessageHandler()` needs to be annotated with `EXCLUSIVE_LOCKS_REQUIRED(!g_msgproc_mutex)`, and probably similar in the tests). With the lock being a class member, clang assumes functions outside of the class aren't called with the lock held.",
      "commit_id" : "d575a675cc884b1bebdb6197f2ef45c51788d4a3",
      "created_at" : "2022-09-15T10:49:21Z",
      "diff_hunk" : "@@ -5099,7 +5099,7 @@ void PeerManagerImpl::MaybeSendAddr(CNode& node, Peer& peer, std::chrono::micros\n \n     // Remove addr records that the peer already knows about, and add new\n     // addrs to the m_addr_known filter on the same pass.\n-    auto addr_already_known = [&peer](const CAddress& addr) {\n+    auto addr_already_known = [&peer](const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(NetEventsInterface::g_msgproc_mutex) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r971833081",
      "id" : 971833081,
      "in_reply_to_id" : 970658409,
      "line" : null,
      "node_id" : "PRRC_kwDOABII58457P75",
      "original_commit_id" : "db5c65bafd6360236e6009cbe4b470606720dce3",
      "original_line" : 5102,
      "original_position" : 193,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 1108967075,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971833081/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-15T10:49:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971833081",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r971929318"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971929318"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, I mean that if \"the namespace/class is dropped\" then it becomes normal global and thus its type must be changed.",
      "commit_id" : "d575a675cc884b1bebdb6197f2ef45c51788d4a3",
      "created_at" : "2022-09-15T12:34:37Z",
      "diff_hunk" : "@@ -5099,7 +5099,7 @@ void PeerManagerImpl::MaybeSendAddr(CNode& node, Peer& peer, std::chrono::micros\n \n     // Remove addr records that the peer already knows about, and add new\n     // addrs to the m_addr_known filter on the same pass.\n-    auto addr_already_known = [&peer](const CAddress& addr) {\n+    auto addr_already_known = [&peer](const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(NetEventsInterface::g_msgproc_mutex) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26036#discussion_r971929318",
      "id" : 971929318,
      "in_reply_to_id" : 970658409,
      "line" : null,
      "node_id" : "PRRC_kwDOABII58457nbm",
      "original_commit_id" : "db5c65bafd6360236e6009cbe4b470606720dce3",
      "original_line" : 5102,
      "original_position" : 193,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 1109107584,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26036",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971929318/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-15T12:34:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/971929318",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "review ACK d575a675cc884b1bebdb6197f2ef45c51788d4a3 ð½\r\n\r\n<details><summary>Show signature</summary>\r\n\r\nSignature:\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA512\r\n\r\nreview ACK d575a675cc884b1bebdb6197f2ef45c51788d4a3 ð½\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\r\npUjnCgv/VwIJXtqBslTMcneH9mic4H9oVu0GmVcAskWGZcUNOMGAFHhtrD8a08IF\r\nVRj9QOBUlvJHKo13NpDbctT7GOOQPTuDV0TS7ixote1+yjwknsGpB1MpVgCu1s8M\r\nsu/9Xx5zdikfQoybb7qbjcYrtaOUQYfoxSsFIGJoiKMTZ1H0D6GjS4D0/XORsMIL\r\nLk7UNeLByR5Kq/otSHUEdzu42ToZTGEFEPUvOoDefNdFdbbB9KLT59NYSbYiBJLD\r\n39C8VPYuu+M8q2i1PaC4Zr9l7ufFvQv09lw9TBFN+ztAz0gnc6sm+kr2b7/yHkDq\r\nMmDflnhyaMV8XYehtz/SbWiS2QAcNc96ewy5M4pL1V6gNHytzr75qk9oBWpKPSMM\r\nam2/TiSf+EnKwsU9Quj2XbzYhBweFk0xNpXbAYHeFf7WEH0E/vb/5PudbelwmNRP\r\nAzaXYbyh4qR/uKyaJ9wlCFMcr0toWPb7koqHOTba1Zq2Kb+JyWRI6cWkB3BZX2EM\r\nEZQHT3Z2\r\n=X5uj\r\n-----END PGP SIGNATURE-----\r\n```\r\n\r\n\r\n</details>\r\n",
      "created_at" : "2022-09-15T19:49:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26036#issuecomment-1248539814",
      "id" : 1248539814,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26036",
      "node_id" : "IC_kwDOABII585KazSm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1248539814/reactions"
      },
      "updated_at" : "2022-09-15T19:49:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1248539814",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK d575a675cc884b1bebdb6197f2ef45c51788d4a3\r\n\r\nThere are a couple `CNodeState` members that could also be annotated as guarded by `g_msgproc_mutex`, see the last couple commits here: https://github.com/dergoegge/bitcoin/commits/202209-msgproc-mutex . Feel free to cherry pick them otherwise i can also open a follow up. (Those `CNodeState` members should probably move to `Peer` aswell)",
      "created_at" : "2022-09-20T12:04:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26036#issuecomment-1252257680",
      "id" : 1252257680,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26036",
      "node_id" : "IC_kwDOABII585Ko--Q",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1252257680/reactions"
      },
      "updated_at" : "2022-09-20T12:04:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1252257680",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
         "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dergoegge/followers",
         "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dergoegge",
         "id" : 8077169,
         "login" : "dergoegge",
         "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
         "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
         "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
         "repos_url" : "https://api.github.com/users/dergoegge/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dergoegge"
      }
   }
]
