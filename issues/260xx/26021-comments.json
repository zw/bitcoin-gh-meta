[
   {
      "author_association" : "MEMBER",
      "body" : "This also happens when loading a wallet containing a miniscript descriptor.\r\n\r\nCatching the error is good, though I still wonder if we should use a flag or something like that to prevent loading future descriptor types.\r\n\r\nhttps://github.com/bitcoin/bitcoin/pull/24148#issuecomment-1189415605",
      "created_at" : "2022-09-06T13:57:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#issuecomment-1238190137",
      "id" : 1238190137,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26021",
      "node_id" : "IC_kwDOABII585JzUg5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1238190137/reactions"
      },
      "updated_at" : "2022-09-06T13:57:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1238190137",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> This also happens when loading a wallet containing a miniscript descriptor.\r\n> \r\n> Catching the error is good, though I still wonder if we should use a flag or something like that to prevent loading future descriptor types.\r\n> \r\n> [#24148 (comment)](https://github.com/bitcoin/bitcoin/pull/24148#issuecomment-1189415605)\r\n\r\nHmm, if you load unrecognized descriptor types, the parsing process should always fail with the current flow. It's not different to parsing corrupted data.\r\n\r\nWill add test coverage for both scenarios and expand the returned error mentioning the last soft version that opened the wallet if it is newer than the current one.\r\n\r\n-----------------------------------------\r\n\r\nA new feature that could be handy for users is \"partial wallet loads\" (or \"force wallet loads\"), meaning that previous soft versions will be able to load every wallet (until where they can), without loading the unrecognized descriptors/data. Where, implementation wise, could be a startup flag that tells the wallet to skip all the entries related to any unrecognized descriptor instead of aborting right away.\r\n\r\nSo, end result would look like this:\r\n\r\n1. If the descriptor parse fails for any reason: the app will, by default, abort and notify the user about the unrecognized descriptor; mentioning the wallet version if it was created/opened by a newer software version before or, if not, just saying that the file is corrupt.\r\n\r\n2. In case of the user wanting to partially/force load wallets with all the information that can be parsed: The user will add a startup flag \"-partial-wallet-load=true\" (or something like that). So he/she is aware of the behavior as it can/will only be able to see a partial view of the owned/watched transactions.\r\n\r\nWhat do you think?",
      "created_at" : "2022-09-06T14:53:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#issuecomment-1238264817",
      "id" : 1238264817,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26021",
      "node_id" : "IC_kwDOABII585Jzmvx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1238264817/reactions"
      },
      "updated_at" : "2022-09-06T14:59:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1238264817",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I would add an argument to the `loadwallet` RPC instead, but that's more of a followup thing.",
      "created_at" : "2022-09-06T15:46:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#issuecomment-1238332201",
      "id" : 1238332201,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26021",
      "node_id" : "IC_kwDOABII585Jz3Mp",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1238332201/reactions"
      },
      "updated_at" : "2022-09-06T15:46:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1238332201",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r963887520"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/963887520"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 8c52bbe5923cb3d78bfd37e429d85b9727cf2dae \"wallet: bugfix, load wallet with an unknown descriptor cause fatal error\"\r\n\r\nI think this should mention that the descriptor is either unknown or corrupt as this will occur for unknown future descriptors. I think it is far more likely that a user downgrades and runs into this error than actually has data corruption in the wallet file.\r\n\r\nAlso, I think it would be better to added a `DBErrors::UNKNOWN_DESCRIPTOR` so that the real error gets propagated to the user interface rather than directing them to find the log file.",
      "commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "created_at" : "2022-09-06T15:54:56Z",
      "diff_hunk" : "@@ -832,6 +839,9 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n                     // Set tx_corrupt back to false so that the error is only printed once (per corrupt tx)\n                     wss.tx_corrupt = false;\n                     result = DBErrors::CORRUPT;\n+                } else if (wss.descriptor_corrupt) {\n+                    pwallet->WalletLogPrintf(\"Error: Corrupt wallet descriptor found in wallet %s. This can be fixed by removing wallet from the settings so it's not loaded at startup.\\n\", pwallet->GetName());\n+                    return DBErrors::CORRUPT;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r963887520",
      "id" : 963887520,
      "line" : 844,
      "node_id" : "PRRC_kwDOABII5845c8Gg",
      "original_commit_id" : "8c52bbe5923cb3d78bfd37e429d85b9727cf2dae",
      "original_line" : 844,
      "original_position" : 29,
      "original_start_line" : 842,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 29,
      "pull_request_review_id" : 1097862418,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/963887520/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 842,
      "start_side" : "RIGHT",
      "updated_at" : "2022-09-06T15:55:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/963887520",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "When attempting to load a wallet with an unknown descriptor via the GUI, there is a segfault. This does not occur when using the `loadwallet` RPC.\r\n\r\nBacktrace:\r\n```\r\nThread 107 \"b-qt-walletctrl\" received signal SIGSEGV, Segmentation fault.\r\n[Switching to Thread 0x7ffe1effd6c0 (LWP 2463919)]\r\n0x00005555556f1b26 in WalletModel::WalletModel (this=0x7ffe0c003d00, wallet=std::unique_ptr<interfaces::Wallet> = {...}, client_model=..., platformStyle=0x5555571f8180, parent=0x0) at qt/walletmodel.cpp:55\r\n55\t   fHaveWatchOnly = m_wallet->haveWatchOnly();\r\n(gdb) bt\r\n#0  0x00005555556f1b26 in WalletModel::WalletModel (this=0x7ffe0c003d00, wallet=std::unique_ptr<interfaces::Wallet> = {...}, client_model=..., platformStyle=0x5555571f8180, \r\n    parent=0x0) at qt/walletmodel.cpp:55\r\n#1  0x00005555556bd84a in WalletController::getOrCreateWallet (this=0x555557a6bd60, wallet=std::unique_ptr<interfaces::Wallet> = {...}) at qt/walletcontroller.cpp:130\r\n#2  0x00005555556bf8c2 in operator() (__closure=0x555557b18980) at qt/walletcontroller.cpp:357\r\n#3  0x00005555556c464e in QtPrivate::FunctorCall<QtPrivate::IndexesList<>, QtPrivate::List<>, void, OpenWalletActivity::open(const std::string&)::<lambda()> >::call(struct {...} &, void **) (f=..., arg=0x55555791cd68) at /usr/include/qt/QtCore/qobjectdefs_impl.h:146\r\n#4  0x00005555556c4265 in QtPrivate::Functor<OpenWalletActivity::open(const std::string&)::<lambda()>, 0>::call<QtPrivate::List<>, void>(struct {...} &, void *, void **) (\r\n    f=..., arg=0x55555791cd68) at /usr/include/qt/QtCore/qobjectdefs_impl.h:256\r\n#5  0x00005555556c3b3a in QtPrivate::QFunctorSlotObject<OpenWalletActivity::open(const std::string&)::<lambda()>, 0, QtPrivate::List<>, void>::impl(int, QtPrivate::QSlotObjectBase *, QObject *, void **, bool *) (which=1, this_=0x555557b18970, r=0x555557a86050, a=0x55555791cd68, ret=0x0) at /usr/include/qt/QtCore/qobjectdefs_impl.h:443\r\n#6  0x00007ffff7ab12f0 in QObject::event(QEvent*) () from /usr/lib/libQt5Core.so.5\r\n#7  0x00007ffff7178b3c in QApplicationPrivate::notify_helper(QObject*, QEvent*) () from /usr/lib/libQt5Widgets.so.5\r\n#8  0x00007ffff7a8d978 in QCoreApplication::notifyInternal2(QObject*, QEvent*) () from /usr/lib/libQt5Core.so.5\r\n#9  0x00007ffff7a8e483 in QCoreApplicationPrivate::sendPostedEvents(QObject*, int, QThreadData*) () from /usr/lib/libQt5Core.so.5\r\n#10 0x00007ffff7ad4478 in ?? () from /usr/lib/libQt5Core.so.5\r\n#11 0x00007ffff546fc6b in g_main_context_dispatch () from /usr/lib/libglib-2.0.so.0\r\n#12 0x00007ffff54c6001 in ?? () from /usr/lib/libglib-2.0.so.0\r\n#13 0x00007ffff546d392 in g_main_context_iteration () from /usr/lib/libglib-2.0.so.0\r\n#14 0x00007ffff7ad825c in QEventDispatcherGlib::processEvents(QFlags<QEventLoop::ProcessEventsFlag>) () from /usr/lib/libQt5Core.so.5\r\n#15 0x00007ffff7a8611c in QEventLoop::exec(QFlags<QEventLoop::ProcessEventsFlag>) () from /usr/lib/libQt5Core.so.5\r\n#16 0x00007ffff78e74bf in QThread::exec() () from /usr/lib/libQt5Core.so.5\r\n#17 0x00007ffff78e42ea in ?? () from /usr/lib/libQt5Core.so.5\r\n#18 0x00007ffff61b778d in ?? () from /usr/lib/libc.so.6\r\n#19 0x00007ffff62388e4 in clone () from /usr/lib/libc.so.6\r\n```",
      "created_at" : "2022-09-06T16:50:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#issuecomment-1238408933",
      "id" : 1238408933,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26021",
      "node_id" : "IC_kwDOABII585J0J7l",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1238408933/reactions"
      },
      "updated_at" : "2022-09-06T16:50:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1238408933",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@furszy I think a \"partial wallet load\" would be a footgun and shouldn't be supported.",
      "created_at" : "2022-09-06T18:54:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#issuecomment-1238532938",
      "id" : 1238532938,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26021",
      "node_id" : "IC_kwDOABII585J0oNK",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1238532938/reactions"
      },
      "updated_at" : "2022-09-06T18:54:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1238532938",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> When attempting to load a wallet with an unknown descriptor via the GUI, there is a segfault. This does not occur when using the loadwallet RPC.\r\n\r\nSame cause as #26005, \"bug 2\". `util::Result` treats the wallet nullptr as the result obj.\r\nIt's solved there.",
      "created_at" : "2022-09-06T18:58:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#issuecomment-1238536327",
      "id" : 1238536327,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26021",
      "node_id" : "IC_kwDOABII585J0pCH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1238536327/reactions"
      },
      "updated_at" : "2022-09-06T18:58:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1238536327",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964067188"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964067188"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`DBErrors::TOO_NEW` might be a good fit here",
      "commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "created_at" : "2022-09-06T18:59:02Z",
      "diff_hunk" : "@@ -832,6 +839,9 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n                     // Set tx_corrupt back to false so that the error is only printed once (per corrupt tx)\n                     wss.tx_corrupt = false;\n                     result = DBErrors::CORRUPT;\n+                } else if (wss.descriptor_corrupt) {\n+                    pwallet->WalletLogPrintf(\"Error: Corrupt wallet descriptor found in wallet %s. This can be fixed by removing wallet from the settings so it's not loaded at startup.\\n\", pwallet->GetName());\n+                    return DBErrors::CORRUPT;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964067188",
      "id" : 964067188,
      "in_reply_to_id" : 963887520,
      "line" : 844,
      "node_id" : "PRRC_kwDOABII5845dn90",
      "original_commit_id" : "8c52bbe5923cb3d78bfd37e429d85b9727cf2dae",
      "original_line" : 844,
      "original_position" : 29,
      "original_start_line" : 842,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 29,
      "pull_request_review_id" : 1098105703,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964067188/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 842,
      "start_side" : "RIGHT",
      "updated_at" : "2022-09-06T18:59:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964067188",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964068016"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964068016"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is way too complicated for a typical user.",
      "commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "created_at" : "2022-09-06T19:00:06Z",
      "diff_hunk" : "@@ -832,6 +839,9 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n                     // Set tx_corrupt back to false so that the error is only printed once (per corrupt tx)\n                     wss.tx_corrupt = false;\n                     result = DBErrors::CORRUPT;\n+                } else if (wss.descriptor_corrupt) {\n+                    pwallet->WalletLogPrintf(\"Error: Corrupt wallet descriptor found in wallet %s. This can be fixed by removing wallet from the settings so it's not loaded at startup.\\n\", pwallet->GetName());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964068016",
      "id" : 964068016,
      "line" : 843,
      "node_id" : "PRRC_kwDOABII5845doKw",
      "original_commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "original_line" : 843,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 28,
      "pull_request_review_id" : 1098106897,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964068016/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-06T19:00:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964068016",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964068324"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964068324"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Probably should export message via `strErr`",
      "commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "created_at" : "2022-09-06T19:00:30Z",
      "diff_hunk" : "@@ -832,6 +839,9 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n                     // Set tx_corrupt back to false so that the error is only printed once (per corrupt tx)\n                     wss.tx_corrupt = false;\n                     result = DBErrors::CORRUPT;\n+                } else if (wss.descriptor_corrupt) {\n+                    pwallet->WalletLogPrintf(\"Error: Corrupt wallet descriptor found in wallet %s. This can be fixed by removing wallet from the settings so it's not loaded at startup.\\n\", pwallet->GetName());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964068324",
      "id" : 964068324,
      "line" : 843,
      "node_id" : "PRRC_kwDOABII5845doPk",
      "original_commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "original_line" : 843,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 28,
      "pull_request_review_id" : 1098107332,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964068324/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-06T19:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964068324",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964069291"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964069291"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "sounds good. Pushed.",
      "commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "created_at" : "2022-09-06T19:01:45Z",
      "diff_hunk" : "@@ -832,6 +839,9 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n                     // Set tx_corrupt back to false so that the error is only printed once (per corrupt tx)\n                     wss.tx_corrupt = false;\n                     result = DBErrors::CORRUPT;\n+                } else if (wss.descriptor_corrupt) {\n+                    pwallet->WalletLogPrintf(\"Error: Corrupt wallet descriptor found in wallet %s. This can be fixed by removing wallet from the settings so it's not loaded at startup.\\n\", pwallet->GetName());\n+                    return DBErrors::CORRUPT;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964069291",
      "id" : 964069291,
      "in_reply_to_id" : 963887520,
      "line" : 844,
      "node_id" : "PRRC_kwDOABII5845doer",
      "original_commit_id" : "8c52bbe5923cb3d78bfd37e429d85b9727cf2dae",
      "original_line" : 844,
      "original_position" : 29,
      "original_start_line" : 842,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 29,
      "pull_request_review_id" : 1098108651,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964069291/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 842,
      "start_side" : "RIGHT",
      "updated_at" : "2022-09-06T19:01:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964069291",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964084940"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964084940"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "yeah, briefly thought about it as well and.. by doing it, remove code duplication that comes with it.  But.. as this involves the introduction of the `util::Result` class and.. I have tendencies of wanting to change too much in single PRs was balancing on whether that should be here or not.\r\nLet me see how it will looks like.",
      "commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "created_at" : "2022-09-06T19:17:27Z",
      "diff_hunk" : "@@ -832,6 +839,9 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n                     // Set tx_corrupt back to false so that the error is only printed once (per corrupt tx)\n                     wss.tx_corrupt = false;\n                     result = DBErrors::CORRUPT;\n+                } else if (wss.descriptor_corrupt) {\n+                    pwallet->WalletLogPrintf(\"Error: Corrupt wallet descriptor found in wallet %s. This can be fixed by removing wallet from the settings so it's not loaded at startup.\\n\", pwallet->GetName());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964084940",
      "id" : 964084940,
      "in_reply_to_id" : 964068324,
      "line" : 843,
      "node_id" : "PRRC_kwDOABII5845dsTM",
      "original_commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "original_line" : 843,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 28,
      "pull_request_review_id" : 1098128760,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964084940/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-06T20:14:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964084940",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964099980"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964099980"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Are you talking about GUI users?\r\nFor them, I think that the best would be to trigger a dialog and ask if want to continue without this wallet. But, that would require a bit more work that could tackle here or in a follow-up work \r\n\r\nFor bitcoind users, as the app cannot proceed without further interaction, shouldn't be a problem for them to remove a line in the settings file. But.. another option could be to not load/open certain wallet/s, even if they are on the settings file, by providing a startup flag \"-unloadwallet=<wallet_name>\" (need to check if we have an available flag for this already or will have to create one). What do you think?\r\n\r\nNote: In both cases, I don't think that skipping certain wallet/s from loading at startup without the user interaction (nor the user knowing about it) is any better than this (would actually say that it's worst).",
      "commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "created_at" : "2022-09-06T19:37:04Z",
      "diff_hunk" : "@@ -832,6 +839,9 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n                     // Set tx_corrupt back to false so that the error is only printed once (per corrupt tx)\n                     wss.tx_corrupt = false;\n                     result = DBErrors::CORRUPT;\n+                } else if (wss.descriptor_corrupt) {\n+                    pwallet->WalletLogPrintf(\"Error: Corrupt wallet descriptor found in wallet %s. This can be fixed by removing wallet from the settings so it's not loaded at startup.\\n\", pwallet->GetName());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964099980",
      "id" : 964099980,
      "in_reply_to_id" : 964068016,
      "line" : 843,
      "node_id" : "PRRC_kwDOABII5845dv-M",
      "original_commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "original_line" : 843,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 28,
      "pull_request_review_id" : 1098150588,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964099980/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-06T19:38:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964099980",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @furszy I think a \"partial wallet load\" would be a footgun and shouldn't be supported.\r\n\r\nConceptually, it's similar to how we treat other compatibility issues. Old versions aren't aware of new stuff but are still able to run what they have (skipping / not verifying some data). While on this scenario, previous versions are simply not compatible with newer wallets.\r\n\r\nIt's a debatable topic. Might be good to continue being incompatible actually.",
      "created_at" : "2022-09-06T19:55:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#issuecomment-1238588995",
      "id" : 1238588995,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26021",
      "node_id" : "IC_kwDOABII585J015D",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1238588995/reactions"
      },
      "updated_at" : "2022-09-06T19:55:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1238588995",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> > @furszy I think a \"partial wallet load\" would be a footgun and shouldn't be supported.\r\n> \r\n> Conceptually, it's similar to how we treat other compatibility issues. Old versions aren't aware of new stuff but are still able to run what they have (skipping / not verifying some data). While on this scenario, previous versions are simply not compatible with newer wallets.\r\n> \r\n> It's a debatable topic. Might be good to continue being incompatible actually.\r\n\r\nI agree with @luke-jr, it's a footgun and we should avoid doing that. The difference is that a partial load may be missing critical information in things that it cannot understand and so may be allowing spending where it shouldn't, or failing to detect transactions when it should. There is a reason that those things return errors.\r\n\r\nWith our backwards compatibility, the newly added things are specifically designed so that they do not induce errors in older versions and are also designed such that they are not critical to operation. Furthermore, we do actually have downgrade protection to prevent loading of newer wallets if new critical data has been added.\r\n\r\nNew/unknown descriptors are part of the critical data and so must cause older software to fail to load the wallet. The decision to use descriptor parsing failures as the downgrade protection method was intentional as using more wallet flags for each new descriptor type is not scalable.",
      "created_at" : "2022-09-06T20:47:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#issuecomment-1238633356",
      "id" : 1238633356,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26021",
      "node_id" : "IC_kwDOABII585J1AuM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1238633356/reactions"
      },
      "updated_at" : "2022-09-06T20:48:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1238633356",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964173078"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964173078"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I mean both should get the error details without jumping through extra hoops",
      "commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "created_at" : "2022-09-06T21:11:18Z",
      "diff_hunk" : "@@ -832,6 +839,9 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n                     // Set tx_corrupt back to false so that the error is only printed once (per corrupt tx)\n                     wss.tx_corrupt = false;\n                     result = DBErrors::CORRUPT;\n+                } else if (wss.descriptor_corrupt) {\n+                    pwallet->WalletLogPrintf(\"Error: Corrupt wallet descriptor found in wallet %s. This can be fixed by removing wallet from the settings so it's not loaded at startup.\\n\", pwallet->GetName());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964173078",
      "id" : 964173078,
      "in_reply_to_id" : 964068016,
      "line" : 843,
      "node_id" : "PRRC_kwDOABII5845eB0W",
      "original_commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "original_line" : 843,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 28,
      "pull_request_review_id" : 1098249696,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964173078/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-06T21:11:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964173078",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964173624"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964173624"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`strErr` is already used here, it doesn't need `util::Result`",
      "commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "created_at" : "2022-09-06T21:11:47Z",
      "diff_hunk" : "@@ -832,6 +839,9 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n                     // Set tx_corrupt back to false so that the error is only printed once (per corrupt tx)\n                     wss.tx_corrupt = false;\n                     result = DBErrors::CORRUPT;\n+                } else if (wss.descriptor_corrupt) {\n+                    pwallet->WalletLogPrintf(\"Error: Corrupt wallet descriptor found in wallet %s. This can be fixed by removing wallet from the settings so it's not loaded at startup.\\n\", pwallet->GetName());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964173624",
      "id" : 964173624,
      "in_reply_to_id" : 964068324,
      "line" : 843,
      "node_id" : "PRRC_kwDOABII5845eB84",
      "original_commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "original_line" : 843,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 28,
      "pull_request_review_id" : 1098250203,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964173624/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-06T21:11:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964173624",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964186448"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964186448"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, this should just use `strErr`. Any error put there should already make it out to the user on the RPC or trigger an error dialog in the GUI. This shouldn't need any other changes.",
      "commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "created_at" : "2022-09-06T21:28:51Z",
      "diff_hunk" : "@@ -832,6 +839,9 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n                     // Set tx_corrupt back to false so that the error is only printed once (per corrupt tx)\n                     wss.tx_corrupt = false;\n                     result = DBErrors::CORRUPT;\n+                } else if (wss.descriptor_corrupt) {\n+                    pwallet->WalletLogPrintf(\"Error: Corrupt wallet descriptor found in wallet %s. This can be fixed by removing wallet from the settings so it's not loaded at startup.\\n\", pwallet->GetName());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964186448",
      "id" : 964186448,
      "in_reply_to_id" : 964068324,
      "line" : 843,
      "node_id" : "PRRC_kwDOABII5845eFFQ",
      "original_commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "original_line" : 843,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 28,
      "pull_request_review_id" : 1098266736,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964186448/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-06T21:29:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964186448",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25766](https://github.com/bitcoin/bitcoin/pull/25766) (wallet: Include a signature with encrypted keys to mitigate a wallet scam by achow101)\n* [#25722](https://github.com/bitcoin/bitcoin/pull/25722) (refactor: Use util::Result class for wallet loading by ryanofsky)\n* [#24914](https://github.com/bitcoin/bitcoin/pull/24914) (wallet: Load database records in a particular order by achow101)\n* [#24897](https://github.com/bitcoin/bitcoin/pull/24897) ([Draft / POC] Silent Payments by w0xlt)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-09-06T23:19:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#issuecomment-1238742524",
      "id" : 1238742524,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26021",
      "node_id" : "IC_kwDOABII585J1bX8",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1238742524/reactions"
      },
      "updated_at" : "2022-09-08T18:30:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1238742524",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964811357"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964811357"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`strErr` isn't propagated to the GUI nor RPC. Is internal to `WalletBatch::LoadWallet`, declared prior to call `ReadKeyValue` and only used to log the error at the end of every record read while we walk through all the db records.\r\n\r\nTo propagate the error to the upper layers need to add a ref string into the function signature (or use the result class and kill two birds with the same stone, cleaning more code in the way).\r\n\r\nIf you check the line below this logging, Im returning right away, not letting the process continue reading all the db records. The reason is that you can have a corrupted descriptor that has an active descriptor entry, which will crash the wallet once the process calls to `LoadActiveScriptPubKeyMan` (on the [map.at](http://map.at/)(id) line) as the descriptor which the active entry points was never added to the wallet.\r\n\r\nThis is something that was going to push later but essentially you can crash the wallet at startup by adding an `ACTIVEEXTERNALSPK` or `ACTIVEINTERNALSPK` record to the db that points to a random spkm id.",
      "commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "created_at" : "2022-09-07T13:00:43Z",
      "diff_hunk" : "@@ -832,6 +839,9 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n                     // Set tx_corrupt back to false so that the error is only printed once (per corrupt tx)\n                     wss.tx_corrupt = false;\n                     result = DBErrors::CORRUPT;\n+                } else if (wss.descriptor_corrupt) {\n+                    pwallet->WalletLogPrintf(\"Error: Corrupt wallet descriptor found in wallet %s. This can be fixed by removing wallet from the settings so it's not loaded at startup.\\n\", pwallet->GetName());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964811357",
      "id" : 964811357,
      "in_reply_to_id" : 964068324,
      "line" : 843,
      "node_id" : "PRRC_kwDOABII5845gdpd",
      "original_commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "original_line" : 843,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 28,
      "pull_request_review_id" : 1099130731,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964811357/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-07T13:00:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964811357",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964881204"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964881204"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "going to prepare the changes and test cases so limitations of the current sources and the diff benefits are visible. The end result will be similar to what was done in #25308.",
      "commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "created_at" : "2022-09-07T13:57:24Z",
      "diff_hunk" : "@@ -832,6 +839,9 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n                     // Set tx_corrupt back to false so that the error is only printed once (per corrupt tx)\n                     wss.tx_corrupt = false;\n                     result = DBErrors::CORRUPT;\n+                } else if (wss.descriptor_corrupt) {\n+                    pwallet->WalletLogPrintf(\"Error: Corrupt wallet descriptor found in wallet %s. This can be fixed by removing wallet from the settings so it's not loaded at startup.\\n\", pwallet->GetName());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964881204",
      "id" : 964881204,
      "in_reply_to_id" : 964068324,
      "line" : 843,
      "node_id" : "PRRC_kwDOABII5845gus0",
      "original_commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "original_line" : 843,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 28,
      "pull_request_review_id" : 1099231402,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964881204/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-07T13:57:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964881204",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964912836"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964912836"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't think it is correct to say `Downgrading is incompatible with descriptor wallets`. Not all downgrading is incompatible, just this particular one with new descriptors. I think you should just leave that sentence out.\r\n\r\nSame down below.",
      "commit_id" : "e6d4425ac2b15f2a2f4ee18753f4fe5528932d70",
      "created_at" : "2022-09-07T14:24:14Z",
      "diff_hunk" : "@@ -2819,8 +2819,12 @@ std::shared_ptr<CWallet> CWallet::Create(WalletContext& context, const std::stri\n             warnings.push_back(strprintf(_(\"Error reading %s! Transaction data may be missing or incorrect.\"\n                                            \" Rescanning wallet.\"), walletFile));\n             rescan_required = true;\n-        }\n-        else {\n+        } else if (nLoadWalletRet == DBErrors::UNKNOWN_DESCRIPTOR) {\n+            error = strprintf(_(\"Error loading %s: Unrecognized descriptor found.\\n\\n\"\n+                                \"The wallet might had been created on a newer version. Downgrading is incompatible with descriptor wallets\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964912836",
      "id" : 964912836,
      "line" : 2824,
      "node_id" : "PRRC_kwDOABII5845g2bE",
      "original_commit_id" : "e6d4425ac2b15f2a2f4ee18753f4fe5528932d70",
      "original_line" : 2824,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 8,
      "pull_request_review_id" : 1099278190,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964912836/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-07T14:24:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964912836",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964918160"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964918160"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Extra note: checked how the util::result connection would look like and changes aren't straightforward to do. It needs further code reorganizations as `DBErrors` enum mixes errors, warnings and the good result (I think that the best would be to decouple this enum into two enums errors and warnings or.. even get rid of the enum completely like it was done in #25308. but.. will leave that for another PR).\r\n\r\nSo, options:\r\n\r\n1) Move forward by adding the ref string arg here. The same error string will be propagated to the upper layers, removing one line of code duplication but having to add the std::string ref arg in all the `WalletBatch::LoadWallet` calls (which we do have a good number of them).\r\n\r\n2) Leave it as is now, which essentially means to act the same as with all the corrupted wallet errors: having the string duplicated inside `WalletBatch::LoadWallet` and its caller `CWallet::Create` (`wallet.cpp`). And implement the proper changes all at once in a follow-up PR.\r\n\r\nPersonally, I'm inclined to go with option (2) as it's inlined with what we currently have and doesn't introduce changes that will most likely be removed later.\r\nThoughts?",
      "commit_id" : "b574285652aa7ae146066d54d219b465c49f618b",
      "created_at" : "2022-09-07T14:28:29Z",
      "diff_hunk" : "@@ -832,6 +839,9 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n                     // Set tx_corrupt back to false so that the error is only printed once (per corrupt tx)\n                     wss.tx_corrupt = false;\n                     result = DBErrors::CORRUPT;\n+                } else if (wss.descriptor_corrupt) {\n+                    pwallet->WalletLogPrintf(\"Error: Corrupt wallet descriptor found in wallet %s. This can be fixed by removing wallet from the settings so it's not loaded at startup.\\n\", pwallet->GetName());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964918160",
      "id" : 964918160,
      "in_reply_to_id" : 964068324,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5845g3uQ",
      "original_commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "original_line" : 843,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : null,
      "pull_request_review_id" : 1099285922,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964918160/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-07T16:43:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964918160",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964999291"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964999291"
         }
      },
      "author_association" : "MEMBER",
      "body" : "For a bugfix for this release, we should just do the minimum to get a message out to the user. We can do more granulated error message propagation in follow-ups.",
      "commit_id" : "e6d4425ac2b15f2a2f4ee18753f4fe5528932d70",
      "created_at" : "2022-09-07T15:34:16Z",
      "diff_hunk" : "@@ -832,6 +839,9 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n                     // Set tx_corrupt back to false so that the error is only printed once (per corrupt tx)\n                     wss.tx_corrupt = false;\n                     result = DBErrors::CORRUPT;\n+                } else if (wss.descriptor_corrupt) {\n+                    pwallet->WalletLogPrintf(\"Error: Corrupt wallet descriptor found in wallet %s. This can be fixed by removing wallet from the settings so it's not loaded at startup.\\n\", pwallet->GetName());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r964999291",
      "id" : 964999291,
      "in_reply_to_id" : 964068324,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5845hLh7",
      "original_commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "original_line" : 843,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : null,
      "pull_request_review_id" : 1099406955,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964999291/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-07T15:34:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/964999291",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r965072612"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/965072612"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I wrote it in that way because at this point of the flow we already tried to parse the descriptor and failed, knowing for sure that either the downgrade is incompatible or the db is corrupted.\r\nBut sure, will remove the line.",
      "commit_id" : "b574285652aa7ae146066d54d219b465c49f618b",
      "created_at" : "2022-09-07T16:46:24Z",
      "diff_hunk" : "@@ -2819,8 +2819,12 @@ std::shared_ptr<CWallet> CWallet::Create(WalletContext& context, const std::stri\n             warnings.push_back(strprintf(_(\"Error reading %s! Transaction data may be missing or incorrect.\"\n                                            \" Rescanning wallet.\"), walletFile));\n             rescan_required = true;\n-        }\n-        else {\n+        } else if (nLoadWalletRet == DBErrors::UNKNOWN_DESCRIPTOR) {\n+            error = strprintf(_(\"Error loading %s: Unrecognized descriptor found.\\n\\n\"\n+                                \"The wallet might had been created on a newer version. Downgrading is incompatible with descriptor wallets\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r965072612",
      "id" : 965072612,
      "in_reply_to_id" : 964912836,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5845hdbk",
      "original_commit_id" : "e6d4425ac2b15f2a2f4ee18753f4fe5528932d70",
      "original_line" : 2824,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 1099511346,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/965072612/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-07T16:46:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/965072612",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r965082536"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/965082536"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "sounds good, let's continue with option 2 then.",
      "commit_id" : "b574285652aa7ae146066d54d219b465c49f618b",
      "created_at" : "2022-09-07T16:57:48Z",
      "diff_hunk" : "@@ -832,6 +839,9 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n                     // Set tx_corrupt back to false so that the error is only printed once (per corrupt tx)\n                     wss.tx_corrupt = false;\n                     result = DBErrors::CORRUPT;\n+                } else if (wss.descriptor_corrupt) {\n+                    pwallet->WalletLogPrintf(\"Error: Corrupt wallet descriptor found in wallet %s. This can be fixed by removing wallet from the settings so it's not loaded at startup.\\n\", pwallet->GetName());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r965082536",
      "id" : 965082536,
      "in_reply_to_id" : 964068324,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5845hf2o",
      "original_commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "original_line" : 843,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : null,
      "pull_request_review_id" : 1099525223,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/965082536/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-07T16:57:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/965082536",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r965104146"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/965104146"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed a different text version.\r\n\r\nAt this point of the code we don't have much information aside from the \"unknown wallet descriptor found\" (at least for now, will work on it on a follow-up PR). We just know that a certain descriptor parse failed. Thus why added the extra information at the end, to provide the user a workaround if still want to run other wallets (just need to unload the failing one).\r\n\r\nBut.. for the sake of simplicity, removed the extra information as well. Let me know what you think.\r\n\r\nBetter to work on the GUI \"unload wallet confirmation dialog\" and the \"unload wallet\" startup flag on a different PR so this bugfix can get merged for this release.",
      "commit_id" : "b574285652aa7ae146066d54d219b465c49f618b",
      "created_at" : "2022-09-07T17:23:48Z",
      "diff_hunk" : "@@ -832,6 +839,9 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n                     // Set tx_corrupt back to false so that the error is only printed once (per corrupt tx)\n                     wss.tx_corrupt = false;\n                     result = DBErrors::CORRUPT;\n+                } else if (wss.descriptor_corrupt) {\n+                    pwallet->WalletLogPrintf(\"Error: Corrupt wallet descriptor found in wallet %s. This can be fixed by removing wallet from the settings so it's not loaded at startup.\\n\", pwallet->GetName());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r965104146",
      "id" : 965104146,
      "in_reply_to_id" : 964068016,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5845hlIS",
      "original_commit_id" : "f59489cb7be71b9e8125c23ce265e8f88582b787",
      "original_line" : 843,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : null,
      "pull_request_review_id" : 1099557465,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/965104146/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-07T17:23:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/965104146",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for the review, feedback tackled.\r\n\r\nPlus, for the sake of completeness, added test coverage for it as well.\r\nCan run 17036782 without the fix commit and the test will crash.",
      "created_at" : "2022-09-07T20:27:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#issuecomment-1239837009",
      "id" : 1239837009,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26021",
      "node_id" : "IC_kwDOABII585J5mlR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1239837009/reactions"
      },
      "updated_at" : "2022-09-07T20:27:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1239837009",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r965437063"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/965437063"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Missing `strprintf` for the `%s` here.\r\n\r\nAlso I think we should avoid having `\\n`s here, makes the log look weird. If you want to have multiline, then each of these needs to be `WalletLogPrintf`'d separately.",
      "commit_id" : "170367828cff859d0b91c214c17b169512e14da8",
      "created_at" : "2022-09-08T02:05:18Z",
      "diff_hunk" : "@@ -832,6 +845,16 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n                     // Set tx_corrupt back to false so that the error is only printed once (per corrupt tx)\n                     wss.tx_corrupt = false;\n                     result = DBErrors::CORRUPT;\n+                } else if (wss.descriptor_unknown) {\n+                    strErr = \"Error: Unrecognized descriptor found in wallet %s\\n\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r965437063",
      "id" : 965437063,
      "line" : 849,
      "node_id" : "PRRC_kwDOABII5845i2aH",
      "original_commit_id" : "645fd6d3b14634e8cb667aa1d8eda8a4c8c7a60d",
      "original_line" : 849,
      "original_position" : 41,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 41,
      "pull_request_review_id" : 1100004064,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/965437063/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-08T02:06:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/965437063",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r965871076"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/965871076"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "thx pushed.\r\n\r\n> Also I think we should avoid having \\ns here, makes the log look weird. If you want to have multiline, then each of these needs to be WalletLogPrintf'd separately.\r\n\r\npushed as well, it was a remanent of the error propagation work.\r\n\r\nNote: same as happen with the other db load errors, we log the messages twice in some flows (e.g. loading an unrecognized descriptor at startup). The text that is formatted with multiline for the GUI (the one inside `CWallet::Create`) will be logged right after the `WalletBatch::LoadWallet` logging. This is due the `ThreadSafeMessageBox` slot that logs the string if it's marked \"insecure\" as well.\r\nWill keep the plan and tackle this in a follow-up PR.",
      "commit_id" : "6cbe5bdefe52753acf60419102766e8bd94b08c5",
      "created_at" : "2022-09-08T12:06:02Z",
      "diff_hunk" : "@@ -832,6 +845,16 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n                     // Set tx_corrupt back to false so that the error is only printed once (per corrupt tx)\n                     wss.tx_corrupt = false;\n                     result = DBErrors::CORRUPT;\n+                } else if (wss.descriptor_unknown) {\n+                    strErr = \"Error: Unrecognized descriptor found in wallet %s\\n\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r965871076",
      "id" : 965871076,
      "in_reply_to_id" : 965437063,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5845kgXk",
      "original_commit_id" : "645fd6d3b14634e8cb667aa1d8eda8a4c8c7a60d",
      "original_line" : 849,
      "original_position" : 41,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : null,
      "pull_request_review_id" : 1100624057,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/965871076/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-08T12:06:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/965871076",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r966221396"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/966221396"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Needs a space before or after each sentence. Otherwise they run together.",
      "commit_id" : "6cbe5bdefe52753acf60419102766e8bd94b08c5",
      "created_at" : "2022-09-08T17:14:58Z",
      "diff_hunk" : "@@ -832,6 +845,13 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n                     // Set tx_corrupt back to false so that the error is only printed once (per corrupt tx)\n                     wss.tx_corrupt = false;\n                     result = DBErrors::CORRUPT;\n+                } else if (wss.descriptor_unknown) {\n+                    strErr = strprintf(\"Error: Unrecognized descriptor found in wallet %s.\", pwallet->GetName());\n+                    strErr += (last_client > CLIENT_VERSION) ? \"The wallet might had been created on a newer version.\" :\n+                            \"The database might be corrupted or the software version is not compatible with one of your wallet descriptors.\";\n+                    strErr += \"Please try running the latest software version\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r966221396",
      "id" : 966221396,
      "line" : 852,
      "node_id" : "PRRC_kwDOABII5845l15U",
      "original_commit_id" : "ca30759b90937f50ae0dbc1b8cdd68a3e1451b3c",
      "original_line" : 852,
      "original_position" : 44,
      "original_start_line" : 849,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 44,
      "pull_request_review_id" : 1101116477,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/966221396/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 849,
      "start_side" : "RIGHT",
      "updated_at" : "2022-09-08T17:14:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/966221396",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r966297196"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/966297196"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "pushed",
      "commit_id" : "a76f9b263fe0bac5cbd69b6a78869835f9b66dd2",
      "created_at" : "2022-09-08T18:33:45Z",
      "diff_hunk" : "@@ -832,6 +845,13 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n                     // Set tx_corrupt back to false so that the error is only printed once (per corrupt tx)\n                     wss.tx_corrupt = false;\n                     result = DBErrors::CORRUPT;\n+                } else if (wss.descriptor_unknown) {\n+                    strErr = strprintf(\"Error: Unrecognized descriptor found in wallet %s.\", pwallet->GetName());\n+                    strErr += (last_client > CLIENT_VERSION) ? \"The wallet might had been created on a newer version.\" :\n+                            \"The database might be corrupted or the software version is not compatible with one of your wallet descriptors.\";\n+                    strErr += \"Please try running the latest software version\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#discussion_r966297196",
      "id" : 966297196,
      "in_reply_to_id" : 966221396,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5845mIZs",
      "original_commit_id" : "ca30759b90937f50ae0dbc1b8cdd68a3e1451b3c",
      "original_line" : 852,
      "original_position" : 44,
      "original_start_line" : 849,
      "path" : "src/wallet/walletdb.cpp",
      "position" : null,
      "pull_request_review_id" : 1101230458,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26021",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/966297196/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2022-09-08T18:33:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/966297196",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "tACK a76f9b2\r\n\r\n@achow101 wrote:\r\n\r\n> When attempting to load a wallet with an unknown descriptor via the GUI, there is a segfault. This does not occur when using the `loadwallet` RPC.\r\n\r\nThis happens to me as well. That's not new in this PR though, running without this PR:\r\n\r\n`2022-09-09T13:52:07Z [qt-walletctrl] GUI: Qt has caught an exception thrown from an event handler. Throwing ...`\r\n\r\ncc @hebasto \r\n\r\nDon't forget to update the PR description.\r\n\r\nI also suggest moving this comment out of the commit and into the PR description (since there's no guarantee such \"follow-up commits\" get merged):\r\n\r\n```\r\nNote: added the test in a separate file intentionally.\r\nWill continue adding coverage for the wallet load\r\nprocess in follow-up commits.\r\n```\r\n\r\nYou could also drop `### Issue Explanation` from the first commit message.",
      "created_at" : "2022-09-09T13:49:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26021#issuecomment-1241999310",
      "id" : 1241999310,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26021",
      "node_id" : "IC_kwDOABII585KB2fO",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1241999310/reactions"
      },
      "updated_at" : "2022-09-09T13:53:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1241999310",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   }
]
