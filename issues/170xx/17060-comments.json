[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#15606](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15606.html) ([experimental] UTXO snapshots by jamesob)\n* [#9384](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/9384.html) (CCoinsViewCache code cleanup & deduplication by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-10-05T11:54:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-538643385",
      "id" : 538643385,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzODY0MzM4NQ==",
      "updated_at" : "2019-11-09T03:27:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/538643385",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Would be nice to test this on a Raspberry-like device. They tend to have low memory and slow storage. Unfortunately they generally also require pruning, and the way pruning currently works we flush the coin cache.\r\n\r\nFor example I have an Orange Pi chipping away at IBD this week; although it has 2 GB of RAM, because I'm pruning it to 5 GB, it never uses more than 230 MB.",
      "created_at" : "2019-10-06T13:51:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-538749228",
      "id" : 538749228,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzODc0OTIyOA==",
      "updated_at" : "2019-10-06T13:51:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/538749228",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> For example I have an Orange Pi chipping away at IBD this week; although it has 2 GB of RAM, because I'm pruning it to 5 GB, it never uses more than 230 MB.\r\n\r\nA 512 GB micro SD card should do the job, no?",
      "created_at" : "2019-10-07T17:05:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-539110266",
      "id" : 539110266,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzOTExMDI2Ng==",
      "updated_at" : "2019-10-07T17:05:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/539110266",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@TheBlueMatt You might be interested here given you commented in #16970.",
      "created_at" : "2019-10-08T15:38:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-539573426",
      "id" : 539573426,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzOTU3MzQyNg==",
      "updated_at" : "2019-10-08T15:39:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/539573426",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17060#discussion_r332743152"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17060"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/332743152"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should be \"regardless\" :)",
      "commit_id" : "03cb535384eb6d2f4284524c33ab03371bd263e2",
      "created_at" : "2019-10-08T21:31:26Z",
      "diff_hunk" : "@@ -127,13 +127,72 @@ class CTxIn\n     std::string ToString() const;\n };\n \n+\n+/**\n+ * CAmount is an int64_t, which requires alignment of 8. This wrapper stores the data\n+ * in a memory array and packs/unpacks it whenever needed, regarldess of alignment.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#discussion_r332743152",
      "id" : 332743152,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzMjc0MzE1Mg==",
      "original_commit_id" : "d69050ecec1848a4e8521b3b4d84d7ba0f18ef14",
      "original_position" : 7,
      "path" : "src/primitives/transaction.h",
      "position" : null,
      "pull_request_review_id" : 299062515,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17060",
      "updated_at" : "2019-10-09T14:45:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/332743152",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17060#discussion_r332743291"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17060"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/332743291"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should be `explicit`? :)",
      "commit_id" : "03cb535384eb6d2f4284524c33ab03371bd263e2",
      "created_at" : "2019-10-08T21:31:51Z",
      "diff_hunk" : "@@ -127,13 +127,72 @@ class CTxIn\n     std::string ToString() const;\n };\n \n+\n+/**\n+ * CAmount is an int64_t, which requires alignment of 8. This wrapper stores the data\n+ * in a memory array and packs/unpacks it whenever needed, regarldess of alignment.\n+ *\n+ * Since CAmount's size is know, the compiler should be able to optimize the std::memcpy away\n+ * in most cases.\n+ */\n+class PackableCAmount\n+{\n+    uint8_t m_data[sizeof(CAmount)];\n+\n+public:\n+    PackableCAmount(CAmount val) noexcept",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#discussion_r332743291",
      "id" : 332743291,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzMjc0MzI5MQ==",
      "original_commit_id" : "d69050ecec1848a4e8521b3b4d84d7ba0f18ef14",
      "original_position" : 17,
      "path" : "src/primitives/transaction.h",
      "position" : null,
      "pull_request_review_id" : 299062685,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17060",
      "updated_at" : "2019-10-09T14:45:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/332743291",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> A 512 GB micro SD card should do the job, no?\r\n\r\nYep, works fine.",
      "created_at" : "2019-10-09T10:03:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-539932847",
      "id" : 539932847,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzOTkzMjg0Nw==",
      "updated_at" : "2019-10-09T10:03:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/539932847",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17060#discussion_r333029200"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17060"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/333029200"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Should be \"known\".\r\n... And, uh, is that \"away\" or \"anyway\"?",
      "commit_id" : "03cb535384eb6d2f4284524c33ab03371bd263e2",
      "created_at" : "2019-10-09T13:59:16Z",
      "diff_hunk" : "@@ -127,13 +127,72 @@ class CTxIn\n     std::string ToString() const;\n };\n \n+\n+/**\n+ * CAmount is an int64_t, which requires alignment of 8. This wrapper stores the data\n+ * in a memory array and packs/unpacks it whenever needed, regarldess of alignment.\n+ *\n+ * Since CAmount's size is know, the compiler should be able to optimize the std::memcpy away",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#discussion_r333029200",
      "id" : 333029200,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzMzAyOTIwMA==",
      "original_commit_id" : "d69050ecec1848a4e8521b3b4d84d7ba0f18ef14",
      "original_position" : 9,
      "path" : "src/primitives/transaction.h",
      "position" : null,
      "pull_request_review_id" : 299432268,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17060",
      "updated_at" : "2019-10-09T14:45:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/333029200",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/42591821?v=4",
         "events_url" : "https://api.github.com/users/GChuf/events{/privacy}",
         "followers_url" : "https://api.github.com/users/GChuf/followers",
         "following_url" : "https://api.github.com/users/GChuf/following{/other_user}",
         "gists_url" : "https://api.github.com/users/GChuf/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/GChuf",
         "id" : 42591821,
         "login" : "GChuf",
         "node_id" : "MDQ6VXNlcjQyNTkxODIx",
         "organizations_url" : "https://api.github.com/users/GChuf/orgs",
         "received_events_url" : "https://api.github.com/users/GChuf/received_events",
         "repos_url" : "https://api.github.com/users/GChuf/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/GChuf/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/GChuf/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/GChuf"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Please lets keep the discussion high level before pointing out any typos.",
      "created_at" : "2019-10-09T14:03:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-540015565",
      "id" : 540015565,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MDAxNTU2NQ==",
      "updated_at" : "2019-10-09T14:03:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/540015565",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17060#discussion_r333051913"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17060"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/333051913"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It should, I can add that easily by adding the assignment operator for CAmount. \r\n\r\nAlso theoretically the `operator CAmount()` should be explicit too, but changing that would mean that I'd have to change practically all usages of this class...",
      "commit_id" : "03cb535384eb6d2f4284524c33ab03371bd263e2",
      "created_at" : "2019-10-09T14:37:38Z",
      "diff_hunk" : "@@ -127,13 +127,72 @@ class CTxIn\n     std::string ToString() const;\n };\n \n+\n+/**\n+ * CAmount is an int64_t, which requires alignment of 8. This wrapper stores the data\n+ * in a memory array and packs/unpacks it whenever needed, regarldess of alignment.\n+ *\n+ * Since CAmount's size is know, the compiler should be able to optimize the std::memcpy away\n+ * in most cases.\n+ */\n+class PackableCAmount\n+{\n+    uint8_t m_data[sizeof(CAmount)];\n+\n+public:\n+    PackableCAmount(CAmount val) noexcept",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#discussion_r333051913",
      "id" : 333051913,
      "in_reply_to_id" : 332743291,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzMzA1MTkxMw==",
      "original_commit_id" : "d69050ecec1848a4e8521b3b4d84d7ba0f18ef14",
      "original_position" : 17,
      "path" : "src/primitives/transaction.h",
      "position" : null,
      "pull_request_review_id" : 299462128,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17060",
      "updated_at" : "2019-10-09T14:45:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/333051913",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17060#discussion_r333060751"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17060"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/333060751"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "fixed in 03cb535384eb6d2f4284524c33ab03371bd263e2, also it should be \"optimized away\" because the compiler can the function call away. See this: https://godbolt.org/z/6uP9_S",
      "commit_id" : "03cb535384eb6d2f4284524c33ab03371bd263e2",
      "created_at" : "2019-10-09T14:52:32Z",
      "diff_hunk" : "@@ -127,13 +127,72 @@ class CTxIn\n     std::string ToString() const;\n };\n \n+\n+/**\n+ * CAmount is an int64_t, which requires alignment of 8. This wrapper stores the data\n+ * in a memory array and packs/unpacks it whenever needed, regarldess of alignment.\n+ *\n+ * Since CAmount's size is know, the compiler should be able to optimize the std::memcpy away",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#discussion_r333060751",
      "id" : 333060751,
      "in_reply_to_id" : 333029200,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzMzA2MDc1MQ==",
      "original_commit_id" : "d69050ecec1848a4e8521b3b4d84d7ba0f18ef14",
      "original_position" : 9,
      "path" : "src/primitives/transaction.h",
      "position" : null,
      "pull_request_review_id" : 299473557,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17060",
      "updated_at" : "2019-10-09T14:52:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/333060751",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@promag that's what the bitfield syntax `unsigned int dirty : 1;` does, it makes the flags take up the minimum possible space.\r\nOr maybe I'm misunderstanding what you're trying to accomplish.",
      "created_at" : "2019-10-12T07:41:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-541297211",
      "id" : 541297211,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MTI5NzIxMQ==",
      "updated_at" : "2019-10-12T07:42:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/541297211",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Would like to test this on my VM using a HDD.\r\nI'm not sure how to benchmark this - I've tried https://github.com/chaincodelabs/bitcoinperf but haven't succeeded. Any info/help would be appreciated.",
      "created_at" : "2019-10-12T13:26:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-541324891",
      "id" : 541324891,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MTMyNDg5MQ==",
      "updated_at" : "2019-10-12T13:26:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/541324891",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/42591821?v=4",
         "events_url" : "https://api.github.com/users/GChuf/events{/privacy}",
         "followers_url" : "https://api.github.com/users/GChuf/followers",
         "following_url" : "https://api.github.com/users/GChuf/following{/other_user}",
         "gists_url" : "https://api.github.com/users/GChuf/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/GChuf",
         "id" : 42591821,
         "login" : "GChuf",
         "node_id" : "MDQ6VXNlcjQyNTkxODIx",
         "organizations_url" : "https://api.github.com/users/GChuf/orgs",
         "received_events_url" : "https://api.github.com/users/GChuf/received_events",
         "repos_url" : "https://api.github.com/users/GChuf/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/GChuf/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/GChuf/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/GChuf"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "bitcoinperf is a bit messy to set up. I think it requires docker. Is there any specific issue you ran into? I guess it might be better to report such upstream at https://github.com/chaincodelabs/bitcoinperf to not bloat this thread",
      "created_at" : "2019-10-12T13:30:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-541325156",
      "id" : 541325156,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MTMyNTE1Ng==",
      "updated_at" : "2019-10-12T13:30:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/541325156",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Would like to test this on my VM using a HDD.\r\n> I'm not sure how to benchmark this - I've tried https://github.com/chaincodelabs/bitcoinperf but haven't succeeded. Any info/help would be appreciated.\r\n\r\nIn my benchmarks I deleted `debug.log`, ran `/usr/bin/time -v ./bitcoind -reindex-chainstate -stopatheight=594000 -printtoconsole=0 -dbcache=500`, then used a hand written script to convert the debug.log into gnuplot-readable data, then used gnuplot to create the graphs.\r\n\r\nIt would be awesome to have some kind of logger in bitcoind that can periodically log statistics into a file in an easily parseable data.",
      "created_at" : "2019-10-12T13:46:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-541326478",
      "id" : 541326478,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MTMyNjQ3OA==",
      "updated_at" : "2019-10-12T13:46:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/541326478",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "There were a couple issues. Could you recommend anything else to test `-reindex-chainstate`? Should I simply run bitcoind and have linux count time ... ?\r\nOr maybe I'll look around things mentioned in this [stackexchange answer](https://unix.stackexchange.com/a/414770/334043).\r\n\r\np.s. thanks for the info @martinus. I'll figure something out with what you did and those tools mentioned in the link.",
      "created_at" : "2019-10-12T13:52:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-541327005",
      "id" : 541327005,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MTMyNzAwNQ==",
      "updated_at" : "2019-10-12T13:52:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/541327005",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/42591821?v=4",
         "events_url" : "https://api.github.com/users/GChuf/events{/privacy}",
         "followers_url" : "https://api.github.com/users/GChuf/followers",
         "following_url" : "https://api.github.com/users/GChuf/following{/other_user}",
         "gists_url" : "https://api.github.com/users/GChuf/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/GChuf",
         "id" : 42591821,
         "login" : "GChuf",
         "node_id" : "MDQ6VXNlcjQyNTkxODIx",
         "organizations_url" : "https://api.github.com/users/GChuf/orgs",
         "received_events_url" : "https://api.github.com/users/GChuf/received_events",
         "repos_url" : "https://api.github.com/users/GChuf/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/GChuf/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/GChuf/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/GChuf"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@laanwj I mean stuff like this:\r\n```\r\n        auto oldDirty = coin.dirty;\r\n        auto oldFresh = coin.fresh;\r\n```\r\ncould be\r\n```\r\n        auto old_cache = coin.cache;\r\n```\r\nwhere\r\n```\r\n    unsigned int cache : 2;   // DIRTY = 1,  FRESH = 2\r\n```",
      "created_at" : "2019-10-12T14:24:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-541329578",
      "id" : 541329578,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MTMyOTU3OA==",
      "updated_at" : "2019-10-12T14:24:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/541329578",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The debug.log from first benchmark (master) got overwritten by the second benchmark, and I didn't make a script to do a graph from debug.log yet anyway, so I'm just gonna post the `/usr/bin/time -v`  results.\r\nThe improvement seems remarkable! I tested this on Ubuntu 16 VM running on a Seagate SSHD (also called bybrid) disk. It seems however the process used more CPU - not sure what's going on with those percentages though. Must be a VM bug.\r\n\r\n\r\n| First Header  | Second Header |time |max resident set size |\r\n| - | - |- |- |\r\n| 2019-09-more-compact-Coin  | dbcache=500  |2:20:09 |1673108 |\r\n| Master  | dbcache=500  |3:25:46 |1729412 |\r\n| Improvement  |    | 31,9% | 3,26%  |\r\n\r\n\r\n\r\n```\r\n\r\n\tCommand being timed: \"./bitcoindmaster -reindex-chainstate -stopatheight=325000 -printtoconsole=0 -dbcache=500\"\r\n\tUser time (seconds): 19760.08\r\n\tSystem time (seconds): 1031.02\r\n\tPercent of CPU this job got: 168%\r\n\tElapsed (wall clock) time (h:mm:ss or m:ss): 3:25:46\r\n\tAverage shared text size (kbytes): 0\r\n\tAverage unshared data size (kbytes): 0\r\n\tAverage stack size (kbytes): 0\r\n\tAverage total size (kbytes): 0\r\n\tMaximum resident set size (kbytes): 1729412\r\n\tAverage resident set size (kbytes): 0\r\n\tMajor (requiring I/O) page faults: 0\r\n\tMinor (reclaiming a frame) page faults: 2088592\r\n\tVoluntary context switches: 38379113\r\n\tInvoluntary context switches: 2185645\r\n\tSwaps: 0\r\n\tFile system inputs: 0\r\n\tFile system outputs: 0\r\n\tSocket messages sent: 0\r\n\tSocket messages received: 0\r\n\tSignals delivered: 0\r\n\tPage size (bytes): 4096\r\n\tExit status: 0\r\n```\r\n\r\n```\r\n\r\n\tCommand being timed: \"./bitcoindcoin -reindex-chainstate -stopatheight=325000 -printtoconsole=0 -dbcache=500\"\r\n\tUser time (seconds): 19004.87\r\n\tSystem time (seconds): 598.24\r\n\tPercent of CPU this job got: 233%\r\n\tElapsed (wall clock) time (h:mm:ss or m:ss): 2:20:09\r\n\tAverage shared text size (kbytes): 0\r\n\tAverage unshared data size (kbytes): 0\r\n\tAverage stack size (kbytes): 0\r\n\tAverage total size (kbytes): 0\r\n\tMaximum resident set size (kbytes): 1673108\r\n\tAverage resident set size (kbytes): 0\r\n\tMajor (requiring I/O) page faults: 0\r\n\tMinor (reclaiming a frame) page faults: 1737560\r\n\tVoluntary context switches: 17203875\r\n\tInvoluntary context switches: 2926137\r\n\tSwaps: 0\r\n\tFile system inputs: 0\r\n\tFile system outputs: 0\r\n\tSocket messages sent: 0\r\n\tSocket messages received: 0\r\n\tSignals delivered: 0\r\n\tPage size (bytes): 4096\r\n\tExit status: 0\r\n\r\n```",
      "created_at" : "2019-10-15T17:55:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-542331666",
      "id" : 542331666,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MjMzMTY2Ng==",
      "updated_at" : "2019-10-15T17:55:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/542331666",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/42591821?v=4",
         "events_url" : "https://api.github.com/users/GChuf/events{/privacy}",
         "followers_url" : "https://api.github.com/users/GChuf/followers",
         "following_url" : "https://api.github.com/users/GChuf/following{/other_user}",
         "gists_url" : "https://api.github.com/users/GChuf/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/GChuf",
         "id" : 42591821,
         "login" : "GChuf",
         "node_id" : "MDQ6VXNlcjQyNTkxODIx",
         "organizations_url" : "https://api.github.com/users/GChuf/orgs",
         "received_events_url" : "https://api.github.com/users/GChuf/received_events",
         "repos_url" : "https://api.github.com/users/GChuf/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/GChuf/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/GChuf/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/GChuf"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks @GChuf for testing this! This are really nice results.\r\n\r\n> It seems however the process used more CPU\r\n\r\nI don't think so:\r\n* master had 19760.08 sec user + 1031.02 sec system = 20791.1 sec\r\n* 2019-09-more-compact-Coin had 19004.87 sec user + 598.24 sec system = 19603,11\r\n\r\nSo the branch used ~6% less CPU. Note that the percentage 233% is much higher than for master because it used that CPU in a much shorter timeframe.\r\n\r\nThe percentage is calculated 100*(user + system time) / elapsed. 233 percent means that on average 2.33 cores were running for this job.",
      "created_at" : "2019-10-15T19:05:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-542359379",
      "id" : 542359379,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MjM1OTM3OQ==",
      "updated_at" : "2019-10-15T20:06:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/542359379",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> The percentage is calculated 100*(user + system time) / elapsed. 233 percent means that on average 2.33 cores were running for this job.\r\n\r\nThanks for the explaination! The math works :)\r\nIf more testing is needed I'd be glad to help, but I think HDDs will show similar results to my SSHD and it's clear that the improvements are real.",
      "created_at" : "2019-10-16T17:40:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-542812785",
      "id" : 542812785,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MjgxMjc4NQ==",
      "updated_at" : "2019-10-16T17:40:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/542812785",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/42591821?v=4",
         "events_url" : "https://api.github.com/users/GChuf/events{/privacy}",
         "followers_url" : "https://api.github.com/users/GChuf/followers",
         "following_url" : "https://api.github.com/users/GChuf/following{/other_user}",
         "gists_url" : "https://api.github.com/users/GChuf/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/GChuf",
         "id" : 42591821,
         "login" : "GChuf",
         "node_id" : "MDQ6VXNlcjQyNTkxODIx",
         "organizations_url" : "https://api.github.com/users/GChuf/orgs",
         "received_events_url" : "https://api.github.com/users/GChuf/received_events",
         "repos_url" : "https://api.github.com/users/GChuf/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/GChuf/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/GChuf/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/GChuf"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK from me, seems like some great savings here. Though it'll be crucial to test this thoroughly across platforms. Will review in depth soon.",
      "created_at" : "2019-10-17T05:48:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-543014001",
      "id" : 543014001,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MzAxNDAwMQ==",
      "updated_at" : "2019-10-17T05:48:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/543014001",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I can also test it on windows. Does anyone have the windows executable for this already, to make my life easier? @martinus maybe? ",
      "created_at" : "2019-10-17T17:11:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-543273045",
      "id" : 543273045,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MzI3MzA0NQ==",
      "updated_at" : "2019-10-17T17:11:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/543273045",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/42591821?v=4",
         "events_url" : "https://api.github.com/users/GChuf/events{/privacy}",
         "followers_url" : "https://api.github.com/users/GChuf/followers",
         "following_url" : "https://api.github.com/users/GChuf/following{/other_user}",
         "gists_url" : "https://api.github.com/users/GChuf/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/GChuf",
         "id" : 42591821,
         "login" : "GChuf",
         "node_id" : "MDQ6VXNlcjQyNTkxODIx",
         "organizations_url" : "https://api.github.com/users/GChuf/orgs",
         "received_events_url" : "https://api.github.com/users/GChuf/received_events",
         "repos_url" : "https://api.github.com/users/GChuf/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/GChuf/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/GChuf/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/GChuf"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "These are pretty impressive gains, so concept ACK.\r\n\r\nSome overall comments:\r\n* Since this is making the boundary between `Coin` and `CCoinsCacheEntry` a bit less clear, maybe it would be useful to either have a `Coin::AssignWithoutFlags` function, or even make `Coin::operator=` not touch the flags. That would avoid all the `oldX = ...; ...; ... = oldX` code, and make review easier.\r\n* The coding style guidelines for variables say to use snake_case in new code.\r\n\r\nI do want to review the prevector changes in more detail.",
      "created_at" : "2019-10-17T17:35:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-543282296",
      "id" : 543282296,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MzI4MjI5Ng==",
      "updated_at" : "2019-10-17T17:36:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/543282296",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I can also test it on windows. Does anyone have the windows executable for this already, to make my life easier? @martinus maybe?\r\n\r\nSorry, I build only in Linux, never tried to build in Windows\r\n\r\n>  Since this is making the boundary between `Coin` and `CCoinsCacheEntry` a bit less clear, maybe it would be useful to either have a `Coin::AssignWithoutFlags` function, or even make `Coin::operator=` not touch the flags. That would avoid all the `oldX = ...; ...; ... = oldX` code, and make review easier.\r\n\r\nI'm also unsure if it was everywhere necessary to backup and then restore the previous flags. Moving the flags into `Coin` only saves us 4bytes. I could also remove that change and do this in a separate PR.\r\n\r\n",
      "created_at" : "2019-10-17T17:43:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-543285380",
      "id" : 543285380,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MzI4NTM4MA==",
      "updated_at" : "2019-10-17T17:43:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/543285380",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@DrahtBot might have a windows build ready tomorrow",
      "created_at" : "2019-10-17T18:21:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-543300465",
      "id" : 543300465,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MzMwMDQ2NQ==",
      "updated_at" : "2019-10-17T18:21:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/543300465",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I have Gitian-built windows binaries of 03cb535384eb6d2f4284524c33ab03371bd263e2 here for those who are keen (@GChuf): https://send.firefox.com/download/c78ac103a4dabe86/#S70uxKCUua-baEeR0v029g",
      "created_at" : "2019-10-17T19:20:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-543323173",
      "id" : 543323173,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MzMyMzE3Mw==",
      "updated_at" : "2019-10-17T19:20:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/543323173",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks @MarcoFalke & @dongcarl, will test on Win10 tomorrow/this weekend.",
      "created_at" : "2019-10-17T20:15:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-543343451",
      "id" : 543343451,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MzM0MzQ1MQ==",
      "updated_at" : "2019-10-17T20:15:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/543343451",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/42591821?v=4",
         "events_url" : "https://api.github.com/users/GChuf/events{/privacy}",
         "followers_url" : "https://api.github.com/users/GChuf/followers",
         "following_url" : "https://api.github.com/users/GChuf/following{/other_user}",
         "gists_url" : "https://api.github.com/users/GChuf/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/GChuf",
         "id" : 42591821,
         "login" : "GChuf",
         "node_id" : "MDQ6VXNlcjQyNTkxODIx",
         "organizations_url" : "https://api.github.com/users/GChuf/orgs",
         "received_events_url" : "https://api.github.com/users/GChuf/received_events",
         "repos_url" : "https://api.github.com/users/GChuf/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/GChuf/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/GChuf/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/GChuf"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> A 512 GB micro SD card should do the job, no?\r\n\r\nYou'll find sdcards larger than 32GB to be rather terrible for anything aside from sequential write (4K video cameras). The main issue is the \"erase block size\" which is the minimum size of any erase. Every time you write anything to disk it could rewrite that size. 32GB is the smallest sdcard I've seen with 4MB erase block size. I've seen 128GB sdcard with 16MB. I'm guessing bigger has even larger erase blocks.\r\n\r\nThere are possible changes that could be done to Core to make it more flash friendly but it is not worthwhile as performance of that type of flash is abysmal while SATA/NVMe SSD controllers don't really need such optimizations.",
      "created_at" : "2019-10-18T00:28:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-543424057",
      "id" : 543424057,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MzQyNDA1Nw==",
      "updated_at" : "2019-10-18T00:28:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/543424057",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/93665?v=4",
         "events_url" : "https://api.github.com/users/wtogami/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wtogami/followers",
         "following_url" : "https://api.github.com/users/wtogami/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wtogami/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wtogami",
         "id" : 93665,
         "login" : "wtogami",
         "node_id" : "MDQ6VXNlcjkzNjY1",
         "organizations_url" : "https://api.github.com/users/wtogami/orgs",
         "received_events_url" : "https://api.github.com/users/wtogami/received_events",
         "repos_url" : "https://api.github.com/users/wtogami/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wtogami/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wtogami/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wtogami"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Hm, getting the opposite of what I would expect in terms of benchmark results. For `/usr/bin/time -v ./src/bitcoind -reindex-chainstate -stopatheight=550000 -dbcache=4000 -connect=0` (run using a lightly modified version of [this script](https://github.com/chaincodelabs/bitcoinperf/blob/master/bin/run_remote_reindex.py)) across a number of different machines, I'm seeing this branch as reliably slower than master:\r\n\r\n```\r\nbench-ssd-2  master                               4:05:52    0.45  6283.55MB 204%\r\nbench-ssd-2  martinus/2019-09-more-compact-Coin   9:06:48    1.00  5927.98MB 347%\r\n\r\nbench-ssd-3  martinus/2019-09-more-compact-Coin   9:07:05    1.00  5914.48MB 346%\r\nbench-ssd-3  master                               2:59:52    0.33  6278.71MB 77%\r\n\r\nbench-ssd-4  master                               2:33:47    0.28  6257.46MB 89%\r\nbench-ssd-4  martinus/2019-09-more-compact-Coin   9:07:19    1.00  5834.16MB 346%\r\n\r\nbench-ssd-5  martinus/2019-09-more-compact-Coin   9:03:16    1.00  5963.10MB 349%\r\nbench-ssd-5  master                               3:58:48    0.44  6252.48MB 209%\r\n\r\nbench-hdd-4  master                               6:22:47    0.64  6263.75MB 36%\r\nbench-hdd-4  martinus/2019-09-more-compact-Coin   10:02:42   1.00  5908.06MB 314%\r\n\r\nbench-hdd-5  martinus/2019-09-more-compact-Coin   9:52:42    1.00  5889.18MB 320%\r\nbench-hdd-5  master                               6:54:05    0.70  6240.25MB 120%\r\n```\r\n\r\nSample machine specs:\r\n```\r\nHostname:            bench-ssd-2\r\nKernel:              Linux 4.9.0-8-amd64\r\nOS:                  Debian GNU/Linux 9\r\nRAM (GB):            7.71\r\nArchitecture:          x86_64\r\nCPU(s):                4\r\nThread(s) per core:    1\r\nCore(s) per socket:    4\r\nModel name:            Intel(R) Xeon(R) CPU E3-1220 v5 @ 3.00GHz\r\n```\r\n\r\nCan anyone think of an explanation for this? \r\n\r\n---\r\n\r\nAlso, FWIW, in your original PR description your graph and table show master as being faster than this branch but when I read it initially I'd assumed it was just a labeling error.",
      "created_at" : "2019-10-18T02:07:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-543451649",
      "id" : 543451649,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MzQ1MTY0OQ==",
      "updated_at" : "2019-10-18T02:14:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/543451649",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Can anyone think of an explanation for this?\r\n\r\nI really can't explain why the diffference is so huge. Maybe it has something to do with the Xeon CPU? Or there is still a bug in the code that manifests on that CPU. Do you have the `debug.log` files, or graphs of the progress? Maybe there it's visible at which point the difference occurs.\r\n\r\nI'm currently running a comparison on a very slow Intel Celeron N3050, 2GB of RAM, `-dbcache=500`, and external SSD. So far it seems the results are very close",
      "created_at" : "2019-10-18T16:03:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-543811585",
      "id" : 543811585,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MzgxMTU4NQ==",
      "updated_at" : "2019-10-18T16:03:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/543811585",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--a722867cd34abeea1fadc8d60700f111-->\nGitian builds for commit ec3ed5a4487886f1c2a35fda0a3289be7b280248 (master):\n * `f64e5b9561bbfd24763ca216dfb72e6c...` [bitcoin-0.19.99-aarch64-linux-gnu-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/bitcoin-0.19.99-aarch64-linux-gnu-debug.tar.gz)\n * `3450cd39da524d4259d8971fa07f7cd3...` [bitcoin-0.19.99-aarch64-linux-gnu.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/bitcoin-0.19.99-aarch64-linux-gnu.tar.gz)\n * `f9c08aecb54c510abc1c49a0f615cc47...` [bitcoin-0.19.99-arm-linux-gnueabihf-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/bitcoin-0.19.99-arm-linux-gnueabihf-debug.tar.gz)\n * `48858aa869f72b05f6fd77a174cec72d...` [bitcoin-0.19.99-arm-linux-gnueabihf.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/bitcoin-0.19.99-arm-linux-gnueabihf.tar.gz)\n * `2f3d551fa3a0744ced807e575f1e4643...` [bitcoin-0.19.99-i686-pc-linux-gnu-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/bitcoin-0.19.99-i686-pc-linux-gnu-debug.tar.gz)\n * `61eef7a7416e41bd49f11481339df776...` [bitcoin-0.19.99-i686-pc-linux-gnu.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/bitcoin-0.19.99-i686-pc-linux-gnu.tar.gz)\n * `befb99d795c38a2f320e99e677e437fb...` [bitcoin-0.19.99-osx-unsigned.dmg](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/bitcoin-0.19.99-osx-unsigned.dmg)\n * `aadf3d3811d300b416a2e3a36e5d9636...` [bitcoin-0.19.99-osx64.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/bitcoin-0.19.99-osx64.tar.gz)\n * `75ad9c5b79ef283885def690f4210e28...` [bitcoin-0.19.99-riscv64-linux-gnu-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/bitcoin-0.19.99-riscv64-linux-gnu-debug.tar.gz)\n * `0bdc56205b7a686505b49d9694dfbb7d...` [bitcoin-0.19.99-riscv64-linux-gnu.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/bitcoin-0.19.99-riscv64-linux-gnu.tar.gz)\n * `0ed997185c1a65c6ab29882306a5c4ed...` [bitcoin-0.19.99-win64-debug.zip](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/bitcoin-0.19.99-win64-debug.zip)\n * `e642bb08c080af778aad7ab1bc889769...` [bitcoin-0.19.99-win64-setup-unsigned.exe](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/bitcoin-0.19.99-win64-setup-unsigned.exe)\n * `471525f13e4ee98129b3e140175776a5...` [bitcoin-0.19.99-win64.zip](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/bitcoin-0.19.99-win64.zip)\n * `a2d38074e8a186c6251fbb30948caf6f...` [bitcoin-0.19.99-x86_64-linux-gnu-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/bitcoin-0.19.99-x86_64-linux-gnu-debug.tar.gz)\n * `544d75a68b31657850b22296599a3d3f...` [bitcoin-0.19.99-x86_64-linux-gnu.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/bitcoin-0.19.99-x86_64-linux-gnu.tar.gz)\n * `c780c4b108f18250dfaa13a06d7ded80...` [bitcoin-0.19.99.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/bitcoin-0.19.99.tar.gz)\n * `42923b2fe3a4f72ea620650c3be0a040...` [bitcoin-core-linux-0.20-res.yml](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/bitcoin-core-linux-0.20-res.yml)\n * `15e9a3c42739179b937c4bb927c02731...` [bitcoin-core-osx-0.20-res.yml](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/bitcoin-core-osx-0.20-res.yml)\n * `4f45465e66f847f97cfd6af3c2bd3514...` [bitcoin-core-win-0.20-res.yml](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/bitcoin-core-win-0.20-res.yml)\n * `a34a94c2dee07af19dfd80a405f39c1d...` [linux-build.log](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/linux-build.log)\n * `e0a214ba922d8febd8566d7102414cc0...` [osx-build.log](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/osx-build.log)\n * `bfb37291238fa4be8727e7c882d422e0...` [win-build.log](https://drahtbot.space/gitian/bitcoin/bitcoin/ec3ed5a4487886f1c2a35fda0a3289be7b280248/win-build.log)\n\n\nGitian builds for commit c03bdee106a5f9743d373955e7ae63c244a9d14f (master and this pull):\n * `21be324e602ab9137713978809daf2d4...` [bitcoin-0.19.99-aarch64-linux-gnu-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-0.19.99-aarch64-linux-gnu-debug.tar.gz)\n * `a2a947b221298ecd34e6ce1cb37c0e24...` [bitcoin-0.19.99-aarch64-linux-gnu.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-0.19.99-aarch64-linux-gnu.tar.gz)\n * `bd91c4a5226072e4edbd5e98b97cb501...` [bitcoin-0.19.99-arm-linux-gnueabihf-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-0.19.99-arm-linux-gnueabihf-debug.tar.gz)\n * `faeb989fd34185ce53da69936d733f79...` [bitcoin-0.19.99-arm-linux-gnueabihf.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-0.19.99-arm-linux-gnueabihf.tar.gz)\n * `a3123122a7e65d5cbf21bef0f8fcf735...` [bitcoin-0.19.99-i686-pc-linux-gnu-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-0.19.99-i686-pc-linux-gnu-debug.tar.gz)\n * `9671072a15c92d5c4e319e106d35562b...` [bitcoin-0.19.99-i686-pc-linux-gnu.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-0.19.99-i686-pc-linux-gnu.tar.gz)\n * `b6ac4ce3519f9c8b1f7f48f178f9ca65...` [bitcoin-0.19.99-osx-unsigned.dmg](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-0.19.99-osx-unsigned.dmg)\n * `3a85bf2bc871654de1d6e5e54e0f96ad...` [bitcoin-0.19.99-osx64.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-0.19.99-osx64.tar.gz)\n * `b8dde959618ef0d0377edddacf15206d...` [bitcoin-0.19.99-riscv64-linux-gnu-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-0.19.99-riscv64-linux-gnu-debug.tar.gz)\n * `0440b4bd516b3dce22624bb4238c8f15...` [bitcoin-0.19.99-riscv64-linux-gnu.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-0.19.99-riscv64-linux-gnu.tar.gz)\n * `c637cd01437f265728fb56e3e1d59251...` [bitcoin-0.19.99-win64-debug.zip](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-0.19.99-win64-debug.zip)\n * `129e664178ed338e3bdacd004a9bef0f...` [bitcoin-0.19.99-win64-setup-unsigned.exe](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-0.19.99-win64-setup-unsigned.exe)\n * `a109ae374325151140aa4d1198d9b0b3...` [bitcoin-0.19.99-win64.zip](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-0.19.99-win64.zip)\n * `51db059ac46e7bb3023eb388d0d15c2a...` [bitcoin-0.19.99-x86_64-linux-gnu-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-0.19.99-x86_64-linux-gnu-debug.tar.gz)\n * `156a11f1a47ef7117f042e61884941c6...` [bitcoin-0.19.99-x86_64-linux-gnu.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-0.19.99-x86_64-linux-gnu.tar.gz)\n * `24814072e1ad7f0737ac7f27041652ec...` [bitcoin-0.19.99.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-0.19.99.tar.gz)\n * `273925fb3dc8bf3bf938d2fbbad25498...` [bitcoin-core-linux-0.20-res.yml](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-core-linux-0.20-res.yml)\n * `fa5fe33a45bd629de2c70f19d4591e14...` [bitcoin-core-linux-0.20-res.yml.diff](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-core-linux-0.20-res.yml.diff)\n * `85c08b95741702e1d30f1ddf661a998e...` [bitcoin-core-osx-0.20-res.yml](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-core-osx-0.20-res.yml)\n * `ff0ae3c0febd01ff9f5ae8143668e186...` [bitcoin-core-osx-0.20-res.yml.diff](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-core-osx-0.20-res.yml.diff)\n * `c436fdc5ae135eef95b78b1a87fd046e...` [bitcoin-core-win-0.20-res.yml](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-core-win-0.20-res.yml)\n * `445445b454c55b180f66c987724dc908...` [bitcoin-core-win-0.20-res.yml.diff](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/bitcoin-core-win-0.20-res.yml.diff)\n * `f623e4a8beac28c21ae777486a2d9896...` [linux-build.log](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/linux-build.log)\n * `bc158fbfa6154a602bbd26d94e152cbc...` [linux-build.log.diff](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/linux-build.log.diff)\n * `3b19b1483a35da9ab989094d72883afe...` [osx-build.log](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/osx-build.log)\n * `fe3f35265a17b343e21809b7b81af0d1...` [osx-build.log.diff](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/osx-build.log.diff)\n * `e7d72b7ce7a9ef37e687fb95165837b7...` [win-build.log](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/win-build.log)\n * `3aee332171621d115568e8fd07e7ac9f...` [win-build.log.diff](https://drahtbot.space/gitian/bitcoin/bitcoin/c03bdee106a5f9743d373955e7ae63c244a9d14f/win-build.log.diff)\n",
      "created_at" : "2019-10-19T04:45:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-544095713",
      "id" : 544095713,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NDA5NTcxMw==",
      "updated_at" : "2019-10-19T04:45:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/544095713",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@jamesob please post the debug logs, some time ago I was looking at your results at https://github.com/bitcoin/bitcoin/pull/16801 which seemed weird as well, and debug logs could shed some much needed light into this.\r\nAs for Xeon CPUs, I've got a Xeon E3 1240 v2. The previous test on ubuntu VM was run with this CPU and I'm gonna run windows benchmarks on it as well and post the results here. Anyway I doubt xeon (or any other) intel CPUs are the problem, thought it's possible.",
      "created_at" : "2019-10-19T15:55:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-544164077",
      "id" : 544164077,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NDE2NDA3Nw==",
      "updated_at" : "2019-10-19T15:55:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/544164077",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/42591821?v=4",
         "events_url" : "https://api.github.com/users/GChuf/events{/privacy}",
         "followers_url" : "https://api.github.com/users/GChuf/followers",
         "following_url" : "https://api.github.com/users/GChuf/following{/other_user}",
         "gists_url" : "https://api.github.com/users/GChuf/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/GChuf",
         "id" : 42591821,
         "login" : "GChuf",
         "node_id" : "MDQ6VXNlcjQyNTkxODIx",
         "organizations_url" : "https://api.github.com/users/GChuf/orgs",
         "received_events_url" : "https://api.github.com/users/GChuf/received_events",
         "repos_url" : "https://api.github.com/users/GChuf/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/GChuf/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/GChuf/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/GChuf"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Much more modest improvements when running this on a physical Windows machine (~2% improvement in time). Same hardware was used as in my previous benchmark.\r\nI might have seen better improvements if I used an old HDD, but I just wanted to make sure the improvements are there on windows as well.\r\n\r\nmaster: 02:59:21\r\n2019-09-more-compact-Coin: 02:56:05\r\n\r\n![figure_1](https://user-images.githubusercontent.com/42591821/67157095-b69bba80-f316-11e9-8de0-2cae1e0845f0.png)\r\n\r\n",
      "created_at" : "2019-10-20T08:56:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-544233613",
      "id" : 544233613,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NDIzMzYxMw==",
      "updated_at" : "2019-10-20T08:58:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/544233613",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/42591821?v=4",
         "events_url" : "https://api.github.com/users/GChuf/events{/privacy}",
         "followers_url" : "https://api.github.com/users/GChuf/followers",
         "following_url" : "https://api.github.com/users/GChuf/following{/other_user}",
         "gists_url" : "https://api.github.com/users/GChuf/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/GChuf",
         "id" : 42591821,
         "login" : "GChuf",
         "node_id" : "MDQ6VXNlcjQyNTkxODIx",
         "organizations_url" : "https://api.github.com/users/GChuf/orgs",
         "received_events_url" : "https://api.github.com/users/GChuf/received_events",
         "repos_url" : "https://api.github.com/users/GChuf/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/GChuf/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/GChuf/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/GChuf"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@GChuf , did you run the windows benchmark on the same hardware where you got the 31% improvement in Linux?\r\n\r\nMy benchmark with Intel Celeron N3050 has finished, where the branch is about of 1.4% faster. It seems that the CPU is definitely the limiting factor here - each run took over 6 days\r\n\r\n![out2](https://user-images.githubusercontent.com/14386/67159490-a3541380-f345-11e9-989f-8135ebc2bfc5.png)\r\n",
      "created_at" : "2019-10-20T12:31:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-544247983",
      "id" : 544247983,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NDI0Nzk4Mw==",
      "updated_at" : "2019-10-20T12:33:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/544247983",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@martinus yes, forgot to mention. Hardware was the same. The difference was that on the first run I was running the benchmark on a VM, which certainly performs worse. I think the difference between physical vs VM is more pronounced with CPUs rather than disks.",
      "created_at" : "2019-10-20T13:38:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-544253328",
      "id" : 544253328,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NDI1MzMyOA==",
      "updated_at" : "2019-10-20T13:38:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/544253328",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/42591821?v=4",
         "events_url" : "https://api.github.com/users/GChuf/events{/privacy}",
         "followers_url" : "https://api.github.com/users/GChuf/followers",
         "following_url" : "https://api.github.com/users/GChuf/following{/other_user}",
         "gists_url" : "https://api.github.com/users/GChuf/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/GChuf",
         "id" : 42591821,
         "login" : "GChuf",
         "node_id" : "MDQ6VXNlcjQyNTkxODIx",
         "organizations_url" : "https://api.github.com/users/GChuf/orgs",
         "received_events_url" : "https://api.github.com/users/GChuf/received_events",
         "repos_url" : "https://api.github.com/users/GChuf/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/GChuf/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/GChuf/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/GChuf"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Some notes on other paths to shave off bytes here:\r\n\r\nAs an alternative, you could do something like the union below to compact the CAmount for the (evidence: https://eprint.iacr.org/2017/1095.pdf, also by pigeon hole we have 21M coins and 100+M UTXOs so most have to be small) common case of a UTXO smaller than 2**31/100e6 (about 21.47 BTC). This technique saves another 4 bytes. The nice thing about this change is that we don't have to change the guts of CScript which has implications across a bunch of sensitive areas.\r\n\r\nWere you to combine it with the prevector and CScript changes, you would see the same improvement of 4 bytes, bringing it down to 72 bytes.\r\n\r\nThere is also the option to hash the COutpoint, to save another 4 bytes, but I looked into this once and it seemed complicated because some cases we use the key of the pair IIRC. (The same trick as above could be used to shave off 2 bytes as almost all outputs indexes are < 16 bits)\r\n\r\n```c++\r\nunion {\r\nstruct {\r\n    bool is_big : 1;\r\n    private:\r\n    uint32_t amount: 31;\r\n} read_flag;\r\nstruct {\r\n    struct {\r\n        private:\r\n        bool __flag : 1;\r\n        public:\r\n        uint32_t amount: 31;\r\n    } flag_amount;\r\n    CScript script;\r\n} small_value;\r\nstruct {\r\n    struct {\r\n        private:\r\n        bool __flag : 1;\r\n        public:\r\n        uint32_t ignore: 31;\r\n    } flag;\r\n    std::unique_ptr<CTxOut> ptr;\r\n} large_value;\r\n}\r\n```",
      "created_at" : "2019-10-20T19:03:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-544281616",
      "id" : 544281616,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NDI4MTYxNg==",
      "updated_at" : "2019-10-20T19:03:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/544281616",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Just finished another benchmark run on a significantly beefier machine with similar (odd) results. Only the debug.log for this branch was preserved since I started the run a few days ago, but (i) I'm working on some better tooling to parse debug.log files (optionally contingent on #16805) and generate tables, graphs, etc., and (ii) in future runs I'll make sure I preserve the debug.log files for each branch.\r\n\r\n`/usr/bin/time -v ./src/bitcoind -reindex-chainstate -stopatheight=550000 -dbcache=4000 -connect=0`\r\n\r\n\r\nEdit: compiled with `g++ (Debian 8.3.0-6) 8.3.0`.\r\n\r\n#### master\r\n \r\n`{'time': '2:56:18', 'cpu_perc': '68%', 'mem_kb': 6389536, 'user_time_secs': 6754.8, 'system_time_secs': 527.61}`\r\n\r\n#### martinus/2019-09-more-compact-Coin (03cb53538)\r\n\r\n`{'time': '9:16:02', 'cpu_perc': '635%', 'mem_kb': 5871084, 'user_time_secs': 211292.35, 'system_time_secs': 565.91}`\r\n\r\n#### debug.log (martinus/2019-09-more-compact-Coin)\r\n \r\nhttps://transfer.sh/ncVfW/jamesob-17060-debug.log\r\n\r\n#### hwinfo\r\n```\r\nhostname               bench-strong        \r\ncpu_model_name         Intel(R) Core(TM) i7-4770 CPU @ 3.40GHz\r\nram_gb                 31.35\r\nos                     ['Debian GNU/Linux', '10', 'buster']\r\narch                   x86_64              \r\nkernel                 4.19.0-5-amd64      \r\nread_iops (/tmp)       29.2k\r\nwrite_iops (/tmp)      9694\r\nread_iops (/data)      396\r\nwrite_iops (/data)     131\r\n```\r\n",
      "created_at" : "2019-10-21T06:25:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-544367528",
      "id" : 544367528,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NDM2NzUyOA==",
      "updated_at" : "2019-10-21T06:28:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/544367528",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for posting the debug.log! That's already helpful. I was hoping to find some issue where e.g. db sync takes a long time, but this is not the case. Flushing the db cache takes a few minutes, but nothing extraordinary:\r\n\r\n```\r\n2019-10-18T08:30:54Z UpdateTip: new best=000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f height=0 version=0x00000001 log2_work=32.000022 tx=1 date='2009-01-03T18:15:05Z' progress=0.000000 cache=0.0MiB(0txo)\r\n2019-10-18T10:10:27Z UpdateTip: new best=00000000000000000d533060763bd64c8b97de7fdbc407bd918cf97ff37ae69a height=372609 version=0x00000003 log2_work=83.29081 tx=82023512 date='2015-09-02T02:22:29Z' progress=0.175964 cache=4275.5MiB(35061266txo)\r\n2019-10-18T10:17:07Z UpdateTip: new best=0000000000000000056e394d44a7ae5eb021d6171504a7dec0a833d50763fad6 height=372610 version=0x00000003 log2_work=83.290838 tx=82024083 date='2015-09-02T02:26:03Z' progress=0.175965 cache=482.8MiB(0txo)\r\n2019-10-18T12:15:33Z UpdateTip: new best=00000000000000000168ff4ff0e7a5ddf08c707fe928be19a25a9c90e8444dab height=433063 version=0x20000000 log2_work=85.368569 tx=160962375 date='2016-10-06T00:55:30Z' progress=0.345290 cache=4276.1MiB(35338561txo)\r\n2019-10-18T12:23:07Z UpdateTip: new best=000000000000000000b7619d54035e1ad58c762daef103369d2c04a8641fb20a height=433064 version=0x20000000 log2_work=85.368598 tx=160962901 date='2016-10-06T00:58:57Z' progress=0.345290 cache=482.8MiB(0txo)\r\n2019-10-18T14:52:48Z UpdateTip: new best=0000000000000000002a003b9e34d263f117db2562c80171080e31d4db61bd72 height=490207 version=0x20000000 log2_work=87.294564 tx=262721239 date='2017-10-16T23:03:01Z' progress=0.563536 cache=4276.0MiB(35487228txo)\r\n2019-10-18T15:00:54Z UpdateTip: new best=000000000000000000564f989b2bd03905df412506a20b2a4708a52b1c230787 height=490208 version=0x20000000 log2_work=87.294603 tx=262723684 date='2017-10-16T23:11:33Z' progress=0.563539 cache=482.8MiB(0txo)\r\n2019-10-18T16:40:48Z UpdateTip: new best=00000000000000000032015afc76ed6c6e3e6fabae75f832e8f3d6f1a79bb2bd height=526412 version=0x20000000 log2_work=88.977034 tx=320908996 date='2018-06-07T10:09:17Z' progress=0.688312 cache=4275.9MiB(35483120txo)\r\n2019-10-18T16:47:17Z UpdateTip: new best=00000000000000000031989467b9aa7c18b75ccafd0ca3f788d5e413dbb86e4a height=526413 version=0x20000000 log2_work=88.977084 tx=320909164 date='2018-06-07T10:22:49Z' progress=0.688310 cache=482.8MiB(0txo)\r\n2019-10-18T17:43:44Z UpdateTip: new best=000000000000000000223b7a2298fb1c6c75fb0efc28a4c56853ff4112ec6bc9 height=550000 version=0x20000000 log2_work=90.011241 tx=356588225 date='2018-11-14T02:35:41Z' progress=0.764816 cache=2880.1MiB(22413485txo)\r\n```\r\nIt looks like progress is made quite linearly, so whatever is slowing it down, it seems to happen from start to finish.The really odd thing is the extreme CPU usage in the branch, it's 31 times higher than on master. \r\n\r\nCould you try to run `perf top` while syncing on the branch, maybe this gives an indication where so much CPU is spent? or create a flamegraph with [hotspot](https://github.com/KDAB/hotspot). Then can't use `pyperf system tune` though because it severely reduces the number of allowed samples",
      "created_at" : "2019-10-21T06:55:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-544375855",
      "id" : 544375855,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NDM3NTg1NQ==",
      "updated_at" : "2019-10-21T09:16:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/544375855",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@martinus @jamesob looking at the first test results from James, it occured to me that the \"problem\" must be in the CPU (or at least not in the disks) - benching master on ssd vs hdd turned out to be ~2x faster (as expected), whereas benching this branch took 9h on ssd and 10h on hdd.\r\n\r\nJames, you mentioned this in https://github.com/bitcoin/bitcoin/pull/16801:\r\n>Before anyone asks: these are dedicated benchmarking machines (specs listed below). Before each run I'm dropping all caches (sudo /sbin/swapoff -a; sudo /sbin/sysctl vm.drop_caches=3;), tuning with pyperf (sudo /usr/local/bin/pyperf system tune;), and I've ensured that the CPU governors are set to performance.\r\n\r\nBesides what Martin suggested, can you try:\r\n\r\n- **not** running pyperf & CPU governor \r\n- using gitian builds above\r\n- using `-printtoconsole=0` (This probably won't change anything, but since we have no idea what's going on ...)",
      "created_at" : "2019-10-21T14:53:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-544552437",
      "id" : 544552437,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NDU1MjQzNw==",
      "updated_at" : "2019-10-21T14:54:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/544552437",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/42591821?v=4",
         "events_url" : "https://api.github.com/users/GChuf/events{/privacy}",
         "followers_url" : "https://api.github.com/users/GChuf/followers",
         "following_url" : "https://api.github.com/users/GChuf/following{/other_user}",
         "gists_url" : "https://api.github.com/users/GChuf/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/GChuf",
         "id" : 42591821,
         "login" : "GChuf",
         "node_id" : "MDQ6VXNlcjQyNTkxODIx",
         "organizations_url" : "https://api.github.com/users/GChuf/orgs",
         "received_events_url" : "https://api.github.com/users/GChuf/received_events",
         "repos_url" : "https://api.github.com/users/GChuf/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/GChuf/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/GChuf/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/GChuf"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Okay, I've finally gotten around to taking perf to the weird `bench-strong` results. I took measurements at `progress=0.20` (roughly height 387,000) by doing \r\n```sh\r\n$ # configure with -fno-omit-frame-pointer, tune system params to enable perf, make, etc.\r\n$ ./src/bitcoind -reindex-chainstate -stopatheight=550000 -dbcache=7000 -printtoconsole=0 -connect=0 &\r\n$ while ! tail -n 10000 ~/.bitcoin/debug.log | grep progress=0.2; do sleep 3; done; kill -STOP `pidof bitcoind`\r\n[... I wait ...]\r\n$ kill -CONT `pidof bitcoind` && sleep 0.4 && perf record -g -F 101 -p `pidof bitcoind` -o perf.$THE_BRANCH.data sleep 90\r\n```\r\n\r\nAfter running the above for both this branch and master at 6a97e8a060f7632bbaee27d3de8035dc6ebe3895, here's `perf diff perf.master.data perf.martinus.data`:\r\n\r\n```\r\n# Event 'cycles:ppp'\r\n#\r\n# Baseline  Delta Abs  Shared Object              Symbol\r\n# ........  .........  .........................  ......................................................................................\r\n#\r\n     2.41%     +3.06%  bitcoind                   [.] SipHashUint256Extra\r\n    15.36%     +2.93%  bitcoind                   [.] secp256k1_fe_mul_inner\r\n     4.09%     -2.21%  libc-2.28.so               [.] 0x000000000007b544\r\n     0.26%     +1.52%  bitcoind                   [.] (anonymous namespace)::ripemd160::rol\r\n    14.02%     -1.42%  bitcoind                   [.] secp256k1_fe_sqr_inner\r\n     1.99%     -1.40%  bitcoind                   [.] sha256d64_avx2::(anonymous namespace)::Xor\r\n     1.48%     -1.32%  bitcoind                   [.] operator new\r\n               +1.12%  bitcoind                   [.] prevector<27u, unsigned char, unsigned int, int>::const_iterator::operator!=\r\n               +1.10%  bitcoind                   [.] prevector<27u, unsigned char, unsigned int, int>::const_iterator::operator++\r\n     0.00%     +1.07%  bitcoind                   [.] ser_writedata32<CSizeComputer>\r\n               +0.99%  bitcoind                   [.] prevector<27u, unsigned char, unsigned int, int>::is_direct\r\n               +0.96%  bitcoind                   [.] prevector<27u, unsigned char, unsigned int, int>::size\r\n     0.03%     +0.92%  bitcoind                   [.] sha256d64_avx2::(anonymous namespace)::Or\r\n```\r\n\r\nI think the percentages are misleading here because when I run `sudo perf top --comms=b-loadblk`, this is what I see:\r\n\r\n```\r\nSamples: 236K of event 'cycles:ppp', 2000 Hz, Event count (approx.): 252595020173\r\nOverhead  Shared Object              Symbol\r\n   2.79%  bitcoind                   [.] SipHashUint256Extra\r\n   1.00%  bitcoind                   [.] base_blob<256u>::GetUint64\r\n   0.56%  bitcoind                   [.] std::__detail::_Hash_code_base<COutPoint, std::pair<COutPoint const, CCoinsCacheEntry>, std::__\r\n   0.50%  bitcoind                   [.] SaltedOutpointHasher::operator()\r\n   0.45%  bitcoind                   [.] prevector<28u, unsigned char, unsigned int, int>::const_iterator::operator*\r\n   0.33%  bitcoind                   [.] std::_Hashtable<COutPoint, std::pair<COutPoint const, CCoinsCacheEntry>, std::allocator<std::pa\r\n   0.26%  bitcoind                   [.] ser_writedata32<CHashWriter>\r\n   0.23%  bitcoind                   [.] std::_Hashtable<COutPoint, std::pair<COutPoint const, CCoinsCacheEntry>, std::allocator<std::pa\r\n   0.22%  bitcoind                   [.] std::__uninitialized_default_n_1<false>::__uninit_default_n<CTxOut*, unsigned long>\r\n   0.18%  libc-2.28.so               [.] 0x000000000015878a\r\n   0.17%  bitcoind                   [.] operator-\r\n```\r\n\r\nIn other words, near as I can figure `SipHashUint256Extra` clocks in as the bottleneck on the `loadblk` thread, which is where the reindexing happens. Based on the (unreliable?) percentage values, it looks like this branch is spending more than twice the time hashing for map access than master is. Why this would be (or even whether or not this is the actual cause of the difference) is outside of my understanding.\r\n\r\nI can upload the raw perf data files if anyone wants, but to my understanding they aren't portable - unfortunately perf is not very well documented, and I had trouble even generating flamegraphs on a secondary machine, so I'm not really sure what the best way to make the datafiles portable is.",
      "created_at" : "2019-10-29T20:21:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-547611741",
      "id" : 547611741,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NzYxMTc0MQ==",
      "updated_at" : "2019-10-29T20:21:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/547611741",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@jamesob twice the time or twice the percentage?\r\nBecause I can confirm that my own benchmarks of master from ~2-3 weeks ago showed `SipHashUint256Extra` very very high on the list (spent a while re-implementing it with SSE instructions just to see it's actually slower with them lol)\r\n\r\n(i'm usually using the following flags: `perf report -g 'graph,0.5,caller'` that way it sorts the percentages by caller instead of callee, though you probably know more about perf than I :) )",
      "created_at" : "2019-10-29T21:05:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-547629076",
      "id" : 547629076,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NzYyOTA3Ng==",
      "updated_at" : "2019-10-29T21:06:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/547629076",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2167860?v=4",
         "events_url" : "https://api.github.com/users/elichai/events{/privacy}",
         "followers_url" : "https://api.github.com/users/elichai/followers",
         "following_url" : "https://api.github.com/users/elichai/following{/other_user}",
         "gists_url" : "https://api.github.com/users/elichai/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/elichai",
         "id" : 2167860,
         "login" : "elichai",
         "node_id" : "MDQ6VXNlcjIxNjc4NjA=",
         "organizations_url" : "https://api.github.com/users/elichai/orgs",
         "received_events_url" : "https://api.github.com/users/elichai/received_events",
         "repos_url" : "https://api.github.com/users/elichai/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/elichai/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/elichai/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/elichai"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@jamesob did your master build already contain #16957? ",
      "created_at" : "2019-10-29T21:11:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-547631234",
      "id" : 547631234,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NzYzMTIzNA==",
      "updated_at" : "2019-10-29T21:11:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/547631234",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@martinus yes it did -- are you not rebased?\r\n\r\nWorth pointing out that a prevector<28> on master fits perfectly in a 32 byte or 64 byte cache line.\r\n\r\nNo longer after this change (which is fine, we can increase to prevector<31> where sensitive to it, like std::vector<prevector<>>.\r\n\r\nAlso, now that CAmounts are unaligned, they too can be extra slow to do something with.\r\n\r\nI doubt that's what's going on here, but worth looking at before merge.",
      "created_at" : "2019-10-29T21:12:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-547631578",
      "id" : 547631578,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NzYzMTU3OA==",
      "updated_at" : "2019-10-29T21:12:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/547631578",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @martinus yes it did -- are you not rebased?\r\n\r\nI didn't saw he linked to the master revision, so both master and my branch has #16957 so it's not that.\r\n\r\nI suspect that there is something strange going on with the threading code. Maybe some timing issue causes lots of caching misses for some reason? I don't know much about how the checkqueue and surrounding classes work though.",
      "created_at" : "2019-10-29T22:51:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-547664250",
      "id" : 547664250,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NzY2NDI1MA==",
      "updated_at" : "2019-10-29T22:51:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/547664250",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I think I might have been able to reproduce this issue. I've tried `./bitcoind -datadir=/run/media/martinus/tera/bitcoin/db -reindex-chainstate -stopatheight=150000 -printtoconsole=0 -connect=0 -dbcache=15000` on master, and on an older version, before #16957. The old version used ~20 seconds of user time, master used 332 seconds. I've done `git bisect` and found this revision as the first bad commit: fa3a7331160d1a460b1c15fca1810e98070d629c \r\n\r\nI don't know why, but this commit seems to have a dramatic effect on performance.",
      "created_at" : "2019-10-29T23:30:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-547674256",
      "id" : 547674256,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NzY3NDI1Ng==",
      "updated_at" : "2019-10-29T23:30:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/547674256",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@martinus Are you aware that blocks before the assumevalid point don't get signature/script validated?",
      "created_at" : "2019-10-29T23:34:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-547675174",
      "id" : 547675174,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NzY3NTE3NA==",
      "updated_at" : "2019-10-29T23:34:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/547675174",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "For benchmarking purposes, it might be best to set all nodes compiled from different branches to `-noassumevalid` or the same block hash.",
      "created_at" : "2019-10-30T00:31:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-547687821",
      "id" : 547687821,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NzY4NzgyMQ==",
      "updated_at" : "2019-10-30T00:31:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/547687821",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @martinus Are you aware that blocks before the assumevalid point don't get signature/script validated?\r\n\r\nNo, I didn't know. Also it seems that since I didn't yet have this block, -reindex-chainstate signature/script validates everything\r\n\r\nIt might be helpful to have a *list* of assumevalid blocks instead of just a single block, to prevent revalidating everything when that specific marker block is not yet there",
      "created_at" : "2019-10-30T05:03:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-547740076",
      "id" : 547740076,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0Nzc0MDA3Ng==",
      "updated_at" : "2019-10-30T05:29:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/547740076",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2019-11-08T11:04:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-551589480",
      "id" : 551589480,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1MTU4OTQ4MA==",
      "updated_at" : "2019-11-08T11:04:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/551589480",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Did some benches over the weekend ([`bench/master.1`](https://github.com/jamesob/bitcoin/tree/bench/master.1) vs. [`bench/compactcoin.1`](https://github.com/jamesob/bitcoin/tree/bench/compactcoin.1)) with the same setup/reindex-to-550,000 as mentioned in the allocator PR (https://github.com/bitcoin/bitcoin/pull/16801#issuecomment-551883348):\r\n\r\n```\r\nhost         tag                      time       time% maxmem  cpu%  dbcache\r\nbench-ssd-2  master.1                 9:13:54    1.00  5770.10MB 344%  4000MB\r\nbench-ssd-2  master.1                 9:15:57    1.00  5773.23MB 343%  4000MB\r\nbench-ssd-2  compactcoin.1            9:07:01    0.98  5899.80MB 347%  4000MB\r\nbench-ssd-2  compactcoin.1            9:07:41    0.99  5923.72MB 346%  4000MB\r\n\r\nbench-ssd-3  compactcoin.1            9:06:32    0.98  5959.14MB 347%  4000MB\r\nbench-ssd-3  compactcoin.1            9:07:35    0.98  6013.83MB 346%  4000MB\r\nbench-ssd-3  master.1                 9:17:00    1.00  5771.56MB 342%  4000MB\r\nbench-ssd-3  master.1                 9:17:24    1.00  5773.17MB 342%  4000MB\r\n\r\nbench-ssd-4  compactcoin.1            9:08:11    0.98  5936.75MB 346%  4000MB\r\nbench-ssd-4  compactcoin.1            9:07:46    0.98  5916.50MB 346%  4000MB\r\nbench-ssd-4  master.1                 9:13:56    0.99  5770.13MB 344%  4000MB\r\nbench-ssd-4  master.1                 9:17:07    1.00  5760.78MB 342%  4000MB\r\n\r\nbench-ssd-5  compactcoin.1            9:03:06    0.98  5943.29MB 349%  4000MB\r\nbench-ssd-5  compactcoin.1            9:04:24    0.98  5975.77MB 348%  4000MB\r\nbench-ssd-5  master.1                 9:11:54    1.00  5769.57MB 346%  4000MB\r\nbench-ssd-5  master.1                 9:13:56    1.00  5775.04MB 344%  4000MB\r\n\r\nbench-strong compactcoin.1            14:59:15   0.99  5710.87MB 546%  4000MB\r\nbench-strong compactcoin.1            14:59:00   0.99  5701.12MB 548%  4000MB\r\nbench-strong master.1                 15:06:04   1.00  5720.08MB 544%  4000MB\r\nbench-strong master.1                 15:04:26   1.00  5745.98MB 545%  4000MB\r\n```\r\n\r\nSee modest 1-2% improvement in runtime and (oddly) on the SSD machines I'm seeing significantly higher memory usage (usually ~200MB) for this branch.",
      "created_at" : "2019-11-12T17:09:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17060#issuecomment-552990885",
      "id" : 552990885,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17060",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1Mjk5MDg4NQ==",
      "updated_at" : "2019-11-12T17:09:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/552990885",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   }
]
