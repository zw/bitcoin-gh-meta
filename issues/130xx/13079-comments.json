[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13079#discussion_r184202451"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13079"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184202451"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "simpler to RAII this instead of a separate Constructor/Start/AnnounceStart methods?",
      "commit_id" : "409db40b6f56748a5b1713a0bc117a8365d9f3ef",
      "created_at" : "2018-04-25T20:54:11Z",
      "diff_hunk" : "@@ -1703,6 +1703,77 @@ int64_t CWallet::RescanFromTime(int64_t startTime, const WalletRescanReserver& r\n     return startTime;\n }\n \n+// Manages the log and UI progress display for CWallet::ScanForWalletTransactions\n+class RescanVerificationProgress\n+{\n+private:\n+    const CWallet& m_wallet;\n+    int64_t m_time;\n+    const CBlockIndex* m_current_block;\n+    const CBlockIndex* m_stop_block;\n+    double m_start;\n+    double m_end;\n+    double m_current;\n+\n+    double GuessProgress(const CBlockIndex* block)\n+    {\n+        AssertLockHeld(cs_main);\n+        return GuessVerificationProgress(Params().TxData(), block);\n+    }\n+\n+public:\n+    RescanVerificationProgress(const CWallet& wallet, const CBlockIndex* const stop_block)\n+        : m_wallet(wallet), m_time(GetTime()), m_stop_block(stop_block) {}\n+\n+    void Start(const CBlockIndex* const start_block)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13079#discussion_r184202451",
      "id" : 184202451,
      "original_commit_id" : "b5fe7a27377b4edfd179daf9a7c94c9cb1046c40",
      "original_position" : 26,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 115350554,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13079",
      "updated_at" : "2018-04-30T07:03:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184202451",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/195769?v=4",
         "events_url" : "https://api.github.com/users/skeees/events{/privacy}",
         "followers_url" : "https://api.github.com/users/skeees/followers",
         "following_url" : "https://api.github.com/users/skeees/following{/other_user}",
         "gists_url" : "https://api.github.com/users/skeees/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/skeees",
         "id" : 195769,
         "login" : "skeees",
         "organizations_url" : "https://api.github.com/users/skeees/orgs",
         "received_events_url" : "https://api.github.com/users/skeees/received_events",
         "repos_url" : "https://api.github.com/users/skeees/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/skeees/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/skeees/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/skeees"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13079#discussion_r184204929"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13079"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184204929"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The main reason I kept this separate is that `GuessVerificationProgress` needs `cs_main` held, and I wanted to minimize the amount of code in the lock-block.",
      "commit_id" : "409db40b6f56748a5b1713a0bc117a8365d9f3ef",
      "created_at" : "2018-04-25T21:03:11Z",
      "diff_hunk" : "@@ -1703,6 +1703,77 @@ int64_t CWallet::RescanFromTime(int64_t startTime, const WalletRescanReserver& r\n     return startTime;\n }\n \n+// Manages the log and UI progress display for CWallet::ScanForWalletTransactions\n+class RescanVerificationProgress\n+{\n+private:\n+    const CWallet& m_wallet;\n+    int64_t m_time;\n+    const CBlockIndex* m_current_block;\n+    const CBlockIndex* m_stop_block;\n+    double m_start;\n+    double m_end;\n+    double m_current;\n+\n+    double GuessProgress(const CBlockIndex* block)\n+    {\n+        AssertLockHeld(cs_main);\n+        return GuessVerificationProgress(Params().TxData(), block);\n+    }\n+\n+public:\n+    RescanVerificationProgress(const CWallet& wallet, const CBlockIndex* const stop_block)\n+        : m_wallet(wallet), m_time(GetTime()), m_stop_block(stop_block) {}\n+\n+    void Start(const CBlockIndex* const start_block)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13079#discussion_r184204929",
      "id" : 184204929,
      "in_reply_to_id" : 184202451,
      "original_commit_id" : "b5fe7a27377b4edfd179daf9a7c94c9cb1046c40",
      "original_position" : 26,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 115353588,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13079",
      "updated_at" : "2018-04-30T07:03:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184204929",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Removed the refactoring for easier review.",
      "created_at" : "2018-04-30T07:07:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13079#issuecomment-385325673",
      "id" : 385325673,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13079",
      "updated_at" : "2018-04-30T07:07:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385325673",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Makes sense. Reporting progress for partial rescans based on the given range seems to be more logical.\r\nutACK 409db40b6f56748a5b1713a0bc117a8365d9f3ef",
      "created_at" : "2018-04-30T12:05:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13079#issuecomment-385379175",
      "id" : 385379175,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13079",
      "updated_at" : "2018-04-30T12:05:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385379175",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13079#discussion_r184977046"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13079"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184977046"
         }
      },
      "author_association" : "MEMBER",
      "body" : "should probably be called `progress_end`",
      "commit_id" : "409db40b6f56748a5b1713a0bc117a8365d9f3ef",
      "created_at" : "2018-04-30T12:48:47Z",
      "diff_hunk" : "@@ -1742,9 +1742,13 @@ CBlockIndex* CWallet::ScanForWalletTransactions(CBlockIndex* pindexStart, CBlock\n         double dProgressTip;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13079#discussion_r184977046",
      "id" : 184977046,
      "original_commit_id" : "409db40b6f56748a5b1713a0bc117a8365d9f3ef",
      "original_position" : 1,
      "path" : "src/wallet/wallet.cpp",
      "position" : 1,
      "pull_request_review_id" : 116274868,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13079",
      "updated_at" : "2018-04-30T12:48:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184977046",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13079#discussion_r184977106"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13079"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184977106"
         }
      },
      "author_association" : "MEMBER",
      "body" : "missing semicolon, also wrong indentation. ",
      "commit_id" : "409db40b6f56748a5b1713a0bc117a8365d9f3ef",
      "created_at" : "2018-04-30T12:49:04Z",
      "diff_hunk" : "@@ -1742,9 +1742,13 @@ CBlockIndex* CWallet::ScanForWalletTransactions(CBlockIndex* pindexStart, CBlock\n         double dProgressTip;\n         {\n             LOCK(cs_main);\n-            tip = chainActive.Tip();\n             dProgressStart = GuessVerificationProgress(chainParams.TxData(), pindex);\n-            dProgressTip = GuessVerificationProgress(chainParams.TxData(), tip);\n+            if (pindexStop == nullptr) {\n+              tip = chainActive.Tip()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13079#discussion_r184977106",
      "id" : 184977106,
      "original_commit_id" : "409db40b6f56748a5b1713a0bc117a8365d9f3ef",
      "original_position" : 8,
      "path" : "src/wallet/wallet.cpp",
      "position" : 8,
      "pull_request_review_id" : 116274951,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13079",
      "updated_at" : "2018-04-30T12:49:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184977106",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 409db40",
      "created_at" : "2018-04-30T12:49:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13079#issuecomment-385388776",
      "id" : 385388776,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13079",
      "updated_at" : "2018-04-30T12:49:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385388776",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "From travis:\r\n```\r\nwallet/wallet.cpp: In member function Ã¢ÂÂCBlockIndex* CWallet::ScanForWalletTransactions(CBlockIndex*, CBlockIndex*, const WalletRescanReserver&, bool)Ã¢ÂÂ:\r\nwallet/wallet.cpp:1748:15: error: expected Ã¢ÂÂ;Ã¢ÂÂ before Ã¢ÂÂdProgressTipÃ¢ÂÂ\r\n               dProgressTip = GuessVerificationProgress(chainParams.TxData(), tip);\r\n               ^\r\n```",
      "created_at" : "2018-04-30T12:59:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13079#issuecomment-385391070",
      "id" : 385391070,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13079",
      "updated_at" : "2018-04-30T12:59:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385391070",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Added semicolon, renamed progress vars to `progress_*`, and clang-formatted.",
      "created_at" : "2018-04-30T14:38:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13079#issuecomment-385418230",
      "id" : 385418230,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13079",
      "updated_at" : "2018-04-30T14:38:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385418230",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased",
      "created_at" : "2018-05-03T17:20:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13079#issuecomment-386370653",
      "id" : 386370653,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13079",
      "updated_at" : "2018-05-03T17:20:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/386370653",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   }
]
