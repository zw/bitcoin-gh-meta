[
   {
      "author_association" : "MEMBER",
      "body" : "ACK https://github.com/bitcoin/bitcoin/pull/23716/commits/5b559dc7ecf37ab1604b75ec8ffe8436377a5fb1, pending CI\r\n\r\nVerified test vectors match my system's ripemd160 installation. Did not review the actual crypto.",
      "created_at" : "2021-12-08T19:48:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23716#issuecomment-989142714",
      "id" : 989142714,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23716",
      "node_id" : "IC_kwDOABII58469R66",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989142714/reactions"
      },
      "updated_at" : "2021-12-08T19:48:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989142714",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23716#discussion_r765393461"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23716"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765393461"
         }
      },
      "author_association" : "MEMBER",
      "body" : "What makes this inherently test-only?",
      "commit_id" : "5b559dc7ecf37ab1604b75ec8ffe8436377a5fb1",
      "created_at" : "2021-12-09T02:45:30Z",
      "diff_hunk" : "@@ -0,0 +1,130 @@\n+# Copyright (c) 2021 Pieter Wuille\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test-only pure Python RIPEMD160 implementation.\"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23716#discussion_r765393461",
      "id" : 765393461,
      "line" : 4,
      "node_id" : "PRRC_kwDOABII584tnvo1",
      "original_commit_id" : "5b559dc7ecf37ab1604b75ec8ffe8436377a5fb1",
      "original_line" : 4,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/ripemd160.py",
      "position" : 4,
      "pull_request_review_id" : 827151110,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23716",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765393461/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-09T02:45:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765393461",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23716#discussion_r765396525"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23716"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765396525"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's not constant time.",
      "commit_id" : "5b559dc7ecf37ab1604b75ec8ffe8436377a5fb1",
      "created_at" : "2021-12-09T02:54:45Z",
      "diff_hunk" : "@@ -0,0 +1,130 @@\n+# Copyright (c) 2021 Pieter Wuille\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test-only pure Python RIPEMD160 implementation.\"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23716#discussion_r765396525",
      "id" : 765396525,
      "in_reply_to_id" : 765393461,
      "line" : 4,
      "node_id" : "PRRC_kwDOABII584tnwYt",
      "original_commit_id" : "5b559dc7ecf37ab1604b75ec8ffe8436377a5fb1",
      "original_line" : 4,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/ripemd160.py",
      "position" : 4,
      "pull_request_review_id" : 827155016,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23716",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765396525/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-09T02:54:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765396525",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23716#discussion_r765400131"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23716"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765400131"
         }
      },
      "author_association" : "MEMBER",
      "body" : "IMO should be mentioned in the comment.",
      "commit_id" : "5b559dc7ecf37ab1604b75ec8ffe8436377a5fb1",
      "created_at" : "2021-12-09T03:06:18Z",
      "diff_hunk" : "@@ -0,0 +1,130 @@\n+# Copyright (c) 2021 Pieter Wuille\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test-only pure Python RIPEMD160 implementation.\"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23716#discussion_r765400131",
      "id" : 765400131,
      "in_reply_to_id" : 765393461,
      "line" : 4,
      "node_id" : "PRRC_kwDOABII584tnxRD",
      "original_commit_id" : "5b559dc7ecf37ab1604b75ec8ffe8436377a5fb1",
      "original_line" : 4,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/ripemd160.py",
      "position" : 4,
      "pull_request_review_id" : 827159870,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23716",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765400131/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-09T03:06:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765400131",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "After merge there will be one other remaining use of `new()`. (`git grep 'hashlib.new'`). Since it is discouraged in the python docs, we should replace that with the named constructor.\r\n\r\nGoing to merge this for our CI, but I plan to review after merge.",
      "created_at" : "2021-12-09T08:17:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23716#issuecomment-989614404",
      "id" : 989614404,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23716",
      "node_id" : "IC_kwDOABII5846_FFE",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989614404/reactions"
      },
      "updated_at" : "2021-12-09T08:18:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989614404",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23716#discussion_r765560805"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23716"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765560805"
         }
      },
      "author_association" : "MEMBER",
      "body" : "That's indeed a good warning to add in a followup.",
      "commit_id" : "5b559dc7ecf37ab1604b75ec8ffe8436377a5fb1",
      "created_at" : "2021-12-09T08:55:56Z",
      "diff_hunk" : "@@ -0,0 +1,130 @@\n+# Copyright (c) 2021 Pieter Wuille\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test-only pure Python RIPEMD160 implementation.\"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23716#discussion_r765560805",
      "id" : 765560805,
      "in_reply_to_id" : 765393461,
      "line" : 4,
      "node_id" : "PRRC_kwDOABII584toYfl",
      "original_commit_id" : "5b559dc7ecf37ab1604b75ec8ffe8436377a5fb1",
      "original_line" : 4,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/ripemd160.py",
      "position" : 4,
      "pull_request_review_id" : 827373486,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23716",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765560805/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-09T08:55:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765560805",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23716#discussion_r765850406"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23716"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765850406"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: using the `&` operator is a slightly odd way to change the sign of an integer, no?\r\n\r\nMight be better written as (119 - len&63) & 63 ?\r\n\r\n\r\nSee also https://docs.python.org/3/library/stdtypes.html#bitwise-operations-on-integer-types\r\n\r\n> Performing these calculations with at least one extra sign extension bit in a finite twoâs complement representation (a working bit-width of 1 + max(x.bit_length(), y.bit_length()) or more) is sufficient to get the same result as if there were an infinite number of sign bits.",
      "commit_id" : "5b559dc7ecf37ab1604b75ec8ffe8436377a5fb1",
      "created_at" : "2021-12-09T14:37:41Z",
      "diff_hunk" : "@@ -0,0 +1,130 @@\n+# Copyright (c) 2021 Pieter Wuille\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test-only pure Python RIPEMD160 implementation.\"\"\"\n+\n+import unittest\n+\n+# Message schedule indexes for the left path.\n+ML = [\n+    0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,\n+    7, 4, 13, 1, 10, 6, 15, 3, 12, 0, 9, 5, 2, 14, 11, 8,\n+    3, 10, 14, 4, 9, 15, 8, 1, 2, 7, 0, 6, 13, 11, 5, 12,\n+    1, 9, 11, 10, 0, 8, 12, 4, 13, 3, 7, 15, 14, 5, 6, 2,\n+    4, 0, 5, 9, 7, 12, 2, 10, 14, 1, 3, 8, 11, 6, 15, 13\n+]\n+\n+# Message schedule indexes for the right path.\n+MR = [\n+    5, 14, 7, 0, 9, 2, 11, 4, 13, 6, 15, 8, 1, 10, 3, 12,\n+    6, 11, 3, 7, 0, 13, 5, 10, 14, 15, 8, 12, 4, 9, 1, 2,\n+    15, 5, 1, 3, 7, 14, 6, 9, 11, 8, 12, 2, 10, 0, 4, 13,\n+    8, 6, 4, 1, 3, 11, 15, 0, 5, 12, 2, 13, 9, 7, 10, 14,\n+    12, 15, 10, 4, 1, 5, 8, 7, 6, 2, 13, 14, 0, 3, 9, 11\n+]\n+\n+# Rotation counts for the left path.\n+RL = [\n+    11, 14, 15, 12, 5, 8, 7, 9, 11, 13, 14, 15, 6, 7, 9, 8,\n+    7, 6, 8, 13, 11, 9, 7, 15, 7, 12, 15, 9, 11, 7, 13, 12,\n+    11, 13, 6, 7, 14, 9, 13, 15, 14, 8, 13, 6, 5, 12, 7, 5,\n+    11, 12, 14, 15, 14, 15, 9, 8, 9, 14, 5, 6, 8, 6, 5, 12,\n+    9, 15, 5, 11, 6, 8, 13, 12, 5, 12, 13, 14, 11, 8, 5, 6\n+]\n+\n+# Rotation counts for the right path.\n+RR = [\n+    8, 9, 9, 11, 13, 15, 15, 5, 7, 7, 8, 11, 14, 14, 12, 6,\n+    9, 13, 15, 7, 12, 8, 9, 11, 7, 7, 12, 7, 6, 15, 13, 11,\n+    9, 7, 15, 11, 8, 6, 6, 14, 12, 13, 5, 14, 13, 13, 7, 5,\n+    15, 5, 8, 11, 14, 14, 6, 14, 6, 9, 12, 9, 12, 5, 15, 8,\n+    8, 5, 12, 9, 12, 5, 14, 6, 8, 13, 6, 5, 15, 13, 11, 11\n+]\n+\n+# K constants for the left path.\n+KL = [0, 0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xa953fd4e]\n+\n+# K constants for the right path.\n+KR = [0x50a28be6, 0x5c4dd124, 0x6d703ef3, 0x7a6d76e9, 0]\n+\n+\n+def fi(x, y, z, i):\n+    \"\"\"The f1, f2, f3, f4, and f5 functions from the specification.\"\"\"\n+    if i == 0:\n+        return x ^ y ^ z\n+    elif i == 1:\n+        return (x & y) | (~x & z)\n+    elif i == 2:\n+        return (x | ~y) ^ z\n+    elif i == 3:\n+        return (x & z) | (y & ~z)\n+    elif i == 4:\n+        return x ^ (y | ~z)\n+    else:\n+        assert False\n+\n+\n+def rol(x, i):\n+    \"\"\"Rotate the bottom 32 bits of x left by i bits.\"\"\"\n+    return ((x << i) | ((x & 0xffffffff) >> (32 - i))) & 0xffffffff\n+\n+\n+def compress(h0, h1, h2, h3, h4, block):\n+    \"\"\"Compress state (h0, h1, h2, h3, h4) with block.\"\"\"\n+    # Left path variables.\n+    al, bl, cl, dl, el = h0, h1, h2, h3, h4\n+    # Right path variables.\n+    ar, br, cr, dr, er = h0, h1, h2, h3, h4\n+    # Message variables.\n+    x = [int.from_bytes(block[4*i:4*(i+1)], 'little') for i in range(16)]\n+\n+    # Iterate over the 80 rounds of the compression.\n+    for j in range(80):\n+        rnd = j >> 4\n+        # Perform left side of the transformation.\n+        al = rol(al + fi(bl, cl, dl, rnd) + x[ML[j]] + KL[rnd], RL[j]) + el\n+        al, bl, cl, dl, el = el, al, bl, rol(cl, 10), dl\n+        # Perform right side of the transformation.\n+        ar = rol(ar + fi(br, cr, dr, 4 - rnd) + x[MR[j]] + KR[rnd], RR[j]) + er\n+        ar, br, cr, dr, er = er, ar, br, rol(cr, 10), dr\n+\n+    # Compose old state, left transform, and right transform into new state.\n+    return h1 + cl + dr, h2 + dl + er, h3 + el + ar, h4 + al + br, h0 + bl + cr\n+\n+\n+def ripemd160(data):\n+    \"\"\"Compute the RIPEMD-160 hash of data.\"\"\"\n+    # Initialize state.\n+    state = (0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0)\n+    # Process full 64-byte blocks in the input.\n+    for b in range(len(data) >> 6):\n+        state = compress(*state, data[64*b:64*(b+1)])\n+    # Construct final blocks (with padding and size).\n+    pad = b\"\\x80\" + b\"\\x00\" * ((119 - len(data)) & 63)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23716#discussion_r765850406",
      "id" : 765850406,
      "line" : 103,
      "node_id" : "PRRC_kwDOABII584tpfMm",
      "original_commit_id" : "ad3e9e1f214d739e098c6ebbd300da5df1026a44",
      "original_line" : 103,
      "original_position" : 103,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/ripemd160.py",
      "position" : 103,
      "pull_request_review_id" : 827768798,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23716",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765850406/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-09T14:38:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765850406",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23716#discussion_r765855648"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23716"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765855648"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm happy to change it, but \"& 63\" is exactly the same as \"% 64\" but faster, and that should be sufficient here.",
      "commit_id" : "5b559dc7ecf37ab1604b75ec8ffe8436377a5fb1",
      "created_at" : "2021-12-09T14:43:09Z",
      "diff_hunk" : "@@ -0,0 +1,130 @@\n+# Copyright (c) 2021 Pieter Wuille\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test-only pure Python RIPEMD160 implementation.\"\"\"\n+\n+import unittest\n+\n+# Message schedule indexes for the left path.\n+ML = [\n+    0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,\n+    7, 4, 13, 1, 10, 6, 15, 3, 12, 0, 9, 5, 2, 14, 11, 8,\n+    3, 10, 14, 4, 9, 15, 8, 1, 2, 7, 0, 6, 13, 11, 5, 12,\n+    1, 9, 11, 10, 0, 8, 12, 4, 13, 3, 7, 15, 14, 5, 6, 2,\n+    4, 0, 5, 9, 7, 12, 2, 10, 14, 1, 3, 8, 11, 6, 15, 13\n+]\n+\n+# Message schedule indexes for the right path.\n+MR = [\n+    5, 14, 7, 0, 9, 2, 11, 4, 13, 6, 15, 8, 1, 10, 3, 12,\n+    6, 11, 3, 7, 0, 13, 5, 10, 14, 15, 8, 12, 4, 9, 1, 2,\n+    15, 5, 1, 3, 7, 14, 6, 9, 11, 8, 12, 2, 10, 0, 4, 13,\n+    8, 6, 4, 1, 3, 11, 15, 0, 5, 12, 2, 13, 9, 7, 10, 14,\n+    12, 15, 10, 4, 1, 5, 8, 7, 6, 2, 13, 14, 0, 3, 9, 11\n+]\n+\n+# Rotation counts for the left path.\n+RL = [\n+    11, 14, 15, 12, 5, 8, 7, 9, 11, 13, 14, 15, 6, 7, 9, 8,\n+    7, 6, 8, 13, 11, 9, 7, 15, 7, 12, 15, 9, 11, 7, 13, 12,\n+    11, 13, 6, 7, 14, 9, 13, 15, 14, 8, 13, 6, 5, 12, 7, 5,\n+    11, 12, 14, 15, 14, 15, 9, 8, 9, 14, 5, 6, 8, 6, 5, 12,\n+    9, 15, 5, 11, 6, 8, 13, 12, 5, 12, 13, 14, 11, 8, 5, 6\n+]\n+\n+# Rotation counts for the right path.\n+RR = [\n+    8, 9, 9, 11, 13, 15, 15, 5, 7, 7, 8, 11, 14, 14, 12, 6,\n+    9, 13, 15, 7, 12, 8, 9, 11, 7, 7, 12, 7, 6, 15, 13, 11,\n+    9, 7, 15, 11, 8, 6, 6, 14, 12, 13, 5, 14, 13, 13, 7, 5,\n+    15, 5, 8, 11, 14, 14, 6, 14, 6, 9, 12, 9, 12, 5, 15, 8,\n+    8, 5, 12, 9, 12, 5, 14, 6, 8, 13, 6, 5, 15, 13, 11, 11\n+]\n+\n+# K constants for the left path.\n+KL = [0, 0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xa953fd4e]\n+\n+# K constants for the right path.\n+KR = [0x50a28be6, 0x5c4dd124, 0x6d703ef3, 0x7a6d76e9, 0]\n+\n+\n+def fi(x, y, z, i):\n+    \"\"\"The f1, f2, f3, f4, and f5 functions from the specification.\"\"\"\n+    if i == 0:\n+        return x ^ y ^ z\n+    elif i == 1:\n+        return (x & y) | (~x & z)\n+    elif i == 2:\n+        return (x | ~y) ^ z\n+    elif i == 3:\n+        return (x & z) | (y & ~z)\n+    elif i == 4:\n+        return x ^ (y | ~z)\n+    else:\n+        assert False\n+\n+\n+def rol(x, i):\n+    \"\"\"Rotate the bottom 32 bits of x left by i bits.\"\"\"\n+    return ((x << i) | ((x & 0xffffffff) >> (32 - i))) & 0xffffffff\n+\n+\n+def compress(h0, h1, h2, h3, h4, block):\n+    \"\"\"Compress state (h0, h1, h2, h3, h4) with block.\"\"\"\n+    # Left path variables.\n+    al, bl, cl, dl, el = h0, h1, h2, h3, h4\n+    # Right path variables.\n+    ar, br, cr, dr, er = h0, h1, h2, h3, h4\n+    # Message variables.\n+    x = [int.from_bytes(block[4*i:4*(i+1)], 'little') for i in range(16)]\n+\n+    # Iterate over the 80 rounds of the compression.\n+    for j in range(80):\n+        rnd = j >> 4\n+        # Perform left side of the transformation.\n+        al = rol(al + fi(bl, cl, dl, rnd) + x[ML[j]] + KL[rnd], RL[j]) + el\n+        al, bl, cl, dl, el = el, al, bl, rol(cl, 10), dl\n+        # Perform right side of the transformation.\n+        ar = rol(ar + fi(br, cr, dr, 4 - rnd) + x[MR[j]] + KR[rnd], RR[j]) + er\n+        ar, br, cr, dr, er = er, ar, br, rol(cr, 10), dr\n+\n+    # Compose old state, left transform, and right transform into new state.\n+    return h1 + cl + dr, h2 + dl + er, h3 + el + ar, h4 + al + br, h0 + bl + cr\n+\n+\n+def ripemd160(data):\n+    \"\"\"Compute the RIPEMD-160 hash of data.\"\"\"\n+    # Initialize state.\n+    state = (0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0)\n+    # Process full 64-byte blocks in the input.\n+    for b in range(len(data) >> 6):\n+        state = compress(*state, data[64*b:64*(b+1)])\n+    # Construct final blocks (with padding and size).\n+    pad = b\"\\x80\" + b\"\\x00\" * ((119 - len(data)) & 63)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23716#discussion_r765855648",
      "id" : 765855648,
      "in_reply_to_id" : 765850406,
      "line" : 103,
      "node_id" : "PRRC_kwDOABII584tpgeg",
      "original_commit_id" : "ad3e9e1f214d739e098c6ebbd300da5df1026a44",
      "original_line" : 103,
      "original_position" : 103,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/ripemd160.py",
      "position" : 103,
      "pull_request_review_id" : 827776200,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23716",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765855648/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-09T14:43:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765855648",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23716#discussion_r765862406"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23716"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765862406"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oh it is fine. I was just commenting that `&63` also changes the sign from negative to positive.\r\n\r\nFor example if the size is `172`, then `119-172` will be negative and `&63` will make it positive.\r\n\r\nEdit: I checked that the two do the same:\r\n\r\n```py\r\n>>> all([  (119-i)&63==(119-i&63)&63  for i in range(1000000) ])\r\nTrue\r\n",
      "commit_id" : "5b559dc7ecf37ab1604b75ec8ffe8436377a5fb1",
      "created_at" : "2021-12-09T14:50:09Z",
      "diff_hunk" : "@@ -0,0 +1,130 @@\n+# Copyright (c) 2021 Pieter Wuille\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test-only pure Python RIPEMD160 implementation.\"\"\"\n+\n+import unittest\n+\n+# Message schedule indexes for the left path.\n+ML = [\n+    0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,\n+    7, 4, 13, 1, 10, 6, 15, 3, 12, 0, 9, 5, 2, 14, 11, 8,\n+    3, 10, 14, 4, 9, 15, 8, 1, 2, 7, 0, 6, 13, 11, 5, 12,\n+    1, 9, 11, 10, 0, 8, 12, 4, 13, 3, 7, 15, 14, 5, 6, 2,\n+    4, 0, 5, 9, 7, 12, 2, 10, 14, 1, 3, 8, 11, 6, 15, 13\n+]\n+\n+# Message schedule indexes for the right path.\n+MR = [\n+    5, 14, 7, 0, 9, 2, 11, 4, 13, 6, 15, 8, 1, 10, 3, 12,\n+    6, 11, 3, 7, 0, 13, 5, 10, 14, 15, 8, 12, 4, 9, 1, 2,\n+    15, 5, 1, 3, 7, 14, 6, 9, 11, 8, 12, 2, 10, 0, 4, 13,\n+    8, 6, 4, 1, 3, 11, 15, 0, 5, 12, 2, 13, 9, 7, 10, 14,\n+    12, 15, 10, 4, 1, 5, 8, 7, 6, 2, 13, 14, 0, 3, 9, 11\n+]\n+\n+# Rotation counts for the left path.\n+RL = [\n+    11, 14, 15, 12, 5, 8, 7, 9, 11, 13, 14, 15, 6, 7, 9, 8,\n+    7, 6, 8, 13, 11, 9, 7, 15, 7, 12, 15, 9, 11, 7, 13, 12,\n+    11, 13, 6, 7, 14, 9, 13, 15, 14, 8, 13, 6, 5, 12, 7, 5,\n+    11, 12, 14, 15, 14, 15, 9, 8, 9, 14, 5, 6, 8, 6, 5, 12,\n+    9, 15, 5, 11, 6, 8, 13, 12, 5, 12, 13, 14, 11, 8, 5, 6\n+]\n+\n+# Rotation counts for the right path.\n+RR = [\n+    8, 9, 9, 11, 13, 15, 15, 5, 7, 7, 8, 11, 14, 14, 12, 6,\n+    9, 13, 15, 7, 12, 8, 9, 11, 7, 7, 12, 7, 6, 15, 13, 11,\n+    9, 7, 15, 11, 8, 6, 6, 14, 12, 13, 5, 14, 13, 13, 7, 5,\n+    15, 5, 8, 11, 14, 14, 6, 14, 6, 9, 12, 9, 12, 5, 15, 8,\n+    8, 5, 12, 9, 12, 5, 14, 6, 8, 13, 6, 5, 15, 13, 11, 11\n+]\n+\n+# K constants for the left path.\n+KL = [0, 0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xa953fd4e]\n+\n+# K constants for the right path.\n+KR = [0x50a28be6, 0x5c4dd124, 0x6d703ef3, 0x7a6d76e9, 0]\n+\n+\n+def fi(x, y, z, i):\n+    \"\"\"The f1, f2, f3, f4, and f5 functions from the specification.\"\"\"\n+    if i == 0:\n+        return x ^ y ^ z\n+    elif i == 1:\n+        return (x & y) | (~x & z)\n+    elif i == 2:\n+        return (x | ~y) ^ z\n+    elif i == 3:\n+        return (x & z) | (y & ~z)\n+    elif i == 4:\n+        return x ^ (y | ~z)\n+    else:\n+        assert False\n+\n+\n+def rol(x, i):\n+    \"\"\"Rotate the bottom 32 bits of x left by i bits.\"\"\"\n+    return ((x << i) | ((x & 0xffffffff) >> (32 - i))) & 0xffffffff\n+\n+\n+def compress(h0, h1, h2, h3, h4, block):\n+    \"\"\"Compress state (h0, h1, h2, h3, h4) with block.\"\"\"\n+    # Left path variables.\n+    al, bl, cl, dl, el = h0, h1, h2, h3, h4\n+    # Right path variables.\n+    ar, br, cr, dr, er = h0, h1, h2, h3, h4\n+    # Message variables.\n+    x = [int.from_bytes(block[4*i:4*(i+1)], 'little') for i in range(16)]\n+\n+    # Iterate over the 80 rounds of the compression.\n+    for j in range(80):\n+        rnd = j >> 4\n+        # Perform left side of the transformation.\n+        al = rol(al + fi(bl, cl, dl, rnd) + x[ML[j]] + KL[rnd], RL[j]) + el\n+        al, bl, cl, dl, el = el, al, bl, rol(cl, 10), dl\n+        # Perform right side of the transformation.\n+        ar = rol(ar + fi(br, cr, dr, 4 - rnd) + x[MR[j]] + KR[rnd], RR[j]) + er\n+        ar, br, cr, dr, er = er, ar, br, rol(cr, 10), dr\n+\n+    # Compose old state, left transform, and right transform into new state.\n+    return h1 + cl + dr, h2 + dl + er, h3 + el + ar, h4 + al + br, h0 + bl + cr\n+\n+\n+def ripemd160(data):\n+    \"\"\"Compute the RIPEMD-160 hash of data.\"\"\"\n+    # Initialize state.\n+    state = (0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0)\n+    # Process full 64-byte blocks in the input.\n+    for b in range(len(data) >> 6):\n+        state = compress(*state, data[64*b:64*(b+1)])\n+    # Construct final blocks (with padding and size).\n+    pad = b\"\\x80\" + b\"\\x00\" * ((119 - len(data)) & 63)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23716#discussion_r765862406",
      "id" : 765862406,
      "in_reply_to_id" : 765850406,
      "line" : 103,
      "node_id" : "PRRC_kwDOABII584tpiIG",
      "original_commit_id" : "ad3e9e1f214d739e098c6ebbd300da5df1026a44",
      "original_line" : 103,
      "original_position" : 103,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/ripemd160.py",
      "position" : 103,
      "pull_request_review_id" : 827785802,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23716",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765862406/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-09T14:57:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765862406",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23716#discussion_r765864629"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23716"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765864629"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, the result of `&` is only negative if both inputs are negative.",
      "commit_id" : "5b559dc7ecf37ab1604b75ec8ffe8436377a5fb1",
      "created_at" : "2021-12-09T14:52:34Z",
      "diff_hunk" : "@@ -0,0 +1,130 @@\n+# Copyright (c) 2021 Pieter Wuille\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test-only pure Python RIPEMD160 implementation.\"\"\"\n+\n+import unittest\n+\n+# Message schedule indexes for the left path.\n+ML = [\n+    0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,\n+    7, 4, 13, 1, 10, 6, 15, 3, 12, 0, 9, 5, 2, 14, 11, 8,\n+    3, 10, 14, 4, 9, 15, 8, 1, 2, 7, 0, 6, 13, 11, 5, 12,\n+    1, 9, 11, 10, 0, 8, 12, 4, 13, 3, 7, 15, 14, 5, 6, 2,\n+    4, 0, 5, 9, 7, 12, 2, 10, 14, 1, 3, 8, 11, 6, 15, 13\n+]\n+\n+# Message schedule indexes for the right path.\n+MR = [\n+    5, 14, 7, 0, 9, 2, 11, 4, 13, 6, 15, 8, 1, 10, 3, 12,\n+    6, 11, 3, 7, 0, 13, 5, 10, 14, 15, 8, 12, 4, 9, 1, 2,\n+    15, 5, 1, 3, 7, 14, 6, 9, 11, 8, 12, 2, 10, 0, 4, 13,\n+    8, 6, 4, 1, 3, 11, 15, 0, 5, 12, 2, 13, 9, 7, 10, 14,\n+    12, 15, 10, 4, 1, 5, 8, 7, 6, 2, 13, 14, 0, 3, 9, 11\n+]\n+\n+# Rotation counts for the left path.\n+RL = [\n+    11, 14, 15, 12, 5, 8, 7, 9, 11, 13, 14, 15, 6, 7, 9, 8,\n+    7, 6, 8, 13, 11, 9, 7, 15, 7, 12, 15, 9, 11, 7, 13, 12,\n+    11, 13, 6, 7, 14, 9, 13, 15, 14, 8, 13, 6, 5, 12, 7, 5,\n+    11, 12, 14, 15, 14, 15, 9, 8, 9, 14, 5, 6, 8, 6, 5, 12,\n+    9, 15, 5, 11, 6, 8, 13, 12, 5, 12, 13, 14, 11, 8, 5, 6\n+]\n+\n+# Rotation counts for the right path.\n+RR = [\n+    8, 9, 9, 11, 13, 15, 15, 5, 7, 7, 8, 11, 14, 14, 12, 6,\n+    9, 13, 15, 7, 12, 8, 9, 11, 7, 7, 12, 7, 6, 15, 13, 11,\n+    9, 7, 15, 11, 8, 6, 6, 14, 12, 13, 5, 14, 13, 13, 7, 5,\n+    15, 5, 8, 11, 14, 14, 6, 14, 6, 9, 12, 9, 12, 5, 15, 8,\n+    8, 5, 12, 9, 12, 5, 14, 6, 8, 13, 6, 5, 15, 13, 11, 11\n+]\n+\n+# K constants for the left path.\n+KL = [0, 0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xa953fd4e]\n+\n+# K constants for the right path.\n+KR = [0x50a28be6, 0x5c4dd124, 0x6d703ef3, 0x7a6d76e9, 0]\n+\n+\n+def fi(x, y, z, i):\n+    \"\"\"The f1, f2, f3, f4, and f5 functions from the specification.\"\"\"\n+    if i == 0:\n+        return x ^ y ^ z\n+    elif i == 1:\n+        return (x & y) | (~x & z)\n+    elif i == 2:\n+        return (x | ~y) ^ z\n+    elif i == 3:\n+        return (x & z) | (y & ~z)\n+    elif i == 4:\n+        return x ^ (y | ~z)\n+    else:\n+        assert False\n+\n+\n+def rol(x, i):\n+    \"\"\"Rotate the bottom 32 bits of x left by i bits.\"\"\"\n+    return ((x << i) | ((x & 0xffffffff) >> (32 - i))) & 0xffffffff\n+\n+\n+def compress(h0, h1, h2, h3, h4, block):\n+    \"\"\"Compress state (h0, h1, h2, h3, h4) with block.\"\"\"\n+    # Left path variables.\n+    al, bl, cl, dl, el = h0, h1, h2, h3, h4\n+    # Right path variables.\n+    ar, br, cr, dr, er = h0, h1, h2, h3, h4\n+    # Message variables.\n+    x = [int.from_bytes(block[4*i:4*(i+1)], 'little') for i in range(16)]\n+\n+    # Iterate over the 80 rounds of the compression.\n+    for j in range(80):\n+        rnd = j >> 4\n+        # Perform left side of the transformation.\n+        al = rol(al + fi(bl, cl, dl, rnd) + x[ML[j]] + KL[rnd], RL[j]) + el\n+        al, bl, cl, dl, el = el, al, bl, rol(cl, 10), dl\n+        # Perform right side of the transformation.\n+        ar = rol(ar + fi(br, cr, dr, 4 - rnd) + x[MR[j]] + KR[rnd], RR[j]) + er\n+        ar, br, cr, dr, er = er, ar, br, rol(cr, 10), dr\n+\n+    # Compose old state, left transform, and right transform into new state.\n+    return h1 + cl + dr, h2 + dl + er, h3 + el + ar, h4 + al + br, h0 + bl + cr\n+\n+\n+def ripemd160(data):\n+    \"\"\"Compute the RIPEMD-160 hash of data.\"\"\"\n+    # Initialize state.\n+    state = (0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0)\n+    # Process full 64-byte blocks in the input.\n+    for b in range(len(data) >> 6):\n+        state = compress(*state, data[64*b:64*(b+1)])\n+    # Construct final blocks (with padding and size).\n+    pad = b\"\\x80\" + b\"\\x00\" * ((119 - len(data)) & 63)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23716#discussion_r765864629",
      "id" : 765864629,
      "in_reply_to_id" : 765850406,
      "line" : 103,
      "node_id" : "PRRC_kwDOABII584tpiq1",
      "original_commit_id" : "ad3e9e1f214d739e098c6ebbd300da5df1026a44",
      "original_line" : 103,
      "original_position" : 103,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/ripemd160.py",
      "position" : 103,
      "pull_request_review_id" : 827789068,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23716",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765864629/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-09T14:52:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/765864629",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23716#discussion_r863787014"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23716"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/863787014"
         }
      },
      "author_association" : "NONE",
      "body" : "> It's not constant time.\r\n\r\nGiven that its only use in Bitcoin is `ripemd160(sha256(data))`, does this not make a timing attack effectively useless?\r\n",
      "commit_id" : "5b559dc7ecf37ab1604b75ec8ffe8436377a5fb1",
      "created_at" : "2022-05-03T13:37:59Z",
      "diff_hunk" : "@@ -0,0 +1,130 @@\n+# Copyright (c) 2021 Pieter Wuille\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test-only pure Python RIPEMD160 implementation.\"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23716#discussion_r863787014",
      "id" : 863787014,
      "in_reply_to_id" : 765393461,
      "line" : 4,
      "node_id" : "PRRC_kwDOABII584zfFgG",
      "original_commit_id" : "5b559dc7ecf37ab1604b75ec8ffe8436377a5fb1",
      "original_line" : 4,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/ripemd160.py",
      "position" : 4,
      "pull_request_review_id" : 960400695,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23716",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/863787014/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-03T13:37:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/863787014",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6071028?v=4",
         "events_url" : "https://api.github.com/users/mmgen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mmgen/followers",
         "following_url" : "https://api.github.com/users/mmgen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mmgen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mmgen",
         "id" : 6071028,
         "login" : "mmgen",
         "node_id" : "MDQ6VXNlcjYwNzEwMjg=",
         "organizations_url" : "https://api.github.com/users/mmgen/orgs",
         "received_events_url" : "https://api.github.com/users/mmgen/received_events",
         "repos_url" : "https://api.github.com/users/mmgen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mmgen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mmgen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mmgen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23716#discussion_r863789458"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23716"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/863789458"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@mmgen Yes, but it's open-source code, and open-source code gets copied and can end up being adopted for other purposes. ",
      "commit_id" : "5b559dc7ecf37ab1604b75ec8ffe8436377a5fb1",
      "created_at" : "2022-05-03T13:39:44Z",
      "diff_hunk" : "@@ -0,0 +1,130 @@\n+# Copyright (c) 2021 Pieter Wuille\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test-only pure Python RIPEMD160 implementation.\"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23716#discussion_r863789458",
      "id" : 863789458,
      "in_reply_to_id" : 765393461,
      "line" : 4,
      "node_id" : "PRRC_kwDOABII584zfGGS",
      "original_commit_id" : "5b559dc7ecf37ab1604b75ec8ffe8436377a5fb1",
      "original_line" : 4,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/ripemd160.py",
      "position" : 4,
      "pull_request_review_id" : 960403111,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23716",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/863789458/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-03T13:39:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/863789458",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for this! I've ported to python 2 and integrated into pycoin here https://github.com/richardkiss/pycoin/commit/6b3e4bb3eeba4c41c33816533f7c52bbae7a6142",
      "created_at" : "2022-05-29T22:15:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23716#issuecomment-1140534531",
      "id" : 1140534531,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23716",
      "node_id" : "IC_kwDOABII585D-y0D",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1140534531/reactions"
      },
      "updated_at" : "2022-05-29T22:15:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1140534531",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5336?v=4",
         "events_url" : "https://api.github.com/users/richardkiss/events{/privacy}",
         "followers_url" : "https://api.github.com/users/richardkiss/followers",
         "following_url" : "https://api.github.com/users/richardkiss/following{/other_user}",
         "gists_url" : "https://api.github.com/users/richardkiss/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/richardkiss",
         "id" : 5336,
         "login" : "richardkiss",
         "node_id" : "MDQ6VXNlcjUzMzY=",
         "organizations_url" : "https://api.github.com/users/richardkiss/orgs",
         "received_events_url" : "https://api.github.com/users/richardkiss/received_events",
         "repos_url" : "https://api.github.com/users/richardkiss/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/richardkiss/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/richardkiss/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/richardkiss"
      }
   }
]
