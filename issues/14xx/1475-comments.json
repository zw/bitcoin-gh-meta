[
   {
      "body" : "It's hard to test when testnet isn't working that good on my computer.",
      "created_at" : "2012-06-17T18:07:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1475#issuecomment-6383261",
      "id" : 6383261,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1475",
      "updated_at" : "2012-06-17T18:07:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6383261",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1719626?v=3",
         "events_url" : "https://api.github.com/users/burger2/events{/privacy}",
         "followers_url" : "https://api.github.com/users/burger2/followers",
         "following_url" : "https://api.github.com/users/burger2/following{/other_user}",
         "gists_url" : "https://api.github.com/users/burger2/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/burger2",
         "id" : 1719626,
         "login" : "burger2",
         "organizations_url" : "https://api.github.com/users/burger2/orgs",
         "received_events_url" : "https://api.github.com/users/burger2/received_events",
         "repos_url" : "https://api.github.com/users/burger2/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/burger2/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/burger2/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/burger2"
      }
   },
   {
      "body" : "I don't think this is the right solution. The view classes (Overviewpage, SendCoinsDialog, ...) should not be burdened with implementation details such as new blocks coming in. As I understand, there is a problem with WalletModel not sending the BalanceUpdated signal every time the Balance changes. Hence, this should be fixed in WalletModel.\n\nThe problem seems to be that some kind of transactions (the \"mined\" ones) need to be baby-sitted for at least 120 blocks until they mature (normal transactions for 6, but this is correctly handled). However, re-computing the balance and updating the UI every time a block comes in also isn't a good solution as this may go very fast. This needs a timer (invoked only a few times per second) that recomputes the balance and issues a BalanceChanged signal if needed...\n\nTangential: Can you try to keep 1) changes in which you rename all kinds of stuff and 2) functional changes separate? Mixing these makes it very hard to review code changes. Commits of type 1 can be verbose, whereas commits of type 2 should be as minimal as possible, especially if you make changes to the core as well as the UI.\n\n",
      "created_at" : "2012-06-17T18:34:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1475#issuecomment-6383517",
      "id" : 6383517,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1475",
      "updated_at" : "2012-06-17T18:34:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6383517",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@burger2 To fix your testnet problems try out #1477. Current master has a bug, which gives all testnet nodes on IRC the same NICK, which causes the current testnet3 troubles.\n\n@laanwj I think the immature balance, which then matures after 120 blocks is not taken correctly into account in terms of the ``balanceChanged`` signal. The state change from immature to mature, which also changes the current balance then, is not triggered by a transaction, so the emited ``balanceChanged`` signal in ``WalletModel::updateTransaction()`` does not help here. That's why I introduced a mechanism, which uses block-changes for this. If you have a cleaner / better idea I'm fine with a simpler patch :). The re-name was a logical thing for me here, because there are now 2 models in overviepage and sendcoinsdialog, so only e.g. ``setModel`` is missleading. I guess a timer is not needed if I add a check for ``IsInitialBlockDownload()`` in the code, as with a catched-up chain the processing won't happen that often.",
      "created_at" : "2012-06-17T19:41:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1475#issuecomment-6384053",
      "id" : 6384053,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1475",
      "updated_at" : "2012-06-17T19:41:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6384053",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "Yes, I'm going to implement this differently. This should really be restricted to WalletModel. It's indeed true that the balanceChanged signal in updateTransaction does not help here, but it could be emitted from different places as well. Having a non-functional balanceChanged signal and working around that means confusion for future updates, you should simply be able to connect to balanceChanged and have the most recent balance.\n\nThen, OverviewPage and SendcoinsDialog don't need the client model and everything there can be kept the same. \n",
      "created_at" : "2012-06-17T19:51:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1475#issuecomment-6384124",
      "id" : 6384124,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1475",
      "updated_at" : "2012-06-17T19:51:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6384124",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "That's fine, if you are currently working on a patch I'm going to stop further progress here. What about the changes to wallet and walletmodel? I'll quote myself:\n\nI'm sure the current call to GetCredit(pcoin) can't be correct, as it does:\n\n<pre>\nif (IsCoinBase() && GetBlocksToMaturity() > 0)\n            return 0;\n</pre>\n\nAnd this is the opposite of what we need for the immature coins, right?",
      "created_at" : "2012-06-17T20:50:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1475#issuecomment-6384590",
      "id" : 6384590,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1475",
      "updated_at" : "2012-06-17T20:50:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6384590",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "I'm not particularly known with that part of the code, but what do you think is wrong? To me, it reads like\n\"If this is a coin-base (mined), *and* there are more than 0 blocks left to maturity, the credit is 0\". Which makes sense to me.\n",
      "created_at" : "2012-06-17T21:02:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1475#issuecomment-6384732",
      "id" : 6384732,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1475",
      "updated_at" : "2012-06-17T21:02:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6384732",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "It does a ``return 0;`` for the conditions we want to be true for adding immature coins together. Need to double check...",
      "created_at" : "2012-06-17T21:09:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1475#issuecomment-6384806",
      "id" : 6384806,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1475",
      "updated_at" : "2012-06-17T21:13:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6384806",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "The current master code uses GetCredit() from CWallet, while I added GetImmatureCredit() into CWalletTx, which I think fit's better in there, as it's similar to CWallet::GetBalance() and CWallet::GetUnconfirmedBalance(). But you are probably right and the current code works.",
      "created_at" : "2012-06-17T21:19:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1475#issuecomment-6384909",
      "id" : 6384909,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1475",
      "updated_at" : "2012-06-17T21:19:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6384909",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "@laanwj I showed sipa the code, who also thinks the new function (CWallet::GetUnconfirmedBalance()) is cleaner ... but as this is unrelated to fixing the base-issue, I will create another pull and close this one!",
      "created_at" : "2012-06-17T21:33:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1475#issuecomment-6385060",
      "id" : 6385060,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1475",
      "updated_at" : "2012-06-17T21:33:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6385060",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "The change in WalletModel also makes sense (makes it somewhat more readable). The only thing I don't agree with are the changes in the views.\n",
      "created_at" : "2012-06-18T05:38:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1475#issuecomment-6388283",
      "id" : 6388283,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1475",
      "updated_at" : "2012-06-18T05:38:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6388283",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "That's fine, I'll open a new one and you patch the signal thing :).",
      "created_at" : "2012-06-18T06:13:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1475#issuecomment-6388610",
      "id" : 6388610,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1475",
      "updated_at" : "2012-06-18T06:13:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6388610",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "@laanwj Is your fix on track for 0.7, any branch you want me to test?",
      "created_at" : "2012-06-20T13:16:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1475#issuecomment-6453511",
      "id" : 6453511,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1475",
      "updated_at" : "2012-06-20T13:16:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6453511",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   }
]
