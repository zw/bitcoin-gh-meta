{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "### Is there an existing issue for this?\r\n\r\n- [X] I have searched the existing issues\r\n\r\n### Current behaviour\r\n\r\nThe WalletCreateTxUsePresetInputsAndCoinSelection benchmark crashes on master due to the commit 758501b71391136c33b525b1a0109b990d4f463e introduced in #25273 (I used git bisect to verify).\r\n\r\n```\r\nvalgrind ./src/bench/bench_bitcoin -filter=WalletCreateTxUsePresetInputsAndCoinSelection -min-time=10000\r\n==34277== Memcheck, a memory error detector\r\n==34277== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\r\n==34277== Using Valgrind-3.18.1 and LibVEX; rerun with -h for copyright info\r\n==34277== Command: ./src/bench/bench_bitcoin -filter=WalletCreateTxUsePresetInputsAndCoinSelection -min-time=10000\r\n==34277==\r\nbench_bitcoin: bench/wallet_create_tx.cpp:135: WalletCreateTx(ankerl::nanobench::Bench&, OutputType, bool, std::optional<PreSelectInputs>)::<lambda()>: Assertion `tx_res' failed.\r\n==34277==\r\n==34277== Process terminating with default action of signal 6 (SIGABRT)\r\n==34277==    at 0x4DD79FC: __pthread_kill_implementation (pthread_kill.c:44)\r\n==34277==    by 0x4DD79FC: __pthread_kill_internal (pthread_kill.c:78)\r\n==34277==    by 0x4DD79FC: pthread_kill@@GLIBC_2.34 (pthread_kill.c:89)\r\n==34277==    by 0x4D83475: raise (raise.c:26)\r\n==34277==    by 0x4D697F2: abort (abort.c:79)\r\n==34277==    by 0x4D6971A: __assert_fail_base.cold (assert.c:92)\r\n==34277==    by 0x4D7AE95: __assert_fail (assert.c:101)\r\n==34277==    by 0x29607B: operator() (wallet_create_tx.cpp:135)\r\n==34277==    by 0x29607B: ankerl::nanobench::Bench& ankerl::nanobench::Bench::run<WalletCreateTx(ankerl::nanobench::Bench&, OutputType, bool, std::optional<PreSelectInputs>)::{lambda()#3}>(WalletCreateTx(ankerl::nanobench::Bench&, OutputType, bool, std::optional<PreSelectInputs>)::{lambda()#3}&&) [clone .isra.0] (nanobench.h:1221)\r\n==34277==    by 0x297F81: WalletCreateTx(ankerl::nanobench::Bench&, OutputType, bool, std::optional<PreSelectInputs>) [clone .constprop.0] [clone .isra.0] (wallet_create_tx.cpp:132)\r\n==34277==    by 0x21B74A: operator() (std_function.h:590)\r\n==34277==    by 0x21B74A: benchmark::BenchRunner::RunAll(benchmark::Args const&) (bench.cpp:119)\r\n==34277==    by 0x1F8B96: main (bench_bitcoin.cpp:132)\r\n==34277==\r\n==34277== HEAP SUMMARY:\r\n==34277==     in use at exit: 48,159,834 bytes in 72,552 blocks\r\n==34277==   total heap usage: 1,668,158 allocs, 1,595,606 frees, 552,252,252 bytes allocated\r\n==34277==\r\n==34277== LEAK SUMMARY:\r\n==34277==    definitely lost: 0 bytes in 0 blocks\r\n==34277==    indirectly lost: 0 bytes in 0 blocks\r\n==34277==      possibly lost: 912 bytes in 3 blocks\r\n==34277==    still reachable: 48,158,922 bytes in 72,549 blocks\r\n==34277==         suppressed: 0 bytes in 0 blocks\r\n==34277== Rerun with --leak-check=full to see details of leaked memory\r\n==34277==\r\n==34277== For lists of detected and suppressed errors, rerun with: -s\r\n==34277== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\r\nAborted\r\n```\r\n\r\n### Expected behaviour\r\n\r\nNo crash\r\n\r\n### Steps to reproduce\r\n\r\n`git checkout master && make -j$(nproc)`\r\n`valgrind ./src/bench/bench_bitcoin -filter=WalletCreateTxUsePresetInputsAndCoinSelection -min-time=10000`\r\n\r\n### Relevant log output\r\n\r\n_No response_\r\n\r\n### How did you obtain Bitcoin Core\r\n\r\nCompiled from source\r\n\r\n### What version of Bitcoin Core are you using?\r\n\r\nmaster@758501b71391136c33b525b1a0109b990d4f463e\r\n\r\n### Operating system and version\r\n\r\nUbuntu 22.04.3 LTS\r\n\r\n### Machine specifications\r\n\r\n_No response_",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 8,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29061/comments",
   "created_at" : "2023-12-12T14:21:52Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29061/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/29061",
   "id" : 2037860377,
   "labels" : [
      {
         "color" : "08a781",
         "default" : false,
         "description" : null,
         "id" : 149424,
         "name" : "Wallet",
         "node_id" : "MDU6TGFiZWwxNDk0MjQ=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet"
      },
      {
         "color" : "d4c5f9",
         "default" : false,
         "description" : null,
         "id" : 62963516,
         "name" : "Tests",
         "node_id" : "MDU6TGFiZWw2Mjk2MzUxNg==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29061/labels{/name}",
   "locked" : false,
   "milestone" : {
      "closed_at" : null,
      "closed_issues" : 22,
      "created_at" : "2023-04-27T08:01:57Z",
      "creator" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      },
      "description" : "",
      "due_on" : null,
      "html_url" : "https://github.com/bitcoin/bitcoin/milestone/61",
      "id" : 9334188,
      "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/milestones/61/labels",
      "node_id" : "MI_kwDOABII584Ajm2s",
      "number" : 61,
      "open_issues" : 9,
      "state" : "open",
      "title" : "27.0",
      "updated_at" : "2023-12-12T14:26:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/milestones/61"
   },
   "node_id" : "I_kwDOABII5855d0gZ",
   "number" : 29061,
   "performed_via_github_app" : null,
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29061/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "state_reason" : null,
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29061/timeline",
   "title" : "Benchmark WalletCreateTxUsePresetInputsAndCoinSelection crashes due to #25273",
   "updated_at" : "2023-12-12T14:51:08Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29061",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
      "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
      "followers_url" : "https://api.github.com/users/aureleoules/followers",
      "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
      "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/aureleoules",
      "id" : 22493292,
      "login" : "aureleoules",
      "node_id" : "MDQ6VXNlcjIyNDkzMjky",
      "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
      "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
      "repos_url" : "https://api.github.com/users/aureleoules/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/aureleoules"
   }
}
