[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#27010](https://github.com/bitcoin/bitcoin/pull/27010) (refactor: use `Hash` helpers for double-SHA256 calculations by theStack)\n* [#26966](https://github.com/bitcoin/bitcoin/pull/26966) (index: blockfilter initial sync speedup, parallelize process by furszy)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2022-10-26T11:01:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26390#issuecomment-1291859968",
      "id" : 1291859968,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26390",
      "node_id" : "IC_kwDOABII585NADgA",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1291859968/reactions"
      },
      "updated_at" : "2023-04-25T15:20:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1291859968",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-02-01T16:01:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26390#issuecomment-1412304097",
      "id" : 1412304097,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26390",
      "node_id" : "IC_kwDOABII585ULgzh",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1412304097/reactions"
      },
      "updated_at" : "2023-02-01T16:01:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1412304097",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Are you still working on this?",
      "created_at" : "2023-04-25T15:20:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26390#issuecomment-1521985512",
      "id" : 1521985512,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26390",
      "node_id" : "IC_kwDOABII585at6fo",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1521985512/reactions"
      },
      "updated_at" : "2023-04-25T15:20:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1521985512",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Are you still working on this?\r\n\r\nIs there any interest for the PR itself? It's not much but you can get additional assurance that the blockfilter stored on disk is not corrupted.\r\n\r\nI can rebase if there's interest in that feature.",
      "created_at" : "2023-04-26T04:53:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26390#issuecomment-1522778737",
      "id" : 1522778737,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26390",
      "node_id" : "IC_kwDOABII585aw8Jx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1522778737/reactions"
      },
      "updated_at" : "2023-04-26T04:53:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1522778737",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/37185887?v=4",
         "events_url" : "https://api.github.com/users/kcalvinalvin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kcalvinalvin/followers",
         "following_url" : "https://api.github.com/users/kcalvinalvin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kcalvinalvin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kcalvinalvin",
         "id" : 37185887,
         "login" : "kcalvinalvin",
         "node_id" : "MDQ6VXNlcjM3MTg1ODg3",
         "organizations_url" : "https://api.github.com/users/kcalvinalvin/orgs",
         "received_events_url" : "https://api.github.com/users/kcalvinalvin/received_events",
         "repos_url" : "https://api.github.com/users/kcalvinalvin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kcalvinalvin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kcalvinalvin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kcalvinalvin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "yeah @kcalvinalvin, please rebase it. Will check it asap.",
      "created_at" : "2023-04-26T09:30:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26390#issuecomment-1523092479",
      "id" : 1523092479,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26390",
      "node_id" : "IC_kwDOABII585ayIv_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1523092479/reactions"
      },
      "updated_at" : "2023-04-26T09:30:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1523092479",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased on master\r\n\r\nDiffs between the relevant files:\r\n\r\nFor `blockfilter.h`:\r\n```diff\r\n[I] calvin@bitcoin ~/b/c/l/bitcoin (2022-07-13-blockfilter-check-block-hash)> git diff a2884a6c3f874c7fd16626a31557fcfb852b39bf src/index/blockfilterindex.h\r\ndiff --git a/src/index/blockfilterindex.h b/src/index/blockfilterindex.h\r\nindex 0afee01a74..9a651dcb1c 100644\r\n--- a/src/index/blockfilterindex.h\r\n+++ b/src/index/blockfilterindex.h\r\n@@ -1,4 +1,4 @@\r\n-// Copyright (c) 2018-2021 The Bitcoin Core developers\r\n+// Copyright (c) 2018-2022 The Bitcoin Core developers\r\n // Distributed under the MIT software license, see the accompanying\r\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\r\n ```\r\n \r\nFor `blockfilter.cpp`:\r\n ```diff\r\n[I] calvin@bitcoin ~/b/c/l/bitcoin (2022-07-13-blockfilter-check-block-hash)> git diff a2884a6c3f874c7fd16626a31557fcfb852b39bf src/index/blockfilterindex.cpp\r\ndiff --git a/src/index/blockfilterindex.cpp b/src/index/blockfilterindex.cpp\r\nindex cb503664be..94a7351c72 100644\r\n--- a/src/index/blockfilterindex.cpp\r\n+++ b/src/index/blockfilterindex.cpp\r\n@@ -1,14 +1,15 @@\r\n-// Copyright (c) 2018-2021 The Bitcoin Core developers\r\n+// Copyright (c) 2018-2022 The Bitcoin Core developers\r\n // Distributed under the MIT software license, see the accompanying\r\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\r\n \r\n #include <map>\r\n \r\n+#include <common/args.h>\r\n #include <dbwrapper.h>\r\n #include <hash.h>\r\n #include <index/blockfilterindex.h>\r\n #include <node/blockstorage.h>\r\n-#include <util/system.h>\r\n+#include <util/fs_helpers.h>\r\n #include <validation.h>\r\n \r\n using node::UndoReadFromDisk;\r\n@@ -158,9 +159,7 @@ bool BlockFilterIndex::ReadFilterFromDisk(const FlatFilePos& pos, const uint256&\r\n     try {\r\n         filein >> read_block_hash >> encoded_filter;\r\n         if (read_block_hash != block_hash) return error(\"Checksum mismatch in filter decode.\");\r\n-        uint256 result;\r\n-        CHash256().Write(encoded_filter).Finalize(result);\r\n-        if (result != hash) return error(\"Checksum mismatch in filter decode.\");\r\n+        if (Hash(encoded_filter) != hash) return error(\"Checksum mismatch in filter decode.\");\r\n         filter = BlockFilter(GetFilterType(), block_hash, std::move(encoded_filter), /*skip_decode_check=*/true);\r\n     }\r\n     catch (const std::exception& e) {\r\n```",
      "created_at" : "2023-04-30T15:51:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26390#issuecomment-1529058465",
      "id" : 1529058465,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26390",
      "node_id" : "IC_kwDOABII585bI5Sh",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1529058465/reactions"
      },
      "updated_at" : "2023-04-30T15:57:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1529058465",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/37185887?v=4",
         "events_url" : "https://api.github.com/users/kcalvinalvin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kcalvinalvin/followers",
         "following_url" : "https://api.github.com/users/kcalvinalvin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kcalvinalvin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kcalvinalvin",
         "id" : 37185887,
         "login" : "kcalvinalvin",
         "node_id" : "MDQ6VXNlcjM3MTg1ODg3",
         "organizations_url" : "https://api.github.com/users/kcalvinalvin/orgs",
         "received_events_url" : "https://api.github.com/users/kcalvinalvin/received_events",
         "repos_url" : "https://api.github.com/users/kcalvinalvin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kcalvinalvin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kcalvinalvin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kcalvinalvin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26390#discussion_r1181267848"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26390"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181267848"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit:\r\nBetter if we call it `expected_block_hash`, and also rename the one called `hash` to `filter_hash`.",
      "commit_id" : "86676411232faa6554ed70737559ad419c311396",
      "created_at" : "2023-04-30T17:38:49Z",
      "diff_hunk" : "@@ -146,18 +146,19 @@ bool BlockFilterIndex::CustomCommit(CDBBatch& batch)\n     return true;\n }\n \n-bool BlockFilterIndex::ReadFilterFromDisk(const FlatFilePos& pos, const uint256& hash, BlockFilter& filter) const\n+bool BlockFilterIndex::ReadFilterFromDisk(const FlatFilePos& pos, const uint256& hash, const uint256& block_hash, BlockFilter& filter) const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26390#discussion_r1181267848",
      "id" : 1181267848,
      "line" : 149,
      "node_id" : "PRRC_kwDOABII585GaLeI",
      "original_commit_id" : "86676411232faa6554ed70737559ad419c311396",
      "original_line" : 149,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/index/blockfilterindex.cpp",
      "position" : 5,
      "pull_request_review_id" : 1407151959,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26390",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181267848/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-30T17:58:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181267848",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26390#discussion_r1181267954"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26390"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181267954"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This error would be easier to debug if it logs an specific error like \"Block hash mismatch in filter decode\" (it's currently logging the same error as a filter hash mismatch). \r\n\r\nPlus, could leave this as it was before if the new arg is called `expected_block_hash` (no need to do the `read_block_hash` rename).",
      "commit_id" : "86676411232faa6554ed70737559ad419c311396",
      "created_at" : "2023-04-30T17:40:04Z",
      "diff_hunk" : "@@ -146,18 +146,19 @@ bool BlockFilterIndex::CustomCommit(CDBBatch& batch)\n     return true;\n }\n \n-bool BlockFilterIndex::ReadFilterFromDisk(const FlatFilePos& pos, const uint256& hash, BlockFilter& filter) const\n+bool BlockFilterIndex::ReadFilterFromDisk(const FlatFilePos& pos, const uint256& hash, const uint256& block_hash, BlockFilter& filter) const\n {\n     AutoFile filein{m_filter_fileseq->Open(pos, true)};\n     if (filein.IsNull()) {\n         return false;\n     }\n \n     // Check that the hash of the encoded_filter matches the one stored in the db.\n-    uint256 block_hash;\n+    uint256 read_block_hash;\n     std::vector<uint8_t> encoded_filter;\n     try {\n-        filein >> block_hash >> encoded_filter;\n+        filein >> read_block_hash >> encoded_filter;\n+        if (read_block_hash != block_hash) return error(\"Checksum mismatch in filter decode.\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26390#discussion_r1181267954",
      "id" : 1181267954,
      "line" : 161,
      "node_id" : "PRRC_kwDOABII585GaLfy",
      "original_commit_id" : "86676411232faa6554ed70737559ad419c311396",
      "original_line" : 161,
      "original_position" : 19,
      "original_start_line" : 157,
      "path" : "src/index/blockfilterindex.cpp",
      "position" : 19,
      "pull_request_review_id" : 1407151959,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26390",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181267954/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 157,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-04-30T17:59:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181267954",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26390#discussion_r1181268939"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26390"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181268939"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Could use structured bindings:\r\n```c++\r\nfor (const auto& [block_hash, filter] : entries) {\r\n    if (!ReadFilterFromDisk(filter.pos, filter.hash, block_hash, *filter_pos_it)) {\r\n```\r\n\r\n(Same below)",
      "commit_id" : "86676411232faa6554ed70737559ad419c311396",
      "created_at" : "2023-04-30T17:48:33Z",
      "diff_hunk" : "@@ -423,15 +426,15 @@ bool BlockFilterIndex::LookupFilterHeader(const CBlockIndex* block_index, uint25\n bool BlockFilterIndex::LookupFilterRange(int start_height, const CBlockIndex* stop_index,\n                                          std::vector<BlockFilter>& filters_out) const\n {\n-    std::vector<DBVal> entries;\n+    std::vector<std::pair<uint256, DBVal>> entries;\n     if (!LookupRange(*m_db, m_name, start_height, stop_index, entries)) {\n         return false;\n     }\n \n     filters_out.resize(entries.size());\n     auto filter_pos_it = filters_out.begin();\n     for (const auto& entry : entries) {\n-        if (!ReadFilterFromDisk(entry.pos, entry.hash, *filter_pos_it)) {\n+        if (!ReadFilterFromDisk(entry.second.pos, entry.second.hash, entry.first, *filter_pos_it)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26390#discussion_r1181268939",
      "id" : 1181268939,
      "line" : 437,
      "node_id" : "PRRC_kwDOABII585GaLvL",
      "original_commit_id" : "86676411232faa6554ed70737559ad419c311396",
      "original_line" : 437,
      "original_position" : 74,
      "original_start_line" : 436,
      "path" : "src/index/blockfilterindex.cpp",
      "position" : 74,
      "pull_request_review_id" : 1407151959,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26390",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181268939/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 436,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-04-30T17:58:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181268939",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26390#discussion_r1181270062"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26390"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181270062"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Wouldn't hurt to add a comment for this. By reading only the function's signature, it's not clear what the uin256 is.",
      "commit_id" : "86676411232faa6554ed70737559ad419c311396",
      "created_at" : "2023-04-30T17:58:12Z",
      "diff_hunk" : "@@ -326,7 +327,7 @@ static bool LookupOne(const CDBWrapper& db, const CBlockIndex* block_index, DBVa\n }\n \n static bool LookupRange(CDBWrapper& db, const std::string& index_name, int start_height,\n-                        const CBlockIndex* stop_index, std::vector<DBVal>& results)\n+                        const CBlockIndex* stop_index, std::vector<std::pair<uint256, DBVal>>& results)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26390#discussion_r1181270062",
      "id" : 1181270062,
      "line" : 330,
      "node_id" : "PRRC_kwDOABII585GaMAu",
      "original_commit_id" : "86676411232faa6554ed70737559ad419c311396",
      "original_line" : 330,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/index/blockfilterindex.cpp",
      "position" : 28,
      "pull_request_review_id" : 1407151959,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26390",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181270062/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-30T17:58:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181270062",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   }
]
