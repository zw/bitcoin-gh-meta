[
   {
      "author_association" : "MEMBER",
      "body" : "This may happen when one of the blocks in the main chain is marked invalid (for example due to corruption)",
      "created_at" : "2022-10-26T08:34:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26391#issuecomment-1291688405",
      "id" : 1291688405,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26391",
      "node_id" : "IC_kwDOABII585M_ZnV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1291688405/reactions"
      },
      "updated_at" : "2022-10-26T08:34:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1291688405",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Your `debug.log` shows that before seeing this behavior you were doing IBD up until `height=224854` were this happened, which I think matches what MarcoFalke said.\r\n```\r\n2022-10-26T07:24:30Z UpdateTip: new best=00000000000000cd7d1c3d5137423c00e6a221d5492ace06d8fb9d990f2d7c96 height=224854 version=0x00000002 log2_work=69.513761 tx=14063312 date='2013-03-08T15:46:54Z' progress=0.018147 cache=356.2MiB(2733513txo)\r\n2022-10-26T07:24:30Z ERROR: ConnectBlock: Consensus::CheckTxInputs: 878d6685666400b75a1947ccfc676249ecdf52678b2dc0d83e0328f8c24a951a, bad-txns-inputs-missingorspent, CheckTxInputs: inputs missing/spent\r\n2022-10-26T07:24:30Z InvalidChainFound: invalid block=000000000000032021a6d18011d202df36cf07822a657b47390ab90568bb14e2  height=224855  log2_work=69.513793  date=2013-03-08T15:58:52Z\r\n2022-10-26T07:24:30Z InvalidChainFound:  current best=00000000000000cd7d1c3d5137423c00e6a221d5492ace06d8fb9d990f2d7c96  height=224854  log2_work=69.513761  date=2013-03-08T15:46:54Z\r\n2022-10-26T07:24:30Z ERROR: ConnectTip: ConnectBlock 000000000000032021a6d18011d202df36cf07822a657b47390ab90568bb14e2 failed, bad-txns-inputs-missingorspent, CheckTxInputs: inputs missing/spent\r\n```\r\n\r\nOn the next run it started the pre-sync phase from that height, and that's the point it restarts every time.\r\n\r\nI've tried to reproduce using the backup of your directory, but I couldn't. Probably because using it requires a `-reindex`.",
      "created_at" : "2022-10-26T09:13:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26391#issuecomment-1291737018",
      "id" : 1291737018,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26391",
      "node_id" : "IC_kwDOABII585M_le6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1291737018/reactions"
      },
      "updated_at" : "2022-10-26T09:13:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1291737018",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/18506343?v=4",
         "events_url" : "https://api.github.com/users/kouloumos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kouloumos/followers",
         "following_url" : "https://api.github.com/users/kouloumos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kouloumos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kouloumos",
         "id" : 18506343,
         "login" : "kouloumos",
         "node_id" : "MDQ6VXNlcjE4NTA2MzQz",
         "organizations_url" : "https://api.github.com/users/kouloumos/orgs",
         "received_events_url" : "https://api.github.com/users/kouloumos/received_events",
         "repos_url" : "https://api.github.com/users/kouloumos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kouloumos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kouloumos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kouloumos"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Steps to reproduce (with a diff to force corruption):\r\n\r\n\r\n```diff\r\ndiff --git a/src/validation.cpp b/src/validation.cpp\r\nindex 37e68cfe4a..811ff2f9eb 100644\r\n--- a/src/validation.cpp\r\n+++ b/src/validation.cpp\r\n@@ -2201,7 +2201,7 @@ bool Chainstate::ConnectBlock(const CBlock& block, BlockValidationState& state,\r\n         {\r\n             CAmount txfee = 0;\r\n             TxValidationState tx_state;\r\n-            if (!Consensus::CheckTxInputs(tx, tx_state, view, pindex->nHeight, txfee)) {\r\n+            if (Consensus::CheckTxInputs(tx, tx_state, view, pindex->nHeight, txfee)) {\r\n                 // Any transaction validation failure in ConnectBlock is a block consensus failure\r\n                 state.Invalid(BlockValidationResult::BLOCK_CONSENSUS,\r\n                             tx_state.GetRejectReason(), tx_state.GetDebugMessage());\r\n```\r\n\r\nthen call `./src/qt/bitcoin-qt -datadir=/tmp -signet -printtoconsole=1`  ",
      "created_at" : "2022-10-26T09:35:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26391#issuecomment-1291765534",
      "id" : 1291765534,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26391",
      "node_id" : "IC_kwDOABII585M_sce",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1291765534/reactions"
      },
      "updated_at" : "2022-10-26T09:35:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1291765534",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
