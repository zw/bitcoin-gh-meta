[
   {
      "body" : "Alas, I like this a lot but I think we can't use the existing mempool command for it:  It's not filtered by set inventory known. (it's also computationally expensive even when fee filter is used).\r\n\r\nWhat I'd like is a \"TOPMEMPSYNC\", which is functionally equal to mempool but considers only the top 2*BLK_SIZE txn in 'fee-rate' order (actual order can be implementation defined but should approximate mining preferences), and also filters its output through setinventoryknown. Then you can pick a peer and keep pulling from it every block and get one more block worth of transactions one block ahead of needing them.",
      "created_at" : "2016-04-27T05:47:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7955#issuecomment-214977651",
      "id" : 214977651,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7955",
      "updated_at" : "2016-04-27T05:47:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/214977651",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "@gmaxwell agreed, i opened this pull since i'm actually using very similar code for a mining setup where the pool's getblocktemplate node has maxmempool=2 for performance reasons",
      "created_at" : "2016-04-27T08:02:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7955#issuecomment-215002543",
      "id" : 215002543,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7955",
      "updated_at" : "2016-04-27T08:02:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/215002543",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/620611?v=3",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "body" : "@gmaxwell will do, i'm not sure you want to filter through setinventoryknown though, since you might have filtered things out for having too low a fee which are now valid",
      "created_at" : "2016-04-27T08:41:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7955#issuecomment-215012496",
      "id" : 215012496,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7955",
      "updated_at" : "2016-04-27T08:41:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/215012496",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/620611?v=3",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "body" : "To bad, so sad. -- it doesn't need to be perfect, ... otherwise the overhead of sending 2 blocks worth where it would end up sending the same txn over and over again makes it less attractive. With the filtering it would add basically no protocol overhead to run this with a single peer for the first 24 hours that you're up or so.",
      "created_at" : "2016-04-27T09:04:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7955#issuecomment-215018767",
      "id" : 215018767,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7955",
      "updated_at" : "2016-04-27T09:04:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/215018767",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "@gmaxwell it's just sending the transaction ids, 2 * MAX_BLOCK_SIZE / 250 * 23 = 256000\r\n\r\nwhich yeah isn't optimal... but i guess it could be short ids actually? it is once per block",
      "created_at" : "2016-04-27T09:18:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7955#issuecomment-215023400",
      "id" : 215023400,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7955",
      "updated_at" : "2016-04-27T09:18:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/215023400",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/620611?v=3",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "body" : "Overhead equal to 1/4 a maximum size block, every block.. vs no overhead compared to regular relay (only sending IDs you haven't seen before)... it's not even comparable.  The short ID stuff works much better in the context of blocks because you don't need them for fetching and can salt with the block hash.",
      "created_at" : "2016-04-27T09:42:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7955#issuecomment-215031009",
      "id" : 215031009,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7955",
      "updated_at" : "2016-04-27T09:42:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/215031009",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   }
]
