[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r61073359"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61073359"
         }
      },
      "body" : "This is not correct, it needs to iterate through all the blocks that got connected, not just the new tip.",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-04-26T12:05:52Z",
      "diff_hunk" : "@@ -2914,13 +2905,23 @@ bool ActivateBestChain(CValidationState &state, const CChainParams& chainparams,\n             if (pindexMostWork == NULL || pindexMostWork == chainActive.Tip())\n                 return true;\n \n-            if (!ActivateBestChainStep(state, chainparams, pindexMostWork, pblock && pblock->GetHash() == pindexMostWork->GetBlockHash() ? pblock : NULL))\n+            if (!ActivateBestChainStep(state, chainparams, pindexMostWork, pblock && pblock->GetHash() == pindexMostWork->GetBlockHash() ? pblock : NULL, txConflicted))\n                 return false;\n \n             pindexNewTip = chainActive.Tip();\n             pindexFork = chainActive.FindFork(pindexOldTip);\n             fInitialDownload = IsInitialBlockDownload();\n         }\n+        // throw all transaction though the signal-interface\n+        // while _not_ holding the cs_main lock\n+        BOOST_FOREACH(const CTransaction &tx, txConflicted) {\n+            SyncWithWallets(tx, pindexNewTip, NULL);\n+        }\n+        // ... and about transactions that got confirmed:\n+        BOOST_FOREACH(const CTransaction &tx, pblock->vtx) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r61073359",
      "id" : 61073359,
      "original_commit_id" : "480ed4f30f311610b1c91fe8222e3ba4cc717de7",
      "original_position" : 73,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-05-25T15:58:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61073359",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "As always when you want to improve the locking a little bit, the change gets quickly more invasive.\r\n\r\nUpdate serval things:\r\n* Fixed @sipa point (iterate though all connected blocks).\r\n* Removed the `CBlock *` parameter from the `SyncTransaction` signal and added `CBlockIndex*` together with `int posInBlock`.\r\n* Updated the wallet logic that it can handle the slightly different signal.",
      "created_at" : "2016-04-26T13:42:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#issuecomment-214749314",
      "id" : 214749314,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7946",
      "updated_at" : "2016-04-26T13:42:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/214749314",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "ActivateBestChainStep reuses a vector for ConnectTip's txConflicted to combine results from multiple blocks. ConnectTip passes txConflicted to mempoool.removeForBlock every time.",
      "created_at" : "2016-04-27T14:17:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#issuecomment-215098004",
      "id" : 215098004,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7946",
      "updated_at" : "2016-04-27T14:17:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/215098004",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1047859?v=3",
         "events_url" : "https://api.github.com/users/kazcw/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kazcw/followers",
         "following_url" : "https://api.github.com/users/kazcw/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kazcw/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kazcw",
         "id" : 1047859,
         "login" : "kazcw",
         "organizations_url" : "https://api.github.com/users/kazcw/orgs",
         "received_events_url" : "https://api.github.com/users/kazcw/received_events",
         "repos_url" : "https://api.github.com/users/kazcw/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kazcw/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kazcw/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kazcw"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r61265115"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61265115"
         }
      },
      "body" : "Could put the new loops below this comment with the other non-cs_main notifications",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-04-27T14:19:52Z",
      "diff_hunk" : "@@ -2914,13 +2910,21 @@ bool ActivateBestChain(CValidationState &state, const CChainParams& chainparams,\n             if (pindexMostWork == NULL || pindexMostWork == chainActive.Tip())\n                 return true;\n \n-            if (!ActivateBestChainStep(state, chainparams, pindexMostWork, pblock && pblock->GetHash() == pindexMostWork->GetBlockHash() ? pblock : NULL))\n+            if (!ActivateBestChainStep(state, chainparams, pindexMostWork, pblock && pblock->GetHash() == pindexMostWork->GetBlockHash() ? pblock : NULL, txConflicted, txChanged))\n                 return false;\n \n             pindexNewTip = chainActive.Tip();\n             pindexFork = chainActive.FindFork(pindexOldTip);\n             fInitialDownload = IsInitialBlockDownload();\n         }\n+        // throw all transactions though the signal-interface\n+        // while _not_ holding the cs_main lock\n+        BOOST_FOREACH(const CTransaction &tx, txConflicted)\n+            SyncWithWallets(tx, pindexNewTip);\n+        // ... and about transactions that got confirmed:\n+        for(unsigned int i = 0; i < txChanged.size(); i++)\n+            SyncWithWallets(txChanged[i].get<0>(), txChanged[i].get<1>(), txChanged[i].get<2>());\n+\n         // When we reach this point, we switched to a new tip (stored in pindexNewTip).\n \n         // Notifications/callbacks that can run without cs_main",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r61265115",
      "id" : 61265115,
      "original_commit_id" : "086654e4fd2ab2fa0d6121c18bdcf53a587bd3c4",
      "original_position" : 107,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-05-25T15:58:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61265115",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1047859?v=3",
         "events_url" : "https://api.github.com/users/kazcw/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kazcw/followers",
         "following_url" : "https://api.github.com/users/kazcw/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kazcw/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kazcw",
         "id" : 1047859,
         "login" : "kazcw",
         "organizations_url" : "https://api.github.com/users/kazcw/orgs",
         "received_events_url" : "https://api.github.com/users/kazcw/received_events",
         "repos_url" : "https://api.github.com/users/kazcw/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kazcw/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kazcw/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kazcw"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r61267490"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61267490"
         }
      },
      "body" : "Why not just change this loop to be numeric and then use the `i`?",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-04-27T14:33:08Z",
      "diff_hunk" : "@@ -1224,7 +1224,14 @@ int CWallet::ScanForWalletTransactions(CBlockIndex* pindexStart, bool fUpdate)\n             ReadBlockFromDisk(block, pindex, Params().GetConsensus());\n             BOOST_FOREACH(CTransaction& tx, block.vtx)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r61267490",
      "id" : 61267490,
      "original_commit_id" : "086654e4fd2ab2fa0d6121c18bdcf53a587bd3c4",
      "original_position" : 50,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-05-25T15:58:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61267490",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1047859?v=3",
         "events_url" : "https://api.github.com/users/kazcw/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kazcw/followers",
         "following_url" : "https://api.github.com/users/kazcw/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kazcw/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kazcw",
         "id" : 1047859,
         "login" : "kazcw",
         "organizations_url" : "https://api.github.com/users/kazcw/orgs",
         "received_events_url" : "https://api.github.com/users/kazcw/received_events",
         "repos_url" : "https://api.github.com/users/kazcw/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kazcw/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kazcw/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kazcw"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r61269025"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61269025"
         }
      },
      "body" : "Could remove the null-check; pindex has already been dereferenced",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-04-27T14:39:01Z",
      "diff_hunk" : "@@ -3276,30 +3283,18 @@ CWalletKey::CWalletKey(int64_t nExpires)\n     nTimeExpires = nExpires;\n }\n \n-int CMerkleTx::SetMerkleBranch(const CBlock& block)\n+int CMerkleTx::SetMerkleBranch(const CBlockIndex* pindex, int posInBlock)\n {\n     AssertLockHeld(cs_main);\n     CBlock blockTmp;\n \n     // Update the tx's hashBlock\n-    hashBlock = block.GetHash();\n+    hashBlock = pindex->GetBlockHash();\n \n-    // Locate the transaction\n-    for (nIndex = 0; nIndex < (int)block.vtx.size(); nIndex++)\n-        if (block.vtx[nIndex] == *(CTransaction*)this)\n-            break;\n-    if (nIndex == (int)block.vtx.size())\n-    {\n-        nIndex = -1;\n-        LogPrintf(\"ERROR: SetMerkleBranch(): couldn't find tx in block\\n\");\n-        return 0;\n-    }\n+    // set the position of the transaction in the block\n+    nIndex = posInBlock;\n \n     // Is the tx in a block that's in the main chain\n-    BlockMap::iterator mi = mapBlockIndex.find(hashBlock);\n-    if (mi == mapBlockIndex.end())\n-        return 0;\n-    const CBlockIndex* pindex = (*mi).second;\n     if (!pindex || !chainActive.Contains(pindex))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r61269025",
      "id" : 61269025,
      "original_commit_id" : "086654e4fd2ab2fa0d6121c18bdcf53a587bd3c4",
      "original_position" : 96,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-05-25T15:58:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61269025",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1047859?v=3",
         "events_url" : "https://api.github.com/users/kazcw/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kazcw/followers",
         "following_url" : "https://api.github.com/users/kazcw/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kazcw/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kazcw",
         "id" : 1047859,
         "login" : "kazcw",
         "organizations_url" : "https://api.github.com/users/kazcw/orgs",
         "received_events_url" : "https://api.github.com/users/kazcw/received_events",
         "repos_url" : "https://api.github.com/users/kazcw/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kazcw/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kazcw/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kazcw"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r62308291"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62308291"
         }
      },
      "body" : "Right. This loop is stupid at this point. The transaction always have a `posInBlock`. Will update.",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-05-06T09:40:00Z",
      "diff_hunk" : "@@ -1224,7 +1224,14 @@ int CWallet::ScanForWalletTransactions(CBlockIndex* pindexStart, bool fUpdate)\n             ReadBlockFromDisk(block, pindex, Params().GetConsensus());\n             BOOST_FOREACH(CTransaction& tx, block.vtx)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r62308291",
      "id" : 62308291,
      "original_commit_id" : "086654e4fd2ab2fa0d6121c18bdcf53a587bd3c4",
      "original_position" : 50,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-05-25T15:58:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62308291",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "@kazcw Thanks for the detailed code review!\r\n\r\nAdded a squashme commit with fixed for issues found by @kazcw.",
      "created_at" : "2016-05-06T09:48:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#issuecomment-217399685",
      "id" : 217399685,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7946",
      "updated_at" : "2016-05-06T09:48:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/217399685",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "You know what, I misread. `txConflicted` is an out-only parameter all the way down the call stack, so it was fine without the `txConflictedCurrent`. Sorry about that.",
      "created_at" : "2016-05-06T13:57:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#issuecomment-217447475",
      "id" : 217447475,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7946",
      "updated_at" : "2016-05-06T13:57:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/217447475",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1047859?v=3",
         "events_url" : "https://api.github.com/users/kazcw/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kazcw/followers",
         "following_url" : "https://api.github.com/users/kazcw/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kazcw/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kazcw",
         "id" : 1047859,
         "login" : "kazcw",
         "organizations_url" : "https://api.github.com/users/kazcw/orgs",
         "received_events_url" : "https://api.github.com/users/kazcw/received_events",
         "repos_url" : "https://api.github.com/users/kazcw/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kazcw/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kazcw/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kazcw"
      }
   },
   {
      "body" : "Needs rebase.",
      "created_at" : "2016-05-25T14:18:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#issuecomment-221590685",
      "id" : 221590685,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7946",
      "updated_at" : "2016-05-25T14:18:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/221590685",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64580923"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64580923"
         }
      },
      "body" : "Use std::tuple instead?",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-05-25T14:19:48Z",
      "diff_hunk" : "@@ -44,6 +44,7 @@\n #include <boost/filesystem/fstream.hpp>\n #include <boost/math/distributions/poisson.hpp>\n #include <boost/thread.hpp>\n+#include <boost/tuple/tuple.hpp>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64580923",
      "id" : 64580923,
      "original_commit_id" : "e8ea3dd5ea65239b2cafff8db1b2d1a8e5ebb963",
      "original_position" : 4,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-05-25T15:58:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64580923",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64581547"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64581547"
         }
      },
      "body" : "This looks like it is not doing anything, as txConflictedCurrent will always be empty?",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-05-25T14:22:56Z",
      "diff_hunk" : "@@ -2723,19 +2724,14 @@ bool static ConnectTip(CValidationState& state, const CChainParams& chainparams,\n     int64_t nTime5 = GetTimeMicros(); nTimeChainState += nTime5 - nTime4;\n     LogPrint(\"bench\", \"  - Writing chainstate: %.2fms [%.2fs]\\n\", (nTime5 - nTime4) * 0.001, nTimeChainState * 0.000001);\n     // Remove conflicting transactions from the mempool.\n-    list<CTransaction> txConflicted;\n+    list<CTransaction> txConflictedCurrent;\n     mempool.removeForBlock(pblock->vtx, pindexNew->nHeight, txConflicted, !IsInitialBlockDownload());\n+    txConflicted.insert(txConflicted.end(), txConflictedCurrent.begin(), txConflictedCurrent.end());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64581547",
      "id" : 64581547,
      "original_commit_id" : "e8ea3dd5ea65239b2cafff8db1b2d1a8e5ebb963",
      "original_position" : 42,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-05-25T15:58:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64581547",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64583607"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64583607"
         }
      },
      "body" : "Oh. Right. L2728 should make use of the `txConflictedCurrent`.\r\nFixed.",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-05-25T14:34:10Z",
      "diff_hunk" : "@@ -2723,19 +2724,14 @@ bool static ConnectTip(CValidationState& state, const CChainParams& chainparams,\n     int64_t nTime5 = GetTimeMicros(); nTimeChainState += nTime5 - nTime4;\n     LogPrint(\"bench\", \"  - Writing chainstate: %.2fms [%.2fs]\\n\", (nTime5 - nTime4) * 0.001, nTimeChainState * 0.000001);\n     // Remove conflicting transactions from the mempool.\n-    list<CTransaction> txConflicted;\n+    list<CTransaction> txConflictedCurrent;\n     mempool.removeForBlock(pblock->vtx, pindexNew->nHeight, txConflicted, !IsInitialBlockDownload());\n+    txConflicted.insert(txConflicted.end(), txConflictedCurrent.begin(), txConflictedCurrent.end());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64583607",
      "id" : 64583607,
      "original_commit_id" : "e8ea3dd5ea65239b2cafff8db1b2d1a8e5ebb963",
      "original_position" : 42,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-05-25T15:58:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64583607",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64584089"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64584089"
         }
      },
      "body" : "Why a temporary variable, and not just pass vchConflicted to mempool.removeForBlock()? txConflictedCurrent is not used elsewhere.",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-05-25T14:36:24Z",
      "diff_hunk" : "@@ -2717,19 +2717,14 @@ bool static ConnectTip(CValidationState& state, const CChainParams& chainparams,\n     int64_t nTime5 = GetTimeMicros(); nTimeChainState += nTime5 - nTime4;\n     LogPrint(\"bench\", \"  - Writing chainstate: %.2fms [%.2fs]\\n\", (nTime5 - nTime4) * 0.001, nTimeChainState * 0.000001);\n     // Remove conflicting transactions from the mempool.\n-    list<CTransaction> txConflicted;\n-    mempool.removeForBlock(pblock->vtx, pindexNew->nHeight, txConflicted, !IsInitialBlockDownload());\n+    list<CTransaction> txConflictedCurrent;\n+    mempool.removeForBlock(pblock->vtx, pindexNew->nHeight, txConflictedCurrent, !IsInitialBlockDownload());\n+    txConflicted.insert(txConflicted.end(), txConflictedCurrent.begin(), txConflictedCurrent.end());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64584089",
      "id" : 64584089,
      "original_commit_id" : "9471f32a8fad340d0518ded6320fc1402f1d6286",
      "original_position" : 35,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-05-25T15:58:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64584089",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64584704"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64584704"
         }
      },
      "body" : "Without a temporary variable, `mempool.removeForBlock` would always work though the combined list `txConflicted` that was initialized [here](https://github.com/bitcoin/bitcoin/pull/7946/files/9471f32a8fad340d0518ded6320fc1402f1d6286#diff-7ec3c68a81efff79b6ca22ac1f1eabbaR2917).\r\n\r\nAlthough I'm not sure if this would be a problem, but at least it would slightly change current masters behavior. ",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-05-25T14:39:34Z",
      "diff_hunk" : "@@ -2717,19 +2717,14 @@ bool static ConnectTip(CValidationState& state, const CChainParams& chainparams,\n     int64_t nTime5 = GetTimeMicros(); nTimeChainState += nTime5 - nTime4;\n     LogPrint(\"bench\", \"  - Writing chainstate: %.2fms [%.2fs]\\n\", (nTime5 - nTime4) * 0.001, nTimeChainState * 0.000001);\n     // Remove conflicting transactions from the mempool.\n-    list<CTransaction> txConflicted;\n-    mempool.removeForBlock(pblock->vtx, pindexNew->nHeight, txConflicted, !IsInitialBlockDownload());\n+    list<CTransaction> txConflictedCurrent;\n+    mempool.removeForBlock(pblock->vtx, pindexNew->nHeight, txConflictedCurrent, !IsInitialBlockDownload());\n+    txConflicted.insert(txConflicted.end(), txConflictedCurrent.begin(), txConflictedCurrent.end());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64584704",
      "id" : 64584704,
      "original_commit_id" : "9471f32a8fad340d0518ded6320fc1402f1d6286",
      "original_position" : 35,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-05-25T15:58:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64584704",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64585646"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64585646"
         }
      },
      "body" : "\"Work through\"? All that function does is append deleted CTransactions to it.",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-05-25T14:44:03Z",
      "diff_hunk" : "@@ -2717,19 +2717,14 @@ bool static ConnectTip(CValidationState& state, const CChainParams& chainparams,\n     int64_t nTime5 = GetTimeMicros(); nTimeChainState += nTime5 - nTime4;\n     LogPrint(\"bench\", \"  - Writing chainstate: %.2fms [%.2fs]\\n\", (nTime5 - nTime4) * 0.001, nTimeChainState * 0.000001);\n     // Remove conflicting transactions from the mempool.\n-    list<CTransaction> txConflicted;\n-    mempool.removeForBlock(pblock->vtx, pindexNew->nHeight, txConflicted, !IsInitialBlockDownload());\n+    list<CTransaction> txConflictedCurrent;\n+    mempool.removeForBlock(pblock->vtx, pindexNew->nHeight, txConflictedCurrent, !IsInitialBlockDownload());\n+    txConflicted.insert(txConflicted.end(), txConflictedCurrent.begin(), txConflictedCurrent.end());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64585646",
      "id" : 64585646,
      "original_commit_id" : "9471f32a8fad340d0518ded6320fc1402f1d6286",
      "original_position" : 35,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-05-25T15:58:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64585646",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64586467"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64586467"
         }
      },
      "body" : "Yes. Your right. Removed the temp. var.",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-05-25T14:48:02Z",
      "diff_hunk" : "@@ -2717,19 +2717,14 @@ bool static ConnectTip(CValidationState& state, const CChainParams& chainparams,\n     int64_t nTime5 = GetTimeMicros(); nTimeChainState += nTime5 - nTime4;\n     LogPrint(\"bench\", \"  - Writing chainstate: %.2fms [%.2fs]\\n\", (nTime5 - nTime4) * 0.001, nTimeChainState * 0.000001);\n     // Remove conflicting transactions from the mempool.\n-    list<CTransaction> txConflicted;\n-    mempool.removeForBlock(pblock->vtx, pindexNew->nHeight, txConflicted, !IsInitialBlockDownload());\n+    list<CTransaction> txConflictedCurrent;\n+    mempool.removeForBlock(pblock->vtx, pindexNew->nHeight, txConflictedCurrent, !IsInitialBlockDownload());\n+    txConflicted.insert(txConflicted.end(), txConflictedCurrent.begin(), txConflictedCurrent.end());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64586467",
      "id" : 64586467,
      "original_commit_id" : "9471f32a8fad340d0518ded6320fc1402f1d6286",
      "original_position" : 35,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-05-25T15:58:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64586467",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64597706"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64597706"
         }
      },
      "body" : "Sorry for changing my mind, but can you define a struct for this instead? Larger tuples don't really have good readability.",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-05-25T15:44:53Z",
      "diff_hunk" : "@@ -2919,6 +2912,8 @@ bool ActivateBestChain(CValidationState &state, const CChainParams& chainparams,\n \n         CBlockIndex *pindexNewTip = NULL;\n         const CBlockIndex *pindexFork;\n+        std::list<CTransaction> txConflicted;\n+        std::vector<std::tuple<CTransaction,CBlockIndex*,int> > txChanged;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64597706",
      "id" : 64597706,
      "original_commit_id" : "580a665a9777e12e4ac3b089efad54e8868dfe81",
      "original_position" : 75,
      "path" : "src/main.cpp",
      "position" : 75,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-05-25T15:58:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64597706",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64598257"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64598257"
         }
      },
      "body" : "Indentation (and braces).",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-05-25T15:47:50Z",
      "diff_hunk" : "@@ -2946,6 +2941,15 @@ bool ActivateBestChain(CValidationState &state, const CChainParams& chainparams,\n         // When we reach this point, we switched to a new tip (stored in pindexNewTip).\n \n         // Notifications/callbacks that can run without cs_main\n+\n+        // throw all transactions though the signal-interface\n+        // while _not_ holding the cs_main lock\n+        BOOST_FOREACH(const CTransaction &tx, txConflicted)\n+        SyncWithWallets(tx, pindexNewTip);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64598257",
      "id" : 64598257,
      "original_commit_id" : "580a665a9777e12e4ac3b089efad54e8868dfe81",
      "original_position" : 96,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-05-25T15:58:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64598257",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64600202"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64600202"
         }
      },
      "body" : "IMO tuple is ideal for a such use case. It's only a temporary variable and its scope is very small. IMO an custom struct seems to be over complex.",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-05-25T15:57:57Z",
      "diff_hunk" : "@@ -2919,6 +2912,8 @@ bool ActivateBestChain(CValidationState &state, const CChainParams& chainparams,\n \n         CBlockIndex *pindexNewTip = NULL;\n         const CBlockIndex *pindexFork;\n+        std::list<CTransaction> txConflicted;\n+        std::vector<std::tuple<CTransaction,CBlockIndex*,int> > txChanged;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64600202",
      "id" : 64600202,
      "original_commit_id" : "580a665a9777e12e4ac3b089efad54e8868dfe81",
      "original_position" : 75,
      "path" : "src/main.cpp",
      "position" : 75,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-05-25T15:58:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64600202",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64600343"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64600343"
         }
      },
      "body" : "Fixed Indentation and braces.",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-05-25T15:58:41Z",
      "diff_hunk" : "@@ -2946,6 +2941,15 @@ bool ActivateBestChain(CValidationState &state, const CChainParams& chainparams,\n         // When we reach this point, we switched to a new tip (stored in pindexNewTip).\n \n         // Notifications/callbacks that can run without cs_main\n+\n+        // throw all transactions though the signal-interface\n+        // while _not_ holding the cs_main lock\n+        BOOST_FOREACH(const CTransaction &tx, txConflicted)\n+        SyncWithWallets(tx, pindexNewTip);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64600343",
      "id" : 64600343,
      "original_commit_id" : "580a665a9777e12e4ac3b089efad54e8868dfe81",
      "original_position" : 96,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-05-25T15:58:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64600343",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64614746"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64614746"
         }
      },
      "body" : "This cs_main is unfortunate, but I guess we can get rid of it in a follow-up.",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-05-25T17:21:28Z",
      "diff_hunk" : "@@ -912,11 +912,11 @@ void CWallet::MarkConflicted(const uint256& hashBlock, const uint256& hashTx)\n     }\n }\n \n-void CWallet::SyncTransaction(const CTransaction& tx, const CBlockIndex *pindex, const CBlock* pblock)\n+void CWallet::SyncTransaction(const CTransaction& tx, const CBlockIndex *pindex, int posInBlock)\n {\n     LOCK2(cs_main, cs_wallet);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64614746",
      "id" : 64614746,
      "original_commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "original_position" : 41,
      "path" : "src/wallet/wallet.cpp",
      "position" : 41,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-05-25T17:21:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64614746",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "utACK fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-05-25T17:22:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#issuecomment-221645567",
      "id" : 221645567,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7946",
      "updated_at" : "2016-05-25T17:22:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/221645567",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64615537"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64615537"
         }
      },
      "body" : "Fair enough.",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-05-25T17:25:53Z",
      "diff_hunk" : "@@ -2919,6 +2912,8 @@ bool ActivateBestChain(CValidationState &state, const CChainParams& chainparams,\n \n         CBlockIndex *pindexNewTip = NULL;\n         const CBlockIndex *pindexFork;\n+        std::list<CTransaction> txConflicted;\n+        std::vector<std::tuple<CTransaction,CBlockIndex*,int> > txChanged;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r64615537",
      "id" : 64615537,
      "original_commit_id" : "580a665a9777e12e4ac3b089efad54e8868dfe81",
      "original_position" : 75,
      "path" : "src/main.cpp",
      "position" : 75,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-05-25T17:25:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64615537",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r65606450"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/65606450"
         }
      },
      "body" : "c++ needs collections.namedtuple :)",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-06-02T19:50:27Z",
      "diff_hunk" : "@@ -2919,6 +2912,8 @@ bool ActivateBestChain(CValidationState &state, const CChainParams& chainparams,\n \n         CBlockIndex *pindexNewTip = NULL;\n         const CBlockIndex *pindexFork;\n+        std::list<CTransaction> txConflicted;\n+        std::vector<std::tuple<CTransaction,CBlockIndex*,int> > txChanged;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r65606450",
      "id" : 65606450,
      "original_commit_id" : "580a665a9777e12e4ac3b089efad54e8868dfe81",
      "original_position" : 75,
      "path" : "src/main.cpp",
      "position" : 75,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-06-02T19:50:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/65606450",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r65608274"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/65608274"
         }
      },
      "body" : "http://www.boost.org/doc/libs/1_58_0/libs/fusion/doc/html/fusion/container/map.html",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-06-02T20:02:01Z",
      "diff_hunk" : "@@ -2919,6 +2912,8 @@ bool ActivateBestChain(CValidationState &state, const CChainParams& chainparams,\n \n         CBlockIndex *pindexNewTip = NULL;\n         const CBlockIndex *pindexFork;\n+        std::list<CTransaction> txConflicted;\n+        std::vector<std::tuple<CTransaction,CBlockIndex*,int> > txChanged;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r65608274",
      "id" : 65608274,
      "original_commit_id" : "580a665a9777e12e4ac3b089efad54e8868dfe81",
      "original_position" : 75,
      "path" : "src/main.cpp",
      "position" : 75,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-06-02T20:02:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/65608274",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r65641763"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/65641763"
         }
      },
      "body" : "given the repeated use,  maybe just `typedef` the `std::tuple`?  `tuple` has some nice conveniences over a `struct` alternative.",
      "commit_id" : "fdf8a5efe03004f4a581ba41b87737a4e1f1ff44",
      "created_at" : "2016-06-03T00:31:58Z",
      "diff_hunk" : "@@ -2919,6 +2912,8 @@ bool ActivateBestChain(CValidationState &state, const CChainParams& chainparams,\n \n         CBlockIndex *pindexNewTip = NULL;\n         const CBlockIndex *pindexFork;\n+        std::list<CTransaction> txConflicted;\n+        std::vector<std::tuple<CTransaction,CBlockIndex*,int> > txChanged;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#discussion_r65641763",
      "id" : 65641763,
      "original_commit_id" : "580a665a9777e12e4ac3b089efad54e8868dfe81",
      "original_position" : 75,
      "path" : "src/main.cpp",
      "position" : 75,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7946",
      "updated_at" : "2016-06-03T00:31:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/65641763",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "body" : "utACK fdf8a5e",
      "created_at" : "2016-06-03T00:32:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7946#issuecomment-223461557",
      "id" : 223461557,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7946",
      "updated_at" : "2016-06-03T00:32:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/223461557",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   }
]
