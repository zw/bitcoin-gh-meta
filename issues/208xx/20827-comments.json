[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/20827).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [andrewtoth](https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1872545821), [fjahr](https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1889900815), [achow101](https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1910911055) |\n| Concept ACK | [jonasschnelli](https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-753833331), [theStack](https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-997509236), [0xB10C](https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-997846468), [jonatack](https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1641253768), [kristapsk](https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1641766302) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.\n",
      "created_at" : "2021-01-02T02:01:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-753416955",
      "id" : 753416955,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1MzQxNjk1NQ==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/753416955/reactions"
      },
      "updated_at" : "2024-01-25T20:07:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/753416955",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Interesting, will have a look.",
      "created_at" : "2021-01-04T00:16:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-753697982",
      "id" : 753697982,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1MzY5Nzk4Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-04T00:16:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/753697982",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Nice!\r\nConcept ACK.\r\nCould we further reduce flushes by allowing a user parameter (`-pruneflushbuffer` [or similar])? Some users are probably okay with providing a few GBs of extra space for speeding up pruning (assume hight dbcache) (but wan't the extra space be freed after IBD).\r\nOr we could automatically use he dbcache size as the buffer size.",
      "created_at" : "2021-01-04T08:26:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-753833331",
      "id" : 753833331,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1MzgzMzMzMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-04T08:26:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/753833331",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I also like the idea of temporally assigning more RAM for IBD. This could even be done by default for GUI users (with opt-out in the intro screen).",
      "created_at" : "2021-01-08T17:50:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-756904825",
      "id" : 756904825,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NjkwNDgyNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-08T17:50:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/756904825",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "`dbcache` adjustments are ultimately an unrelated feature. I see #19873 as the next step in that area.",
      "created_at" : "2021-01-08T18:33:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-756926008",
      "id" : 756926008,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NjkyNjAwOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-08T18:33:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/756926008",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK\r\n\r\nWould be nice to see this benchmarked.",
      "created_at" : "2021-01-09T18:02:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-757344141",
      "id" : 757344141,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NzM0NDE0MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-09T18:02:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/757344141",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--4a62be1de6b64f3ed646cdc7932c8cf5-->\nðµï¸ @sipa has been requested to review this pull request as specified in the REVIEWERS file.",
      "created_at" : "2021-01-13T11:45:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-759396337",
      "id" : 759396337,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1OTM5NjMzNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-13T11:45:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/759396337",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-02-18T10:05:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-781231104",
      "id" : 781231104,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4MTIzMTEwNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-02-18T10:05:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/781231104",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20827#discussion_r615407150"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20827"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615407150"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "why assume when you can calculate?   I guess/hope the answer is \"because it's easier and it's safe to assume\"",
      "commit_id" : "2c35ce710d3ca250f26daf2bc8b364e3bd124d5c",
      "created_at" : "2021-04-18T14:32:00Z",
      "diff_hunk" : "@@ -4018,10 +4018,12 @@ void BlockManager::FindFilesToPrune(std::set<int>& setFilesToPrune, uint64_t nPr\n         // On a prune event, the chainstate DB is flushed.\n         // To avoid excessive prune events negating the benefit of high dbcache\n         // values, we should not prune too rapidly.\n-        // So when pruning in IBD, increase the buffer a bit to avoid a re-prune too soon.\n-        if (is_ibd) {\n-            // Since this is only relevant during IBD, we use a fixed 10%\n-            nBuffer += nPruneTarget / 10;\n+        // So when pruning in IBD, increase the buffer to avoid a re-prune too soon.\n+        if (is_ibd && target_sync_height > (uint64_t)chain_tip_height) {\n+            // Since this is only relevant during IBD, we assume blocks are at least 1 MB on average\n+            static constexpr uint64_t average_block_size = 1000000;  /* 1 MB */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#discussion_r615407150",
      "id" : 615407150,
      "line" : 4024,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTQwNzE1MA==",
      "original_commit_id" : "2c35ce710d3ca250f26daf2bc8b364e3bd124d5c",
      "original_line" : 4024,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 29,
      "pull_request_review_id" : 638336418,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20827",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-18T14:32:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615407150",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=4",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "node_id" : "MDQ6VXNlcjE1MzAyODM=",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20827#discussion_r664938505"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20827"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/664938505"
         }
      },
      "author_association" : "MEMBER",
      "body" : "AFAIK we don't have access to future block sizes at this point.",
      "commit_id" : "2c35ce710d3ca250f26daf2bc8b364e3bd124d5c",
      "created_at" : "2021-07-06T23:28:45Z",
      "diff_hunk" : "@@ -4018,10 +4018,12 @@ void BlockManager::FindFilesToPrune(std::set<int>& setFilesToPrune, uint64_t nPr\n         // On a prune event, the chainstate DB is flushed.\n         // To avoid excessive prune events negating the benefit of high dbcache\n         // values, we should not prune too rapidly.\n-        // So when pruning in IBD, increase the buffer a bit to avoid a re-prune too soon.\n-        if (is_ibd) {\n-            // Since this is only relevant during IBD, we use a fixed 10%\n-            nBuffer += nPruneTarget / 10;\n+        // So when pruning in IBD, increase the buffer to avoid a re-prune too soon.\n+        if (is_ibd && target_sync_height > (uint64_t)chain_tip_height) {\n+            // Since this is only relevant during IBD, we assume blocks are at least 1 MB on average\n+            static constexpr uint64_t average_block_size = 1000000;  /* 1 MB */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#discussion_r664938505",
      "id" : 664938505,
      "in_reply_to_id" : 615407150,
      "line" : 4024,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NDkzODUwNQ==",
      "original_commit_id" : "2c35ce710d3ca250f26daf2bc8b364e3bd124d5c",
      "original_line" : 4024,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 29,
      "pull_request_review_id" : 700456305,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20827",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-07-06T23:28:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/664938505",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Without rebase, compiling fails for me:\r\n\r\n```shell\r\n$ make clean && ./configure CXXFLAGS=\"-O0 -g\" CFLAGS=\"-O0 -g\" && make -j 9\r\n...\r\ntouch src/config/bitcoin-config.h.in\r\n  CXX      util/libbitcoin_util_a-moneystr.o\r\n  CXX      util/libbitcoin_util_a-readwritefile.o\r\n  CXX      util/libbitcoin_util_a-settings.o\r\n  CXX      util/libbitcoin_util_a-serfloat.o\r\n  CXX      util/libbitcoin_util_a-spanparsing.o\r\n  CXX      util/libbitcoin_util_a-strencodings.o\r\n  CXX      util/libbitcoin_util_a-string.o\r\n  CXX      util/libbitcoin_util_a-url.o\r\nmake[3]: *** No rule to make target `libunivalue.la'.  Stop.\r\nmake[2]: *** [univalue/libunivalue.la] Error 2\r\nmake[2]: *** Waiting for unfinished jobs....\r\nmake[1]: *** [all-recursive] Error 1\r\nmake: *** [all-recursive] Error 1\r\n```\r\n\r\nAfter `git rebase master`, everything runs smoothly again. Will report back shortly with my review results!",
      "created_at" : "2021-12-16T14:15:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-995856284",
      "id" : 995856284,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII5847W4-c",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/995856284/reactions"
      },
      "updated_at" : "2021-12-16T14:15:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/995856284",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@stickies-v If you want to compile older commits of master, you'll need to `make distclean` first.",
      "created_at" : "2021-12-16T14:21:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-995861317",
      "id" : 995861317,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII5847W6NF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/995861317/reactions"
      },
      "updated_at" : "2021-12-16T14:21:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/995861317",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Without rebase, compiling fails for me:\r\n\r\nNote: It's usually best to merge PRs into master for testing. Sometimes (bugfixes) they can be based on very old commits (when the bug was introduced); and if there's a silent problem with the merge, you'd want to notice that too.\r\n\r\n>@stickies-v If you want to compile older commits of master, you'll need to make distclean first.\r\n\r\nCan we fix this build system bug?",
      "created_at" : "2021-12-16T16:44:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-995991074",
      "id" : 995991074,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII5847XZ4i",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/995991074/reactions"
      },
      "updated_at" : "2021-12-16T16:44:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/995991074",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2021-12-20T01:15:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-997509236",
      "id" : 997509236,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII5847dMh0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/997509236/reactions"
      },
      "updated_at" : "2021-12-20T01:15:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/997509236",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK\r\n\r\nWe'll be doing a Bitcoin Core PR Review club covering this PR on the 29th: [bitcoincore.reviews/20827](https://bitcoincore.reviews/20827) ",
      "created_at" : "2021-12-20T11:36:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-997846468",
      "id" : 997846468,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII5847ee3E",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 1,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/997846468/reactions"
      },
      "updated_at" : "2021-12-20T11:36:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/997846468",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "https://github.com/bitcoin/bitcoin/pull/12404 (not merged) may also be interesting to reviewers. @Sjors did run a few benchmarks back then and found https://github.com/bitcoin/bitcoin/pull/11658 (which this PR overrides) to be the better option at that time.\r\n\r\nI'm planing on benchmarking this change too.",
      "created_at" : "2021-12-26T12:03:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1001166198",
      "id" : 1001166198,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII5847rJV2",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1001166198/reactions"
      },
      "updated_at" : "2021-12-26T12:03:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1001166198",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-01-04T03:25:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1004502063",
      "id" : 1004502063,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII584733wv",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1004502063/reactions"
      },
      "updated_at" : "2022-01-04T03:25:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1004502063",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK, I read the PR Review Club and will review after rebase.",
      "created_at" : "2022-01-09T18:36:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1008351377",
      "id" : 1008351377,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII5848GjiR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1008351377/reactions"
      },
      "updated_at" : "2022-01-09T18:36:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1008351377",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "fwiw: https://github.com/bitcoin/bitcoin/pull/23581 moved BlockManager to node/blockstorage, that's where the conflict with master happens.\r\n\r\nI've rebased this PR in https://github.com/0xB10C/bitcoin/tree/2022-01-lukejr-ibd-prune-max-rebased and started benchmarking https://github.com/0xB10C/bitcoin/commit/db2a9e71a748c4806b85f767441fb3f090d62163 (PR) vs https://github.com/0xB10C/bitcoin/commit/2e01b6986099715afa40ed6464da4b321b630e9c (mergebase; MB). \r\n\r\nI have 8 different prune and dbcache configurations set-up. Each configuration runs three times per binary (PR and MB).\r\nThat's 8 configs * 3 runs * 2 binaries = 48. I expect this to take about 6 days. Configurations:\r\n\r\n```\r\n1. -dbcache=300 -prune=550\r\n2. -dbcache=4000 -prune=550\r\n\r\n3. -dbcache=300 -prune=1100\r\n4. -dbcache=4000 -prune=1100\r\n\r\n5. -dbcache=300 -prune=2200\r\n6. -dbcache=4000 -prune=2200\r\n\r\n7. -dbcache=300 -prune=4400\r\n8. -dbcache=4000 -prune=4400\r\n```\r\n\r\nBenchmarks run on a dedicated, properly cooled, and otherwise idle machine with two HDDs in a RAID0. The node syncs from a local node on the same machine and disks (connected via `addnode` and otherwise `connect=0`). The sync starts at block height 500_000 and ends at height 600_000. Between each run, the machine idles 5 minutes. The debug.log, with extra `debug=coindb debug=prune` logging, of each run is saved. I'll post results and graphs next week.\r\n",
      "created_at" : "2022-01-10T15:52:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1009016428",
      "id" : 1009016428,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII5848JF5s",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1009016428/reactions"
      },
      "updated_at" : "2022-01-10T15:53:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1009016428",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "With a prune just before IBD, there is more blk and undo data available when running master than with this change. One potential issue that was mentioned during the PR review club:\r\n\r\nOn non-mainnet networks, the 1MB per block assumption doesn't hold. When we prune with a large `nBuffer` just before IBD ends, the prune might cause problems on larger reorgs as not enough undo data is present to revert back to the last shared block. Testnet has seen large reorgs in the past. \r\n\r\nMight be worth thinking about potential alternatives to increasing the `nBuffer` by `1MB * remaining_blocks`. There might be cleaner ways to implement \"prune _everything_ as long as we are not close to IBD being done\". Haven't come up with a practical threshold for \"IBD being close to done\" yet that works for all networks.\r\n\r\n",
      "created_at" : "2022-01-15T10:29:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1013658310",
      "id" : 1013658310,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII5848azLG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013658310/reactions"
      },
      "updated_at" : "2022-01-15T10:29:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013658310",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The 1 MB per block assumption would mean at least 550 blocks. Testnet has deeper reorgs than that?",
      "created_at" : "2022-01-15T19:09:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1013737923",
      "id" : 1013737923,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII5848bGnD",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013737923/reactions"
      },
      "updated_at" : "2022-01-15T19:09:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013737923",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> The 1 MB per block assumption would mean at least 550 blocks. Testnet has deeper reorgs than that?\r\n\r\nI haven't observed this personally, but yes testnet has been unreliable in regards to deep reorgs in the past. That's one motivation for SigNet in BIP 325. Also:\r\n- https://github.com/lightningnetwork/lnd/issues/3060#issuecomment-491096343\r\n- https://blog.lopp.net/the-block-storms-of-bitcoins-testnet/",
      "created_at" : "2022-01-16T11:05:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1013854867",
      "id" : 1013854867,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII5848bjKT",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013854867/reactions"
      },
      "updated_at" : "2022-01-16T11:05:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013854867",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> benchmarking [0xB10C@db2a9e7](https://github.com/0xB10C/bitcoin/commit/db2a9e71a748c4806b85f767441fb3f090d62163) (PR) vs [0xB10C@2e01b69](https://github.com/0xB10C/bitcoin/commit/2e01b6986099715afa40ed6464da4b321b630e9c) (mergebase; MB).\r\n>\r\n> I have 8 different prune and dbcache configurations set-up. Each configuration runs three times per binary (PR and MB). That's 8 configs * 3 runs * 2 binaries = 48. I expect this to take about 6 days. Configurations:\r\n>\r\n> ```\r\n> 1. -dbcache=300 -prune=550\r\n> 2. -dbcache=4000 -prune=550\r\n>\r\n> 3. -dbcache=300 -prune=1100\r\n> 4. -dbcache=4000 -prune=1100\r\n>\r\n> 5. -dbcache=300 -prune=2200\r\n> 6. -dbcache=4000 -prune=2200\r\n>\r\n> 7. -dbcache=300 -prune=4400\r\n> 8. -dbcache=4000 -prune=4400\r\n> ```\r\n>\r\n> Benchmarks run on a dedicated, properly cooled, and otherwise idle machine with two HDDs in a RAID0. The node syncs from a local node on the same machine and disks (connected via `addnode` and otherwise `connect=0`). The sync starts at block height 500_000 and ends at height 600_000. Between each run, the machine idles 5 minutes. The debug.log, with extra `debug=coindb debug=prune` logging, of each run is saved. I'll post results and graphs next week.\r\n\r\nBenchmarks done. Happy to share debug.logs and code if anyone wants to look into it or reproduce.\r\n\r\n**tl;dr**: With some configurations, an IBD performance improvement of 15% or more between block 500k and 600k was measured.\r\n\r\n\r\n### Number of prunes, pruned files, dbcache flushes\r\n\r\nThis PR makes pruning more aggressive. We prune more blk/rev files in a single prune operation to minimize the total number of prune operations needed. This also reduces the number of expensive dbcache flushes as each prune operation requires a dbcache flush.\r\n\r\n\r\n| config                     |   MB prunes |   PR prunes | prunes   |   MB pruned files |   PR pruned files | pruned files   |   MB flushes |   PR flushes | flushes   |\r\n|----------------------------|-------------|-------------|----------|-------------------|-------------------|----------------|--------------|--------------|-----------|\r\n| 0: prune=550 dbcache=300   |         726 |         670 | 92.29%   |                 1 |              1.08 | 1.08x          |          726 |          670 | 92%       |\r\n| 1: prune=550 dbcache=4000  |         726 |         670 | 92.29%   |                 1 |              1.08 | 1.08x          |          726 |          670 | 92%       |\r\n| 2: prune=1100 dbcache=300  |         723 |         150 | 20.75%   |                 1 |              4.83 | 4.83x          |          723 |          150 | 21%       |\r\n| 3: prune=1100 dbcache=4000 |         723 |         150 | 20.75%   |                 1 |              4.83 | 4.83x          |          723 |          150 | 21%       |\r\n| 4: prune=2200 dbcache=300  |         358 |          58 | 16.2%    |                 2 |             12.47 | 6.23x          |          359 |           76 | 21%       |\r\n| 5: prune=2200 dbcache=4000 |         358 |          58 | 16.2%    |                 2 |             12.47 | 6.23x          |          358 |           58 | 16%       |\r\n| 6: prune=4400 dbcache=300  |         175 |          26 | 14.86%   |                 4 |             27.69 | 6.92x          |          178 |           69 | 39%       |\r\n| 7: prune=4400 dbcache=4000 |         175 |          26 | 14.86%   |                 4 |             27.69 | 6.92x          |          175 |           26 | 15%       |\r\n\r\nIn the IBDs for **configurations 0 & 1** (prune = 550MB; minimum prune target), we only prune and flush about 8% less in _PR_ than in _MB_. With _MB_, every prune operation prunes 1 blk/rev file pairs. _PR_ prune operations sometimes prune 2 blk/rev files, averaging at 1.08 files per prune. Increasing the dbcache doesn't affect the number of flushes. Likely because the max cache size is not reached.\r\n\r\nSimilarly, a larger dbcache doesn't affect **configurations 2 & 3**. However, _PR_ only has 21% of the flushes and prune operations of _MB_. _MB_ prunes 1 file pair per prune operation while _PR_ prunes 4.83 file pairs on average.\r\n\r\nWe first see a larger dbcache affecting the number of flushes in **configurations 4 & 5**. Configuration 4 (c4) has a dbcache of 300MB and configuration 5 (c5) a dbcache of 4000MB. With c4, the number of flushes of _PR_ compared to _MB_ is only 21%. With c5, it's 16%. _PR_ prunes on average 12.47 file pairs per prune operation, while _MB_ prunes 2 pairs.\r\n\r\nWith **configurations 6 & 7** _PR_ prunes 27.7 file pairs on average while _MB_ prunes 4 pairs. However, in configuration 6 (c6) the small dbcache (300MB) is a limiting factor. _PR_ flushes 69 times with c6 and 26 times with configuration 7 (dbcache=4000MB) compared to 178 (c6) and 175 (c7) flushes with _MB_.\r\n\r\n\r\n### IBD performance (between block 500000 and 600000)\r\n\r\nFewer dbcache flushes due to fewer prune operations should yield IBD performance improvements.\r\n\r\n| Configuration              | MB run 1   | MB run 2   | MB run 3   | MB mean   | PR run 1   | PR run 2   | PR run 3   | PR mean   | improvement   |\r\n|----------------------------|------------|------------|------------|-----------|------------|------------|------------|-----------|---------------|\r\n| 0: prune=550 dbcache=300   | 9799s      | 10046s     | 10003s     | 9949s     | 9478s      | 9531s      | 9518s      | 9509s     | 4.4%          |\r\n| 1: prune=550 dbcache=4000  | 10219s     | 10047s     | 9915s      | 10060s    | 9649s      | 9549s      | 9712s      | 9636s     | 4.2%          |\r\n| 2: prune=1100 dbcache=300  | 9970s      | 10191s     | 10073s     | 10078s    | 8249s      | 8467s      | 8310s      | 8342s     | 17.2%         |\r\n| 3: prune=1100 dbcache=4000 | 10084s     | 9887s      | 9976s      | 9982s     | 8652s      | 8483s      | 8329s      | 8488s     | 15.0%         |\r\n| 4: prune=2200 dbcache=300  | 8991s      | 9071s      | 8817s      | 8959s     | 7494s      | 7687s      | 7496s      | 7559s     | 15.6%         |\r\n| 5: prune=2200 dbcache=4000 | 8973s      | 8865s      | 9063s      | 8967s     | 7405s      | 7169s      | 7661s      | 7411s     | 17.4%         |\r\n| 6: prune=4400 dbcache=300  | 8378s      | 8102s      | 7972s      | 8150s     | 7645s      | 7533s      | 7515s      | 7564s     | 7.2%          |\r\n| 7: prune=4400 dbcache=4000 | 8144s      | 8263s      | 8002s      | 8136s     | 6833s      | 6982s      | 6792s      | 6869s     | 15.6%         |\r\n\r\nThe performance improves for all configurations.\r\n\r\nIn configurations 0 (c0) and 1 (c1), the increased dbcache had no effect. We saw 8% fewer prunes and flushes with _PR_ than _MB_ for both configurations. We measured a 4.4% (c0) and a 4.2% (c1) improvement in IBD performance with _PR_.\r\n\r\n![image](https://user-images.githubusercontent.com/19157360/150341947-fd0b8f5d-9a64-4b53-87c4-4c19f1b80618.png)\r\n\r\n\r\nIn configurations 2 (c2) and 3 (c3), _PR_ had only 21% of the flush and prune operations than _MB_ had (see above). We measured a performance improvement of 17.2% for c2 and a 15% for c3. The difference of 2.2% stems likely from _PR run 1_ of c3, which took about 400s (~5%) longer than _PR run 1_ of c2.\r\n\r\n![image](https://user-images.githubusercontent.com/19157360/150342050-4670a10c-bebf-41dd-97a6-e3b1666cf090.png)\r\n\r\n\r\nThe smaller dbcache of configuration 4 (c4) was noticeable in the number of flushes and prunes already. The _PR_ showed a 15.6% improvement over _MB_ in c4 and a 17.4% improvement in c5.\r\n\r\n![image](https://user-images.githubusercontent.com/19157360/150344540-bf62cba3-de56-4564-8879-9206877babde.png)\r\n\r\n\r\nWith configurations 6 (c6) and 7 (c7), the effect of the smaller dbcache of c6 became more noticeable. We saw a 7.2% improvement for _PR_ with c6 compared to a 15.6% improvement with c7.\r\n\r\n![image](https://user-images.githubusercontent.com/19157360/150344644-e0cdbda8-25b2-40d4-b6f9-412e9f634a0d.png)\r\n\r\n### Conclusion\r\n\r\n_PR_ with a larger prune target does reduce the number of flushes significantly compared to _MB_ by deleting more blk/rev file pairs per prune operation. However, the default dbcache (of 300MB) can fill up with larger prune targets. Here, increasing the dbcache is helpful. Given the right configuration, fewer flushes significantly impact the IBD performance between block 500000 and 600000. Often, a performance improvement of over 15% can be measured.\r\n\r\nThis PR is worth pursuing. \r\n\r\n---\r\n\r\nI'm running full (genesis to 710k) IBD benchmarks now.",
      "created_at" : "2022-01-20T15:07:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1017603590",
      "id" : 1017603590,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII5848p2YG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1017603590/reactions"
      },
      "updated_at" : "2022-01-20T15:12:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1017603590",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Review by @0xB10C is helpful although I was confused at some places if MB is for Master Branch or Mega Byte.\r\n\r\nHm, good point. MB actually stands for mergebase (the commit right before the changes from this PR) here.",
      "created_at" : "2022-01-20T15:40:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1017636601",
      "id" : 1017636601,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII5848p-b5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1017636601/reactions"
      },
      "updated_at" : "2022-01-20T15:40:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1017636601",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I ran full IBD benchmarks (block 0 to 710k compared to 500k to 600k in https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1017603590) with these three configurations:\r\n\r\n```\r\n1. -dbcache=300 -prune=550\r\n2. -dbcache=4000 -prune=4400\r\n3. -dbcache=4000 -prune=8800\r\n```\r\nI ran each configuration two times (compared to three times in https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1017603590) for both the PR binary and the MB binary. That's 3 configurations * 2 binaries * 2 runs = 12 full IBDs. The setup and hardware were the same as in the 500k-to-600k benchmark. However, I've started with an empty datadir compared to a datadir pre-synced to block 500k in the previous benchmark.\r\n\r\n**tl;dr:** I measured a 3.9% full-IBD speed-up with a default dbcache and the minimum pruning target and a 17.4% full-IBD speed-up with a dbcache of 4000MB and a prune target of 8800MB.\r\n \r\n### Number of prunes, pruned files, dbcache flushes\r\n\r\n| config                     |   MB prunes |   PR prunes | prunes   |   MB pruned files |   PR pruned files | pruned files   |   MB flushes |   PR flushes | flushes   |\r\n|----------------------------|-------------|-------------|----------|-------------------|-------------------|----------------|--------------|--------------|-----------|\r\n| 0: prune=550 dbcache=300   |        2805 |        2403 | 85.67%   |              1    |              1.17 | 1.17x          |         2805 |         2403 | 86%       |\r\n| 1: prune=4400 dbcache=4000 |         695 |         101 | 14.53%   |              4    |             27.75 | 6.94x          |          695 |          101 | 15%       |\r\n| 2: prune=8800 dbcache=4000 |         393 |          48 | 12.21%   |              6.99 |             58.17 | 8.32x          |          393 |           48 | 12%       |\r\n\r\nAcross the board, it's visible that pruning more files in a single pruning operation causes fewer pruning operations in total. This causes fewer dbcache flushes in total. The _PR_ binary in configuration 0 pruned 1.17 blk/rev file pair per prune operation compared 1 file pair in the _MB_. This caused the _PR_ binary to flush 24% fewer times. With higher prune targets, we flush even less often. In configuration 1 we flushed 85% fewer times with _PR_ than with  _MB_ and in configuration 2 we flushed 88% fewer times. In configuration 2 we flushed 58 blk/rev file pairs on average per flush operation compared to only 7 file pairs in _MB_.  \r\n\r\n### full-IBD performance (between block 0 and 710k)\r\n\r\n| Configuration              | MB run 1   | MB run 2   | MB mean   | PR run 1   | PR run 2   | PR mean   | improvement   |\r\n|----------------------------|------------|------------|-----------|------------|------------|-----------|---------------|\r\n| 0: prune=550 dbcache=300   | 40621s     | 39884s     | 40252s    | 38127s     | 39208s     | 38667s    | 3.9%          |\r\n| 1: prune=4400 dbcache=4000 | 33346s     | 33395s     | 33370s    | 27597s     | 28715s     | 28156s    | 15.6%         |\r\n| 2: prune=8800 dbcache=4000 | 30734s     | 32040s     | 31387s    | 25656s     | 26214s     | 25935s    | 17.4%         |\r\n\r\n![image](https://user-images.githubusercontent.com/19157360/151371447-8d5e5208-078f-48dd-852c-b03a7e5ba085.png)\r\n\r\nWith configuration 0, I measured a 3.9% IBD speed-up with the _PR_ binary. The _MB_ binary averaged at 11:10:52 and the PR binary at 10:44:27 for a full IBD.\r\n\r\n![image](https://user-images.githubusercontent.com/19157360/151371403-f4bc4971-907d-4ddf-886a-c453b7a5d8c4.png)\r\n\r\n\r\nWith configuration 1 I measured a 15.6% IBD speed-up with the _PR_ binary. The _MB_ binary averaged at 09:16:10 and the PR binary at 07:49:16 for a full IBD.\r\n\r\n![image](https://user-images.githubusercontent.com/19157360/151371578-cc44f856-743b-4483-9f5a-bc9eb16ac657.png)\r\n\r\n\r\nWith configuration 2, I measured a 17.4% IBD speed-up with the _PR_ binary. The _MB_ binary averaged at 08:43:07 and the PR binary at 07:12:15 for a full IBD.\r\n\r\n### dbcache usage on flush\r\n\r\nI've looked at the dbcache size right before it's flushed to discuss the chosen configurations. This gives a good indication of the dbcache utilization.\r\n\r\n![image](https://user-images.githubusercontent.com/19157360/151360199-f7398f52-4e15-4876-95c9-ca50e09c4a8f.png)\r\n\r\nFor the three configurations, the blue box plot (for the _MB_ binary) on the left and the orange box plot (for the _PR_ binary) show the distributions of the dbcache size right before flushing it to disk.\r\n\r\nFor configuration 0, with a default dbcache of 300MB, both _MB_ and _PR_ utilize only about 100MB and 125MB of the dbcache in the median. _PR_ has some outliners just below 500MB, which are larger than the configured dbcache. This is likely the reserved mempool memory being used as dbcache during IBD (where the mempool is empty). \r\n\r\nWith configuration 1 with a 4000MB dbcache, the median utilization is about 275MB for the _MB_ binary and about 1050MB for _PR_. _PR_ has outliers up to 2100MB, but limiting it to 1600MB compared to 4000MB would probably be fine too. \r\n\r\nWith configuration 2 with a 4000MB dbcache, the median utilization is about 450MB for the _MB_ binary and about 1600MB for _PR_. _PR_ has outliers up to 2700MB, but limiting it to 2600MB compared to 4000MB would probably be fine too. \r\n\r\nNone of the configurations are limited by dbcache size. \r\n\r\n### Hardware utilization\r\n\r\n![image](https://user-images.githubusercontent.com/19157360/151361979-bb7abd59-2557-4251-89d1-768396559f9d.png)\r\n\r\nThe 4c/8t i7 CPU of the benchmarking machine was under about 25% load without signature verification and 65% load with signature verification (assumevalid). The limiting factor was probably disk IO on the HDD raid. \r\n\r\nAgain, benchmarks on a system with SDDs would be helpful too. As HDD space is usually cheaper than SSD space, maybe more people enable pruning on systems with an SSD. Additionally, systems with weaker processors might see smaller performance improvements as they are also limited by their CPU and not only by disk IO.",
      "created_at" : "2022-01-27T11:23:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1023108273",
      "id" : 1023108273,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII5848-2Sx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 1,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 2,
         "total_count" : 4,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1023108273/reactions"
      },
      "updated_at" : "2022-01-27T13:48:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1023108273",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased",
      "created_at" : "2022-03-24T02:09:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1076995022",
      "id" : 1076995022,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII585AMaPO",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1076995022/reactions"
      },
      "updated_at" : "2022-03-24T02:09:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1076995022",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-10-19T09:32:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1283709207",
      "id" : 1283709207,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII585Mg9kX",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1283709207/reactions"
      },
      "updated_at" : "2022-10-19T09:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1283709207",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--13523179cfe9479db18ec6c5d236f789-->\nThere hasn't been much activity lately and the patch still needs rebase. What is the status here?\n\n* Is it still relevant? â¡ï¸ Please solve the conflicts to make it ready for review and to ensure the CI passes.\n* Is it no longer relevant? â¡ï¸ Please close.\n* Did the author lose interest or time to work on this? â¡ï¸ Please close it and mark it 'Up for grabs' with the label, so that it can be picked up in the future.\n",
      "created_at" : "2023-01-17T01:38:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1384731690",
      "id" : 1384731690,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII585SiVQq",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1384731690/reactions"
      },
      "updated_at" : "2023-01-17T01:38:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1384731690",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Are you still working on this?",
      "created_at" : "2023-02-03T20:50:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1416389074",
      "id" : 1416389074,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII585UbGHS",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1416389074/reactions"
      },
      "updated_at" : "2023-02-03T20:50:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1416389074",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased",
      "created_at" : "2023-07-19T01:25:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1641248977",
      "id" : 1641248977,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII585h03jR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1641248977/reactions"
      },
      "updated_at" : "2023-07-19T01:25:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1641248977",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2023-07-19T01:33:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1641253768",
      "id" : 1641253768,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII585h04uI",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1641253768/reactions"
      },
      "updated_at" : "2023-07-19T01:33:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1641253768",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2023-07-19T09:42:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1641766302",
      "id" : 1641766302,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII585h212e",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1641766302/reactions"
      },
      "updated_at" : "2023-07-19T09:42:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1641766302",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4500994?v=4",
         "events_url" : "https://api.github.com/users/kristapsk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kristapsk/followers",
         "following_url" : "https://api.github.com/users/kristapsk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kristapsk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kristapsk",
         "id" : 4500994,
         "login" : "kristapsk",
         "node_id" : "MDQ6VXNlcjQ1MDA5OTQ=",
         "organizations_url" : "https://api.github.com/users/kristapsk/orgs",
         "received_events_url" : "https://api.github.com/users/kristapsk/received_events",
         "repos_url" : "https://api.github.com/users/kristapsk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kristapsk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kristapsk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kristapsk"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I have a project that syncs bitcoin core on an external drive and this would really help a lot of people testing it with smaller flash drives and higher RAM.  So much so that I've made scripts to do manual pruning (back to 550mib) only when disk space is getting low to emulate this.",
      "created_at" : "2023-08-04T04:15:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1664944819",
      "id" : 1664944819,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII585jPQqz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1664944819/reactions"
      },
      "updated_at" : "2023-08-04T04:15:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1664944819",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73506583?v=4",
         "events_url" : "https://api.github.com/users/BenWestgate/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BenWestgate/followers",
         "following_url" : "https://api.github.com/users/BenWestgate/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BenWestgate/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BenWestgate",
         "id" : 73506583,
         "login" : "BenWestgate",
         "node_id" : "MDQ6VXNlcjczNTA2NTgz",
         "organizations_url" : "https://api.github.com/users/BenWestgate/orgs",
         "received_events_url" : "https://api.github.com/users/BenWestgate/received_events",
         "repos_url" : "https://api.github.com/users/BenWestgate/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BenWestgate/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BenWestgate/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BenWestgate"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-08-21T11:28:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1686152228",
      "id" : 1686152228,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII585kgKQk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1686152228/reactions"
      },
      "updated_at" : "2023-08-21T11:28:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1686152228",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Are you still working on this?",
      "created_at" : "2023-09-20T16:22:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1728064696",
      "id" : 1728064696,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII585nACy4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1728064696/reactions"
      },
      "updated_at" : "2023-09-20T16:22:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1728064696",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--13523179cfe9479db18ec6c5d236f789-->\nThere hasn't been much activity lately and the patch still needs rebase. What is the status here?\n\n* Is it still relevant? â¡ï¸ Please solve the conflicts to make it ready for review and to ensure the CI passes.\n* Is it no longer relevant? â¡ï¸ Please close.\n* Did the author lose interest or time to work on this? â¡ï¸ Please close it and mark it 'Up for grabs' with the label, so that it can be picked up in the future.\n",
      "created_at" : "2023-12-19T01:53:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1861975725",
      "id" : 1861975725,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII585u-36t",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1861975725/reactions"
      },
      "updated_at" : "2023-12-19T01:53:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1861975725",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20827#discussion_r1437296904"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20827"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1437296904"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: Any reason this declaration is up here and not directly above where it is used below?",
      "commit_id" : "d298ff8b62b2624ed390c8a2f905c888ffc956ff",
      "created_at" : "2023-12-27T23:52:26Z",
      "diff_hunk" : "@@ -298,6 +298,7 @@ void BlockManager::FindFilesToPrune(\n     // Distribute our -prune budget over all chainstates.\n     const auto target = std::max(\n         MIN_DISK_SPACE_FOR_BLOCK_FILES, GetPruneTarget() / chainman.GetAll().size());\n+    const uint64_t target_sync_height = chainman.m_best_header->nHeight;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#discussion_r1437296904",
      "id" : 1437296904,
      "line" : 301,
      "node_id" : "PRRC_kwDOABII585Vq2kI",
      "original_commit_id" : "d298ff8b62b2624ed390c8a2f905c888ffc956ff",
      "original_line" : 301,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : 4,
      "pull_request_review_id" : 1797569404,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20827",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1437296904/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-27T23:53:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1437296904",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20827#discussion_r1437297033"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20827"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1437297033"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: could remove the cast in the next line with\r\n```suggestion\r\n        const uint64_t chain_tip_height = chain.m_chain.Height();\r\n```",
      "commit_id" : "d298ff8b62b2624ed390c8a2f905c888ffc956ff",
      "created_at" : "2023-12-27T23:53:01Z",
      "diff_hunk" : "@@ -320,10 +321,13 @@ void BlockManager::FindFilesToPrune(\n         // On a prune event, the chainstate DB is flushed.\n         // To avoid excessive prune events negating the benefit of high dbcache\n         // values, we should not prune too rapidly.\n-        // So when pruning in IBD, increase the buffer a bit to avoid a re-prune too soon.\n-        if (chainman.IsInitialBlockDownload()) {\n-            // Since this is only relevant during IBD, we use a fixed 10%\n-            nBuffer += target / 10;\n+        // So when pruning in IBD, increase the buffer to avoid a re-prune too soon.\n+        const auto chain_tip_height = chain.m_chain.Height();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#discussion_r1437297033",
      "id" : 1437297033,
      "line" : 325,
      "node_id" : "PRRC_kwDOABII585Vq2mJ",
      "original_commit_id" : "d298ff8b62b2624ed390c8a2f905c888ffc956ff",
      "original_line" : 325,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : 17,
      "pull_request_review_id" : 1797569404,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20827",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1437297033/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-12-27T23:53:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1437297033",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK d298ff8b62b2624ed390c8a2f905c888ffc956ff\r\n\r\nRan benchmark with hyperfine:\r\n```\r\nhyperfine --show-output --parameter-list commit 96ec3b67a7a7f968d002e13d6fc227f69b7f07d7,d298ff8b62b2624ed390c8a2f905c888ffc956ff --setup 'git checkout {commit} && make -j$(nproc) src/bitcoind' --prepare 'sync; sudo /sbin/sysctl vm.drop_caches=3; rm -r /home/user/.bitcoin/blocks /home/user/.bitcoin/chainstate' -M 3 './src/bitcoind -dbcache=2000 -prune=2000 -printtoconsole=0 -stopatheight=800000'\r\n```\r\n\r\nResults were 21% faster on this branch :rocket: \r\n```\r\nSummary\r\n  ./src/bitcoind -dbcache=2000 -prune=2000 -printtoconsole=0 -stopatheight=800000 (commit = d298ff8b62b2624ed390c8a2f905c888ffc956ff) ran\r\n    1.21 Â± 0.00 times faster than ./src/bitcoind -dbcache=2000 -prune=2000 -printtoconsole=0 -stopatheight=800000 (commit = 96ec3b67a7a7f968d002e13d6fc227f69b7f07d7)\r\n```",
      "created_at" : "2023-12-30T15:11:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1872545821",
      "id" : 1872545821,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII585vnMgd",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1872545821/reactions"
      },
      "updated_at" : "2023-12-30T15:11:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1872545821",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/237213?v=4",
         "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andrewtoth/followers",
         "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andrewtoth",
         "id" : 237213,
         "login" : "andrewtoth",
         "node_id" : "MDQ6VXNlcjIzNzIxMw==",
         "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
         "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
         "repos_url" : "https://api.github.com/users/andrewtoth/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andrewtoth"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "utACK d298ff8b62b2624ed390c8a2f905c888ffc956ff\r\n\r\nWhile there may be slightly better configurations possible, as @0xB10C pointed out above, I think the 1MB assumption is alright and this is a clear improvement already, so this can be merged and potentially improved later.",
      "created_at" : "2024-01-12T20:20:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1889900815",
      "id" : 1889900815,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII585wpZkP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1889900815/reactions"
      },
      "updated_at" : "2024-01-12T20:20:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1889900815",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK d298ff8b62b2624ed390c8a2f905c888ffc956ff",
      "created_at" : "2024-01-25T20:07:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1910911055",
      "id" : 1910911055,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII585x5jBP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1910911055/reactions"
      },
      "updated_at" : "2024-01-25T20:07:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1910911055",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "15% improvement in IBD performance in some configurations seems significant enough for a release note, no?",
      "created_at" : "2024-02-28T19:18:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20827#issuecomment-1969681537",
      "id" : 1969681537,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20827",
      "node_id" : "IC_kwDOABII5851ZvSB",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1969681537/reactions"
      },
      "updated_at" : "2024-02-28T19:18:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1969681537",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/43024885?v=4",
         "events_url" : "https://api.github.com/users/vostrnad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vostrnad/followers",
         "following_url" : "https://api.github.com/users/vostrnad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vostrnad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vostrnad",
         "id" : 43024885,
         "login" : "vostrnad",
         "node_id" : "MDQ6VXNlcjQzMDI0ODg1",
         "organizations_url" : "https://api.github.com/users/vostrnad/orgs",
         "received_events_url" : "https://api.github.com/users/vostrnad/received_events",
         "repos_url" : "https://api.github.com/users/vostrnad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vostrnad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vostrnad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vostrnad"
      }
   }
]
