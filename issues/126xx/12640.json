{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "Since #11100, in init.cpp `-blockmaxsize` is translated to `-blockmaxweight` with the code:\r\n\r\n```\r\n        unsigned int max_size = gArgs.GetArg(\"-blockmaxsize\", 0);\r\n        if (gArgs.SoftSetArg(\"blockmaxweight\", strprintf(\"%d\", max_size * WITNESS_SCALE_FACTOR))) {\r\n```\r\nHowever SoftSetArg requires the argument to be specified with the leading dash (ie, as `SoftSetArg(\"-blockmaxweight\")`) without the dash the value will not be looked up later (because the later lookups specify it with a dash).\r\n\r\nObvious fix is just to add the dash (`SoftSetArg(\"-blockmaxweight\", ...)`), but if there haven't been any complaints, just removing the option entirely might be better, since current behaviour is the same as if the option is just removed.\r\n\r\nI believe this applies to master, 0.16 and 0.15 (due to backport via #11592).\r\n\r\nTest case to demonstrate:\r\n\r\n```\r\n#!/usr/bin/env python3\r\n\"\"\"Test limiting maxblocksize\"\"\"\r\n\r\nfrom test_framework.test_framework import BitcoinTestFramework\r\nfrom test_framework.util import *\r\n\r\nclass MaxBlockSizeTest(BitcoinTestFramework):\r\n    def set_test_params(self):\r\n        self.num_nodes = 2\r\n        self.extra_args = [[\"-blockmaxweight=40000\"], [\"-blockmaxsize=10000\"]]\r\n\r\n    def run_test(self):\r\n        chain_height = self.nodes[0].getblockcount()\r\n        assert_equal(chain_height, 200)\r\n        self.nodes[0].generate(100)\r\n        self.nodes[1].generate(100)\r\n        self.nodes[0].generate(100) # unspendable\r\n\r\n        blk = [None,None]\r\n        for n in [0,1]:\r\n            vsize = 0\r\n            address = self.nodes[n].getnewaddress()\r\n            txes = 0\r\n            while vsize*4 < 84000:\r\n                txid = self.nodes[n].sendtoaddress(address, 0.25)\r\n                tx = self.nodes[n].getrawtransaction(txid, 1)\r\n                vsize += tx[\"vsize\"]\r\n                txes += 1\r\n            self.nodes[n].generate(1)\r\n            blk[n] = self.nodes[n].getblock(self.nodes[n].getbestblockhash())\r\n            self.sync_all()\r\n\r\n        assert blk[0][\"weight\"] <= 40000, \"blockmaxweight greater than 40000\"\r\n        assert blk[1][\"size\"] <= 10000 or blk[1][\"weight\"] <= 40000, \"blockmaxsize is greater than 10000\"\r\n\r\nif __name__ == '__main__':\r\n    MaxBlockSizeTest().main()\r\n```\r\n\r\nCc @jnewbery (who picked this up via an assertion failure in #11862) @TheBlueMatt (who did the original PR)",
   "closed_at" : "2018-03-26T13:31:33Z",
   "closed_by" : {
      "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
      "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
      "followers_url" : "https://api.github.com/users/laanwj/followers",
      "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/laanwj",
      "id" : 126646,
      "login" : "laanwj",
      "organizations_url" : "https://api.github.com/users/laanwj/orgs",
      "received_events_url" : "https://api.github.com/users/laanwj/received_events",
      "repos_url" : "https://api.github.com/users/laanwj/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/laanwj"
   },
   "comments" : 1,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12640/comments",
   "created_at" : "2018-03-07T21:54:12Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12640/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/12640",
   "id" : 303273908,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12640/labels{/name}",
   "locked" : false,
   "milestone" : {
      "closed_at" : null,
      "closed_issues" : 12,
      "created_at" : "2018-01-30T11:31:46Z",
      "creator" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      },
      "description" : "",
      "due_on" : null,
      "html_url" : "https://github.com/bitcoin/bitcoin/milestone/34",
      "id" : 3074572,
      "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/milestones/34/labels",
      "number" : 34,
      "open_issues" : 6,
      "state" : "open",
      "title" : "0.16.1",
      "updated_at" : "2018-03-26T13:31:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/milestones/34"
   },
   "number" : 12640,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "blockmaxsize parameter has no effect",
   "updated_at" : "2018-03-26T13:31:33Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12640",
   "user" : {
      "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
      "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
      "followers_url" : "https://api.github.com/users/ajtowns/followers",
      "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
      "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/ajtowns",
      "id" : 127186,
      "login" : "ajtowns",
      "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
      "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
      "repos_url" : "https://api.github.com/users/ajtowns/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/ajtowns"
   }
}
