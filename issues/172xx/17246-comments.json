[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#17260](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17260.html) (Split some CWallet functions into new LegacyScriptPubKeyMan by achow101)\n* [#17237](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17237.html) (wallet: LearnRelatedScripts only if KeepDestination by promag)\n* [#16546](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16546.html) ([WIP] External signer support - Wallet Box edition by Sjors)\n* [#16528](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16528.html) ([WIP] Native Descriptor Wallets (take 2) by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-10-25T13:12:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17246#issuecomment-546348011",
      "id" : 546348011,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17246",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NjM0ODAxMQ==",
      "updated_at" : "2019-10-25T22:51:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/546348011",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I don't think this is really the right approach to allowing subtractFeeFromOutputs. Instead of passing along subtractFeeFromOutputs to BnB, I think it makes more sense to just change the effective_values of each input to be nValue and change the non_input_fees to 0, BnB doesn't need to know whether subtractFeeFromOutputs is being used.\r\n\r\nI can work on this as an alternative if you'd like.",
      "created_at" : "2019-10-25T15:47:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17246#issuecomment-546407539",
      "id" : 546407539,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17246",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NjQwNzUzOQ==",
      "updated_at" : "2019-10-25T15:47:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/546407539",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Happy to see an alternative approach. Ideally though, I think BnB _should_ know about `subtractFeeFromOutputs`. It should try to find a set of coins as close to the target as possible, minizing the fees subtracted from the output. With regular wallets this doesn't matter much, but if you have to choose between spending a P2WPK coin or some 15-of-15 multisig it does.",
      "created_at" : "2019-10-25T18:17:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17246#issuecomment-546458438",
      "id" : 546458438,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17246",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NjQ1ODQzOA==",
      "updated_at" : "2019-10-25T18:17:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/546458438",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Ideally though, I think BnB _should_ know about `subtractFeeFromOutputs`. It should try to find a set of coins as close to the target as possible, minizing the fees subtracted from the output. With regular wallets this doesn't matter much, but if you have to choose between spending a P2WPK coin or some 15-of-15 multisig it does.\r\n\r\nBnB should already be minimizing transaction fees as part of reducing \"waste\".\r\n\r\n",
      "created_at" : "2019-10-25T18:55:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17246#issuecomment-546471871",
      "id" : 546471871,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17246",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NjQ3MTg3MQ==",
      "updated_at" : "2019-10-25T18:55:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/546471871",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "If the effective value of inputs is equal to their nominal value then, afaik, waste reduction only tries to find the smallest possible set of coins. It won't optimize for which coins are cheapest to spend based on (witness) size.",
      "created_at" : "2019-10-25T19:06:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17246#issuecomment-546475664",
      "id" : 546475664,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17246",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NjQ3NTY2NA==",
      "updated_at" : "2019-10-25T19:06:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/546475664",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I looked more closely at your changes, and it seems like you've actually done what I suggested, just in a more verbose way. It could be done with fewer changes.",
      "created_at" : "2019-10-25T22:45:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17246#issuecomment-546536581",
      "id" : 546536581,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17246",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NjUzNjU4MQ==",
      "updated_at" : "2019-10-25T22:45:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/546536581",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "That's probably because I went all over the place while trying to get this to work, and chased down a few other rabbit holes (like trying to make BnB find a solution with `subtractFeeFromOutputs` that actually takes input fees into account). Happy to shorten it a bit.",
      "created_at" : "2019-10-26T08:47:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17246#issuecomment-546583893",
      "id" : 546583893,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17246",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NjU4Mzg5Mw==",
      "updated_at" : "2019-10-26T08:48:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/546583893",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   }
]
