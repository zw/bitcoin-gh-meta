[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I assume libnatpmp should be subtree'd or we should still use the version linked-against in miniupnpc?\n\nOn January 28, 2018 8:15:18 PM UTC, Annanay Agarwal <notifications@github.com> wrote:\n>Adds minimal support for NATPMP (and removes dependency on external\n>UPnP library). Reference implementation in `miniupnp/libnatpmp`.\n>\n>WIP but aims to fix #11902 .\n>You can view, comment on, or merge this pull request online at:\n>\n>  https://github.com/bitcoin/bitcoin/pull/12288\n>\n>-- Commit Summary --\n>\n>* Add basic NATPMP support, get gateway by file parsing,\n>getpublicaddress, map public-private port\n>\n>-- File Changes --\n>\n>    A src/getgateway.c (570)\n>    A src/getgateway.h (47)\n>    A src/natpmp.c (354)\n>    A src/natpmp.h (182)\n>    M src/net.cpp (187)\n>    A src/wingettimeofday.c (60)\n>    A src/wingettimeofday.h (36)\n>\n>-- Patch Links --\n>\n>https://github.com/bitcoin/bitcoin/pull/12288.patch\n>https://github.com/bitcoin/bitcoin/pull/12288.diff\n>\n>-- \n>You are receiving this because you are subscribed to this thread.\n>Reply to this email directly or view it on GitHub:\n>https://github.com/bitcoin/bitcoin/pull/12288\n",
      "created_at" : "2018-01-28T20:37:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12288#issuecomment-361093713",
      "id" : 361093713,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12288",
      "updated_at" : "2018-01-28T20:37:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/361093713",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "This PR just copies 6 files from libnatpmp into the repository. Perhaps this is a sufficiently low amount of code that we want to do this (like with tinyformat), but if so, putting them in a subdirectory together may be better.\n\nI haven't checked how much changes were necessary to them, but if it was 0, perhaps we can subtree but still build them directly from our build system (as opposed to building as a library and linking statically).",
      "created_at" : "2018-01-28T20:42:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12288#issuecomment-361094071",
      "id" : 361094071,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12288",
      "updated_at" : "2018-01-28T20:42:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/361094071",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "There are minor changes to the copied files, some including changing the `WIN32` macro, and others according to the coding guidelines like changing `NULL` to `nullptr`, etc.\r\n\r\n",
      "created_at" : "2018-01-29T05:45:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12288#issuecomment-361145997",
      "id" : 361145997,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12288",
      "updated_at" : "2018-01-29T05:45:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/361145997",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/10982987?v=4",
         "events_url" : "https://api.github.com/users/annanay25/events{/privacy}",
         "followers_url" : "https://api.github.com/users/annanay25/followers",
         "following_url" : "https://api.github.com/users/annanay25/following{/other_user}",
         "gists_url" : "https://api.github.com/users/annanay25/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/annanay25",
         "id" : 10982987,
         "login" : "annanay25",
         "organizations_url" : "https://api.github.com/users/annanay25/orgs",
         "received_events_url" : "https://api.github.com/users/annanay25/received_events",
         "repos_url" : "https://api.github.com/users/annanay25/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/annanay25/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/annanay25/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/annanay25"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "libnatpmp seems to have been virtually unmaintained a while (last commit was Mar 15, 2016), so I think it doesn't matter whether we use 'subtree'. It might be easier to just include the (small) implementation files into our build system and see if we can maintain it ourselves, cutting out parts we don't need.\r\n\r\nAt least now we don't have to carry the `.java`s.\r\n\r\n> putting them in a subdirectory together may be better.\r\n\r\nI agree with that - whatever you do, please don't put them in `src/` root.",
      "created_at" : "2018-01-29T09:02:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12288#issuecomment-361180620",
      "id" : 361180620,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12288",
      "updated_at" : "2018-01-29T09:02:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/361180620",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "This is failing the travis build - did you perhaps forget to add `natpmp.h` to the makefile, so that it's not included in make dist?\r\n```\r\nMaking check in src\r\nmake[1]: Entering directory `/home/travis/build/bitcoin/bitcoin/build/bitcoin-i686-w64-mingw32/src'\r\nmake[2]: Entering directory `/home/travis/build/bitcoin/bitcoin/build/bitcoin-i686-w64-mingw32/src'\r\n  CXX      libbitcoin_server_a-net.o\r\n  CXX      libbitcoin_server_a-noui.o\r\n  CXX      libbitcoin_server_a-pow.o\r\n  CXX      libbitcoin_server_a-rest.o\r\nnet.cpp:31:20: fatal error: natpmp.h: No such file or directory\r\n #include <natpmp.h>\r\n                    ^\r\ncompilation terminated.\r\nmake[2]: *** [libbitcoin_server_a-net.o] Error 1\r\nmake[2]: *** Waiting for unfinished jobs....\r\nmake[2]: Leaving directory `/home/travis/build/bitcoin/bitcoin/build/bitcoin-i686-w64-mingw32/src'\r\nmake[1]: *** [check-recursive] Error 1\r\nmake[1]: Leaving directory `/home/travis/build/bitcoin/bitcoin/build/bitcoin-i686-w64-mingw32/src'\r\nmake: *** [check-recursive] Error 1\r\n```",
      "created_at" : "2018-02-08T16:06:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12288#issuecomment-364159788",
      "id" : 364159788,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12288",
      "updated_at" : "2018-02-08T16:06:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/364159788",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@laanwj ;\r\n\r\nI'm a little confused with the name mangling happening here. The `src/natpmp/*.c` files have `extern \"C\"` in the function prototypes, which confirms no name mangling (confirmed this with `nm src/natpmp/libbitcoin_server_a-natpmp.o | grep initnatpmp`), but C++ object files are looking for mangled function names?",
      "created_at" : "2018-03-13T07:36:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12288#issuecomment-372573415",
      "id" : 372573415,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12288",
      "updated_at" : "2018-03-13T07:36:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372573415",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/10982987?v=4",
         "events_url" : "https://api.github.com/users/annanay25/events{/privacy}",
         "followers_url" : "https://api.github.com/users/annanay25/followers",
         "following_url" : "https://api.github.com/users/annanay25/following{/other_user}",
         "gists_url" : "https://api.github.com/users/annanay25/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/annanay25",
         "id" : 10982987,
         "login" : "annanay25",
         "organizations_url" : "https://api.github.com/users/annanay25/orgs",
         "received_events_url" : "https://api.github.com/users/annanay25/received_events",
         "repos_url" : "https://api.github.com/users/annanay25/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/annanay25/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/annanay25/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/annanay25"
      }
   }
]
