[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#15606](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15606.html) ([experimental] UTXO snapshots by jamesob)\n* [#15493](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15493.html) (rfc: Add -printconfig arg to bitcoind by promag)\n* [#13751](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/13751.html) (Utils and libraries: Drops the boost/algorithm/string/split.hpp dependency by 251Labs)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-04-18T21:25:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#issuecomment-484694957",
      "id" : 484694957,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15849",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NDY5NDk1Nw==",
      "updated_at" : "2019-04-26T21:07:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/484694957",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2019-04-23T11:33:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#issuecomment-485765187",
      "id" : 485765187,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15849",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NTc2NTE4Nw==",
      "updated_at" : "2019-04-23T11:33:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/485765187",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r278733529"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/278733529"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think this is a pessimizing move which prevents copy elision.",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-25T21:11:26Z",
      "diff_hunk" : "@@ -196,29 +199,31 @@ std::string BCLog::Logger::LogTimestampStr(const std::string &str)\n     } else\n         strStamped = str;\n \n-    if (!str.empty() && str[str.size()-1] == '\\n')\n-        m_started_new_line = true;\n-    else\n-        m_started_new_line = false;\n-\n     return strStamped;\n }\n \n void BCLog::Logger::LogPrintStr(const std::string &str)\n {\n-    std::string strTimestamped = LogTimestampStr(str);\n+    std::string strPrefixed = str;\n+\n+    if (m_log_threadnames && m_started_new_line)\n+        strPrefixed.insert(0, \"[\" + std::move(thread_util::GetInternalName()) + \"] \");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r278733529",
      "id" : 278733529,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3ODczMzUyOQ==",
      "original_commit_id" : "a0ca62b189fc65c960e9b3fc180eaaa7bc13b8cc",
      "original_position" : 37,
      "path" : "src/logging.cpp",
      "position" : null,
      "pull_request_review_id" : 230887187,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/278733529",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r278735199"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/278735199"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Reorder to match the order the compiler will use (which is the order of declaration): so please put `fTry` first :-)",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-25T21:16:25Z",
      "diff_hunk" : "@@ -37,23 +39,23 @@ void PrintLockContention(const char* pszName, const char* pszFile, int nLine)\n //\n \n struct CLockLocation {\n-    CLockLocation(const char* pszName, const char* pszFile, int nLine, bool fTryIn)\n-    {\n-        mutexName = pszName;\n-        sourceFile = pszFile;\n-        sourceLine = nLine;\n-        fTry = fTryIn;\n-    }\n+    CLockLocation(\n+        const char* pszName, const char* pszFile, int nLine, bool fTryIn, std::string thread_name_) :\n+            mutexName(pszName), sourceFile(pszFile), sourceLine(nLine), fTry(fTryIn),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r278735199",
      "id" : 278735199,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3ODczNTE5OQ==",
      "original_commit_id" : "a0ca62b189fc65c960e9b3fc180eaaa7bc13b8cc",
      "original_position" : 25,
      "path" : "src/sync.cpp",
      "position" : null,
      "pull_request_review_id" : 230887187,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/278735199",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r278960448"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/278960448"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed, thanks.",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T13:59:05Z",
      "diff_hunk" : "@@ -196,29 +199,31 @@ std::string BCLog::Logger::LogTimestampStr(const std::string &str)\n     } else\n         strStamped = str;\n \n-    if (!str.empty() && str[str.size()-1] == '\\n')\n-        m_started_new_line = true;\n-    else\n-        m_started_new_line = false;\n-\n     return strStamped;\n }\n \n void BCLog::Logger::LogPrintStr(const std::string &str)\n {\n-    std::string strTimestamped = LogTimestampStr(str);\n+    std::string strPrefixed = str;\n+\n+    if (m_log_threadnames && m_started_new_line)\n+        strPrefixed.insert(0, \"[\" + std::move(thread_util::GetInternalName()) + \"] \");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r278960448",
      "id" : 278960448,
      "in_reply_to_id" : 278733529,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3ODk2MDQ0OA==",
      "original_commit_id" : "a0ca62b189fc65c960e9b3fc180eaaa7bc13b8cc",
      "original_position" : 37,
      "path" : "src/logging.cpp",
      "position" : null,
      "pull_request_review_id" : 231171652,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/278960448",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r278960491"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/278960491"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed, thanks.",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T13:59:11Z",
      "diff_hunk" : "@@ -37,23 +39,23 @@ void PrintLockContention(const char* pszName, const char* pszFile, int nLine)\n //\n \n struct CLockLocation {\n-    CLockLocation(const char* pszName, const char* pszFile, int nLine, bool fTryIn)\n-    {\n-        mutexName = pszName;\n-        sourceFile = pszFile;\n-        sourceLine = nLine;\n-        fTry = fTryIn;\n-    }\n+    CLockLocation(\n+        const char* pszName, const char* pszFile, int nLine, bool fTryIn, std::string thread_name_) :\n+            mutexName(pszName), sourceFile(pszFile), sourceLine(nLine), fTry(fTryIn),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r278960491",
      "id" : 278960491,
      "in_reply_to_id" : 278735199,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3ODk2MDQ5MQ==",
      "original_commit_id" : "a0ca62b189fc65c960e9b3fc180eaaa7bc13b8cc",
      "original_position" : 25,
      "path" : "src/sync.cpp",
      "position" : null,
      "pull_request_review_id" : 231171709,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/278960491",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279014719"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279014719"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"disable thread_local on unreliable platforms\" (c1d159999c6fc2b81fb8d0caf7d68a744d127fb8)\r\n\r\nCommit message is misleading. It sounds like this disables the `thread_local` keyword when actually it disables the `HAVE_THREAD_LOCAL` macro. Would suggest: \"disable HAVE_THREAD_LOCAL on unreliable platforms\" and mentioning that this doesn't affect anything except the DEBUG_LOCKCONTENTION implementation.",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T16:14:54Z",
      "diff_hunk" : "@@ -827,8 +827,23 @@ AC_LINK_IFELSE([AC_LANG_SOURCE([\n   }\n   ])],\n   [\n-    AC_DEFINE(HAVE_THREAD_LOCAL,1,[Define if thread_local is supported.])\n-    AC_MSG_RESULT(yes)\n+   case $host in",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279014719",
      "id" : 279014719,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTAxNDcxOQ==",
      "original_commit_id" : "c1d159999c6fc2b81fb8d0caf7d68a744d127fb8",
      "original_position" : 6,
      "path" : "configure.ac",
      "position" : 6,
      "pull_request_review_id" : 231243081,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279014719",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279019382"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279019382"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"threads: introduce threadutil, refactor thread naming\" (91cc480ddde33e92d87795d72ff28658bcc88877)\r\n\r\nNow that we have a util directory, I'd suggest calling this `util/threadnames.h` or `util/threads.h`.\r\n\r\nI'd also suggest going with `util::ThreadRename` instead of `thread_util::Rename`. Even though we're only doing it a few places, and it's less important in smaller projects like ours, I think its nice when c++ namespaces just mirror directory paths:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/5046d4e911aa5ef4d546e8a6d66ca1810c89592a/src/util/system.h#L369\r\nhttps://github.com/bitcoin/bitcoin/blob/5046d4e911aa5ef4d546e8a6d66ca1810c89592a/src/interfaces/chain.h#L28",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T16:29:29Z",
      "diff_hunk" : "@@ -194,6 +194,7 @@ BITCOIN_CORE_H = \\\n   support/events.h \\\n   support/lockedpool.h \\\n   sync.h \\\n+  threadutil.h \\",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279019382",
      "id" : 279019382,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTAxOTM4Mg==",
      "original_commit_id" : "91cc480ddde33e92d87795d72ff28658bcc88877",
      "original_position" : 4,
      "path" : "src/Makefile.am",
      "position" : null,
      "pull_request_review_id" : 231243081,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279019382",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279020898"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279020898"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"threads: introduce threadutil, refactor thread naming\" (91cc480ddde33e92d87795d72ff28658bcc88877)\r\n\r\nSuggest formatting with clang-format. Namespace contents shouldn't be indented here.",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T16:34:48Z",
      "diff_hunk" : "@@ -0,0 +1,22 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_THREADUTIL_H\n+#define BITCOIN_THREADUTIL_H\n+\n+#include <string>\n+\n+namespace thread_util\n+{\n+    //! Rename a thread both in terms of an internal (in-memory) name as well",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279020898",
      "id" : 279020898,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTAyMDg5OA==",
      "original_commit_id" : "91cc480ddde33e92d87795d72ff28658bcc88877",
      "original_position" : 12,
      "path" : "src/threadutil.h",
      "position" : null,
      "pull_request_review_id" : 231243081,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279020898",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279024642"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279024642"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"threads: introduce threadutil, refactor thread naming\" (91cc480ddde33e92d87795d72ff28658bcc88877)\r\n\r\nNot sure if you still have any efficiency concerns at this point, but just in case you do, it would be possible to avoid a copy and allocation here by changing the return type to `const std::string&`",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T16:45:55Z",
      "diff_hunk" : "@@ -0,0 +1,22 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_THREADUTIL_H\n+#define BITCOIN_THREADUTIL_H\n+\n+#include <string>\n+\n+namespace thread_util\n+{\n+    //! Rename a thread both in terms of an internal (in-memory) name as well\n+    //! as its system thread name.\n+    void Rename(const std::string&);\n+\n+    //! Get the thread's internal (in-memory) name; used e.g. for identification in\n+    //! logging.\n+    std::string GetInternalName();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279024642",
      "id" : 279024642,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTAyNDY0Mg==",
      "original_commit_id" : "91cc480ddde33e92d87795d72ff28658bcc88877",
      "original_position" : 18,
      "path" : "src/threadutil.h",
      "position" : null,
      "pull_request_review_id" : 231243081,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279024642",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279025599"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279025599"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"threads: introduce threadutil, refactor thread naming\" (91cc480ddde33e92d87795d72ff28658bcc88877)\r\n\r\nNote: Maybe obvious, but just in case it helps other reviewers, this code is unchanged (easy to verify with `git log -p -n1 --color-moved=dimmed_zebra`)",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T16:48:55Z",
      "diff_hunk" : "@@ -0,0 +1,56 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#if defined(HAVE_CONFIG_H)\n+#include <config/bitcoin-config.h>\n+#endif\n+\n+#include <atomic>\n+#include <thread>\n+\n+#include <threadutil.h>\n+\n+#ifdef HAVE_SYS_PRCTL_H\n+#include <sys/prctl.h> // For prctl, PR_SET_NAME, PR_GET_NAME\n+#endif\n+\n+//! Set the thread's name at the process level. Does not affect the\n+//! internal name.\n+static void SetThreadName(const char* name)\n+{\n+#if defined(PR_SET_NAME)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279025599",
      "id" : 279025599,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTAyNTU5OQ==",
      "original_commit_id" : "91cc480ddde33e92d87795d72ff28658bcc88877",
      "original_position" : 22,
      "path" : "src/threadutil.cpp",
      "position" : null,
      "pull_request_review_id" : 231243081,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279025599",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279027141"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279027141"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"tests: add threadutil tests\" (553a4d660b3cd4b9ed1ea66b780bf001081eaa64)\r\n\r\nNice test!",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T16:53:31Z",
      "diff_hunk" : "@@ -0,0 +1,73 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <threadutil.h>\n+#include <test/setup_common.h>\n+\n+#include <thread>\n+#include <vector>\n+#include <set>\n+#include <mutex>\n+\n+#if defined(HAVE_CONFIG_H)\n+#include <config/bitcoin-config.h>\n+#endif\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_FIXTURE_TEST_SUITE(threadutil_tests, BasicTestingSetup)\n+\n+std::string TEST_THREAD_NAME_BASE = \"test_thread.\";\n+\n+/**\n+ * Run a bunch of threads to all call thread_util::rename.\n+ *\n+ * @return the set of name each thread has after attempted renaming.\n+ */\n+std::set<std::string> RenameEnMasse(int num_threads)\n+{\n+    std::vector<std::thread> threads;\n+    std::set<std::string> names;\n+    std::mutex lock;\n+\n+    auto RenameThisThread = [&](int i) {\n+        thread_util::Rename(TEST_THREAD_NAME_BASE + std::to_string(i));\n+        std::lock_guard<std::mutex> guard(lock);\n+        names.insert(thread_util::GetInternalName());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279027141",
      "id" : 279027141,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTAyNzE0MQ==",
      "original_commit_id" : "553a4d660b3cd4b9ed1ea66b780bf001081eaa64",
      "original_position" : 37,
      "path" : "src/test/threadutil_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 231243081,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279027141",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279027705"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279027705"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"threads: prefix log messages with thread names\" (4fba3ead9811ebe47161e9e7f535a7cc88403cf5)\r\n\r\nCould sort alphabetically (thread before util)",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T16:55:18Z",
      "diff_hunk" : "@@ -5,6 +5,9 @@\n \n #include <logging.h>\n #include <util/time.h>\n+#include <threadutil.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279027705",
      "id" : 279027705,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTAyNzcwNQ==",
      "original_commit_id" : "4fba3ead9811ebe47161e9e7f535a7cc88403cf5",
      "original_position" : 4,
      "path" : "src/logging.cpp",
      "position" : null,
      "pull_request_review_id" : 231243081,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279027705",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279030836"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279030836"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"threads: add thread names to deadlock debugging message\" (503c1ff6eeeb6e222ff446033745650ba59ab659)\r\n\r\nIn case you do take my earlier suggestion and change `GetInternalName` to return a const string reference instead of a temporary string, you could change this type to a const string reference and avoid any string copy initializing this struct field (it would point directly to the `g_thread_name` instance).",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T17:06:04Z",
      "diff_hunk" : "@@ -37,23 +39,26 @@ void PrintLockContention(const char* pszName, const char* pszFile, int nLine)\n //\n \n struct CLockLocation {\n-    CLockLocation(const char* pszName, const char* pszFile, int nLine, bool fTryIn)\n-    {\n-        mutexName = pszName;\n-        sourceFile = pszFile;\n-        sourceLine = nLine;\n-        fTry = fTryIn;\n-    }\n+    CLockLocation(\n+        const char* pszName, const char* pszFile, int nLine, bool fTryIn, std::string thread_name_) :\n+            fTry(fTryIn),\n+            mutexName(pszName),\n+            sourceFile(pszFile),\n+            thread_name(std::move(thread_name_)),\n+            sourceLine(nLine) { }\n \n     std::string ToString() const\n     {\n-        return mutexName + \"  \" + sourceFile + \":\" + itostr(sourceLine) + (fTry ? \" (TRY)\" : \"\");\n+        return tfm::format(\n+            \"%s %s:%s%s (in thread %s)\",\n+            mutexName, sourceFile, itostr(sourceLine), (fTry ? \" (TRY)\" : \"\"), thread_name);\n     }\n \n private:\n     bool fTry;\n     std::string mutexName;\n     std::string sourceFile;\n+    std::string thread_name;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279030836",
      "id" : 279030836,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTAzMDgzNg==",
      "original_commit_id" : "503c1ff6eeeb6e222ff446033745650ba59ab659",
      "original_position" : 43,
      "path" : "src/sync.cpp",
      "position" : null,
      "pull_request_review_id" : 231243081,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279030836",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279033285"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279033285"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"threads: prefix log messages with thread names\" (4fba3ead9811ebe47161e9e7f535a7cc88403cf5)\r\n\r\nNot sure if you dropped the `&` intentionally here. It would make sense to drop it, so the string could be moved from instead of copied. But you'd also want to drop the `const` and add `std::move` below, and also change the `Logger::LogPrintStr` function similarly (function calling this function).\r\n\r\nWithout these things, I don't think there'd be a reason to drop `&`.",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T17:13:48Z",
      "diff_hunk" : "@@ -174,7 +177,7 @@ std::vector<CLogCategoryActive> ListActiveLogCategories()\n     return ret;\n }\n \n-std::string BCLog::Logger::LogTimestampStr(const std::string &str)\n+std::string BCLog::Logger::LogTimestampStr(const std::string str)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279033285",
      "id" : 279033285,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTAzMzI4NQ==",
      "original_commit_id" : "4fba3ead9811ebe47161e9e7f535a7cc88403cf5",
      "original_position" : 15,
      "path" : "src/logging.cpp",
      "position" : null,
      "pull_request_review_id" : 231243081,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279033285",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279034566"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279034566"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"threads: prefix log messages with thread names\" (4fba3ead9811ebe47161e9e7f535a7cc88403cf5)\r\n\r\nSome unneeded parentheses here",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T17:17:55Z",
      "diff_hunk" : "@@ -196,29 +199,31 @@ std::string BCLog::Logger::LogTimestampStr(const std::string &str)\n     } else\n         strStamped = str;\n \n-    if (!str.empty() && str[str.size()-1] == '\\n')\n-        m_started_new_line = true;\n-    else\n-        m_started_new_line = false;\n-\n     return strStamped;\n }\n \n void BCLog::Logger::LogPrintStr(const std::string &str)\n {\n-    std::string strTimestamped = LogTimestampStr(str);\n+    std::string strPrefixed = str;\n+\n+    if (m_log_threadnames && m_started_new_line)\n+        strPrefixed.insert(0, \"[\" + thread_util::GetInternalName() + \"] \");\n+\n+    strPrefixed = LogTimestampStr(strPrefixed);\n+\n+    m_started_new_line = (!str.empty() && str[str.size()-1] == '\\n');",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279034566",
      "id" : 279034566,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTAzNDU2Ng==",
      "original_commit_id" : "4fba3ead9811ebe47161e9e7f535a7cc88403cf5",
      "original_position" : 41,
      "path" : "src/logging.cpp",
      "position" : null,
      "pull_request_review_id" : 231243081,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279034566",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279035502"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279035502"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"threads: prefix log messages with thread names\" (4fba3ead9811ebe47161e9e7f535a7cc88403cf5)\r\n\r\nSince this is renaming, could go to with current lowercase convention.",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T17:20:50Z",
      "diff_hunk" : "@@ -196,29 +199,31 @@ std::string BCLog::Logger::LogTimestampStr(const std::string &str)\n     } else\n         strStamped = str;\n \n-    if (!str.empty() && str[str.size()-1] == '\\n')\n-        m_started_new_line = true;\n-    else\n-        m_started_new_line = false;\n-\n     return strStamped;\n }\n \n void BCLog::Logger::LogPrintStr(const std::string &str)\n {\n-    std::string strTimestamped = LogTimestampStr(str);\n+    std::string strPrefixed = str;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279035502",
      "id" : 279035502,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTAzNTUwMg==",
      "original_commit_id" : "4fba3ead9811ebe47161e9e7f535a7cc88403cf5",
      "original_position" : 34,
      "path" : "src/logging.cpp",
      "position" : null,
      "pull_request_review_id" : 231243081,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279035502",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279069419"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279069419"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In making this change I hit some compiler barf that has me out of my depths: https://gist.github.com/jamesob/5a19c75b34a49a4972b4105e0287d79d",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T19:02:33Z",
      "diff_hunk" : "@@ -37,23 +39,26 @@ void PrintLockContention(const char* pszName, const char* pszFile, int nLine)\n //\n \n struct CLockLocation {\n-    CLockLocation(const char* pszName, const char* pszFile, int nLine, bool fTryIn)\n-    {\n-        mutexName = pszName;\n-        sourceFile = pszFile;\n-        sourceLine = nLine;\n-        fTry = fTryIn;\n-    }\n+    CLockLocation(\n+        const char* pszName, const char* pszFile, int nLine, bool fTryIn, std::string thread_name_) :\n+            fTry(fTryIn),\n+            mutexName(pszName),\n+            sourceFile(pszFile),\n+            thread_name(std::move(thread_name_)),\n+            sourceLine(nLine) { }\n \n     std::string ToString() const\n     {\n-        return mutexName + \"  \" + sourceFile + \":\" + itostr(sourceLine) + (fTry ? \" (TRY)\" : \"\");\n+        return tfm::format(\n+            \"%s %s:%s%s (in thread %s)\",\n+            mutexName, sourceFile, itostr(sourceLine), (fTry ? \" (TRY)\" : \"\"), thread_name);\n     }\n \n private:\n     bool fTry;\n     std::string mutexName;\n     std::string sourceFile;\n+    std::string thread_name;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279069419",
      "id" : 279069419,
      "in_reply_to_id" : 279030836,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTA2OTQxOQ==",
      "original_commit_id" : "503c1ff6eeeb6e222ff446033745650ba59ab659",
      "original_position" : 43,
      "path" : "src/sync.cpp",
      "position" : null,
      "pull_request_review_id" : 231314856,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279069419",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@ryanofsky thanks very much for the review. Per usual, your suggested changes are indelibly righteous. I've made all of them save for the last I commented on.",
      "created_at" : "2019-04-26T19:05:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#issuecomment-487167729",
      "id" : 487167729,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15849",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NzE2NzcyOQ==",
      "updated_at" : "2019-04-26T19:05:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/487167729",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279080004"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279080004"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Oh, the relevant part of that error message is:\r\n\r\n```\r\nsync.cpp:133:33: note: in instantiation of member function 'std::vector<std::pair<void *, CLockLocation>, std::allocator<std::pair<void *, CLockLocation> > >::operator=' requested here\r\n        lockdata.lockorders[p1] = g_lockstack;\r\n```\r\n\r\nIt's complaining that it can't copy the g_lockstack variable, which makes sense since adding a reference member to CLockLocation makes it not copyable by default. If inclined, you could work around it by manually defining a CLockLocation copy constructor:\r\n\r\n```\r\nCLockLocation(const CLockLocation& other) : fTry(other.fTry), mutexName(other.mutexName), etc, ... {}\r\n```",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T19:41:37Z",
      "diff_hunk" : "@@ -37,23 +39,26 @@ void PrintLockContention(const char* pszName, const char* pszFile, int nLine)\n //\n \n struct CLockLocation {\n-    CLockLocation(const char* pszName, const char* pszFile, int nLine, bool fTryIn)\n-    {\n-        mutexName = pszName;\n-        sourceFile = pszFile;\n-        sourceLine = nLine;\n-        fTry = fTryIn;\n-    }\n+    CLockLocation(\n+        const char* pszName, const char* pszFile, int nLine, bool fTryIn, std::string thread_name_) :\n+            fTry(fTryIn),\n+            mutexName(pszName),\n+            sourceFile(pszFile),\n+            thread_name(std::move(thread_name_)),\n+            sourceLine(nLine) { }\n \n     std::string ToString() const\n     {\n-        return mutexName + \"  \" + sourceFile + \":\" + itostr(sourceLine) + (fTry ? \" (TRY)\" : \"\");\n+        return tfm::format(\n+            \"%s %s:%s%s (in thread %s)\",\n+            mutexName, sourceFile, itostr(sourceLine), (fTry ? \" (TRY)\" : \"\"), thread_name);\n     }\n \n private:\n     bool fTry;\n     std::string mutexName;\n     std::string sourceFile;\n+    std::string thread_name;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279080004",
      "id" : 279080004,
      "in_reply_to_id" : 279030836,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTA4MDAwNA==",
      "original_commit_id" : "503c1ff6eeeb6e222ff446033745650ba59ab659",
      "original_position" : 43,
      "path" : "src/sync.cpp",
      "position" : null,
      "pull_request_review_id" : 231329131,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279080004",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Reran benchmarking; no performance difference.\r\n\r\n### absolute\r\n|                      name                      | iterations |           master           |      threadnames2.18       |\r\n|------------------------------------------------|-----------:|----------------------------|----------------------------|\r\n| build.make.23.clang                            |          1 | 135.8741 ( 0.0000)        | 133.9639 ( 0.0000)        |\r\n| build.make.23.clang.mem-usage                  |          1 | 648692.0000 ( 0.0000)     | 646632.0000 ( 0.0000)     |\r\n| ibd.local.500000.504000.dbcache=2048           |          3 | 357.4552 ( 1.2016)        | 357.3936 ( 1.1932)        |\r\n| ibd.local.500000.504000.dbcache=2048.mem-usage |          3 | 2240597.3333 ( 3291.6968) | 2237538.6667 ( 4462.0143) |\r\n\r\n### relative\r\n|                      name                      | iterations | master | threadnames2.18 |\r\n|------------------------------------------------|-----------:|-------:|----------------:|\r\n| build.make.23.clang                            |          1 |  1.014 |               1 |\r\n| build.make.23.clang.mem-usage                  |          1 |  1.003 |               1 |\r\n| ibd.local.500000.504000.dbcache=2048           |          3 |  1.000 |               1 |\r\n| ibd.local.500000.504000.dbcache=2048.mem-usage |          3 |  1.001 |               1 |",
      "created_at" : "2019-04-26T20:00:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#issuecomment-487182947",
      "id" : 487182947,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15849",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NzE4Mjk0Nw==",
      "updated_at" : "2019-04-26T20:00:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/487182947",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279086278"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279086278"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think I was wrong. Even with a reference member CLockLocation should still be copyable, just not assignable, so you may be able to fix this by emplacing into lockorders instead of assigning into it.",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T20:03:48Z",
      "diff_hunk" : "@@ -37,23 +39,26 @@ void PrintLockContention(const char* pszName, const char* pszFile, int nLine)\n //\n \n struct CLockLocation {\n-    CLockLocation(const char* pszName, const char* pszFile, int nLine, bool fTryIn)\n-    {\n-        mutexName = pszName;\n-        sourceFile = pszFile;\n-        sourceLine = nLine;\n-        fTry = fTryIn;\n-    }\n+    CLockLocation(\n+        const char* pszName, const char* pszFile, int nLine, bool fTryIn, std::string thread_name_) :\n+            fTry(fTryIn),\n+            mutexName(pszName),\n+            sourceFile(pszFile),\n+            thread_name(std::move(thread_name_)),\n+            sourceLine(nLine) { }\n \n     std::string ToString() const\n     {\n-        return mutexName + \"  \" + sourceFile + \":\" + itostr(sourceLine) + (fTry ? \" (TRY)\" : \"\");\n+        return tfm::format(\n+            \"%s %s:%s%s (in thread %s)\",\n+            mutexName, sourceFile, itostr(sourceLine), (fTry ? \" (TRY)\" : \"\"), thread_name);\n     }\n \n private:\n     bool fTry;\n     std::string mutexName;\n     std::string sourceFile;\n+    std::string thread_name;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279086278",
      "id" : 279086278,
      "in_reply_to_id" : 279030836,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTA4NjI3OA==",
      "original_commit_id" : "503c1ff6eeeb6e222ff446033745650ba59ab659",
      "original_position" : 43,
      "path" : "src/sync.cpp",
      "position" : null,
      "pull_request_review_id" : 231337495,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279086278",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279086419"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279086419"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed by changing the above assignment to `emplace()` per your advice. Thanks!",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T20:04:15Z",
      "diff_hunk" : "@@ -37,23 +39,26 @@ void PrintLockContention(const char* pszName, const char* pszFile, int nLine)\n //\n \n struct CLockLocation {\n-    CLockLocation(const char* pszName, const char* pszFile, int nLine, bool fTryIn)\n-    {\n-        mutexName = pszName;\n-        sourceFile = pszFile;\n-        sourceLine = nLine;\n-        fTry = fTryIn;\n-    }\n+    CLockLocation(\n+        const char* pszName, const char* pszFile, int nLine, bool fTryIn, std::string thread_name_) :\n+            fTry(fTryIn),\n+            mutexName(pszName),\n+            sourceFile(pszFile),\n+            thread_name(std::move(thread_name_)),\n+            sourceLine(nLine) { }\n \n     std::string ToString() const\n     {\n-        return mutexName + \"  \" + sourceFile + \":\" + itostr(sourceLine) + (fTry ? \" (TRY)\" : \"\");\n+        return tfm::format(\n+            \"%s %s:%s%s (in thread %s)\",\n+            mutexName, sourceFile, itostr(sourceLine), (fTry ? \" (TRY)\" : \"\"), thread_name);\n     }\n \n private:\n     bool fTry;\n     std::string mutexName;\n     std::string sourceFile;\n+    std::string thread_name;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279086419",
      "id" : 279086419,
      "in_reply_to_id" : 279030836,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTA4NjQxOQ==",
      "original_commit_id" : "503c1ff6eeeb6e222ff446033745650ba59ab659",
      "original_position" : 43,
      "path" : "src/sync.cpp",
      "position" : null,
      "pull_request_review_id" : 231337689,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279086419",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279089809"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279089809"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"threads: introduce threadutil, refactor thread naming\" (1cf8779ee2887e3c8ea0265fe8bbb9ecbd502172)\r\n\r\nSorry, this is from a change I suggested, but it isn't really safe (and causes a warning): \r\n\r\n```\r\nutil/threadnames.cpp:48:59: warning: returning reference to local temporary object [-Wreturn-stack-address]\r\nconst std::string& util::ThreadGetInternalName() { return \"\"; }\r\n```\r\n\r\nShould do something like:\r\n\r\n```c++\r\nstatic const std::string empty_string;\r\nconst std::string& util::ThreadGetInternalName() { return empty_string; }\r\n```",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T20:16:13Z",
      "diff_hunk" : "@@ -0,0 +1,56 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#if defined(HAVE_CONFIG_H)\n+#include <config/bitcoin-config.h>\n+#endif\n+\n+#include <atomic>\n+#include <thread>\n+\n+#include <util/threadnames.h>\n+\n+#ifdef HAVE_SYS_PRCTL_H\n+#include <sys/prctl.h> // For prctl, PR_SET_NAME, PR_GET_NAME\n+#endif\n+\n+//! Set the thread's name at the process level. Does not affect the\n+//! internal name.\n+static void SetThreadName(const char* name)\n+{\n+#if defined(PR_SET_NAME)\n+    // Only the first 15 characters are used (16 - NUL terminator)\n+    ::prctl(PR_SET_NAME, name, 0, 0, 0);\n+#elif (defined(__FreeBSD__) || defined(__OpenBSD__) || defined(__DragonFly__))\n+    pthread_set_name_np(pthread_self(), name);\n+#elif defined(MAC_OSX)\n+    pthread_setname_np(name);\n+#else\n+    // Prevent warnings for unused parameters...\n+    (void)name;\n+#endif\n+}\n+\n+// If we have thread_local, just keep thread ID and name in a thread_local\n+// global.\n+#if defined(HAVE_THREAD_LOCAL)\n+\n+static thread_local std::string g_thread_name;\n+const std::string& util::ThreadGetInternalName() { return g_thread_name; }\n+//! Set the in-memory internal name for this thread. Does not affect the process\n+//! name.\n+static void SetInternalName(const std::string& name) { g_thread_name = name; }\n+\n+// Without thread_local available, don't handle internal name at all.\n+#else\n+\n+const std::string& util::ThreadGetInternalName() { return \"\"; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279089809",
      "id" : 279089809,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTA4OTgwOQ==",
      "original_commit_id" : "1cf8779ee2887e3c8ea0265fe8bbb9ecbd502172",
      "original_position" : 48,
      "path" : "src/util/threadnames.cpp",
      "position" : null,
      "pull_request_review_id" : 231342078,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279089809",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279090696"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279090696"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"threads: introduce threadutil, refactor thread naming\" (1cf8779ee2887e3c8ea0265fe8bbb9ecbd502172)\r\n\r\nShould use `BITCOIN_UTIL_THREADNAMES_H`. Also commit message text reference previous names and could be updated.",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T20:19:26Z",
      "diff_hunk" : "@@ -0,0 +1,21 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_THREADUTIL_H\n+#define BITCOIN_THREADUTIL_H",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279090696",
      "id" : 279090696,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTA5MDY5Ng==",
      "original_commit_id" : "1cf8779ee2887e3c8ea0265fe8bbb9ecbd502172",
      "original_position" : 6,
      "path" : "src/util/threadnames.h",
      "position" : null,
      "pull_request_review_id" : 231342078,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279090696",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@ryanofsky Oops! Thanks, pushed.",
      "created_at" : "2019-04-26T20:26:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#issuecomment-487190570",
      "id" : 487190570,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15849",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NzE5MDU3MA==",
      "updated_at" : "2019-04-26T20:26:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/487190570",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279116351"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279116351"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in commit 195ba388eb tests: add threadutil tests\r\n\r\n\r\nstyle-nit: Should be `const`, since it is upper cased?",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T22:03:37Z",
      "diff_hunk" : "@@ -0,0 +1,73 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <util/threadnames.h>\n+#include <test/setup_common.h>\n+\n+#include <thread>\n+#include <vector>\n+#include <set>\n+#include <mutex>\n+\n+#if defined(HAVE_CONFIG_H)\n+#include <config/bitcoin-config.h>\n+#endif\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_FIXTURE_TEST_SUITE(util_threadnames_tests, BasicTestingSetup)\n+\n+std::string TEST_THREAD_NAME_BASE = \"test_thread.\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279116351",
      "id" : 279116351,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTExNjM1MQ==",
      "original_commit_id" : "043a3876396a13f2810bf97e8c79684866e3491d",
      "original_position" : 21,
      "path" : "src/test/util_threadnames_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 231375470,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279116351",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279117759"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279117759"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why does the OP say it is off by default, but the code and release notes otherwise?\r\n\r\n```\r\n static const bool DEFAULT_LOGTHREADNAMES = true;",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T22:10:37Z",
      "diff_hunk" : "@@ -0,0 +1,6 @@\n+Thread names in logs\n+--------------------\n+\n+On platforms supporting `thread_local`, log lines are now prefixed by default\n+with the name of the thread that caused the log. To disable this behavior,\n+specify `-logthreadnames=0`.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279117759",
      "id" : 279117759,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTExNzc1OQ==",
      "original_commit_id" : "043a3876396a13f2810bf97e8c79684866e3491d",
      "original_position" : 6,
      "path" : "doc/release-notes-pr13168.md",
      "position" : 6,
      "pull_request_review_id" : 231375470,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279117759",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279119514"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279119514"
         }
      },
      "author_association" : "MEMBER",
      "body" : "style-nit: in commit 951769cf12 threads: prefix log messages with thread names\r\n\r\nCould add `{}`, according to developer notes for new code?",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T22:20:17Z",
      "diff_hunk" : "@@ -196,29 +199,31 @@ std::string BCLog::Logger::LogTimestampStr(const std::string &str)\n     } else\n         strStamped = str;\n \n-    if (!str.empty() && str[str.size()-1] == '\\n')\n-        m_started_new_line = true;\n-    else\n-        m_started_new_line = false;\n-\n     return strStamped;\n }\n \n void BCLog::Logger::LogPrintStr(const std::string &str)\n {\n-    std::string strTimestamped = LogTimestampStr(str);\n+    std::string str_prefixed = str;\n+\n+    if (m_log_threadnames && m_started_new_line)\n+        str_prefixed.insert(0, \"[\" + util::ThreadGetInternalName() + \"] \");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279119514",
      "id" : 279119514,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTExOTUxNA==",
      "original_commit_id" : "043a3876396a13f2810bf97e8c79684866e3491d",
      "original_position" : 39,
      "path" : "src/logging.cpp",
      "position" : 39,
      "pull_request_review_id" : 231375470,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279119514",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279122981"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279122981"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Wowow, something must've gotten screwed up in a rebase. Fixing - thanks for the catch.",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T22:40:27Z",
      "diff_hunk" : "@@ -0,0 +1,6 @@\n+Thread names in logs\n+--------------------\n+\n+On platforms supporting `thread_local`, log lines are now prefixed by default\n+with the name of the thread that caused the log. To disable this behavior,\n+specify `-logthreadnames=0`.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279122981",
      "id" : 279122981,
      "in_reply_to_id" : 279117759,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTEyMjk4MQ==",
      "original_commit_id" : "043a3876396a13f2810bf97e8c79684866e3491d",
      "original_position" : 6,
      "path" : "doc/release-notes-pr13168.md",
      "position" : 6,
      "pull_request_review_id" : 231384825,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279122981",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279124037"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279124037"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done, thanks.",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T22:47:24Z",
      "diff_hunk" : "@@ -196,29 +199,31 @@ std::string BCLog::Logger::LogTimestampStr(const std::string &str)\n     } else\n         strStamped = str;\n \n-    if (!str.empty() && str[str.size()-1] == '\\n')\n-        m_started_new_line = true;\n-    else\n-        m_started_new_line = false;\n-\n     return strStamped;\n }\n \n void BCLog::Logger::LogPrintStr(const std::string &str)\n {\n-    std::string strTimestamped = LogTimestampStr(str);\n+    std::string str_prefixed = str;\n+\n+    if (m_log_threadnames && m_started_new_line)\n+        str_prefixed.insert(0, \"[\" + util::ThreadGetInternalName() + \"] \");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279124037",
      "id" : 279124037,
      "in_reply_to_id" : 279119514,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTEyNDAzNw==",
      "original_commit_id" : "043a3876396a13f2810bf97e8c79684866e3491d",
      "original_position" : 39,
      "path" : "src/logging.cpp",
      "position" : 39,
      "pull_request_review_id" : 231386151,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279124037",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279124064"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279124064"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done, thanks.",
      "commit_id" : "0cfcb8d470bd23f34e1bd81810444a1db8e4c702",
      "created_at" : "2019-04-26T22:47:34Z",
      "diff_hunk" : "@@ -0,0 +1,73 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <util/threadnames.h>\n+#include <test/setup_common.h>\n+\n+#include <thread>\n+#include <vector>\n+#include <set>\n+#include <mutex>\n+\n+#if defined(HAVE_CONFIG_H)\n+#include <config/bitcoin-config.h>\n+#endif\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_FIXTURE_TEST_SUITE(util_threadnames_tests, BasicTestingSetup)\n+\n+std::string TEST_THREAD_NAME_BASE = \"test_thread.\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#discussion_r279124064",
      "id" : 279124064,
      "in_reply_to_id" : 279116351,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3OTEyNDA2NA==",
      "original_commit_id" : "043a3876396a13f2810bf97e8c79684866e3491d",
      "original_position" : 21,
      "path" : "src/test/util_threadnames_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 231386187,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15849",
      "updated_at" : "2019-04-26T22:47:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/279124064",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Latest benchmark; 0.7% difference seems attributable to noise.\r\n\r\n![ibd local 500000 504000 dbcache=2048](https://user-images.githubusercontent.com/73197/56842255-90aec500-6861-11e9-8e9e-d45109bd3b2c.png)\r\n",
      "created_at" : "2019-04-27T00:27:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15849#issuecomment-487238248",
      "id" : 487238248,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15849",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NzIzODI0OA==",
      "updated_at" : "2019-04-27T00:27:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/487238248",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   }
]
