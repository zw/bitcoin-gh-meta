[
   {
      "author_association" : "MEMBER",
      "body" : "The commits moved from https://github.com/bitcoin-core/gui/pull/86 already have two ACKs:\r\n- from @jnewbery https://github.com/bitcoin-core/gui/pull/86#issuecomment-691905056\r\n> Code review ACK https://github.com/bitcoin-core/gui/commit/6549abcb072d73e0ac91c7992cc5d86eb4064b70 (node changes only. Did not fully review qt changes)\r\n\r\n- from @Sjors https://github.com/bitcoin-core/gui/pull/86#pullrequestreview-489554178\r\n> tACK https://github.com/bitcoin-core/gui/commit/6549abcb072d73e0ac91c7992cc5d86eb4064b70 with notes for followup",
      "created_at" : "2020-10-16T22:03:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#issuecomment-710673472",
      "id" : 710673472,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20172",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxMDY3MzQ3Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-16T22:03:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/710673472",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r506748086"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/506748086"
         }
      },
      "author_association" : "MEMBER",
      "body" : "s/all connection/all connections/",
      "commit_id" : "85ff09ef5d4da9991ee1e9761662d003ff464679",
      "created_at" : "2020-10-16T22:30:20Z",
      "diff_hunk" : "@@ -533,10 +533,11 @@ static RPCHelpMan getnetworkinfo()\n                         }},\n                         {RPCResult::Type::BOOL, \"localrelay\", \"true if transaction relay is requested from peers\"},\n                         {RPCResult::Type::NUM, \"timeoffset\", \"the time offset\"},\n+                        {RPCResult::Type::BOOL, \"networkactive\", \"whether p2p networking is enabled\"},\n                         {RPCResult::Type::NUM, \"connections\", \"the total number of connections\"},\n                         {RPCResult::Type::NUM, \"connections_in\", \"the number of inbound connections\"},\n                         {RPCResult::Type::NUM, \"connections_out\", \"the number of outbound connections\"},\n-                        {RPCResult::Type::BOOL, \"networkactive\", \"whether p2p networking is enabled\"},\n+                        {RPCResult::Type::BOOL, \"connections_onion_only\", \"whether all connection are through the onion network\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r506748086",
      "id" : 506748086,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc0ODA4Ng==",
      "original_commit_id" : "174848ffb88767fe9190dd7fa160e7187dfcdc07",
      "original_line" : 540,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 510831106,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-19T23:24:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/506748086",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r506749645"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/506749645"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Style nit: I'd put both of the ConnCounts declarations all on one line with `{}`. It looks like this is clang-format output, but ISTM this particular formatting is ugly, wastes space, and isn't followed in the new code additions we see while reviewing. Maybe others disagree :man_shrugging: ",
      "commit_id" : "85ff09ef5d4da9991ee1e9761662d003ff464679",
      "created_at" : "2020-10-16T22:36:26Z",
      "diff_hunk" : "@@ -183,18 +183,28 @@ enum class ConnectionType {\n     ADDR_FETCH,\n };\n \n+struct ConnCounts\n+{\n+    const int all{0};\n+    const int in{0};\n+    const int out{0};\n+    const bool onion_only{false};\n+\n+    ConnCounts()\n+    {\n+    }\n+\n+    ConnCounts(int num_in, int num_out, bool is_onion_only)\n+        : all(num_in + num_out), in(num_in), out(num_out), onion_only(is_onion_only)\n+    {\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r506749645",
      "id" : 506749645,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc0OTY0NQ==",
      "original_commit_id" : "174848ffb88767fe9190dd7fa160e7187dfcdc07",
      "original_line" : 200,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : null,
      "pull_request_review_id" : 510831106,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-19T23:24:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/506749645",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20494 (refactor: Move node and wallet code out of src/interfaces by ryanofsky)\n* #20267 (Disable and fix tests for when BDB is not compiled by achow101)\n* #19937 (signet mining utility by ajtowns)\n* #19771 (net: Replace enum CConnMan::NumConnections with enum class ConnectionDirection by luke-jr)\n* #19461 (multiprocess: Add bitcoin-gui -ipcconnect option by ryanofsky)\n* #19460 (multiprocess: Add bitcoin-wallet -ipcconnect option by ryanofsky)\n* #19315 ([tests] Allow outbound & block-relay-only connections in functional tests. by amitiuttarwar)\n* #19160 (multiprocess: Add basic spawn and IPC support by ryanofsky)\n* #17167 (Allow whitelisting outgoing connections by luke-jr)\n* #10102 ([experimental] Multiprocess bitcoin by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-10-17T02:57:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#issuecomment-710734202",
      "id" : 710734202,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20172",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxMDczNDIwMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-26T05:42:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/710734202",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.\r\n\r\nAgree that a functional test for `connections_onion_only` would be good, but not sure how easy it is. You could spin up two test nodes, 0 with default settings, 1 with `-onlynet=onion` and `-bind=...=onion`, and then connect node 0 to node 1 via it's \"onion\" port. In that case node 1 should have `connections_onion_only=true`.",
      "created_at" : "2020-10-17T07:52:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#issuecomment-710768868",
      "id" : 710768868,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20172",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxMDc2ODg2OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-17T07:52:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/710768868",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Updated 174848ffb88767fe9190dd7fa160e7187dfcdc07 -> 9371757d9031ad40ca99543bb4d24fc48e00b32e ([pr20172.01](https://github.com/hebasto/bitcoin/commits/pr20172.01) -> [pr20172.02](https://github.com/hebasto/bitcoin/commits/pr20172.02), [diff](https://github.com/hebasto/bitcoin/compare/pr20172.01..pr20172.02)):\r\n\r\n- addressed all of @jonatack's and @Sjors' comments\r\n- added a functional test",
      "created_at" : "2020-10-17T12:25:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#issuecomment-710886459",
      "id" : 710886459,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20172",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxMDg4NjQ1OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-17T12:25:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/710886459",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r506938197"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/506938197"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks! [Updated](https://github.com/bitcoin/bitcoin/pull/20172#issuecomment-710886459).",
      "commit_id" : "85ff09ef5d4da9991ee1e9761662d003ff464679",
      "created_at" : "2020-10-17T12:26:00Z",
      "diff_hunk" : "@@ -533,10 +533,11 @@ static RPCHelpMan getnetworkinfo()\n                         }},\n                         {RPCResult::Type::BOOL, \"localrelay\", \"true if transaction relay is requested from peers\"},\n                         {RPCResult::Type::NUM, \"timeoffset\", \"the time offset\"},\n+                        {RPCResult::Type::BOOL, \"networkactive\", \"whether p2p networking is enabled\"},\n                         {RPCResult::Type::NUM, \"connections\", \"the total number of connections\"},\n                         {RPCResult::Type::NUM, \"connections_in\", \"the number of inbound connections\"},\n                         {RPCResult::Type::NUM, \"connections_out\", \"the number of outbound connections\"},\n-                        {RPCResult::Type::BOOL, \"networkactive\", \"whether p2p networking is enabled\"},\n+                        {RPCResult::Type::BOOL, \"connections_onion_only\", \"whether all connection are through the onion network\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r506938197",
      "id" : 506938197,
      "in_reply_to_id" : 506748086,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjkzODE5Nw==",
      "original_commit_id" : "174848ffb88767fe9190dd7fa160e7187dfcdc07",
      "original_line" : 540,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : null,
      "pull_request_review_id" : 510982042,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-19T23:24:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/506938197",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r506938225"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/506938225"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks! [Updated](https://github.com/bitcoin/bitcoin/pull/20172#issuecomment-710886459).",
      "commit_id" : "85ff09ef5d4da9991ee1e9761662d003ff464679",
      "created_at" : "2020-10-17T12:26:13Z",
      "diff_hunk" : "@@ -183,18 +183,28 @@ enum class ConnectionType {\n     ADDR_FETCH,\n };\n \n+struct ConnCounts\n+{\n+    const int all{0};\n+    const int in{0};\n+    const int out{0};\n+    const bool onion_only{false};\n+\n+    ConnCounts()\n+    {\n+    }\n+\n+    ConnCounts(int num_in, int num_out, bool is_onion_only)\n+        : all(num_in + num_out), in(num_in), out(num_out), onion_only(is_onion_only)\n+    {\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r506938225",
      "id" : 506938225,
      "in_reply_to_id" : 506749645,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjkzODIyNQ==",
      "original_commit_id" : "174848ffb88767fe9190dd7fa160e7187dfcdc07",
      "original_line" : 200,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : null,
      "pull_request_review_id" : 510982056,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-19T23:24:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/506938225",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "~Hmm, the current [pr20172.03](https://github.com/hebasto/bitcoin/commits/pr20172.03) branch does not pass macOS 10.14 build on Travis.~\r\n\r\n~The alternative [pr20172.04](https://github.com/hebasto/bitcoin/commits/pr20172.04) branch pass locally on macOS 10.15 and Linux Mint 20 (Focal codebase), but it does not pass on Travis at all.~\r\n\r\n~What is the correct portable way to `-bind=localhost` and `-bind=localhost:port=onion` simultaneously?~\r\n\r\nUPDATE: it was such a silly error, and I've caught it after sleep :smiley:",
      "created_at" : "2020-10-17T21:18:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#issuecomment-711081738",
      "id" : 711081738,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20172",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxMTA4MTczOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-18T10:20:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/711081738",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Updated 9371757d9031ad40ca99543bb4d24fc48e00b32e -> d301cc5c564f8c130949567602e182917efef18e ([pr20172.02](https://github.com/hebasto/bitcoin/commits/pr20172.02) -> [pr20172.06](https://github.com/hebasto/bitcoin/commits/pr20172.06), [diff](https://github.com/hebasto/bitcoin/compare/pr20172.02..pr20172.06)):\r\n\r\n- fixed functional test\r\n\r\nTravis is green now!",
      "created_at" : "2020-10-18T12:02:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#issuecomment-711157670",
      "id" : 711157670,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20172",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxMTE1NzY3MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-18T12:02:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/711157670",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r507574400"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/507574400"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Perhaps name this function `GetConnectionCounts()`?",
      "commit_id" : "85ff09ef5d4da9991ee1e9761662d003ff464679",
      "created_at" : "2020-10-19T08:44:28Z",
      "diff_hunk" : "@@ -346,7 +350,8 @@ class CConnman\n     bool RemoveAddedNode(const std::string& node);\n     std::vector<AddedNodeInfo> GetAddedNodeInfo();\n \n-    size_t GetNodeCount(NumConnections num);\n+    size_t PeerCount() { return WITH_LOCK(cs_vNodes, return vNodes.size()); }\n+    ConnCounts ConnectionCounts();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r507574400",
      "id" : 507574400,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzU3NDQwMA==",
      "original_commit_id" : "d301cc5c564f8c130949567602e182917efef18e",
      "original_line" : 354,
      "original_position" : 36,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : null,
      "pull_request_review_id" : 511537564,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-19T23:24:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/507574400",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r507589923"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/507589923"
         }
      },
      "author_association" : "MEMBER",
      "body" : "What is this onion address?",
      "commit_id" : "85ff09ef5d4da9991ee1e9761662d003ff464679",
      "created_at" : "2020-10-19T09:07:41Z",
      "diff_hunk" : "@@ -0,0 +1,78 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test bitcoind with 'onion'-tagged peers.\n+\n+Tested outbound and inbound peers.\n+\"\"\"\n+\n+import os\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.socks5 import Socks5Configuration, Socks5Server\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    PORT_MIN,\n+    PORT_RANGE,\n+    assert_equal,\n+)\n+\n+\n+class OnionTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        self.setup_clean_chain = True\n+\n+    def setup_network(self):\n+        port_offset = PORT_MIN + 2 * PORT_RANGE + (os.getpid() % 1000)\n+        self.bind_onion = '127.0.0.1:{}'.format(port_offset + 1000)\n+\n+        self.proxy_conf = Socks5Configuration()\n+        self.proxy_conf.addr = ('127.0.0.1', port_offset + 2000)\n+        self.proxy_conf.unauth = True\n+        self.proxy = Socks5Server(self.proxy_conf)\n+        self.proxy.start()\n+\n+        args = [\n+            ['-bind={}=onion'.format(self.bind_onion), '-onion=%s:%i' % (self.proxy_conf.addr)],\n+            [],\n+            ]\n+        self.add_nodes(self.num_nodes, extra_args=args)\n+        self.start_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Checking a node without any peers...\")\n+        network_info = self.nodes[0].getnetworkinfo()\n+        assert_equal(network_info[\"connections\"], 0)\n+        assert_equal(network_info[\"connections_in\"], 0)\n+        assert_equal(network_info[\"connections_out\"], 0)\n+        assert_equal(network_info[\"connections_onion_only\"], False)\n+\n+        self.log.info(\"Accepting an inbound 'onion'-tagged connection, and checking...\")\n+        self.nodes[1].addnode(self.bind_onion, \"onetry\")\n+        network_info = self.nodes[0].getnetworkinfo()\n+        assert_equal(network_info[\"connections\"], 1)\n+        assert_equal(network_info[\"connections_in\"], 1)\n+        assert_equal(network_info[\"connections_out\"], 0)\n+        assert_equal(network_info[\"connections_onion_only\"], True)\n+\n+        self.log.info(\"Creating an outbound onion connection, and checking...\")\n+        self.nodes[0].addnode(\"bitcoinostk4e4re.onion:8333\", \"onetry\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r507589923",
      "id" : 507589923,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzU4OTkyMw==",
      "original_commit_id" : "d301cc5c564f8c130949567602e182917efef18e",
      "original_line" : 61,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "test/functional/feature_onion.py",
      "position" : null,
      "pull_request_review_id" : 511537564,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-19T23:24:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/507589923",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r507594173"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/507594173"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It has been taken from https://github.com/bitcoin/bitcoin/blob/d9d9a293520d26ca8fec8caebab46db103b29903/test/functional/feature_proxy.py#L139",
      "commit_id" : "85ff09ef5d4da9991ee1e9761662d003ff464679",
      "created_at" : "2020-10-19T09:14:43Z",
      "diff_hunk" : "@@ -0,0 +1,78 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test bitcoind with 'onion'-tagged peers.\n+\n+Tested outbound and inbound peers.\n+\"\"\"\n+\n+import os\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.socks5 import Socks5Configuration, Socks5Server\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    PORT_MIN,\n+    PORT_RANGE,\n+    assert_equal,\n+)\n+\n+\n+class OnionTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        self.setup_clean_chain = True\n+\n+    def setup_network(self):\n+        port_offset = PORT_MIN + 2 * PORT_RANGE + (os.getpid() % 1000)\n+        self.bind_onion = '127.0.0.1:{}'.format(port_offset + 1000)\n+\n+        self.proxy_conf = Socks5Configuration()\n+        self.proxy_conf.addr = ('127.0.0.1', port_offset + 2000)\n+        self.proxy_conf.unauth = True\n+        self.proxy = Socks5Server(self.proxy_conf)\n+        self.proxy.start()\n+\n+        args = [\n+            ['-bind={}=onion'.format(self.bind_onion), '-onion=%s:%i' % (self.proxy_conf.addr)],\n+            [],\n+            ]\n+        self.add_nodes(self.num_nodes, extra_args=args)\n+        self.start_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Checking a node without any peers...\")\n+        network_info = self.nodes[0].getnetworkinfo()\n+        assert_equal(network_info[\"connections\"], 0)\n+        assert_equal(network_info[\"connections_in\"], 0)\n+        assert_equal(network_info[\"connections_out\"], 0)\n+        assert_equal(network_info[\"connections_onion_only\"], False)\n+\n+        self.log.info(\"Accepting an inbound 'onion'-tagged connection, and checking...\")\n+        self.nodes[1].addnode(self.bind_onion, \"onetry\")\n+        network_info = self.nodes[0].getnetworkinfo()\n+        assert_equal(network_info[\"connections\"], 1)\n+        assert_equal(network_info[\"connections_in\"], 1)\n+        assert_equal(network_info[\"connections_out\"], 0)\n+        assert_equal(network_info[\"connections_onion_only\"], True)\n+\n+        self.log.info(\"Creating an outbound onion connection, and checking...\")\n+        self.nodes[0].addnode(\"bitcoinostk4e4re.onion:8333\", \"onetry\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r507594173",
      "id" : 507594173,
      "in_reply_to_id" : 507589923,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzU5NDE3Mw==",
      "original_commit_id" : "d301cc5c564f8c130949567602e182917efef18e",
      "original_line" : 61,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "test/functional/feature_onion.py",
      "position" : null,
      "pull_request_review_id" : 511563039,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-19T23:24:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/507594173",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jnewbery \r\n> This PR contains qt-only changes. It shouldn't be too difficult to separate the changes so that PRs to the main repo only contain changes to the node code, and PRs to the GUI repo only contain changes to qt code.\r\n\r\nClear qt-only changes are already [leaved](https://github.com/bitcoin-core/gui/pull/86) in the GUI repo. This pull contains two commits that modify signal signatures. As these signals propagate through the qt code, I do not want to break those commits in \"non-qt\" and \"qt\" parts.",
      "created_at" : "2020-10-19T09:20:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#issuecomment-711899704",
      "id" : 711899704,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20172",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxMTg5OTcwNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-19T09:20:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/711899704",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r507626814"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/507626814"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This repetitious code could potentially be refactored into a small helper function `get_connection_info()`.",
      "commit_id" : "85ff09ef5d4da9991ee1e9761662d003ff464679",
      "created_at" : "2020-10-19T10:06:23Z",
      "diff_hunk" : "@@ -0,0 +1,78 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test bitcoind with 'onion'-tagged peers.\n+\n+Tested outbound and inbound peers.\n+\"\"\"\n+\n+import os\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.socks5 import Socks5Configuration, Socks5Server\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    PORT_MIN,\n+    PORT_RANGE,\n+    assert_equal,\n+)\n+\n+\n+class OnionTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        self.setup_clean_chain = True\n+\n+    def setup_network(self):\n+        port_offset = PORT_MIN + 2 * PORT_RANGE + (os.getpid() % 1000)\n+        self.bind_onion = '127.0.0.1:{}'.format(port_offset + 1000)\n+\n+        self.proxy_conf = Socks5Configuration()\n+        self.proxy_conf.addr = ('127.0.0.1', port_offset + 2000)\n+        self.proxy_conf.unauth = True\n+        self.proxy = Socks5Server(self.proxy_conf)\n+        self.proxy.start()\n+\n+        args = [\n+            ['-bind={}=onion'.format(self.bind_onion), '-onion=%s:%i' % (self.proxy_conf.addr)],\n+            [],\n+            ]\n+        self.add_nodes(self.num_nodes, extra_args=args)\n+        self.start_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Checking a node without any peers...\")\n+        network_info = self.nodes[0].getnetworkinfo()\n+        assert_equal(network_info[\"connections\"], 0)\n+        assert_equal(network_info[\"connections_in\"], 0)\n+        assert_equal(network_info[\"connections_out\"], 0)\n+        assert_equal(network_info[\"connections_onion_only\"], False)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r507626814",
      "id" : 507626814,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYyNjgxNA==",
      "original_commit_id" : "d301cc5c564f8c130949567602e182917efef18e",
      "original_line" : 50,
      "original_position" : 50,
      "original_start_line" : 46,
      "path" : "test/functional/feature_onion.py",
      "position" : null,
      "pull_request_review_id" : 511605916,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-10-19T23:24:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/507626814",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r507627340"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/507627340"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm confused about how this works. It creates an outbound connection to where? Why does that outbound connection show up here, but is gone by the time you call `getnetworkinfo()` again?",
      "commit_id" : "85ff09ef5d4da9991ee1e9761662d003ff464679",
      "created_at" : "2020-10-19T10:07:20Z",
      "diff_hunk" : "@@ -0,0 +1,78 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test bitcoind with 'onion'-tagged peers.\n+\n+Tested outbound and inbound peers.\n+\"\"\"\n+\n+import os\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.socks5 import Socks5Configuration, Socks5Server\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    PORT_MIN,\n+    PORT_RANGE,\n+    assert_equal,\n+)\n+\n+\n+class OnionTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        self.setup_clean_chain = True\n+\n+    def setup_network(self):\n+        port_offset = PORT_MIN + 2 * PORT_RANGE + (os.getpid() % 1000)\n+        self.bind_onion = '127.0.0.1:{}'.format(port_offset + 1000)\n+\n+        self.proxy_conf = Socks5Configuration()\n+        self.proxy_conf.addr = ('127.0.0.1', port_offset + 2000)\n+        self.proxy_conf.unauth = True\n+        self.proxy = Socks5Server(self.proxy_conf)\n+        self.proxy.start()\n+\n+        args = [\n+            ['-bind={}=onion'.format(self.bind_onion), '-onion=%s:%i' % (self.proxy_conf.addr)],\n+            [],\n+            ]\n+        self.add_nodes(self.num_nodes, extra_args=args)\n+        self.start_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Checking a node without any peers...\")\n+        network_info = self.nodes[0].getnetworkinfo()\n+        assert_equal(network_info[\"connections\"], 0)\n+        assert_equal(network_info[\"connections_in\"], 0)\n+        assert_equal(network_info[\"connections_out\"], 0)\n+        assert_equal(network_info[\"connections_onion_only\"], False)\n+\n+        self.log.info(\"Accepting an inbound 'onion'-tagged connection, and checking...\")\n+        self.nodes[1].addnode(self.bind_onion, \"onetry\")\n+        network_info = self.nodes[0].getnetworkinfo()\n+        assert_equal(network_info[\"connections\"], 1)\n+        assert_equal(network_info[\"connections_in\"], 1)\n+        assert_equal(network_info[\"connections_out\"], 0)\n+        assert_equal(network_info[\"connections_onion_only\"], True)\n+\n+        self.log.info(\"Creating an outbound onion connection, and checking...\")\n+        self.nodes[0].addnode(\"bitcoinostk4e4re.onion:8333\", \"onetry\")\n+        network_info = self.nodes[0].getnetworkinfo()\n+        assert_equal(network_info[\"connections\"], 2)\n+        assert_equal(network_info[\"connections_in\"], 1)\n+        assert_equal(network_info[\"connections_out\"], 1)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r507627340",
      "id" : 507627340,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYyNzM0MA==",
      "original_commit_id" : "d301cc5c564f8c130949567602e182917efef18e",
      "original_line" : 65,
      "original_position" : 65,
      "original_start_line" : null,
      "path" : "test/functional/feature_onion.py",
      "position" : null,
      "pull_request_review_id" : 511605916,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-19T23:24:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/507627340",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r507630284"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/507630284"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> It creates an outbound connection to where?\r\n\r\nTo created `self.proxy`.\r\n\r\n> Why does that outbound connection show up here, but is gone by the time you call `getnetworkinfo()` again?\r\n\r\n~IDK why `add_p2p_connection(P2PInterface())` causes drop of the connection to the proxy.~",
      "commit_id" : "85ff09ef5d4da9991ee1e9761662d003ff464679",
      "created_at" : "2020-10-19T10:12:31Z",
      "diff_hunk" : "@@ -0,0 +1,78 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test bitcoind with 'onion'-tagged peers.\n+\n+Tested outbound and inbound peers.\n+\"\"\"\n+\n+import os\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.socks5 import Socks5Configuration, Socks5Server\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    PORT_MIN,\n+    PORT_RANGE,\n+    assert_equal,\n+)\n+\n+\n+class OnionTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        self.setup_clean_chain = True\n+\n+    def setup_network(self):\n+        port_offset = PORT_MIN + 2 * PORT_RANGE + (os.getpid() % 1000)\n+        self.bind_onion = '127.0.0.1:{}'.format(port_offset + 1000)\n+\n+        self.proxy_conf = Socks5Configuration()\n+        self.proxy_conf.addr = ('127.0.0.1', port_offset + 2000)\n+        self.proxy_conf.unauth = True\n+        self.proxy = Socks5Server(self.proxy_conf)\n+        self.proxy.start()\n+\n+        args = [\n+            ['-bind={}=onion'.format(self.bind_onion), '-onion=%s:%i' % (self.proxy_conf.addr)],\n+            [],\n+            ]\n+        self.add_nodes(self.num_nodes, extra_args=args)\n+        self.start_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Checking a node without any peers...\")\n+        network_info = self.nodes[0].getnetworkinfo()\n+        assert_equal(network_info[\"connections\"], 0)\n+        assert_equal(network_info[\"connections_in\"], 0)\n+        assert_equal(network_info[\"connections_out\"], 0)\n+        assert_equal(network_info[\"connections_onion_only\"], False)\n+\n+        self.log.info(\"Accepting an inbound 'onion'-tagged connection, and checking...\")\n+        self.nodes[1].addnode(self.bind_onion, \"onetry\")\n+        network_info = self.nodes[0].getnetworkinfo()\n+        assert_equal(network_info[\"connections\"], 1)\n+        assert_equal(network_info[\"connections_in\"], 1)\n+        assert_equal(network_info[\"connections_out\"], 0)\n+        assert_equal(network_info[\"connections_onion_only\"], True)\n+\n+        self.log.info(\"Creating an outbound onion connection, and checking...\")\n+        self.nodes[0].addnode(\"bitcoinostk4e4re.onion:8333\", \"onetry\")\n+        network_info = self.nodes[0].getnetworkinfo()\n+        assert_equal(network_info[\"connections\"], 2)\n+        assert_equal(network_info[\"connections_in\"], 1)\n+        assert_equal(network_info[\"connections_out\"], 1)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r507630284",
      "id" : 507630284,
      "in_reply_to_id" : 507627340,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzYzMDI4NA==",
      "original_commit_id" : "d301cc5c564f8c130949567602e182917efef18e",
      "original_line" : 65,
      "original_position" : 65,
      "original_start_line" : null,
      "path" : "test/functional/feature_onion.py",
      "position" : null,
      "pull_request_review_id" : 511610479,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-19T23:24:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/507630284",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r508099612"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/508099612"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Why does that outbound connection show up here, but is gone by the time you call `getnetworkinfo()` again?\r\n\r\nConnections to a dummy Socks5 server are short-lived:https://github.com/bitcoin/bitcoin/blob/45385018e13e167521e655c36128d8ee4f2a3e0b/test/functional/test_framework/socks5.py#L113-L124",
      "commit_id" : "85ff09ef5d4da9991ee1e9761662d003ff464679",
      "created_at" : "2020-10-19T22:29:24Z",
      "diff_hunk" : "@@ -0,0 +1,78 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test bitcoind with 'onion'-tagged peers.\n+\n+Tested outbound and inbound peers.\n+\"\"\"\n+\n+import os\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.socks5 import Socks5Configuration, Socks5Server\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    PORT_MIN,\n+    PORT_RANGE,\n+    assert_equal,\n+)\n+\n+\n+class OnionTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        self.setup_clean_chain = True\n+\n+    def setup_network(self):\n+        port_offset = PORT_MIN + 2 * PORT_RANGE + (os.getpid() % 1000)\n+        self.bind_onion = '127.0.0.1:{}'.format(port_offset + 1000)\n+\n+        self.proxy_conf = Socks5Configuration()\n+        self.proxy_conf.addr = ('127.0.0.1', port_offset + 2000)\n+        self.proxy_conf.unauth = True\n+        self.proxy = Socks5Server(self.proxy_conf)\n+        self.proxy.start()\n+\n+        args = [\n+            ['-bind={}=onion'.format(self.bind_onion), '-onion=%s:%i' % (self.proxy_conf.addr)],\n+            [],\n+            ]\n+        self.add_nodes(self.num_nodes, extra_args=args)\n+        self.start_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Checking a node without any peers...\")\n+        network_info = self.nodes[0].getnetworkinfo()\n+        assert_equal(network_info[\"connections\"], 0)\n+        assert_equal(network_info[\"connections_in\"], 0)\n+        assert_equal(network_info[\"connections_out\"], 0)\n+        assert_equal(network_info[\"connections_onion_only\"], False)\n+\n+        self.log.info(\"Accepting an inbound 'onion'-tagged connection, and checking...\")\n+        self.nodes[1].addnode(self.bind_onion, \"onetry\")\n+        network_info = self.nodes[0].getnetworkinfo()\n+        assert_equal(network_info[\"connections\"], 1)\n+        assert_equal(network_info[\"connections_in\"], 1)\n+        assert_equal(network_info[\"connections_out\"], 0)\n+        assert_equal(network_info[\"connections_onion_only\"], True)\n+\n+        self.log.info(\"Creating an outbound onion connection, and checking...\")\n+        self.nodes[0].addnode(\"bitcoinostk4e4re.onion:8333\", \"onetry\")\n+        network_info = self.nodes[0].getnetworkinfo()\n+        assert_equal(network_info[\"connections\"], 2)\n+        assert_equal(network_info[\"connections_in\"], 1)\n+        assert_equal(network_info[\"connections_out\"], 1)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r508099612",
      "id" : 508099612,
      "in_reply_to_id" : 507627340,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODA5OTYxMg==",
      "original_commit_id" : "d301cc5c564f8c130949567602e182917efef18e",
      "original_line" : 65,
      "original_position" : 65,
      "original_start_line" : null,
      "path" : "test/functional/feature_onion.py",
      "position" : null,
      "pull_request_review_id" : 512205001,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-19T23:24:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/508099612",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Updated d301cc5c564f8c130949567602e182917efef18e -> caebabfc4b239bfb854228f041a6b4220e87e3af ([pr20172.06](https://github.com/hebasto/bitcoin/commits/pr20172.06) -> [pr20172.09](https://github.com/hebasto/bitcoin/commits/pr20172.09), [diff](https://github.com/hebasto/bitcoin/compare/pr20172.06..pr20172.09)):\r\n\r\n- reworked functional test\r\n\r\n- addressed @jnewbery's [comment](https://github.com/bitcoin/bitcoin/pull/20172#discussion_r507626814):\r\n> This repetitious code could potentially be refactored into a small helper function `get_connection_info()`.",
      "created_at" : "2020-10-19T22:35:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#issuecomment-712479264",
      "id" : 712479264,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20172",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxMjQ3OTI2NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-19T22:35:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/712479264",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r508102005"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/508102005"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Sure! [Updated](https://github.com/bitcoin/bitcoin/pull/20172#issuecomment-712479264).",
      "commit_id" : "85ff09ef5d4da9991ee1e9761662d003ff464679",
      "created_at" : "2020-10-19T22:35:45Z",
      "diff_hunk" : "@@ -346,7 +350,8 @@ class CConnman\n     bool RemoveAddedNode(const std::string& node);\n     std::vector<AddedNodeInfo> GetAddedNodeInfo();\n \n-    size_t GetNodeCount(NumConnections num);\n+    size_t PeerCount() { return WITH_LOCK(cs_vNodes, return vNodes.size()); }\n+    ConnCounts ConnectionCounts();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r508102005",
      "id" : 508102005,
      "in_reply_to_id" : 507574400,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODEwMjAwNQ==",
      "original_commit_id" : "d301cc5c564f8c130949567602e182917efef18e",
      "original_line" : 354,
      "original_position" : 36,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : null,
      "pull_request_review_id" : 512207989,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-19T23:24:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/508102005",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r508102278"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/508102278"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks! [Reworked](https://github.com/bitcoin/bitcoin/pull/20172#issuecomment-712479264).",
      "commit_id" : "85ff09ef5d4da9991ee1e9761662d003ff464679",
      "created_at" : "2020-10-19T22:36:30Z",
      "diff_hunk" : "@@ -0,0 +1,78 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test bitcoind with 'onion'-tagged peers.\n+\n+Tested outbound and inbound peers.\n+\"\"\"\n+\n+import os\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.socks5 import Socks5Configuration, Socks5Server\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    PORT_MIN,\n+    PORT_RANGE,\n+    assert_equal,\n+)\n+\n+\n+class OnionTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        self.setup_clean_chain = True\n+\n+    def setup_network(self):\n+        port_offset = PORT_MIN + 2 * PORT_RANGE + (os.getpid() % 1000)\n+        self.bind_onion = '127.0.0.1:{}'.format(port_offset + 1000)\n+\n+        self.proxy_conf = Socks5Configuration()\n+        self.proxy_conf.addr = ('127.0.0.1', port_offset + 2000)\n+        self.proxy_conf.unauth = True\n+        self.proxy = Socks5Server(self.proxy_conf)\n+        self.proxy.start()\n+\n+        args = [\n+            ['-bind={}=onion'.format(self.bind_onion), '-onion=%s:%i' % (self.proxy_conf.addr)],\n+            [],\n+            ]\n+        self.add_nodes(self.num_nodes, extra_args=args)\n+        self.start_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Checking a node without any peers...\")\n+        network_info = self.nodes[0].getnetworkinfo()\n+        assert_equal(network_info[\"connections\"], 0)\n+        assert_equal(network_info[\"connections_in\"], 0)\n+        assert_equal(network_info[\"connections_out\"], 0)\n+        assert_equal(network_info[\"connections_onion_only\"], False)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r508102278",
      "id" : 508102278,
      "in_reply_to_id" : 507626814,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODEwMjI3OA==",
      "original_commit_id" : "d301cc5c564f8c130949567602e182917efef18e",
      "original_line" : 50,
      "original_position" : 50,
      "original_start_line" : 46,
      "path" : "test/functional/feature_onion.py",
      "position" : null,
      "pull_request_review_id" : 512208306,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-10-19T23:24:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/508102278",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r508102443"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/508102443"
         }
      },
      "author_association" : "MEMBER",
      "body" : "[Reworked](https://github.com/bitcoin/bitcoin/pull/20172#issuecomment-712479264).",
      "commit_id" : "85ff09ef5d4da9991ee1e9761662d003ff464679",
      "created_at" : "2020-10-19T22:36:57Z",
      "diff_hunk" : "@@ -0,0 +1,78 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test bitcoind with 'onion'-tagged peers.\n+\n+Tested outbound and inbound peers.\n+\"\"\"\n+\n+import os\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.socks5 import Socks5Configuration, Socks5Server\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    PORT_MIN,\n+    PORT_RANGE,\n+    assert_equal,\n+)\n+\n+\n+class OnionTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        self.setup_clean_chain = True\n+\n+    def setup_network(self):\n+        port_offset = PORT_MIN + 2 * PORT_RANGE + (os.getpid() % 1000)\n+        self.bind_onion = '127.0.0.1:{}'.format(port_offset + 1000)\n+\n+        self.proxy_conf = Socks5Configuration()\n+        self.proxy_conf.addr = ('127.0.0.1', port_offset + 2000)\n+        self.proxy_conf.unauth = True\n+        self.proxy = Socks5Server(self.proxy_conf)\n+        self.proxy.start()\n+\n+        args = [\n+            ['-bind={}=onion'.format(self.bind_onion), '-onion=%s:%i' % (self.proxy_conf.addr)],\n+            [],\n+            ]\n+        self.add_nodes(self.num_nodes, extra_args=args)\n+        self.start_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Checking a node without any peers...\")\n+        network_info = self.nodes[0].getnetworkinfo()\n+        assert_equal(network_info[\"connections\"], 0)\n+        assert_equal(network_info[\"connections_in\"], 0)\n+        assert_equal(network_info[\"connections_out\"], 0)\n+        assert_equal(network_info[\"connections_onion_only\"], False)\n+\n+        self.log.info(\"Accepting an inbound 'onion'-tagged connection, and checking...\")\n+        self.nodes[1].addnode(self.bind_onion, \"onetry\")\n+        network_info = self.nodes[0].getnetworkinfo()\n+        assert_equal(network_info[\"connections\"], 1)\n+        assert_equal(network_info[\"connections_in\"], 1)\n+        assert_equal(network_info[\"connections_out\"], 0)\n+        assert_equal(network_info[\"connections_onion_only\"], True)\n+\n+        self.log.info(\"Creating an outbound onion connection, and checking...\")\n+        self.nodes[0].addnode(\"bitcoinostk4e4re.onion:8333\", \"onetry\")\n+        network_info = self.nodes[0].getnetworkinfo()\n+        assert_equal(network_info[\"connections\"], 2)\n+        assert_equal(network_info[\"connections_in\"], 1)\n+        assert_equal(network_info[\"connections_out\"], 1)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r508102443",
      "id" : 508102443,
      "in_reply_to_id" : 507627340,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODEwMjQ0Mw==",
      "original_commit_id" : "d301cc5c564f8c130949567602e182917efef18e",
      "original_line" : 65,
      "original_position" : 65,
      "original_start_line" : null,
      "path" : "test/functional/feature_onion.py",
      "position" : null,
      "pull_request_review_id" : 512208482,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-19T23:24:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/508102443",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r508290004"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/508290004"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Stop-starting the nodes 11 times just to test new connections seems very inefficient. Is there a reason you need to do this stop-start?",
      "commit_id" : "85ff09ef5d4da9991ee1e9761662d003ff464679",
      "created_at" : "2020-10-20T08:01:23Z",
      "diff_hunk" : "@@ -0,0 +1,91 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test bitcoind with 'onion'-tagged peers.\n+\n+Tested inbound and outbound peers.\n+\"\"\"\n+\n+import os\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.socks5 import Socks5Configuration, Socks5Server\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    PORT_MIN,\n+    PORT_RANGE,\n+    assert_equal,\n+)\n+\n+\n+class OnionTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        self.setup_clean_chain = True\n+\n+    def setup_network(self):\n+        self.add_nodes(self.num_nodes)\n+        self.start_nodes()\n+\n+    def test_connections(self, in_clearnet=0, in_onion=0, out_onion=0):\n+        self.restart_node(0, ['-bind={}=onion'.format(self.bind_onion), self.arg_onion])\n+        self.restart_node(1)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#discussion_r508290004",
      "id" : 508290004,
      "line" : 33,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODI5MDAwNA==",
      "original_commit_id" : "85ff09ef5d4da9991ee1e9761662d003ff464679",
      "original_line" : 33,
      "original_position" : 33,
      "original_start_line" : 32,
      "path" : "test/functional/feature_onion.py",
      "position" : 33,
      "pull_request_review_id" : 512432788,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20172",
      "side" : "RIGHT",
      "start_line" : 32,
      "start_side" : "RIGHT",
      "updated_at" : "2020-10-20T08:01:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/508290004",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Updated 85ff09ef5d4da9991ee1e9761662d003ff464679 -> da8b1092fc2d5fa5ee9da3310dae16d4c919bc1b ([pr20172.10](https://github.com/hebasto/bitcoin/commits/pr20172.10) -> [pr20172.11](https://github.com/hebasto/bitcoin/commits/pr20172.11), [diff](https://github.com/hebasto/bitcoin/compare/pr20172.10..pr20172.11)):\r\n\r\n- addressed @jnewbery's [comment](https://github.com/bitcoin/bitcoin/pull/20172#discussion_r508290004):\r\n> Stop-starting the nodes 11 times just to test new connections seems very inefficient. Is there a reason you need to do this stop-start?\r\n\r\n- improved robustness",
      "created_at" : "2020-10-20T10:47:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#issuecomment-712763616",
      "id" : 712763616,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20172",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxMjc2MzYxNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-20T10:47:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/712763616",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "tACK da8b109",
      "created_at" : "2020-10-20T12:39:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#issuecomment-712819523",
      "id" : 712819523,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20172",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxMjgxOTUyMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-20T12:39:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/712819523",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I'm thinking about this in a context of if / when other privacy network support is added to Bitcoin Core (like I2P, #20254). What people might want then is not \"are all of my connections Tor only?\", but \"are all of my connections using privacy networks?\" and \"which privacy networks are they using?\".",
      "created_at" : "2020-11-05T15:30:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#issuecomment-722451210",
      "id" : 722451210,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20172",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyMjQ1MTIxMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-05T19:50:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/722451210",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/4500994?v=4",
         "events_url" : "https://api.github.com/users/kristapsk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kristapsk/followers",
         "following_url" : "https://api.github.com/users/kristapsk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kristapsk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kristapsk",
         "id" : 4500994,
         "login" : "kristapsk",
         "node_id" : "MDQ6VXNlcjQ1MDA5OTQ=",
         "organizations_url" : "https://api.github.com/users/kristapsk/orgs",
         "received_events_url" : "https://api.github.com/users/kristapsk/received_events",
         "repos_url" : "https://api.github.com/users/kristapsk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kristapsk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kristapsk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kristapsk"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2020-12-01T09:43:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#issuecomment-736358448",
      "id" : 736358448,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20172",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczNjM1ODQ0OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-01T09:43:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/736358448",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Closing. Leaving it up for grabs.",
      "created_at" : "2021-05-03T19:55:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20172#issuecomment-831495795",
      "id" : 831495795,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20172",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgzMTQ5NTc5NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-05-03T19:55:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/831495795",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   }
]
