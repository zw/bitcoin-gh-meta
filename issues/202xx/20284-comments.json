[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@jnewbery spotted the potential problem here: https://github.com/bitcoin/bitcoin/pull/19954#discussion_r515607619",
      "created_at" : "2020-11-02T11:04:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-720402264",
      "id" : 720402264,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyMDQwMjI2NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-02T11:04:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/720402264",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.\r\n\r\nI think this requires a bit more discussion. I'm going to raise it as a meeting topic for the next p2p meeting (Nov 3).\r\n\r\nMarking this as a 0.21 milestone, since we'll need to make a decision before that release.",
      "created_at" : "2020-11-02T13:29:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-720472622",
      "id" : 720472622,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyMDQ3MjYyMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-02T13:29:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/720472622",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #18722 (addrman: improve performance by using more suitable containers by vasild)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-11-02T14:58:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-720523138",
      "id" : 720523138,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyMDUyMzEzOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-02T14:58:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/720523138",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r516035544"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/516035544"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks for adding an actual versioning mechanism, at least next time we won't have to resort to a hack like this!",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-02T15:07:11Z",
      "diff_hunk" : "@@ -410,9 +413,20 @@ friend class CAddrManTest;\n \n         OverrideStream<Stream> s(&s_, s_.GetType(), stream_version);\n \n-        unsigned char nKeySize;\n-        s >> nKeySize;\n-        if (nKeySize != 32) throw std::ios_base::failure(\"Incorrect keysize in addrman deserialization\");\n+        //! The maximum format this software can Unserialize().\n+        static constexpr Format maximum_supported_format = Format::V3_BIP155;\n+\n+        uint8_t compat;\n+        s >> compat;\n+        const uint8_t lowest_compatible = compat - m_incompatibility_base;\n+        if (lowest_compatible > maximum_supported_format) {\n+            throw std::ios_base::failure(\n+                strprintf(\"Unsupported format of addrman database: %u. It is compatible with \"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r516035544",
      "id" : 516035544,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjAzNTU0NA==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 439,
      "original_position" : 89,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 521713341,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/516035544",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.",
      "created_at" : "2020-11-02T15:10:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-720530252",
      "id" : 720530252,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyMDUzMDI1Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-02T15:10:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/720530252",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.",
      "created_at" : "2020-11-03T14:40:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-721156298",
      "id" : 721156298,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyMTE1NjI5OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-03T14:40:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/721156298",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520327284"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520327284"
         }
      },
      "author_association" : "MEMBER",
      "body" : "unrelated style nit: Any reason why this can't use `CustomUintFormatter` (and its run-time sanity checks)?",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-10T06:44:40Z",
      "diff_hunk" : "@@ -332,7 +339,12 @@ friend class CAddrManTest;\n         OverrideStream<Stream> s(&s_, s_.GetType(), s_.GetVersion() | ADDRV2_FORMAT);\n \n         s << static_cast<uint8_t>(Format::V3_BIP155);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520327284",
      "id" : 520327284,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDMyNzI4NA==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 351,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 526899023,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520327284",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520329901"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520329901"
         }
      },
      "author_association" : "MEMBER",
      "body" : "stye-nit: I think the \"continue\" (and logging) is responsibility (and is already done) by the calling code that also catches the exception. No need to assume this exception is always caught.\r\n\r\n",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-10T06:51:55Z",
      "diff_hunk" : "@@ -410,9 +413,20 @@ friend class CAddrManTest;\n \n         OverrideStream<Stream> s(&s_, s_.GetType(), stream_version);\n \n-        unsigned char nKeySize;\n-        s >> nKeySize;\n-        if (nKeySize != 32) throw std::ios_base::failure(\"Incorrect keysize in addrman deserialization\");\n+        //! The maximum format this software can Unserialize().\n+        static constexpr Format maximum_supported_format = Format::V3_BIP155;\n+\n+        uint8_t compat;\n+        s >> compat;\n+        const uint8_t lowest_compatible = compat - m_incompatibility_base;\n+        if (lowest_compatible > maximum_supported_format) {\n+            throw std::ios_base::failure(\n+                strprintf(\"Unsupported format of addrman database: %u. It is compatible with \"\n+                          \"formats >=%u, but the maximum supported by this version of %s is %u. \"\n+                          \"Continuing operation without using the saved list of peers.\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520329901",
      "id" : 520329901,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDMyOTkwMQ==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 426,
      "original_position" : 91,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 526899023,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520329901",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520412455"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520412455"
         }
      },
      "author_association" : "MEMBER",
      "body" : "We usually use ALL_CAPS for constant names.",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-10T09:27:18Z",
      "diff_hunk" : "@@ -176,6 +177,20 @@ friend class CAddrManTest;\n     mutable RecursiveMutex cs;\n \n private:\n+    //! Serialization versions.\n+    enum Format : uint8_t {\n+        V0_HISTORICAL = 0,    //!< historic format, before commit e6b343d88\n+        V1_DETERMINISTIC = 1, //!< for pre-asmap files\n+        V2_ASMAP = 2,         //!< for files including asmap version\n+        V3_BIP155 = 3,        //!< same as V2_ASMAP plus addresses are in BIP155 format\n+    };\n+\n+    //! The initial value of a field that is incremented every time an incompatible format\n+    //! change is made. This is 32 instead of 0 because we overtook the \"key size\" field\n+    //! which was 32 historically and we don't want to start with 0 and bump into 32 at\n+    //! some point in the future.\n+    static constexpr uint8_t m_incompatibility_base = 32;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520412455",
      "id" : 520412455,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDQxMjQ1NQ==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 192,
      "original_position" : 24,
      "original_start_line" : 188,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 527008374,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520412455",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520414528"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520414528"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is a very badly named constant! The whole point of this PR is that we want the code to be forward compatible if possible, and only in exceptional circumstances make format changes that aren't. If the format is bumped, but lowest_compatible is not, then older software will still be able to read it.\r\n\r\nI'd suggest moving this to a class-level static constant called FILE_FORMAT or similar, and use it in both the serialize and unserialize functions.",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-10T09:30:13Z",
      "diff_hunk" : "@@ -410,9 +413,20 @@ friend class CAddrManTest;\n \n         OverrideStream<Stream> s(&s_, s_.GetType(), stream_version);\n \n-        unsigned char nKeySize;\n-        s >> nKeySize;\n-        if (nKeySize != 32) throw std::ios_base::failure(\"Incorrect keysize in addrman deserialization\");\n+        //! The maximum format this software can Unserialize().\n+        static constexpr Format maximum_supported_format = Format::V3_BIP155;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520414528",
      "id" : 520414528,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDQxNDUyOA==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 417,
      "original_position" : 82,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 527008374,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520414528",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520417770"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520417770"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think this requires better documentation. At the very least, the `* Serialized format.` comment above needs updating. You might also add `asmap_version` while you're doing that, since the documentation wasn't updated correctly last time either.\r\n\r\nI'd suggest something like:\r\n\r\n\"The lowest version of software that can read this peers.dat file. Update this to be the same as `FILE_FORMAT` when making a change to the file format that is not forwards compatible.\"",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-10T09:34:58Z",
      "diff_hunk" : "@@ -332,7 +339,12 @@ friend class CAddrManTest;\n         OverrideStream<Stream> s(&s_, s_.GetType(), s_.GetVersion() | ADDRV2_FORMAT);\n \n         s << static_cast<uint8_t>(Format::V3_BIP155);\n-        s << ((unsigned char)32);\n+\n+        // Increment `lowest_compatible` iff a newly introduced format is incompatible with",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520417770",
      "id" : 520417770,
      "line" : 361,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDQxNzc3MA==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 361,
      "original_position" : 50,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : 86,
      "pull_request_review_id" : 527008374,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520417770",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520425775"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520425775"
         }
      },
      "author_association" : "MEMBER",
      "body" : "\"we don't want to bump into 32\" isn't the reason we start at 32. The reason is that v0.20 and earlier wrote 32 into this field, so if we didn't use this offset, then minimum_version would be greater than the current version and v0.21 software wouldn't be able to read old peers.dat files. I'd just leave the explanation out.",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-10T09:46:45Z",
      "diff_hunk" : "@@ -176,6 +177,20 @@ friend class CAddrManTest;\n     mutable RecursiveMutex cs;\n \n private:\n+    //! Serialization versions.\n+    enum Format : uint8_t {\n+        V0_HISTORICAL = 0,    //!< historic format, before commit e6b343d88\n+        V1_DETERMINISTIC = 1, //!< for pre-asmap files\n+        V2_ASMAP = 2,         //!< for files including asmap version\n+        V3_BIP155 = 3,        //!< same as V2_ASMAP plus addresses are in BIP155 format\n+    };\n+\n+    //! The initial value of a field that is incremented every time an incompatible format\n+    //! change is made. This is 32 instead of 0 because we overtook the \"key size\" field\n+    //! which was 32 historically and we don't want to start with 0 and bump into 32 at\n+    //! some point in the future.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520425775",
      "id" : 520425775,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDQyNTc3NQ==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 191,
      "original_position" : 23,
      "original_start_line" : 189,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 527008374,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520425775",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520447920"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520447920"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: Any value equal to or greater than 32 should be fine here. As this is a breaking change (old versions can't read the peers.dat created by this version of Bitcoin Core), might as well bump to 33 right away to avoid confusion with the \"magic value\" 32.\r\n",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-10T10:19:17Z",
      "diff_hunk" : "@@ -176,6 +177,20 @@ friend class CAddrManTest;\n     mutable RecursiveMutex cs;\n \n private:\n+    //! Serialization versions.\n+    enum Format : uint8_t {\n+        V0_HISTORICAL = 0,    //!< historic format, before commit e6b343d88\n+        V1_DETERMINISTIC = 1, //!< for pre-asmap files\n+        V2_ASMAP = 2,         //!< for files including asmap version\n+        V3_BIP155 = 3,        //!< same as V2_ASMAP plus addresses are in BIP155 format\n+    };\n+\n+    //! The initial value of a field that is incremented every time an incompatible format\n+    //! change is made. This is 32 instead of 0 because we overtook the \"key size\" field\n+    //! which was 32 historically and we don't want to start with 0 and bump into 32 at\n+    //! some point in the future.\n+    static constexpr uint8_t m_incompatibility_base = 32;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520447920",
      "id" : 520447920,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDQ0NzkyMA==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 192,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 527053663,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520447920",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520457896"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520457896"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Or perhaps use `0x80` as a very obvious offset. We're unlikely to have 128 file versions so we're not going to run out of bits.",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-10T10:34:29Z",
      "diff_hunk" : "@@ -176,6 +177,20 @@ friend class CAddrManTest;\n     mutable RecursiveMutex cs;\n \n private:\n+    //! Serialization versions.\n+    enum Format : uint8_t {\n+        V0_HISTORICAL = 0,    //!< historic format, before commit e6b343d88\n+        V1_DETERMINISTIC = 1, //!< for pre-asmap files\n+        V2_ASMAP = 2,         //!< for files including asmap version\n+        V3_BIP155 = 3,        //!< same as V2_ASMAP plus addresses are in BIP155 format\n+    };\n+\n+    //! The initial value of a field that is incremented every time an incompatible format\n+    //! change is made. This is 32 instead of 0 because we overtook the \"key size\" field\n+    //! which was 32 historically and we don't want to start with 0 and bump into 32 at\n+    //! some point in the future.\n+    static constexpr uint8_t m_incompatibility_base = 32;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520457896",
      "id" : 520457896,
      "in_reply_to_id" : 520447920,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDQ1Nzg5Ng==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 192,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 527066174,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520457896",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520590073"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520590073"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It is possible to use `CustomUintFormatter` here. This line is not otherwise modified by the patch, so it would be sneaking an unnecessary change, so I left it as is to ease reviewers and future history observers.",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-10T14:10:43Z",
      "diff_hunk" : "@@ -332,7 +339,12 @@ friend class CAddrManTest;\n         OverrideStream<Stream> s(&s_, s_.GetType(), s_.GetVersion() | ADDRV2_FORMAT);\n \n         s << static_cast<uint8_t>(Format::V3_BIP155);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520590073",
      "id" : 520590073,
      "in_reply_to_id" : 520327284,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU5MDA3Mw==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 351,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 527238768,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520590073",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520591235"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520591235"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I agree. Removed the last sentence. Alas, the code that catches this exception is too generic and we can't print \"Continuing operation without using the saved list of peers\" from it.",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-10T14:12:09Z",
      "diff_hunk" : "@@ -410,9 +413,20 @@ friend class CAddrManTest;\n \n         OverrideStream<Stream> s(&s_, s_.GetType(), stream_version);\n \n-        unsigned char nKeySize;\n-        s >> nKeySize;\n-        if (nKeySize != 32) throw std::ios_base::failure(\"Incorrect keysize in addrman deserialization\");\n+        //! The maximum format this software can Unserialize().\n+        static constexpr Format maximum_supported_format = Format::V3_BIP155;\n+\n+        uint8_t compat;\n+        s >> compat;\n+        const uint8_t lowest_compatible = compat - m_incompatibility_base;\n+        if (lowest_compatible > maximum_supported_format) {\n+            throw std::ios_base::failure(\n+                strprintf(\"Unsupported format of addrman database: %u. It is compatible with \"\n+                          \"formats >=%u, but the maximum supported by this version of %s is %u. \"\n+                          \"Continuing operation without using the saved list of peers.\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520591235",
      "id" : 520591235,
      "in_reply_to_id" : 520329901,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU5MTIzNQ==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 426,
      "original_position" : 91,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 527240276,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520591235",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520612084"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520612084"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Changed to `INCOMPATIBILITY_BASE`.",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-10T14:39:18Z",
      "diff_hunk" : "@@ -176,6 +177,20 @@ friend class CAddrManTest;\n     mutable RecursiveMutex cs;\n \n private:\n+    //! Serialization versions.\n+    enum Format : uint8_t {\n+        V0_HISTORICAL = 0,    //!< historic format, before commit e6b343d88\n+        V1_DETERMINISTIC = 1, //!< for pre-asmap files\n+        V2_ASMAP = 2,         //!< for files including asmap version\n+        V3_BIP155 = 3,        //!< same as V2_ASMAP plus addresses are in BIP155 format\n+    };\n+\n+    //! The initial value of a field that is incremented every time an incompatible format\n+    //! change is made. This is 32 instead of 0 because we overtook the \"key size\" field\n+    //! which was 32 historically and we don't want to start with 0 and bump into 32 at\n+    //! some point in the future.\n+    static constexpr uint8_t m_incompatibility_base = 32;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520612084",
      "id" : 520612084,
      "in_reply_to_id" : 520412455,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDYxMjA4NA==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 192,
      "original_position" : 24,
      "original_start_line" : 188,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 527268210,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520612084",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520627113"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520627113"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Renamed to `maximum_known_format`.\r\n\r\nThere is no use for such a constant in `Serialize()`. It is only necessary in `Unserialize()`, thus I think it is better to have it as local variable in `Unserialize()` in order to minimize its span.",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-10T14:57:45Z",
      "diff_hunk" : "@@ -410,9 +413,20 @@ friend class CAddrManTest;\n \n         OverrideStream<Stream> s(&s_, s_.GetType(), stream_version);\n \n-        unsigned char nKeySize;\n-        s >> nKeySize;\n-        if (nKeySize != 32) throw std::ios_base::failure(\"Incorrect keysize in addrman deserialization\");\n+        //! The maximum format this software can Unserialize().\n+        static constexpr Format maximum_supported_format = Format::V3_BIP155;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520627113",
      "id" : 520627113,
      "in_reply_to_id" : 520414528,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDYyNzExMw==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 417,
      "original_position" : 82,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 527288161,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520627113",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520627563"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520627563"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I updated the `* Serialized format` comment.",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-10T14:58:22Z",
      "diff_hunk" : "@@ -332,7 +339,12 @@ friend class CAddrManTest;\n         OverrideStream<Stream> s(&s_, s_.GetType(), s_.GetVersion() | ADDRV2_FORMAT);\n \n         s << static_cast<uint8_t>(Format::V3_BIP155);\n-        s << ((unsigned char)32);\n+\n+        // Increment `lowest_compatible` iff a newly introduced format is incompatible with",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520627563",
      "id" : 520627563,
      "in_reply_to_id" : 520417770,
      "line" : 361,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDYyNzU2Mw==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 361,
      "original_position" : 50,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : 86,
      "pull_request_review_id" : 527288790,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520627563",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520628458"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520628458"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> I'd just leave the explanation out.\r\n\r\nRemoved the last part of the comment.",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-10T14:59:27Z",
      "diff_hunk" : "@@ -176,6 +177,20 @@ friend class CAddrManTest;\n     mutable RecursiveMutex cs;\n \n private:\n+    //! Serialization versions.\n+    enum Format : uint8_t {\n+        V0_HISTORICAL = 0,    //!< historic format, before commit e6b343d88\n+        V1_DETERMINISTIC = 1, //!< for pre-asmap files\n+        V2_ASMAP = 2,         //!< for files including asmap version\n+        V3_BIP155 = 3,        //!< same as V2_ASMAP plus addresses are in BIP155 format\n+    };\n+\n+    //! The initial value of a field that is incremented every time an incompatible format\n+    //! change is made. This is 32 instead of 0 because we overtook the \"key size\" field\n+    //! which was 32 historically and we don't want to start with 0 and bump into 32 at\n+    //! some point in the future.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520628458",
      "id" : 520628458,
      "in_reply_to_id" : 520425775,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDYyODQ1OA==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 191,
      "original_position" : 23,
      "original_start_line" : 189,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 527290009,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520628458",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520643076"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520643076"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think it should be one of `29`, `30`, `31` or `32`:\r\n\r\n```cpp\r\n// Unserialize in 0.21\r\nlowest_compatible = byte_read_from_disk - INCOMPATIBILITY_BASE;\r\n```\r\n\r\n0.20 write `32` to disk\r\n\r\nSo\r\n\r\n* If `INCOMPATIBILITY_BASE` is `28` or less then a file written by 0.20 will be rendered unreadable by 0.21 as having too high `lowest_compatible`: `4` or higher.\r\n* If `INCOMPATIBILITY_BASE` is one of `29`, `30`, `31` or `32` then a file written by 0.20 will appear to have `lowest_compatible` `3`, `2`, `1` or `0` which is ok for 0.21.\r\n* If `INCOMPATIBILITY_BASE` is `33` or greater then a file written by 0.20 will cause 0.21 to calculate a negative `lowest_compatible`.\r\n\r\nSo I left it as `32`.",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-10T15:18:09Z",
      "diff_hunk" : "@@ -176,6 +177,20 @@ friend class CAddrManTest;\n     mutable RecursiveMutex cs;\n \n private:\n+    //! Serialization versions.\n+    enum Format : uint8_t {\n+        V0_HISTORICAL = 0,    //!< historic format, before commit e6b343d88\n+        V1_DETERMINISTIC = 1, //!< for pre-asmap files\n+        V2_ASMAP = 2,         //!< for files including asmap version\n+        V3_BIP155 = 3,        //!< same as V2_ASMAP plus addresses are in BIP155 format\n+    };\n+\n+    //! The initial value of a field that is incremented every time an incompatible format\n+    //! change is made. This is 32 instead of 0 because we overtook the \"key size\" field\n+    //! which was 32 historically and we don't want to start with 0 and bump into 32 at\n+    //! some point in the future.\n+    static constexpr uint8_t m_incompatibility_base = 32;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520643076",
      "id" : 520643076,
      "in_reply_to_id" : 520447920,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDY0MzA3Ng==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 192,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 527309622,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520643076",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> The commit log should s/backwards compatible/forwards compatible/.\r\n\r\nI think the confusion with forward vs backward compatible <sup>[1](http://www.erisian.com.au/bitcoin-core-dev/log-2020-11-03.html#l-269), [2](http://www.erisian.com.au/bitcoin-core-dev/log-2020-11-03.html#l-379), [3](http://www.erisian.com.au/bitcoin-core-dev/log-2020-11-03.html#l-383)</sup> is because forward/backward is relative - from the point of view of the new software the old one is backwards and from the point of view of the old software the new one is forwards (in time). Also, there is software version and file format version which makes it further confusing when we consider old software and new file format and new software with old file format.\r\n\r\nFor example, [Wikipedia](https://en.wikipedia.org/wiki/Backward_compatibility) contains this:\r\n\r\n> A data format is said to be backward compatible with its predecessor if every message or file that is valid under the old format is still valid, retaining its meaning under the new format.\r\n\r\nWhich means that our `peers.dat` format=3 is not backward compatible with its predecessor format=2.\r\n\r\nThe current `master` [contains](https://github.com/bitcoin/bitcoin/blob/42f950cb27b732782d55282cdcd934396fcd7071/src/addrman.h#L299) this:\r\n\r\n> 0x20 + nKey (serialized as if it were a vector, for backward compatibility)\r\n\r\nDo you think that should be `s/backward/forward/`?\r\n\r\nI have reworded the commit message to explain the matters without using the words \"backward\" or \"forward\".\r\n",
      "created_at" : "2020-11-10T15:21:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-724771283",
      "id" : 724771283,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNDc3MTI4Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-10T15:21:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/724771283",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Addressed suggestions - reworded comments, a log message and renamed two variables.",
      "created_at" : "2020-11-10T15:24:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-724773339",
      "id" : 724773339,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNDc3MzMzOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-10T15:43:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/724773339",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520665020"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520665020"
         }
      },
      "author_association" : "MEMBER",
      "body" : "My point is that the \"maximum known format\" should always the same as the value that is serialized into the format version byte. It's the format that this software uses.\r\n\r\nDefining a constant here means that it needs to be updated at the same time as line 351 where the version is serialized into the file.",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-10T15:45:39Z",
      "diff_hunk" : "@@ -410,9 +413,20 @@ friend class CAddrManTest;\n \n         OverrideStream<Stream> s(&s_, s_.GetType(), stream_version);\n \n-        unsigned char nKeySize;\n-        s >> nKeySize;\n-        if (nKeySize != 32) throw std::ios_base::failure(\"Incorrect keysize in addrman deserialization\");\n+        //! The maximum format this software can Unserialize().\n+        static constexpr Format maximum_supported_format = Format::V3_BIP155;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520665020",
      "id" : 520665020,
      "in_reply_to_id" : 520414528,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDY2NTAyMA==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 417,
      "original_position" : 82,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 527338538,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520665020",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520666464"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520666464"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'd suggest not using actual version numbers in this comment. At some point we'll have versions 0.23 and 0.25, and they might not use file versions 4 and 5, and this comment will be confusing.",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-10T15:47:35Z",
      "diff_hunk" : "@@ -295,8 +303,17 @@ friend class CAddrManTest;\n \n     /**\n      * Serialized format.\n-     * * version byte (@see `Format`)\n-     * * 0x20 + nKey (serialized as if it were a vector, for backward compatibility)\n+     * * format version byte (@see `Format`)\n+     * * lowest compatible format version byte. This is used to help old software decide\n+     *   whether to parse the file. For example:\n+     *   * Bitcoin Core 0.21 knows how to parse up to format=3. If a new format=4 is introduced\n+     *     in Bitcoin Core 0.23 which is compatible with format=3 and it is known that 0.21 will\n+     *     be able to parse it, then 0.23 will write (format=4, lowest_compatible=3) in the\n+     *     first two bytes of the file and so 0.21 will still try to parse it.\n+     *   * Bitcoin Core 0.25 introduces a new incompatible format=5. It will write\n+     *     (format=5, lowest_compatible=5) and so any versions that do not know how to parse\n+     *     format=5 will not try to read the file.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520666464",
      "id" : 520666464,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDY2NjQ2NA==",
      "original_commit_id" : "1c60aba1da161e3986ff95d3c273c1de29a4299a",
      "original_line" : 323,
      "original_position" : 60,
      "original_start_line" : 309,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 527340575,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520666464",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I think the confusion with forward vs backward compatible...\r\n\r\nThe fact that there's confusion is exactly the reason we should precise with our language. We have exact terminology for these concepts, so we should use it consistently to avoid future confusion:\r\n\r\n- software is backward-compatible if it can read old input formats\r\n- software is forward-compatible if it can gracefully read new input formats (ignoring the new parts it can't understand)\r\n=> a change to an input format breaks forward-compatibility if the new file format can't be read by old software.\r\n\r\n> The current master contains this:\r\n> > 0x20 + nKey (serialized as if it were a vector, for backward compatibility)\r\n>\r\n> Do you think that should be s/backward/forward/?\r\n\r\nNo, this is for backwards compatibility. That format change broke forward-compatibility explicitly by XOR'ing the number of new buckets with 2**30. Explicitly having the new software write the same value to this field means that the software can read both v0 and v1 without any branching logic at that point. That's the easiest way to achieve backward-compatibility.",
      "created_at" : "2020-11-10T16:17:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-724807161",
      "id" : 724807161,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNDgwNzE2MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-10T16:17:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/724807161",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520700683"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520700683"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "_Now_ I changed this line for other reasons and switched to `CustomUintFormatter` :-)",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-10T16:32:05Z",
      "diff_hunk" : "@@ -332,7 +339,12 @@ friend class CAddrManTest;\n         OverrideStream<Stream> s(&s_, s_.GetType(), s_.GetVersion() | ADDRV2_FORMAT);\n \n         s << static_cast<uint8_t>(Format::V3_BIP155);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520700683",
      "id" : 520700683,
      "in_reply_to_id" : 520327284,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDcwMDY4Mw==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 351,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 527386329,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520700683",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520701293"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520701293"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I see you point now. Moved as a member variable of the class, renamed to `FILE_FORMAT` and used in `Serialize()` too.",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-10T16:32:57Z",
      "diff_hunk" : "@@ -410,9 +413,20 @@ friend class CAddrManTest;\n \n         OverrideStream<Stream> s(&s_, s_.GetType(), stream_version);\n \n-        unsigned char nKeySize;\n-        s >> nKeySize;\n-        if (nKeySize != 32) throw std::ios_base::failure(\"Incorrect keysize in addrman deserialization\");\n+        //! The maximum format this software can Unserialize().\n+        static constexpr Format maximum_supported_format = Format::V3_BIP155;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520701293",
      "id" : 520701293,
      "in_reply_to_id" : 520414528,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDcwMTI5Mw==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 417,
      "original_position" : 82,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 527387163,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520701293",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520702384"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520702384"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Changed to `V`, `V+1` and `V+2`.",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-10T16:34:26Z",
      "diff_hunk" : "@@ -295,8 +303,17 @@ friend class CAddrManTest;\n \n     /**\n      * Serialized format.\n-     * * version byte (@see `Format`)\n-     * * 0x20 + nKey (serialized as if it were a vector, for backward compatibility)\n+     * * format version byte (@see `Format`)\n+     * * lowest compatible format version byte. This is used to help old software decide\n+     *   whether to parse the file. For example:\n+     *   * Bitcoin Core 0.21 knows how to parse up to format=3. If a new format=4 is introduced\n+     *     in Bitcoin Core 0.23 which is compatible with format=3 and it is known that 0.21 will\n+     *     be able to parse it, then 0.23 will write (format=4, lowest_compatible=3) in the\n+     *     first two bytes of the file and so 0.21 will still try to parse it.\n+     *   * Bitcoin Core 0.25 introduces a new incompatible format=5. It will write\n+     *     (format=5, lowest_compatible=5) and so any versions that do not know how to parse\n+     *     format=5 will not try to read the file.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520702384",
      "id" : 520702384,
      "in_reply_to_id" : 520666464,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDcwMjM4NA==",
      "original_commit_id" : "1c60aba1da161e3986ff95d3c273c1de29a4299a",
      "original_line" : 323,
      "original_position" : 60,
      "original_start_line" : 309,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 527388553,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/520702384",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Addressed suggestions - reworded a comment and moved a local variable as a member of the class.",
      "created_at" : "2020-11-10T16:38:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-724820489",
      "id" : 724820489,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNDgyMDQ4OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-10T16:38:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/724820489",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK eaa04bec653428091a9434fa08253a9b89e01fd6\r\n\r\nFunctionally this is fine and can be merged for 0.21. However, I think that the comments are still very confused/confusing and could be tidied up with precise terminology and clearer explanations.",
      "created_at" : "2020-11-10T16:45:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-724824596",
      "id" : 724824596,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNDgyNDU5Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-10T16:45:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/724824596",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "looks like this doesn't compile:\r\n\r\n```\r\n/tmp/cirrus-ci-build/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/./addrman.h:438: undefined reference to `CAddrMan::FILE_FORMAT'",
      "created_at" : "2020-11-10T17:13:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-724841956",
      "id" : 724841956,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNDg0MTk1Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-10T17:13:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/724841956",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> looks like this doesn't compile:\r\n> \r\n> ```\r\n> /tmp/cirrus-ci-build/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/./addrman.h:438: undefined reference to `CAddrMan::FILE_FORMAT'\r\n> ```\r\n\r\nPushed a blind attempt to fix it (it does compile locally).",
      "created_at" : "2020-11-10T17:14:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-724842803",
      "id" : 724842803,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNDg0MjgwMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-10T17:14:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/724842803",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> * software is backward-compatible if it can read old input formats\r\n> * software is forward-compatible if it can gracefully read new input formats (ignoring the new parts it can't understand) => a change to an input format breaks forward-compatibility if the new file format can't be read by old software.\r\n\r\nOk, so backward and forward compatibility is a property of the software, not of the formats.\r\n\r\n> No, this is for backwards compatibility. That format change broke forward-compatibility explicitly by XOR'ing the number of new buckets with 2**30.\r\n\r\nI'm not sure that's true according to your definition above. The writing of the 0x20 prefix is there such that old software can still read the nKey (as it used to be serialized as a vector) - the new software doesn't care about the prefix. So I think your definition above says this is forward compatibility: old software reading the new format gracefully.\r\n\r\nThe same is true about the XORing of the bucket count with 2**30. It's there to trigger a re-bucketing if read by old software, which means it deals with the new format, albeit with reduced functionality (the bucket assignments aren't retained).\r\n\r\nV3 is the first actual incompatibility that was introduced: old software cannot read addrv2 encoding at all. It's arguably still \"graceful\" in that old Bitcoin Core keeps working when it finds a future peers.dat file, but as it means the same as starting with no peers.dat I think it's fair to call that incompatible.\r\n\r\nI think the compatibility table is something like this:\r\n\r\n| Format version | Software V0 | Software V1 | Software V2 | Software V3 |\r\n| - | - | - | - | - |\r\n| **V0** |  | R | R | R |\r\n| **V1** | R |  | R | R |\r\n| **V2** | R | R |  |  |\r\n| **V3** |  |  |  |  |\r\n\r\nWhere \"R\" means \"compatible but may trigger rebucketing\".\r\n\r\nThe upper right triangle represents backward compatibility (and is all R/, so we're good). The bottom left triangle represents forward compatibility, and V3 breaks that.",
      "created_at" : "2020-11-10T17:23:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-724847778",
      "id" : 724847778,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNDg0Nzc3OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-10T17:33:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/724847778",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> So I think your definition above says this is forward compatibility: old software reading the new format gracefully.\r\n\r\n> The same is true about the XORing of the bucket count with 2**30. It's there to trigger a re-bucketing if read by old software, which means it deals with the new format, albeit with reduced functionality (the bucket assignments aren't retained).\r\n\r\nAh! Those both make sense. Thanks!",
      "created_at" : "2020-11-10T18:32:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-724886142",
      "id" : 724886142,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNDg4NjE0Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-10T18:32:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/724886142",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r521234708"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/521234708"
         }
      },
      "author_association" : "MEMBER",
      "body" : "re https://github.com/bitcoin/bitcoin/pull/20284#discussion_r520327284. I don't understand why we want this change. The comment for `CustomUintFormatter` says \"This is only intended to implement serializers that are compatible with existing formats, and its use is not recommended for new data structures.\"\r\n",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-11T09:42:15Z",
      "diff_hunk" : "@@ -332,7 +339,12 @@ friend class CAddrManTest;\n         OverrideStream<Stream> s(&s_, s_.GetType(), s_.GetVersion() | ADDRV2_FORMAT);\n \n         s << static_cast<uint8_t>(Format::V3_BIP155);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r521234708",
      "id" : 521234708,
      "in_reply_to_id" : 520327284,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTIzNDcwOA==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 351,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 528012727,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/521234708",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r521239550"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/521239550"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The comment only applies to endianness, see https://github.com/bitcoin/bitcoin/pull/18317#discussion_r427621184.\r\nGenerally, I think serialize/deserialze should use the same helpers, so either `CustomUintFormatter` should be used for both paths or for none.\r\n",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-11T09:50:28Z",
      "diff_hunk" : "@@ -332,7 +339,12 @@ friend class CAddrManTest;\n         OverrideStream<Stream> s(&s_, s_.GetType(), s_.GetVersion() | ADDRV2_FORMAT);\n \n         s << static_cast<uint8_t>(Format::V3_BIP155);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r521239550",
      "id" : 521239550,
      "in_reply_to_id" : 520327284,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTIzOTU1MA==",
      "original_commit_id" : "5cde64168976dea9e5d1422b23159413de1307dc",
      "original_line" : 351,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 528018910,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/521239550",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Pushed a blind attempt to fix it\r\n\r\nI think it'd be better to fix this by just casting the enum to an int in the unserialize exception:\r\n\r\n```diff\r\ndiff --git a/src/addrman.cpp b/src/addrman.cpp\r\nindex 0067a32994..7636c6bad2 100644\r\n--- a/src/addrman.cpp\r\n+++ b/src/addrman.cpp\r\n@@ -71,8 +71,6 @@ double CAddrInfo::GetChance(int64_t nNow) const\r\n     return fChance;\r\n }\r\n \r\n-constexpr CAddrMan::Format CAddrMan::FILE_FORMAT;\r\n-\r\n CAddrInfo* CAddrMan::Find(const CNetAddr& addr, int* pnId)\r\n {\r\n     std::map<CNetAddr, int>::iterator it = mapAddr.find(addr);\r\ndiff --git a/src/addrman.h b/src/addrman.h\r\nindex 8c9ed3f563..a18124dcad 100644\r\n--- a/src/addrman.h\r\n+++ b/src/addrman.h\r\n@@ -437,7 +437,7 @@ public:\r\n             throw std::ios_base::failure(\r\n                 strprintf(\"Unsupported format of addrman database: %u. It is compatible with \"\r\n                           \"formats >=%u, but the maximum supported by this version of %s is %u.\",\r\n-                          format, lowest_compatible, PACKAGE_NAME, FILE_FORMAT));\r\n+                          format, lowest_compatible, PACKAGE_NAME, static_cast<uint8_t>(FILE_FORMAT)));\r\n         }\r\n \r\n         s >> nKey;\r\n```",
      "created_at" : "2020-11-11T10:28:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-725341208",
      "id" : 725341208,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNTM0MTIwOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-11T10:28:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/725341208",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r521307102"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/521307102"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I could be mistaken, but ISTM it's too late to make changes here; the release notes have been migrated to https://github.com/bitcoin-core/bitcoin-devwiki/wiki/0.21.0-Release-Notes-Draft where you can make this change manually.",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-11T11:55:56Z",
      "diff_hunk" : "@@ -65,8 +65,8 @@ format of this file has been changed in a backwards-incompatible way in order to\n accommodate the storage of Tor v3 and other BIP155 addresses. This means that if\n the file is modified by 0.21.0 or newer then older versions will not be able to\n read it. Those old versions, in the event of a downgrade, will log an error\n-message that deserialization has failed and will continue normal operation\n-as if the file was missing, creating a new empty one. (#19954)\n+message \"Incorrect keysize in addrman deserialization\" and will continue normal\n+operation as if the file was missing, creating a new empty one. (#19954)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r521307102",
      "id" : 521307102,
      "line" : 69,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTMwNzEwMg==",
      "original_commit_id" : "2ed531dfcd9142cd1d16526dbea0aa45d991786b",
      "original_line" : 69,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "doc/release-notes.md",
      "position" : 7,
      "pull_request_review_id" : 528106395,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/521307102",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 2ed531dfcd9142cd1d16526dbea0aa45d991786b",
      "created_at" : "2020-11-11T11:59:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-725383155",
      "id" : 725383155,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNTM4MzE1NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-11T11:59:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/725383155",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r521313470"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/521313470"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Bitcoin Core V? These look like Roman numerals (anyone remember the [Saturn V](https://en.wikipedia.org/wiki/Saturn_V) rocket?)\r\n\r\nPerhaps:\r\n```diff\r\n-     *   whether to parse the file. For example:\r\n-     *   * Bitcoin Core V knows how to parse up to format=3. If a new format=4 is introduced\r\n-     *     in Bitcoin Core V+1 which is compatible with format=3 and it is known that V will\r\n-     *     be able to parse it, then V+1 will write (format=4, lowest_compatible=3) in the\r\n-     *     first two bytes of the file and so V will still try to parse it.\r\n-     *   * Bitcoin Core V+2 introduces a new incompatible format=5. It will write\r\n+     *   whether to parse the file.\r\n+     *   For example:\r\n+     *   * Bitcoin Core version n knows how to parse up to format=3. If a new format=4 is introduced\r\n+     *     in version n + 1 that is compatible with format=3 and it is known that version n will\r\n+     *     be able to parse it, then version n + 1 will write (format=4, lowest_compatible=3) in the\r\n+     *     first two bytes of the file, and so version n will still try to parse it.\r\n+     *   * Bitcoin Core version n + 2 introduces a new incompatible format=5. It will write\r\n```\r\n",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-11T12:08:42Z",
      "diff_hunk" : "@@ -295,8 +310,17 @@ friend class CAddrManTest;\n \n     /**\n      * Serialized format.\n-     * * version byte (@see `Format`)\n-     * * 0x20 + nKey (serialized as if it were a vector, for backward compatibility)\n+     * * format version byte (@see `Format`)\n+     * * lowest compatible format version byte. This is used to help old software decide\n+     *   whether to parse the file. For example:\n+     *   * Bitcoin Core V knows how to parse up to format=3. If a new format=4 is introduced",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r521313470",
      "id" : 521313470,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTMxMzQ3MA==",
      "original_commit_id" : "2ed531dfcd9142cd1d16526dbea0aa45d991786b",
      "original_line" : 316,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 528106395,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/521313470",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r521320881"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/521320881"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Will tweak if I retouch :)",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-11T12:22:54Z",
      "diff_hunk" : "@@ -295,8 +310,17 @@ friend class CAddrManTest;\n \n     /**\n      * Serialized format.\n-     * * version byte (@see `Format`)\n-     * * 0x20 + nKey (serialized as if it were a vector, for backward compatibility)\n+     * * format version byte (@see `Format`)\n+     * * lowest compatible format version byte. This is used to help old software decide\n+     *   whether to parse the file. For example:\n+     *   * Bitcoin Core V knows how to parse up to format=3. If a new format=4 is introduced",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r521320881",
      "id" : 521320881,
      "in_reply_to_id" : 521313470,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTMyMDg4MQ==",
      "original_commit_id" : "2ed531dfcd9142cd1d16526dbea0aa45d991786b",
      "original_line" : 316,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 528124165,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/521320881",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r521321140"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/521321140"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "ok, if this gets merged then I will also update that wiki",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-11T12:23:27Z",
      "diff_hunk" : "@@ -65,8 +65,8 @@ format of this file has been changed in a backwards-incompatible way in order to\n accommodate the storage of Tor v3 and other BIP155 addresses. This means that if\n the file is modified by 0.21.0 or newer then older versions will not be able to\n read it. Those old versions, in the event of a downgrade, will log an error\n-message that deserialization has failed and will continue normal operation\n-as if the file was missing, creating a new empty one. (#19954)\n+message \"Incorrect keysize in addrman deserialization\" and will continue normal\n+operation as if the file was missing, creating a new empty one. (#19954)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r521321140",
      "id" : 521321140,
      "in_reply_to_id" : 521307102,
      "line" : 69,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTMyMTE0MA==",
      "original_commit_id" : "2ed531dfcd9142cd1d16526dbea0aa45d991786b",
      "original_line" : 69,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "doc/release-notes.md",
      "position" : 7,
      "pull_request_review_id" : 528124528,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/521321140",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r521362080"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/521362080"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Reworded.",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-11T13:36:23Z",
      "diff_hunk" : "@@ -295,8 +310,17 @@ friend class CAddrManTest;\n \n     /**\n      * Serialized format.\n-     * * version byte (@see `Format`)\n-     * * 0x20 + nKey (serialized as if it were a vector, for backward compatibility)\n+     * * format version byte (@see `Format`)\n+     * * lowest compatible format version byte. This is used to help old software decide\n+     *   whether to parse the file. For example:\n+     *   * Bitcoin Core V knows how to parse up to format=3. If a new format=4 is introduced",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r521362080",
      "id" : 521362080,
      "in_reply_to_id" : 521313470,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTM2MjA4MA==",
      "original_commit_id" : "2ed531dfcd9142cd1d16526dbea0aa45d991786b",
      "original_line" : 316,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 528176305,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:22:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/521362080",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I think it'd be better to fix this by just casting the enum to an int in the unserialize exception:\r\n\r\nThat [did not compile](https://cirrus-ci.com/task/6471173661786112?command=ci#L3847). Went back to the previous version and addressed [Saturn V](https://github.com/bitcoin/bitcoin/pull/20284#discussion_r521313470).\r\n\r\nThis should be the final version of it.",
      "created_at" : "2020-11-11T13:41:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-725429466",
      "id" : 725429466,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNTQyOTQ2Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-11T13:41:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/725429466",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Nothing is final!",
      "created_at" : "2020-11-11T15:24:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-725485153",
      "id" : 725485153,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNTQ4NTE1Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-11T15:24:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/725485153",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 38ada892ed0ed9aaa46b1791db12a371a3c0c419\r\n\r\nThanks @vasild!",
      "created_at" : "2020-11-11T15:37:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-725493230",
      "id" : 725493230,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNTQ5MzIzMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-11T15:37:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/725493230",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r521448806"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/521448806"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\noperation as if the file was missing, creating a new empty one. (#19954, #20284)\r\n```\r\n\r\nfor the release notes  wiki (not this pull) \r\n\r\nEdit: done here: https://github.com/bitcoin-core/bitcoin-devwiki/wiki/0.21.0-Release-Notes-Draft/_compare/ef1291e4985154b703bc5c87decdf68dbe0fcc20...c98b735a5bbf337f9f7bb065b56f490804cf9ae7",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-11T15:43:51Z",
      "diff_hunk" : "@@ -65,8 +65,8 @@ format of this file has been changed in a backwards-incompatible way in order to\n accommodate the storage of Tor v3 and other BIP155 addresses. This means that if\n the file is modified by 0.21.0 or newer then older versions will not be able to\n read it. Those old versions, in the event of a downgrade, will log an error\n-message that deserialization has failed and will continue normal operation\n-as if the file was missing, creating a new empty one. (#19954)\n+message \"Incorrect keysize in addrman deserialization\" and will continue normal\n+operation as if the file was missing, creating a new empty one. (#19954)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r521448806",
      "id" : 521448806,
      "line" : 69,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ0ODgwNg==",
      "original_commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "original_line" : 69,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "doc/release-notes.md",
      "position" : 7,
      "pull_request_review_id" : 528290619,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:47:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/521448806",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r521450932"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/521450932"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done here: https://github.com/bitcoin-core/bitcoin-devwiki/wiki/0.21.0-Release-Notes-Draft/_compare/ef1291e4985154b703bc5c87decdf68dbe0fcc20...c98b735a5bbf337f9f7bb065b56f490804cf9ae7",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-11T15:46:51Z",
      "diff_hunk" : "@@ -65,8 +65,8 @@ format of this file has been changed in a backwards-incompatible way in order to\n accommodate the storage of Tor v3 and other BIP155 addresses. This means that if\n the file is modified by 0.21.0 or newer then older versions will not be able to\n read it. Those old versions, in the event of a downgrade, will log an error\n-message that deserialization has failed and will continue normal operation\n-as if the file was missing, creating a new empty one. (#19954)\n+message \"Incorrect keysize in addrman deserialization\" and will continue normal\n+operation as if the file was missing, creating a new empty one. (#19954)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r521450932",
      "id" : 521450932,
      "in_reply_to_id" : 521307102,
      "line" : 69,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ1MDkzMg==",
      "original_commit_id" : "2ed531dfcd9142cd1d16526dbea0aa45d991786b",
      "original_line" : 69,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "doc/release-notes.md",
      "position" : 7,
      "pull_request_review_id" : 528293404,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-11T15:46:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/521450932",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "(the timed-out test run can be ignored)",
      "created_at" : "2020-11-12T12:31:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-726049493",
      "id" : 726049493,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNjA0OTQ5Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-12T12:31:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/726049493",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r522099886"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/522099886"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I am somewhat partial to the idea of a roman numerals based version scheme :slightly_smiling_face: *upcoming release will be Bitcoin Core XXI* lol",
      "commit_id" : "38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-12T13:21:01Z",
      "diff_hunk" : "@@ -295,8 +310,17 @@ friend class CAddrManTest;\n \n     /**\n      * Serialized format.\n-     * * version byte (@see `Format`)\n-     * * 0x20 + nKey (serialized as if it were a vector, for backward compatibility)\n+     * * format version byte (@see `Format`)\n+     * * lowest compatible format version byte. This is used to help old software decide\n+     *   whether to parse the file. For example:\n+     *   * Bitcoin Core V knows how to parse up to format=3. If a new format=4 is introduced",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#discussion_r522099886",
      "id" : 522099886,
      "in_reply_to_id" : 521313470,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjA5OTg4Ng==",
      "original_commit_id" : "2ed531dfcd9142cd1d16526dbea0aa45d991786b",
      "original_line" : 316,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "src/addrman.h",
      "position" : null,
      "pull_request_review_id" : 529078350,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20284",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-12T13:21:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/522099886",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK 38ada892ed0ed9aaa46b1791db12a371a3c0c419",
      "created_at" : "2020-11-12T16:05:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20284#issuecomment-726172937",
      "id" : 726172937,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20284",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNjE3MjkzNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-12T16:05:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/726172937",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
