[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Hello @itoffshore,\r\n\r\nthanks for your report!\r\nI tried to reproduce the behaviour you described via Docker and came up with the following `Dockerfile` after some researching about Alpine Linux and its package system:\r\n```\r\nFROM alpine:3.12.1\r\nRUN apk add alpine-sdk\r\nRUN adduser --disabled-password btc\r\nRUN addgroup btc abuild\r\nUSER btc\r\nWORKDIR /home/btc\r\nRUN git clone git://git.alpinelinux.org/aports\r\nWORKDIR /home/btc/aports/community/bitcoin\r\nRUN abuild-keygen -a\r\nENTRYPOINT abuild -r\r\n```\r\n\r\nBuilding and running this container via\r\n```\r\n$ docker build -t bitcoin_issue_20236 . && docker run -it bitcoin_issue_20236\r\n```\r\n\r\nbuilds the source and runs the tests, which all pass on my system, which is a x86_64 architecture with 4.4.0 kernel. So I unfortunately couldn't reproduce your reported behaviour. Can you give more details on your system? Did you do any other steps than described in the Dockerfile (which is of course very minimal)? Does it make a difference if `make check` is called manually or via the `abuild` tool?\r\nAlso it would be interesting on how it is possible to keep the source after building -- after `abuild -r` the `src` folder within `aports/community/bitcoin/` seems to be gone.\r\n",
      "created_at" : "2020-10-26T01:37:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20236#issuecomment-716256032",
      "id" : 716256032,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20236",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxNjI1NjAzMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-26T01:37:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/716256032",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Does `make distclean` help?",
      "created_at" : "2020-10-26T07:06:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20236#issuecomment-716351645",
      "id" : 716351645,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20236",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxNjM1MTY0NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-26T07:06:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/716351645",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@theStack  - if you edit `/etc/abuild.conf` the `src` folder is not cleaned up after a successful build:\r\n\r\n```\r\n# what to clean up after a successful build\r\n#CLEANUP=\"srcdir pkgdir deps\"\r\nCLEANUP=\"deps\"\r\n```\r\n\r\n- My system is Arch Linux with `lxc-4.0.4-1` & an Alpine Linux Edge (latest currently 3.12.1) container\r\n- How I build `bitcoin` [is here](https://gitlab.alpinelinux.org/itoffshore/aports/-/blob/master/community/bitcoin/APKBUILD)\r\n- Current [Merge Request to fix bitcoin service](https://gitlab.alpinelinux.org/alpine/aports/-/merge_requests/13971) for reference\r\n\r\n@MarcoFalke - if I run `make distclean` immediately before `make clean` the `clean` target is not found.\r\n",
      "created_at" : "2020-10-26T08:23:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20236#issuecomment-716391281",
      "id" : 716391281,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20236",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxNjM5MTI4MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-26T08:23:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/716391281",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1141947?v=4",
         "events_url" : "https://api.github.com/users/itoffshore/events{/privacy}",
         "followers_url" : "https://api.github.com/users/itoffshore/followers",
         "following_url" : "https://api.github.com/users/itoffshore/following{/other_user}",
         "gists_url" : "https://api.github.com/users/itoffshore/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/itoffshore",
         "id" : 1141947,
         "login" : "itoffshore",
         "node_id" : "MDQ6VXNlcjExNDE5NDc=",
         "organizations_url" : "https://api.github.com/users/itoffshore/orgs",
         "received_events_url" : "https://api.github.com/users/itoffshore/received_events",
         "repos_url" : "https://api.github.com/users/itoffshore/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/itoffshore/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/itoffshore/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/itoffshore"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "What is the full output of `make check`? What version of python are you using?",
      "created_at" : "2020-10-26T08:53:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20236#issuecomment-716406112",
      "id" : 716406112,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20236",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxNjQwNjExMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-26T08:53:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/716406112",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "`python3 (3.8.6-r0)`\r\n\r\nif I run the tests now I get a different error due to [changing the environment to C](https://gitlab.alpinelinux.org/alpine/aports/-/merge_requests/13971/diffs?commit_id=e4fc9d8ade2658a4bae6d38eb4555486347e1853)\r\n\r\nWhen the tests failed before there was never a full report - only as the issue above\r\n",
      "created_at" : "2020-10-28T09:25:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20236#issuecomment-717807558",
      "id" : 717807558,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20236",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxNzgwNzU1OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-28T09:25:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/717807558",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1141947?v=4",
         "events_url" : "https://api.github.com/users/itoffshore/events{/privacy}",
         "followers_url" : "https://api.github.com/users/itoffshore/followers",
         "following_url" : "https://api.github.com/users/itoffshore/following{/other_user}",
         "gists_url" : "https://api.github.com/users/itoffshore/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/itoffshore",
         "id" : 1141947,
         "login" : "itoffshore",
         "node_id" : "MDQ6VXNlcjExNDE5NDc=",
         "organizations_url" : "https://api.github.com/users/itoffshore/orgs",
         "received_events_url" : "https://api.github.com/users/itoffshore/received_events",
         "repos_url" : "https://api.github.com/users/itoffshore/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/itoffshore/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/itoffshore/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/itoffshore"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Without the full output of `make check` or `./test/util/bitcoin-util-test.py` we can't debug this",
      "created_at" : "2020-10-28T09:30:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20236#issuecomment-717810630",
      "id" : 717810630,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20236",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxNzgxMDYzMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-28T09:30:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/717810630",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> When the tests failed before there was never a full report - only as the issue above\r\n\r\nCould you just manually run the util test (looking at the output, I think it's most likely that the issue is there) with the verbose option and redirect all of its output to a file, e.g.:\r\n\r\n```\r\n$ test/util/bitcoin-util-test.py -v > output.txt 2>&1\r\n```\r\n\r\nand then post the content of the output file here.",
      "created_at" : "2020-10-29T09:57:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20236#issuecomment-718568516",
      "id" : 718568516,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20236",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxODU2ODUxNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-29T09:57:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/718568516",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   }
]
