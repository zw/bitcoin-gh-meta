[
   {
      "author_association" : "MEMBER",
      "body" : "Very helpful. I think this helps define \"sprints\" that can be achieved to hit next milestones.",
      "created_at" : "2023-04-14T14:26:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27463#issuecomment-1508641506",
      "id" : 1508641506,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27463",
      "node_id" : "IC_kwDOABII585Z7Ari",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1508641506/reactions"
      },
      "updated_at" : "2023-04-14T14:26:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1508641506",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think one more sub-category to track is the feedback collected on how package relay/nversion=3 are fitting multi-party applications and contracting protocols\r\n- Lightning: legacy channels / anchor output / taproot types\r\n- Peerswap: claim with preimage + refund cooperatively + refund after csv passes\r\n- Collaborative transaction: splicing + dual funding flows\r\n\r\nThe [0-conf flow](https://github.com/lightning/bolts/pull/910) of Lightning can be also considered. As deployed today by some LSPs where both incoming/outgoing HTLCs are allowed during the pending confirmation period, there is a risk in case of mempool congestions of the inbound funding transaction not confirming before the timelock of the offered HTLC output expires. The current nversion=3 size is 1000 vb which might be too low if LSPs would like to do batching of 0-confs. Note, I think all the pinning risks are not the same for 0-conf funding transactions than for time-sensitive confirmation of LN commitment+HTLCs transactions.\r\n\r\nMentioning 0-conf, and as raised on [#27643](https://github.com/bitcoin/bitcoin/pull/26525#issuecomment-1473067644) at some point in the development cycle of nversion=3 it might be good communication practice to publish than all 0confs users might have to upgrade their mempool monitoring stuff to reject nversion=3, or chain of transactions with them, as otherwise genuine upgrade to the version of Core with package relay might lower their security.\r\n\r\nFor Lightning, there is the question if the p2p package format is flexible enough for the Lightning channels to apply \"new mempool rules\" on \"old in-flight channnel type\". Like backward compatible effect of the mempools rules without off-chain channels having to cooperate on-resigning transactions. I believe that would require a Lightning node to sign the p2p package with the same pubkey than used with the channel (though I start to think we might have multiple types of backward/forward compatible application of mempools rules like the ones mentioned in [#25038](https://github.com/bitcoin/bitcoin/pull/25038#issuecomment-1405944407), like there is some matrix ?)\r\n\r\nFor the second-layers listed, I'm just considering the ones which have a) a mature specification and b) some substantial deployment though should we consider more second-layers or multi-party applications like vaults (non-deployed) ?\r\n\r\nFrom a reviewer viewpoint, I think it could be very valuable if you can highlight the 2/3 PRs or mail posts you consider as top of the stack for reviews ? Thanks for a package-relay context-tracking meta-issue.\r\n\r\n(Feel free to integrate what you find relevant of this comment to ease context tracking of package relay as a project)",
      "created_at" : "2023-04-17T01:30:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27463#issuecomment-1510569136",
      "id" : 1510569136,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27463",
      "node_id" : "IC_kwDOABII585aCXSw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1510569136/reactions"
      },
      "updated_at" : "2023-04-17T01:30:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1510569136",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I think at a high level, the \"package relay\" part looks like:\r\n\r\n - [x] make package mempool acceptance available via rpc in regtest\r\n - [ ] fix up package acceptance/retention/mining policies to be free from DoS vectors and to behave sensibly\r\n - [ ] behave sensibly with arbitrary txs in a package\r\n - [ ] implement bip331 to expose package relay over p2p not just rpc\r\n\r\nAnd relatedly:\r\n\r\n - [ ] version 3 acceptance/rbf policies to limit pinnability\r\n - [ ] ephemeral anchors\r\n\r\nParticularly if #26933 is applied, is there any reason not to make `submitpackage` available on all chains? It should behave no differently to submitting the transactions individually with a non-full mempool, no?",
      "created_at" : "2023-04-17T05:21:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27463#issuecomment-1510719846",
      "id" : 1510719846,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27463",
      "node_id" : "IC_kwDOABII585aC8Fm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1510719846/reactions"
      },
      "updated_at" : "2023-04-17T05:21:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1510719846",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "FWIW, I don't think \"incentive compatibility\" is a good description of our goal here -- I think there's three goals we want:\r\n\r\n - for most normal use cases (including newly invented ones) just submitting your txs over p2p should work fine\r\n   - (otherwise people will tend to use centralised tx submission methods, which creates a chokepoint that will attract censorship)\r\n - running a plain bitcoind should get you block templates within 90%-99% of optimal, depending on the resources you can allocate to your node\r\n   - (otherwise miners will outsource block template construction to proprietary services in order to be competitive, which again creates a censorship chokepoint)\r\n - mempool/relay behaviour should be as simple to understand as possible -- for wallet designers, bitcoin users, node operators and miners\r\n   - (otherwise bitcoin will only be usable in theory, not in practice)\r\n\r\nI think most of the \"incentive compatible\" things above aren't really making anything more incentive compatible (miners can just raise their mempool limits to keep the transactions; non-mining nodes aren't receiving any incentives in the first place) but rather making mempool behaviour easier to understand (eg \"we removed this tx because there was a race condition when loading the mempool\" vs \"we removed this tx because it wouldn't be included in any of the next 100 optimal blocks, even if no new txs are submitted\").",
      "created_at" : "2023-04-17T07:23:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27463#issuecomment-1510836263",
      "id" : 1510836263,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27463",
      "node_id" : "IC_kwDOABII585aDYgn",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1510836263/reactions"
      },
      "updated_at" : "2023-04-17T07:23:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1510836263",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I think at a high level, the \"package relay\" part looks like:\r\n\r\nYes, that is how I think of it.\r\n\r\n> Particularly if https://github.com/bitcoin/bitcoin/pull/26933 is applied, is there any reason not to make submitpackage available on \r\nall chains? It should behave no differently to submitting the transactions individually with a non-full mempool, no?\r\n\r\nSomewhat. It's still a little bit weird when you submit a child-with-parents where a parent relies on the other (grep \"Check that validation isn't quitting *too* early\" in #26711, currently [at this line](https://github.com/bitcoin/bitcoin/pull/26711/files#diff-98ca28aa44cf84d5a29e4ce7eddbabf495a51154b02a6703a78977b80e19b17aR436)). I would say it's safe after the \"submit with subpackages\" changes.\r\n\r\nAlso, mempools *are* full on mainnet (great for testing but means there is a difference), and we'll definitely want to warn them that the transactions are not necessarily relayed etc.",
      "created_at" : "2023-04-17T07:42:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27463#issuecomment-1510857791",
      "id" : 1510857791,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27463",
      "node_id" : "IC_kwDOABII585aDdw_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1510857791/reactions"
      },
      "updated_at" : "2023-04-17T07:42:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1510857791",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   }
]
