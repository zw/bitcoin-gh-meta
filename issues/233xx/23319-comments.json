[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I will add tests after initial review",
      "created_at" : "2021-10-20T05:51:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-947349693",
      "id" : 947349693,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII5844d2i9",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/947349693/reactions"
      },
      "updated_at" : "2021-10-20T05:51:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/947349693",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r732469998"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732469998"
         }
      },
      "author_association" : "MEMBER",
      "body" : "wouldn't it make sense to combine the `!blockindex` check here?",
      "commit_id" : "2730b680d250a5e258c38e9d638baf36e78bc17e",
      "created_at" : "2021-10-20T07:03:19Z",
      "diff_hunk" : "@@ -211,8 +213,28 @@ static RPCHelpMan getrawtransaction()\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    if (!blockindex) {\n+        TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+        return result;\n+    }\n+    result.pushKV(\"in_active_chain\", in_active_chain);\n+\n+    std::optional<size_t>  opt_tx_position{std::nullopt};\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+    if (IsBlockPruned(blockindex) || !(UndoReadFromDisk(blockUndo, blockindex) && ReadBlockFromDisk(block, blockindex, Params().GetConsensus()))) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r732469998",
      "id" : 732469998,
      "line" : 225,
      "node_id" : "PRRC_kwDOABII584rqJru",
      "original_commit_id" : "2730b680d250a5e258c38e9d638baf36e78bc17e",
      "original_line" : 225,
      "original_position" : 48,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 48,
      "pull_request_review_id" : 784071729,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732469998/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-20T07:04:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732469998",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r732470233"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732470233"
         }
      },
      "author_association" : "MEMBER",
      "body" : "it is optional?",
      "commit_id" : "2730b680d250a5e258c38e9d638baf36e78bc17e",
      "created_at" : "2021-10-20T07:03:46Z",
      "diff_hunk" : "@@ -97,6 +98,7 @@ static RPCHelpMan getrawtransaction()\n                          {\n                              {RPCResult::Type::BOOL, \"in_active_chain\", /* optional */ true, \"Whether specified block is in the active chain or not (only present with explicit \\\"blockhash\\\" argument)\"},\n                              {RPCResult::Type::STR_HEX, \"hex\", \"The serialized, hex-encoded data for 'txid'\"},\n+                             {RPCResult::Type::STR_AMOUNT, \"fee\", \"transaction fee in \" + CURRENCY_UNIT},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r732470233",
      "id" : 732470233,
      "line" : 101,
      "node_id" : "PRRC_kwDOABII584rqJvZ",
      "original_commit_id" : "2730b680d250a5e258c38e9d638baf36e78bc17e",
      "original_line" : 101,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 29,
      "pull_request_review_id" : 784071729,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732470233/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-20T07:04:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732470233",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r732734970"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732734970"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "yes, and moved",
      "commit_id" : "d3f084a19bd930a365dcc1f6538d29570241d12c",
      "created_at" : "2021-10-20T12:42:53Z",
      "diff_hunk" : "@@ -211,8 +213,28 @@ static RPCHelpMan getrawtransaction()\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    if (!blockindex) {\n+        TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+        return result;\n+    }\n+    result.pushKV(\"in_active_chain\", in_active_chain);\n+\n+    std::optional<size_t>  opt_tx_position{std::nullopt};\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+    if (IsBlockPruned(blockindex) || !(UndoReadFromDisk(blockUndo, blockindex) && ReadBlockFromDisk(block, blockindex, Params().GetConsensus()))) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r732734970",
      "id" : 732734970,
      "in_reply_to_id" : 732469998,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rrKX6",
      "original_commit_id" : "2730b680d250a5e258c38e9d638baf36e78bc17e",
      "original_line" : 225,
      "original_position" : 48,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : null,
      "pull_request_review_id" : 784429612,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732734970/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-20T12:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732734970",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r732741166"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732741166"
         }
      },
      "author_association" : "MEMBER",
      "body" : "this is an unrelated behavior change",
      "commit_id" : "d3f084a19bd930a365dcc1f6538d29570241d12c",
      "created_at" : "2021-10-20T12:49:52Z",
      "diff_hunk" : "@@ -211,8 +213,24 @@ static RPCHelpMan getrawtransaction()\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    std::optional<size_t>  opt_tx_position{std::nullopt};\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+    if (!blockindex || IsBlockPruned(blockindex) || !(UndoReadFromDisk(blockUndo, blockindex) && ReadBlockFromDisk(block, blockindex, Params().GetConsensus()))) {\n+        TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+        return result;\n+    }\n+    result.pushKV(\"in_active_chain\", in_active_chain);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r732741166",
      "id" : 732741166,
      "line" : 226,
      "node_id" : "PRRC_kwDOABII584rrL4u",
      "original_commit_id" : "25989832aacc77dc362410debf7df718e48b5852",
      "original_line" : 226,
      "original_position" : 46,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 49,
      "pull_request_review_id" : 784437933,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732741166/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-20T12:49:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732741166",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r732779544"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732779544"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "right. good catch. ",
      "commit_id" : "d3f084a19bd930a365dcc1f6538d29570241d12c",
      "created_at" : "2021-10-20T13:30:32Z",
      "diff_hunk" : "@@ -211,8 +213,24 @@ static RPCHelpMan getrawtransaction()\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    std::optional<size_t>  opt_tx_position{std::nullopt};\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+    if (!blockindex || IsBlockPruned(blockindex) || !(UndoReadFromDisk(blockUndo, blockindex) && ReadBlockFromDisk(block, blockindex, Params().GetConsensus()))) {\n+        TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+        return result;\n+    }\n+    result.pushKV(\"in_active_chain\", in_active_chain);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r732779544",
      "id" : 732779544,
      "in_reply_to_id" : 732741166,
      "line" : 226,
      "node_id" : "PRRC_kwDOABII584rrVQY",
      "original_commit_id" : "25989832aacc77dc362410debf7df718e48b5852",
      "original_line" : 226,
      "original_position" : 46,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 49,
      "pull_request_review_id" : 784490365,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732779544/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-20T13:30:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732779544",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r732823420"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732823420"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I mean why are you changing this at all? Seems unrelated and the existing code should work fine.",
      "commit_id" : "d3f084a19bd930a365dcc1f6538d29570241d12c",
      "created_at" : "2021-10-20T14:14:00Z",
      "diff_hunk" : "@@ -211,8 +213,24 @@ static RPCHelpMan getrawtransaction()\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    std::optional<size_t>  opt_tx_position{std::nullopt};\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+    if (!blockindex || IsBlockPruned(blockindex) || !(UndoReadFromDisk(blockUndo, blockindex) && ReadBlockFromDisk(block, blockindex, Params().GetConsensus()))) {\n+        TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+        return result;\n+    }\n+    result.pushKV(\"in_active_chain\", in_active_chain);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r732823420",
      "id" : 732823420,
      "in_reply_to_id" : 732741166,
      "line" : 226,
      "node_id" : "PRRC_kwDOABII584rrf98",
      "original_commit_id" : "25989832aacc77dc362410debf7df718e48b5852",
      "original_line" : 226,
      "original_position" : 46,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 49,
      "pull_request_review_id" : 784552225,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732823420/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-20T14:14:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732823420",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r732827529"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732827529"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "you said \"wouldn't it make sense to combine the !blockindex check here?\"\r\nin your inital review, i thought you meant combine !blockindex with my new if statement ",
      "commit_id" : "d3f084a19bd930a365dcc1f6538d29570241d12c",
      "created_at" : "2021-10-20T14:18:01Z",
      "diff_hunk" : "@@ -211,8 +213,24 @@ static RPCHelpMan getrawtransaction()\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    std::optional<size_t>  opt_tx_position{std::nullopt};\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+    if (!blockindex || IsBlockPruned(blockindex) || !(UndoReadFromDisk(blockUndo, blockindex) && ReadBlockFromDisk(block, blockindex, Params().GetConsensus()))) {\n+        TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+        return result;\n+    }\n+    result.pushKV(\"in_active_chain\", in_active_chain);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r732827529",
      "id" : 732827529,
      "in_reply_to_id" : 732741166,
      "line" : 226,
      "node_id" : "PRRC_kwDOABII584rrg-J",
      "original_commit_id" : "25989832aacc77dc362410debf7df718e48b5852",
      "original_line" : 226,
      "original_position" : 46,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 49,
      "pull_request_review_id" : 784557989,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732827529/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-20T14:18:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732827529",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r732832020"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732832020"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, but the blockindex check can stay as-is. Also, I think it makes more sense to clarify the condition on when the field is existing/missing.\r\n\r\n```\r\nif (a) pushKV();\r\n```\r\n\r\nis clearer than\r\n\r\n```\r\nif (something)\r\n  if (a) pushKV();\r\n  return\r\npushKV();",
      "commit_id" : "d3f084a19bd930a365dcc1f6538d29570241d12c",
      "created_at" : "2021-10-20T14:22:23Z",
      "diff_hunk" : "@@ -211,8 +213,24 @@ static RPCHelpMan getrawtransaction()\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    std::optional<size_t>  opt_tx_position{std::nullopt};\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+    if (!blockindex || IsBlockPruned(blockindex) || !(UndoReadFromDisk(blockUndo, blockindex) && ReadBlockFromDisk(block, blockindex, Params().GetConsensus()))) {\n+        TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+        return result;\n+    }\n+    result.pushKV(\"in_active_chain\", in_active_chain);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r732832020",
      "id" : 732832020,
      "in_reply_to_id" : 732741166,
      "line" : 226,
      "node_id" : "PRRC_kwDOABII584rriEU",
      "original_commit_id" : "25989832aacc77dc362410debf7df718e48b5852",
      "original_line" : 226,
      "original_position" : 46,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 49,
      "pull_request_review_id" : 784564260,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732832020/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-20T14:22:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732832020",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r732846354"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732846354"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I had already worked out a solution to this problem, but with a different approach,\r\nThe difference is in how to get the `CTxUndo* txundo` value.\r\n\r\nNot sure if getting the coins of `txundo` through `CCoinsViewMemPool` is better than through `BlockUndo`.\r\n\r\n```suggestion\r\n        auto mempool = node.mempool.get();\r\n    LOCK2(cs_main, mempool->cs);\r\n    CCoinsViewCache& viewChain = chainman.ActiveChainstate().CoinsTip();\r\n    CCoinsViewMemPool viewMempool(&viewChain, *mempool);\r\n\r\n    std::unique_ptr<CTxUndo> txundo(new CTxUndo());\r\n\r\n    if (!tx->IsCoinBase()) {\r\n        txundo->vprevout.reserve(tx->vin.size());\r\n        for (unsigned int i = 0; i < tx->vin.size(); i++) {\r\n            Coin coin;\r\n            const CTxIn& txin = tx->vin[i];\r\n            if (viewMempool.GetCoin(txin.prevout, coin)) {\r\n                txundo->vprevout.emplace_back(std::move(coin));\r\n            }\r\n        }\r\n    } else {\r\n        txundo = nullptr;\r\n    }\r\n```",
      "commit_id" : "d3f084a19bd930a365dcc1f6538d29570241d12c",
      "created_at" : "2021-10-20T14:35:47Z",
      "diff_hunk" : "@@ -211,8 +213,27 @@ static RPCHelpMan getrawtransaction()\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    std::optional<size_t>  opt_tx_position{std::nullopt};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r732846354",
      "id" : 732846354,
      "line" : 216,
      "node_id" : "PRRC_kwDOABII584rrlkS",
      "original_commit_id" : "d3f084a19bd930a365dcc1f6538d29570241d12c",
      "original_line" : 216,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 39,
      "pull_request_review_id" : 784583808,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732846354/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-20T14:37:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732846354",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/84432093?v=4",
         "events_url" : "https://api.github.com/users/lsilva01/events{/privacy}",
         "followers_url" : "https://api.github.com/users/lsilva01/followers",
         "following_url" : "https://api.github.com/users/lsilva01/following{/other_user}",
         "gists_url" : "https://api.github.com/users/lsilva01/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/lsilva01",
         "id" : 84432093,
         "login" : "lsilva01",
         "node_id" : "MDQ6VXNlcjg0NDMyMDkz",
         "organizations_url" : "https://api.github.com/users/lsilva01/orgs",
         "received_events_url" : "https://api.github.com/users/lsilva01/received_events",
         "repos_url" : "https://api.github.com/users/lsilva01/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/lsilva01/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/lsilva01/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/lsilva01"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r733057279"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/733057279"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Gotcha, Hopefully now it looks better",
      "commit_id" : "2e8ce71097d9e521354217c27c2bc059ae3252d4",
      "created_at" : "2021-10-20T18:50:48Z",
      "diff_hunk" : "@@ -211,8 +213,24 @@ static RPCHelpMan getrawtransaction()\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    std::optional<size_t>  opt_tx_position{std::nullopt};\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+    if (!blockindex || IsBlockPruned(blockindex) || !(UndoReadFromDisk(blockUndo, blockindex) && ReadBlockFromDisk(block, blockindex, Params().GetConsensus()))) {\n+        TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+        return result;\n+    }\n+    result.pushKV(\"in_active_chain\", in_active_chain);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r733057279",
      "id" : 733057279,
      "in_reply_to_id" : 732741166,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rsZD_",
      "original_commit_id" : "25989832aacc77dc362410debf7df718e48b5852",
      "original_line" : 226,
      "original_position" : 46,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : null,
      "pull_request_review_id" : 784876223,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/733057279/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-20T18:50:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/733057279",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think this has been said on IRC already: Shouldn't this be hidden behind a flag like the RPC it is copied from?",
      "created_at" : "2021-10-20T18:52:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-947945962",
      "id" : 947945962,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII5844gIHq",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/947945962/reactions"
      },
      "updated_at" : "2021-10-20T18:52:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/947945962",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Concept ACK.\r\n> \r\n> It would be interesting to add a functional test case.\r\n\r\nAgreed, wanted to discuss the implementation before diving in. \r\nAnything special I should know about testing `./test/functional/rpc_rawtransaction.py` ? This is my 1st time doing functional test.",
      "created_at" : "2021-10-20T18:53:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-947946201",
      "id" : 947946201,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII5844gILZ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/947946201/reactions"
      },
      "updated_at" : "2021-10-20T18:53:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/947946201",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I think this has been said on IRC already: Shouldn't this be hidden behind a flag like the RPC it is copied from?\r\n\r\nTo confirm we want the second (hybrid) parameter to have three verbosity levels:\r\n\r\n* `0`  or `false` - hex encoded\r\n*  `1` or `true`  - returns an Object with information about txid\r\n* `2` -  adds fee field to Object",
      "created_at" : "2021-10-20T19:08:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-947957710",
      "id" : 947957710,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII5844gK_O",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/947957710/reactions"
      },
      "updated_at" : "2021-10-20T19:08:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/947957710",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Yes, if that is the behavior of the other RPC, it makes sense to copy it.",
      "created_at" : "2021-10-20T19:11:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-947959148",
      "id" : 947959148,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII5844gLVs",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/947959148/reactions"
      },
      "updated_at" : "2021-10-20T19:11:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/947959148",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Yes, if that is the behavior of the other RPC, it makes sense to copy it.\r\n\r\nI'm taking this from `getblocks` ",
      "created_at" : "2021-10-20T19:15:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-947962128",
      "id" : 947962128,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII5844gMEQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/947962128/reactions"
      },
      "updated_at" : "2021-10-20T19:15:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/947962128",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "You might want to also add the UTXOs being spent by the transaction. You're looking those up anyway.",
      "created_at" : "2021-10-20T19:17:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-947963375",
      "id" : 947963375,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII5844gMXv",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/947963375/reactions"
      },
      "updated_at" : "2021-10-20T19:17:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/947963375",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The tests can also be taken from the other RPC: https://github.com/bitcoin/bitcoin/pull/22918/files",
      "created_at" : "2021-10-21T11:22:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-948513873",
      "id" : 948513873,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII5844iSxR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 1,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/948513873/reactions"
      },
      "updated_at" : "2021-10-21T11:22:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/948513873",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> The tests can also be taken from the other RPC: https://github.com/bitcoin/bitcoin/pull/22918/files\r\n\r\nAdded tests and verbosity levels",
      "created_at" : "2021-10-21T18:53:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-948909763",
      "id" : 948909763,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII5844jzbD",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/948909763/reactions"
      },
      "updated_at" : "2021-10-21T18:53:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/948909763",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26039](https://github.com/bitcoin/bitcoin/pull/26039) (rpc: Run type check against RPCArgs (1/2) by MarcoFalke)\n* [#25979](https://github.com/bitcoin/bitcoin/pull/25979) ([WIP] wallet: standardize change output detection process by furszy)\n* [#23507](https://github.com/bitcoin/bitcoin/pull/23507) (Refactor: Improve API design of `ScriptToUniv`, `TxToUniv` etc to return the `UniValue` instead of mutating a parameter/reference by mjdietzx)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-10-25T18:59:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-951216484",
      "id" : 951216484,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII5844smlk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/951216484/reactions"
      },
      "updated_at" : "2022-10-06T19:14:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/951216484",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r738608678"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738608678"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Is there a reason you don't add `verbosity == 1` to this conjunction instead of duplicating the same `TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate()); return result;` above?",
      "commit_id" : "83e5f6c5844892da4c4f9290d6c20fbaee2ae295",
      "created_at" : "2021-10-28T17:31:40Z",
      "diff_hunk" : "@@ -206,13 +213,35 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, errmsg + \". Use gettransaction for wallet transactions.\");\n     }\n \n-    if (!fVerbose) {\n+    if (verbosity == 0) {\n         return EncodeHexTx(*tx, RPCSerializationFlags());\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    if (blockindex) {\n+        result.pushKV(\"in_active_chain\", in_active_chain);\n+    }\n+    if (verbosity == 1) {\n+        TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+        return result;\n+    }\n+\n+    std::optional<size_t>  opt_tx_position{std::nullopt};\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+    if (!blockindex || IsBlockPruned(blockindex) || !(UndoReadFromDisk(blockUndo, blockindex) && ReadBlockFromDisk(block, blockindex, Params().GetConsensus()))) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r738608678",
      "id" : 738608678,
      "line" : 232,
      "node_id" : "PRRC_kwDOABII584sBkYm",
      "original_commit_id" : "83e5f6c5844892da4c4f9290d6c20fbaee2ae295",
      "original_line" : 232,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 93,
      "pull_request_review_id" : 792171748,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738608678/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-28T17:32:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738608678",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r738622797"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738622797"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I guess mostly to prevent unneeded allocation of \r\n```\r\n    std::optional<size_t>  opt_tx_position{std::nullopt};\r\n    CBlockUndo blockUndo;\r\n    CBlock block;\r\n```\r\n I can move it to the `if (!blockindex || IsBlockPruned(blockindex)...`  if you like. \r\n",
      "commit_id" : "83e5f6c5844892da4c4f9290d6c20fbaee2ae295",
      "created_at" : "2021-10-28T17:51:28Z",
      "diff_hunk" : "@@ -206,13 +213,35 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, errmsg + \". Use gettransaction for wallet transactions.\");\n     }\n \n-    if (!fVerbose) {\n+    if (verbosity == 0) {\n         return EncodeHexTx(*tx, RPCSerializationFlags());\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    if (blockindex) {\n+        result.pushKV(\"in_active_chain\", in_active_chain);\n+    }\n+    if (verbosity == 1) {\n+        TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+        return result;\n+    }\n+\n+    std::optional<size_t>  opt_tx_position{std::nullopt};\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+    if (!blockindex || IsBlockPruned(blockindex) || !(UndoReadFromDisk(blockUndo, blockindex) && ReadBlockFromDisk(block, blockindex, Params().GetConsensus()))) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r738622797",
      "id" : 738622797,
      "in_reply_to_id" : 738608678,
      "line" : 232,
      "node_id" : "PRRC_kwDOABII584sBn1N",
      "original_commit_id" : "83e5f6c5844892da4c4f9290d6c20fbaee2ae295",
      "original_line" : 232,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 93,
      "pull_request_review_id" : 792191018,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738622797/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-28T17:51:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738622797",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> You might want to also add the UTXOs being spent by the transaction. You're looking those up anyway.\r\n\r\n@sipa Can you clarify a bit more on `add the UTXOs being spent` ? Specifically, what you like to add to the response body?",
      "created_at" : "2021-10-28T18:02:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-954076159",
      "id" : 954076159,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII58443gv_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/954076159/reactions"
      },
      "updated_at" : "2021-10-28T18:02:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/954076159",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@dougEfresh The scriptPubKey and amount being spent for each input (together with information about the scriptPubKey like the output already has).",
      "created_at" : "2021-10-28T18:20:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-954089224",
      "id" : 954089224,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII58443j8I",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/954089224/reactions"
      },
      "updated_at" : "2021-10-28T18:20:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/954089224",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Showing the utxos being spent is also being done by the other RPC. Any questions you might have should be answered by looking at the code changes of https://github.com/bitcoin/bitcoin/pull/22918/files",
      "created_at" : "2021-10-29T09:11:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-954580846",
      "id" : 954580846,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII58445b9u",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/954580846/reactions"
      },
      "updated_at" : "2021-10-29T09:11:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/954580846",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r739162422"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739162422"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "For code clarity, I moved `verbosity == 1`  to the if block. \r\n\r\nThe performance impact is marginal ",
      "commit_id" : "2c56d72acac277babad758dbc6eefb38264cb0ed",
      "created_at" : "2021-10-29T11:43:32Z",
      "diff_hunk" : "@@ -206,13 +213,35 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, errmsg + \". Use gettransaction for wallet transactions.\");\n     }\n \n-    if (!fVerbose) {\n+    if (verbosity == 0) {\n         return EncodeHexTx(*tx, RPCSerializationFlags());\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    if (blockindex) {\n+        result.pushKV(\"in_active_chain\", in_active_chain);\n+    }\n+    if (verbosity == 1) {\n+        TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+        return result;\n+    }\n+\n+    std::optional<size_t>  opt_tx_position{std::nullopt};\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+    if (!blockindex || IsBlockPruned(blockindex) || !(UndoReadFromDisk(blockUndo, blockindex) && ReadBlockFromDisk(block, blockindex, Params().GetConsensus()))) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r739162422",
      "id" : 739162422,
      "in_reply_to_id" : 738608678,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584sDrk2",
      "original_commit_id" : "83e5f6c5844892da4c4f9290d6c20fbaee2ae295",
      "original_line" : 232,
      "original_position" : 93,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : null,
      "pull_request_review_id" : 792936962,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739162422/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-29T11:43:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739162422",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Showing the utxos being spent is also being done by the other RPC. Any questions you might have should be answered by looking at the code changes of https://github.com/bitcoin/bitcoin/pull/22918/files\r\n\r\nthanks, added utxos with  `TxVerbosity::SHOW_DETAILS_AND_PREVOUT`\r\n\r\nMy latest change includes \r\n\r\n* test for prevout (utxo)\r\n* release documentation\r\n* consolidate if statement in ./src/rpc/rawtransaction.cpp  getrawtransaction\r\n  ```\r\n  if (verbosity == 1 || !blockindex || IsBlockPruned(blockindex) ....\r\n  ```",
      "created_at" : "2021-10-29T11:48:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-954678983",
      "id" : 954678983,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII58445z7H",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/954678983/reactions"
      },
      "updated_at" : "2021-10-29T11:48:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/954678983",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r739167913"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739167913"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I will add a space between ` inputs(only` after review by others.",
      "commit_id" : "2c56d72acac277babad758dbc6eefb38264cb0ed",
      "created_at" : "2021-10-29T11:52:34Z",
      "diff_hunk" : "@@ -79,13 +80,14 @@ static RPCHelpMan getrawtransaction()\n                 \"and no blockhash argument is passed, it will return the transaction if it is in the mempool or any block.\\n\"\n                 \"If a blockhash argument is passed, it will return the transaction if\\n\"\n                 \"the specified block is available and the transaction is in that block.\\n\"\n-                \"\\nHint: Use gettransaction for wallet transactions.\\n\"\n+                \"\\nHint: Use gettransaction for wallet transactions.\\n\\n\"\n \n-                \"\\nIf verbose is 'true', returns an Object with information about 'txid'.\\n\"\n-                \"If verbose is 'false' or omitted, returns a string that is serialized, hex-encoded data for 'txid'.\\n\",\n+                \"If verbose is 0, 'false' or omitted, returns a string that is serialized, hex-encoded data for 'txid'.\\n\"\n+                \"If verbose is 1 or 'true', returns an Object with information about 'txid'.\\n\"\n+                \"If verbose is 2, returns an Object with information about 'txid', including fees and prevout information for inputs(only for unpruned blocks in the current best chain).\\n\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r739167913",
      "id" : 739167913,
      "line" : 87,
      "node_id" : "PRRC_kwDOABII584sDs6p",
      "original_commit_id" : "2c56d72acac277babad758dbc6eefb38264cb0ed",
      "original_line" : 87,
      "original_position" : 36,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 36,
      "pull_request_review_id" : 792944260,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739167913/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-29T11:54:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739167913",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r739381944"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739381944"
         }
      },
      "author_association" : "MEMBER",
      "body" : "verbos*ity*",
      "commit_id" : "2c56d72acac277babad758dbc6eefb38264cb0ed",
      "created_at" : "2021-10-29T16:29:57Z",
      "diff_hunk" : "@@ -79,13 +80,14 @@ static RPCHelpMan getrawtransaction()\n                 \"and no blockhash argument is passed, it will return the transaction if it is in the mempool or any block.\\n\"\n                 \"If a blockhash argument is passed, it will return the transaction if\\n\"\n                 \"the specified block is available and the transaction is in that block.\\n\"\n-                \"\\nHint: Use gettransaction for wallet transactions.\\n\"\n+                \"\\nHint: Use gettransaction for wallet transactions.\\n\\n\"\n \n-                \"\\nIf verbose is 'true', returns an Object with information about 'txid'.\\n\"\n-                \"If verbose is 'false' or omitted, returns a string that is serialized, hex-encoded data for 'txid'.\\n\",\n+                \"If verbose is 0, 'false' or omitted, returns a string that is serialized, hex-encoded data for 'txid'.\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r739381944",
      "id" : 739381944,
      "line" : 85,
      "node_id" : "PRRC_kwDOABII584sEhK4",
      "original_commit_id" : "2c56d72acac277babad758dbc6eefb38264cb0ed",
      "original_line" : 85,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 34,
      "pull_request_review_id" : 793244895,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739381944/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-29T16:29:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739381944",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r739382479"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739382479"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Stick to just the numbers in docs. (bool is essentially just backwards compat)",
      "commit_id" : "2c56d72acac277babad758dbc6eefb38264cb0ed",
      "created_at" : "2021-10-29T16:30:52Z",
      "diff_hunk" : "@@ -79,13 +80,14 @@ static RPCHelpMan getrawtransaction()\n                 \"and no blockhash argument is passed, it will return the transaction if it is in the mempool or any block.\\n\"\n                 \"If a blockhash argument is passed, it will return the transaction if\\n\"\n                 \"the specified block is available and the transaction is in that block.\\n\"\n-                \"\\nHint: Use gettransaction for wallet transactions.\\n\"\n+                \"\\nHint: Use gettransaction for wallet transactions.\\n\\n\"\n \n-                \"\\nIf verbose is 'true', returns an Object with information about 'txid'.\\n\"\n-                \"If verbose is 'false' or omitted, returns a string that is serialized, hex-encoded data for 'txid'.\\n\",\n+                \"If verbose is 0, 'false' or omitted, returns a string that is serialized, hex-encoded data for 'txid'.\\n\"\n+                \"If verbose is 1 or 'true', returns an Object with information about 'txid'.\\n\"\n+                \"If verbose is 2, returns an Object with information about 'txid', including fees and prevout information for inputs(only for unpruned blocks in the current best chain).\\n\",\n                 {\n                     {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n-                    {\"verbose\", RPCArg::Type::BOOL, RPCArg::Default{false}, \"If false, return a string, otherwise return a json object\"},\n+                    {\"verbosity|verbose\", RPCArg::Type::NUM, RPCArg::Default{0}, \"0|false for hex-encoded data, 1|true for a json object, and 2 for json object with fee\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r739382479",
      "id" : 739382479,
      "line" : 90,
      "node_id" : "PRRC_kwDOABII584sEhTP",
      "original_commit_id" : "2c56d72acac277babad758dbc6eefb38264cb0ed",
      "original_line" : 90,
      "original_position" : 40,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 40,
      "pull_request_review_id" : 793245669,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739382479/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-29T16:30:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739382479",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r739601931"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739601931"
         }
      },
      "author_association" : "MEMBER",
      "body" : "What is supposed to guarantee this is correct?",
      "commit_id" : "2c56d72acac277babad758dbc6eefb38264cb0ed",
      "created_at" : "2021-10-30T03:22:40Z",
      "diff_hunk" : "@@ -141,21 +143,35 @@ def getrawtransaction_tests(self):\n         for n in [0, 3]:\n             self.log.info(f\"Test getrawtransaction {'with' if n == 0 else 'without'} -txindex, with blockhash\")\n             # We should be able to get the raw transaction by providing the correct block\n-            gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=True, blockhash=block1)\n-            assert_equal(gottx['txid'], tx)\n-            assert_equal(gottx['in_active_chain'], True)\n-            if n == 0:\n-                self.log.info(\"Test getrawtransaction with -txindex, without blockhash: 'in_active_chain' should be absent\")\n-                gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=True)\n+            for v in [1, 2]: # verbosity level\n+                gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=v, blockhash=block1)\n                 assert_equal(gottx['txid'], tx)\n-                assert 'in_active_chain' not in gottx\n-            else:\n-                self.log.info(\"Test getrawtransaction without -txindex, without blockhash: expect the call to raise\")\n-                err_msg = (\n-                    \"No such mempool transaction. Use -txindex or provide a block hash to enable\"\n-                    \" blockchain transaction queries. Use gettransaction for wallet transactions.\"\n-                )\n-                assert_raises_rpc_error(-5, err_msg, self.nodes[n].getrawtransaction, txid=tx, verbose=True)\n+                assert_equal(gottx['in_active_chain'], True)\n+                if v == 2:\n+                    # fee is in verbosity 2 only\n+                    assert_equal(gottx['fee'], Decimal('0.00002820'))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r739601931",
      "id" : 739601931,
      "line" : 152,
      "node_id" : "PRRC_kwDOABII584sFW4L",
      "original_commit_id" : "2c56d72acac277babad758dbc6eefb38264cb0ed",
      "original_line" : 152,
      "original_position" : 55,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 55,
      "pull_request_review_id" : 793532825,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739601931/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-30T03:22:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739601931",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r739621037"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739621037"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The value of fee is not important. I want to see that the field fee exists. Change it to `assert('fee' in gottxt)` ?\r\n\r\nThere are another tests (outside the scope of this PR) which validate the fee amount. ",
      "commit_id" : "2c56d72acac277babad758dbc6eefb38264cb0ed",
      "created_at" : "2021-10-30T07:28:40Z",
      "diff_hunk" : "@@ -141,21 +143,35 @@ def getrawtransaction_tests(self):\n         for n in [0, 3]:\n             self.log.info(f\"Test getrawtransaction {'with' if n == 0 else 'without'} -txindex, with blockhash\")\n             # We should be able to get the raw transaction by providing the correct block\n-            gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=True, blockhash=block1)\n-            assert_equal(gottx['txid'], tx)\n-            assert_equal(gottx['in_active_chain'], True)\n-            if n == 0:\n-                self.log.info(\"Test getrawtransaction with -txindex, without blockhash: 'in_active_chain' should be absent\")\n-                gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=True)\n+            for v in [1, 2]: # verbosity level\n+                gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=v, blockhash=block1)\n                 assert_equal(gottx['txid'], tx)\n-                assert 'in_active_chain' not in gottx\n-            else:\n-                self.log.info(\"Test getrawtransaction without -txindex, without blockhash: expect the call to raise\")\n-                err_msg = (\n-                    \"No such mempool transaction. Use -txindex or provide a block hash to enable\"\n-                    \" blockchain transaction queries. Use gettransaction for wallet transactions.\"\n-                )\n-                assert_raises_rpc_error(-5, err_msg, self.nodes[n].getrawtransaction, txid=tx, verbose=True)\n+                assert_equal(gottx['in_active_chain'], True)\n+                if v == 2:\n+                    # fee is in verbosity 2 only\n+                    assert_equal(gottx['fee'], Decimal('0.00002820'))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r739621037",
      "id" : 739621037,
      "in_reply_to_id" : 739601931,
      "line" : 152,
      "node_id" : "PRRC_kwDOABII584sFbit",
      "original_commit_id" : "2c56d72acac277babad758dbc6eefb38264cb0ed",
      "original_line" : 152,
      "original_position" : 55,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 55,
      "pull_request_review_id" : 793546313,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739621037/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-30T07:29:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739621037",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r739668657"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739668657"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe do `tx_fee = -self.nodes[2].gettransaction(tx)['fee']` immediately after sending and compare to that?",
      "commit_id" : "2c56d72acac277babad758dbc6eefb38264cb0ed",
      "created_at" : "2021-10-30T15:59:47Z",
      "diff_hunk" : "@@ -141,21 +143,35 @@ def getrawtransaction_tests(self):\n         for n in [0, 3]:\n             self.log.info(f\"Test getrawtransaction {'with' if n == 0 else 'without'} -txindex, with blockhash\")\n             # We should be able to get the raw transaction by providing the correct block\n-            gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=True, blockhash=block1)\n-            assert_equal(gottx['txid'], tx)\n-            assert_equal(gottx['in_active_chain'], True)\n-            if n == 0:\n-                self.log.info(\"Test getrawtransaction with -txindex, without blockhash: 'in_active_chain' should be absent\")\n-                gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=True)\n+            for v in [1, 2]: # verbosity level\n+                gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=v, blockhash=block1)\n                 assert_equal(gottx['txid'], tx)\n-                assert 'in_active_chain' not in gottx\n-            else:\n-                self.log.info(\"Test getrawtransaction without -txindex, without blockhash: expect the call to raise\")\n-                err_msg = (\n-                    \"No such mempool transaction. Use -txindex or provide a block hash to enable\"\n-                    \" blockchain transaction queries. Use gettransaction for wallet transactions.\"\n-                )\n-                assert_raises_rpc_error(-5, err_msg, self.nodes[n].getrawtransaction, txid=tx, verbose=True)\n+                assert_equal(gottx['in_active_chain'], True)\n+                if v == 2:\n+                    # fee is in verbosity 2 only\n+                    assert_equal(gottx['fee'], Decimal('0.00002820'))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r739668657",
      "id" : 739668657,
      "in_reply_to_id" : 739601931,
      "line" : 152,
      "node_id" : "PRRC_kwDOABII584sFnKx",
      "original_commit_id" : "2c56d72acac277babad758dbc6eefb38264cb0ed",
      "original_line" : 152,
      "original_position" : 55,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 55,
      "pull_request_review_id" : 793581717,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739668657/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-30T15:59:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739668657",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r740920756"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740920756"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "No fee field in `gettransaction` . \r\nI added `assert('fee' in gottxt)`  but kept `assert_equal(gottx['fee'], Decimal('0.00002820'))` \r\n",
      "commit_id" : "f30f007c829547e44cac4214c04a0fa7d0ddc3c2",
      "created_at" : "2021-11-02T10:26:54Z",
      "diff_hunk" : "@@ -141,21 +143,35 @@ def getrawtransaction_tests(self):\n         for n in [0, 3]:\n             self.log.info(f\"Test getrawtransaction {'with' if n == 0 else 'without'} -txindex, with blockhash\")\n             # We should be able to get the raw transaction by providing the correct block\n-            gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=True, blockhash=block1)\n-            assert_equal(gottx['txid'], tx)\n-            assert_equal(gottx['in_active_chain'], True)\n-            if n == 0:\n-                self.log.info(\"Test getrawtransaction with -txindex, without blockhash: 'in_active_chain' should be absent\")\n-                gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=True)\n+            for v in [1, 2]: # verbosity level\n+                gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=v, blockhash=block1)\n                 assert_equal(gottx['txid'], tx)\n-                assert 'in_active_chain' not in gottx\n-            else:\n-                self.log.info(\"Test getrawtransaction without -txindex, without blockhash: expect the call to raise\")\n-                err_msg = (\n-                    \"No such mempool transaction. Use -txindex or provide a block hash to enable\"\n-                    \" blockchain transaction queries. Use gettransaction for wallet transactions.\"\n-                )\n-                assert_raises_rpc_error(-5, err_msg, self.nodes[n].getrawtransaction, txid=tx, verbose=True)\n+                assert_equal(gottx['in_active_chain'], True)\n+                if v == 2:\n+                    # fee is in verbosity 2 only\n+                    assert_equal(gottx['fee'], Decimal('0.00002820'))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r740920756",
      "id" : 740920756,
      "in_reply_to_id" : 739601931,
      "line" : 152,
      "node_id" : "PRRC_kwDOABII584sKY20",
      "original_commit_id" : "2c56d72acac277babad758dbc6eefb38264cb0ed",
      "original_line" : 152,
      "original_position" : 55,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 54,
      "pull_request_review_id" : 795143842,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740920756/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-02T10:26:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740920756",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r748786334"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748786334"
         }
      },
      "author_association" : "NONE",
      "body" : "I'm just studying for the pr review club. \r\n\r\n There was a question about the performance implications of this loop. I was digging through the code and I was perhaps thinking that CBlockUndo could maybe benefit from a faster data structure to find a transaction? Maybe a method that returns the data faster.\r\n\r\nPerhaps that is a later improvement and off topic?",
      "commit_id" : "f30f007c829547e44cac4214c04a0fa7d0ddc3c2",
      "created_at" : "2021-11-14T01:52:37Z",
      "diff_hunk" : "@@ -206,13 +214,31 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, errmsg + \". Use gettransaction for wallet transactions.\");\n     }\n \n-    if (!fVerbose) {\n+    if (verbosity == 0) {\n         return EncodeHexTx(*tx, RPCSerializationFlags());\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    if (blockindex) {\n+        result.pushKV(\"in_active_chain\", in_active_chain);\n+    }\n+\n+    std::optional<size_t> opt_tx_position{std::nullopt};\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+    if (verbosity == 1 || !blockindex || IsBlockPruned(blockindex) || !(UndoReadFromDisk(blockUndo, blockindex) && ReadBlockFromDisk(block, blockindex, Params().GetConsensus()))) {\n+        TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+        return result;\n+    }\n+    for (size_t i = 0; i < block.vtx.size(); ++i) {\n+        const CTransactionRef t = block.vtx.at(i);\n+        if (*t == *tx) {\n+            // blockundo does not have coinbase tx\n+            opt_tx_position = std::optional<size_t>{i-1};\n+            break;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r748786334",
      "id" : 748786334,
      "line" : 238,
      "node_id" : "PRRC_kwDOABII584soZKe",
      "original_commit_id" : "f30f007c829547e44cac4214c04a0fa7d0ddc3c2",
      "original_line" : 238,
      "original_position" : 106,
      "original_start_line" : 233,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 106,
      "pull_request_review_id" : 805417766,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748786334/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 233,
      "start_side" : "RIGHT",
      "updated_at" : "2021-11-14T01:52:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748786334",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/45839100?v=4",
         "events_url" : "https://api.github.com/users/amovfx/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amovfx/followers",
         "following_url" : "https://api.github.com/users/amovfx/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amovfx/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amovfx",
         "id" : 45839100,
         "login" : "amovfx",
         "node_id" : "MDQ6VXNlcjQ1ODM5MTAw",
         "organizations_url" : "https://api.github.com/users/amovfx/orgs",
         "received_events_url" : "https://api.github.com/users/amovfx/received_events",
         "repos_url" : "https://api.github.com/users/amovfx/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amovfx/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amovfx/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amovfx"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r748868321"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748868321"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Probably I am missing something, but I am not finding any `prevout` reference in the `getblock` help doc. Is it referring to it's internal implementation? Maybe this line could be made a little more clear? ",
      "commit_id" : "fb2f153136dc14921cb7f249fe224919cb7094bb",
      "created_at" : "2021-11-14T15:13:55Z",
      "diff_hunk" : "@@ -99,6 +99,11 @@ Updated RPCs\n   causes the lock to be written persistently to the wallet database. This\n   allows UTXOs to remain locked even after node restarts or crashes. (#23065)\n \n+- `getrawtransaction` RPC verbose argument changed to verbosity levels: 0, 1 and 2 (backwards compatible).\n+  Verbosity 0 and 1 correspond to previous (verbose) argument's values `false` and `true`.\n+  Verbosity `3` contains an optional `fee` field and optional `prevout` subfield\n+  describing the spent output. See `getblock` RPC for `prevout` details.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r748868321",
      "id" : 748868321,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584sotLh",
      "original_commit_id" : "f30f007c829547e44cac4214c04a0fa7d0ddc3c2",
      "original_line" : 105,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "doc/release-notes.md",
      "position" : null,
      "pull_request_review_id" : 805483976,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748868321/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-14T18:06:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748868321",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r748871612"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748871612"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "To keep parity with lines below, maybe also remove leading `\\n` from here? ",
      "commit_id" : "fb2f153136dc14921cb7f249fe224919cb7094bb",
      "created_at" : "2021-11-14T15:40:45Z",
      "diff_hunk" : "@@ -79,13 +80,14 @@ static RPCHelpMan getrawtransaction()\n                 \"and no blockhash argument is passed, it will return the transaction if it is in the mempool or any block.\\n\"\n                 \"If a blockhash argument is passed, it will return the transaction if\\n\"\n                 \"the specified block is available and the transaction is in that block.\\n\"\n-                \"\\nHint: Use gettransaction for wallet transactions.\\n\"\n+                \"\\nHint: Use gettransaction for wallet transactions.\\n\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r748871612",
      "id" : 748871612,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584sot-8",
      "original_commit_id" : "f30f007c829547e44cac4214c04a0fa7d0ddc3c2",
      "original_line" : 83,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : null,
      "pull_request_review_id" : 805483976,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748871612/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-14T18:06:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748871612",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r748873364"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748873364"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think the framing can be improved a bit.\r\n1. Using \"transaction\" instead of \"txid\". They are not in general replaceable with each other for all contexts. It's clearer to say \"details of transaction\" than \"details of txid\".\r\n2. The verbosity 2 comment can feel a little confusing for users on the \"prevout for inputs\" part. It might sound at first glance as the prevout for the tx containing inputs of the given tx. I think keeping it simple like \" ... , including fee and prevout information ... \" only is clear enough. The only structure related to prevout in a transaction is inputs, so its redundant to explicitly specify.    ",
      "commit_id" : "fb2f153136dc14921cb7f249fe224919cb7094bb",
      "created_at" : "2021-11-14T15:55:36Z",
      "diff_hunk" : "@@ -79,13 +80,14 @@ static RPCHelpMan getrawtransaction()\n                 \"and no blockhash argument is passed, it will return the transaction if it is in the mempool or any block.\\n\"\n                 \"If a blockhash argument is passed, it will return the transaction if\\n\"\n                 \"the specified block is available and the transaction is in that block.\\n\"\n-                \"\\nHint: Use gettransaction for wallet transactions.\\n\"\n+                \"\\nHint: Use gettransaction for wallet transactions.\\n\\n\"\n \n-                \"\\nIf verbose is 'true', returns an Object with information about 'txid'.\\n\"\n-                \"If verbose is 'false' or omitted, returns a string that is serialized, hex-encoded data for 'txid'.\\n\",\n+                \"If verbosity is 0 or omitted, returns a string that is serialized, hex-encoded data for 'txid'.\\n\"\n+                \"If verbosity is 1, returns an Object with information about 'txid'.\\n\"\n+                \"If verbosity is 2, returns an Object with information about 'txid', including fees and prevout information for inputs (only for unpruned blocks in the current best chain).\\n\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r748873364",
      "id" : 748873364,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584souaU",
      "original_commit_id" : "f30f007c829547e44cac4214c04a0fa7d0ddc3c2",
      "original_line" : 87,
      "original_position" : 36,
      "original_start_line" : 85,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : null,
      "pull_request_review_id" : 805483976,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748873364/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-11-14T18:06:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748873364",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r748884982"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748884982"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I am not entirely sure, should we still keep the previous usage in the examples above this line?\r\n\r\nEven though the `bool` values are still accepted, the help doc doesn't include it anymore, so it might be confusing to users.  ",
      "commit_id" : "fb2f153136dc14921cb7f249fe224919cb7094bb",
      "created_at" : "2021-11-14T17:31:17Z",
      "diff_hunk" : "@@ -150,6 +153,7 @@ static RPCHelpMan getrawtransaction()\n             + HelpExampleRpc(\"getrawtransaction\", \"\\\"mytxid\\\", true\")\n             + HelpExampleCli(\"getrawtransaction\", \"\\\"mytxid\\\" false \\\"myblockhash\\\"\")\n             + HelpExampleCli(\"getrawtransaction\", \"\\\"mytxid\\\" true \\\"myblockhash\\\"\")\n+            + HelpExampleCli(\"getrawtransaction\", \"\\\"mytxid\\\" 2 \\\"myblockhash\\\"\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r748884982",
      "id" : 748884982,
      "line" : 182,
      "node_id" : "PRRC_kwDOABII584soxP2",
      "original_commit_id" : "f30f007c829547e44cac4214c04a0fa7d0ddc3c2",
      "original_line" : 182,
      "original_position" : 56,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 105,
      "pull_request_review_id" : 805483976,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748884982/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-14T18:06:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748884982",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r748914552"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748914552"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I moved the \\n(s)",
      "commit_id" : "fb2f153136dc14921cb7f249fe224919cb7094bb",
      "created_at" : "2021-11-14T21:47:42Z",
      "diff_hunk" : "@@ -79,13 +80,14 @@ static RPCHelpMan getrawtransaction()\n                 \"and no blockhash argument is passed, it will return the transaction if it is in the mempool or any block.\\n\"\n                 \"If a blockhash argument is passed, it will return the transaction if\\n\"\n                 \"the specified block is available and the transaction is in that block.\\n\"\n-                \"\\nHint: Use gettransaction for wallet transactions.\\n\"\n+                \"\\nHint: Use gettransaction for wallet transactions.\\n\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r748914552",
      "id" : 748914552,
      "in_reply_to_id" : 748871612,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584so4d4",
      "original_commit_id" : "f30f007c829547e44cac4214c04a0fa7d0ddc3c2",
      "original_line" : 83,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : null,
      "pull_request_review_id" : 805521248,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748914552/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-14T21:54:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748914552",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r748914657"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748914657"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Agreed and changed",
      "commit_id" : "fb2f153136dc14921cb7f249fe224919cb7094bb",
      "created_at" : "2021-11-14T21:48:36Z",
      "diff_hunk" : "@@ -150,6 +153,7 @@ static RPCHelpMan getrawtransaction()\n             + HelpExampleRpc(\"getrawtransaction\", \"\\\"mytxid\\\", true\")\n             + HelpExampleCli(\"getrawtransaction\", \"\\\"mytxid\\\" false \\\"myblockhash\\\"\")\n             + HelpExampleCli(\"getrawtransaction\", \"\\\"mytxid\\\" true \\\"myblockhash\\\"\")\n+            + HelpExampleCli(\"getrawtransaction\", \"\\\"mytxid\\\" 2 \\\"myblockhash\\\"\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r748914657",
      "id" : 748914657,
      "in_reply_to_id" : 748884982,
      "line" : 182,
      "node_id" : "PRRC_kwDOABII584so4fh",
      "original_commit_id" : "f30f007c829547e44cac4214c04a0fa7d0ddc3c2",
      "original_line" : 182,
      "original_position" : 56,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 105,
      "pull_request_review_id" : 805521248,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748914657/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-14T21:54:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748914657",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r748914824"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748914824"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "See latest latest changes\r\nI added  separate RPC  documentation for `verbosity=2` \r\n```\r\nResult (for verbosity = 2):\r\n{                               (json object)\r\n  ...,                          Same output as verbosity = 1\r\n  \"fee\" : n,                    (numeric, optional) transaction fee in BTC, omitted if block undo data is not available\r\n  \"vin\" : [                     (json array)\r\n    {                           (json object, optional) utxo being spent, omitted if block undo data is not available\r\n      ...,                      Same output as verbosity = 1\r\n      \"prevout\" : {             (json object)\r\n        \"value\" : n,            (numeric) The value in BTC\r\n        \"height\" : n,           (numeric) previous block height\r\n        \"scriptPubKey\" : {      (json object)\r\n          \"asm\" : \"str\",        (string) the asm\r\n          \"hex\" : \"str\",        (string) the hex\r\n          \"type\" : \"str\",       (string) The type, eg 'pubkeyhash'\r\n          \"address\" : \"str\"     (string, optional) The Bitcoin address (only if a well-defined address exists)\r\n        }\r\n      }\r\n    },\r\n    ...\r\n  ]\r\n}\r\n```",
      "commit_id" : "fb2f153136dc14921cb7f249fe224919cb7094bb",
      "created_at" : "2021-11-14T21:50:02Z",
      "diff_hunk" : "@@ -79,13 +80,14 @@ static RPCHelpMan getrawtransaction()\n                 \"and no blockhash argument is passed, it will return the transaction if it is in the mempool or any block.\\n\"\n                 \"If a blockhash argument is passed, it will return the transaction if\\n\"\n                 \"the specified block is available and the transaction is in that block.\\n\"\n-                \"\\nHint: Use gettransaction for wallet transactions.\\n\"\n+                \"\\nHint: Use gettransaction for wallet transactions.\\n\\n\"\n \n-                \"\\nIf verbose is 'true', returns an Object with information about 'txid'.\\n\"\n-                \"If verbose is 'false' or omitted, returns a string that is serialized, hex-encoded data for 'txid'.\\n\",\n+                \"If verbosity is 0 or omitted, returns a string that is serialized, hex-encoded data for 'txid'.\\n\"\n+                \"If verbosity is 1, returns an Object with information about 'txid'.\\n\"\n+                \"If verbosity is 2, returns an Object with information about 'txid', including fees and prevout information for inputs (only for unpruned blocks in the current best chain).\\n\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r748914824",
      "id" : 748914824,
      "in_reply_to_id" : 748873364,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584so4iI",
      "original_commit_id" : "f30f007c829547e44cac4214c04a0fa7d0ddc3c2",
      "original_line" : 87,
      "original_position" : 36,
      "original_start_line" : 85,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : null,
      "pull_request_review_id" : 805521248,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748914824/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-11-14T21:54:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748914824",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r748914964"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748914964"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I was referring to the `getblock` in the above paragraph of the release notes. \r\nI updated to explicitly reference the above paragraph. ",
      "commit_id" : "fb2f153136dc14921cb7f249fe224919cb7094bb",
      "created_at" : "2021-11-14T21:51:26Z",
      "diff_hunk" : "@@ -99,6 +99,11 @@ Updated RPCs\n   causes the lock to be written persistently to the wallet database. This\n   allows UTXOs to remain locked even after node restarts or crashes. (#23065)\n \n+- `getrawtransaction` RPC verbose argument changed to verbosity levels: 0, 1 and 2 (backwards compatible).\n+  Verbosity 0 and 1 correspond to previous (verbose) argument's values `false` and `true`.\n+  Verbosity `3` contains an optional `fee` field and optional `prevout` subfield\n+  describing the spent output. See `getblock` RPC for `prevout` details.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r748914964",
      "id" : 748914964,
      "in_reply_to_id" : 748868321,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584so4kU",
      "original_commit_id" : "f30f007c829547e44cac4214c04a0fa7d0ddc3c2",
      "original_line" : 105,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "doc/release-notes.md",
      "position" : null,
      "pull_request_review_id" : 805521248,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748914964/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-14T21:54:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748914964",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r748915529"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748915529"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Someone did suggest a more performant  solution, I can't find it at the moment though. ",
      "commit_id" : "fb2f153136dc14921cb7f249fe224919cb7094bb",
      "created_at" : "2021-11-14T21:56:02Z",
      "diff_hunk" : "@@ -206,13 +214,31 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, errmsg + \". Use gettransaction for wallet transactions.\");\n     }\n \n-    if (!fVerbose) {\n+    if (verbosity == 0) {\n         return EncodeHexTx(*tx, RPCSerializationFlags());\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    if (blockindex) {\n+        result.pushKV(\"in_active_chain\", in_active_chain);\n+    }\n+\n+    std::optional<size_t> opt_tx_position{std::nullopt};\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+    if (verbosity == 1 || !blockindex || IsBlockPruned(blockindex) || !(UndoReadFromDisk(blockUndo, blockindex) && ReadBlockFromDisk(block, blockindex, Params().GetConsensus()))) {\n+        TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+        return result;\n+    }\n+    for (size_t i = 0; i < block.vtx.size(); ++i) {\n+        const CTransactionRef t = block.vtx.at(i);\n+        if (*t == *tx) {\n+            // blockundo does not have coinbase tx\n+            opt_tx_position = std::optional<size_t>{i-1};\n+            break;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r748915529",
      "id" : 748915529,
      "in_reply_to_id" : 748786334,
      "line" : 264,
      "node_id" : "PRRC_kwDOABII584so4tJ",
      "original_commit_id" : "f30f007c829547e44cac4214c04a0fa7d0ddc3c2",
      "original_line" : 264,
      "original_position" : 106,
      "original_start_line" : 233,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 155,
      "pull_request_review_id" : 805522072,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748915529/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 259,
      "start_side" : "RIGHT",
      "updated_at" : "2021-11-14T21:56:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748915529",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Initial concept ACK. This is really helpful for wallets trying to sync with core rpc out there, and it will reduce get calls by half for input fetching. Thanks for working on this.\r\n> \r\n> Below are few minor nits.\r\n> \r\n> Will review in more detail later.\r\n\r\n@rajarshimaitra thanks for feedback. The test I  added  could use a good review. \r\n",
      "created_at" : "2021-11-14T22:04:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-968372084",
      "id" : 968372084,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII5845uC90",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/968372084/reactions"
      },
      "updated_at" : "2021-11-14T22:04:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/968372084",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r749529909"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/749529909"
         }
      },
      "author_association" : "NONE",
      "body" : "This overflows in the case of coinbase transaction (i==0). To bring it in line with `getblock` (where the coinbase transaction is serialized without fees/prevouts when `verbosity` is set to `3`), you could add another OR clause on [#255](https://github.com/bitcoin/bitcoin/pull/23319/files#diff-a58e7bb9d9a8a0287c0b7281d99da4e79b6f8c2a5780c24c6d76c14212c48640R255) to also check for `tx->IsCoinBase()`, for example?",
      "commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "created_at" : "2021-11-15T17:16:22Z",
      "diff_hunk" : "@@ -206,13 +240,31 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, errmsg + \". Use gettransaction for wallet transactions.\");\n     }\n \n-    if (!fVerbose) {\n+    if (verbosity == 0) {\n         return EncodeHexTx(*tx, RPCSerializationFlags());\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    if (blockindex) {\n+        result.pushKV(\"in_active_chain\", in_active_chain);\n+    }\n+\n+    std::optional<size_t> opt_tx_position{std::nullopt};\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+    if (verbosity == 1 || !blockindex || IsBlockPruned(blockindex) || !(UndoReadFromDisk(blockUndo, blockindex) && ReadBlockFromDisk(block, blockindex, Params().GetConsensus()))) {\n+        TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+        return result;\n+    }\n+    for (size_t i = 0; i < block.vtx.size(); ++i) {\n+        const CTransactionRef t = block.vtx.at(i);\n+        if (*t == *tx) {\n+            // blockundo does not have coinbase tx\n+            opt_tx_position = std::optional<size_t>{i-1};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r749529909",
      "id" : 749529909,
      "line" : 265,
      "node_id" : "PRRC_kwDOABII584srOs1",
      "original_commit_id" : "fb2f153136dc14921cb7f249fe224919cb7094bb",
      "original_line" : 263,
      "original_position" : 154,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 156,
      "pull_request_review_id" : 806345918,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/749529909/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-17T23:14:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/749529909",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r749620834"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/749620834"
         }
      },
      "author_association" : "NONE",
      "body" : "I understand that functionally this works fine, but it feels unnecessarily confusing to always pass `TxVerbosity::SHOW_DETAILS_AND_PREVOUT` even in the case when in actuality we're trying to get `TxVerbosity::SHOW_DETAILS` but relying on `txundo` being null to achieve that. Would it not be more prudent to instead add `verbosity` as an optional argument to `TxToJSON` and simply pass that along?",
      "commit_id" : "fb2f153136dc14921cb7f249fe224919cb7094bb",
      "created_at" : "2021-11-15T19:29:44Z",
      "diff_hunk" : "@@ -43,14 +44,14 @@\n \n #include <univalue.h>\n \n-static void TxToJSON(const CTransaction& tx, const uint256 hashBlock, UniValue& entry, CChainState& active_chainstate)\n+static void TxToJSON(const CTransaction& tx, const uint256 hashBlock, UniValue& entry, CChainState& active_chainstate, const CTxUndo* txundo = nullptr)\n {\n     // Call into TxToUniv() in bitcoin-common to decode the transaction hex.\n     //\n     // Blockchain contextual information (confirmations and blocktime) is not\n     // available to code in bitcoin-common, so we query them here and push the\n     // data into the returned UniValue.\n-    TxToUniv(tx, uint256(), entry, true, RPCSerializationFlags());\n+    TxToUniv(tx, uint256(), entry, true, RPCSerializationFlags(), txundo, TxVerbosity::SHOW_DETAILS_AND_PREVOUT);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r749620834",
      "id" : 749620834,
      "line" : 54,
      "node_id" : "PRRC_kwDOABII584srk5i",
      "original_commit_id" : "fb2f153136dc14921cb7f249fe224919cb7094bb",
      "original_line" : 54,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 21,
      "pull_request_review_id" : 806345918,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/749620834/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-15T19:41:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/749620834",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r750119538"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/750119538"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks @stickies-v \r\n  I'll also add a function test to catch this condition",
      "commit_id" : "fb2f153136dc14921cb7f249fe224919cb7094bb",
      "created_at" : "2021-11-16T10:20:08Z",
      "diff_hunk" : "@@ -206,13 +240,31 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, errmsg + \". Use gettransaction for wallet transactions.\");\n     }\n \n-    if (!fVerbose) {\n+    if (verbosity == 0) {\n         return EncodeHexTx(*tx, RPCSerializationFlags());\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    if (blockindex) {\n+        result.pushKV(\"in_active_chain\", in_active_chain);\n+    }\n+\n+    std::optional<size_t> opt_tx_position{std::nullopt};\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+    if (verbosity == 1 || !blockindex || IsBlockPruned(blockindex) || !(UndoReadFromDisk(blockUndo, blockindex) && ReadBlockFromDisk(block, blockindex, Params().GetConsensus()))) {\n+        TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+        return result;\n+    }\n+    for (size_t i = 0; i < block.vtx.size(); ++i) {\n+        const CTransactionRef t = block.vtx.at(i);\n+        if (*t == *tx) {\n+            // blockundo does not have coinbase tx\n+            opt_tx_position = std::optional<size_t>{i-1};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r750119538",
      "id" : 750119538,
      "in_reply_to_id" : 749529909,
      "line" : 263,
      "node_id" : "PRRC_kwDOABII584stepy",
      "original_commit_id" : "fb2f153136dc14921cb7f249fe224919cb7094bb",
      "original_line" : 263,
      "original_position" : 154,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 154,
      "pull_request_review_id" : 807097996,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/750119538/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-16T10:20:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/750119538",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r750396075"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/750396075"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "There is `fee` in getransaction. see https://developer.bitcoin.org/reference/rpc/gettransaction.html\r\n\r\nI also agree with @luke-jr . There is no guarantee that fee calculation will always remain same, and thus better not to assert against hard coded values.",
      "commit_id" : "fb2f153136dc14921cb7f249fe224919cb7094bb",
      "created_at" : "2021-11-16T15:33:47Z",
      "diff_hunk" : "@@ -141,21 +143,35 @@ def getrawtransaction_tests(self):\n         for n in [0, 3]:\n             self.log.info(f\"Test getrawtransaction {'with' if n == 0 else 'without'} -txindex, with blockhash\")\n             # We should be able to get the raw transaction by providing the correct block\n-            gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=True, blockhash=block1)\n-            assert_equal(gottx['txid'], tx)\n-            assert_equal(gottx['in_active_chain'], True)\n-            if n == 0:\n-                self.log.info(\"Test getrawtransaction with -txindex, without blockhash: 'in_active_chain' should be absent\")\n-                gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=True)\n+            for v in [1, 2]: # verbosity level\n+                gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=v, blockhash=block1)\n                 assert_equal(gottx['txid'], tx)\n-                assert 'in_active_chain' not in gottx\n-            else:\n-                self.log.info(\"Test getrawtransaction without -txindex, without blockhash: expect the call to raise\")\n-                err_msg = (\n-                    \"No such mempool transaction. Use -txindex or provide a block hash to enable\"\n-                    \" blockchain transaction queries. Use gettransaction for wallet transactions.\"\n-                )\n-                assert_raises_rpc_error(-5, err_msg, self.nodes[n].getrawtransaction, txid=tx, verbose=True)\n+                assert_equal(gottx['in_active_chain'], True)\n+                if v == 2:\n+                    # fee is in verbosity 2 only\n+                    assert_equal(gottx['fee'], Decimal('0.00002820'))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r750396075",
      "id" : 750396075,
      "in_reply_to_id" : 739601931,
      "line" : 152,
      "node_id" : "PRRC_kwDOABII584suiKr",
      "original_commit_id" : "2c56d72acac277babad758dbc6eefb38264cb0ed",
      "original_line" : 152,
      "original_position" : 55,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 54,
      "pull_request_review_id" : 807471671,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/750396075/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-16T16:29:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/750396075",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r750449024"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/750449024"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Maybe it would be good to add few more data checks in `prevout` to ensure nothing changes in at the field level? ",
      "commit_id" : "fb2f153136dc14921cb7f249fe224919cb7094bb",
      "created_at" : "2021-11-16T16:25:43Z",
      "diff_hunk" : "@@ -141,21 +142,35 @@ def getrawtransaction_tests(self):\n         for n in [0, 3]:\n             self.log.info(f\"Test getrawtransaction {'with' if n == 0 else 'without'} -txindex, with blockhash\")\n             # We should be able to get the raw transaction by providing the correct block\n-            gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=True, blockhash=block1)\n-            assert_equal(gottx['txid'], tx)\n-            assert_equal(gottx['in_active_chain'], True)\n-            if n == 0:\n-                self.log.info(\"Test getrawtransaction with -txindex, without blockhash: 'in_active_chain' should be absent\")\n-                gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=True)\n+            for v in [1, 2]: # verbosity level\n+                gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=v, blockhash=block1)\n                 assert_equal(gottx['txid'], tx)\n-                assert 'in_active_chain' not in gottx\n-            else:\n-                self.log.info(\"Test getrawtransaction without -txindex, without blockhash: expect the call to raise\")\n-                err_msg = (\n-                    \"No such mempool transaction. Use -txindex or provide a block hash to enable\"\n-                    \" blockchain transaction queries. Use gettransaction for wallet transactions.\"\n-                )\n-                assert_raises_rpc_error(-5, err_msg, self.nodes[n].getrawtransaction, txid=tx, verbose=True)\n+                assert_equal(gottx['in_active_chain'], True)\n+                if v == 2:\n+                    # fee is in verbosity 2 only\n+                    assert('fee' in gottx)\n+                    assert_equal(gottx['fee'], Decimal('0.00002820'))\n+                    # verify transacion has prevout field\n+                    assert('vin' in gottx)\n+                    assert(len(gottx['vin']) > 0)\n+                    assert('prevout' in gottx['vin'][0])\n+                    assert_equal(False, gottx['vin'][0]['prevout']['generated'])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r750449024",
      "id" : 750449024,
      "line" : 157,
      "node_id" : "PRRC_kwDOABII584suvGA",
      "original_commit_id" : "fb2f153136dc14921cb7f249fe224919cb7094bb",
      "original_line" : 157,
      "original_position" : 59,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 59,
      "pull_request_review_id" : 807471671,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/750449024/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-16T16:29:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/750449024",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Review ACK [fb2f153](https://github.com/bitcoin/bitcoin/commit/fb2f153136dc14921cb7f249fe224919cb7094bb)\r\n> \r\n> I am not sure why, but I am hitting this weird error in the test\r\n> \r\n> ```\r\n> $ ./test/functional/rpc_rawtransaction.py \r\n\r\nI saw that as well, I'm fixing. \r\n",
      "created_at" : "2021-11-17T09:43:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-971406958",
      "id" : 971406958,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII58455n5u",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/971406958/reactions"
      },
      "updated_at" : "2021-11-17T09:43:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/971406958",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752101675"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752101675"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I added a separate test to validate output fields, only that they exists, not their values. \r\nIs this worth having?",
      "commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "created_at" : "2021-11-18T10:25:27Z",
      "diff_hunk" : "@@ -171,6 +174,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752101675",
      "id" : 752101675,
      "line" : 177,
      "node_id" : "PRRC_kwDOABII584s1Ckr",
      "original_commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "original_line" : 177,
      "original_position" : 40,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 40,
      "pull_request_review_id" : 809731554,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752101675/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-18T10:27:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752101675",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752102684"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752102684"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The function test, `./test/functional/rpc_rawtransaction.py`, uses named paramaters, so `verbose` must be here, unless we want to change the functional test.\r\n",
      "commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "created_at" : "2021-11-18T10:26:43Z",
      "diff_hunk" : "@@ -73,26 +74,27 @@ static RPCHelpMan getrawtransaction()\n {\n     return RPCHelpMan{\n                 \"getrawtransaction\",\n-                \"\\nReturn the raw transaction data.\\n\"\n+                \"\\nReturn the raw transaction data.\\n\\n\"\n \n-                \"\\nBy default, this call only returns a transaction if it is in the mempool. If -txindex is enabled\\n\"\n+                \"By default, this call only returns a transaction if it is in the mempool. If -txindex is enabled\\n\"\n                 \"and no blockhash argument is passed, it will return the transaction if it is in the mempool or any block.\\n\"\n                 \"If a blockhash argument is passed, it will return the transaction if\\n\"\n-                \"the specified block is available and the transaction is in that block.\\n\"\n-                \"\\nHint: Use gettransaction for wallet transactions.\\n\"\n+                \"the specified block is available and the transaction is in that block.\\n\\n\"\n+                \"Hint: Use gettransaction for wallet transactions.\\n\\n\"\n \n-                \"\\nIf verbose is 'true', returns an Object with information about 'txid'.\\n\"\n-                \"If verbose is 'false' or omitted, returns a string that is serialized, hex-encoded data for 'txid'.\\n\",\n+                \"If verbosity is 0 or omitted, returns a string that is serialized, hex-encoded data for transaction.\\n\"\n+                \"If verbosity is 1, returns an Object with information about transaction.\\n\"\n+                \"If verbosity is 2, returns an Object with information about transaction, including fees and prevout information.\\n\",\n                 {\n                     {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n-                    {\"verbose\", RPCArg::Type::BOOL, RPCArg::Default{false}, \"If false, return a string, otherwise return a json object\"},\n+                    {\"verbosity|verbose\", RPCArg::Type::NUM, RPCArg::Default{0}, \"0 for hex-encoded data, 1 for a json object, and 2 for json object with fee and prevout\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752102684",
      "id" : 752102684,
      "line" : 90,
      "node_id" : "PRRC_kwDOABII584s1C0c",
      "original_commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "original_line" : 90,
      "original_position" : 49,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 49,
      "pull_request_review_id" : 809731554,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752102684/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-18T10:27:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752102684",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752429948"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752429948"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "maybe this a little more clear?\r\n```suggestion\r\n            # We only check the \"hex\" field of the output, getrawtransaction_verbosity_tests checks remaining fields\r\n```",
      "commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "created_at" : "2021-11-18T16:44:11Z",
      "diff_hunk" : "@@ -113,21 +114,23 @@ def getrawtransaction_tests(self):\n             assert_equal(self.nodes[n].getrawtransaction(txId, False), rawTxSigned['hex'])\n \n             # 4. valid parameters - supply txid and 1 for verbose.\n-            # We only check the \"hex\" field of the output so we don't need to update this test every time the output format changes.\n+            # We only check the \"hex\" field of the output, getrawtransaction_verbosity_tests checks output",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752429948",
      "id" : 752429948,
      "line" : 117,
      "node_id" : "PRRC_kwDOABII584s2St8",
      "original_commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "original_line" : 117,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 13,
      "pull_request_review_id" : 810184027,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752429948/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-18T17:01:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752429948",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752437160"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752437160"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Do we need 2 blocks here? ",
      "commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "created_at" : "2021-11-18T16:51:35Z",
      "diff_hunk" : "@@ -171,6 +174,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.nodes[2].sendtoaddress(self.nodes[1].getnewaddress(), 1)\n+        block1, _ = self.generate(self.nodes[2], 2)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752437160",
      "id" : 752437160,
      "line" : 179,
      "node_id" : "PRRC_kwDOABII584s2Ueo",
      "original_commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "original_line" : 179,
      "original_position" : 42,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 42,
      "pull_request_review_id" : 810184027,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752437160/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-18T17:01:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752437160",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752439208"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752439208"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Internal node numbers are in general not printed in the test log as they don't really convey any meaningful information.",
      "commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "created_at" : "2021-11-18T16:53:35Z",
      "diff_hunk" : "@@ -171,6 +174,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.nodes[2].sendtoaddress(self.nodes[1].getnewaddress(), 1)\n+        block1, _ = self.generate(self.nodes[2], 2)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight'\n+        ]\n+        prevout_fields = [\n+            'generated',\n+            'height',\n+            'value',\n+            'scriptPubKey'\n+        ]\n+        script_pub_key_fields = [\n+            'address',\n+            'asm',\n+            'hex',\n+            'type'\n+        ]\n+        for n in [0, 3]:\n+            for v in [1,2]:\n+                self.log.info(f\"Test[{n}] getrawtransaction_verbosity {v} {'with' if n == 0 else 'without'} -txindex, with blockhash\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752439208",
      "id" : 752439208,
      "line" : 210,
      "node_id" : "PRRC_kwDOABII584s2U-o",
      "original_commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "original_line" : 210,
      "original_position" : 73,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 73,
      "pull_request_review_id" : 810184027,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752439208/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-18T17:01:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752439208",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752440784"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752440784"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "To keep parity with previous tests, an `without blockhash` test segment would be nice. ",
      "commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "created_at" : "2021-11-18T16:55:20Z",
      "diff_hunk" : "@@ -171,6 +174,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.nodes[2].sendtoaddress(self.nodes[1].getnewaddress(), 1)\n+        block1, _ = self.generate(self.nodes[2], 2)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight'\n+        ]\n+        prevout_fields = [\n+            'generated',\n+            'height',\n+            'value',\n+            'scriptPubKey'\n+        ]\n+        script_pub_key_fields = [\n+            'address',\n+            'asm',\n+            'hex',\n+            'type'\n+        ]\n+        for n in [0, 3]:\n+            for v in [1,2]:\n+                self.log.info(f\"Test[{n}] getrawtransaction_verbosity {v} {'with' if n == 0 else 'without'} -txindex, with blockhash\")\n+                gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=v, blockhash=block1)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752440784",
      "id" : 752440784,
      "line" : 211,
      "node_id" : "PRRC_kwDOABII584s2VXQ",
      "original_commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "original_line" : 211,
      "original_position" : 74,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 74,
      "pull_request_review_id" : 810184027,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752440784/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-18T17:01:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752440784",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752441923"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752441923"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: \r\n```suggestion\r\n        # check that coinbase has no fee or doesn't throw any errors for verbosity 2\r\n```",
      "commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "created_at" : "2021-11-18T16:56:37Z",
      "diff_hunk" : "@@ -171,6 +174,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.nodes[2].sendtoaddress(self.nodes[1].getnewaddress(), 1)\n+        block1, _ = self.generate(self.nodes[2], 2)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight'\n+        ]\n+        prevout_fields = [\n+            'generated',\n+            'height',\n+            'value',\n+            'scriptPubKey'\n+        ]\n+        script_pub_key_fields = [\n+            'address',\n+            'asm',\n+            'hex',\n+            'type'\n+        ]\n+        for n in [0, 3]:\n+            for v in [1,2]:\n+                self.log.info(f\"Test[{n}] getrawtransaction_verbosity {v} {'with' if n == 0 else 'without'} -txindex, with blockhash\")\n+                gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=v, blockhash=block1)\n+                for f in fields:\n+                    if f not in gottx:\n+                        raise AssertionError(f\"field {f} is not in transaction\")\n+                    if v == 1:\n+                        assert('fee' not in gottx)\n+                        assert(len(gottx['vin']) > 0)\n+                        assert('prevout' not in gottx['vin'][0])\n+                    if v == 2:\n+                        assert('fee' in gottx)\n+                        assert(isinstance(gottx['fee'], Decimal))\n+                        assert(len(gottx['vin']) > 0)\n+                        assert('prevout' in gottx['vin'][0])\n+                        prevout = gottx['vin'][0]['prevout']\n+                        for prevout_field in prevout_fields:\n+                            if prevout_field not in prevout:\n+                                raise AssertionError(f\"field {prevout_field} is not in transaction prevout {prevout}\")\n+                        script_pub_key = prevout['scriptPubKey']\n+                        for script_field in script_pub_key_fields:\n+                            if script_field not in script_pub_key:\n+                                raise AssertionError(f\"field {script_field} is not in transaction scriptPubKey {script_pub_key}\")\n+\n+        # check that coinbase has no fee or throws any errors for verbosity 2",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752441923",
      "id" : 752441923,
      "line" : 233,
      "node_id" : "PRRC_kwDOABII584s2VpD",
      "original_commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "original_line" : 233,
      "original_position" : 96,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 96,
      "pull_request_review_id" : 810184027,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752441923/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-18T17:01:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752441923",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752525733"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752525733"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> \r\n> But I am still unsure why the tests needs to be separated (or how it is related to previous test failure).\r\n> \r\n\r\nMostly clarity, I felt the `getrawtransaction_tests` was a bit confusing to follow, especially as I added the `verbosity=2` test cases.  Having a separate test for verbosity fields instead of smashing everything in one test block made reading more clear as well was intent. \r\n\r\n\r\n",
      "commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "created_at" : "2021-11-18T18:42:33Z",
      "diff_hunk" : "@@ -113,21 +114,23 @@ def getrawtransaction_tests(self):\n             assert_equal(self.nodes[n].getrawtransaction(txId, False), rawTxSigned['hex'])\n \n             # 4. valid parameters - supply txid and 1 for verbose.\n-            # We only check the \"hex\" field of the output so we don't need to update this test every time the output format changes.\n+            # We only check the \"hex\" field of the output, getrawtransaction_verbosity_tests checks output",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752525733",
      "id" : 752525733,
      "in_reply_to_id" : 752429948,
      "line" : 117,
      "node_id" : "PRRC_kwDOABII584s2qGl",
      "original_commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "original_line" : 117,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 13,
      "pull_request_review_id" : 810318041,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752525733/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-18T18:42:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752525733",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752923357"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752923357"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "changed",
      "commit_id" : "eaf10aacddfd32c0722414a3f040d3fae2b51cf7",
      "created_at" : "2021-11-19T07:42:31Z",
      "diff_hunk" : "@@ -171,6 +174,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.nodes[2].sendtoaddress(self.nodes[1].getnewaddress(), 1)\n+        block1, _ = self.generate(self.nodes[2], 2)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight'\n+        ]\n+        prevout_fields = [\n+            'generated',\n+            'height',\n+            'value',\n+            'scriptPubKey'\n+        ]\n+        script_pub_key_fields = [\n+            'address',\n+            'asm',\n+            'hex',\n+            'type'\n+        ]\n+        for n in [0, 3]:\n+            for v in [1,2]:\n+                self.log.info(f\"Test[{n}] getrawtransaction_verbosity {v} {'with' if n == 0 else 'without'} -txindex, with blockhash\")\n+                gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=v, blockhash=block1)\n+                for f in fields:\n+                    if f not in gottx:\n+                        raise AssertionError(f\"field {f} is not in transaction\")\n+                    if v == 1:\n+                        assert('fee' not in gottx)\n+                        assert(len(gottx['vin']) > 0)\n+                        assert('prevout' not in gottx['vin'][0])\n+                    if v == 2:\n+                        assert('fee' in gottx)\n+                        assert(isinstance(gottx['fee'], Decimal))\n+                        assert(len(gottx['vin']) > 0)\n+                        assert('prevout' in gottx['vin'][0])\n+                        prevout = gottx['vin'][0]['prevout']\n+                        for prevout_field in prevout_fields:\n+                            if prevout_field not in prevout:\n+                                raise AssertionError(f\"field {prevout_field} is not in transaction prevout {prevout}\")\n+                        script_pub_key = prevout['scriptPubKey']\n+                        for script_field in script_pub_key_fields:\n+                            if script_field not in script_pub_key:\n+                                raise AssertionError(f\"field {script_field} is not in transaction scriptPubKey {script_pub_key}\")\n+\n+        # check that coinbase has no fee or throws any errors for verbosity 2",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752923357",
      "id" : 752923357,
      "in_reply_to_id" : 752441923,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584s4LLd",
      "original_commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "original_line" : 233,
      "original_position" : 96,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : null,
      "pull_request_review_id" : 810867810,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752923357/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-19T07:42:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752923357",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752923484"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752923484"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Removed",
      "commit_id" : "eaf10aacddfd32c0722414a3f040d3fae2b51cf7",
      "created_at" : "2021-11-19T07:42:48Z",
      "diff_hunk" : "@@ -171,6 +174,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.nodes[2].sendtoaddress(self.nodes[1].getnewaddress(), 1)\n+        block1, _ = self.generate(self.nodes[2], 2)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight'\n+        ]\n+        prevout_fields = [\n+            'generated',\n+            'height',\n+            'value',\n+            'scriptPubKey'\n+        ]\n+        script_pub_key_fields = [\n+            'address',\n+            'asm',\n+            'hex',\n+            'type'\n+        ]\n+        for n in [0, 3]:\n+            for v in [1,2]:\n+                self.log.info(f\"Test[{n}] getrawtransaction_verbosity {v} {'with' if n == 0 else 'without'} -txindex, with blockhash\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752923484",
      "id" : 752923484,
      "in_reply_to_id" : 752439208,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584s4LNc",
      "original_commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "original_line" : 210,
      "original_position" : 73,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : null,
      "pull_request_review_id" : 810868222,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752923484/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-19T07:42:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752923484",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752923550"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752923550"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nope!",
      "commit_id" : "eaf10aacddfd32c0722414a3f040d3fae2b51cf7",
      "created_at" : "2021-11-19T07:42:56Z",
      "diff_hunk" : "@@ -171,6 +174,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.nodes[2].sendtoaddress(self.nodes[1].getnewaddress(), 1)\n+        block1, _ = self.generate(self.nodes[2], 2)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752923550",
      "id" : 752923550,
      "in_reply_to_id" : 752437160,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584s4LOe",
      "original_commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "original_line" : 179,
      "original_position" : 42,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : null,
      "pull_request_review_id" : 810868464,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752923550/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-19T07:42:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752923550",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752932303"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752932303"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I added `without blockhash` verbosity=2 test in `getrawtransaction_tests`",
      "commit_id" : "eaf10aacddfd32c0722414a3f040d3fae2b51cf7",
      "created_at" : "2021-11-19T07:59:08Z",
      "diff_hunk" : "@@ -171,6 +174,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.nodes[2].sendtoaddress(self.nodes[1].getnewaddress(), 1)\n+        block1, _ = self.generate(self.nodes[2], 2)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight'\n+        ]\n+        prevout_fields = [\n+            'generated',\n+            'height',\n+            'value',\n+            'scriptPubKey'\n+        ]\n+        script_pub_key_fields = [\n+            'address',\n+            'asm',\n+            'hex',\n+            'type'\n+        ]\n+        for n in [0, 3]:\n+            for v in [1,2]:\n+                self.log.info(f\"Test[{n}] getrawtransaction_verbosity {v} {'with' if n == 0 else 'without'} -txindex, with blockhash\")\n+                gottx = self.nodes[n].getrawtransaction(txid=tx, verbose=v, blockhash=block1)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r752932303",
      "id" : 752932303,
      "in_reply_to_id" : 752440784,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584s4NXP",
      "original_commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "original_line" : 211,
      "original_position" : 74,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : null,
      "pull_request_review_id" : 810894348,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752932303/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-19T07:59:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/752932303",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r753202059"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/753202059"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Fair enough.. That makes sense.. ",
      "commit_id" : "eaf10aacddfd32c0722414a3f040d3fae2b51cf7",
      "created_at" : "2021-11-19T13:45:47Z",
      "diff_hunk" : "@@ -113,21 +114,23 @@ def getrawtransaction_tests(self):\n             assert_equal(self.nodes[n].getrawtransaction(txId, False), rawTxSigned['hex'])\n \n             # 4. valid parameters - supply txid and 1 for verbose.\n-            # We only check the \"hex\" field of the output so we don't need to update this test every time the output format changes.\n+            # We only check the \"hex\" field of the output, getrawtransaction_verbosity_tests checks output",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r753202059",
      "id" : 753202059,
      "in_reply_to_id" : 752429948,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584s5POL",
      "original_commit_id" : "fee0b82aca8f9c8eba4b0bff3e6ec3ddbb7208ae",
      "original_line" : 117,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : null,
      "pull_request_review_id" : 811221450,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/753202059/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-19T13:45:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/753202059",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r753206108"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/753206108"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: \r\n```suggestion\r\n        # check that coinbase has no fee or does not throw any errors for verbosity 2\r\n```",
      "commit_id" : "eaf10aacddfd32c0722414a3f040d3fae2b51cf7",
      "created_at" : "2021-11-19T13:51:21Z",
      "diff_hunk" : "@@ -171,6 +175,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.nodes[2].sendtoaddress(self.nodes[1].getnewaddress(), 1)\n+        [block1] = self.generate(self.nodes[2], 1)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight'\n+        ]\n+        prevout_fields = [\n+            'generated',\n+            'height',\n+            'value',\n+            'scriptPubKey'\n+        ]\n+        script_pub_key_fields = [\n+            'address',\n+            'asm',\n+            'hex',\n+            'type'\n+        ]\n+        for n in [0, 3]:\n+            for v in [1,2]:\n+                self.log.info(f\"Test getrawtransaction_verbosity {v} {'with' if n == 0 else 'without'} -txindex, with blockhash\")\n+                gottx = self.nodes[n].getrawtransaction(txid=tx, verbosity=v, blockhash=block1)\n+                for f in fields:\n+                    if f not in gottx:\n+                        raise AssertionError(f\"field {f} is not in transaction\")\n+                    if v == 1:\n+                        assert('fee' not in gottx)\n+                        assert(len(gottx['vin']) > 0)\n+                        assert('prevout' not in gottx['vin'][0])\n+                    if v == 2:\n+                        assert('fee' in gottx)\n+                        assert(isinstance(gottx['fee'], Decimal))\n+                        assert(len(gottx['vin']) > 0)\n+                        assert('prevout' in gottx['vin'][0])\n+                        prevout = gottx['vin'][0]['prevout']\n+                        for prevout_field in prevout_fields:\n+                            if prevout_field not in prevout:\n+                                raise AssertionError(f\"field {prevout_field} is not in transaction prevout {prevout}\")\n+                        script_pub_key = prevout['scriptPubKey']\n+                        for script_field in script_pub_key_fields:\n+                            if script_field not in script_pub_key:\n+                                raise AssertionError(f\"field {script_field} is not in transaction scriptPubKey {script_pub_key}\")\n+\n+        # check that coinbase has no fee or does not throws any errors for verbosity 2",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r753206108",
      "id" : 753206108,
      "line" : 234,
      "node_id" : "PRRC_kwDOABII584s5QNc",
      "original_commit_id" : "eaf10aacddfd32c0722414a3f040d3fae2b51cf7",
      "original_line" : 234,
      "original_position" : 110,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 110,
      "pull_request_review_id" : 811227117,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/753206108/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-19T14:32:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/753206108",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r753225045"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/753225045"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "```suggestion\r\n                    RPCResult{\"if verbosity is not set or set to 0\",\r\n```",
      "commit_id" : "eaf10aacddfd32c0722414a3f040d3fae2b51cf7",
      "created_at" : "2021-11-19T14:16:34Z",
      "diff_hunk" : "@@ -73,26 +74,27 @@ static RPCHelpMan getrawtransaction()\n {\n     return RPCHelpMan{\n                 \"getrawtransaction\",\n-                \"\\nReturn the raw transaction data.\\n\"\n+                \"\\nReturn the raw transaction data.\\n\\n\"\n \n-                \"\\nBy default, this call only returns a transaction if it is in the mempool. If -txindex is enabled\\n\"\n+                \"By default, this call only returns a transaction if it is in the mempool. If -txindex is enabled\\n\"\n                 \"and no blockhash argument is passed, it will return the transaction if it is in the mempool or any block.\\n\"\n                 \"If a blockhash argument is passed, it will return the transaction if\\n\"\n-                \"the specified block is available and the transaction is in that block.\\n\"\n-                \"\\nHint: Use gettransaction for wallet transactions.\\n\"\n+                \"the specified block is available and the transaction is in that block.\\n\\n\"\n+                \"Hint: Use gettransaction for wallet transactions.\\n\\n\"\n \n-                \"\\nIf verbose is 'true', returns an Object with information about 'txid'.\\n\"\n-                \"If verbose is 'false' or omitted, returns a string that is serialized, hex-encoded data for 'txid'.\\n\",\n+                \"If verbosity is 0 or omitted, returns a string that is serialized, hex-encoded data for transaction.\\n\"\n+                \"If verbosity is 1, returns an Object with information about transaction.\\n\"\n+                \"If verbosity is 2, returns an Object with information about transaction, including fees and prevout information.\\n\",\n                 {\n                     {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n-                    {\"verbose\", RPCArg::Type::BOOL, RPCArg::Default{false}, \"If false, return a string, otherwise return a json object\"},\n+                    {\"verbosity|verbose\", RPCArg::Type::NUM, RPCArg::Default{0}, \"0 for hex-encoded data, 1 for a json object, and 2 for json object with fee and prevout\"},\n                     {\"blockhash\", RPCArg::Type::STR_HEX, RPCArg::Optional::OMITTED_NAMED_ARG, \"The block in which to look for the transaction\"},\n                 },\n                 {\n-                    RPCResult{\"if verbose is not set or set to false\",\n+                    RPCResult{\"if verbose is not set or set to 0\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r753225045",
      "id" : 753225045,
      "line" : 94,
      "node_id" : "PRRC_kwDOABII584s5U1V",
      "original_commit_id" : "eaf10aacddfd32c0722414a3f040d3fae2b51cf7",
      "original_line" : 94,
      "original_position" : 54,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 54,
      "pull_request_review_id" : 811227117,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/753225045/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-19T14:32:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/753225045",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r753225691"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/753225691"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "```suggestion\r\n                \"If verbosity is 2, returns an Object with information about transaction, including fee and prevout information.\\n\",\r\n```",
      "commit_id" : "eaf10aacddfd32c0722414a3f040d3fae2b51cf7",
      "created_at" : "2021-11-19T14:17:25Z",
      "diff_hunk" : "@@ -73,26 +74,27 @@ static RPCHelpMan getrawtransaction()\n {\n     return RPCHelpMan{\n                 \"getrawtransaction\",\n-                \"\\nReturn the raw transaction data.\\n\"\n+                \"\\nReturn the raw transaction data.\\n\\n\"\n \n-                \"\\nBy default, this call only returns a transaction if it is in the mempool. If -txindex is enabled\\n\"\n+                \"By default, this call only returns a transaction if it is in the mempool. If -txindex is enabled\\n\"\n                 \"and no blockhash argument is passed, it will return the transaction if it is in the mempool or any block.\\n\"\n                 \"If a blockhash argument is passed, it will return the transaction if\\n\"\n-                \"the specified block is available and the transaction is in that block.\\n\"\n-                \"\\nHint: Use gettransaction for wallet transactions.\\n\"\n+                \"the specified block is available and the transaction is in that block.\\n\\n\"\n+                \"Hint: Use gettransaction for wallet transactions.\\n\\n\"\n \n-                \"\\nIf verbose is 'true', returns an Object with information about 'txid'.\\n\"\n-                \"If verbose is 'false' or omitted, returns a string that is serialized, hex-encoded data for 'txid'.\\n\",\n+                \"If verbosity is 0 or omitted, returns a string that is serialized, hex-encoded data for transaction.\\n\"\n+                \"If verbosity is 1, returns an Object with information about transaction.\\n\"\n+                \"If verbosity is 2, returns an Object with information about transaction, including fees and prevout information.\\n\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r753225691",
      "id" : 753225691,
      "line" : 87,
      "node_id" : "PRRC_kwDOABII584s5U_b",
      "original_commit_id" : "eaf10aacddfd32c0722414a3f040d3fae2b51cf7",
      "original_line" : 87,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 45,
      "pull_request_review_id" : 811227117,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/753225691/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-19T14:32:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/753225691",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Re ACK [eaf10aa](https://github.com/bitcoin/bitcoin/commit/eaf10aacddfd32c0722414a3f040d3fae2b51cf7).\r\n> \r\n> I think the commits can be rearranged a bit, consolidating all file specific changes. Would be easier for new reviewers.\r\n\r\nShould I just squash into one commit ?\r\n\r\n",
      "created_at" : "2021-11-20T10:21:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-974628126",
      "id" : 974628126,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII5846F6Ue",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/974628126/reactions"
      },
      "updated_at" : "2021-11-20T10:21:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/974628126",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Should I just squash into one commit ?\r\n\r\nI think the best thing to do here is to put one commit for each file, and order them logically (ex: `client.cpp` changes should come before `rawtransaction.cpp`, functional test commit should be the last, etc). For more details on commit structuring refer https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#committing-patches",
      "created_at" : "2021-11-20T15:15:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-974663889",
      "id" : 974663889,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII5846GDDR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/974663889/reactions"
      },
      "updated_at" : "2021-11-20T15:15:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/974663889",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think it is also fine to have just one commit, since this is just one feature. And it is fine to add tests in the same commit that adds features.",
      "created_at" : "2021-11-21T07:38:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-974769534",
      "id" : 974769534,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII5846Gc1-",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/974769534/reactions"
      },
      "updated_at" : "2021-11-21T07:38:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/974769534",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I think it is also fine to have just one commit, since this is just one feature. And it is fine to add tests in the same commit that adds features.\r\n\r\nsquashed to one commit ",
      "created_at" : "2021-11-21T09:19:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-974781343",
      "id" : 974781343,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII5846Gfuf",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/974781343/reactions"
      },
      "updated_at" : "2021-11-21T09:19:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/974781343",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r754302688"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754302688"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I added an arg for explicit `TxVerbosity` in `TxToJSON`",
      "commit_id" : "b612eddc3c251f187e6f28142f88be75345ad300",
      "created_at" : "2021-11-22T13:57:30Z",
      "diff_hunk" : "@@ -43,14 +44,14 @@\n \n #include <univalue.h>\n \n-static void TxToJSON(const CTransaction& tx, const uint256 hashBlock, UniValue& entry, CChainState& active_chainstate)\n+static void TxToJSON(const CTransaction& tx, const uint256 hashBlock, UniValue& entry, CChainState& active_chainstate, const CTxUndo* txundo = nullptr)\n {\n     // Call into TxToUniv() in bitcoin-common to decode the transaction hex.\n     //\n     // Blockchain contextual information (confirmations and blocktime) is not\n     // available to code in bitcoin-common, so we query them here and push the\n     // data into the returned UniValue.\n-    TxToUniv(tx, uint256(), entry, true, RPCSerializationFlags());\n+    TxToUniv(tx, uint256(), entry, true, RPCSerializationFlags(), txundo, TxVerbosity::SHOW_DETAILS_AND_PREVOUT);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r754302688",
      "id" : 754302688,
      "in_reply_to_id" : 749620834,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584s9b7g",
      "original_commit_id" : "fb2f153136dc14921cb7f249fe224919cb7094bb",
      "original_line" : 54,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : null,
      "pull_request_review_id" : 812565601,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754302688/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-22T13:57:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754302688",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r755066106"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755066106"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think this change is still pending.. ",
      "commit_id" : "b612eddc3c251f187e6f28142f88be75345ad300",
      "created_at" : "2021-11-23T12:15:30Z",
      "diff_hunk" : "@@ -171,6 +175,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.nodes[2].sendtoaddress(self.nodes[1].getnewaddress(), 1)\n+        [block1] = self.generate(self.nodes[2], 1)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight'\n+        ]\n+        prevout_fields = [\n+            'generated',\n+            'height',\n+            'value',\n+            'scriptPubKey'\n+        ]\n+        script_pub_key_fields = [\n+            'address',\n+            'asm',\n+            'hex',\n+            'type'\n+        ]\n+        for n in [0, 3]:\n+            for v in [1,2]:\n+                self.log.info(f\"Test getrawtransaction_verbosity {v} {'with' if n == 0 else 'without'} -txindex, with blockhash\")\n+                gottx = self.nodes[n].getrawtransaction(txid=tx, verbosity=v, blockhash=block1)\n+                for f in fields:\n+                    if f not in gottx:\n+                        raise AssertionError(f\"field {f} is not in transaction\")\n+                    if v == 1:\n+                        assert('fee' not in gottx)\n+                        assert(len(gottx['vin']) > 0)\n+                        assert('prevout' not in gottx['vin'][0])\n+                    if v == 2:\n+                        assert('fee' in gottx)\n+                        assert(isinstance(gottx['fee'], Decimal))\n+                        assert(len(gottx['vin']) > 0)\n+                        assert('prevout' in gottx['vin'][0])\n+                        prevout = gottx['vin'][0]['prevout']\n+                        for prevout_field in prevout_fields:\n+                            if prevout_field not in prevout:\n+                                raise AssertionError(f\"field {prevout_field} is not in transaction prevout {prevout}\")\n+                        script_pub_key = prevout['scriptPubKey']\n+                        for script_field in script_pub_key_fields:\n+                            if script_field not in script_pub_key:\n+                                raise AssertionError(f\"field {script_field} is not in transaction scriptPubKey {script_pub_key}\")\n+\n+        # check that coinbase has no fee or does not throws any errors for verbosity 2",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r755066106",
      "id" : 755066106,
      "in_reply_to_id" : 753206108,
      "line" : 234,
      "node_id" : "PRRC_kwDOABII584tAWT6",
      "original_commit_id" : "eaf10aacddfd32c0722414a3f040d3fae2b51cf7",
      "original_line" : 234,
      "original_position" : 110,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 110,
      "pull_request_review_id" : 813580620,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755066106/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-23T12:15:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755066106",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r755401364"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755401364"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> I think this change is still pending..\r\n\r\nFixed",
      "commit_id" : "46c9cfe65526997e6043d4fdbaace32b4eb580df",
      "created_at" : "2021-11-23T18:25:33Z",
      "diff_hunk" : "@@ -171,6 +175,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.nodes[2].sendtoaddress(self.nodes[1].getnewaddress(), 1)\n+        [block1] = self.generate(self.nodes[2], 1)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight'\n+        ]\n+        prevout_fields = [\n+            'generated',\n+            'height',\n+            'value',\n+            'scriptPubKey'\n+        ]\n+        script_pub_key_fields = [\n+            'address',\n+            'asm',\n+            'hex',\n+            'type'\n+        ]\n+        for n in [0, 3]:\n+            for v in [1,2]:\n+                self.log.info(f\"Test getrawtransaction_verbosity {v} {'with' if n == 0 else 'without'} -txindex, with blockhash\")\n+                gottx = self.nodes[n].getrawtransaction(txid=tx, verbosity=v, blockhash=block1)\n+                for f in fields:\n+                    if f not in gottx:\n+                        raise AssertionError(f\"field {f} is not in transaction\")\n+                    if v == 1:\n+                        assert('fee' not in gottx)\n+                        assert(len(gottx['vin']) > 0)\n+                        assert('prevout' not in gottx['vin'][0])\n+                    if v == 2:\n+                        assert('fee' in gottx)\n+                        assert(isinstance(gottx['fee'], Decimal))\n+                        assert(len(gottx['vin']) > 0)\n+                        assert('prevout' in gottx['vin'][0])\n+                        prevout = gottx['vin'][0]['prevout']\n+                        for prevout_field in prevout_fields:\n+                            if prevout_field not in prevout:\n+                                raise AssertionError(f\"field {prevout_field} is not in transaction prevout {prevout}\")\n+                        script_pub_key = prevout['scriptPubKey']\n+                        for script_field in script_pub_key_fields:\n+                            if script_field not in script_pub_key:\n+                                raise AssertionError(f\"field {script_field} is not in transaction scriptPubKey {script_pub_key}\")\n+\n+        # check that coinbase has no fee or does not throws any errors for verbosity 2",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r755401364",
      "id" : 755401364,
      "in_reply_to_id" : 753206108,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584tBoKU",
      "original_commit_id" : "eaf10aacddfd32c0722414a3f040d3fae2b51cf7",
      "original_line" : 234,
      "original_position" : 110,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : null,
      "pull_request_review_id" : 814036550,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755401364/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-23T18:25:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755401364",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-12-07T14:38:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-987986369",
      "id" : 987986369,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII584643nB",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/987986369/reactions"
      },
      "updated_at" : "2021-12-07T14:38:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/987986369",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-01-11T10:37:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-1009830967",
      "id" : 1009830967,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII5848MMw3",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1009830967/reactions"
      },
      "updated_at" : "2022-01-11T10:37:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1009830967",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r782024851"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/782024851"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n                \"Return the raw transaction data.\\n\\n\"\r\n```\r\n\r\nnit: no need for this `\\n` after rebase",
      "commit_id" : "e76df3127e68e46a92dd4a66a8f39920001a003b",
      "created_at" : "2022-01-11T10:45:57Z",
      "diff_hunk" : "@@ -111,26 +112,27 @@ static RPCHelpMan getrawtransaction()\n {\n     return RPCHelpMan{\n                 \"getrawtransaction\",\n-                \"\\nReturn the raw transaction data.\\n\"\n+                \"\\nReturn the raw transaction data.\\n\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r782024851",
      "id" : 782024851,
      "line" : 115,
      "node_id" : "PRRC_kwDOABII584unMCT",
      "original_commit_id" : "e76df3127e68e46a92dd4a66a8f39920001a003b",
      "original_line" : 115,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 30,
      "pull_request_review_id" : 848983312,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/782024851/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-11T10:45:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/782024851",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r782025080"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/782025080"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n                \"If verbosity is 2, returns an Object with information about transaction, including fee and prevout information.\",\r\n```\r\n\r\nsame: can be removed",
      "commit_id" : "e76df3127e68e46a92dd4a66a8f39920001a003b",
      "created_at" : "2022-01-11T10:46:14Z",
      "diff_hunk" : "@@ -111,26 +112,27 @@ static RPCHelpMan getrawtransaction()\n {\n     return RPCHelpMan{\n                 \"getrawtransaction\",\n-                \"\\nReturn the raw transaction data.\\n\"\n+                \"\\nReturn the raw transaction data.\\n\\n\"\n \n-                \"\\nBy default, this call only returns a transaction if it is in the mempool. If -txindex is enabled\\n\"\n+                \"By default, this call only returns a transaction if it is in the mempool. If -txindex is enabled\\n\"\n                 \"and no blockhash argument is passed, it will return the transaction if it is in the mempool or any block.\\n\"\n                 \"If a blockhash argument is passed, it will return the transaction if\\n\"\n-                \"the specified block is available and the transaction is in that block.\\n\"\n-                \"\\nHint: Use gettransaction for wallet transactions.\\n\"\n+                \"the specified block is available and the transaction is in that block.\\n\\n\"\n+                \"Hint: Use gettransaction for wallet transactions.\\n\\n\"\n \n-                \"\\nIf verbose is 'true', returns an Object with information about 'txid'.\\n\"\n-                \"If verbose is 'false' or omitted, returns a string that is serialized, hex-encoded data for 'txid'.\\n\",\n+                \"If verbosity is 0 or omitted, returns a string that is serialized, hex-encoded data for transaction.\\n\"\n+                \"If verbosity is 1, returns an Object with information about transaction.\\n\"\n+                \"If verbosity is 2, returns an Object with information about transaction, including fee and prevout information.\\n\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r782025080",
      "id" : 782025080,
      "line" : 125,
      "node_id" : "PRRC_kwDOABII584unMF4",
      "original_commit_id" : "e76df3127e68e46a92dd4a66a8f39920001a003b",
      "original_line" : 125,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 45,
      "pull_request_review_id" : 848983605,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/782025080/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-11T10:46:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/782025080",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-01-17T04:26:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-1014130526",
      "id" : 1014130526,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII5848cmde",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1014130526/reactions"
      },
      "updated_at" : "2022-01-17T04:26:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1014130526",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-01-26T10:22:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-1022061955",
      "id" : 1022061955,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII5848622D",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1022061955/reactions"
      },
      "updated_at" : "2022-01-26T10:22:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1022061955",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798046497"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798046497"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I had to add the lock due to `IsBlockPruned` now requiring a lock ",
      "commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "created_at" : "2022-02-02T21:57:32Z",
      "diff_hunk" : "@@ -256,13 +292,37 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, errmsg + \". Use gettransaction for wallet transactions.\");\n     }\n \n-    if (!fVerbose) {\n+    if (verbosity == 0) {\n         return EncodeHexTx(*tx, RPCSerializationFlags());\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    if (blockindex) {\n+        result.pushKV(\"in_active_chain\", in_active_chain);\n+    }\n+\n+    std::optional<size_t> opt_tx_position{std::nullopt};\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+\n+    {\n+        LOCK(cs_main);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798046497",
      "id" : 798046497,
      "line" : 309,
      "node_id" : "PRRC_kwDOABII584vkTkh",
      "original_commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "original_line" : 309,
      "original_position" : 154,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 154,
      "pull_request_review_id" : 871153362,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798046497/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-02T21:57:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798046497",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798421734"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798421734"
         }
      },
      "author_association" : "NONE",
      "body" : "nit: I find \"data for transaction\" a bit ambiguous. We're just returning the entire transaction, so I'd phrase it as:\r\n```suggestion\r\n                \"If verbosity is 0 or omitted, returns the serialized transaction as a hex-encoded string.\\n\"\r\n```",
      "commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "created_at" : "2022-02-03T10:28:33Z",
      "diff_hunk" : "@@ -121,26 +124,27 @@ static RPCHelpMan getrawtransaction()\n {\n     return RPCHelpMan{\n                 \"getrawtransaction\",\n-                \"\\nReturn the raw transaction data.\\n\"\n+                \"Return the raw transaction data.\\n\\n\"\n \n-                \"\\nBy default, this call only returns a transaction if it is in the mempool. If -txindex is enabled\\n\"\n+                \"By default, this call only returns a transaction if it is in the mempool. If -txindex is enabled\\n\"\n                 \"and no blockhash argument is passed, it will return the transaction if it is in the mempool or any block.\\n\"\n                 \"If a blockhash argument is passed, it will return the transaction if\\n\"\n-                \"the specified block is available and the transaction is in that block.\\n\"\n-                \"\\nHint: Use gettransaction for wallet transactions.\\n\"\n+                \"the specified block is available and the transaction is in that block.\\n\\n\"\n+                \"Hint: Use gettransaction for wallet transactions.\\n\\n\"\n \n-                \"\\nIf verbose is 'true', returns an Object with information about 'txid'.\\n\"\n-                \"If verbose is 'false' or omitted, returns a string that is serialized, hex-encoded data for 'txid'.\\n\",\n+                \"If verbosity is 0 or omitted, returns a string that is serialized, hex-encoded data for transaction.\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798421734",
      "id" : 798421734,
      "line" : 135,
      "node_id" : "PRRC_kwDOABII584vlvLm",
      "original_commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "original_line" : 135,
      "original_position" : 49,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 49,
      "pull_request_review_id" : 871642356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798421734/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-03T14:29:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798421734",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798423877"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798423877"
         }
      },
      "author_association" : "NONE",
      "body" : "nit: consistent reference to a JSON Object\r\n```suggestion\r\n                \"If verbosity is 1, returns a JSON Object with information about transaction.\\n\"\r\n                \"If verbosity is 2, returns a JSON Object with information about transaction, including fee and prevout information.\",\r\n```",
      "commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "created_at" : "2022-02-03T10:31:08Z",
      "diff_hunk" : "@@ -121,26 +124,27 @@ static RPCHelpMan getrawtransaction()\n {\n     return RPCHelpMan{\n                 \"getrawtransaction\",\n-                \"\\nReturn the raw transaction data.\\n\"\n+                \"Return the raw transaction data.\\n\\n\"\n \n-                \"\\nBy default, this call only returns a transaction if it is in the mempool. If -txindex is enabled\\n\"\n+                \"By default, this call only returns a transaction if it is in the mempool. If -txindex is enabled\\n\"\n                 \"and no blockhash argument is passed, it will return the transaction if it is in the mempool or any block.\\n\"\n                 \"If a blockhash argument is passed, it will return the transaction if\\n\"\n-                \"the specified block is available and the transaction is in that block.\\n\"\n-                \"\\nHint: Use gettransaction for wallet transactions.\\n\"\n+                \"the specified block is available and the transaction is in that block.\\n\\n\"\n+                \"Hint: Use gettransaction for wallet transactions.\\n\\n\"\n \n-                \"\\nIf verbose is 'true', returns an Object with information about 'txid'.\\n\"\n-                \"If verbose is 'false' or omitted, returns a string that is serialized, hex-encoded data for 'txid'.\\n\",\n+                \"If verbosity is 0 or omitted, returns a string that is serialized, hex-encoded data for transaction.\\n\"\n+                \"If verbosity is 1, returns an Object with information about transaction.\\n\"\n+                \"If verbosity is 2, returns an Object with information about transaction, including fee and prevout information.\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798423877",
      "id" : 798423877,
      "line" : 137,
      "node_id" : "PRRC_kwDOABII584vlvtF",
      "original_commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "original_line" : 137,
      "original_position" : 51,
      "original_start_line" : 136,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 51,
      "pull_request_review_id" : 871642356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798423877/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 136,
      "start_side" : "RIGHT",
      "updated_at" : "2022-02-03T14:29:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798423877",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798424303"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798424303"
         }
      },
      "author_association" : "NONE",
      "body" : "nit: consistent reference to a JSON Object\r\n```suggestion\r\n                    {\"verbosity|verbose\", RPCArg::Type::NUM, RPCArg::Default{0}, \"0 for hex-encoded data, 1 for a JSON Object, and 2 for JSON Object with fee and prevout\"},\r\n```",
      "commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "created_at" : "2022-02-03T10:31:37Z",
      "diff_hunk" : "@@ -121,26 +124,27 @@ static RPCHelpMan getrawtransaction()\n {\n     return RPCHelpMan{\n                 \"getrawtransaction\",\n-                \"\\nReturn the raw transaction data.\\n\"\n+                \"Return the raw transaction data.\\n\\n\"\n \n-                \"\\nBy default, this call only returns a transaction if it is in the mempool. If -txindex is enabled\\n\"\n+                \"By default, this call only returns a transaction if it is in the mempool. If -txindex is enabled\\n\"\n                 \"and no blockhash argument is passed, it will return the transaction if it is in the mempool or any block.\\n\"\n                 \"If a blockhash argument is passed, it will return the transaction if\\n\"\n-                \"the specified block is available and the transaction is in that block.\\n\"\n-                \"\\nHint: Use gettransaction for wallet transactions.\\n\"\n+                \"the specified block is available and the transaction is in that block.\\n\\n\"\n+                \"Hint: Use gettransaction for wallet transactions.\\n\\n\"\n \n-                \"\\nIf verbose is 'true', returns an Object with information about 'txid'.\\n\"\n-                \"If verbose is 'false' or omitted, returns a string that is serialized, hex-encoded data for 'txid'.\\n\",\n+                \"If verbosity is 0 or omitted, returns a string that is serialized, hex-encoded data for transaction.\\n\"\n+                \"If verbosity is 1, returns an Object with information about transaction.\\n\"\n+                \"If verbosity is 2, returns an Object with information about transaction, including fee and prevout information.\",\n                 {\n                     {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n-                    {\"verbose\", RPCArg::Type::BOOL, RPCArg::Default{false}, \"If false, return a string, otherwise return a json object\"},\n+                    {\"verbosity|verbose\", RPCArg::Type::NUM, RPCArg::Default{0}, \"0 for hex-encoded data, 1 for a json object, and 2 for json object with fee and prevout\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798424303",
      "id" : 798424303,
      "line" : 140,
      "node_id" : "PRRC_kwDOABII584vlvzv",
      "original_commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "original_line" : 140,
      "original_position" : 55,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 55,
      "pull_request_review_id" : 871642356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798424303/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-03T14:29:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798424303",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798428888"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798428888"
         }
      },
      "author_association" : "NONE",
      "body" : "As per above suggestion, for consistency:\r\n```suggestion\r\n                         RPCResult::Type::STR, \"data\", \"The serialized transaction as a hex-encoded string\"\r\n```",
      "commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "created_at" : "2022-02-03T10:37:18Z",
      "diff_hunk" : "@@ -121,26 +124,27 @@ static RPCHelpMan getrawtransaction()\n {\n     return RPCHelpMan{\n                 \"getrawtransaction\",\n-                \"\\nReturn the raw transaction data.\\n\"\n+                \"Return the raw transaction data.\\n\\n\"\n \n-                \"\\nBy default, this call only returns a transaction if it is in the mempool. If -txindex is enabled\\n\"\n+                \"By default, this call only returns a transaction if it is in the mempool. If -txindex is enabled\\n\"\n                 \"and no blockhash argument is passed, it will return the transaction if it is in the mempool or any block.\\n\"\n                 \"If a blockhash argument is passed, it will return the transaction if\\n\"\n-                \"the specified block is available and the transaction is in that block.\\n\"\n-                \"\\nHint: Use gettransaction for wallet transactions.\\n\"\n+                \"the specified block is available and the transaction is in that block.\\n\\n\"\n+                \"Hint: Use gettransaction for wallet transactions.\\n\\n\"\n \n-                \"\\nIf verbose is 'true', returns an Object with information about 'txid'.\\n\"\n-                \"If verbose is 'false' or omitted, returns a string that is serialized, hex-encoded data for 'txid'.\\n\",\n+                \"If verbosity is 0 or omitted, returns a string that is serialized, hex-encoded data for transaction.\\n\"\n+                \"If verbosity is 1, returns an Object with information about transaction.\\n\"\n+                \"If verbosity is 2, returns an Object with information about transaction, including fee and prevout information.\",\n                 {\n                     {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n-                    {\"verbose\", RPCArg::Type::BOOL, RPCArg::Default{false}, \"If false, return a string, otherwise return a json object\"},\n+                    {\"verbosity|verbose\", RPCArg::Type::NUM, RPCArg::Default{0}, \"0 for hex-encoded data, 1 for a json object, and 2 for json object with fee and prevout\"},\n                     {\"blockhash\", RPCArg::Type::STR_HEX, RPCArg::Optional::OMITTED_NAMED_ARG, \"The block in which to look for the transaction\"},\n                 },\n                 {\n-                    RPCResult{\"if verbose is not set or set to false\",\n+                    RPCResult{\"if verbosity is not set or set to 0\",\n                          RPCResult::Type::STR, \"data\", \"The serialized, hex-encoded data for 'txid'\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798428888",
      "id" : 798428888,
      "line" : 145,
      "node_id" : "PRRC_kwDOABII584vlw7Y",
      "original_commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "original_line" : 145,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 61,
      "pull_request_review_id" : 871642356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798428888/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-03T14:29:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798428888",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798434880"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798434880"
         }
      },
      "author_association" : "NONE",
      "body" : "I think this is missing the \"desc\" output?\r\n```\r\n\"scriptPubKey\": {\r\n          \"asm\": \"0 7846ce1ced3253d8bd43008db2ca364cc722f5a2\",\r\n          \"desc\": \"addr(tb1q0prvu88dxffa302rqzxm9j3kfnrj9adzk49mlp)#57mlqnnp\",\r\n          \"hex\": \"00147846ce1ced3253d8bd43008db2ca364cc722f5a2\",\r\n          \"address\": \"tb1q0prvu88dxffa302rqzxm9j3kfnrj9adzk49mlp\",\r\n          \"type\": \"witness_v0_keyhash\"\r\n        }\r\n```",
      "commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "created_at" : "2022-02-03T10:44:41Z",
      "diff_hunk" : "@@ -192,13 +196,41 @@ static RPCHelpMan getrawtransaction()\n                              {RPCResult::Type::NUM, \"time\", /*optional=*/true, \"Same as \\\"blocktime\\\"\"},\n                         }\n                     },\n+                    RPCResult{\"for verbosity = 2\",\n+                        RPCResult::Type::OBJ, \"\", \"\",\n+                        {\n+                            {RPCResult::Type::ELISION, \"\", \"Same output as verbosity = 1\"},\n+                            {RPCResult::Type::NUM, \"fee\", /* optional */ true, \"transaction fee in \" + CURRENCY_UNIT + \", omitted if block undo data is not available\"},\n+                            {RPCResult::Type::ARR, \"vin\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ, \"\", /* optional */ true, \"utxo being spent, omitted if block undo data is not available\",\n+                                {\n+                                    {RPCResult::Type::ELISION, \"\", \"Same output as verbosity = 1\"},\n+                                    {RPCResult::Type::OBJ, \"prevout\", \"\",\n+                                    {\n+                                        {RPCResult::Type::BOOL, \"generated\", \"\"},\n+                                        {RPCResult::Type::NUM, \"value\", \"The value in \" + CURRENCY_UNIT},\n+                                        {RPCResult::Type::NUM, \"height\", \"previous block height\"},\n+                                        {RPCResult::Type::OBJ, \"scriptPubKey\", \"\",\n+                                        {\n+                                            {RPCResult::Type::STR, \"asm\", \"the asm\"},\n+                                            {RPCResult::Type::STR, \"hex\", \"the hex\"},\n+                                            {RPCResult::Type::STR, \"type\", \"The type, eg 'pubkeyhash'\"},\n+                                             {RPCResult::Type::STR, \"address\", /* optional */ true, \"The Bitcoin address (only if a well-defined address exists)\"},\n+                                        }},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798434880",
      "id" : 798434880,
      "line" : 220,
      "node_id" : "PRRC_kwDOABII584vlyZA",
      "original_commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "original_line" : 220,
      "original_position" : 94,
      "original_start_line" : 214,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 94,
      "pull_request_review_id" : 871642356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798434880/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 214,
      "start_side" : "RIGHT",
      "updated_at" : "2022-02-03T14:29:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798434880",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798441144"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798441144"
         }
      },
      "author_association" : "NONE",
      "body" : "Also nit: the actual results seem to be ordered somewhat differently: in my output `type` comes after `address`. Same for `height` and `value` in `prevout`.",
      "commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "created_at" : "2022-02-03T10:51:58Z",
      "diff_hunk" : "@@ -192,13 +196,41 @@ static RPCHelpMan getrawtransaction()\n                              {RPCResult::Type::NUM, \"time\", /*optional=*/true, \"Same as \\\"blocktime\\\"\"},\n                         }\n                     },\n+                    RPCResult{\"for verbosity = 2\",\n+                        RPCResult::Type::OBJ, \"\", \"\",\n+                        {\n+                            {RPCResult::Type::ELISION, \"\", \"Same output as verbosity = 1\"},\n+                            {RPCResult::Type::NUM, \"fee\", /* optional */ true, \"transaction fee in \" + CURRENCY_UNIT + \", omitted if block undo data is not available\"},\n+                            {RPCResult::Type::ARR, \"vin\", \"\",\n+                            {\n+                                {RPCResult::Type::OBJ, \"\", /* optional */ true, \"utxo being spent, omitted if block undo data is not available\",\n+                                {\n+                                    {RPCResult::Type::ELISION, \"\", \"Same output as verbosity = 1\"},\n+                                    {RPCResult::Type::OBJ, \"prevout\", \"\",\n+                                    {\n+                                        {RPCResult::Type::BOOL, \"generated\", \"\"},\n+                                        {RPCResult::Type::NUM, \"value\", \"The value in \" + CURRENCY_UNIT},\n+                                        {RPCResult::Type::NUM, \"height\", \"previous block height\"},\n+                                        {RPCResult::Type::OBJ, \"scriptPubKey\", \"\",\n+                                        {\n+                                            {RPCResult::Type::STR, \"asm\", \"the asm\"},\n+                                            {RPCResult::Type::STR, \"hex\", \"the hex\"},\n+                                            {RPCResult::Type::STR, \"type\", \"The type, eg 'pubkeyhash'\"},\n+                                             {RPCResult::Type::STR, \"address\", /* optional */ true, \"The Bitcoin address (only if a well-defined address exists)\"},\n+                                        }},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798441144",
      "id" : 798441144,
      "in_reply_to_id" : 798434880,
      "line" : 220,
      "node_id" : "PRRC_kwDOABII584vlz64",
      "original_commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "original_line" : 220,
      "original_position" : 94,
      "original_start_line" : 214,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 94,
      "pull_request_review_id" : 871642356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798441144/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 214,
      "start_side" : "RIGHT",
      "updated_at" : "2022-02-03T14:29:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798441144",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798447256"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798447256"
         }
      },
      "author_association" : "NONE",
      "body" : "You should include the `<optional>` [header](https://en.cppreference.com/w/cpp/utility/optional) now",
      "commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "created_at" : "2022-02-03T10:59:24Z",
      "diff_hunk" : "@@ -256,13 +292,37 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, errmsg + \". Use gettransaction for wallet transactions.\");\n     }\n \n-    if (!fVerbose) {\n+    if (verbosity == 0) {\n         return EncodeHexTx(*tx, RPCSerializationFlags());\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    if (blockindex) {\n+        result.pushKV(\"in_active_chain\", in_active_chain);\n+    }\n+\n+    std::optional<size_t> opt_tx_position{std::nullopt};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798447256",
      "id" : 798447256,
      "line" : 304,
      "node_id" : "PRRC_kwDOABII584vl1aY",
      "original_commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "original_line" : 304,
      "original_position" : 149,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 149,
      "pull_request_review_id" : 871642356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798447256/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-03T14:29:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798447256",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798453369"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798453369"
         }
      },
      "author_association" : "NONE",
      "body" : "Would it be possible to reduce your lock usage by only locking during the `IsBlockPruned` operation?\r\nAt first sight I think this would work:\r\n```suggestion\r\n        const bool is_block_pruned {WITH_LOCK(cs_main, return IsBlockPruned(blockindex))};\r\n        if (verbosity == 1 || tx->IsCoinBase() || !blockindex || is_block_pruned ||\r\n            !(UndoReadFromDisk(blockUndo, blockindex) && ReadBlockFromDisk(block, blockindex, Params().GetConsensus()))) {\r\n            TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\r\n            return result;\r\n        }\r\n```\r\n",
      "commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "created_at" : "2022-02-03T11:07:21Z",
      "diff_hunk" : "@@ -256,13 +292,37 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, errmsg + \". Use gettransaction for wallet transactions.\");\n     }\n \n-    if (!fVerbose) {\n+    if (verbosity == 0) {\n         return EncodeHexTx(*tx, RPCSerializationFlags());\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    if (blockindex) {\n+        result.pushKV(\"in_active_chain\", in_active_chain);\n+    }\n+\n+    std::optional<size_t> opt_tx_position{std::nullopt};\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+\n+    {\n+        LOCK(cs_main);\n+        if (verbosity == 1 || tx->IsCoinBase() ||\n+            !blockindex || IsBlockPruned(blockindex) ||\n+            !(UndoReadFromDisk(blockUndo, blockindex) && ReadBlockFromDisk(block, blockindex, Params().GetConsensus()))) {\n+            TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+            return result;\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798453369",
      "id" : 798453369,
      "line" : 315,
      "node_id" : "PRRC_kwDOABII584vl255",
      "original_commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "original_line" : 315,
      "original_position" : 160,
      "original_start_line" : 309,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 160,
      "pull_request_review_id" : 871642356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798453369/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 309,
      "start_side" : "RIGHT",
      "updated_at" : "2022-02-03T14:29:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798453369",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798515350"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798515350"
         }
      },
      "author_association" : "NONE",
      "body" : "This declaration could also be moved down a few lines to right before it is used. Or, if you incorporate my other comment to use `find_if`, this line can be removed entirely (as can including the `<optional>` header)",
      "commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "created_at" : "2022-02-03T12:30:33Z",
      "diff_hunk" : "@@ -256,13 +292,37 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, errmsg + \". Use gettransaction for wallet transactions.\");\n     }\n \n-    if (!fVerbose) {\n+    if (verbosity == 0) {\n         return EncodeHexTx(*tx, RPCSerializationFlags());\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    if (blockindex) {\n+        result.pushKV(\"in_active_chain\", in_active_chain);\n+    }\n+\n+    std::optional<size_t> opt_tx_position{std::nullopt};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798515350",
      "id" : 798515350,
      "in_reply_to_id" : 798447256,
      "line" : 304,
      "node_id" : "PRRC_kwDOABII584vmGCW",
      "original_commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "original_line" : 304,
      "original_position" : 149,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 149,
      "pull_request_review_id" : 871642356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798515350/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-03T14:29:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798515350",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798518924"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798518924"
         }
      },
      "author_association" : "NONE",
      "body" : "Suggested change to avoid the manual iteration and to simplify the `TxToJSON` call. I think it's slightly easier to follow, but I don't have a strong opinion either way.\r\n```suggestion\r\n    CTxUndo* undo {nullptr};\r\n    auto it = std::find_if(block.vtx.begin(), block.vtx.end(), [tx](CTransactionRef t){ return *t == *tx; });\r\n    if (it != block.vtx.end()) {\r\n        // -1 as blockundo does not have coinbase tx\r\n        undo = &blockUndo.vtxundo.at(it - block.vtx.begin() - 1);\r\n    }\r\n    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate(), undo, TxVerbosity::SHOW_DETAILS_AND_PREVOUT);\r\n    return result;\r\n```",
      "commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "created_at" : "2022-02-03T12:35:12Z",
      "diff_hunk" : "@@ -256,13 +292,37 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, errmsg + \". Use gettransaction for wallet transactions.\");\n     }\n \n-    if (!fVerbose) {\n+    if (verbosity == 0) {\n         return EncodeHexTx(*tx, RPCSerializationFlags());\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    if (blockindex) {\n+        result.pushKV(\"in_active_chain\", in_active_chain);\n+    }\n+\n+    std::optional<size_t> opt_tx_position{std::nullopt};\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+\n+    {\n+        LOCK(cs_main);\n+        if (verbosity == 1 || tx->IsCoinBase() ||\n+            !blockindex || IsBlockPruned(blockindex) ||\n+            !(UndoReadFromDisk(blockUndo, blockindex) && ReadBlockFromDisk(block, blockindex, Params().GetConsensus()))) {\n+            TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+            return result;\n+        }\n+    }\n+    for (size_t i = 0; i < block.vtx.size(); ++i) {\n+        const CTransactionRef t = block.vtx.at(i);\n+        if (*t == *tx) {\n+            // blockundo does not have coinbase tx\n+            opt_tx_position = std::optional<size_t>{i-1};\n+            break;\n+        }\n+    }\n+    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate(), opt_tx_position ? &blockUndo.vtxundo.at(*opt_tx_position) : nullptr, TxVerbosity::SHOW_DETAILS_AND_PREVOUT);\n     return result;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798518924",
      "id" : 798518924,
      "line" : 326,
      "node_id" : "PRRC_kwDOABII584vmG6M",
      "original_commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "original_line" : 326,
      "original_position" : 171,
      "original_start_line" : 317,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 171,
      "pull_request_review_id" : 871642356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798518924/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 317,
      "start_side" : "RIGHT",
      "updated_at" : "2022-02-03T14:29:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798518924",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798571801"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798571801"
         }
      },
      "author_association" : "NONE",
      "body" : "As per my other comment, I think `desc` should be added here too?",
      "commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "created_at" : "2022-02-03T13:39:27Z",
      "diff_hunk" : "@@ -178,6 +182,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.nodes[2].sendtoaddress(self.nodes[1].getnewaddress(), 1)\n+        [block1] = self.generate(self.nodes[2], 1)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight'\n+        ]\n+        prevout_fields = [\n+            'generated',\n+            'height',\n+            'value',\n+            'scriptPubKey'\n+        ]\n+        script_pub_key_fields = [",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798571801",
      "id" : 798571801,
      "line" : 210,
      "node_id" : "PRRC_kwDOABII584vmT0Z",
      "original_commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "original_line" : 210,
      "original_position" : 77,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 77,
      "pull_request_review_id" : 871642356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798571801/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-03T14:29:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798571801",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798593527"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798593527"
         }
      },
      "author_association" : "NONE",
      "body" : "Now these assertions are repeated for every `f in fields`, I think you want to decrease the indentation?",
      "commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "created_at" : "2022-02-03T14:03:03Z",
      "diff_hunk" : "@@ -178,6 +182,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.nodes[2].sendtoaddress(self.nodes[1].getnewaddress(), 1)\n+        [block1] = self.generate(self.nodes[2], 1)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight'\n+        ]\n+        prevout_fields = [\n+            'generated',\n+            'height',\n+            'value',\n+            'scriptPubKey'\n+        ]\n+        script_pub_key_fields = [\n+            'address',\n+            'asm',\n+            'hex',\n+            'type'\n+        ]\n+        for n in [0, 3]:\n+            for v in [1,2]:\n+                self.log.info(f\"Test getrawtransaction_verbosity {v} {'with' if n == 0 else 'without'} -txindex, with blockhash\")\n+                gottx = self.nodes[n].getrawtransaction(txid=tx, verbosity=v, blockhash=block1)\n+                for f in fields:\n+                    if f not in gottx:\n+                        raise AssertionError(f\"field {f} is not in transaction\")\n+                    if v == 1:\n+                        assert('fee' not in gottx)\n+                        assert(len(gottx['vin']) > 0)\n+                        assert('prevout' not in gottx['vin'][0])\n+                    if v == 2:\n+                        assert('fee' in gottx)\n+                        assert(isinstance(gottx['fee'], Decimal))\n+                        assert(len(gottx['vin']) > 0)\n+                        assert('prevout' in gottx['vin'][0])\n+                        prevout = gottx['vin'][0]['prevout']\n+                        for prevout_field in prevout_fields:\n+                            if prevout_field not in prevout:\n+                                raise AssertionError(f\"field {prevout_field} is not in transaction prevout {prevout}\")\n+                        script_pub_key = prevout['scriptPubKey']\n+                        for script_field in script_pub_key_fields:\n+                            if script_field not in script_pub_key:\n+                                raise AssertionError(f\"field {script_field} is not in transaction scriptPubKey {script_pub_key}\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798593527",
      "id" : 798593527,
      "line" : 239,
      "node_id" : "PRRC_kwDOABII584vmZH3",
      "original_commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "original_line" : 239,
      "original_position" : 106,
      "original_start_line" : 223,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 106,
      "pull_request_review_id" : 871642356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798593527/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 223,
      "start_side" : "RIGHT",
      "updated_at" : "2022-02-03T14:29:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798593527",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798594551"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798594551"
         }
      },
      "author_association" : "NONE",
      "body" : "This is not specific to `if v == 1` so I'd move it up one level and remove the duplication from `if v == 2:`",
      "commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "created_at" : "2022-02-03T14:04:11Z",
      "diff_hunk" : "@@ -178,6 +182,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.nodes[2].sendtoaddress(self.nodes[1].getnewaddress(), 1)\n+        [block1] = self.generate(self.nodes[2], 1)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight'\n+        ]\n+        prevout_fields = [\n+            'generated',\n+            'height',\n+            'value',\n+            'scriptPubKey'\n+        ]\n+        script_pub_key_fields = [\n+            'address',\n+            'asm',\n+            'hex',\n+            'type'\n+        ]\n+        for n in [0, 3]:\n+            for v in [1,2]:\n+                self.log.info(f\"Test getrawtransaction_verbosity {v} {'with' if n == 0 else 'without'} -txindex, with blockhash\")\n+                gottx = self.nodes[n].getrawtransaction(txid=tx, verbosity=v, blockhash=block1)\n+                for f in fields:\n+                    if f not in gottx:\n+                        raise AssertionError(f\"field {f} is not in transaction\")\n+                    if v == 1:\n+                        assert('fee' not in gottx)\n+                        assert(len(gottx['vin']) > 0)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798594551",
      "id" : 798594551,
      "line" : 225,
      "node_id" : "PRRC_kwDOABII584vmZX3",
      "original_commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "original_line" : 225,
      "original_position" : 92,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 92,
      "pull_request_review_id" : 871642356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798594551/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-03T14:29:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798594551",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798601426"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798601426"
         }
      },
      "author_association" : "NONE",
      "body" : "If you do a set comparison you can catch all missing fields in one run, as opposed to potentially having to rerun the test multiple times. The same applies to the other comparisons further down.\r\n```suggestion\r\n                missing_fields = set(fields).difference(gottx.keys())\r\n                if missing_fields:\r\n                    raise AssertionError(f\"fields {', '.join(missing_fields)} are not in transaction\")\r\n```",
      "commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "created_at" : "2022-02-03T14:11:23Z",
      "diff_hunk" : "@@ -178,6 +182,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.nodes[2].sendtoaddress(self.nodes[1].getnewaddress(), 1)\n+        [block1] = self.generate(self.nodes[2], 1)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight'\n+        ]\n+        prevout_fields = [\n+            'generated',\n+            'height',\n+            'value',\n+            'scriptPubKey'\n+        ]\n+        script_pub_key_fields = [\n+            'address',\n+            'asm',\n+            'hex',\n+            'type'\n+        ]\n+        for n in [0, 3]:\n+            for v in [1,2]:\n+                self.log.info(f\"Test getrawtransaction_verbosity {v} {'with' if n == 0 else 'without'} -txindex, with blockhash\")\n+                gottx = self.nodes[n].getrawtransaction(txid=tx, verbosity=v, blockhash=block1)\n+                for f in fields:\n+                    if f not in gottx:\n+                        raise AssertionError(f\"field {f} is not in transaction\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798601426",
      "id" : 798601426,
      "line" : 222,
      "node_id" : "PRRC_kwDOABII584vmbDS",
      "original_commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "original_line" : 222,
      "original_position" : 89,
      "original_start_line" : 220,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 89,
      "pull_request_review_id" : 871642356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798601426/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 220,
      "start_side" : "RIGHT",
      "updated_at" : "2022-02-03T14:29:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798601426",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798606529"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798606529"
         }
      },
      "author_association" : "NONE",
      "body" : "nit: In Python, it's recommended to add trailing commas on multiline lists to minimize the git diff when new items are added later on.\r\n```suggestion\r\n            'weight',\r\n```",
      "commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "created_at" : "2022-02-03T14:16:47Z",
      "diff_hunk" : "@@ -178,6 +182,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.nodes[2].sendtoaddress(self.nodes[1].getnewaddress(), 1)\n+        [block1] = self.generate(self.nodes[2], 1)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight'",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r798606529",
      "id" : 798606529,
      "line" : 202,
      "node_id" : "PRRC_kwDOABII584vmcTB",
      "original_commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "original_line" : 202,
      "original_position" : 69,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 69,
      "pull_request_review_id" : 871642356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798606529/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-03T14:29:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/798606529",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-03-03T18:39:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-1058366082",
      "id" : 1058366082,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII584_FWKC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1058366082/reactions"
      },
      "updated_at" : "2022-03-03T18:39:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1058366082",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r820118775"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/820118775"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I like, this is more elegant.",
      "commit_id" : "0f68fab2c6158f8f0c50770a274b0b83f2cb59b4",
      "created_at" : "2022-03-05T15:53:18Z",
      "diff_hunk" : "@@ -256,13 +292,37 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, errmsg + \". Use gettransaction for wallet transactions.\");\n     }\n \n-    if (!fVerbose) {\n+    if (verbosity == 0) {\n         return EncodeHexTx(*tx, RPCSerializationFlags());\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    if (blockindex) {\n+        result.pushKV(\"in_active_chain\", in_active_chain);\n+    }\n+\n+    std::optional<size_t> opt_tx_position{std::nullopt};\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+\n+    {\n+        LOCK(cs_main);\n+        if (verbosity == 1 || tx->IsCoinBase() ||\n+            !blockindex || IsBlockPruned(blockindex) ||\n+            !(UndoReadFromDisk(blockUndo, blockindex) && ReadBlockFromDisk(block, blockindex, Params().GetConsensus()))) {\n+            TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+            return result;\n+        }\n+    }\n+    for (size_t i = 0; i < block.vtx.size(); ++i) {\n+        const CTransactionRef t = block.vtx.at(i);\n+        if (*t == *tx) {\n+            // blockundo does not have coinbase tx\n+            opt_tx_position = std::optional<size_t>{i-1};\n+            break;\n+        }\n+    }\n+    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate(), opt_tx_position ? &blockUndo.vtxundo.at(*opt_tx_position) : nullptr, TxVerbosity::SHOW_DETAILS_AND_PREVOUT);\n     return result;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r820118775",
      "id" : 820118775,
      "in_reply_to_id" : 798518924,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584w4gT3",
      "original_commit_id" : "02ed9b997b45ef2a9d8eff9d73e0dbf15fa7a531",
      "original_line" : 324,
      "original_position" : 171,
      "original_start_line" : 317,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : null,
      "pull_request_review_id" : 900986008,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/820118775/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2022-03-05T15:53:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/820118775",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-03-31T07:22:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-1084193419",
      "id" : 1084193419,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII585An3qL",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1084193419/reactions"
      },
      "updated_at" : "2022-03-31T07:22:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1084193419",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-03-31T15:49:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-1084772535",
      "id" : 1084772535,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII585AqFC3",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1084772535/reactions"
      },
      "updated_at" : "2022-03-31T15:49:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1084772535",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r847890268"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/847890268"
         }
      },
      "author_association" : "NONE",
      "body" : "Specifying a negative verbosity level fallbacks to 2 instead of 0.\r\n```suggestion\r\n    if (verbosity <= 0) {\r\n```",
      "commit_id" : "58a638f77b4d9d69b64cd4e3eb9ff8da79f465c7",
      "created_at" : "2022-04-12T02:32:27Z",
      "diff_hunk" : "@@ -263,13 +300,33 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, errmsg + \". Use gettransaction for wallet transactions.\");\n     }\n \n-    if (!fVerbose) {\n+    if (verbosity == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r847890268",
      "id" : 847890268,
      "line" : 303,
      "node_id" : "PRRC_kwDOABII584yicdc",
      "original_commit_id" : "58a638f77b4d9d69b64cd4e3eb9ff8da79f465c7",
      "original_line" : 303,
      "original_position" : 139,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 139,
      "pull_request_review_id" : 938806523,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/847890268/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-12T02:32:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/847890268",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r848305307"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/848305307"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n            verbosity = request.params[1].get_bool();\r\n```",
      "commit_id" : "58a638f77b4d9d69b64cd4e3eb9ff8da79f465c7",
      "created_at" : "2022-04-12T11:03:33Z",
      "diff_hunk" : "@@ -221,10 +254,14 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"The genesis block coinbase is not considered an ordinary transaction and cannot be retrieved\");\n     }\n \n-    // Accept either a bool (true) or a num (>=1) to indicate verbose output.\n-    bool fVerbose = false;\n+    // Accept either a bool (true) or a num (>=0) to indicate verbosity.\n+    int verbosity{0};\n     if (!request.params[1].isNull()) {\n-        fVerbose = request.params[1].isNum() ? (request.params[1].get_int() != 0) : request.params[1].get_bool();\n+        if (request.params[1].isBool()) {\n+            verbosity = request.params[1].get_bool() ? 1 : 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r848305307",
      "id" : 848305307,
      "line" : 261,
      "node_id" : "PRRC_kwDOABII584ykByb",
      "original_commit_id" : "58a638f77b4d9d69b64cd4e3eb9ff8da79f465c7",
      "original_line" : 261,
      "original_position" : 127,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 127,
      "pull_request_review_id" : 939359557,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/848305307/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-12T11:06:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/848305307",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r848305667"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/848305667"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    const bool is_block_pruned{WITH_LOCK(cs_main, return IsBlockPruned(blockindex))};\r\n```\r\n(don't hesitate to run clang-format on your changes)",
      "commit_id" : "58a638f77b4d9d69b64cd4e3eb9ff8da79f465c7",
      "created_at" : "2022-04-12T11:04:02Z",
      "diff_hunk" : "@@ -263,13 +300,33 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, errmsg + \". Use gettransaction for wallet transactions.\");\n     }\n \n-    if (!fVerbose) {\n+    if (verbosity == 0) {\n         return EncodeHexTx(*tx, RPCSerializationFlags());\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    if (blockindex) {\n+        result.pushKV(\"in_active_chain\", in_active_chain);\n+    }\n+\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+    const bool is_block_pruned {WITH_LOCK(cs_main, return IsBlockPruned(blockindex))};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r848305667",
      "id" : 848305667,
      "line" : 314,
      "node_id" : "PRRC_kwDOABII584ykB4D",
      "original_commit_id" : "58a638f77b4d9d69b64cd4e3eb9ff8da79f465c7",
      "original_line" : 314,
      "original_position" : 152,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 152,
      "pull_request_review_id" : 939359557,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/848305667/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-12T11:06:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/848305667",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r848307093"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/848307093"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```diff\r\n from collections import OrderedDict\r\n from decimal import Decimal\r\n+from itertools import product\r\n \r\n@@ -213,30 +214,29 @@ class RawTransactionsTest(BitcoinTestFramework):\r\n-        for n in [0, 3]:\r\n-            for v in [1,2]:\r\n+        for n, v in product([0, 3], [1, 2]):\r\n```\r\n(and reduce indentation in the for-loop scope by four spaces)",
      "commit_id" : "58a638f77b4d9d69b64cd4e3eb9ff8da79f465c7",
      "created_at" : "2022-04-12T11:05:37Z",
      "diff_hunk" : "@@ -178,6 +182,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.nodes[2].sendtoaddress(self.nodes[1].getnewaddress(), 1)\n+        [block1] = self.generate(self.nodes[2], 1)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight',\n+        ]\n+        prevout_fields = [\n+            'generated',\n+            'height',\n+            'value',\n+            'scriptPubKey',\n+        ]\n+        script_pub_key_fields = [\n+            'address',\n+            'asm',\n+            'hex',\n+            'type',\n+        ]\n+        for n in [0, 3]:\n+            for v in [1,2]:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r848307093",
      "id" : 848307093,
      "line" : 217,
      "node_id" : "PRRC_kwDOABII584ykCOV",
      "original_commit_id" : "58a638f77b4d9d69b64cd4e3eb9ff8da79f465c7",
      "original_line" : 217,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 84,
      "pull_request_review_id" : 939359557,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/848307093/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-12T11:06:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/848307093",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r854942036"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/854942036"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Every time I do clang-format on this file, it changes a lot of things that we do not want. \r\nI did change this line though.",
      "commit_id" : "44900c33c7b9326bf88286a5bc7e6e9fc9a1cecd",
      "created_at" : "2022-04-21T08:50:03Z",
      "diff_hunk" : "@@ -263,13 +300,33 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, errmsg + \". Use gettransaction for wallet transactions.\");\n     }\n \n-    if (!fVerbose) {\n+    if (verbosity == 0) {\n         return EncodeHexTx(*tx, RPCSerializationFlags());\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    if (blockindex) {\n+        result.pushKV(\"in_active_chain\", in_active_chain);\n+    }\n+\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+    const bool is_block_pruned {WITH_LOCK(cs_main, return IsBlockPruned(blockindex))};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r854942036",
      "id" : 854942036,
      "in_reply_to_id" : 848305667,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584y9WFU",
      "original_commit_id" : "58a638f77b4d9d69b64cd4e3eb9ff8da79f465c7",
      "original_line" : 314,
      "original_position" : 152,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : null,
      "pull_request_review_id" : 948277024,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/854942036/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-21T08:50:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/854942036",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r854942441"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/854942441"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Change. I also added a comment to indicate intent of the loop. ",
      "commit_id" : "44900c33c7b9326bf88286a5bc7e6e9fc9a1cecd",
      "created_at" : "2022-04-21T08:50:28Z",
      "diff_hunk" : "@@ -178,6 +182,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.nodes[2].sendtoaddress(self.nodes[1].getnewaddress(), 1)\n+        [block1] = self.generate(self.nodes[2], 1)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight',\n+        ]\n+        prevout_fields = [\n+            'generated',\n+            'height',\n+            'value',\n+            'scriptPubKey',\n+        ]\n+        script_pub_key_fields = [\n+            'address',\n+            'asm',\n+            'hex',\n+            'type',\n+        ]\n+        for n in [0, 3]:\n+            for v in [1,2]:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r854942441",
      "id" : 854942441,
      "in_reply_to_id" : 848307093,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584y9WLp",
      "original_commit_id" : "58a638f77b4d9d69b64cd4e3eb9ff8da79f465c7",
      "original_line" : 217,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : null,
      "pull_request_review_id" : 948277530,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/854942441/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-21T08:50:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/854942441",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r855144343"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/855144343"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It is possible to run clang-format on your changes only: https://github.com/bitcoin/bitcoin/tree/master/contrib/devtools#clang-format-diffpy ",
      "commit_id" : "44900c33c7b9326bf88286a5bc7e6e9fc9a1cecd",
      "created_at" : "2022-04-21T12:43:59Z",
      "diff_hunk" : "@@ -263,13 +300,33 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, errmsg + \". Use gettransaction for wallet transactions.\");\n     }\n \n-    if (!fVerbose) {\n+    if (verbosity == 0) {\n         return EncodeHexTx(*tx, RPCSerializationFlags());\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    if (blockindex) {\n+        result.pushKV(\"in_active_chain\", in_active_chain);\n+    }\n+\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+    const bool is_block_pruned {WITH_LOCK(cs_main, return IsBlockPruned(blockindex))};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r855144343",
      "id" : 855144343,
      "in_reply_to_id" : 848305667,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584y-HeX",
      "original_commit_id" : "58a638f77b4d9d69b64cd4e3eb9ff8da79f465c7",
      "original_line" : 314,
      "original_position" : 152,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : null,
      "pull_request_review_id" : 948565433,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/855144343/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-21T12:43:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/855144343",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-05-19T16:40:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-1131944646",
      "id" : 1131944646,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII585DeBrG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1131944646/reactions"
      },
      "updated_at" : "2022-05-19T16:40:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1131944646",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-05-30T15:26:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-1141279817",
      "id" : 1141279817,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII585EBoxJ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1141279817/reactions"
      },
      "updated_at" : "2022-05-30T15:26:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1141279817",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-07-19T08:39:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-1188767263",
      "id" : 1188767263,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII585G2yYf",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1188767263/reactions"
      },
      "updated_at" : "2022-07-19T08:39:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1188767263",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "rebased",
      "created_at" : "2022-08-16T17:14:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-1216922764",
      "id" : 1216922764,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII585IiMSM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1216922764/reactions"
      },
      "updated_at" : "2022-08-16T17:14:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1216922764",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r947223593"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/947223593"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Typo?\r\n\r\n```suggestion\r\n            verbosity = request.params[1].get_bool();\r\n```",
      "commit_id" : "a19823c72c452a2bc563760c65550ad27c4e9c8f",
      "created_at" : "2022-08-16T20:30:39Z",
      "diff_hunk" : "@@ -220,10 +253,14 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"The genesis block coinbase is not considered an ordinary transaction and cannot be retrieved\");\n     }\n \n-    // Accept either a bool (true) or a num (>=1) to indicate verbose output.\n-    bool fVerbose = false;\n+    // Accept either a bool (true) or a num (>=0) to indicate verbosity.\n+    int verbosity{0};\n     if (!request.params[1].isNull()) {\n-        fVerbose = request.params[1].isNum() ? (request.params[1].getInt<int>() != 0) : request.params[1].get_bool();\n+        if (request.params[1].isBool()) {\n+            verbosity = verbosity = request.params[1].get_bool();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r947223593",
      "id" : 947223593,
      "line" : 260,
      "node_id" : "PRRC_kwDOABII5844dXwp",
      "original_commit_id" : "a19823c72c452a2bc563760c65550ad27c4e9c8f",
      "original_line" : 260,
      "original_position" : 124,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 124,
      "pull_request_review_id" : 1074740029,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/947223593/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-16T20:31:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/947223593",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/42201?v=4",
         "events_url" : "https://api.github.com/users/prusnak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prusnak/followers",
         "following_url" : "https://api.github.com/users/prusnak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prusnak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prusnak",
         "id" : 42201,
         "login" : "prusnak",
         "node_id" : "MDQ6VXNlcjQyMjAx",
         "organizations_url" : "https://api.github.com/users/prusnak/orgs",
         "received_events_url" : "https://api.github.com/users/prusnak/received_events",
         "repos_url" : "https://api.github.com/users/prusnak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prusnak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prusnak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prusnak"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r950342593"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/950342593"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Must of missed this when I rebased. Fixed now. ",
      "commit_id" : "cc44ed12b1ad9df6ddcba914e833d0031e61f7e8",
      "created_at" : "2022-08-19T15:54:21Z",
      "diff_hunk" : "@@ -220,10 +253,14 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"The genesis block coinbase is not considered an ordinary transaction and cannot be retrieved\");\n     }\n \n-    // Accept either a bool (true) or a num (>=1) to indicate verbose output.\n-    bool fVerbose = false;\n+    // Accept either a bool (true) or a num (>=0) to indicate verbosity.\n+    int verbosity{0};\n     if (!request.params[1].isNull()) {\n-        fVerbose = request.params[1].isNum() ? (request.params[1].getInt<int>() != 0) : request.params[1].get_bool();\n+        if (request.params[1].isBool()) {\n+            verbosity = verbosity = request.params[1].get_bool();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r950342593",
      "id" : 950342593,
      "in_reply_to_id" : 947223593,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5844pRPB",
      "original_commit_id" : "a19823c72c452a2bc563760c65550ad27c4e9c8f",
      "original_line" : 260,
      "original_position" : 124,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : null,
      "pull_request_review_id" : 1079037894,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/950342593/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-19T15:54:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/950342593",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-09-13T16:36:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-1245665205",
      "id" : 1245665205,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII585KP1e1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1245665205/reactions"
      },
      "updated_at" : "2022-09-13T16:36:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1245665205",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-09-21T11:16:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-1253557557",
      "id" : 1253557557,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII585Kt8U1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1253557557/reactions"
      },
      "updated_at" : "2022-09-21T11:16:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1253557557",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r986754326"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/986754326"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It seems if `verbosity==2` and `!blockindex` this will trigger and we won't get the `fee` and `prevout` fields even when `g_txindex` is available.. Is this expected behavior?",
      "commit_id" : "eae8f8e66621b75776a4a9bb5d8224c7320f89e4",
      "created_at" : "2022-10-04T11:33:29Z",
      "diff_hunk" : "@@ -262,13 +299,33 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, errmsg + \". Use gettransaction for wallet transactions.\");\n     }\n \n-    if (!fVerbose) {\n+    if (verbosity <= 0) {\n         return EncodeHexTx(*tx, RPCSerializationFlags());\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    if (blockindex) {\n+        result.pushKV(\"in_active_chain\", in_active_chain);\n+    }\n+\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+    const bool is_block_pruned{WITH_LOCK(cs_main, return chainman.m_blockman.IsBlockPruned(blockindex))};\n+\n+    if (verbosity == 1 || tx->IsCoinBase() ||\n+        !blockindex || is_block_pruned ||",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r986754326",
      "id" : 986754326,
      "line" : 316,
      "node_id" : "PRRC_kwDOABII58460K0W",
      "original_commit_id" : "eae8f8e66621b75776a4a9bb5d8224c7320f89e4",
      "original_line" : 316,
      "original_position" : 152,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 152,
      "pull_request_review_id" : 1129764287,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/986754326/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-10-04T11:41:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/986754326",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r986755937"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/986755937"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Could be useful to add cases without blockhash and affirm all the blockhash related expected behaviors.. ",
      "commit_id" : "eae8f8e66621b75776a4a9bb5d8224c7320f89e4",
      "created_at" : "2022-10-04T11:35:08Z",
      "diff_hunk" : "@@ -170,6 +175,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.wallet.send_self_transfer(from_node=self.nodes[1])['txid']\n+        [block1] = self.generate(self.nodes[1], 1)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight',\n+        ]\n+        prevout_fields = [\n+            'generated',\n+            'height',\n+            'value',\n+            'scriptPubKey',\n+        ]\n+        script_pub_key_fields = [\n+            'address',\n+            'asm',\n+            'hex',\n+            'type',\n+        ]\n+        # node 0 & 3 with verbosity 1 & 2\n+        for n, v in product([0, 2], [1, 2]):\n+            self.log.info(f\"Test getrawtransaction_verbosity {v} {'with' if n == 0 else 'without'} -txindex, with blockhash\")\n+            gottx = self.nodes[n].getrawtransaction(txid=tx, verbosity=v, blockhash=block1)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r986755937",
      "id" : 986755937,
      "line" : 212,
      "node_id" : "PRRC_kwDOABII58460LNh",
      "original_commit_id" : "eae8f8e66621b75776a4a9bb5d8224c7320f89e4",
      "original_line" : 212,
      "original_position" : 94,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 94,
      "pull_request_review_id" : 1129764287,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/986755937/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-10-04T11:41:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/986755937",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r986759500"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/986759500"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I reproduced the no `blockhash` and `v=2` situation and confirmed that it doesn't produce `fee` and `prevout` fields.\r\n```suggestion\r\n         for n, v in product([0, 2], [1, 2]):\r\n            self.log.info(f\"Test getrawtransaction_verbosity {v} {'with' if n == 0 else 'without'} -txindex, with blockhash\")\r\n            if v == 2 and n == 0:\r\n                gottx = self.nodes[n].getrawtransaction(txid=tx, verbosity=v)\r\n                self.log.info(f\"Tx data for -v=2 -txindex -noblockhash {gottx}\")\r\n                assert('fee' not in gottx)\r\n                assert('prevout' not in gottx)\r\n```",
      "commit_id" : "eae8f8e66621b75776a4a9bb5d8224c7320f89e4",
      "created_at" : "2022-10-04T11:38:34Z",
      "diff_hunk" : "@@ -170,6 +175,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.wallet.send_self_transfer(from_node=self.nodes[1])['txid']\n+        [block1] = self.generate(self.nodes[1], 1)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight',\n+        ]\n+        prevout_fields = [\n+            'generated',\n+            'height',\n+            'value',\n+            'scriptPubKey',\n+        ]\n+        script_pub_key_fields = [\n+            'address',\n+            'asm',\n+            'hex',\n+            'type',\n+        ]\n+        # node 0 & 3 with verbosity 1 & 2\n+        for n, v in product([0, 2], [1, 2]):\n+            self.log.info(f\"Test getrawtransaction_verbosity {v} {'with' if n == 0 else 'without'} -txindex, with blockhash\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r986759500",
      "id" : 986759500,
      "line" : 211,
      "node_id" : "PRRC_kwDOABII58460MFM",
      "original_commit_id" : "eae8f8e66621b75776a4a9bb5d8224c7320f89e4",
      "original_line" : 211,
      "original_position" : 93,
      "original_start_line" : 210,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 93,
      "pull_request_review_id" : 1129764287,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/986759500/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 210,
      "start_side" : "RIGHT",
      "updated_at" : "2022-10-04T11:41:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/986759500",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r987083890"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/987083890"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\nstatic void TxToJSON(const CTransaction& tx, const uint256& hashBlock, UniValue& entry, Chainstate& active_chainstate, const CTxUndo* txundo = nullptr, TxVerbosity verbosity = TxVerbosity::SHOW_TXID)\r\n```",
      "commit_id" : "eae8f8e66621b75776a4a9bb5d8224c7320f89e4",
      "created_at" : "2022-10-04T16:10:54Z",
      "diff_hunk" : "@@ -50,15 +51,17 @@ using node::FindCoins;\n using node::GetTransaction;\n using node::NodeContext;\n using node::PSBTAnalysis;\n+using node::ReadBlockFromDisk;\n+using node::UndoReadFromDisk;\n \n-static void TxToJSON(const CTransaction& tx, const uint256 hashBlock, UniValue& entry, Chainstate& active_chainstate)\n+static void TxToJSON(const CTransaction& tx, const uint256 hashBlock, UniValue& entry, Chainstate& active_chainstate, const CTxUndo* txundo = nullptr, TxVerbosity verbosity = TxVerbosity::SHOW_TXID)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r987083890",
      "id" : 987083890,
      "line" : 57,
      "node_id" : "PRRC_kwDOABII58461bRy",
      "original_commit_id" : "eae8f8e66621b75776a4a9bb5d8224c7320f89e4",
      "original_line" : 57,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 16,
      "pull_request_review_id" : 1130254716,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/987083890/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-10-04T16:31:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/987083890",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r987103167"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/987103167"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`f` is unused, I think you can remove the loop",
      "commit_id" : "eae8f8e66621b75776a4a9bb5d8224c7320f89e4",
      "created_at" : "2022-10-04T16:30:33Z",
      "diff_hunk" : "@@ -170,6 +175,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.wallet.send_self_transfer(from_node=self.nodes[1])['txid']\n+        [block1] = self.generate(self.nodes[1], 1)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight',\n+        ]\n+        prevout_fields = [\n+            'generated',\n+            'height',\n+            'value',\n+            'scriptPubKey',\n+        ]\n+        script_pub_key_fields = [\n+            'address',\n+            'asm',\n+            'hex',\n+            'type',\n+        ]\n+        # node 0 & 3 with verbosity 1 & 2\n+        for n, v in product([0, 2], [1, 2]):\n+            self.log.info(f\"Test getrawtransaction_verbosity {v} {'with' if n == 0 else 'without'} -txindex, with blockhash\")\n+            gottx = self.nodes[n].getrawtransaction(txid=tx, verbosity=v, blockhash=block1)\n+            missing_fields = set(fields).difference(gottx.keys())\n+            if missing_fields:\n+                raise AssertionError(f\"fields {', '.join(missing_fields)} are not in transaction\")\n+\n+            for f in fields:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r987103167",
      "id" : 987103167,
      "line" : 217,
      "node_id" : "PRRC_kwDOABII58461f-_",
      "original_commit_id" : "eae8f8e66621b75776a4a9bb5d8224c7320f89e4",
      "original_line" : 217,
      "original_position" : 99,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 99,
      "pull_request_review_id" : 1130254716,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/987103167/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-10-04T16:31:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/987103167",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r990760777"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/990760777"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "refactored this test to remove this loop",
      "commit_id" : "845913f84a338ea16d9f01f4c60ababcc24aefbe",
      "created_at" : "2022-10-09T09:15:40Z",
      "diff_hunk" : "@@ -170,6 +175,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.wallet.send_self_transfer(from_node=self.nodes[1])['txid']\n+        [block1] = self.generate(self.nodes[1], 1)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight',\n+        ]\n+        prevout_fields = [\n+            'generated',\n+            'height',\n+            'value',\n+            'scriptPubKey',\n+        ]\n+        script_pub_key_fields = [\n+            'address',\n+            'asm',\n+            'hex',\n+            'type',\n+        ]\n+        # node 0 & 3 with verbosity 1 & 2\n+        for n, v in product([0, 2], [1, 2]):\n+            self.log.info(f\"Test getrawtransaction_verbosity {v} {'with' if n == 0 else 'without'} -txindex, with blockhash\")\n+            gottx = self.nodes[n].getrawtransaction(txid=tx, verbosity=v, blockhash=block1)\n+            missing_fields = set(fields).difference(gottx.keys())\n+            if missing_fields:\n+                raise AssertionError(f\"fields {', '.join(missing_fields)} are not in transaction\")\n+\n+            for f in fields:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r990760777",
      "id" : 990760777,
      "in_reply_to_id" : 987103167,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5847Dc9J",
      "original_commit_id" : "eae8f8e66621b75776a4a9bb5d8224c7320f89e4",
      "original_line" : 217,
      "original_position" : 99,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : null,
      "pull_request_review_id" : 1135323204,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/990760777/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-10-09T09:15:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/990760777",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r991005779"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/991005779"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "You are correct. I have refactored the code to detect if blockhash was sent as a parameter. \r\nWhat should we expect if the blockhash is **not** sent and the tx is in **mempool**? Should the fee field be available? (I would think so) ",
      "commit_id" : "226b0b7485799529de46f5bb8a59e281f171801a",
      "created_at" : "2022-10-10T08:00:35Z",
      "diff_hunk" : "@@ -262,13 +299,33 @@ static RPCHelpMan getrawtransaction()\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, errmsg + \". Use gettransaction for wallet transactions.\");\n     }\n \n-    if (!fVerbose) {\n+    if (verbosity <= 0) {\n         return EncodeHexTx(*tx, RPCSerializationFlags());\n     }\n \n     UniValue result(UniValue::VOBJ);\n-    if (blockindex) result.pushKV(\"in_active_chain\", in_active_chain);\n-    TxToJSON(*tx, hash_block, result, chainman.ActiveChainstate());\n+    if (blockindex) {\n+        result.pushKV(\"in_active_chain\", in_active_chain);\n+    }\n+\n+    CBlockUndo blockUndo;\n+    CBlock block;\n+    const bool is_block_pruned{WITH_LOCK(cs_main, return chainman.m_blockman.IsBlockPruned(blockindex))};\n+\n+    if (verbosity == 1 || tx->IsCoinBase() ||\n+        !blockindex || is_block_pruned ||",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r991005779",
      "id" : 991005779,
      "in_reply_to_id" : 986754326,
      "line" : 323,
      "node_id" : "PRRC_kwDOABII5847EYxT",
      "original_commit_id" : "eae8f8e66621b75776a4a9bb5d8224c7320f89e4",
      "original_line" : 323,
      "original_position" : 152,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 176,
      "pull_request_review_id" : 1135611308,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/991005779/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-10-10T08:01:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/991005779",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r991006048"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/991006048"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I have added this test case",
      "commit_id" : "226b0b7485799529de46f5bb8a59e281f171801a",
      "created_at" : "2022-10-10T08:00:58Z",
      "diff_hunk" : "@@ -170,6 +175,67 @@ def getrawtransaction_tests(self):\n         block = self.nodes[0].getblock(self.nodes[0].getblockhash(0))\n         assert_raises_rpc_error(-5, \"The genesis block coinbase is not considered an ordinary transaction\", self.nodes[0].getrawtransaction, block['merkleroot'])\n \n+    def getrawtransaction_verbosity_tests(self):\n+        tx = self.wallet.send_self_transfer(from_node=self.nodes[1])['txid']\n+        [block1] = self.generate(self.nodes[1], 1)\n+        fields = [\n+            'blockhash',\n+            'blocktime',\n+            'confirmations',\n+            'hash',\n+            'hex',\n+            'in_active_chain',\n+            'locktime',\n+            'size',\n+            'time',\n+            'txid',\n+            'vin',\n+            'vout',\n+            'vsize',\n+            'weight',\n+        ]\n+        prevout_fields = [\n+            'generated',\n+            'height',\n+            'value',\n+            'scriptPubKey',\n+        ]\n+        script_pub_key_fields = [\n+            'address',\n+            'asm',\n+            'hex',\n+            'type',\n+        ]\n+        # node 0 & 3 with verbosity 1 & 2\n+        for n, v in product([0, 2], [1, 2]):\n+            self.log.info(f\"Test getrawtransaction_verbosity {v} {'with' if n == 0 else 'without'} -txindex, with blockhash\")\n+            gottx = self.nodes[n].getrawtransaction(txid=tx, verbosity=v, blockhash=block1)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#discussion_r991006048",
      "id" : 991006048,
      "in_reply_to_id" : 986755937,
      "line" : 212,
      "node_id" : "PRRC_kwDOABII5847EY1g",
      "original_commit_id" : "eae8f8e66621b75776a4a9bb5d8224c7320f89e4",
      "original_line" : 212,
      "original_position" : 94,
      "original_start_line" : null,
      "path" : "test/functional/rpc_rawtransaction.py",
      "position" : 94,
      "pull_request_review_id" : 1135611711,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23319",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/991006048/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-10-10T08:00:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/991006048",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Compiled and manually tested.\r\n> \r\n> The RPC help result object could use some improvement. Right now the section is rendered like this:\r\n> \r\n\r\nI updated the RPC help to reflect getblock ",
      "created_at" : "2022-10-30T07:24:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23319#issuecomment-1296147461",
      "id" : 1296147461,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23319",
      "node_id" : "IC_kwDOABII585NQaQF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1296147461/reactions"
      },
      "updated_at" : "2022-10-30T07:24:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1296147461",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/976425?v=4",
         "events_url" : "https://api.github.com/users/dougEfresh/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dougEfresh/followers",
         "following_url" : "https://api.github.com/users/dougEfresh/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dougEfresh/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dougEfresh",
         "id" : 976425,
         "login" : "dougEfresh",
         "node_id" : "MDQ6VXNlcjk3NjQyNQ==",
         "organizations_url" : "https://api.github.com/users/dougEfresh/orgs",
         "received_events_url" : "https://api.github.com/users/dougEfresh/received_events",
         "repos_url" : "https://api.github.com/users/dougEfresh/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dougEfresh/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dougEfresh/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dougEfresh"
      }
   }
]
