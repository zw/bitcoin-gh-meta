[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "to ease review, might be good to split this into a moveonly commit and then a subsequent one with changes if thats possible?",
      "created_at" : "2018-05-23T17:45:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#issuecomment-391437656",
      "id" : 391437656,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13311",
      "updated_at" : "2018-05-23T17:45:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/391437656",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/195769?v=4",
         "events_url" : "https://api.github.com/users/skeees/events{/privacy}",
         "followers_url" : "https://api.github.com/users/skeees/followers",
         "following_url" : "https://api.github.com/users/skeees/following{/other_user}",
         "gists_url" : "https://api.github.com/users/skeees/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/skeees",
         "id" : 195769,
         "login" : "skeees",
         "organizations_url" : "https://api.github.com/users/skeees/orgs",
         "received_events_url" : "https://api.github.com/users/skeees/received_events",
         "repos_url" : "https://api.github.com/users/skeees/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/skeees/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/skeees/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/skeees"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Why move the version bits information to a separate file? This introduces a circular dependency between chainparams and versionbitsinfo,",
      "created_at" : "2018-05-24T17:42:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#issuecomment-391800316",
      "id" : 391800316,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13311",
      "updated_at" : "2018-05-24T17:42:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/391800316",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> to ease review, might be good to split this into a moveonly commit and then a subsequent one with changes if thats possible?\r\n\r\nSure, but I would like to wait for some concept acks first.\r\n\r\n> Why move the version bits information to a separate file? This introduces a circular dependency between chainparams and versionbitsinfo,\r\n\r\nNo, it does not. After this, versionbits depends onchainparams, which depends on versionbitsinfo, which depends on consensus/params.\r\nThe separation is precisely to avoid a circular dependency between chainparams and versionbits.\r\n ",
      "created_at" : "2018-05-27T10:36:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#issuecomment-392321101",
      "id" : 392321101,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13311",
      "updated_at" : "2018-05-27T10:36:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/392321101",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1008458?v=4",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> No, it does not. After this, versionbits depends onchainparams, which depends on versionbitsinfo, which depends on consensus/params.\r\n> The separation is precisely to avoid a circular dependency between chainparams and versionbits.\r\n\r\nMy apologies! I confused chainparams and consensus/params when reading this.",
      "created_at" : "2018-05-27T20:01:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#issuecomment-392362127",
      "id" : 392362127,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13311",
      "updated_at" : "2018-05-27T20:01:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/392362127",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Needs rebase due to merge of #13341\r\n",
      "created_at" : "2018-05-30T13:58:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#issuecomment-393172348",
      "id" : 393172348,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13311",
      "updated_at" : "2018-05-30T13:58:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/393172348",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased and separated MOVEONLY commit.\r\n",
      "created_at" : "2018-06-16T20:42:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#issuecomment-397837719",
      "id" : 397837719,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13311",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NzgzNzcxOQ==",
      "updated_at" : "2018-06-16T20:42:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/397837719",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1008458?v=4",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "node_id" : "MDQ6VXNlcjEwMDg0NTg=",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r201875969"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/201875969"
         }
      },
      "author_association" : "MEMBER",
      "body" : "NB: it's still used in init.cpp, only for mempool replacement",
      "commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "created_at" : "2018-07-12T00:07:25Z",
      "diff_hunk" : "@@ -4,15 +4,17 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chainparams.h>\n+#include <chainparamsseeds.h>\n #include <consensus/merkle.h>\n-\n #include <tinyformat.h>\n #include <util.h>\n #include <utilstrencodings.h>\n+#include <versionbitsinfo.h>\n \n #include <assert.h>\n \n-#include <chainparamsseeds.h>\n+#include <boost/algorithm/string/classification.hpp>\n+#include <boost/algorithm/string/split.hpp>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r201875969",
      "id" : 201875969,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMTg3NTk2OQ==",
      "original_commit_id" : "c3d5082ce373f5ee39bdf5daa7bae36ad94c5433",
      "original_position" : 16,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 136464269,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311",
      "updated_at" : "2018-09-07T22:07:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/201875969",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r201876512"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/201876512"
         }
      },
      "author_association" : "MEMBER",
      "body" : "NB: it's still used in init.cpp, only for mempool replacement",
      "commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "created_at" : "2018-07-12T00:11:19Z",
      "diff_hunk" : "@@ -4,15 +4,17 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chainparams.h>\n+#include <chainparamsseeds.h>\n #include <consensus/merkle.h>\n-\n #include <tinyformat.h>\n #include <util.h>\n #include <utilstrencodings.h>\n+#include <versionbitsinfo.h>\n \n #include <assert.h>\n \n-#include <chainparamsseeds.h>\n+#include <boost/algorithm/string/classification.hpp>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r201876512",
      "id" : 201876512,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMTg3NjUxMg==",
      "original_commit_id" : "c3d5082ce373f5ee39bdf5daa7bae36ad94c5433",
      "original_position" : 15,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 136464269,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311",
      "updated_at" : "2018-09-07T22:07:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/201876512",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r201876880"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/201876880"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: would be nice to keep using `Consensus::BIP9Deployment::NO_TIMEOUT`",
      "commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "created_at" : "2018-07-12T00:14:10Z",
      "diff_hunk" : "@@ -55,6 +55,9 @@ BasicTestingSetup::BasicTestingSetup(const std::string& chainName)\n         InitSignatureCache();\n         InitScriptExecutionCache();\n         fCheckBlockIndex = true;\n+        // CreateAndProcessBlock() does not support building SegWit blocks, so don't activate in these tests.\n+        // TODO: fix the code to support SegWit blocks.\n+        gArgs.ForceSetArg(\"-vbparams\", \"segwit:0:999999999999\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r201876880",
      "id" : 201876880,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMTg3Njg4MA==",
      "original_commit_id" : "c3d5082ce373f5ee39bdf5daa7bae36ad94c5433",
      "original_position" : 6,
      "path" : "src/test/test_bitcoin.cpp",
      "position" : null,
      "pull_request_review_id" : 136464269,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311",
      "updated_at" : "2018-09-07T22:07:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/201876880",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2018-07-12T12:03:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#issuecomment-404489052",
      "id" : 404489052,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13311",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNDQ4OTA1Mg==",
      "updated_at" : "2018-07-12T12:03:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/404489052",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "rebased\r\n",
      "created_at" : "2018-07-19T05:41:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#issuecomment-406160934",
      "id" : 406160934,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13311",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNjE2MDkzNA==",
      "updated_at" : "2018-07-19T22:36:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/406160934",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1008458?v=4",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "node_id" : "MDQ6VXNlcjEwMDg0NTg=",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Fixed nit in https://github.com/bitcoin/bitcoin/pull/13311#discussion_r201876880",
      "created_at" : "2018-07-19T22:36:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#issuecomment-406435380",
      "id" : 406435380,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13311",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNjQzNTM4MA==",
      "updated_at" : "2018-07-19T22:36:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/406435380",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1008458?v=4",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "node_id" : "MDQ6VXNlcjEwMDg0NTg=",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r203899444"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/203899444"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Could change this to `unique_ptr<const CChainParams>` to better ensure that params aren't changed after initialisation? (Means `CreateChainParams()` return value also needs to change, but that seems to work fine)",
      "commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "created_at" : "2018-07-19T23:11:44Z",
      "diff_hunk" : "@@ -353,33 +351,78 @@ class CRegTestParams : public CChainParams {\n         /* enable fallback fee on regtest */\n         m_fallback_fee_enabled = true;\n     }\n+\n+    /**\n+     * Allows modifying the Version Bits regtest parameters.\n+     */\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    {\n+        consensus.vDeployments[d].nStartTime = nStartTime;\n+        consensus.vDeployments[d].nTimeout = nTimeout;\n+    }\n+    void UpdateVersionBitsParametersFromArgs(ArgsManager& args);\n };\n \n+void CRegTestParams::UpdateVersionBitsParametersFromArgs(ArgsManager& args)\n+{\n+    // Allow overriding version bits parameters for testing\n+    if (args.IsArgSet(\"-vbparams\")) {\n+        for (const std::string& strDeployment : args.GetArgs(\"-vbparams\")) {\n+            std::vector<std::string> vDeploymentParams;\n+            boost::split(vDeploymentParams, strDeployment, boost::is_any_of(\":\"));\n+            if (vDeploymentParams.size() != 3) {\n+                throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:start:end\");\n+            }\n+            int64_t nStartTime, nTimeout;\n+            if (!ParseInt64(vDeploymentParams[1], &nStartTime)) {\n+                throw std::runtime_error(strprintf(\"Invalid nStartTime (%s)\", vDeploymentParams[1]));\n+            }\n+            if (!ParseInt64(vDeploymentParams[2], &nTimeout)) {\n+                throw std::runtime_error(strprintf(\"Invalid nTimeout (%s)\", vDeploymentParams[2]));\n+            }\n+            bool found = false;\n+            for (int j=0; j<(int)Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++j)\n+            {\n+                if (vDeploymentParams[0].compare(VersionBitsDeploymentInfo[j].name) == 0) {\n+                    UpdateVersionBitsParameters(Consensus::DeploymentPos(j), nStartTime, nTimeout);\n+                    found = true;\n+                    LogPrintf(\"Setting version bits activation parameters for %s to start=%ld, timeout=%ld\\n\", vDeploymentParams[0], nStartTime, nTimeout);\n+                    break;\n+                }\n+            }\n+            if (!found) {\n+                throw std::runtime_error(strprintf(\"Invalid deployment (%s)\", vDeploymentParams[0]));\n+            }\n+        }\n+    }\n+}\n+\n static std::unique_ptr<CChainParams> globalChainParams;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r203899444",
      "id" : 203899444,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMzg5OTQ0NA==",
      "original_commit_id" : "7067657731404c28ff87e46ec390992500ca13be",
      "original_position" : 101,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 138883723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311",
      "updated_at" : "2018-09-07T22:07:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/203899444",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r203901242"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/203901242"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Why not reference `gArgs` directly in `CreateChainParams()` when using REGTEST? This is the only place that actually calls `CreateChainParams` with the `args` parameter and the only place that calls it with `chain==REGTEST`. That way you don't need to have two different ways of calling `CreateChainParams`.",
      "commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "created_at" : "2018-07-19T23:23:40Z",
      "diff_hunk" : "@@ -353,33 +351,78 @@ class CRegTestParams : public CChainParams {\n         /* enable fallback fee on regtest */\n         m_fallback_fee_enabled = true;\n     }\n+\n+    /**\n+     * Allows modifying the Version Bits regtest parameters.\n+     */\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    {\n+        consensus.vDeployments[d].nStartTime = nStartTime;\n+        consensus.vDeployments[d].nTimeout = nTimeout;\n+    }\n+    void UpdateVersionBitsParametersFromArgs(ArgsManager& args);\n };\n \n+void CRegTestParams::UpdateVersionBitsParametersFromArgs(ArgsManager& args)\n+{\n+    // Allow overriding version bits parameters for testing\n+    if (args.IsArgSet(\"-vbparams\")) {\n+        for (const std::string& strDeployment : args.GetArgs(\"-vbparams\")) {\n+            std::vector<std::string> vDeploymentParams;\n+            boost::split(vDeploymentParams, strDeployment, boost::is_any_of(\":\"));\n+            if (vDeploymentParams.size() != 3) {\n+                throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:start:end\");\n+            }\n+            int64_t nStartTime, nTimeout;\n+            if (!ParseInt64(vDeploymentParams[1], &nStartTime)) {\n+                throw std::runtime_error(strprintf(\"Invalid nStartTime (%s)\", vDeploymentParams[1]));\n+            }\n+            if (!ParseInt64(vDeploymentParams[2], &nTimeout)) {\n+                throw std::runtime_error(strprintf(\"Invalid nTimeout (%s)\", vDeploymentParams[2]));\n+            }\n+            bool found = false;\n+            for (int j=0; j<(int)Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++j)\n+            {\n+                if (vDeploymentParams[0].compare(VersionBitsDeploymentInfo[j].name) == 0) {\n+                    UpdateVersionBitsParameters(Consensus::DeploymentPos(j), nStartTime, nTimeout);\n+                    found = true;\n+                    LogPrintf(\"Setting version bits activation parameters for %s to start=%ld, timeout=%ld\\n\", vDeploymentParams[0], nStartTime, nTimeout);\n+                    break;\n+                }\n+            }\n+            if (!found) {\n+                throw std::runtime_error(strprintf(\"Invalid deployment (%s)\", vDeploymentParams[0]));\n+            }\n+        }\n+    }\n+}\n+\n static std::unique_ptr<CChainParams> globalChainParams;\n \n const CChainParams &Params() {\n     assert(globalChainParams);\n     return *globalChainParams;\n }\n \n-std::unique_ptr<CChainParams> CreateChainParams(const std::string& chain)\n+std::unique_ptr<CChainParams> CreateChainParams(const std::string& chain, ArgsManager& args)\n {\n     if (chain == CBaseChainParams::MAIN)\n         return std::unique_ptr<CChainParams>(new CMainParams());\n     else if (chain == CBaseChainParams::TESTNET)\n         return std::unique_ptr<CChainParams>(new CTestNetParams());\n     else if (chain == CBaseChainParams::REGTEST)\n-        return std::unique_ptr<CChainParams>(new CRegTestParams());\n+        return std::unique_ptr<CChainParams>(new CRegTestParams(args));\n     throw std::runtime_error(strprintf(\"%s: Unknown chain %s.\", __func__, chain));\n }\n \n-void SelectParams(const std::string& network)\n+std::unique_ptr<CChainParams> CreateChainParams(const std::string& chain)\n {\n-    SelectBaseParams(network);\n-    globalChainParams = CreateChainParams(network);\n+    ArgsManager args;\n+    return CreateChainParams(chain, args);\n }\n \n-void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+void SelectParams(const std::string& network)\n {\n-    globalChainParams->UpdateVersionBitsParameters(d, nStartTime, nTimeout);\n+    SelectBaseParams(network);\n+    globalChainParams = CreateChainParams(network, gArgs);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r203901242",
      "id" : 203901242,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMzkwMTI0Mg==",
      "original_commit_id" : "7067657731404c28ff87e46ec390992500ca13be",
      "original_position" : 135,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 138883723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311",
      "updated_at" : "2018-09-07T22:07:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/203901242",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r203901479"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/203901479"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Is it necessary to pass in an entire ArgsManager object? It seems only the -vbparams value is used. What about just passing in the vbparams value?",
      "commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "created_at" : "2018-07-19T23:25:04Z",
      "diff_hunk" : "@@ -280,7 +276,7 @@ class CTestNetParams : public CChainParams {\n  */\n class CRegTestParams : public CChainParams {\n public:\n-    CRegTestParams() {\n+    CRegTestParams(ArgsManager& args) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r203901479",
      "id" : 203901479,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMzkwMTQ3OQ==",
      "original_commit_id" : "7067657731404c28ff87e46ec390992500ca13be",
      "original_position" : 38,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 138885990,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311",
      "updated_at" : "2018-09-07T22:07:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/203901479",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r203901688"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/203901688"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Well, the point of that is to make it easy to add further params, like in https://github.com/bitcoin/bitcoin/pull/8994 (probably not all of them are interesting for testing).\r\n",
      "commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "created_at" : "2018-07-19T23:26:33Z",
      "diff_hunk" : "@@ -280,7 +276,7 @@ class CTestNetParams : public CChainParams {\n  */\n class CRegTestParams : public CChainParams {\n public:\n-    CRegTestParams() {\n+    CRegTestParams(ArgsManager& args) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r203901688",
      "id" : 203901688,
      "in_reply_to_id" : 203901479,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMzkwMTY4OA==",
      "original_commit_id" : "7067657731404c28ff87e46ec390992500ca13be",
      "original_position" : 38,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 138886233,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311",
      "updated_at" : "2018-09-07T22:07:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/203901688",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1008458?v=4",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "node_id" : "MDQ6VXNlcjEwMDg0NTg=",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.",
      "created_at" : "2018-07-20T01:13:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#issuecomment-406459616",
      "id" : 406459616,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13311",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNjQ1OTYxNg==",
      "updated_at" : "2018-07-20T01:13:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/406459616",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r203917276"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/203917276"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I can remove the new way of calling CreateChainParams, but the idea was that some unittests could create their own custom ArgsManager instead of using gArgs. This would only serve for testing functions that explicitly take a CChainParams instead of relaying on Params().",
      "commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "created_at" : "2018-07-20T01:23:17Z",
      "diff_hunk" : "@@ -353,33 +351,78 @@ class CRegTestParams : public CChainParams {\n         /* enable fallback fee on regtest */\n         m_fallback_fee_enabled = true;\n     }\n+\n+    /**\n+     * Allows modifying the Version Bits regtest parameters.\n+     */\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    {\n+        consensus.vDeployments[d].nStartTime = nStartTime;\n+        consensus.vDeployments[d].nTimeout = nTimeout;\n+    }\n+    void UpdateVersionBitsParametersFromArgs(ArgsManager& args);\n };\n \n+void CRegTestParams::UpdateVersionBitsParametersFromArgs(ArgsManager& args)\n+{\n+    // Allow overriding version bits parameters for testing\n+    if (args.IsArgSet(\"-vbparams\")) {\n+        for (const std::string& strDeployment : args.GetArgs(\"-vbparams\")) {\n+            std::vector<std::string> vDeploymentParams;\n+            boost::split(vDeploymentParams, strDeployment, boost::is_any_of(\":\"));\n+            if (vDeploymentParams.size() != 3) {\n+                throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:start:end\");\n+            }\n+            int64_t nStartTime, nTimeout;\n+            if (!ParseInt64(vDeploymentParams[1], &nStartTime)) {\n+                throw std::runtime_error(strprintf(\"Invalid nStartTime (%s)\", vDeploymentParams[1]));\n+            }\n+            if (!ParseInt64(vDeploymentParams[2], &nTimeout)) {\n+                throw std::runtime_error(strprintf(\"Invalid nTimeout (%s)\", vDeploymentParams[2]));\n+            }\n+            bool found = false;\n+            for (int j=0; j<(int)Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++j)\n+            {\n+                if (vDeploymentParams[0].compare(VersionBitsDeploymentInfo[j].name) == 0) {\n+                    UpdateVersionBitsParameters(Consensus::DeploymentPos(j), nStartTime, nTimeout);\n+                    found = true;\n+                    LogPrintf(\"Setting version bits activation parameters for %s to start=%ld, timeout=%ld\\n\", vDeploymentParams[0], nStartTime, nTimeout);\n+                    break;\n+                }\n+            }\n+            if (!found) {\n+                throw std::runtime_error(strprintf(\"Invalid deployment (%s)\", vDeploymentParams[0]));\n+            }\n+        }\n+    }\n+}\n+\n static std::unique_ptr<CChainParams> globalChainParams;\n \n const CChainParams &Params() {\n     assert(globalChainParams);\n     return *globalChainParams;\n }\n \n-std::unique_ptr<CChainParams> CreateChainParams(const std::string& chain)\n+std::unique_ptr<CChainParams> CreateChainParams(const std::string& chain, ArgsManager& args)\n {\n     if (chain == CBaseChainParams::MAIN)\n         return std::unique_ptr<CChainParams>(new CMainParams());\n     else if (chain == CBaseChainParams::TESTNET)\n         return std::unique_ptr<CChainParams>(new CTestNetParams());\n     else if (chain == CBaseChainParams::REGTEST)\n-        return std::unique_ptr<CChainParams>(new CRegTestParams());\n+        return std::unique_ptr<CChainParams>(new CRegTestParams(args));\n     throw std::runtime_error(strprintf(\"%s: Unknown chain %s.\", __func__, chain));\n }\n \n-void SelectParams(const std::string& network)\n+std::unique_ptr<CChainParams> CreateChainParams(const std::string& chain)\n {\n-    SelectBaseParams(network);\n-    globalChainParams = CreateChainParams(network);\n+    ArgsManager args;\n+    return CreateChainParams(chain, args);\n }\n \n-void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+void SelectParams(const std::string& network)\n {\n-    globalChainParams->UpdateVersionBitsParameters(d, nStartTime, nTimeout);\n+    SelectBaseParams(network);\n+    globalChainParams = CreateChainParams(network, gArgs);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r203917276",
      "id" : 203917276,
      "in_reply_to_id" : 203901242,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMzkxNzI3Ng==",
      "original_commit_id" : "7067657731404c28ff87e46ec390992500ca13be",
      "original_position" : 135,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 138904046,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311",
      "updated_at" : "2018-09-07T22:07:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/203917276",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1008458?v=4",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "node_id" : "MDQ6VXNlcjEwMDg0NTg=",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Fixed nit in https://github.com/bitcoin/bitcoin/pull/13311/files#r203899444",
      "created_at" : "2018-07-20T01:31:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#issuecomment-406462100",
      "id" : 406462100,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13311",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNjQ2MjEwMA==",
      "updated_at" : "2018-07-20T01:31:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/406462100",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1008458?v=4",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "node_id" : "MDQ6VXNlcjEwMDg0NTg=",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r211117992"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/211117992"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Tend to agree with @ajtowns.\r\n\r\n> but the idea was that some unittests could create their own custom ArgsManager instead of using gArgs\r\n\r\nIf needed it can mutate gArgs? Or this can be done when needed?",
      "commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "created_at" : "2018-08-19T22:51:07Z",
      "diff_hunk" : "@@ -353,33 +351,78 @@ class CRegTestParams : public CChainParams {\n         /* enable fallback fee on regtest */\n         m_fallback_fee_enabled = true;\n     }\n+\n+    /**\n+     * Allows modifying the Version Bits regtest parameters.\n+     */\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    {\n+        consensus.vDeployments[d].nStartTime = nStartTime;\n+        consensus.vDeployments[d].nTimeout = nTimeout;\n+    }\n+    void UpdateVersionBitsParametersFromArgs(ArgsManager& args);\n };\n \n+void CRegTestParams::UpdateVersionBitsParametersFromArgs(ArgsManager& args)\n+{\n+    // Allow overriding version bits parameters for testing\n+    if (args.IsArgSet(\"-vbparams\")) {\n+        for (const std::string& strDeployment : args.GetArgs(\"-vbparams\")) {\n+            std::vector<std::string> vDeploymentParams;\n+            boost::split(vDeploymentParams, strDeployment, boost::is_any_of(\":\"));\n+            if (vDeploymentParams.size() != 3) {\n+                throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:start:end\");\n+            }\n+            int64_t nStartTime, nTimeout;\n+            if (!ParseInt64(vDeploymentParams[1], &nStartTime)) {\n+                throw std::runtime_error(strprintf(\"Invalid nStartTime (%s)\", vDeploymentParams[1]));\n+            }\n+            if (!ParseInt64(vDeploymentParams[2], &nTimeout)) {\n+                throw std::runtime_error(strprintf(\"Invalid nTimeout (%s)\", vDeploymentParams[2]));\n+            }\n+            bool found = false;\n+            for (int j=0; j<(int)Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++j)\n+            {\n+                if (vDeploymentParams[0].compare(VersionBitsDeploymentInfo[j].name) == 0) {\n+                    UpdateVersionBitsParameters(Consensus::DeploymentPos(j), nStartTime, nTimeout);\n+                    found = true;\n+                    LogPrintf(\"Setting version bits activation parameters for %s to start=%ld, timeout=%ld\\n\", vDeploymentParams[0], nStartTime, nTimeout);\n+                    break;\n+                }\n+            }\n+            if (!found) {\n+                throw std::runtime_error(strprintf(\"Invalid deployment (%s)\", vDeploymentParams[0]));\n+            }\n+        }\n+    }\n+}\n+\n static std::unique_ptr<CChainParams> globalChainParams;\n \n const CChainParams &Params() {\n     assert(globalChainParams);\n     return *globalChainParams;\n }\n \n-std::unique_ptr<CChainParams> CreateChainParams(const std::string& chain)\n+std::unique_ptr<CChainParams> CreateChainParams(const std::string& chain, ArgsManager& args)\n {\n     if (chain == CBaseChainParams::MAIN)\n         return std::unique_ptr<CChainParams>(new CMainParams());\n     else if (chain == CBaseChainParams::TESTNET)\n         return std::unique_ptr<CChainParams>(new CTestNetParams());\n     else if (chain == CBaseChainParams::REGTEST)\n-        return std::unique_ptr<CChainParams>(new CRegTestParams());\n+        return std::unique_ptr<CChainParams>(new CRegTestParams(args));\n     throw std::runtime_error(strprintf(\"%s: Unknown chain %s.\", __func__, chain));\n }\n \n-void SelectParams(const std::string& network)\n+std::unique_ptr<CChainParams> CreateChainParams(const std::string& chain)\n {\n-    SelectBaseParams(network);\n-    globalChainParams = CreateChainParams(network);\n+    ArgsManager args;\n+    return CreateChainParams(chain, args);\n }\n \n-void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+void SelectParams(const std::string& network)\n {\n-    globalChainParams->UpdateVersionBitsParameters(d, nStartTime, nTimeout);\n+    SelectBaseParams(network);\n+    globalChainParams = CreateChainParams(network, gArgs);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r211117992",
      "id" : 211117992,
      "in_reply_to_id" : 203901242,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMTExNzk5Mg==",
      "original_commit_id" : "7067657731404c28ff87e46ec390992500ca13be",
      "original_position" : 135,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 147473549,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311",
      "updated_at" : "2018-09-07T22:07:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/211117992",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r211394627"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/211394627"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I guess one can mutate gArgs to a given value for a given test and then back to its original value afterwards.\r\nOr as you say, make this change afterwards when it's going to be used.\r\n",
      "commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "created_at" : "2018-08-20T20:20:44Z",
      "diff_hunk" : "@@ -353,33 +351,78 @@ class CRegTestParams : public CChainParams {\n         /* enable fallback fee on regtest */\n         m_fallback_fee_enabled = true;\n     }\n+\n+    /**\n+     * Allows modifying the Version Bits regtest parameters.\n+     */\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    {\n+        consensus.vDeployments[d].nStartTime = nStartTime;\n+        consensus.vDeployments[d].nTimeout = nTimeout;\n+    }\n+    void UpdateVersionBitsParametersFromArgs(ArgsManager& args);\n };\n \n+void CRegTestParams::UpdateVersionBitsParametersFromArgs(ArgsManager& args)\n+{\n+    // Allow overriding version bits parameters for testing\n+    if (args.IsArgSet(\"-vbparams\")) {\n+        for (const std::string& strDeployment : args.GetArgs(\"-vbparams\")) {\n+            std::vector<std::string> vDeploymentParams;\n+            boost::split(vDeploymentParams, strDeployment, boost::is_any_of(\":\"));\n+            if (vDeploymentParams.size() != 3) {\n+                throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:start:end\");\n+            }\n+            int64_t nStartTime, nTimeout;\n+            if (!ParseInt64(vDeploymentParams[1], &nStartTime)) {\n+                throw std::runtime_error(strprintf(\"Invalid nStartTime (%s)\", vDeploymentParams[1]));\n+            }\n+            if (!ParseInt64(vDeploymentParams[2], &nTimeout)) {\n+                throw std::runtime_error(strprintf(\"Invalid nTimeout (%s)\", vDeploymentParams[2]));\n+            }\n+            bool found = false;\n+            for (int j=0; j<(int)Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++j)\n+            {\n+                if (vDeploymentParams[0].compare(VersionBitsDeploymentInfo[j].name) == 0) {\n+                    UpdateVersionBitsParameters(Consensus::DeploymentPos(j), nStartTime, nTimeout);\n+                    found = true;\n+                    LogPrintf(\"Setting version bits activation parameters for %s to start=%ld, timeout=%ld\\n\", vDeploymentParams[0], nStartTime, nTimeout);\n+                    break;\n+                }\n+            }\n+            if (!found) {\n+                throw std::runtime_error(strprintf(\"Invalid deployment (%s)\", vDeploymentParams[0]));\n+            }\n+        }\n+    }\n+}\n+\n static std::unique_ptr<CChainParams> globalChainParams;\n \n const CChainParams &Params() {\n     assert(globalChainParams);\n     return *globalChainParams;\n }\n \n-std::unique_ptr<CChainParams> CreateChainParams(const std::string& chain)\n+std::unique_ptr<CChainParams> CreateChainParams(const std::string& chain, ArgsManager& args)\n {\n     if (chain == CBaseChainParams::MAIN)\n         return std::unique_ptr<CChainParams>(new CMainParams());\n     else if (chain == CBaseChainParams::TESTNET)\n         return std::unique_ptr<CChainParams>(new CTestNetParams());\n     else if (chain == CBaseChainParams::REGTEST)\n-        return std::unique_ptr<CChainParams>(new CRegTestParams());\n+        return std::unique_ptr<CChainParams>(new CRegTestParams(args));\n     throw std::runtime_error(strprintf(\"%s: Unknown chain %s.\", __func__, chain));\n }\n \n-void SelectParams(const std::string& network)\n+std::unique_ptr<CChainParams> CreateChainParams(const std::string& chain)\n {\n-    SelectBaseParams(network);\n-    globalChainParams = CreateChainParams(network);\n+    ArgsManager args;\n+    return CreateChainParams(chain, args);\n }\n \n-void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+void SelectParams(const std::string& network)\n {\n-    globalChainParams->UpdateVersionBitsParameters(d, nStartTime, nTimeout);\n+    SelectBaseParams(network);\n+    globalChainParams = CreateChainParams(network, gArgs);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r211394627",
      "id" : 211394627,
      "in_reply_to_id" : 203901242,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMTM5NDYyNw==",
      "original_commit_id" : "7067657731404c28ff87e46ec390992500ca13be",
      "original_position" : 135,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 147806728,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311",
      "updated_at" : "2018-09-07T22:07:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/211394627",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1008458?v=4",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "node_id" : "MDQ6VXNlcjEwMDg0NTg=",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r211437401"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/211437401"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Better to just pass the needed arg IMO, and only couple these classes if preferable based on the eventual use.\r\nhttps://martinfowler.com/bliki/Yagni.html",
      "commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "created_at" : "2018-08-20T23:23:55Z",
      "diff_hunk" : "@@ -280,7 +276,7 @@ class CTestNetParams : public CChainParams {\n  */\n class CRegTestParams : public CChainParams {\n public:\n-    CRegTestParams() {\n+    CRegTestParams(ArgsManager& args) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r211437401",
      "id" : 211437401,
      "in_reply_to_id" : 203901479,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMTQzNzQwMQ==",
      "original_commit_id" : "7067657731404c28ff87e46ec390992500ca13be",
      "original_position" : 38,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 147857722,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311",
      "updated_at" : "2018-09-07T22:07:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/211437401",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r212864705"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212864705"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Could make this `const ArgsManager& args`",
      "commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "created_at" : "2018-08-27T04:39:58Z",
      "diff_hunk" : "@@ -280,7 +276,7 @@ class CTestNetParams : public CChainParams {\n  */\n class CRegTestParams : public CChainParams {\n public:\n-    CRegTestParams() {\n+    CRegTestParams(ArgsManager& args) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r212864705",
      "id" : 212864705,
      "in_reply_to_id" : 203901479,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjg2NDcwNQ==",
      "original_commit_id" : "7067657731404c28ff87e46ec390992500ca13be",
      "original_position" : 38,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 149579796,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311",
      "updated_at" : "2018-09-07T22:07:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212864705",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r212864736"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212864736"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`const ArgsManager&` here as well",
      "commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "created_at" : "2018-08-27T04:40:23Z",
      "diff_hunk" : "@@ -353,33 +351,78 @@ class CRegTestParams : public CChainParams {\n         /* enable fallback fee on regtest */\n         m_fallback_fee_enabled = true;\n     }\n+\n+    /**\n+     * Allows modifying the Version Bits regtest parameters.\n+     */\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    {\n+        consensus.vDeployments[d].nStartTime = nStartTime;\n+        consensus.vDeployments[d].nTimeout = nTimeout;\n+    }\n+    void UpdateVersionBitsParametersFromArgs(ArgsManager& args);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r212864736",
      "id" : 212864736,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjg2NDczNg==",
      "original_commit_id" : "ca040b5b76ddeeace6da4f8111169ffd6234414a",
      "original_position" : 64,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 149579796,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311",
      "updated_at" : "2018-09-07T22:07:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212864736",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r212864830"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212864830"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I still think dropping the `args` param and referencing `gArgs` here directly makes more sense. Otherwise, could make `args` be `const` here too.",
      "commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "created_at" : "2018-08-27T04:41:39Z",
      "diff_hunk" : "@@ -353,33 +351,78 @@ class CRegTestParams : public CChainParams {\n         /* enable fallback fee on regtest */\n         m_fallback_fee_enabled = true;\n     }\n+\n+    /**\n+     * Allows modifying the Version Bits regtest parameters.\n+     */\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    {\n+        consensus.vDeployments[d].nStartTime = nStartTime;\n+        consensus.vDeployments[d].nTimeout = nTimeout;\n+    }\n+    void UpdateVersionBitsParametersFromArgs(ArgsManager& args);\n };\n \n-static std::unique_ptr<CChainParams> globalChainParams;\n+void CRegTestParams::UpdateVersionBitsParametersFromArgs(ArgsManager& args)\n+{\n+    // Allow overriding version bits parameters for testing\n+    if (args.IsArgSet(\"-vbparams\")) {\n+        for (const std::string& strDeployment : args.GetArgs(\"-vbparams\")) {\n+            std::vector<std::string> vDeploymentParams;\n+            boost::split(vDeploymentParams, strDeployment, boost::is_any_of(\":\"));\n+            if (vDeploymentParams.size() != 3) {\n+                throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:start:end\");\n+            }\n+            int64_t nStartTime, nTimeout;\n+            if (!ParseInt64(vDeploymentParams[1], &nStartTime)) {\n+                throw std::runtime_error(strprintf(\"Invalid nStartTime (%s)\", vDeploymentParams[1]));\n+            }\n+            if (!ParseInt64(vDeploymentParams[2], &nTimeout)) {\n+                throw std::runtime_error(strprintf(\"Invalid nTimeout (%s)\", vDeploymentParams[2]));\n+            }\n+            bool found = false;\n+            for (int j=0; j<(int)Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++j)\n+            {\n+                if (vDeploymentParams[0].compare(VersionBitsDeploymentInfo[j].name) == 0) {\n+                    UpdateVersionBitsParameters(Consensus::DeploymentPos(j), nStartTime, nTimeout);\n+                    found = true;\n+                    LogPrintf(\"Setting version bits activation parameters for %s to start=%ld, timeout=%ld\\n\", vDeploymentParams[0], nStartTime, nTimeout);\n+                    break;\n+                }\n+            }\n+            if (!found) {\n+                throw std::runtime_error(strprintf(\"Invalid deployment (%s)\", vDeploymentParams[0]));\n+            }\n+        }\n+    }\n+}\n+\n+static std::unique_ptr<const CChainParams> globalChainParams;\n \n const CChainParams &Params() {\n     assert(globalChainParams);\n     return *globalChainParams;\n }\n \n-std::unique_ptr<CChainParams> CreateChainParams(const std::string& chain)\n+std::unique_ptr<const CChainParams> CreateChainParams(const std::string& chain, ArgsManager& args)\n {\n     if (chain == CBaseChainParams::MAIN)\n         return std::unique_ptr<CChainParams>(new CMainParams());\n     else if (chain == CBaseChainParams::TESTNET)\n         return std::unique_ptr<CChainParams>(new CTestNetParams());\n     else if (chain == CBaseChainParams::REGTEST)\n-        return std::unique_ptr<CChainParams>(new CRegTestParams());\n+        return std::unique_ptr<CChainParams>(new CRegTestParams(args));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r212864830",
      "id" : 212864830,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjg2NDgzMA==",
      "original_commit_id" : "ca040b5b76ddeeace6da4f8111169ffd6234414a",
      "original_position" : 118,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 149579796,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311",
      "updated_at" : "2018-09-07T22:07:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212864830",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r214517046"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214517046"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This function can exit early if the `-vbparams` arg is not set.\r\n```c++\r\nvoid CRegTestParams::UpdateVersionBitsParametersFromArgs(ArgsManager& args)\r\n{\r\n    if (!args.IsArgSet(\"-vbparams\")) return;\r\n\r\n    for (const std::string& strDeployment : args.GetArgs(\"-vbparams\")) {\r\n        ...\r\n    }\r\n}\r\n```",
      "commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "created_at" : "2018-09-01T15:52:25Z",
      "diff_hunk" : "@@ -353,33 +351,78 @@ class CRegTestParams : public CChainParams {\n         /* enable fallback fee on regtest */\n         m_fallback_fee_enabled = true;\n     }\n+\n+    /**\n+     * Allows modifying the Version Bits regtest parameters.\n+     */\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    {\n+        consensus.vDeployments[d].nStartTime = nStartTime;\n+        consensus.vDeployments[d].nTimeout = nTimeout;\n+    }\n+    void UpdateVersionBitsParametersFromArgs(ArgsManager& args);\n };\n \n-static std::unique_ptr<CChainParams> globalChainParams;\n+void CRegTestParams::UpdateVersionBitsParametersFromArgs(ArgsManager& args)\n+{\n+    // Allow overriding version bits parameters for testing\n+    if (args.IsArgSet(\"-vbparams\")) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r214517046",
      "id" : 214517046,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDUxNzA0Ng==",
      "original_commit_id" : "ca040b5b76ddeeace6da4f8111169ffd6234414a",
      "original_position" : 71,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 151596890,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311",
      "updated_at" : "2018-09-07T22:07:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214517046",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13120787?v=4",
         "events_url" : "https://api.github.com/users/251Labs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/251Labs/followers",
         "following_url" : "https://api.github.com/users/251Labs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/251Labs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/251Labs",
         "id" : 13120787,
         "login" : "251Labs",
         "node_id" : "MDQ6VXNlcjEzMTIwNzg3",
         "organizations_url" : "https://api.github.com/users/251Labs/orgs",
         "received_events_url" : "https://api.github.com/users/251Labs/received_events",
         "repos_url" : "https://api.github.com/users/251Labs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/251Labs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/251Labs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/251Labs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r214522950"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214522950"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I tend to agree with @ajtowns that we can do without `std::unique_ptr<const CChainParams> CreateChainParams(const std::string& chain, ArgsManager& args)`.\r\n\r\nIf you want to keep it then maybe you can remove its declaration from `chainparams.h`. There is no need to expose it; it only uses internal linkage at the moment.",
      "commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "created_at" : "2018-09-01T21:00:37Z",
      "diff_hunk" : "@@ -107,7 +108,9 @@ class CChainParams\n  * @returns a CChainParams* of the chosen chain.\n  * @throws a std::runtime_error if the chain is not supported.\n  */\n-std::unique_ptr<CChainParams> CreateChainParams(const std::string& chain);\n+std::unique_ptr<const CChainParams> CreateChainParams(const std::string& chain);\n+/** Extended version taking custom args (only useful for regtest). */\n+std::unique_ptr<const CChainParams> CreateChainParams(const std::string& chain, ArgsManager& args);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r214522950",
      "id" : 214522950,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDUyMjk1MA==",
      "original_commit_id" : "ca040b5b76ddeeace6da4f8111169ffd6234414a",
      "original_position" : 24,
      "path" : "src/chainparams.h",
      "position" : null,
      "pull_request_review_id" : 151596890,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311",
      "updated_at" : "2018-09-07T22:07:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214522950",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13120787?v=4",
         "events_url" : "https://api.github.com/users/251Labs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/251Labs/followers",
         "following_url" : "https://api.github.com/users/251Labs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/251Labs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/251Labs",
         "id" : 13120787,
         "login" : "251Labs",
         "node_id" : "MDQ6VXNlcjEzMTIwNzg3",
         "organizations_url" : "https://api.github.com/users/251Labs/orgs",
         "received_events_url" : "https://api.github.com/users/251Labs/received_events",
         "repos_url" : "https://api.github.com/users/251Labs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/251Labs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/251Labs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/251Labs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r214523789"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214523789"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, that makes sense. \r\n\r\nBy doing just that and dropping the `ArgsManager& args` argument from `std::unique_ptr<const CChainParams> CreateChainParams(const std::string& chain, ArgsManager& args)` we can remove `std::unique_ptr<const CChainParams> CreateChainParams(const std::string& chain)` as you also have pointed out here: https://github.com/bitcoin/bitcoin/pull/13311#discussion_r203901242.",
      "commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "created_at" : "2018-09-01T21:50:44Z",
      "diff_hunk" : "@@ -353,33 +351,78 @@ class CRegTestParams : public CChainParams {\n         /* enable fallback fee on regtest */\n         m_fallback_fee_enabled = true;\n     }\n+\n+    /**\n+     * Allows modifying the Version Bits regtest parameters.\n+     */\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    {\n+        consensus.vDeployments[d].nStartTime = nStartTime;\n+        consensus.vDeployments[d].nTimeout = nTimeout;\n+    }\n+    void UpdateVersionBitsParametersFromArgs(ArgsManager& args);\n };\n \n-static std::unique_ptr<CChainParams> globalChainParams;\n+void CRegTestParams::UpdateVersionBitsParametersFromArgs(ArgsManager& args)\n+{\n+    // Allow overriding version bits parameters for testing\n+    if (args.IsArgSet(\"-vbparams\")) {\n+        for (const std::string& strDeployment : args.GetArgs(\"-vbparams\")) {\n+            std::vector<std::string> vDeploymentParams;\n+            boost::split(vDeploymentParams, strDeployment, boost::is_any_of(\":\"));\n+            if (vDeploymentParams.size() != 3) {\n+                throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:start:end\");\n+            }\n+            int64_t nStartTime, nTimeout;\n+            if (!ParseInt64(vDeploymentParams[1], &nStartTime)) {\n+                throw std::runtime_error(strprintf(\"Invalid nStartTime (%s)\", vDeploymentParams[1]));\n+            }\n+            if (!ParseInt64(vDeploymentParams[2], &nTimeout)) {\n+                throw std::runtime_error(strprintf(\"Invalid nTimeout (%s)\", vDeploymentParams[2]));\n+            }\n+            bool found = false;\n+            for (int j=0; j<(int)Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++j)\n+            {\n+                if (vDeploymentParams[0].compare(VersionBitsDeploymentInfo[j].name) == 0) {\n+                    UpdateVersionBitsParameters(Consensus::DeploymentPos(j), nStartTime, nTimeout);\n+                    found = true;\n+                    LogPrintf(\"Setting version bits activation parameters for %s to start=%ld, timeout=%ld\\n\", vDeploymentParams[0], nStartTime, nTimeout);\n+                    break;\n+                }\n+            }\n+            if (!found) {\n+                throw std::runtime_error(strprintf(\"Invalid deployment (%s)\", vDeploymentParams[0]));\n+            }\n+        }\n+    }\n+}\n+\n+static std::unique_ptr<const CChainParams> globalChainParams;\n \n const CChainParams &Params() {\n     assert(globalChainParams);\n     return *globalChainParams;\n }\n \n-std::unique_ptr<CChainParams> CreateChainParams(const std::string& chain)\n+std::unique_ptr<const CChainParams> CreateChainParams(const std::string& chain, ArgsManager& args)\n {\n     if (chain == CBaseChainParams::MAIN)\n         return std::unique_ptr<CChainParams>(new CMainParams());\n     else if (chain == CBaseChainParams::TESTNET)\n         return std::unique_ptr<CChainParams>(new CTestNetParams());\n     else if (chain == CBaseChainParams::REGTEST)\n-        return std::unique_ptr<CChainParams>(new CRegTestParams());\n+        return std::unique_ptr<CChainParams>(new CRegTestParams(args));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r214523789",
      "id" : 214523789,
      "in_reply_to_id" : 212864830,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDUyMzc4OQ==",
      "original_commit_id" : "ca040b5b76ddeeace6da4f8111169ffd6234414a",
      "original_position" : 118,
      "path" : "src/chainparams.cpp",
      "position" : null,
      "pull_request_review_id" : 151596890,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311",
      "updated_at" : "2018-09-07T22:07:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214523789",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13120787?v=4",
         "events_url" : "https://api.github.com/users/251Labs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/251Labs/followers",
         "following_url" : "https://api.github.com/users/251Labs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/251Labs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/251Labs",
         "id" : 13120787,
         "login" : "251Labs",
         "node_id" : "MDQ6VXNlcjEzMTIwNzg3",
         "organizations_url" : "https://api.github.com/users/251Labs/orgs",
         "received_events_url" : "https://api.github.com/users/251Labs/received_events",
         "repos_url" : "https://api.github.com/users/251Labs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/251Labs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/251Labs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/251Labs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Hopefully fixed all pending nits in the last commit to be squashed, please remind me if I left anything out. Also sorry about the wait, back from vacation.",
      "created_at" : "2018-09-05T00:06:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#issuecomment-418556456",
      "id" : 418556456,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13311",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxODU1NjQ1Ng==",
      "updated_at" : "2018-09-05T00:06:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/418556456",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1008458?v=4",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "node_id" : "MDQ6VXNlcjEwMDg0NTg=",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Looks good to me, fwiw",
      "created_at" : "2018-09-06T00:04:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#issuecomment-418919835",
      "id" : 418919835,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13311",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxODkxOTgzNQ==",
      "updated_at" : "2018-09-06T00:04:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/418919835",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Of course, @DrahtBot , from now on I will rebase all my open PRs whenever you ask. Starting today with this PR. Thanks",
      "created_at" : "2018-09-07T22:09:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#issuecomment-419579264",
      "id" : 419579264,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13311",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxOTU3OTI2NA==",
      "updated_at" : "2018-09-07T22:09:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/419579264",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1008458?v=4",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "node_id" : "MDQ6VXNlcjEwMDg0NTg=",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->Note to reviewers: This pull request conflicts with the following ones:\n\n* #14211 (Use MakeUnique to construct objects owned by unique_ptrs by practicalswift)\n* #14053 (Add address-based index (attempt 4?) by marcinja)\n* #14045 (refactor: Fix the chainparamsbase -> util circular dependency by Empact)\n* #13751 (Utils and libraries: Drops the boost/algorithm/string/split.hpp dependency by 251Labs)\n* #10823 (Allow all mempool txs to be replaced after a configurable timeout (default 6h) by greenaddress)\n* #10443 (Add fee_est tool for debugging fee estimation code by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2018-09-10T01:49:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#issuecomment-419764792",
      "id" : 419764792,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13311",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxOTc2NDc5Mg==",
      "updated_at" : "2018-09-13T02:12:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/419764792",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 18d5f26",
      "created_at" : "2018-09-12T20:04:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#issuecomment-420779255",
      "id" : 420779255,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13311",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyMDc3OTI1NQ==",
      "updated_at" : "2018-09-12T20:04:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/420779255",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "node_id" : "MDQ6VXNlcjExMTU0MTE4",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r217928196"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/217928196"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Any reason to not use `gArgs` global in `CRegTestParams` constructor?",
      "commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "created_at" : "2018-09-16T21:19:08Z",
      "diff_hunk" : "@@ -343,23 +343,65 @@ class CRegTestParams : public CChainParams {\n         /* enable fallback fee on regtest */\n         m_fallback_fee_enabled = true;\n     }\n+\n+    /**\n+     * Allows modifying the Version Bits regtest parameters.\n+     */\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    {\n+        consensus.vDeployments[d].nStartTime = nStartTime;\n+        consensus.vDeployments[d].nTimeout = nTimeout;\n+    }\n+    void UpdateVersionBitsParametersFromArgs(const ArgsManager& args);\n };\n \n-static std::unique_ptr<CChainParams> globalChainParams;\n+void CRegTestParams::UpdateVersionBitsParametersFromArgs(const ArgsManager& args)\n+{\n+    if (!args.IsArgSet(\"-vbparams\")) return;\n+\n+    for (const std::string& strDeployment : args.GetArgs(\"-vbparams\")) {\n+        std::vector<std::string> vDeploymentParams;\n+        boost::split(vDeploymentParams, strDeployment, boost::is_any_of(\":\"));\n+        if (vDeploymentParams.size() != 3) {\n+            throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:start:end\");\n+        }\n+        int64_t nStartTime, nTimeout;\n+        if (!ParseInt64(vDeploymentParams[1], &nStartTime)) {\n+            throw std::runtime_error(strprintf(\"Invalid nStartTime (%s)\", vDeploymentParams[1]));\n+        }\n+        if (!ParseInt64(vDeploymentParams[2], &nTimeout)) {\n+            throw std::runtime_error(strprintf(\"Invalid nTimeout (%s)\", vDeploymentParams[2]));\n+        }\n+        bool found = false;\n+        for (int j=0; j<(int)Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++j) {\n+            if (vDeploymentParams[0].compare(VersionBitsDeploymentInfo[j].name) == 0) {\n+                UpdateVersionBitsParameters(Consensus::DeploymentPos(j), nStartTime, nTimeout);\n+                found = true;\n+                LogPrintf(\"Setting version bits activation parameters for %s to start=%ld, timeout=%ld\\n\", vDeploymentParams[0], nStartTime, nTimeout);\n+                break;\n+            }\n+        }\n+        if (!found) {\n+            throw std::runtime_error(strprintf(\"Invalid deployment (%s)\", vDeploymentParams[0]));\n+        }\n+    }\n+}\n+\n+static std::unique_ptr<const CChainParams> globalChainParams;\n \n const CChainParams &Params() {\n     assert(globalChainParams);\n     return *globalChainParams;\n }\n \n-std::unique_ptr<CChainParams> CreateChainParams(const std::string& chain)\n+std::unique_ptr<const CChainParams> CreateChainParams(const std::string& chain)\n {\n     if (chain == CBaseChainParams::MAIN)\n         return std::unique_ptr<CChainParams>(new CMainParams());\n     else if (chain == CBaseChainParams::TESTNET)\n         return std::unique_ptr<CChainParams>(new CTestNetParams());\n     else if (chain == CBaseChainParams::REGTEST)\n-        return std::unique_ptr<CChainParams>(new CRegTestParams());\n+        return std::unique_ptr<CChainParams>(new CRegTestParams(gArgs));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r217928196",
      "id" : 217928196,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNzkyODE5Ng==",
      "original_commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "original_position" : 110,
      "path" : "src/chainparams.cpp",
      "position" : 110,
      "pull_request_review_id" : 155758424,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311",
      "updated_at" : "2018-09-16T21:19:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/217928196",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Any reason to use the global instead of a parameter?\nI think it's more encapsulated this way, but I tend to be alergic to\nglobals ib general. If people prefer a global I guess I will have to change\nit.\n\n\nOn Sun, 16 Sep 2018, 23:21 Joo Barbosa, <notifications@github.com> wrote:\n\n> *@promag* commented on this pull request.\n>\n> utACK 18d5f26\n> <https://github.com/bitcoin/bitcoin/commit/18d5f2621f2ade428e631d34b95e23c8be862ec8>,\n> with a little question.\n> ------------------------------\n>\n> In src/chainparams.cpp\n> <https://github.com/bitcoin/bitcoin/pull/13311#discussion_r217928196>:\n>\n> >  {\n>      if (chain == CBaseChainParams::MAIN)\n>          return std::unique_ptr<CChainParams>(new CMainParams());\n>      else if (chain == CBaseChainParams::TESTNET)\n>          return std::unique_ptr<CChainParams>(new CTestNetParams());\n>      else if (chain == CBaseChainParams::REGTEST)\n> -        return std::unique_ptr<CChainParams>(new CRegTestParams());\n> +        return std::unique_ptr<CChainParams>(new CRegTestParams(gArgs));\n>\n> Any reason to not use gArgs global in CRegTestParams constructor?\n>\n> \n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/13311#pullrequestreview-155758424>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AA9jStqUTYlVdHuFThL_C3Io272IQd7eks5ubsDAgaJpZM4UKcd3>\n> .\n>\n",
      "created_at" : "2018-09-16T22:37:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#issuecomment-421845888",
      "id" : 421845888,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13311",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyMTg0NTg4OA==",
      "updated_at" : "2018-09-16T22:37:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/421845888",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1008458?v=4",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "node_id" : "MDQ6VXNlcjEwMDg0NTg=",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r218418992"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218418992"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The class only uses the global for initialisation; I think it makes sense to supply it as a parameter for initialisation rather than making the entire class dependent on the global. YMMV, FWIW, etc.",
      "commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "created_at" : "2018-09-18T12:54:05Z",
      "diff_hunk" : "@@ -343,23 +343,65 @@ class CRegTestParams : public CChainParams {\n         /* enable fallback fee on regtest */\n         m_fallback_fee_enabled = true;\n     }\n+\n+    /**\n+     * Allows modifying the Version Bits regtest parameters.\n+     */\n+    void UpdateVersionBitsParameters(Consensus::DeploymentPos d, int64_t nStartTime, int64_t nTimeout)\n+    {\n+        consensus.vDeployments[d].nStartTime = nStartTime;\n+        consensus.vDeployments[d].nTimeout = nTimeout;\n+    }\n+    void UpdateVersionBitsParametersFromArgs(const ArgsManager& args);\n };\n \n-static std::unique_ptr<CChainParams> globalChainParams;\n+void CRegTestParams::UpdateVersionBitsParametersFromArgs(const ArgsManager& args)\n+{\n+    if (!args.IsArgSet(\"-vbparams\")) return;\n+\n+    for (const std::string& strDeployment : args.GetArgs(\"-vbparams\")) {\n+        std::vector<std::string> vDeploymentParams;\n+        boost::split(vDeploymentParams, strDeployment, boost::is_any_of(\":\"));\n+        if (vDeploymentParams.size() != 3) {\n+            throw std::runtime_error(\"Version bits parameters malformed, expecting deployment:start:end\");\n+        }\n+        int64_t nStartTime, nTimeout;\n+        if (!ParseInt64(vDeploymentParams[1], &nStartTime)) {\n+            throw std::runtime_error(strprintf(\"Invalid nStartTime (%s)\", vDeploymentParams[1]));\n+        }\n+        if (!ParseInt64(vDeploymentParams[2], &nTimeout)) {\n+            throw std::runtime_error(strprintf(\"Invalid nTimeout (%s)\", vDeploymentParams[2]));\n+        }\n+        bool found = false;\n+        for (int j=0; j<(int)Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++j) {\n+            if (vDeploymentParams[0].compare(VersionBitsDeploymentInfo[j].name) == 0) {\n+                UpdateVersionBitsParameters(Consensus::DeploymentPos(j), nStartTime, nTimeout);\n+                found = true;\n+                LogPrintf(\"Setting version bits activation parameters for %s to start=%ld, timeout=%ld\\n\", vDeploymentParams[0], nStartTime, nTimeout);\n+                break;\n+            }\n+        }\n+        if (!found) {\n+            throw std::runtime_error(strprintf(\"Invalid deployment (%s)\", vDeploymentParams[0]));\n+        }\n+    }\n+}\n+\n+static std::unique_ptr<const CChainParams> globalChainParams;\n \n const CChainParams &Params() {\n     assert(globalChainParams);\n     return *globalChainParams;\n }\n \n-std::unique_ptr<CChainParams> CreateChainParams(const std::string& chain)\n+std::unique_ptr<const CChainParams> CreateChainParams(const std::string& chain)\n {\n     if (chain == CBaseChainParams::MAIN)\n         return std::unique_ptr<CChainParams>(new CMainParams());\n     else if (chain == CBaseChainParams::TESTNET)\n         return std::unique_ptr<CChainParams>(new CTestNetParams());\n     else if (chain == CBaseChainParams::REGTEST)\n-        return std::unique_ptr<CChainParams>(new CRegTestParams());\n+        return std::unique_ptr<CChainParams>(new CRegTestParams(gArgs));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13311#discussion_r218418992",
      "id" : 218418992,
      "in_reply_to_id" : 217928196,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxODQxODk5Mg==",
      "original_commit_id" : "18d5f2621f2ade428e631d34b95e23c8be862ec8",
      "original_position" : 110,
      "path" : "src/chainparams.cpp",
      "position" : 110,
      "pull_request_review_id" : 156350079,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13311",
      "updated_at" : "2018-09-18T12:54:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218418992",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   }
]
