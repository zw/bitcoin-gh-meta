[
   {
      "author_association" : "MEMBER",
      "body" : "Ping @Flowdalic  ",
      "created_at" : "2018-06-01T12:10:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/13344#issuecomment-393861572",
      "id" : 393861572,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13344",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5Mzg2MTU3Mg==",
      "updated_at" : "2018-06-01T12:10:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/393861572",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Short update: was trying around two days trying all tricks that Dr. Google had on stock. There are reports that passing the args as environmental variable in might work in Fedora, no success in Ubuntu.\r\nImho the perfectly usable solution would support calling the executable with %i do one could for example systemctl bitcoind@conf1.service \r\n",
      "created_at" : "2018-06-01T13:10:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/13344#issuecomment-393875674",
      "id" : 393875674,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13344",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5Mzg3NTY3NA==",
      "updated_at" : "2018-06-01T13:10:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/393875674",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/26601261?v=4",
         "events_url" : "https://api.github.com/users/HashUnlimited/events{/privacy}",
         "followers_url" : "https://api.github.com/users/HashUnlimited/followers",
         "following_url" : "https://api.github.com/users/HashUnlimited/following{/other_user}",
         "gists_url" : "https://api.github.com/users/HashUnlimited/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/HashUnlimited",
         "id" : 26601261,
         "login" : "HashUnlimited",
         "node_id" : "MDQ6VXNlcjI2NjAxMjYx",
         "organizations_url" : "https://api.github.com/users/HashUnlimited/orgs",
         "received_events_url" : "https://api.github.com/users/HashUnlimited/received_events",
         "repos_url" : "https://api.github.com/users/HashUnlimited/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/HashUnlimited/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/HashUnlimited/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/HashUnlimited"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Next one, it's complaining it can't do anything with MemoryDenyWriteExecute=true -> still ok, comment out.\r\n\r\nCould you elaborate on that a bit? Who is complaining? What is the exact message you see and where do you see it? What is the output of `systemctl status bitcoind` if the service is stoped and started?\r\n\r\n> added user bitcoin sudo adduser --system --group --no-create-home bitcoin\r\n\r\nThat could be one issue: The systemd file expects the bitcoin user to have a home directory, potentially at `/var/lib/bitcoin`. It depends on how your bitcoin.conf looks like. Could you show it to us?",
      "created_at" : "2018-06-02T10:34:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/13344#issuecomment-394077109",
      "id" : 394077109,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13344",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NDA3NzEwOQ==",
      "updated_at" : "2018-06-02T10:38:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/394077109",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/432385?v=4",
         "events_url" : "https://api.github.com/users/Flowdalic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Flowdalic/followers",
         "following_url" : "https://api.github.com/users/Flowdalic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Flowdalic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Flowdalic",
         "id" : 432385,
         "login" : "Flowdalic",
         "node_id" : "MDQ6VXNlcjQzMjM4NQ==",
         "organizations_url" : "https://api.github.com/users/Flowdalic/orgs",
         "received_events_url" : "https://api.github.com/users/Flowdalic/received_events",
         "repos_url" : "https://api.github.com/users/Flowdalic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Flowdalic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Flowdalic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Flowdalic"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Alright, we are getting \r\n\r\n> [/lib/systemd/system/bitcoin.service:41] Unknown lvalue 'MemoryDenyWriteExecute' in section 'Service'\r\n\r\nThe bitcoin.conf contains the `datadir=/var/lib/bitcoin` so there shouldn't be an issue. Except it doesn't know about the conf because it's not taking the correct conf. \r\n\r\nThe result of my research is, that the line\r\n\r\n`ExecStart=/usr/bin/bitcoind -daemon -conf=/etc/bitcoin/bitcoin.conf -pid=/run/bitcoind/bitcoind.pid`\r\n\r\ncan't ever work correctly because systemd will think the arguments are for systemd itself and for sure not passing them through to bitcoind. So it is just staring a plain bitcoind which is then looking for it's home dir in /hone/bitcoin/ but we didn't create one for our poor little process simply because we want it to use /var/lib/\r\n",
      "created_at" : "2018-06-02T15:13:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/13344#issuecomment-394094277",
      "id" : 394094277,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13344",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NDA5NDI3Nw==",
      "updated_at" : "2018-06-02T15:13:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/394094277",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/26601261?v=4",
         "events_url" : "https://api.github.com/users/HashUnlimited/events{/privacy}",
         "followers_url" : "https://api.github.com/users/HashUnlimited/followers",
         "following_url" : "https://api.github.com/users/HashUnlimited/following{/other_user}",
         "gists_url" : "https://api.github.com/users/HashUnlimited/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/HashUnlimited",
         "id" : 26601261,
         "login" : "HashUnlimited",
         "node_id" : "MDQ6VXNlcjI2NjAxMjYx",
         "organizations_url" : "https://api.github.com/users/HashUnlimited/orgs",
         "received_events_url" : "https://api.github.com/users/HashUnlimited/received_events",
         "repos_url" : "https://api.github.com/users/HashUnlimited/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/HashUnlimited/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/HashUnlimited/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/HashUnlimited"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Alright, we are getting\r\n> \r\n> [/lib/systemd/system/bitcoin.service:41] Unknown lvalue 'MemoryDenyWriteExecute' in section 'Service'\r\n\r\nIndeed, systemd in Ubuntu 16.04 does appear to be to old to support this option. We probably should add a comment to the shipped systemd service file explaining the situation that it requires systemd >= 231.\r\n\r\n> The bitcoin.conf contains the datadir=/var/lib/bitcoin so there shouldn't be an issue. \r\n\r\nRight, that appears to be OK then.\r\n\r\n> The result of my research is, that the line\r\n> \r\n> ExecStart=/usr/bin/bitcoind -daemon -conf=/etc/bitcoin/bitcoin.conf -pid=/run/bitcoind/bitcoind.pid\r\n> \r\n> can't ever work correctly because systemd will think the arguments are for systemd\r\n\r\nCould you share the references of your research which lead you to that conclusion? As far as I can tell the ExecStart rvalue is sound and works as intended. This is for example the truncated output from one of my bitcoind boxes `systemctl status bitcoind`:\r\n\r\n```\r\n   CGroup: /system.slice/bitcoind.service\r\n           Ã¢ÂÂÃ¢ÂÂ230 /usr/bin/bitcoind -daemon -conf=/etc/bitcoin/bitcoin.conf -pid=/run/bitcoind/bitcoind.>\r\n```\r\n\r\nHow does your output look like?",
      "created_at" : "2018-06-03T09:13:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/13344#issuecomment-394148294",
      "id" : 394148294,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13344",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NDE0ODI5NA==",
      "updated_at" : "2018-06-03T09:16:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/394148294",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/432385?v=4",
         "events_url" : "https://api.github.com/users/Flowdalic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Flowdalic/followers",
         "following_url" : "https://api.github.com/users/Flowdalic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Flowdalic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Flowdalic",
         "id" : 432385,
         "login" : "Flowdalic",
         "node_id" : "MDQ6VXNlcjQzMjM4NQ==",
         "organizations_url" : "https://api.github.com/users/Flowdalic/orgs",
         "received_events_url" : "https://api.github.com/users/Flowdalic/received_events",
         "repos_url" : "https://api.github.com/users/Flowdalic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Flowdalic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Flowdalic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Flowdalic"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "\r\nThe first clue about what is going on came from [Stackexchange](https://superuser.com/questions/728951/systemd-giving-my-service-multiple-arguments) (as usual). There are several similar inquiries around which are all claiming that a workaround is needed to pass arguments to a systemd service. It also appears that Xenial (or at least the deployment I got there) is extremely restrictive because I couldn't get any workaround I found to do the job. \r\n\r\nThe folder and permission setup must be all correct because just running the ExecStart content from command line is just doing as expected.\r\n\r\nUnfortunately I can't get to a valid output of `systemctl status bitcoind.service` unless I create a home dir for the user bitcoin. Tbh I don't want to do this here on the production environment just to prove that we are not taking the arguments as with the standard line the log looks like\r\n\r\n>  -- Unit bitcoin.service has begun starting up.\r\nJun 04 04:35:21 FAILOVER bitcoind[24073]: ************************\r\nJun 04 04:35:21 FAILOVER bitcoind[24073]: EXCEPTION: N5boost10filesystem16filesystem_errorE\r\nJun 04 04:35:21 FAILOVER bitcoind[24073]: boost::filesystem::create_directories: Permission denied: \"/home/bitcoin\"\r\n\r\nTo me that already means we are ignoring the `-conf=/etc/bitcoin/bitcoin.conf` argument ",
      "created_at" : "2018-06-04T09:01:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/13344#issuecomment-394284369",
      "id" : 394284369,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13344",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NDI4NDM2OQ==",
      "updated_at" : "2018-06-04T09:01:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/394284369",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/26601261?v=4",
         "events_url" : "https://api.github.com/users/HashUnlimited/events{/privacy}",
         "followers_url" : "https://api.github.com/users/HashUnlimited/followers",
         "following_url" : "https://api.github.com/users/HashUnlimited/following{/other_user}",
         "gists_url" : "https://api.github.com/users/HashUnlimited/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/HashUnlimited",
         "id" : 26601261,
         "login" : "HashUnlimited",
         "node_id" : "MDQ6VXNlcjI2NjAxMjYx",
         "organizations_url" : "https://api.github.com/users/HashUnlimited/orgs",
         "received_events_url" : "https://api.github.com/users/HashUnlimited/received_events",
         "repos_url" : "https://api.github.com/users/HashUnlimited/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/HashUnlimited/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/HashUnlimited/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/HashUnlimited"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@HashUnlimited Did you specify `-datadir`?",
      "created_at" : "2018-06-04T09:35:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/13344#issuecomment-394294020",
      "id" : 394294020,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13344",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NDI5NDAyMA==",
      "updated_at" : "2018-06-04T09:35:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/394294020",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "node_id" : "MDQ6VXNlcjExMTU0MTE4",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "yep, in bitcoin.conf",
      "created_at" : "2018-06-04T10:06:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/13344#issuecomment-394302488",
      "id" : 394302488,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13344",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NDMwMjQ4OA==",
      "updated_at" : "2018-06-04T10:06:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/394302488",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/26601261?v=4",
         "events_url" : "https://api.github.com/users/HashUnlimited/events{/privacy}",
         "followers_url" : "https://api.github.com/users/HashUnlimited/followers",
         "following_url" : "https://api.github.com/users/HashUnlimited/following{/other_user}",
         "gists_url" : "https://api.github.com/users/HashUnlimited/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/HashUnlimited",
         "id" : 26601261,
         "login" : "HashUnlimited",
         "node_id" : "MDQ6VXNlcjI2NjAxMjYx",
         "organizations_url" : "https://api.github.com/users/HashUnlimited/orgs",
         "received_events_url" : "https://api.github.com/users/HashUnlimited/received_events",
         "repos_url" : "https://api.github.com/users/HashUnlimited/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/HashUnlimited/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/HashUnlimited/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/HashUnlimited"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> To me that already means we are ignoring the -conf=/etc/bitcoin/bitcoin.conf argument\r\n\r\nOr it means that bitcoind tries to do something in $HOME even before reading its configuration file. Which results do you get if you create the user's home?",
      "created_at" : "2018-06-04T13:37:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/13344#issuecomment-394357496",
      "id" : 394357496,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13344",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NDM1NzQ5Ng==",
      "updated_at" : "2018-06-04T13:37:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/394357496",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/432385?v=4",
         "events_url" : "https://api.github.com/users/Flowdalic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Flowdalic/followers",
         "following_url" : "https://api.github.com/users/Flowdalic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Flowdalic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Flowdalic",
         "id" : 432385,
         "login" : "Flowdalic",
         "node_id" : "MDQ6VXNlcjQzMjM4NQ==",
         "organizations_url" : "https://api.github.com/users/Flowdalic/orgs",
         "received_events_url" : "https://api.github.com/users/Flowdalic/received_events",
         "repos_url" : "https://api.github.com/users/Flowdalic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Flowdalic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Flowdalic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Flowdalic"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "In that case it was taking everything including the .conf from its home folder. \r\nCreating a user and a home folder for each instance would be a workaround but then I need a sudo to monitor the processes.",
      "created_at" : "2018-06-04T13:43:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/13344#issuecomment-394359402",
      "id" : 394359402,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13344",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NDM1OTQwMg==",
      "updated_at" : "2018-06-04T13:43:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/394359402",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/26601261?v=4",
         "events_url" : "https://api.github.com/users/HashUnlimited/events{/privacy}",
         "followers_url" : "https://api.github.com/users/HashUnlimited/followers",
         "following_url" : "https://api.github.com/users/HashUnlimited/following{/other_user}",
         "gists_url" : "https://api.github.com/users/HashUnlimited/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/HashUnlimited",
         "id" : 26601261,
         "login" : "HashUnlimited",
         "node_id" : "MDQ6VXNlcjI2NjAxMjYx",
         "organizations_url" : "https://api.github.com/users/HashUnlimited/orgs",
         "received_events_url" : "https://api.github.com/users/HashUnlimited/received_events",
         "repos_url" : "https://api.github.com/users/HashUnlimited/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/HashUnlimited/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/HashUnlimited/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/HashUnlimited"
      }
   }
]
