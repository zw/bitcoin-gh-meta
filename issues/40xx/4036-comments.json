[
   {
      "body" : "The message is accurate. Shutting down your computer while bitcoin is running can be dangerous. If it is not shut down properly, the database (or even wallet) may be left in a corrupted state.",
      "created_at" : "2014-04-09T18:01:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4036#issuecomment-39996297",
      "id" : 39996297,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4036",
      "updated_at" : "2014-04-09T18:02:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/39996297",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Maybe you could use [QtCloseEvent](http://qt-project.org/doc/qt-4.8/qcloseevent.html) to prevent windows program termination during important tasks. This way when program close is requested it can prevent termination during the bitcoin shutdown tasks, then release control.",
      "created_at" : "2014-04-09T19:33:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4036#issuecomment-40006708",
      "id" : 40006708,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4036",
      "updated_at" : "2014-04-09T19:33:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/40006708",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/251852?v=3",
         "events_url" : "https://api.github.com/users/drak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/drak/followers",
         "following_url" : "https://api.github.com/users/drak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/drak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/drak",
         "id" : 251852,
         "login" : "drak",
         "organizations_url" : "https://api.github.com/users/drak/orgs",
         "received_events_url" : "https://api.github.com/users/drak/received_events",
         "repos_url" : "https://api.github.com/users/drak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/drak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/drak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/drak"
      }
   },
   {
      "body" : "Thanks - yes, it's more than just the message. The problem is that a user hits shutdown, then the user sees the message that they should not have done it. Like @drak said, can we make bitcoin stall shutdown so it can finish?\r\nSee:\r\nQSessionManager::cancel ()\r\nhttps://qt-project.org/doc/qt-4.7/qsessionmanager.html#id-df0f5c47-b430-4fdb-8ef2-d1214a82b61f\r\n\"Tells the session manager to cancel the shutdown process. Applications should not call this function without asking the user first.\r\nSee also allowsInteraction() and allowsErrorInteraction().\"\r\n\r\nI'd suggest popping up a window with \"Shutdown bitcoin or cancel system log off?\" with an \"ok\" and \"cancel\" button if allowsInteraction() is true. \"ok\" triggers normal bitcoin close, \"cancel\" triggers QSessionManager:cancel(). It won't prevent remote shutdowns, but if allowsInteraction() is true, it will stop users from shutting down accidentally.\r\n\r\nEDIT: an example of catching the shutdown signal and cancelling it is here:\r\nhttp://qt.developpez.com/doc/4.7/qsessionmanager/#allowsinteraction",
      "created_at" : "2014-04-09T20:14:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4036#issuecomment-40011021",
      "id" : 40011021,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4036",
      "updated_at" : "2014-04-09T20:19:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/40011021",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/424153?v=3",
         "events_url" : "https://api.github.com/users/maqifrnswa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maqifrnswa/followers",
         "following_url" : "https://api.github.com/users/maqifrnswa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maqifrnswa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maqifrnswa",
         "id" : 424153,
         "login" : "maqifrnswa",
         "organizations_url" : "https://api.github.com/users/maqifrnswa/orgs",
         "received_events_url" : "https://api.github.com/users/maqifrnswa/received_events",
         "repos_url" : "https://api.github.com/users/maqifrnswa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maqifrnswa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maqifrnswa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maqifrnswa"
      }
   },
   {
      "body" : "I have got working code for this at least for Windows, I'll create a patch tomorrow for review :).",
      "created_at" : "2014-04-09T20:48:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4036#issuecomment-40014486",
      "id" : 40014486,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4036",
      "updated_at" : "2014-04-09T20:48:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/40014486",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "For *nix implement callback signal(SIGINT, sigint_callback) via signal.h &\nerrno.h would work does Windows use this? then you are already done? :-)\n\n\nOn Wed, Apr 9, 2014 at 4:49 PM, P. Kaufmann <notifications@github.com>wrote:\n\n> I have got working code for this at least for Windows, I'll create a patch\n> tomorrow for review :).\n>\n> --\n> Reply to this email directly or view it on GitHub<https://github.com/bitcoin/bitcoin/issues/4036#issuecomment-40014486>\n> .\n>\n\n\n\n-- \nJourdain Casale\nLead Computer Scientist | Advanced Research Projects | CASCORP\nDirect: +1 (647) 505-5919\n\n--\nThis message contains confidential information and is intended only for the\nindividual named. If you are not the named addressee you should not\ndisseminate, distribute or copy this e-mail. Please notify the sender\nimmediately by e-mail if you have received this e-mail by mistake and\ndelete this e-mail from your system. E-mail transmission cannot be\nguaranteed to be secure or error-free as information could be intercepted,\ncorrupted, lost, destroyed, arrive late or incomplete, or contain viruses.\nThe sender therefore does not accept liability for any errors or omissions\nin the contents of this message, which arise as a result of e-mail\ntransmission. If verification is required please request a hard-copy\nversion.\n\n-----BEGIN PGP PUBLIC KEY BLOCK-----\nVersion: GnuPG/MacGPG2 v2.0.22 (Darwin)\nComment: GPGTools - https://gpgtools.org\n\nmQENBFMslfEBCADPHwWP4QOLRNSRvmfhNSaz9L/pItzvJV/sq6kfNzu7su+Ng74+\no8pa7cq/MPvZnNlc/+jWprS8Z+kzrqA7Yq0vInQsTEGF8iI72kSDZOy/7vPyjtUK\nfn9tXThmTQOgeHc6aNt2cU0MAjHZPuOIBpV7UJoqZ7qwbss8cl5n+FjuAJ8DlGee\nyH/12NdF/CMW/icKz1yMZHk2mg28CV2QNPH44N1Xm6AtqTMp8JARrImMxD75Djft\nspxi/cylHFj8J7mcG385fymT7K2711IchwEc3via/9yP0wooUrOTQHJE8jsAvW8j\n+kLG2W5918Sl/uCUfeHIN3AqVzMCr/uHSkD5ABEBAAG0JUpvdXJkYWluIENhc2Fs\nZSA8Y2FzYWxlakBjYXNjb3JwLm5ldD6JAT0EEwEKACcFAlMslfECGwMFCQeGH4AF\nCwkIBwMFFQoJCAsFFgIDAQACHgECF4AACgkQYgTBL9o3+X8zYAgAucKxn0oDTwI8\n5EUCxTlaT/wHfUt02LPlbbccrrGY280BLRVqy2OqbZK+vsxLQgyUwQg4jaMuMhIQ\nhBmQlZAAx/FeFnbPKhDVmHdmtURxxjDgZXrX6QvBElllHUI9JKlRQheQ58k41pIq\nw7nFVq8bTTO8SxngTRH8kVXWwe4HPcbBqNrqEyjodrtQh4mPUAaWwHi0F+4odyV9\nWc6sMojAxn6bFwKHcpirTtJ5CMmcwJt2vJJL1QR7DqhpyWiTSf48WJOkrdl3+jw/\nlmhhakaZLQ45xWiGV0mdWpCYKZ5YOPJR8QjY/xbnoXKOK2rQAUAhmSUfG4Pbqruj\n7/hgIQKk07kBDQRTLJXxAQgAvJSWefy8IbGHIl5wrCuGptpBSCrOCrx/j+0OgxEN\nSQH+Z/xJ7nenJZra04y/VjdNqaYjWzuU/ksrmKAz3oLTz1V/nY/mjKjwy/OfyIw8\nPhDdCTpC6O41pyLbo4KR3MyWGtRiVhCpP81Uu7oBl9FdpoANx3V7mVOCT/PM+yxZ\nxQGSCVViuUMm/xNOWqoJkTEDevGVja3C0gN4FxYHRFMegp9cYbe9G8o6zNAnAfTr\n1X/3Y1B4Ocmr32TJrnuH65cjbRpPLgoYIb5pfG/gzskwgk0GB2myx/h5XbcX0kIN\na8giBnjvss6/C0RhPnCpbCL9ZJrXiCH6XTEC+Cnm9DGwkQARAQABiQElBBgBCgAP\nBQJTLJXxAhsMBQkHhh+AAAoJEGIEwS/aN/l/fkQIAIUmBV0ArsJ8lSIaKUHKy8oq\nHxpfxabLwA0PMb/LzQPs+FbOZfKm6Micz04trcAdL9ZPstO7k+0YNB7ifwqPhCkw\nSSF2XXX5+2TxiMYQWNzBM0+bBteqz8x7ksmq9icJHf1FBYA9so18CmWJYnfcWN8u\nCijEWJvFEb9sZMoBbvswmBDORDqmyF2OHsr7lAPUUI5ry6vHtqoeCmZiLfEyFbO+\nhxVyFJPebO3+KZP03mCfbjMGbI9qzZtQiFqxqsBm+Sg+d9C//48bnfmAusUR//5f\nlSU0WF03e7NL6CDAsYQInJaLEnWel129d2ODqkrUvGDRC0aShrbjmIrmuENksIQ=\n=tsNb\n-----END PGP PUBLIC KEY BLOCK-----",
      "created_at" : "2014-04-09T21:01:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4036#issuecomment-40015895",
      "id" : 40015895,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4036",
      "updated_at" : "2014-04-09T21:01:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/40015895",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3901235?v=3",
         "events_url" : "https://api.github.com/users/PeacefulAnimal/events{/privacy}",
         "followers_url" : "https://api.github.com/users/PeacefulAnimal/followers",
         "following_url" : "https://api.github.com/users/PeacefulAnimal/following{/other_user}",
         "gists_url" : "https://api.github.com/users/PeacefulAnimal/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/PeacefulAnimal",
         "id" : 3901235,
         "login" : "PeacefulAnimal",
         "organizations_url" : "https://api.github.com/users/PeacefulAnimal/orgs",
         "received_events_url" : "https://api.github.com/users/PeacefulAnimal/received_events",
         "repos_url" : "https://api.github.com/users/PeacefulAnimal/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/PeacefulAnimal/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/PeacefulAnimal/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/PeacefulAnimal"
      }
   },
   {
      "body" : "If it's possible to hold the windows shutdown it should be done in a non-QT specific way because the gui-less daemon also needs to close itself completely. I'm unsure if we have any more remaining issues where shutdown will take more than a few secondsÃ¢ÂÂ we probably do.",
      "created_at" : "2014-04-09T22:30:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4036#issuecomment-40024582",
      "id" : 40024582,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4036",
      "updated_at" : "2014-04-09T22:30:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/40024582",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "@gmaxwell Several, at least these I know of:\r\n\r\n#3966 Client keeps updating tip after Shutdown requested\r\n#2954 Opencon thread massively slows down client shutdown\r\n\r\nIt could be frustrating to hold up shutdown in this case, though it's certainly better than forcing shutting down and possibly breaking something.\r\n",
      "created_at" : "2014-04-10T05:54:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4036#issuecomment-40045458",
      "id" : 40045458,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4036",
      "updated_at" : "2014-04-10T05:57:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/40045458",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
