[
   {
      "body" : "Note that the log in https://github.com/bitcoin/bitcoin/issues/3997#issuecomment-41220141 has more examples of these warnings, and was from a bitcoin-qt built from the same commit.",
      "created_at" : "2014-04-24T17:05:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4091#issuecomment-41305818",
      "id" : 41305818,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4091",
      "updated_at" : "2014-04-24T17:05:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41305818",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=3",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "body" : "I've noticed that if I run bitcoin-qt with a large wallet.dat loaded, it locks up for over 3 minutes each time a block is found, with one of the CPU cores using 100% CPU flat out.  The debug.log shows:\r\n\r\n    2014-04-27 20:39:26 UpdateTip: new best=00000000000000005af8d5387a8a595ed2a34167c55b14cdcaa97e5c380f6c7b  height=298031  log2_work=78.256738  tx=37671615  date=2014-04-27 20:38:52 progress=0.999998\r\n    2014-04-27 20:39:26 ProcessBlock: ACCEPTED\r\n    2014-04-27 20:42:40 ERROR: AcceptToMemoryPool : inputs already spent\r\n\r\nNote over 3 minutes of nothing between the 2nd and 3rd lines.  Another example:\r\n\r\n    2014-04-27 20:30:45 UpdateTip: new best=000000000000000020365ab82fbf0d69b29f3c8889acd8241f4bf97951d6995a  height=298028  log2_work=78.256379  tx=37671170  date=2014-04-27 20:31:03 progress=1.000001\r\n    2014-04-27 20:30:45 ProcessBlock: ACCEPTED\r\n    [3 minute gap]\r\n    2014-04-27 20:33:54 Peer 176.67.167.236:8333 is stalling block download, disconnecting\r\n    2014-04-27 20:33:54 ERROR: AcceptToMemoryPool : inputs already spent\r\n    2014-04-27 20:33:55 ERROR: AcceptToMemoryPool : inputs already spent\r\n    2014-04-27 20:33:55 POTENTIAL DEADLOCK DETECTED\r\n    2014-04-27 20:33:55 Previous lock order was:\r\n    2014-04-27 20:33:55  pnode->cs_vRecvMsg  net.cpp:1537\r\n    2014-04-27 20:33:55  (1) cs_main  main.cpp:3718\r\n    2014-04-27 20:33:55  (2) cs_vSend  net.h:449\r\n    2014-04-27 20:33:55 Current lock order is:\r\n    2014-04-27 20:33:55  (2) pnode->cs_vSend  net.cpp:1556\r\n    2014-04-27 20:33:55  (1) cs_main  main.cpp:4206\r\n    2014-04-27 20:33:55  (1) cs_main  main.cpp:1313\r\n    2014-04-27 20:33:55 ERROR: AcceptToMemoryPool : inputs already spent\r\n\r\nIf I run bitcoind instead, I don't see these delays when blocks are found.\r\n\r\nBoth bitcoin-qt and bitcoind were built from commit 89bbd54fbfbb1b21257d436731868455821a101e.",
      "created_at" : "2014-04-27T20:52:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4091#issuecomment-41508675",
      "id" : 41508675,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4091",
      "updated_at" : "2014-04-27T20:52:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41508675",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=3",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "body" : "Can you profile where it spends all that time?\r\n\r\nI still don't have any large-wallet cases to test with, so cannot reproduce this myself.\r\n",
      "created_at" : "2014-04-28T01:59:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4091#issuecomment-41517478",
      "id" : 41517478,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4091",
      "updated_at" : "2014-04-28T01:59:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41517478",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "What tool do you recommend for profiling on Linux?",
      "created_at" : "2014-04-28T04:38:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4091#issuecomment-41522459",
      "id" : 41522459,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4091",
      "updated_at" : "2014-04-28T04:38:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41522459",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=3",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "body" : "Also, I think you can make a large wallet by calling 'getnewaddress' in a loop lots of times.  I don't know if it matters that they have lots of different labels like my large wallet does.",
      "created_at" : "2014-04-28T04:47:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4091#issuecomment-41522713",
      "id" : 41522713,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4091",
      "updated_at" : "2014-04-28T04:47:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41522713",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=3",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "body" : "That wouldn't be a very realistic use case. Large wallets also have lots of incoming and outgoing transactions.\r\n\r\nAs for profiling, I think using gprof is easiest, although there are many other tools available under Linux such has callgrind, oprofile, sysprofile which may work better in some cases.",
      "created_at" : "2014-04-28T04:53:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4091#issuecomment-41522946",
      "id" : 41522946,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4091",
      "updated_at" : "2014-04-28T04:53:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41522946",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I tried a very simple approach of hitting control-C in gdb while it was busy and asking 'where' over and over.  All 19 times it reported being in:\r\n\r\n    #33 0x00005555556611fb in TransactionTableModel::updateConfirmations (\r\n        this=0x5555567373d0) at transactiontablemodel.cpp:264\r\n    #34 0x00005555556147ea in WalletModel::pollBalanceChanged (\r\n        this=this@entry=0x55555618d6d0) at walletmodel.cpp:118\r\n    #35 0x000055555562c670 in WalletModel::qt_static_metacall (_o=0x55555618d6d0, \r\n        _c=<optimized out>, _id=10, _a=0x7fffffffd850) at moc_walletmodel.cpp:82\r\n    #36 0x00007ffff61ed87a in QMetaObject::activate(QObject*, QMetaObject const*, int, void**) () from /usr/lib/x86_64-linux-gnu/libQtCore.so.4\r\n\r\nIs that enough to go on?\r\n\r\nI counted each of the file:line references in the 19 backtraces I got.  Here are the common ones, with the counts:\r\n\r\n     6 transactiontablemodel.cpp:199\r\n     7 transactiontablemodel.cpp:611\r\n     9 transactiontablemodel.cpp:614\r\n    10 sync.cpp:42\r\n    10 transactiontablemodel.cpp:196\r\n    11 sync.cpp:84\r\n    14 sync.cpp:123\r\n\r\nThese line numbers are in a recent HEAD commit c63b2e25a59c602de182a376313ad5d3d62d5045",
      "created_at" : "2014-04-28T05:25:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4091#issuecomment-41523997",
      "id" : 41523997,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4091",
      "updated_at" : "2014-04-28T05:25:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41523997",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=3",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "body" : "I notice that 11 of the 19 times I interrupted it, it was running:\r\n\r\n    LogPrint(\"lock\", \"Locking: %s\\n\", locklocation.ToString());\r\n\r\nIt seems that ```CLockLocation::ToString()``` is heavy.",
      "created_at" : "2014-04-28T05:30:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4091#issuecomment-41524159",
      "id" : 41524159,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4091",
      "updated_at" : "2014-04-28T05:30:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41524159",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=3",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "body" : "So probably a case of locking contention. Maybe due to the lock debugging itself. Try turning it off when you do performance profiling :)\r\n\r\n",
      "created_at" : "2014-04-28T05:52:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4091#issuecomment-41525102",
      "id" : 41525102,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4091",
      "updated_at" : "2014-04-28T05:52:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41525102",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "With the lock debugging disabled, each new block still ties up the CPU (and freezes the window) for a period of time, but it's less than a minute, rather than being over 3 minutes.\r\n\r\nIt's now spending all the time here:\r\n\r\n    #4  0x00007ffff61ed87a in QMetaObject::activate(QObject*, QMetaObject const*, int, void**) () from /usr/lib/x86_64-linux-gnu/libQtCore.so.4\r\n    #5  0x00007ffff6237527 in QAbstractItemModel::dataChanged(QModelIndex const&, QModelIndex const&) () from /usr/lib/x86_64-linux-gnu/libQtCore.so.4\r\n    #6  0x0000555555660e6b in TransactionTableModel::updateConfirmations (\r\n        this=0x55555685c340) at transactiontablemodel.cpp:264\r\n    #7  0x0000555555613909 in WalletModel::pollBalanceChanged (\r\n        this=this@entry=0x555556185d70) at walletmodel.cpp:118\r\n\r\n",
      "created_at" : "2014-04-28T06:23:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4091#issuecomment-41526384",
      "id" : 41526384,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4091",
      "updated_at" : "2014-04-28T06:23:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41526384",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=3",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "body" : "> probably a case of locking contention\r\n\r\nThat wouldn't cause the CPU to get pegged at 100% would it?",
      "created_at" : "2014-04-28T06:24:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4091#issuecomment-41526443",
      "id" : 41526443,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4091",
      "updated_at" : "2014-04-28T06:24:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41526443",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=3",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "body" : "> That wouldn't cause the CPU to get pegged at 100% would it?\r\n\r\n@dooglus it could; threads would be fighting over the lock which can certainly max out a CPU\r\n\r\nI wonder if it generates data changed events, updating the number of confirmations for *every* transaction instead of just the ones visible on the screen (which is the intention). Performance here could be improved in any case, thanks for getting to the bottom of this.\r\n",
      "created_at" : "2014-04-28T06:29:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4091#issuecomment-41526830",
      "id" : 41526830,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4091",
      "updated_at" : "2014-04-28T06:29:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41526830",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I recompiled and profiled with gprof.  The output is huge, and I'm not sure how to read it.  From what I can see it doesn't draw attention to the call chain I pasted above.\r\n\r\nHere are the top few chains it shows:\r\n\r\n    granularity: each sample hit covers 2 byte(s) for 0.00% of 589.66 seconds\r\n\r\n    index % time    self  children    called     name\r\n                                                     <spontaneous>\r\n    [1]     64.5    0.54  380.06                 TransactionFilterProxy::filterAcceptsRow(int, QModelIndex const&) const [1]\r\n                    0.38  319.03 5581880/5582004     QModelIndex::data(int) const [2]\r\n                    0.77   59.45  930967/930979      TransactionTableModel::index(int, int, QModelIndex const&) const [18]\r\n                    0.10    0.06  930871/930871      QString::contains(QString const&, Qt::CaseSensitivity) const [1309]\r\n                    0.09    0.00  930878/930906      QModelIndex::~QModelIndex() [1651]\r\n                    0.03    0.05 1861938/26802754     QString::~QString() [483]\r\n                    0.06    0.00  931139/931139      QBool::operator void const*() const [1990]\r\n                    0.03    0.00  930276/930280      TransactionFilterProxy::TYPE(int) [2654]\r\n                    0.02    0.00  930954/931286      QDateTime::operator>(QDateTime const&) const [3129]\r\n    -----------------------------------------------\r\n                    0.00    0.01     124/5582004     TxViewDelegate::paint(QPainter*, QStyleOptionViewItem const&, QModelIndex const&) const [4489]\r\n                    0.38  319.03 5581880/5582004     TransactionFilterProxy::filterAcceptsRow(int, QModelIndex const&) const [1]\r\n    [2]     54.2    0.38  319.03 5582004         QModelIndex::data(int) const [2]\r\n                    1.47  317.56 5581254/5581254     TransactionTableModel::data(QModelIndex const&, int) const [3]\r\n    -----------------------------------------------\r\n                    1.47  317.56 5581254/5581254     QModelIndex::data(int) const [2]\r\n    [3]     54.1    1.47  317.56 5581254         TransactionTableModel::data(QModelIndex const&, int) const [3]\r\n                    0.20  314.05  928783/928808      AddressTableModel::labelForAddress(QString const&) const [4]\r\n                    0.39    0.69 24692085/26802754     QString::~QString() [483]\r\n                    0.80    0.00 23762806/24299209     QString::fromStdString(std::string const&) [601]\r\n                    0.57    0.00 27433453/27433453     QModelIndex::isValid() const [720]\r\n                    0.48    0.00 27472122/27472122     QModelIndex::internalPointer() const [791]\r\n                    0.32    0.00 21898093/21898093     QModelIndex::column() const [947]\r\n                    0.05    0.00  930672/930699      WalletModel::getAddressTableModel() [2157]\r\n                    0.00    0.02      19/19          TransactionTableModel::formatTxToAddress(TransactionRecord const*, bool) const [3478]\r\n                    0.00    0.00       7/7           TransactionTableModel::addressColor(TransactionRecord const*) const [5141]\r\n                    0.00    0.00      20/20          TransactionTableModel::txAddressDecoration(TransactionRecord const*) const [7229]\r\n                    0.00    0.00      12/47          QColor::QColor(int, int, int, int) [11149]\r\n    -----------------------------------------------\r\n                    0.00    0.00       6/928808      TransactionTableModel::addressColor(TransactionRecord const*) const [5141]\r\n                    0.00    0.01      19/928808      TransactionTableModel::lookupAddress(std::string const&, bool) const [3479]\r\n                    0.20  314.05  928783/928808      TransactionTableModel::data(QModelIndex const&, int) const [3]\r\n    [4]     53.3    0.20  314.05  928808         AddressTableModel::labelForAddress(QString const&) const [4]\r\n                    0.07  293.29  930445/948840      CBitcoinAddress::CBitcoinAddress(std::string const&) [5]\r\n                    0.05   16.44  930124/930124      std::map<boost::variant<CNoDestination, CKeyID, CScriptID, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_>, CAddressBookData, std::less<boost::variant<CNoDestination, CKeyID, CScriptID, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_> >, std::allocator<std::pair<boost::variant<CNoDestination, CKeyID, CScriptID, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_> const, CAddressBookData> > >::find(boost::variant<CNoDestination, CKeyID, CScriptID, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_> const&) [71]\r\n                    0.08    1.52  930850/963023      CBitcoinAddress::Get() const [389]\r\n                    0.03    1.03  930542/1025379     CBitcoinAddress::~CBitcoinAddress() [484]\r\n                    0.07    0.77  930496/1160916     boost::variant<CNoDestination, CKeyID, CScriptID, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_>::~variant() [538]\r\n                    0.02    0.18  930660/96949719     CMutexLock<AnnotatedMixin<boost::recursive_mutex> >::CMutexLock(AnnotatedMixin<boost::recursive_mutex>&, char const*, char const*, int, bool) [52]\r\n                    0.09    0.08  930584/930597      QString::toStdString() const [1262]\r\n                    0.10    0.03  435584/435827      QString::QString() [1439]\r\n                    0.02    0.10  931309/97110659     CMutexLock<AnnotatedMixin<boost::recursive_mutex> >::~CMutexLock() [83]\r\n                    0.01    0.03  931733/950129      std::map<boost::variant<CNoDestination, CKeyID, CScriptID, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_>, CAddressBookData, std::less<boost::variant<CNoDestination, CKeyID, CScriptID, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_> >, std::allocator<std::pair<boost::variant<CNoDestination, CKeyID, CScriptID, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_> const, CAddressBookData> > >::end() [2296]\r\n                    0.01    0.01  495590/495590      std::_Rb_tree_iterator<std::pair<boost::variant<CNoDestination, CKeyID, CScriptID, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_> const, CAddressBookData> >::operator->() const [2923]\r\n                    0.02    0.00  929474/929474      std::_Rb_tree_iterator<std::pair<boost::variant<CNoDestination, CKeyID, CScriptID, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_> const, CAddressBookData> >::operator!=(std::_Rb_tree_iterator<std::pair<boost::variant<CNoDestination, CKeyID, CScriptID, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_, boost::detail::variant::void_> const, CAddressBookData> > const&) const [3130]\r\n                    0.02    0.00  495034/24299209     QString::fromStdString(std::string const&) [601]\r\n    -----------------------------------------------\r\n                    0.00    5.80   18395/948840      ReadKeyValue(CWallet*, CDataStream&, CDataStream&, CWalletScanState&, std::string&, std::string&) [44]\r\n                    0.07  293.29  930445/948840      AddressTableModel::labelForAddress(QString const&) const [4]\r\n    [5]     50.7    0.07  299.08  948840         CBitcoinAddress::CBitcoinAddress(std::string const&) [5]\r\n                    0.00  297.94  949944/949944      CBase58Data::SetString(std::string const&) [6]\r\n                    0.05    1.10  949931/1026400     CBase58Data::CBase58Data() [467]\r\n    -----------------------------------------------\r\n                    0.00  297.94  949944/949944      CBitcoinAddress::CBitcoinAddress(std::string const&) [5]\r\n    [6]     50.5    0.00  297.94  949944         CBase58Data::SetString(std::string const&) [6]\r\n                    0.15  297.79  948495/948495      CBase58Data::SetString(char const*, unsigned int) [7]\r\n    -----------------------------------------------\r\n",
      "created_at" : "2014-04-28T07:23:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4091#issuecomment-41529865",
      "id" : 41529865,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4091",
      "updated_at" : "2014-04-28T07:23:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41529865",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=3",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "body" : "Maybe this is the part of interest:\r\n\r\n    -----------------------------------------------\r\n                    0.00    0.00      12/930979      TransactionTableModel::updateConfirmations() [2287]\r\n                    0.77   59.45  930967/930979      TransactionFilterProxy::filterAcceptsRow(int, QModelIndex const&) const [1]\r\n    [18]    10.2    0.77   59.45  930979         TransactionTableModel::index(int, int, QModelIndex const&) const [18]\r\n                    2.54   55.96 45668847/45668847     TransactionTablePriv::index(int) [19]\r\n                    0.47    0.48 22841271/22841273     QAbstractItemModel::createIndex(int, int, void*) const [563]\r\n    -----------------------------------------------\r\n\r\nNote that the time to load the wallet initially is longer than the delays per block, so that's possibly what's showing up at the top of the list.",
      "created_at" : "2014-04-28T07:25:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4091#issuecomment-41530010",
      "id" : 41530010,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4091",
      "updated_at" : "2014-04-28T07:25:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41530010",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=3",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   }
]
