[
   {
      "author_association" : "MEMBER",
      "body" : "Interesting, would like to give this a try soon.",
      "created_at" : "2022-05-07T16:21:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25081#issuecomment-1120235919",
      "id" : 1120235919,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25081",
      "node_id" : "IC_kwDOABII585CxXGP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1120235919/reactions"
      },
      "updated_at" : "2022-05-07T16:21:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1120235919",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This looks interesting. Planning to play around with this, e.g. running this on [bitcoind.observer](https://bitcoind.observer).\r\n\r\nI think it would be good to document these tracepoints in [doc/tracing.md](https://github.com/bitcoin/bitcoin/blob/master/doc/tracing.md) and, if possible, have an interface test similar to these added in e.g. https://github.com/bitcoin/bitcoin/pull/24358 (`test/functional/interface_usdt_*.py`).\n\nEdit: Oh also, documentation of the bpftrace script in `contrib/tracing/README.md` would be nice :). ",
      "created_at" : "2022-05-07T18:56:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25081#issuecomment-1120264468",
      "id" : 1120264468,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25081",
      "node_id" : "IC_kwDOABII585CxeEU",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1120264468/reactions"
      },
      "updated_at" : "2022-05-07T19:13:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1120264468",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25819](https://github.com/bitcoin/bitcoin/pull/25819) (msvc, refactor: Avoid some rare compiler warnings by hebasto)\n* [#25676](https://github.com/bitcoin/bitcoin/pull/25676) (sync: simplify and remove unused code from sync.h by vasild)\n* [#24923](https://github.com/bitcoin/bitcoin/pull/24923) (Rework logging timer by MarcoFalke)\n* [#16545](https://github.com/bitcoin/bitcoin/pull/16545) (refactor: Implement missing error checking for ArgsManager flags by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-05-08T06:30:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25081#issuecomment-1120359585",
      "id" : 1120359585,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25081",
      "node_id" : "IC_kwDOABII585Cx1Sh",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1120359585/reactions"
      },
      "updated_at" : "2022-09-23T12:11:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1120359585",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> have an interface test similar to these added in e.g. https://github.com/bitcoin/bitcoin/pull/24358 (test/functional/interface_usdt_*.py).\r\n\r\nOh, I didn't even know we had something like that...  I guess I need to learn more about eBPF and python :sweat_smile: \r\n\r\n",
      "created_at" : "2022-05-08T07:09:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25081#issuecomment-1120364028",
      "id" : 1120364028,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25081",
      "node_id" : "IC_kwDOABII585Cx2X8",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1120364028/reactions"
      },
      "updated_at" : "2022-05-08T07:09:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1120364028",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> `bitcoind` needs to be especially compiled with that enabled\r\n\r\nFor info, #24757 would define it by default in debug builds (`--enable-debug`).",
      "created_at" : "2022-05-08T08:00:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25081#issuecomment-1120370346",
      "id" : 1120370346,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25081",
      "node_id" : "IC_kwDOABII585Cx36q",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1120370346/reactions"
      },
      "updated_at" : "2022-05-08T08:00:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1120370346",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, I like using tracepoints for this kind of analysis instead of our own instrumentation.\r\n\r\n> For this to work I had to add traces to UniqueLock and AnnotatedMixin, and move the implementation into the cpp file (without moving, due to inlining the maximum number of traces of 512 is quickly exhausted)\r\n\r\nNo longer inlining the locks will add some overhead to locking even in the no-tracing case. We'll need to benchmark this.",
      "created_at" : "2022-05-09T19:31:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25081#issuecomment-1121493683",
      "id" : 1121493683,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25081",
      "node_id" : "IC_kwDOABII585C2KKz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1121493683/reactions"
      },
      "updated_at" : "2022-05-09T19:31:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1121493683",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.",
      "created_at" : "2022-05-09T20:42:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25081#issuecomment-1121562252",
      "id" : 1121562252,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25081",
      "node_id" : "IC_kwDOABII585C2a6M",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1121562252/reactions"
      },
      "updated_at" : "2022-05-09T20:42:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1121562252",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Hvaen't reviewed the code yet, but just ran a quick IBD bench on a \"contemporary\" region of the chain to get a sense of any performance impact. No significant slowdown there.\r\n\r\n### commands index\r\n|          bench name           |                                                                                                     command                                                                                                      |\r\n|-------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\r\n| ibd.local.range.667200.677200 | `bitcoind -dbcache=10000 -debug=coindb -debug=bench -listen=0 -connect=0 -addnode=127.0.0.1:8888 -prune=9999999 -printtoconsole=0 -assumevalid=000000000000000000176c192f42ad13ab159fdb20198b87e7ba3c001e47b876` |\r\n\r\n\r\n\r\n### #25081 vs. $mergebase (absolute)\r\n|                  bench name                   |  x  |          #25081           |         $mergebase         |\r\n|-----------------------------------------------|----:|---------------------------|----------------------------|\r\n| ibd.local.range.667200.677200.total_secs      |   2 | 1738.2652 (Â± 3.4354)      | 1736.2869 (Â± 0.6808)       |\r\n| ibd.local.range.667200.677200.peak_rss_KiB    |   2 | 3518128.0000 (Â± 196.0000) | 3518346.0000 (Â± 3050.0000) |\r\n| ibd.local.range.667200.677200.cpu_kernel_secs |   2 | 126.4900 (Â± 1.4500)       | 125.9750 (Â± 0.5650)        |\r\n| ibd.local.range.667200.677200.cpu_user_secs   |   2 | 10095.4250 (Â± 1.1050)     | 10089.9250 (Â± 1.4550)      |\r\n\r\n\r\n### #25081 vs. $mergebase (relative)\r\n|                  bench name                   |  x  | #25081 | $mergebase |\r\n|-----------------------------------------------|----:|-------:|-----------:|\r\n| ibd.local.range.667200.677200.total_secs      |   2 |  1.001 |       1.00 |\r\n| ibd.local.range.667200.677200.peak_rss_KiB    |   2 |  1.000 |       1.00 |\r\n| ibd.local.range.667200.677200.cpu_kernel_secs |   2 |  1.004 |       1.00 |\r\n| ibd.local.range.667200.677200.cpu_user_secs   |   2 |  1.001 |       1.00 |\r\n\r\n### Reproduce with\r\n\r\n```sh\r\nbitcoinperf bench-pr --num-blocks 10_000 --run-id lock-tracing \\\r\n  --bitcoind-args='-dbcache=10000' --run-count 2 25081\r\n```",
      "created_at" : "2022-05-17T20:24:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25081#issuecomment-1129284585",
      "id" : 1129284585,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25081",
      "node_id" : "IC_kwDOABII585DT4Pp",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1129284585/reactions"
      },
      "updated_at" : "2022-05-17T20:24:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1129284585",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK!\n\nThis was one of the main usecases of tracepoints that I had in mind! Very nice, will test.\n",
      "created_at" : "2022-05-17T22:06:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25081#issuecomment-1129362470",
      "id" : 1129362470,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25081",
      "node_id" : "IC_kwDOABII585DULQm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1129362470/reactions"
      },
      "updated_at" : "2022-05-17T22:06:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1129362470",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I've started playing around with these tracepoints. It seems like there are **two** ELF notes generated for each `sync` tracepoint. \r\n\r\n<details>\r\n<summary>\r\nOutput of `readelf -n ./src/bitcoind`\r\n</summary>\r\n\r\n```\r\n...\r\n  stapsdt              0x0000002f\tNT_STAPSDT (SystemTap probe descriptors)\r\n    Provider: sync\r\n    Name: mutex_ctor\r\n    Location: 0x00000000005dca7b, Base: 0x000000000086f360, Semaphore: 0x0000000000000000\r\n    Arguments: 8@%rdi\r\n  stapsdt              0x0000002f\tNT_STAPSDT (SystemTap probe descriptors)\r\n    Provider: sync\r\n    Name: mutex_dtor\r\n    Location: 0x00000000005dcab8, Base: 0x000000000086f360, Semaphore: 0x0000000000000000\r\n    Arguments: 8@%rdi\r\n  stapsdt              0x0000002f\tNT_STAPSDT (SystemTap probe descriptors)\r\n    Provider: sync\r\n    Name: mutex_ctor\r\n    Location: 0x00000000005dcc12, Base: 0x000000000086f360, Semaphore: 0x0000000000000000\r\n    Arguments: 8@%rdi\r\n  stapsdt              0x0000002f\tNT_STAPSDT (SystemTap probe descriptors)\r\n    Provider: sync\r\n    Name: mutex_dtor\r\n    Location: 0x00000000005dcc48, Base: 0x000000000086f360, Semaphore: 0x0000000000000000\r\n    Arguments: 8@%rdi\r\n  stapsdt              0x0000004e\tNT_STAPSDT (SystemTap probe descriptors)\r\n    Provider: sync\r\n    Name: enter\r\n    Location: 0x00000000005dcd8c, Base: 0x000000000086f360, Semaphore: 0x0000000000000000\r\n    Arguments: 8@(%rdi) 8@16(%rdi) 8@24(%rdi) -4@32(%rdi)\r\n  stapsdt              0x0000004d\tNT_STAPSDT (SystemTap probe descriptors)\r\n    Provider: sync\r\n    Name: locked\r\n    Location: 0x00000000005dcdb5, Base: 0x000000000086f360, Semaphore: 0x0000000000000000\r\n    Arguments: 8@%rdi 8@16(%rbx) 8@24(%rbx) -4@32(%rbx)\r\n  stapsdt              0x00000051\tNT_STAPSDT (SystemTap probe descriptors)\r\n    Provider: sync\r\n    Name: try_locked\r\n    Location: 0x00000000005dce5c, Base: 0x000000000086f360, Semaphore: 0x0000000000000000\r\n    Arguments: 8@%rdi 8@16(%rbx) 8@24(%rbx) -4@32(%rbx)\r\n  stapsdt              0x00000044\tNT_STAPSDT (SystemTap probe descriptors)\r\n    Provider: sync\r\n    Name: unlock\r\n    Location: 0x00000000005dceae, Base: 0x000000000086f360, Semaphore: 0x0000000000000000\r\n    Arguments: 8@(%rdi) 8@24(%rdi) -4@32(%rdi)\r\n  stapsdt              0x0000004e\tNT_STAPSDT (SystemTap probe descriptors)\r\n    Provider: sync\r\n    Name: enter\r\n    Location: 0x00000000005dd14c, Base: 0x000000000086f360, Semaphore: 0x0000000000000000\r\n    Arguments: 8@(%rdi) 8@16(%rdi) 8@24(%rdi) -4@32(%rdi)\r\n  stapsdt              0x0000004d\tNT_STAPSDT (SystemTap probe descriptors)\r\n    Provider: sync\r\n    Name: locked\r\n    Location: 0x00000000005dd175, Base: 0x000000000086f360, Semaphore: 0x0000000000000000\r\n    Arguments: 8@%rdi 8@16(%rbx) 8@24(%rbx) -4@32(%rbx)\r\n  stapsdt              0x00000051\tNT_STAPSDT (SystemTap probe descriptors)\r\n    Provider: sync\r\n    Name: try_locked\r\n    Location: 0x00000000005dd21c, Base: 0x000000000086f360, Semaphore: 0x0000000000000000\r\n    Arguments: 8@%rdi 8@16(%rbx) 8@24(%rbx) -4@32(%rbx)\r\n  stapsdt              0x00000044\tNT_STAPSDT (SystemTap probe descriptors)\r\n    Provider: sync\r\n    Name: unlock\r\n    Location: 0x00000000005dd26e, Base: 0x000000000086f360, Semaphore: 0x0000000000000000\r\n    Arguments: 8@(%rdi) 8@24(%rdi) -4@32(%rdi)\r\n```\r\n\r\n</details>\r\n\r\nI think, this is caused the templates were using - and that's not something we want to change.  E.g. https://github.com/bitcoin/bitcoin/blob/f7917c26970956bf5fc423b9cc995554694c87be/src/sync.cpp#L329-L333\r\n\r\nTwo ELF notes with the same context/provider and name cause problems for me. E.g., when using bcc via the binary path (as we do it in e.g. [the interface tests](https://github.com/bitcoin/bitcoin/blob/d5d40d59f8d12cf53c5ad1ce9710f3f108cec386/test/functional/interface_usdt_net.py#L112)). According to https://github.com/iovisor/bcc/issues/1774#issuecomment-390723275 this works when using the PID, which we can do for the interface tests. Still, supporting hooking into the tracepoints both via PID and binary path would be good, but I'm not sure if that's possible in this case.\r\n\r\n ",
      "created_at" : "2022-05-17T22:19:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25081#issuecomment-1129370599",
      "id" : 1129370599,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25081",
      "node_id" : "IC_kwDOABII585DUNPn",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1129370599/reactions"
      },
      "updated_at" : "2022-05-17T22:21:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1129370599",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> there are two ELF notes generated for each sync tracepoint\r\n\r\nCurrently the templates are instantiated only for `std::mutex` and `std::recursive_mutex`, so workaround might be to do something like this:\r\n\r\n```cpp\r\ntemplate <typename PARENT>\r\nAnnotatedMixin<PARENT>::AnnotatedMixin()\r\n{\r\n    if constexpr (std::is_same_v<std::mutex, PARENT>) {\r\n        TRACE1(sync, mutex_ctor, this);\r\n    } else if constexpr (std::is_same_v<std::recursive_mutex, PARENT>) {\r\n        TRACE1(sync, recursive_mutex_ctor, this);\r\n    } else {\r\n        assert(false && \"unknown lock used\");\r\n    }\r\n}\r\n```\r\n\r\nUnfortunately currently I don't have much time to work on this though",
      "created_at" : "2022-05-18T10:39:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25081#issuecomment-1129850921",
      "id" : 1129850921,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25081",
      "node_id" : "IC_kwDOABII585DWCgp",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1129850921/reactions"
      },
      "updated_at" : "2022-05-18T10:39:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1129850921",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> there are two ELF notes generated for each sync tracepoint\n\nIf the template is getting instantiated twice creating two tracepoints, why not just create a standalone function containing the trace? Then perhaps we wouldn't need to move the header-only templates as well.\n",
      "created_at" : "2022-05-18T16:14:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25081#issuecomment-1130218739",
      "id" : 1130218739,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25081",
      "node_id" : "IC_kwDOABII585DXcTz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1130218739/reactions"
      },
      "updated_at" : "2022-05-18T16:14:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1130218739",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-10-03T19:04:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25081#issuecomment-1265899850",
      "id" : 1265899850,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25081",
      "node_id" : "IC_kwDOABII585LdBlK",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1265899850/reactions"
      },
      "updated_at" : "2022-10-03T19:04:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1265899850",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   }
]
