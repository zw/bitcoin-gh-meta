[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15197#discussion_r248946940"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15197"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248946940"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: I think \"reject\" was a better wording than \"exit\"\r\nAlso please add braces now that this code is touched anyway.\r\n```\r\nif (!hdr.IsValid(Params().MessageStart())) {\r\n    ...\r\n}\r\n```",
      "commit_id" : "03501001d39403abe095a286e4491e2c46ab46cd",
      "created_at" : "2019-01-18T07:24:24Z",
      "diff_hunk" : "@@ -835,8 +835,8 @@ int CNetMessage::readHeader(const char *pch, unsigned int nBytes)\n         return -1;\n     }\n \n-    // reject messages larger than MAX_SIZE\n-    if (hdr.nMessageSize > MAX_SIZE)\n+    // exit if message has an invalid header",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15197#discussion_r248946940",
      "id" : 248946940,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0ODk0Njk0MA==",
      "original_commit_id" : "99c83dffdcde356b1c8899ae363d292d47f40dad",
      "original_position" : 6,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 193973239,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15197",
      "updated_at" : "2019-01-31T19:36:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248946940",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15197#discussion_r248946998"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15197"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248946998"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: `{` on same line as if",
      "commit_id" : "03501001d39403abe095a286e4491e2c46ab46cd",
      "created_at" : "2019-01-18T07:24:46Z",
      "diff_hunk" : "@@ -102,7 +102,10 @@ bool CMessageHeader::IsValid(const MessageStartChars& pchMessageStartIn) const\n {\n     // Check start string\n     if (memcmp(pchMessageStart, pchMessageStartIn, MESSAGE_START_SIZE) != 0)\n+    {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15197#discussion_r248946998",
      "id" : 248946998,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0ODk0Njk5OA==",
      "original_commit_id" : "99c83dffdcde356b1c8899ae363d292d47f40dad",
      "original_position" : 4,
      "path" : "src/protocol.cpp",
      "position" : null,
      "pull_request_review_id" : 193973320,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15197",
      "updated_at" : "2019-01-31T19:36:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248946998",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, it is good to reject an invalid message as soon as possible.\r\n\r\nI think this is correct\r\n- `CNetMessage::readHeader` for every message called before `::ProcessMessages`\r\n- `CMessageHeader::IsValid` does the following checks, which includes checking the message size\r\n  - Check message start\r\n  - Check command string for errors\r\n  - Check message size\r\n",
      "created_at" : "2019-01-18T07:34:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15197#issuecomment-455453699",
      "id" : 455453699,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15197",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1NTQ1MzY5OQ==",
      "updated_at" : "2019-01-18T07:34:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/455453699",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK c749b1347ed1101c2b41211bbbf9dff501bd5927",
      "created_at" : "2019-01-21T16:35:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15197#issuecomment-456133150",
      "id" : 456133150,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15197",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1NjEzMzE1MA==",
      "updated_at" : "2019-01-21T16:35:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/456133150",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "utACK c749b13\r\n\r\nPerhaps also replace *24* with ```HEADER_SIZE``` here? (twice)\r\nhttps://github.com/bitcoin/bitcoin/blob/c749b1347ed1101c2b41211bbbf9dff501bd5927/src/net.cpp#L820",
      "created_at" : "2019-01-21T19:46:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15197#issuecomment-456181865",
      "id" : 456181865,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15197",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1NjE4MTg2NQ==",
      "updated_at" : "2019-01-21T19:46:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/456181865",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Perhaps also replace 24 with HEADER_SIZE here? (twice)\r\n\r\nIt should be replaced but its irrelevant for this PR and not within the scope of it (will do later).",
      "created_at" : "2019-01-24T19:32:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15197#issuecomment-457326728",
      "id" : 457326728,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15197",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1NzMyNjcyOA==",
      "updated_at" : "2019-01-24T19:32:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/457326728",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "p2p_invalid_messages is failing locally on this, probably due to something else merged in the meantime?\r\n```\r\n$ test/functional/test_runner.py p2p_invalid_messages.py\r\nTemporary test directory at /tmp/test_runner_Ã¢ÂÂ¿_Ã°ÂÂÂ_20190131_144734\r\n1/1 - p2p_invalid_messages.py failed, Duration: 1 s\r\n\r\nstdout:\r\n2019-01-31T13:47:34.927000Z TestFramework (INFO): Initializing test directory /tmp/test_runner_Ã¢ÂÂ¿_Ã°ÂÂÂ_20190131_144734/p2p_invalid_messages_0\r\n2019-01-31T13:47:35.309000Z TestFramework (ERROR): Assertion failed\r\nTraceback (most recent call last):\r\n  File \"/.../bitcoin/test/functional/test_framework/test_framework.py\", line 173, in main\r\n    self.run_test()\r\n  File \"/home/orion/projects/bitcoin/bitcoin/test/functional/p2p_invalid_messages.py\", line 45, in run_test\r\n    self.test_magic_bytes()\r\n  File \"/home/orion/projects/bitcoin/bitcoin/test/functional/p2p_invalid_messages.py\", line 150, in test_magic_bytes\r\n    self.nodes[0].disconnect_p2ps()\r\n  File \"/usr/lib/python3.6/contextlib.py\", line 88, in __exit__\r\n    next(self.gen)\r\n  File \"/.../bitcoin/test/functional/test_framework/test_node.py\", line 291, in assert_debug_log\r\n    self._raise_assertion_error('Expected message \"{}\" does not partially match log:\\n\\n{}\\n\\n'.format(expected_msg, print_log))\r\n  File \"/.../bitcoin/test/functional/test_framework/test_node.py\", line 143, in _raise_assertion_error\r\n    raise AssertionError(self._node_msg(msg))\r\nAssertionError: [node 0] Expected message \"PROCESSMESSAGE: INVALID MESSAGESTART ping\" does not partially match log:\r\n\r\n - 2019-01-31T13:47:35.257438Z INVALID MESSAGESTART ping\r\n - 2019-01-31T13:47:35.257494Z disconnecting peer=0\r\n - 2019-01-31T13:47:35.257613Z Cleared nodestate for peer=0\r\n\r\n\r\n2019-01-31T13:47:35.363000Z TestFramework (INFO): Stopping nodes\r\n2019-01-31T13:47:35.567000Z TestFramework (WARNING): Not cleaning up dir /tmp/test_runner_Ã¢ÂÂ¿_Ã°ÂÂÂ_20190131_144734/p2p_invalid_messages_0\r\n2019-01-31T13:47:35.567000Z TestFramework (ERROR): Test failed. Test logging available at /tmp/test_runner_Ã¢ÂÂ¿_Ã°ÂÂÂ_20190131_144734/p2p_invalid_messages_0/test_framework.log\r\n2019-01-31T13:47:35.569000Z TestFramework (ERROR): Hint: Call /.../bitcoin/test/functional/combine_logs.py '/tmp/test_runner_Ã¢ÂÂ¿_Ã°ÂÂÂ_20190131_144734/p2p_invalid_messages_0' to consolidate all logs\r\n\r\n\r\nstderr:\r\n\r\n\r\n\r\nTEST                    | STATUS    | DURATION\r\n\r\np2p_invalid_messages.py | Ã¢ÂÂ Failed  | 1 s\r\n\r\nALL                     | Ã¢ÂÂ Failed  | 1 s (accumulated)\r\nRuntime: 1 s\r\n```",
      "created_at" : "2019-01-31T13:50:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15197#issuecomment-459350547",
      "id" : 459350547,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15197",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1OTM1MDU0Nw==",
      "updated_at" : "2019-01-31T13:50:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/459350547",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15197#discussion_r252719065"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15197"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252719065"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Previously this wouldn't log and now this logs. This is a minor change in behaviour and opens the possibility to fill in the (currently empty) string in `assert_debug_log` in the invalid message functional test.",
      "commit_id" : "03501001d39403abe095a286e4491e2c46ab46cd",
      "created_at" : "2019-01-31T15:41:48Z",
      "diff_hunk" : "@@ -835,9 +835,10 @@ int CNetMessage::readHeader(const char *pch, unsigned int nBytes)\n         return -1;\n     }\n \n-    // reject messages larger than MAX_SIZE\n-    if (hdr.nMessageSize > MAX_SIZE)\n+    // reject if message has an invalid header\n+    if (!hdr.IsValid(Params().MessageStart())) {\n         return -1;\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15197#discussion_r252719065",
      "id" : 252719065,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MjcxOTA2NQ==",
      "original_commit_id" : "c749b1347ed1101c2b41211bbbf9dff501bd5927",
      "original_position" : 9,
      "path" : "src/net.cpp",
      "position" : 10,
      "pull_request_review_id" : 198658632,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15197",
      "updated_at" : "2019-01-31T19:36:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252719065",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Needs rebase",
      "created_at" : "2019-01-31T15:42:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15197#issuecomment-459391752",
      "id" : 459391752,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15197",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1OTM5MTc1Mg==",
      "updated_at" : "2019-01-31T15:42:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/459391752",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Re-added the invalid header log (slightly changed log message) and fixed the new tests.",
      "created_at" : "2019-01-31T19:35:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15197#issuecomment-459476487",
      "id" : 459476487,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15197",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1OTQ3NjQ4Nw==",
      "updated_at" : "2019-01-31T19:35:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/459476487",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15197#discussion_r252812623"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15197"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252812623"
         }
      },
      "author_association" : "MEMBER",
      "body" : "There is already logging in\r\n\r\n```\r\nLogPrintf(\"CMessageHeader::IsValid(): (%s, %u bytes) nMessageSize > MAX_SIZE\r\n```\r\n\r\nI have no opinion on where to do it, but it should suffice to log only one line instead of two for a single error.",
      "commit_id" : "03501001d39403abe095a286e4491e2c46ab46cd",
      "created_at" : "2019-01-31T19:42:55Z",
      "diff_hunk" : "@@ -665,9 +665,11 @@ int CNetMessage::readHeader(const char *pch, unsigned int nBytes)\n         return -1;\n     }\n \n-    // reject messages larger than MAX_SIZE\n-    if (hdr.nMessageSize > MAX_SIZE)\n+    // reject if message has an invalid header\n+    if (!hdr.IsValid(Params().MessageStart())) {\n+        LogPrint(BCLog::NET, \"INVALID HEADER DETECTED\\n\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15197#discussion_r252812623",
      "id" : 252812623,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MjgxMjYyMw==",
      "original_commit_id" : "03501001d39403abe095a286e4491e2c46ab46cd",
      "original_position" : 8,
      "path" : "src/net.cpp",
      "position" : 8,
      "pull_request_review_id" : 198778717,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15197",
      "updated_at" : "2019-01-31T19:42:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252812623",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15197#discussion_r252821609"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15197"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252821609"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Without the log entry in L670, we would only log the invalid message size (**not** invalid magic check and invalid command strings).\r\nWe could drop the invalid message size but I think this is one we should keep since it smells after DoS/dishonest peers.\r\n\r\nAfter this PR, you will get two log entries in case of an message size larger then `MAX_SIZE`.\r\n1. `LogPrintf(\"CMessageHeader::IsValid(): (%s, %u bytes) nMessageSize > MAX_SIZE\\n\", GetCommand(), nMessageSize);`\r\n2. `LogPrint(BCLog::NET, \"INVALID HEADER DETECTED\\n\");`\r\n\r\nWhich I think is acceptable.\r\n\r\nOf course we could remove the first entry about the message size.",
      "commit_id" : "03501001d39403abe095a286e4491e2c46ab46cd",
      "created_at" : "2019-01-31T20:08:32Z",
      "diff_hunk" : "@@ -665,9 +665,11 @@ int CNetMessage::readHeader(const char *pch, unsigned int nBytes)\n         return -1;\n     }\n \n-    // reject messages larger than MAX_SIZE\n-    if (hdr.nMessageSize > MAX_SIZE)\n+    // reject if message has an invalid header\n+    if (!hdr.IsValid(Params().MessageStart())) {\n+        LogPrint(BCLog::NET, \"INVALID HEADER DETECTED\\n\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15197#discussion_r252821609",
      "id" : 252821609,
      "in_reply_to_id" : 252812623,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MjgyMTYwOQ==",
      "original_commit_id" : "03501001d39403abe095a286e4491e2c46ab46cd",
      "original_position" : 8,
      "path" : "src/net.cpp",
      "position" : 8,
      "pull_request_review_id" : 198789790,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15197",
      "updated_at" : "2019-01-31T20:08:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252821609",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#15697](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15697.html) (qa: Make swap_magic_bytes in p2p_invalid_messages atomic by MarcoFalke)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-03-11T18:59:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15197#issuecomment-471676350",
      "id" : 471676350,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15197",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3MTY3NjM1MA==",
      "updated_at" : "2019-04-04T23:41:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/471676350",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   }
]
