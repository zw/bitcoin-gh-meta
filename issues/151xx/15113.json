{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "NONE",
   "body" : "Description of issue:\r\nBitcoin Core crashes with the following \"Error: A fatal internal error occurred, see debug.log for details\"\r\n\r\n<img width=\"1056\" alt=\"screen shot 2019-01-05 at 2 38 15 pm\" src=\"https://user-images.githubusercontent.com/46251733/50730506-d591dd00-1146-11e9-8329-c4ac27d44f18.png\">\r\n\r\n\r\nThe debug.log has the following:\r\n\r\n<img width=\"635\" alt=\"screen shot 2019-01-05 at 3 18 58 pm\" src=\"https://user-images.githubusercontent.com/46251733/50730513-ecd0ca80-1146-11e9-8513-0d6a63da17e6.png\">\r\n\r\nWhat behavior did you expect?\r\nI was hoping to run the node without crashing.\r\n\r\nWhat was the actual behavior (provide screenshots if the issue is GUI-related)?\r\nWhenever I load Bitcoin Core, it tries to sync and it just crashes.\r\n\r\nHow reliably can you reproduce the issue, what are the steps to do so?\r\nEvery time I boot Bitcoin Core, it crashes.\r\n\r\nWhat version of Bitcoin Core are you using, where did you get it (website, self-compiled, etc)?\r\n<img width=\"781\" alt=\"screen shot 2019-01-05 at 4 08 43 pm\" src=\"https://user-images.githubusercontent.com/46251733/50730527-446f3600-1147-11e9-9450-8f65c3b7ad13.png\">\r\n\r\nI am using Bitcoin Core, downloaded from Bitcoin.org.\r\n\r\nWhat type of machine are you observing the error on (OS/CPU and disk type)?\r\n<img width=\"564\" alt=\"screen shot 2019-01-05 at 4 09 51 pm\" src=\"https://user-images.githubusercontent.com/46251733/50730538-6963a900-1147-11e9-9117-d59d9e882f30.png\">\r\n\r\n<img width=\"354\" alt=\"screen shot 2019-01-05 at 6 13 40 pm\" src=\"https://user-images.githubusercontent.com/46251733/50731326-ccf6d200-1159-11e9-8190-645894b0ca7e.png\">\r\n<img width=\"579\" alt=\"screen shot 2019-01-05 at 6 02 29 pm\" src=\"https://user-images.githubusercontent.com/46251733/50731327-d08a5900-1159-11e9-92b7-14216c0561ef.png\">\r\n\r\n\r\nMac OSX, 500gb SSD with ~100gb of free space.\r\n\r\nAny extra information that might be useful in the debugging process.\r\nThis crash occurred after installing electrum personal server and adding several thousand watching addresses. I have since uninstalled Bitcoin Core, reinstalled it, and resynced it. It continues to crash, even without the use of electrum personal server.\r\n\r\nThis is normally the contents of a `debug.log` or `config.log` file. Raw text or a link to a pastebin type site are preferred.\r\n\r\n\"2019-01-05T23:52:37Z Bitcoin Core version v0.17.0.1 (release build)\r\n2019-01-05T23:52:37Z InitParameterInteraction: parameter interaction: -whitelistforcerelay=1 -> setting -whitelistrelay=1\r\n2019-01-05T23:52:37Z Assuming ancestors of block 0000000000000000002e63058c023a9a1de233554f28c7b21380b6c9003f36a8 have valid signatures.\r\n2019-01-05T23:52:37Z Setting nMinimumChainWork=0000000000000000000000000000000000000000028822fef1c230963535a90d\r\n2019-01-05T23:52:37Z Using the 'sse4(1way),sse41(4way),avx2(8way)' SHA256 implementation\r\n2019-01-05T23:52:37Z Using RdRand as an additional entropy source\r\n2019-01-05T23:52:37Z Default data directory /Users/anaonanaon1/Library/Application Support/Bitcoin\r\n2019-01-05T23:52:37Z Using data directory /Users/anaonanaon1/Library/Application Support/Bitcoin\r\n2019-01-05T23:52:37Z Using config file /Users/anaonanaon1/Library/Application Support/Bitcoin/bitcoin.conf\r\n2019-01-05T23:52:37Z Using at most 125 automatic connections (2560 file descriptors available)\r\n2019-01-05T23:52:37Z Using 16 MiB out of 32/2 requested for signature cache, able to store 524288 elements\r\n2019-01-05T23:52:37Z Using 16 MiB out of 32/2 requested for script execution cache, able to store 524288 elements\r\n2019-01-05T23:52:37Z Using 8 threads for script verification\r\n2019-01-05T23:52:37Z scheduler thread start\r\n2019-01-05T23:52:37Z HTTP: creating work queue of depth 16\r\n2019-01-05T23:52:37Z No rpcpassword set - using random cookie authentication.\r\n2019-01-05T23:52:37Z Generated RPC authentication cookie /Users/anaonanaon1/Library/Application Support/Bitcoin/.cookie\r\n2019-01-05T23:52:37Z HTTP: starting 4 worker threads\r\n2019-01-05T23:52:37Z Using wallet directory /Users/anaonanaon1/Library/Application Support/Bitcoin/wallets\r\n2019-01-05T23:52:37Z init message: Verifying wallet(s)...\r\n2019-01-05T23:52:37Z Using BerkeleyDB version Berkeley DB 4.8.30: (April  9, 2010)\r\n2019-01-05T23:52:37Z Using wallet wallet.dat\r\n2019-01-05T23:52:37Z BerkeleyEnvironment::Open: LogDir=/Users/anaonanaon1/Library/Application Support/Bitcoin/wallets/database ErrorFile=/Users/anaonanaon1/Library/Application Support/Bitcoin/wallets/db.log\r\n2019-01-05T23:52:37Z Cache configuration:\r\n2019-01-05T23:52:37Z * Using 2.0MiB for block index database\r\n2019-01-05T23:52:37Z * Using 8.0MiB for chain state database\r\n2019-01-05T23:52:37Z * Using 4490.0MiB for in-memory UTXO set (plus up to 286.1MiB of unused mempool space)\r\n2019-01-05T23:52:37Z init message: Loading block index...\r\n2019-01-05T23:52:37Z Opening LevelDB in /Users/anaonanaon1/Library/Application Support/Bitcoin/blocks/index\r\n2019-01-05T23:52:37Z Opened LevelDB successfully\r\n2019-01-05T23:52:37Z Using obfuscation key for /Users/anaonanaon1/Library/Application Support/Bitcoin/blocks/index: 0000000000000000\r\n2019-01-05T23:52:40Z LoadBlockIndexDB: last block file = 1485\r\n2019-01-05T23:52:40Z LoadBlockIndexDB: last block file info: CBlockFileInfo(blocks=9, size=2126192, heights=557091...557108, time=2019-01-05...2019-01-05)\r\n2019-01-05T23:52:40Z Checking all blk files are present...\r\n2019-01-05T23:52:43Z Opening LevelDB in /Users/anaonanaon1/Library/Application Support/Bitcoin/chainstate\r\n2019-01-05T23:52:43Z Opened LevelDB successfully\r\n2019-01-05T23:52:43Z Using obfuscation key for /Users/anaonanaon1/Library/Application Support/Bitcoin/chainstate: 30e54f02b376fa77\r\n2019-01-05T23:52:43Z Loaded best chain: hashBestChain=0000000000000000002f3cb3939d8685c8976dc9e35ccec08c4e121b12688974 height=557090 date=2019-01-05T03:35:07Z progress=0.999527\r\n2019-01-05T23:52:43Z init message: Rewinding blocks...\r\n2019-01-05T23:52:45Z Unable to open file /Users/anaonanaon1/Library/Application Support/Bitcoin/blocks/blk01485.dat\r\n2019-01-05T23:52:45Z Unable to open file /Users/anaonanaon1/Library/Application Support/Bitcoin/blocks/rev01485.dat\r\n2019-01-05T23:52:45Z init message: Verifying blocks...\r\n2019-01-05T23:52:45Z Verifying last 6 blocks at level 3\r\n2019-01-05T23:52:45Z [0%]...[16%]...[33%]...[50%]...[66%]...[83%]...[99%]...[DONE].\r\n2019-01-05T23:52:46Z No coin database inconsistencies in last 6 blocks (8393 transactions)\r\n2019-01-05T23:52:46Z  block index            8721ms\r\n2019-01-05T23:52:46Z init message: Loading wallet...\r\n2019-01-05T23:52:46Z [default wallet] nFileVersion = 170001\r\n2019-01-05T23:52:46Z [default wallet] Keys: 0 plaintext, 4158 encrypted, 4213 w/ metadata, 4158 total. Unknown wallet records: 1\r\n2019-01-05T23:52:46Z [default wallet] Wallet completed loading in              66ms\r\n2019-01-05T23:52:46Z [default wallet] setKeyPool.size() = 1999\r\n2019-01-05T23:52:46Z [default wallet] mapWallet.size() = 217\r\n2019-01-05T23:52:46Z [default wallet] mapAddressBook.size() = 256\r\n2019-01-05T23:52:46Z mapBlockIndex.size() = 557226\r\n2019-01-05T23:52:46Z nBestHeight = 557090\r\n2019-01-05T23:52:46Z torcontrol thread start\r\n2019-01-05T23:52:46Z AddLocal([2601:642:c400:f45:84d:337b:b4a2:647b]:8333,1)\r\n2019-01-05T23:52:46Z Discover: IPv6 en0: 2601:642:c400:f45:84d:337b:b4a2:647b\r\n2019-01-05T23:52:46Z Imported mempool transactions from disk: 0 succeeded, 0 failed, 0 expired, 0 already there\r\n2019-01-05T23:52:46Z AddLocal([2601:642:c400:f45:65a9:a20f:d0ad:c2b0]:8333,1)\r\n2019-01-05T23:52:46Z Discover: IPv6 en0: 2601:642:c400:f45:65a9:a20f:d0ad:c2b0\r\n2019-01-05T23:52:46Z AddLocal([2601:642:c400:f45::a1cf]:8333,1)\r\n2019-01-05T23:52:46Z Discover: IPv6 en0: 2601:642:c400:f45::a1cf\r\n2019-01-05T23:52:46Z Bound to [::]:8333\r\n2019-01-05T23:52:46Z Bound to 0.0.0.0:8333\r\n2019-01-05T23:52:46Z init message: Loading P2P addresses...\r\n2019-01-05T23:52:46Z Loaded 70405 addresses from peers.dat  205ms\r\n2019-01-05T23:52:46Z init message: Loading banlist...\r\n2019-01-05T23:52:46Z init message: Starting network threads...\r\n2019-01-05T23:52:46Z dnsseed thread start\r\n2019-01-05T23:52:46Z net thread start\r\n2019-01-05T23:52:46Z addcon thread start\r\n2019-01-05T23:52:46Z init message: Done loading\r\n2019-01-05T23:52:46Z msghand thread start\r\n2019-01-05T23:52:46Z opencon thread start\r\n2019-01-05T23:52:46Z GUI: Platform customization: \"macosx\"\r\n2019-01-05T23:52:46Z GUI: PaymentServer::LoadRootCAs: Loaded  176  root certificates\r\n2019-01-05T23:52:55Z Leaving InitialBlockDownload (latching to false)\r\n2019-01-05T23:52:57Z Loading addresses from DNS seeds (could take a while)\r\n2019-01-05T23:52:57Z 163 addresses found from DNS seeds\r\n2019-01-05T23:52:57Z dnsseed thread exit\r\n2019-01-05T23:53:01Z New outbound peer connected: version: 70015, blocks=557225, peer=0\r\n2019-01-05T23:53:02Z Unable to open file /Users/anaonanaon1/Library/Application Support/Bitcoin/blocks/blk01485.dat\r\n2019-01-05T23:53:02Z ERROR: WriteBlockToDisk: OpenBlockFile failed\r\n2019-01-05T23:53:02Z *** Failed to write block\r\n2019-01-05T23:53:05Z ERROR: ProcessNewBlock: AcceptBlock FAILED (AcceptBlock: Failed to find position to write new block to disk (code 0))\r\n2019-01-05T23:53:05Z Unable to open file /Users/anaonanaon1/Library/Application Support/Bitcoin/blocks/blk01485.dat\r\n2019-01-05T23:53:05Z ERROR: WriteBlockToDisk: OpenBlockFile failed\r\n2019-01-05T23:53:05Z *** Failed to write block\r\n2019-01-05T23:53:05Z ERROR: ProcessNewBlock: AcceptBlock FAILED (AcceptBlock: Failed to find position to write new block to disk (code 0))\r\n2019-01-05T23:53:05Z Unable to open file /Users/anaonanaon1/Library/Application Support/Bitcoin/blocks/blk01485.dat\r\n2019-01-05T23:53:05Z ERROR: WriteBlockToDisk: OpenBlockFile failed\r\n2019-01-05T23:53:05Z *** Failed to write block\r\n2019-01-05T23:53:05Z tor: Thread interrupt\r\n2019-01-05T23:53:05Z Shutdown: In progress...\r\n2019-01-05T23:53:05Z torcontrol thread exit\r\n2019-01-05T23:53:05Z addcon thread exit\r\n2019-01-05T23:53:05Z net thread exit\r\n2019-01-05T23:53:07Z ERROR: ProcessNewBlock: AcceptBlock FAILED (AcceptBlock: Failed to find position to write new block to disk (code 0))\r\n2019-01-05T23:53:07Z msghand thread exit\r\n2019-01-05T23:53:07Z opencon thread exit\r\n2019-01-05T23:53:07Z scheduler thread interrupt\r\n2019-01-05T23:53:07Z Dumped mempool: 1.1e-05s to copy, 0.004685s to dump\r\n2019-01-05T23:53:07Z Unable to open file /Users/anaonanaon1/Library/Application Support/Bitcoin/blocks/blk01485.dat\r\n2019-01-05T23:53:07Z Unable to open file /Users/anaonanaon1/Library/Application Support/Bitcoin/blocks/rev01485.dat\r\n2019-01-05T23:53:07Z Unable to open file /Users/anaonanaon1/Library/Application Support/Bitcoin/blocks/blk01485.dat\r\n2019-01-05T23:53:07Z Unable to open file /Users/anaonanaon1/Library/Application Support/Bitcoin/blocks/rev01485.dat\r\n2019-01-05T23:53:07Z [default wallet] Releasing wallet\r\n2019-01-05T23:53:07Z Shutdown: done\"\r\n",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 0,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15113/comments",
   "created_at" : "2019-01-06T00:14:32Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15113/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/15113",
   "id" : 396213771,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15113/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDU6SXNzdWUzOTYyMTM3NzE=",
   "number" : 15113,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "ERROR: WriteBlockToDisk: OpenBlockFile failed / AcceptBlock: Failed to find position to write new block to disk (code 0))",
   "updated_at" : "2019-01-06T02:22:05Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15113",
   "user" : {
      "avatar_url" : "https://avatars0.githubusercontent.com/u/46251733?v=4",
      "events_url" : "https://api.github.com/users/JamesTwitter/events{/privacy}",
      "followers_url" : "https://api.github.com/users/JamesTwitter/followers",
      "following_url" : "https://api.github.com/users/JamesTwitter/following{/other_user}",
      "gists_url" : "https://api.github.com/users/JamesTwitter/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/JamesTwitter",
      "id" : 46251733,
      "login" : "JamesTwitter",
      "node_id" : "MDQ6VXNlcjQ2MjUxNzMz",
      "organizations_url" : "https://api.github.com/users/JamesTwitter/orgs",
      "received_events_url" : "https://api.github.com/users/JamesTwitter/received_events",
      "repos_url" : "https://api.github.com/users/JamesTwitter/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/JamesTwitter/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/JamesTwitter/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/JamesTwitter"
   }
}
