[
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2018-04-30T05:51:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#issuecomment-385317795",
      "id" : 385317795,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13120",
      "updated_at" : "2018-04-30T05:51:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385317795",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "utACK fae0e4f",
      "created_at" : "2018-05-01T22:53:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#issuecomment-385813887",
      "id" : 385813887,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13120",
      "updated_at" : "2018-05-01T22:53:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385813887",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK https://github.com/bitcoin/bitcoin/pull/13120/commits/fae0e4f3309eff88e9b3d50518b1f86413d399ce",
      "created_at" : "2018-05-02T09:11:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#issuecomment-385914144",
      "id" : 385914144,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13120",
      "updated_at" : "2018-05-02T09:11:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385914144",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/MeshCollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MeshCollider/followers",
         "following_url" : "https://api.github.com/users/MeshCollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MeshCollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MeshCollider",
         "id" : 3211283,
         "login" : "MeshCollider",
         "organizations_url" : "https://api.github.com/users/MeshCollider/orgs",
         "received_events_url" : "https://api.github.com/users/MeshCollider/received_events",
         "repos_url" : "https://api.github.com/users/MeshCollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MeshCollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MeshCollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MeshCollider"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Note that the test changes can be reviewed with leading white space ignored: `git diff fae0e4f~ fae0e4f --ignore-all-space ./test/`",
      "created_at" : "2018-05-02T18:33:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#issuecomment-386077077",
      "id" : 386077077,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13120",
      "updated_at" : "2018-05-02T18:33:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/386077077",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r185643579"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/185643579"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think this whole block can be removed (`self.log.info(\"Verify default node can't accept any witness format txs before fork\")` downwards). The previuos `self.fail_accept()` calls are testing transactions that are invalid both before and after the fork due to missing signatures.",
      "commit_id" : "340720c5d3bef6b61e6561aa505732ec51e4b565",
      "created_at" : "2018-05-02T21:25:34Z",
      "diff_hunk" : "@@ -138,11 +138,6 @@ def run_test(self):\n         # unsigned with redeem script\n         self.fail_accept(self.nodes[0], \"mandatory-script-verify-flag\", p2sh_ids[NODE_0][WIT_V0][0], False, witness_script(False, self.pubkey[0]))\n         self.fail_accept(self.nodes[0], \"mandatory-script-verify-flag\", p2sh_ids[NODE_0][WIT_V1][0], False, witness_script(True, self.pubkey[0]))\n-        # signed",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r185643579",
      "id" : 185643579,
      "original_commit_id" : "fae0e4f3309eff88e9b3d50518b1f86413d399ce",
      "original_position" : 17,
      "path" : "test/functional/feature_segwit.py",
      "position" : null,
      "pull_request_review_id" : 117075386,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120",
      "updated_at" : "2018-05-08T19:00:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/185643579",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r185644275"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/185644275"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Update comment above this function (`V0 segwit outputs should be standard after activation, but not before.`)",
      "commit_id" : "340720c5d3bef6b61e6561aa505732ec51e4b565",
      "created_at" : "2018-05-02T21:28:34Z",
      "diff_hunk" : "@@ -1149,45 +1149,46 @@ def test_standardness_v0(self, segwit_activated):\n         tx.vin = [CTxIn(COutPoint(p2sh_tx.sha256, 0), CScript([witness_program]))]\n         tx.vout = [CTxOut(p2sh_tx.vout[0].nValue-10000, scriptPubKey)]\n         tx.vout.append(CTxOut(8000, scriptPubKey)) # Might burn this later\n+        tx.vin[0].nSequence = BIP125_SEQUENCE_NUMBER  # Just to have the option to bump this tx from the mempool\n         tx.rehash()\n \n-        test_transaction_acceptance(self.nodes[1].rpc, self.std_node, tx, with_witness=True, accepted=segwit_activated)\n+        # This is always accepted, since the mempool policy is to consider segwit as always active\n+        # and thus allow segwit outputs\n+        test_transaction_acceptance(self.nodes[1].rpc, self.std_node, tx, with_witness=True, accepted=True)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r185644275",
      "id" : 185644275,
      "original_commit_id" : "fae0e4f3309eff88e9b3d50518b1f86413d399ce",
      "original_position" : 26,
      "path" : "test/functional/p2p_segwit.py",
      "position" : 76,
      "pull_request_review_id" : 117075386,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120",
      "updated_at" : "2018-05-08T19:00:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/185644275",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r185645086"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/185645086"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Just remove this entire block (everything from `We'll add an unnecessary witness to this transaction that would cause` down). `bad-witness-nonstandard` is tested further down.",
      "commit_id" : "340720c5d3bef6b61e6561aa505732ec51e4b565",
      "created_at" : "2018-05-02T21:32:00Z",
      "diff_hunk" : "@@ -252,11 +252,11 @@ def test_unnecessary_witness_before_segwit_activation(self):\n         tx3.vin.append(CTxIn(COutPoint(tx2.sha256, 0), CScript([p2sh_program])))\n         tx3.vout.append(CTxOut(tx2.vout[0].nValue-1000, scriptPubKey))\n         tx3.wit.vtxinwit.append(CTxInWitness())\n-        tx3.wit.vtxinwit[0].scriptWitness.stack = [b'a'*400000]\n+        tx3.wit.vtxinwit[0].scriptWitness.stack = [b'a' * 400]\n         tx3.rehash()\n-        # Note that this should be rejected for the premature witness reason,\n-        # rather than a policy check, since segwit hasn't activated yet.\n-        test_transaction_acceptance(self.nodes[1].rpc, self.std_node, tx3, True, False, b'no-witness-yet')\n+        # This will be rejected due to a policy check:\n+        # No witness is allowed, since it is not a witness program but a p2sh program",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r185645086",
      "id" : 185645086,
      "original_commit_id" : "fae0e4f3309eff88e9b3d50518b1f86413d399ce",
      "original_position" : 11,
      "path" : "test/functional/p2p_segwit.py",
      "position" : null,
      "pull_request_review_id" : 117075386,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120",
      "updated_at" : "2018-05-08T19:00:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/185645086",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186150966"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186150966"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This pull request changes the (rejection-/acceptance-) policy about segwit transactions that are otherwise valid, not about segwit transactions that are otherwise invalid. Personally I don't see the advantage in removing those tests and I'd suggest to move the suggested changes into a separate pull request, since it seems unrelated to the changes in this pull request.",
      "commit_id" : "340720c5d3bef6b61e6561aa505732ec51e4b565",
      "created_at" : "2018-05-04T17:22:04Z",
      "diff_hunk" : "@@ -138,11 +138,6 @@ def run_test(self):\n         # unsigned with redeem script\n         self.fail_accept(self.nodes[0], \"mandatory-script-verify-flag\", p2sh_ids[NODE_0][WIT_V0][0], False, witness_script(False, self.pubkey[0]))\n         self.fail_accept(self.nodes[0], \"mandatory-script-verify-flag\", p2sh_ids[NODE_0][WIT_V1][0], False, witness_script(True, self.pubkey[0]))\n-        # signed",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186150966",
      "id" : 186150966,
      "in_reply_to_id" : 185643579,
      "original_commit_id" : "fae0e4f3309eff88e9b3d50518b1f86413d399ce",
      "original_position" : 17,
      "path" : "test/functional/feature_segwit.py",
      "position" : null,
      "pull_request_review_id" : 117689333,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120",
      "updated_at" : "2018-05-08T19:00:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186150966",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186154120"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186154120"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Please note that `bad-witness-nonstandard` is a general reject reason and as far as I can see none of the tests below check for unnecessary witness. So I guess it is fine to keep this as is.",
      "commit_id" : "340720c5d3bef6b61e6561aa505732ec51e4b565",
      "created_at" : "2018-05-04T17:34:40Z",
      "diff_hunk" : "@@ -252,11 +252,11 @@ def test_unnecessary_witness_before_segwit_activation(self):\n         tx3.vin.append(CTxIn(COutPoint(tx2.sha256, 0), CScript([p2sh_program])))\n         tx3.vout.append(CTxOut(tx2.vout[0].nValue-1000, scriptPubKey))\n         tx3.wit.vtxinwit.append(CTxInWitness())\n-        tx3.wit.vtxinwit[0].scriptWitness.stack = [b'a'*400000]\n+        tx3.wit.vtxinwit[0].scriptWitness.stack = [b'a' * 400]\n         tx3.rehash()\n-        # Note that this should be rejected for the premature witness reason,\n-        # rather than a policy check, since segwit hasn't activated yet.\n-        test_transaction_acceptance(self.nodes[1].rpc, self.std_node, tx3, True, False, b'no-witness-yet')\n+        # This will be rejected due to a policy check:\n+        # No witness is allowed, since it is not a witness program but a p2sh program",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186154120",
      "id" : 186154120,
      "in_reply_to_id" : 185645086,
      "original_commit_id" : "fae0e4f3309eff88e9b3d50518b1f86413d399ce",
      "original_position" : 11,
      "path" : "test/functional/p2p_segwit.py",
      "position" : null,
      "pull_request_review_id" : 117693200,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120",
      "updated_at" : "2018-05-08T19:00:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186154120",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186165297"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186165297"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks! Fixed up the comment in a new commit.",
      "commit_id" : "340720c5d3bef6b61e6561aa505732ec51e4b565",
      "created_at" : "2018-05-04T17:49:32Z",
      "diff_hunk" : "@@ -1149,45 +1149,46 @@ def test_standardness_v0(self, segwit_activated):\n         tx.vin = [CTxIn(COutPoint(p2sh_tx.sha256, 0), CScript([witness_program]))]\n         tx.vout = [CTxOut(p2sh_tx.vout[0].nValue-10000, scriptPubKey)]\n         tx.vout.append(CTxOut(8000, scriptPubKey)) # Might burn this later\n+        tx.vin[0].nSequence = BIP125_SEQUENCE_NUMBER  # Just to have the option to bump this tx from the mempool\n         tx.rehash()\n \n-        test_transaction_acceptance(self.nodes[1].rpc, self.std_node, tx, with_witness=True, accepted=segwit_activated)\n+        # This is always accepted, since the mempool policy is to consider segwit as always active\n+        # and thus allow segwit outputs\n+        test_transaction_acceptance(self.nodes[1].rpc, self.std_node, tx, with_witness=True, accepted=True)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186165297",
      "id" : 186165297,
      "in_reply_to_id" : 185644275,
      "original_commit_id" : "fae0e4f3309eff88e9b3d50518b1f86413d399ce",
      "original_position" : 26,
      "path" : "test/functional/p2p_segwit.py",
      "position" : 76,
      "pull_request_review_id" : 117701949,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120",
      "updated_at" : "2018-05-08T19:00:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186165297",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186425558"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186425558"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I disagree. The entire `test_unnecessary_witness_before_segwit_activation()` subtest should be removed, since this PR updates the logic so there's no difference in behaviour before and after activation. Leaving this test as it is is misleading, since it implies that there's some difference in logic before and after activation.",
      "commit_id" : "340720c5d3bef6b61e6561aa505732ec51e4b565",
      "created_at" : "2018-05-07T13:41:09Z",
      "diff_hunk" : "@@ -252,11 +252,11 @@ def test_unnecessary_witness_before_segwit_activation(self):\n         tx3.vin.append(CTxIn(COutPoint(tx2.sha256, 0), CScript([p2sh_program])))\n         tx3.vout.append(CTxOut(tx2.vout[0].nValue-1000, scriptPubKey))\n         tx3.wit.vtxinwit.append(CTxInWitness())\n-        tx3.wit.vtxinwit[0].scriptWitness.stack = [b'a'*400000]\n+        tx3.wit.vtxinwit[0].scriptWitness.stack = [b'a' * 400]\n         tx3.rehash()\n-        # Note that this should be rejected for the premature witness reason,\n-        # rather than a policy check, since segwit hasn't activated yet.\n-        test_transaction_acceptance(self.nodes[1].rpc, self.std_node, tx3, True, False, b'no-witness-yet')\n+        # This will be rejected due to a policy check:\n+        # No witness is allowed, since it is not a witness program but a p2sh program",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186425558",
      "id" : 186425558,
      "in_reply_to_id" : 185645086,
      "original_commit_id" : "fae0e4f3309eff88e9b3d50518b1f86413d399ce",
      "original_position" : 11,
      "path" : "test/functional/p2p_segwit.py",
      "position" : null,
      "pull_request_review_id" : 117999738,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120",
      "updated_at" : "2018-05-08T19:00:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186425558",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186425990"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186425990"
         }
      },
      "author_association" : "MEMBER",
      "body" : "For the same reason as above, I think that including these tests is misleading for anyone reading the tests, since it implies that behaviour is different before and after segwit activation.",
      "commit_id" : "340720c5d3bef6b61e6561aa505732ec51e4b565",
      "created_at" : "2018-05-07T13:42:43Z",
      "diff_hunk" : "@@ -138,11 +138,6 @@ def run_test(self):\n         # unsigned with redeem script\n         self.fail_accept(self.nodes[0], \"mandatory-script-verify-flag\", p2sh_ids[NODE_0][WIT_V0][0], False, witness_script(False, self.pubkey[0]))\n         self.fail_accept(self.nodes[0], \"mandatory-script-verify-flag\", p2sh_ids[NODE_0][WIT_V1][0], False, witness_script(True, self.pubkey[0]))\n-        # signed",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186425990",
      "id" : 186425990,
      "in_reply_to_id" : 185643579,
      "original_commit_id" : "fae0e4f3309eff88e9b3d50518b1f86413d399ce",
      "original_position" : 17,
      "path" : "test/functional/feature_segwit.py",
      "position" : null,
      "pull_request_review_id" : 117999738,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120",
      "updated_at" : "2018-05-08T19:00:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186425990",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186815095"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186815095"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks! Reworded the comment in the last commit",
      "commit_id" : "340720c5d3bef6b61e6561aa505732ec51e4b565",
      "created_at" : "2018-05-08T17:58:08Z",
      "diff_hunk" : "@@ -138,11 +138,6 @@ def run_test(self):\n         # unsigned with redeem script\n         self.fail_accept(self.nodes[0], \"mandatory-script-verify-flag\", p2sh_ids[NODE_0][WIT_V0][0], False, witness_script(False, self.pubkey[0]))\n         self.fail_accept(self.nodes[0], \"mandatory-script-verify-flag\", p2sh_ids[NODE_0][WIT_V1][0], False, witness_script(True, self.pubkey[0]))\n-        # signed",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186815095",
      "id" : 186815095,
      "in_reply_to_id" : 185643579,
      "original_commit_id" : "fae0e4f3309eff88e9b3d50518b1f86413d399ce",
      "original_position" : 17,
      "path" : "test/functional/feature_segwit.py",
      "position" : null,
      "pull_request_review_id" : 118469595,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120",
      "updated_at" : "2018-05-08T19:00:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186815095",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186816034"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186816034"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Please note that the policy difference only has effect on transactions (and not blocks). This test is testing that blocks can not include unnecessary witness. It is also testing that unnecessary witness that is added to transactions \"in-flight\" (e.g. by malicious peers) does not add them to the rejection cache and that they'd be accepted just fine when sent without the witness.",
      "commit_id" : "340720c5d3bef6b61e6561aa505732ec51e4b565",
      "created_at" : "2018-05-08T18:01:14Z",
      "diff_hunk" : "@@ -252,11 +252,11 @@ def test_unnecessary_witness_before_segwit_activation(self):\n         tx3.vin.append(CTxIn(COutPoint(tx2.sha256, 0), CScript([p2sh_program])))\n         tx3.vout.append(CTxOut(tx2.vout[0].nValue-1000, scriptPubKey))\n         tx3.wit.vtxinwit.append(CTxInWitness())\n-        tx3.wit.vtxinwit[0].scriptWitness.stack = [b'a'*400000]\n+        tx3.wit.vtxinwit[0].scriptWitness.stack = [b'a' * 400]\n         tx3.rehash()\n-        # Note that this should be rejected for the premature witness reason,\n-        # rather than a policy check, since segwit hasn't activated yet.\n-        test_transaction_acceptance(self.nodes[1].rpc, self.std_node, tx3, True, False, b'no-witness-yet')\n+        # This will be rejected due to a policy check:\n+        # No witness is allowed, since it is not a witness program but a p2sh program",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186816034",
      "id" : 186816034,
      "in_reply_to_id" : 185645086,
      "original_commit_id" : "fae0e4f3309eff88e9b3d50518b1f86413d399ce",
      "original_position" : 11,
      "path" : "test/functional/p2p_segwit.py",
      "position" : null,
      "pull_request_review_id" : 118470738,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120",
      "updated_at" : "2018-05-08T19:00:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186816034",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186816367"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186816367"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I have amended the misleading comment in my last commit.",
      "commit_id" : "340720c5d3bef6b61e6561aa505732ec51e4b565",
      "created_at" : "2018-05-08T18:02:21Z",
      "diff_hunk" : "@@ -252,11 +252,11 @@ def test_unnecessary_witness_before_segwit_activation(self):\n         tx3.vin.append(CTxIn(COutPoint(tx2.sha256, 0), CScript([p2sh_program])))\n         tx3.vout.append(CTxOut(tx2.vout[0].nValue-1000, scriptPubKey))\n         tx3.wit.vtxinwit.append(CTxInWitness())\n-        tx3.wit.vtxinwit[0].scriptWitness.stack = [b'a'*400000]\n+        tx3.wit.vtxinwit[0].scriptWitness.stack = [b'a' * 400]\n         tx3.rehash()\n-        # Note that this should be rejected for the premature witness reason,\n-        # rather than a policy check, since segwit hasn't activated yet.\n-        test_transaction_acceptance(self.nodes[1].rpc, self.std_node, tx3, True, False, b'no-witness-yet')\n+        # This will be rejected due to a policy check:\n+        # No witness is allowed, since it is not a witness program but a p2sh program",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186816367",
      "id" : 186816367,
      "in_reply_to_id" : 185645086,
      "original_commit_id" : "fae0e4f3309eff88e9b3d50518b1f86413d399ce",
      "original_position" : 11,
      "path" : "test/functional/p2p_segwit.py",
      "position" : null,
      "pull_request_review_id" : 118471142,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120",
      "updated_at" : "2018-05-08T19:00:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186816367",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186820630"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186820630"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I still think these subtests should be moved to after segwit activation",
      "commit_id" : "340720c5d3bef6b61e6561aa505732ec51e4b565",
      "created_at" : "2018-05-08T18:17:07Z",
      "diff_hunk" : "@@ -138,11 +138,6 @@ def run_test(self):\n         # unsigned with redeem script\n         self.fail_accept(self.nodes[0], \"mandatory-script-verify-flag\", p2sh_ids[NODE_0][WIT_V0][0], False, witness_script(False, self.pubkey[0]))\n         self.fail_accept(self.nodes[0], \"mandatory-script-verify-flag\", p2sh_ids[NODE_0][WIT_V1][0], False, witness_script(True, self.pubkey[0]))\n-        # signed",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186820630",
      "id" : 186820630,
      "in_reply_to_id" : 185643579,
      "original_commit_id" : "fae0e4f3309eff88e9b3d50518b1f86413d399ce",
      "original_position" : 17,
      "path" : "test/functional/feature_segwit.py",
      "position" : null,
      "pull_request_review_id" : 118476394,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120",
      "updated_at" : "2018-05-08T19:00:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186820630",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186821324"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186821324"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This subtest should be in `test_non_standard_witness()`, not in `test_unnecessary_witness_before_segwit_activation()`",
      "commit_id" : "340720c5d3bef6b61e6561aa505732ec51e4b565",
      "created_at" : "2018-05-08T18:19:27Z",
      "diff_hunk" : "@@ -252,11 +252,11 @@ def test_unnecessary_witness_before_segwit_activation(self):\n         tx3.vin.append(CTxIn(COutPoint(tx2.sha256, 0), CScript([p2sh_program])))\n         tx3.vout.append(CTxOut(tx2.vout[0].nValue-1000, scriptPubKey))\n         tx3.wit.vtxinwit.append(CTxInWitness())\n-        tx3.wit.vtxinwit[0].scriptWitness.stack = [b'a'*400000]\n+        tx3.wit.vtxinwit[0].scriptWitness.stack = [b'a' * 400]\n         tx3.rehash()\n-        # Note that this should be rejected for the premature witness reason,\n-        # rather than a policy check, since segwit hasn't activated yet.\n-        test_transaction_acceptance(self.nodes[1].rpc, self.std_node, tx3, True, False, b'no-witness-yet')\n+        # This will be rejected due to a policy check:\n+        # No witness is allowed, since it is not a witness program but a p2sh program",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186821324",
      "id" : 186821324,
      "in_reply_to_id" : 185645086,
      "original_commit_id" : "fae0e4f3309eff88e9b3d50518b1f86413d399ce",
      "original_position" : 11,
      "path" : "test/functional/p2p_segwit.py",
      "position" : null,
      "pull_request_review_id" : 118477229,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120",
      "updated_at" : "2018-05-08T19:00:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186821324",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186828799"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186828799"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I have moved it to a separate test case so that the symbols don't collide",
      "commit_id" : "340720c5d3bef6b61e6561aa505732ec51e4b565",
      "created_at" : "2018-05-08T18:44:35Z",
      "diff_hunk" : "@@ -252,11 +252,11 @@ def test_unnecessary_witness_before_segwit_activation(self):\n         tx3.vin.append(CTxIn(COutPoint(tx2.sha256, 0), CScript([p2sh_program])))\n         tx3.vout.append(CTxOut(tx2.vout[0].nValue-1000, scriptPubKey))\n         tx3.wit.vtxinwit.append(CTxInWitness())\n-        tx3.wit.vtxinwit[0].scriptWitness.stack = [b'a'*400000]\n+        tx3.wit.vtxinwit[0].scriptWitness.stack = [b'a' * 400]\n         tx3.rehash()\n-        # Note that this should be rejected for the premature witness reason,\n-        # rather than a policy check, since segwit hasn't activated yet.\n-        test_transaction_acceptance(self.nodes[1].rpc, self.std_node, tx3, True, False, b'no-witness-yet')\n+        # This will be rejected due to a policy check:\n+        # No witness is allowed, since it is not a witness program but a p2sh program",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#discussion_r186828799",
      "id" : 186828799,
      "in_reply_to_id" : 185645086,
      "original_commit_id" : "fae0e4f3309eff88e9b3d50518b1f86413d399ce",
      "original_position" : 11,
      "path" : "test/functional/p2p_segwit.py",
      "position" : null,
      "pull_request_review_id" : 118486295,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13120",
      "updated_at" : "2018-05-08T19:00:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186828799",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 340720c5d3bef6b61e6561aa505732ec51e4b565",
      "created_at" : "2018-05-08T19:03:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#issuecomment-387508518",
      "id" : 387508518,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13120",
      "updated_at" : "2018-05-08T19:03:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/387508518",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think this is a good idea, but I struggle with one issue.  I think it's reasonably likely that I'm being overly pedantic, but here goes anyway:\r\n\r\nI believe our code should be robust and internally consistent.  The existing code is very robust -- if we somehow end up on a branch where BIP 141 is not active, then we'll stop allowing new segwit transactions to our mempool.  After #11739, this is required, as it is no longer possible with this software to spend v0 witness outputs unless BIP 141 is active (because the witness is required, yet blocks cannot contain witness-bearing transactions unless BIP 141 is active).\r\n\r\nConsequently this change would introduce potentially (admittedly unlikely) internally-inconsistent behavior depending on the state of the chain.  This is the case even if all the nodes on the network were running the same software (contrast this with, say, BIP90-style consensus changes, where the internal consistency is unaffected by a large reorg, although external consistency -- consensus with nodes running other software -- could be a potential issue).  I don't know if this is overly pedantic, but it vaguely troubles me to allow for an internally-inconsistent edge case, even if it's very unlikely.\r\n\r\n(I was trying to come up with other examples of times we've done something like this and determined that this was okay, but I couldn't come up with anything.)\r\n\r\nAll that said, I think this is a useful simplification that I'd like to make.  One idea I thought of was something like #12360 (which would lock in segwit activation at a block height), which makes it even less likely that you could end up on a branch on which the software would not think that BIP 141 was active.  But even that isn't bulletproof as in theory we could end up on a shorter, more-work chain below that activation height.\r\n\r\nSo I'm not sure what the right course of action here is; if others aren't concerned about this issue then maybe we can just take it as-is, or maybe someone has another idea to ensure that our code is always internally-consistent?",
      "created_at" : "2018-05-09T15:34:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#issuecomment-387780367",
      "id" : 387780367,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13120",
      "updated_at" : "2018-05-09T15:34:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/387780367",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think we are slightly more internally consistent with this change, considering that the wallet already treats segwit as always active and feeds the mempool with segwit transactions (that are potentially rejected, based on the versionbits-state of the node's tip).\r\n\r\nNote that our miner would not include segwit transactions until the segwit commitment is allowed in the coinbase. So I think we are internally consistent with this change.\r\n\r\nI'd assume the only way this could break is when a miner picks transactions directly from the mempool and includes a transaction with witness in a block on a chain where segwit is not active. Although, to me it appears that this change isn't making that possible or particularly worse, given that a miner could always manually pick random transactions that are invalid in blocks.",
      "created_at" : "2018-05-09T16:41:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#issuecomment-387801134",
      "id" : 387801134,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13120",
      "updated_at" : "2018-05-09T16:41:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/387801134",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Agreed, I had overlooked the mining logic that remains in place, which would prevent including segwit transactions if somehow BIP 141 were not active on the chain.  So indeed I believe that this change would not result in internally inconsistent behavior, merely suboptimal behavior, which I think is totally fine in such a case.\r\n\r\nI do think that it would be somewhat better to also move forward with #12360 (which would cement the idea that the node will always eventually find segwit transactions to be valid, at some blockheight -- so that we aren't filling our mempool up with transactions that we might never think could be mined) but I don't think that discussion needs to hold this up at all.\r\n\r\nConcept ACK.",
      "created_at" : "2018-05-09T16:52:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#issuecomment-387804210",
      "id" : 387804210,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13120",
      "updated_at" : "2018-05-09T16:52:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/387804210",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Squashed and rebased. (Only merge conflict was in the functional tests)",
      "created_at" : "2018-05-13T15:19:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#issuecomment-388634521",
      "id" : 388634521,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13120",
      "updated_at" : "2018-05-13T15:19:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/388634521",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "re-utACK fa2a73a41e5d196c7c82ed1fd451e989a31aef37",
      "created_at" : "2018-05-16T21:23:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#issuecomment-389670289",
      "id" : 389670289,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13120",
      "updated_at" : "2018-05-16T21:23:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/389670289",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased to accommodate for moved file in `test/lint` (no code changes)",
      "created_at" : "2018-05-29T20:52:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13120#issuecomment-392940348",
      "id" : 392940348,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13120",
      "updated_at" : "2018-05-29T20:52:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/392940348",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
