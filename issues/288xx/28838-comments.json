[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/28838).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [theStack](https://github.com/bitcoin/bitcoin/pull/28838#pullrequestreview-1813788224), [maflcko](https://github.com/bitcoin/bitcoin/pull/28838#issuecomment-1886787577), [achow101](https://github.com/bitcoin/bitcoin/pull/28838#issuecomment-1887519279) |\n| Concept ACK | [BrandonOdiwuor](https://github.com/bitcoin/bitcoin/pull/28838#pullrequestreview-1798753190) |\n| Stale ACK | [pablomartin4btc](https://github.com/bitcoin/bitcoin/pull/28838#pullrequestreview-1749243180) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#28616](https://github.com/bitcoin/bitcoin/pull/28616) (Show transactions as not fully confirmed during background validation by Sjors)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-11-10T01:15:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#issuecomment-1804923575",
      "id" : 1804923575,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28838",
      "node_id" : "IC_kwDOABII585rlPK3",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1804923575/reactions"
      },
      "updated_at" : "2024-01-11T16:23:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1804923575",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1389091265"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389091265"
         }
      },
      "author_association" : "MEMBER",
      "body" : "My diff was a hack, obviously. I don't think it makes sense to escape the datadir \"sandbox\" and potentially overwrite user data when running a test.",
      "commit_id" : "0b8143396183d23e215fc90a2d24813ad1b7ad23",
      "created_at" : "2023-11-10T08:50:23Z",
      "diff_hunk" : "@@ -0,0 +1,159 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+## Possible test improvements\n+\n+- TODO: the \"assumed\" field for a confirmed wallet transaction should be\n+        present during background sync, start false and become true as\n+        sync progresses.\n+        Alternatively prevent loading a wallet with a birthdate before\n+        the snapshot height, as is done with restoring from backup.\n+\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+START_HEIGHT = 199\n+SNAPSHOT_BASE_HEIGHT = 299\n+FINAL_HEIGHT = 399\n+\n+class AssumeutxoTest(BitcoinTestFramework):\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        \"\"\"Use the pregenerated, deterministic chain up to height 199.\"\"\"\n+        self.num_nodes = 2\n+        self.rpc_timeout = 120\n+        self.extra_args = [\n+            [],\n+            [\"-fastprune\", \"-prune=1\"]\n+        ]\n+\n+    def setup_network(self):\n+        \"\"\"Start with the nodes disconnected so that one can generate a snapshot\n+        including blocks the other hasn't yet seen.\"\"\"\n+        self.add_nodes(2)\n+        self.start_nodes(extra_args=self.extra_args)\n+\n+    def run_test(self):\n+        \"\"\"\n+        Bring up two (disconnected) nodes, mine some new blocks on the first,\n+        and generate a UTXO snapshot.\n+\n+        Load the snapshot into the second, ensure it syncs to tip and completes\n+        background validation when connected to the first.\n+        \"\"\"\n+        n0 = self.nodes[0]\n+        n1 = self.nodes[1]\n+\n+        # Mock time for a deterministic chain\n+        for n in self.nodes:\n+            n.setmocktime(n.getblockheader(n.getbestblockhash())['time'])\n+\n+        self.sync_blocks()\n+\n+        n0.createwallet('test',blank=True, disable_private_keys=True, descriptors=True)\n+        w = n0.get_wallet_rpc(\"test\")\n+\n+        w.importdescriptors([{\"desc\":\"addr(mjTkW3DjgyZck4KbiRusZsqTgaYTxdSz6z)#jdtmxdcm\",\"timestamp\":0,\"label\":\"det_coinbase_key_0\"}])\n+\n+        # Generate a series of blocks that `n0` will have in the snapshot,\n+        # but that n1 doesn't yet see. In order for the snapshot to activate,\n+        # though, we have to ferry over the new headers to n1 so that it\n+        # isn't waiting forever to see the header of the snapshot's base block\n+        # while disconnected from n0.\n+        for i in range(100):\n+            self.generate(n0, nblocks=1, sync_fun=self.no_op)\n+            newblock = n0.getblock(n0.getbestblockhash(), 0)\n+\n+            # make n1 aware of the new header, but don't give it the block.\n+            n1.submitheader(newblock)\n+\n+        # Ensure everyone is seeing the same headers.\n+        for n in self.nodes:\n+            assert_equal(n.getblockchaininfo()[\"headers\"], SNAPSHOT_BASE_HEIGHT)\n+\n+        w.backupwallet(\"/tmp/abc.dat\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1389091265",
      "id" : 1389091265,
      "line" : 87,
      "node_id" : "PRRC_kwDOABII585Sy9nB",
      "original_commit_id" : "0b8143396183d23e215fc90a2d24813ad1b7ad23",
      "original_line" : 87,
      "original_position" : 87,
      "original_start_line" : null,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : 87,
      "pull_request_review_id" : 1724298102,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389091265/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-10T08:52:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389091265",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1389093305"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389093305"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Seems odd to add a TODO to add a test based on a feature that doesn't even exist.",
      "commit_id" : "0b8143396183d23e215fc90a2d24813ad1b7ad23",
      "created_at" : "2023-11-10T08:51:47Z",
      "diff_hunk" : "@@ -0,0 +1,159 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+## Possible test improvements\n+\n+- TODO: the \"assumed\" field for a confirmed wallet transaction should be",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1389093305",
      "id" : 1389093305,
      "line" : 10,
      "node_id" : "PRRC_kwDOABII585Sy-G5",
      "original_commit_id" : "0b8143396183d23e215fc90a2d24813ad1b7ad23",
      "original_line" : 10,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : 10,
      "pull_request_review_id" : 1724298102,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389093305/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-10T08:52:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389093305",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1389094288"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389094288"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: `blank` may not be needed? Also, could run a python formatter on this file to fix the whitespace?",
      "commit_id" : "0b8143396183d23e215fc90a2d24813ad1b7ad23",
      "created_at" : "2023-11-10T08:52:37Z",
      "diff_hunk" : "@@ -0,0 +1,159 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+## Possible test improvements\n+\n+- TODO: the \"assumed\" field for a confirmed wallet transaction should be\n+        present during background sync, start false and become true as\n+        sync progresses.\n+        Alternatively prevent loading a wallet with a birthdate before\n+        the snapshot height, as is done with restoring from backup.\n+\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+START_HEIGHT = 199\n+SNAPSHOT_BASE_HEIGHT = 299\n+FINAL_HEIGHT = 399\n+\n+class AssumeutxoTest(BitcoinTestFramework):\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        \"\"\"Use the pregenerated, deterministic chain up to height 199.\"\"\"\n+        self.num_nodes = 2\n+        self.rpc_timeout = 120\n+        self.extra_args = [\n+            [],\n+            [\"-fastprune\", \"-prune=1\"]\n+        ]\n+\n+    def setup_network(self):\n+        \"\"\"Start with the nodes disconnected so that one can generate a snapshot\n+        including blocks the other hasn't yet seen.\"\"\"\n+        self.add_nodes(2)\n+        self.start_nodes(extra_args=self.extra_args)\n+\n+    def run_test(self):\n+        \"\"\"\n+        Bring up two (disconnected) nodes, mine some new blocks on the first,\n+        and generate a UTXO snapshot.\n+\n+        Load the snapshot into the second, ensure it syncs to tip and completes\n+        background validation when connected to the first.\n+        \"\"\"\n+        n0 = self.nodes[0]\n+        n1 = self.nodes[1]\n+\n+        # Mock time for a deterministic chain\n+        for n in self.nodes:\n+            n.setmocktime(n.getblockheader(n.getbestblockhash())['time'])\n+\n+        self.sync_blocks()\n+\n+        n0.createwallet('test',blank=True, disable_private_keys=True, descriptors=True)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1389094288",
      "id" : 1389094288,
      "line" : 66,
      "node_id" : "PRRC_kwDOABII585Sy-WQ",
      "original_commit_id" : "0b8143396183d23e215fc90a2d24813ad1b7ad23",
      "original_line" : 66,
      "original_position" : 66,
      "original_start_line" : null,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : 66,
      "pull_request_review_id" : 1724298102,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389094288/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-10T08:52:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389094288",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1389415296"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389415296"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In 0b8143396183d23e215fc90a2d24813ad1b7ad23: nit\r\n```suggestion\r\n        for _ in range(100):\r\n```",
      "commit_id" : "0b8143396183d23e215fc90a2d24813ad1b7ad23",
      "created_at" : "2023-11-10T13:45:13Z",
      "diff_hunk" : "@@ -0,0 +1,159 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+## Possible test improvements\n+\n+- TODO: the \"assumed\" field for a confirmed wallet transaction should be\n+        present during background sync, start false and become true as\n+        sync progresses.\n+        Alternatively prevent loading a wallet with a birthdate before\n+        the snapshot height, as is done with restoring from backup.\n+\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+START_HEIGHT = 199\n+SNAPSHOT_BASE_HEIGHT = 299\n+FINAL_HEIGHT = 399\n+\n+class AssumeutxoTest(BitcoinTestFramework):\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        \"\"\"Use the pregenerated, deterministic chain up to height 199.\"\"\"\n+        self.num_nodes = 2\n+        self.rpc_timeout = 120\n+        self.extra_args = [\n+            [],\n+            [\"-fastprune\", \"-prune=1\"]\n+        ]\n+\n+    def setup_network(self):\n+        \"\"\"Start with the nodes disconnected so that one can generate a snapshot\n+        including blocks the other hasn't yet seen.\"\"\"\n+        self.add_nodes(2)\n+        self.start_nodes(extra_args=self.extra_args)\n+\n+    def run_test(self):\n+        \"\"\"\n+        Bring up two (disconnected) nodes, mine some new blocks on the first,\n+        and generate a UTXO snapshot.\n+\n+        Load the snapshot into the second, ensure it syncs to tip and completes\n+        background validation when connected to the first.\n+        \"\"\"\n+        n0 = self.nodes[0]\n+        n1 = self.nodes[1]\n+\n+        # Mock time for a deterministic chain\n+        for n in self.nodes:\n+            n.setmocktime(n.getblockheader(n.getbestblockhash())['time'])\n+\n+        self.sync_blocks()\n+\n+        n0.createwallet('test',blank=True, disable_private_keys=True, descriptors=True)\n+        w = n0.get_wallet_rpc(\"test\")\n+\n+        w.importdescriptors([{\"desc\":\"addr(mjTkW3DjgyZck4KbiRusZsqTgaYTxdSz6z)#jdtmxdcm\",\"timestamp\":0,\"label\":\"det_coinbase_key_0\"}])\n+\n+        # Generate a series of blocks that `n0` will have in the snapshot,\n+        # but that n1 doesn't yet see. In order for the snapshot to activate,\n+        # though, we have to ferry over the new headers to n1 so that it\n+        # isn't waiting forever to see the header of the snapshot's base block\n+        # while disconnected from n0.\n+        for i in range(100):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1389415296",
      "id" : 1389415296,
      "line" : 76,
      "node_id" : "PRRC_kwDOABII585S0MuA",
      "original_commit_id" : "0b8143396183d23e215fc90a2d24813ad1b7ad23",
      "original_line" : 76,
      "original_position" : 76,
      "original_start_line" : null,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : 76,
      "pull_request_review_id" : 1724814188,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389415296/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-10T13:45:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389415296",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1390663584"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1390663584"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Might indeed just give the wallet some keys, so later tests can have transactions and rescans.\r\n\r\nWhich formatter? Ah PEP-8 https://github.com/bitcoin/bitcoin/tree/master/test/functional#style-guidelines",
      "commit_id" : "f4f3a0c910a148a158e1879f8c9e6767575539db",
      "created_at" : "2023-11-13T06:25:16Z",
      "diff_hunk" : "@@ -0,0 +1,159 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+## Possible test improvements\n+\n+- TODO: the \"assumed\" field for a confirmed wallet transaction should be\n+        present during background sync, start false and become true as\n+        sync progresses.\n+        Alternatively prevent loading a wallet with a birthdate before\n+        the snapshot height, as is done with restoring from backup.\n+\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+START_HEIGHT = 199\n+SNAPSHOT_BASE_HEIGHT = 299\n+FINAL_HEIGHT = 399\n+\n+class AssumeutxoTest(BitcoinTestFramework):\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        \"\"\"Use the pregenerated, deterministic chain up to height 199.\"\"\"\n+        self.num_nodes = 2\n+        self.rpc_timeout = 120\n+        self.extra_args = [\n+            [],\n+            [\"-fastprune\", \"-prune=1\"]\n+        ]\n+\n+    def setup_network(self):\n+        \"\"\"Start with the nodes disconnected so that one can generate a snapshot\n+        including blocks the other hasn't yet seen.\"\"\"\n+        self.add_nodes(2)\n+        self.start_nodes(extra_args=self.extra_args)\n+\n+    def run_test(self):\n+        \"\"\"\n+        Bring up two (disconnected) nodes, mine some new blocks on the first,\n+        and generate a UTXO snapshot.\n+\n+        Load the snapshot into the second, ensure it syncs to tip and completes\n+        background validation when connected to the first.\n+        \"\"\"\n+        n0 = self.nodes[0]\n+        n1 = self.nodes[1]\n+\n+        # Mock time for a deterministic chain\n+        for n in self.nodes:\n+            n.setmocktime(n.getblockheader(n.getbestblockhash())['time'])\n+\n+        self.sync_blocks()\n+\n+        n0.createwallet('test',blank=True, disable_private_keys=True, descriptors=True)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1390663584",
      "id" : 1390663584,
      "in_reply_to_id" : 1389094288,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585S49eg",
      "original_commit_id" : "0b8143396183d23e215fc90a2d24813ad1b7ad23",
      "original_line" : 66,
      "original_position" : 66,
      "original_start_line" : null,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : null,
      "pull_request_review_id" : 1726606376,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1390663584/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-13T06:38:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1390663584",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1390665847"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1390665847"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Dropped",
      "commit_id" : "f4f3a0c910a148a158e1879f8c9e6767575539db",
      "created_at" : "2023-11-13T06:29:52Z",
      "diff_hunk" : "@@ -0,0 +1,159 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+## Possible test improvements\n+\n+- TODO: the \"assumed\" field for a confirmed wallet transaction should be",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1390665847",
      "id" : 1390665847,
      "in_reply_to_id" : 1389093305,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585S4-B3",
      "original_commit_id" : "0b8143396183d23e215fc90a2d24813ad1b7ad23",
      "original_line" : 10,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : null,
      "pull_request_review_id" : 1726609873,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1390665847/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-13T06:29:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1390665847",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Pushed some cleanups.",
      "created_at" : "2023-11-13T06:43:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#issuecomment-1807555704",
      "id" : 1807555704,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28838",
      "node_id" : "IC_kwDOABII585rvRx4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1807555704/reactions"
      },
      "updated_at" : "2023-11-13T06:43:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1807555704",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1390771582"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1390771582"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Could add a comment why this is needed?",
      "commit_id" : "f4f3a0c910a148a158e1879f8c9e6767575539db",
      "created_at" : "2023-11-13T08:47:09Z",
      "diff_hunk" : "@@ -0,0 +1,160 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+START_HEIGHT = 199\n+SNAPSHOT_BASE_HEIGHT = 299\n+FINAL_HEIGHT = 399\n+\n+\n+class AssumeutxoTest(BitcoinTestFramework):\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        \"\"\"Use the pregenerated, deterministic chain up to height 199.\"\"\"\n+        self.num_nodes = 2\n+        self.rpc_timeout = 120\n+        self.extra_args = [\n+            [],\n+            [\"-fastprune\", \"-prune=1\"]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1390771582",
      "id" : 1390771582,
      "line" : 33,
      "node_id" : "PRRC_kwDOABII585S5X1-",
      "original_commit_id" : "f4f3a0c910a148a158e1879f8c9e6767575539db",
      "original_line" : 33,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : 33,
      "pull_request_review_id" : 1726782224,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1390771582/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-13T08:47:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1390771582",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1390973314"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1390973314"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's not. Replaced with a TODO comment to add wallet test for a pruned node.",
      "commit_id" : "f4f3a0c910a148a158e1879f8c9e6767575539db",
      "created_at" : "2023-11-13T11:13:19Z",
      "diff_hunk" : "@@ -0,0 +1,160 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+START_HEIGHT = 199\n+SNAPSHOT_BASE_HEIGHT = 299\n+FINAL_HEIGHT = 399\n+\n+\n+class AssumeutxoTest(BitcoinTestFramework):\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        \"\"\"Use the pregenerated, deterministic chain up to height 199.\"\"\"\n+        self.num_nodes = 2\n+        self.rpc_timeout = 120\n+        self.extra_args = [\n+            [],\n+            [\"-fastprune\", \"-prune=1\"]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1390973314",
      "id" : 1390973314,
      "in_reply_to_id" : 1390771582,
      "line" : 33,
      "node_id" : "PRRC_kwDOABII585S6JGC",
      "original_commit_id" : "f4f3a0c910a148a158e1879f8c9e6767575539db",
      "original_line" : 33,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : 33,
      "pull_request_review_id" : 1727094996,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1390973314/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-13T11:13:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1390973314",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1390973698"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1390973698"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Also dropping this import since the wallet is no longer watch-only. I added a TODO instead to test scenarios like when you import a descriptor with existing transactions while background sync is in progress.",
      "commit_id" : "f4f3a0c910a148a158e1879f8c9e6767575539db",
      "created_at" : "2023-11-13T11:13:43Z",
      "diff_hunk" : "@@ -0,0 +1,160 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+START_HEIGHT = 199\n+SNAPSHOT_BASE_HEIGHT = 299\n+FINAL_HEIGHT = 399\n+\n+\n+class AssumeutxoTest(BitcoinTestFramework):\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        \"\"\"Use the pregenerated, deterministic chain up to height 199.\"\"\"\n+        self.num_nodes = 2\n+        self.rpc_timeout = 120\n+        self.extra_args = [\n+            [],\n+            [\"-fastprune\", \"-prune=1\"]\n+        ]\n+\n+    def setup_network(self):\n+        \"\"\"Start with the nodes disconnected so that one can generate a snapshot\n+        including blocks the other hasn't yet seen.\"\"\"\n+        self.add_nodes(2)\n+        self.start_nodes(extra_args=self.extra_args)\n+\n+    def run_test(self):\n+        \"\"\"\n+        Bring up two (disconnected) nodes, mine some new blocks on the first,\n+        and generate a UTXO snapshot.\n+\n+        Load the snapshot into the second, ensure it syncs to tip and completes\n+        background validation when connected to the first.\n+        \"\"\"\n+        n0 = self.nodes[0]\n+        n1 = self.nodes[1]\n+\n+        # Mock time for a deterministic chain\n+        for n in self.nodes:\n+            n.setmocktime(n.getblockheader(n.getbestblockhash())['time'])\n+\n+        self.sync_blocks()\n+\n+        n0.createwallet('w')\n+        w = n0.get_wallet_rpc(\"w\")\n+\n+        w.importdescriptors([{\"desc\": \"addr(mjTkW3DjgyZck4KbiRusZsqTgaYTxdSz6z)#jdtmxdcm\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1390973698",
      "id" : 1390973698,
      "line" : 62,
      "node_id" : "PRRC_kwDOABII585S6JMC",
      "original_commit_id" : "f4f3a0c910a148a158e1879f8c9e6767575539db",
      "original_line" : 62,
      "original_position" : 62,
      "original_start_line" : null,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : 62,
      "pull_request_review_id" : 1727095597,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1390973698/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-13T11:19:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1390973698",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "lgtm ACK f4f3a0c910a148a158e1879f8c9e6767575539db",
      "created_at" : "2023-11-27T09:32:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#issuecomment-1827463604",
      "id" : 1827463604,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28838",
      "node_id" : "IC_kwDOABII585s7OG0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1827463604/reactions"
      },
      "updated_at" : "2023-11-27T09:32:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1827463604",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1407829770"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1407829770"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It doesn't seem like this was pushed?",
      "commit_id" : "f4f3a0c910a148a158e1879f8c9e6767575539db",
      "created_at" : "2023-11-28T14:14:14Z",
      "diff_hunk" : "@@ -0,0 +1,160 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+START_HEIGHT = 199\n+SNAPSHOT_BASE_HEIGHT = 299\n+FINAL_HEIGHT = 399\n+\n+\n+class AssumeutxoTest(BitcoinTestFramework):\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        \"\"\"Use the pregenerated, deterministic chain up to height 199.\"\"\"\n+        self.num_nodes = 2\n+        self.rpc_timeout = 120\n+        self.extra_args = [\n+            [],\n+            [\"-fastprune\", \"-prune=1\"]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1407829770",
      "id" : 1407829770,
      "in_reply_to_id" : 1390771582,
      "line" : 33,
      "node_id" : "PRRC_kwDOABII585T6ccK",
      "original_commit_id" : "f4f3a0c910a148a158e1879f8c9e6767575539db",
      "original_line" : 33,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : 33,
      "pull_request_review_id" : 1753002049,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1407829770/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-28T14:14:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1407829770",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1407829924"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1407829924"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It doesn't seem like this was pushed?",
      "commit_id" : "f4f3a0c910a148a158e1879f8c9e6767575539db",
      "created_at" : "2023-11-28T14:14:21Z",
      "diff_hunk" : "@@ -0,0 +1,160 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+START_HEIGHT = 199\n+SNAPSHOT_BASE_HEIGHT = 299\n+FINAL_HEIGHT = 399\n+\n+\n+class AssumeutxoTest(BitcoinTestFramework):\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        \"\"\"Use the pregenerated, deterministic chain up to height 199.\"\"\"\n+        self.num_nodes = 2\n+        self.rpc_timeout = 120\n+        self.extra_args = [\n+            [],\n+            [\"-fastprune\", \"-prune=1\"]\n+        ]\n+\n+    def setup_network(self):\n+        \"\"\"Start with the nodes disconnected so that one can generate a snapshot\n+        including blocks the other hasn't yet seen.\"\"\"\n+        self.add_nodes(2)\n+        self.start_nodes(extra_args=self.extra_args)\n+\n+    def run_test(self):\n+        \"\"\"\n+        Bring up two (disconnected) nodes, mine some new blocks on the first,\n+        and generate a UTXO snapshot.\n+\n+        Load the snapshot into the second, ensure it syncs to tip and completes\n+        background validation when connected to the first.\n+        \"\"\"\n+        n0 = self.nodes[0]\n+        n1 = self.nodes[1]\n+\n+        # Mock time for a deterministic chain\n+        for n in self.nodes:\n+            n.setmocktime(n.getblockheader(n.getbestblockhash())['time'])\n+\n+        self.sync_blocks()\n+\n+        n0.createwallet('w')\n+        w = n0.get_wallet_rpc(\"w\")\n+\n+        w.importdescriptors([{\"desc\": \"addr(mjTkW3DjgyZck4KbiRusZsqTgaYTxdSz6z)#jdtmxdcm\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1407829924",
      "id" : 1407829924,
      "in_reply_to_id" : 1390973698,
      "line" : 62,
      "node_id" : "PRRC_kwDOABII585T6cek",
      "original_commit_id" : "f4f3a0c910a148a158e1879f8c9e6767575539db",
      "original_line" : 62,
      "original_position" : 62,
      "original_start_line" : null,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : 62,
      "pull_request_review_id" : 1753002299,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1407829924/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-28T14:14:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1407829924",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@achow101 good catch, I indeed forgot to push.\r\n\r\n@pablomartin4btc I think he likes it this way",
      "created_at" : "2023-11-28T15:24:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#issuecomment-1830067746",
      "id" : 1830067746,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28838",
      "node_id" : "IC_kwDOABII585tFJ4i",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1830067746/reactions"
      },
      "updated_at" : "2023-11-28T15:24:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1830067746",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK\r\n\r\nWill review in a bit. As a follow-up idea, maybe we could put the AssumeUTXO chain and snapshot creation in a shared module, in order to deduplicate code between feature_assumeutxo.py and wallet_assumeutxo.py? If we ever wanted to change the snapshot chainstate for e.g. more advanced tests, it'd be quite annoying having to touch several files.",
      "created_at" : "2024-01-10T12:43:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#issuecomment-1884782328",
      "id" : 1884782328,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28838",
      "node_id" : "IC_kwDOABII585wV374",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1884782328/reactions"
      },
      "updated_at" : "2024-01-10T12:43:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1884782328",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1447730295"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447730295"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: looks like an unintended newline here?\r\n```suggestion\r\n            assert_equal(n.getblockchaininfo()[\"headers\"], SNAPSHOT_BASE_HEIGHT)\r\n```",
      "commit_id" : "997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "created_at" : "2024-01-10T17:49:29Z",
      "diff_hunk" : "@@ -0,0 +1,164 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+## Possible test improvements\n+\n+- TODO: test import descriptors while background sync is in progress\n+- TODO: test loading a wallet (backup) on a pruned node\n+\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+START_HEIGHT = 199\n+SNAPSHOT_BASE_HEIGHT = 299\n+FINAL_HEIGHT = 399\n+\n+\n+class AssumeutxoTest(BitcoinTestFramework):\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        \"\"\"Use the pregenerated, deterministic chain up to height 199.\"\"\"\n+        self.num_nodes = 2\n+        self.rpc_timeout = 120\n+        self.extra_args = [\n+            [],\n+            [],\n+        ]\n+\n+    def setup_network(self):\n+        \"\"\"Start with the nodes disconnected so that one can generate a snapshot\n+        including blocks the other hasn't yet seen.\"\"\"\n+        self.add_nodes(2)\n+        self.start_nodes(extra_args=self.extra_args)\n+\n+    def run_test(self):\n+        \"\"\"\n+        Bring up two (disconnected) nodes, mine some new blocks on the first,\n+        and generate a UTXO snapshot.\n+\n+        Load the snapshot into the second, ensure it syncs to tip and completes\n+        background validation when connected to the first.\n+        \"\"\"\n+        n0 = self.nodes[0]\n+        n1 = self.nodes[1]\n+\n+        # Mock time for a deterministic chain\n+        for n in self.nodes:\n+            n.setmocktime(n.getblockheader(n.getbestblockhash())['time'])\n+\n+        self.sync_blocks()\n+\n+        n0.createwallet('w')\n+        w = n0.get_wallet_rpc(\"w\")\n+\n+        # Generate a series of blocks that `n0` will have in the snapshot,\n+        # but that n1 doesn't yet see. In order for the snapshot to activate,\n+        # though, we have to ferry over the new headers to n1 so that it\n+        # isn't waiting forever to see the header of the snapshot's base block\n+        # while disconnected from n0.\n+        for _ in range(100):\n+            self.generate(n0, nblocks=1, sync_fun=self.no_op)\n+            newblock = n0.getblock(n0.getbestblockhash(), 0)\n+\n+            # make n1 aware of the new header, but don't give it the block.\n+            n1.submitheader(newblock)\n+\n+        # Ensure everyone is seeing the same headers.\n+        for n in self.nodes:\n+            assert_equal(n.getblockchaininfo()[\n+                         \"headers\"], SNAPSHOT_BASE_HEIGHT)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1447730295",
      "id" : 1447730295,
      "line" : 82,
      "node_id" : "PRRC_kwDOABII585WSpx3",
      "original_commit_id" : "997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "original_line" : 82,
      "original_position" : 82,
      "original_start_line" : 81,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : 82,
      "pull_request_review_id" : 1813788224,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447730295/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 81,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-01-10T17:51:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1447730295",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "lgtm ACK 997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "created_at" : "2024-01-11T10:16:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#issuecomment-1886787577",
      "id" : 1886787577,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28838",
      "node_id" : "IC_kwDOABII585wdhf5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1886787577/reactions"
      },
      "updated_at" : "2024-01-11T10:16:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1886787577",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "created_at" : "2024-01-11T16:23:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#issuecomment-1887519279",
      "id" : 1887519279,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28838",
      "node_id" : "IC_kwDOABII585wgUIv",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1887519279/reactions"
      },
      "updated_at" : "2024-01-11T16:23:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1887519279",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Posthumous ACK https://github.com/bitcoin/bitcoin/commit/997b9a73e5166b4244f7c5b4fe144d524f3005f4\r\n\r\nWas just in the middle of reviewing this and figuring out how to add some balance checks. May file a followup.",
      "created_at" : "2024-01-11T16:31:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#issuecomment-1887533530",
      "id" : 1887533530,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28838",
      "node_id" : "IC_kwDOABII585wgXna",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1887533530/reactions"
      },
      "updated_at" : "2024-01-11T16:31:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1887533530",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "https://github.com/bitcoin/bitcoin/actions/runs/7491713362/job/20393561752?pr=29218#step:27:7881\r\n\r\n```\r\n                                   test_framework.authproxy.JSONRPCException: remove_all: The process cannot access the file because it is being used by another process.: \"D:\\a\\_temp\\test_runner_?_??_20240111_163825\\wallet_assumeutxo_47\\node1\\regtest\\w\" (-1)\r\n\r\n",
      "created_at" : "2024-01-11T16:58:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#issuecomment-1887580464",
      "id" : 1887580464,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28838",
      "node_id" : "IC_kwDOABII585wgjEw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1887580464/reactions"
      },
      "updated_at" : "2024-01-11T16:58:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1887580464",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1450778587"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450778587"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@jamesob I think you can just close the wallet after this call?",
      "commit_id" : "997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "created_at" : "2024-01-12T18:10:45Z",
      "diff_hunk" : "@@ -0,0 +1,164 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+## Possible test improvements\n+\n+- TODO: test import descriptors while background sync is in progress\n+- TODO: test loading a wallet (backup) on a pruned node\n+\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+START_HEIGHT = 199\n+SNAPSHOT_BASE_HEIGHT = 299\n+FINAL_HEIGHT = 399\n+\n+\n+class AssumeutxoTest(BitcoinTestFramework):\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        \"\"\"Use the pregenerated, deterministic chain up to height 199.\"\"\"\n+        self.num_nodes = 2\n+        self.rpc_timeout = 120\n+        self.extra_args = [\n+            [],\n+            [],\n+        ]\n+\n+    def setup_network(self):\n+        \"\"\"Start with the nodes disconnected so that one can generate a snapshot\n+        including blocks the other hasn't yet seen.\"\"\"\n+        self.add_nodes(2)\n+        self.start_nodes(extra_args=self.extra_args)\n+\n+    def run_test(self):\n+        \"\"\"\n+        Bring up two (disconnected) nodes, mine some new blocks on the first,\n+        and generate a UTXO snapshot.\n+\n+        Load the snapshot into the second, ensure it syncs to tip and completes\n+        background validation when connected to the first.\n+        \"\"\"\n+        n0 = self.nodes[0]\n+        n1 = self.nodes[1]\n+\n+        # Mock time for a deterministic chain\n+        for n in self.nodes:\n+            n.setmocktime(n.getblockheader(n.getbestblockhash())['time'])\n+\n+        self.sync_blocks()\n+\n+        n0.createwallet('w')\n+        w = n0.get_wallet_rpc(\"w\")\n+\n+        # Generate a series of blocks that `n0` will have in the snapshot,\n+        # but that n1 doesn't yet see. In order for the snapshot to activate,\n+        # though, we have to ferry over the new headers to n1 so that it\n+        # isn't waiting forever to see the header of the snapshot's base block\n+        # while disconnected from n0.\n+        for _ in range(100):\n+            self.generate(n0, nblocks=1, sync_fun=self.no_op)\n+            newblock = n0.getblock(n0.getbestblockhash(), 0)\n+\n+            # make n1 aware of the new header, but don't give it the block.\n+            n1.submitheader(newblock)\n+\n+        # Ensure everyone is seeing the same headers.\n+        for n in self.nodes:\n+            assert_equal(n.getblockchaininfo()[\n+                         \"headers\"], SNAPSHOT_BASE_HEIGHT)\n+\n+        w.backupwallet(\"backup_w.dat\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1450778587",
      "id" : 1450778587,
      "line" : 84,
      "node_id" : "PRRC_kwDOABII585WeR_b",
      "original_commit_id" : "997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "original_line" : 84,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : 84,
      "pull_request_review_id" : 1818793895,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450778587/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-12T18:10:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450778587",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1450784477"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450784477"
         }
      },
      "author_association" : "MEMBER",
      "body" : "From reading the test again (it's a been a while) I don't think we care about this loaded wallet `w` anymore.",
      "commit_id" : "997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "created_at" : "2024-01-12T18:16:13Z",
      "diff_hunk" : "@@ -0,0 +1,164 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+## Possible test improvements\n+\n+- TODO: test import descriptors while background sync is in progress\n+- TODO: test loading a wallet (backup) on a pruned node\n+\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+START_HEIGHT = 199\n+SNAPSHOT_BASE_HEIGHT = 299\n+FINAL_HEIGHT = 399\n+\n+\n+class AssumeutxoTest(BitcoinTestFramework):\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        \"\"\"Use the pregenerated, deterministic chain up to height 199.\"\"\"\n+        self.num_nodes = 2\n+        self.rpc_timeout = 120\n+        self.extra_args = [\n+            [],\n+            [],\n+        ]\n+\n+    def setup_network(self):\n+        \"\"\"Start with the nodes disconnected so that one can generate a snapshot\n+        including blocks the other hasn't yet seen.\"\"\"\n+        self.add_nodes(2)\n+        self.start_nodes(extra_args=self.extra_args)\n+\n+    def run_test(self):\n+        \"\"\"\n+        Bring up two (disconnected) nodes, mine some new blocks on the first,\n+        and generate a UTXO snapshot.\n+\n+        Load the snapshot into the second, ensure it syncs to tip and completes\n+        background validation when connected to the first.\n+        \"\"\"\n+        n0 = self.nodes[0]\n+        n1 = self.nodes[1]\n+\n+        # Mock time for a deterministic chain\n+        for n in self.nodes:\n+            n.setmocktime(n.getblockheader(n.getbestblockhash())['time'])\n+\n+        self.sync_blocks()\n+\n+        n0.createwallet('w')\n+        w = n0.get_wallet_rpc(\"w\")\n+\n+        # Generate a series of blocks that `n0` will have in the snapshot,\n+        # but that n1 doesn't yet see. In order for the snapshot to activate,\n+        # though, we have to ferry over the new headers to n1 so that it\n+        # isn't waiting forever to see the header of the snapshot's base block\n+        # while disconnected from n0.\n+        for _ in range(100):\n+            self.generate(n0, nblocks=1, sync_fun=self.no_op)\n+            newblock = n0.getblock(n0.getbestblockhash(), 0)\n+\n+            # make n1 aware of the new header, but don't give it the block.\n+            n1.submitheader(newblock)\n+\n+        # Ensure everyone is seeing the same headers.\n+        for n in self.nodes:\n+            assert_equal(n.getblockchaininfo()[\n+                         \"headers\"], SNAPSHOT_BASE_HEIGHT)\n+\n+        w.backupwallet(\"backup_w.dat\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1450784477",
      "id" : 1450784477,
      "in_reply_to_id" : 1450778587,
      "line" : 84,
      "node_id" : "PRRC_kwDOABII585WeTbd",
      "original_commit_id" : "997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "original_line" : 84,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : 84,
      "pull_request_review_id" : 1818803364,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450784477/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-12T18:16:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450784477",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1450785203"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450785203"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't think the problem is that the original wallet is open. The error is the path for the restored wallet on node1, not the original on node0.",
      "commit_id" : "997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "created_at" : "2024-01-12T18:16:51Z",
      "diff_hunk" : "@@ -0,0 +1,164 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+## Possible test improvements\n+\n+- TODO: test import descriptors while background sync is in progress\n+- TODO: test loading a wallet (backup) on a pruned node\n+\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+START_HEIGHT = 199\n+SNAPSHOT_BASE_HEIGHT = 299\n+FINAL_HEIGHT = 399\n+\n+\n+class AssumeutxoTest(BitcoinTestFramework):\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        \"\"\"Use the pregenerated, deterministic chain up to height 199.\"\"\"\n+        self.num_nodes = 2\n+        self.rpc_timeout = 120\n+        self.extra_args = [\n+            [],\n+            [],\n+        ]\n+\n+    def setup_network(self):\n+        \"\"\"Start with the nodes disconnected so that one can generate a snapshot\n+        including blocks the other hasn't yet seen.\"\"\"\n+        self.add_nodes(2)\n+        self.start_nodes(extra_args=self.extra_args)\n+\n+    def run_test(self):\n+        \"\"\"\n+        Bring up two (disconnected) nodes, mine some new blocks on the first,\n+        and generate a UTXO snapshot.\n+\n+        Load the snapshot into the second, ensure it syncs to tip and completes\n+        background validation when connected to the first.\n+        \"\"\"\n+        n0 = self.nodes[0]\n+        n1 = self.nodes[1]\n+\n+        # Mock time for a deterministic chain\n+        for n in self.nodes:\n+            n.setmocktime(n.getblockheader(n.getbestblockhash())['time'])\n+\n+        self.sync_blocks()\n+\n+        n0.createwallet('w')\n+        w = n0.get_wallet_rpc(\"w\")\n+\n+        # Generate a series of blocks that `n0` will have in the snapshot,\n+        # but that n1 doesn't yet see. In order for the snapshot to activate,\n+        # though, we have to ferry over the new headers to n1 so that it\n+        # isn't waiting forever to see the header of the snapshot's base block\n+        # while disconnected from n0.\n+        for _ in range(100):\n+            self.generate(n0, nblocks=1, sync_fun=self.no_op)\n+            newblock = n0.getblock(n0.getbestblockhash(), 0)\n+\n+            # make n1 aware of the new header, but don't give it the block.\n+            n1.submitheader(newblock)\n+\n+        # Ensure everyone is seeing the same headers.\n+        for n in self.nodes:\n+            assert_equal(n.getblockchaininfo()[\n+                         \"headers\"], SNAPSHOT_BASE_HEIGHT)\n+\n+        w.backupwallet(\"backup_w.dat\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1450785203",
      "id" : 1450785203,
      "in_reply_to_id" : 1450778587,
      "line" : 84,
      "node_id" : "PRRC_kwDOABII585WeTmz",
      "original_commit_id" : "997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "original_line" : 84,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : 84,
      "pull_request_review_id" : 1818804670,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450785203/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-12T18:16:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450785203",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1450789885"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450789885"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I see (just saw the log in #29234).\r\n\r\nSounds like the node that made the backup holds on to it after writing? Maybe restart the node (`n0`)? Or copy the backup file? ",
      "commit_id" : "997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "created_at" : "2024-01-12T18:22:24Z",
      "diff_hunk" : "@@ -0,0 +1,164 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+## Possible test improvements\n+\n+- TODO: test import descriptors while background sync is in progress\n+- TODO: test loading a wallet (backup) on a pruned node\n+\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+START_HEIGHT = 199\n+SNAPSHOT_BASE_HEIGHT = 299\n+FINAL_HEIGHT = 399\n+\n+\n+class AssumeutxoTest(BitcoinTestFramework):\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        \"\"\"Use the pregenerated, deterministic chain up to height 199.\"\"\"\n+        self.num_nodes = 2\n+        self.rpc_timeout = 120\n+        self.extra_args = [\n+            [],\n+            [],\n+        ]\n+\n+    def setup_network(self):\n+        \"\"\"Start with the nodes disconnected so that one can generate a snapshot\n+        including blocks the other hasn't yet seen.\"\"\"\n+        self.add_nodes(2)\n+        self.start_nodes(extra_args=self.extra_args)\n+\n+    def run_test(self):\n+        \"\"\"\n+        Bring up two (disconnected) nodes, mine some new blocks on the first,\n+        and generate a UTXO snapshot.\n+\n+        Load the snapshot into the second, ensure it syncs to tip and completes\n+        background validation when connected to the first.\n+        \"\"\"\n+        n0 = self.nodes[0]\n+        n1 = self.nodes[1]\n+\n+        # Mock time for a deterministic chain\n+        for n in self.nodes:\n+            n.setmocktime(n.getblockheader(n.getbestblockhash())['time'])\n+\n+        self.sync_blocks()\n+\n+        n0.createwallet('w')\n+        w = n0.get_wallet_rpc(\"w\")\n+\n+        # Generate a series of blocks that `n0` will have in the snapshot,\n+        # but that n1 doesn't yet see. In order for the snapshot to activate,\n+        # though, we have to ferry over the new headers to n1 so that it\n+        # isn't waiting forever to see the header of the snapshot's base block\n+        # while disconnected from n0.\n+        for _ in range(100):\n+            self.generate(n0, nblocks=1, sync_fun=self.no_op)\n+            newblock = n0.getblock(n0.getbestblockhash(), 0)\n+\n+            # make n1 aware of the new header, but don't give it the block.\n+            n1.submitheader(newblock)\n+\n+        # Ensure everyone is seeing the same headers.\n+        for n in self.nodes:\n+            assert_equal(n.getblockchaininfo()[\n+                         \"headers\"], SNAPSHOT_BASE_HEIGHT)\n+\n+        w.backupwallet(\"backup_w.dat\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1450789885",
      "id" : 1450789885,
      "in_reply_to_id" : 1450778587,
      "line" : 84,
      "node_id" : "PRRC_kwDOABII585WeUv9",
      "original_commit_id" : "997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "original_line" : 84,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : 84,
      "pull_request_review_id" : 1818812135,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450789885/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-12T18:24:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450789885",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1450792644"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450792644"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Sounds like the node that made the backup holds on to it after writing? Maybe restart the node? Or copy the backup file?\r\n\r\nWe don't remove the backup. The failure is in cleaning up the restored wallet after it fails to restore. The backup file is copied to a new path, and that is what `remove_all` is trying to remove.\r\n\r\nI think it's more likely that the database isn't fully closed yet even though the `CWallet` should be destructed.",
      "commit_id" : "997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "created_at" : "2024-01-12T18:25:50Z",
      "diff_hunk" : "@@ -0,0 +1,164 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+## Possible test improvements\n+\n+- TODO: test import descriptors while background sync is in progress\n+- TODO: test loading a wallet (backup) on a pruned node\n+\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+START_HEIGHT = 199\n+SNAPSHOT_BASE_HEIGHT = 299\n+FINAL_HEIGHT = 399\n+\n+\n+class AssumeutxoTest(BitcoinTestFramework):\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        \"\"\"Use the pregenerated, deterministic chain up to height 199.\"\"\"\n+        self.num_nodes = 2\n+        self.rpc_timeout = 120\n+        self.extra_args = [\n+            [],\n+            [],\n+        ]\n+\n+    def setup_network(self):\n+        \"\"\"Start with the nodes disconnected so that one can generate a snapshot\n+        including blocks the other hasn't yet seen.\"\"\"\n+        self.add_nodes(2)\n+        self.start_nodes(extra_args=self.extra_args)\n+\n+    def run_test(self):\n+        \"\"\"\n+        Bring up two (disconnected) nodes, mine some new blocks on the first,\n+        and generate a UTXO snapshot.\n+\n+        Load the snapshot into the second, ensure it syncs to tip and completes\n+        background validation when connected to the first.\n+        \"\"\"\n+        n0 = self.nodes[0]\n+        n1 = self.nodes[1]\n+\n+        # Mock time for a deterministic chain\n+        for n in self.nodes:\n+            n.setmocktime(n.getblockheader(n.getbestblockhash())['time'])\n+\n+        self.sync_blocks()\n+\n+        n0.createwallet('w')\n+        w = n0.get_wallet_rpc(\"w\")\n+\n+        # Generate a series of blocks that `n0` will have in the snapshot,\n+        # but that n1 doesn't yet see. In order for the snapshot to activate,\n+        # though, we have to ferry over the new headers to n1 so that it\n+        # isn't waiting forever to see the header of the snapshot's base block\n+        # while disconnected from n0.\n+        for _ in range(100):\n+            self.generate(n0, nblocks=1, sync_fun=self.no_op)\n+            newblock = n0.getblock(n0.getbestblockhash(), 0)\n+\n+            # make n1 aware of the new header, but don't give it the block.\n+            n1.submitheader(newblock)\n+\n+        # Ensure everyone is seeing the same headers.\n+        for n in self.nodes:\n+            assert_equal(n.getblockchaininfo()[\n+                         \"headers\"], SNAPSHOT_BASE_HEIGHT)\n+\n+        w.backupwallet(\"backup_w.dat\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1450792644",
      "id" : 1450792644,
      "in_reply_to_id" : 1450778587,
      "line" : 84,
      "node_id" : "PRRC_kwDOABII585WeVbE",
      "original_commit_id" : "997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "original_line" : 84,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : 84,
      "pull_request_review_id" : 1818816576,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450792644/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-12T18:25:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450792644",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1450796060"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450796060"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ok, so it has nothing to do with what n0 did. I'm surprised none of the other wallet backup & restore tests have this issue. But I guess it's a different failure condition.",
      "commit_id" : "997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "created_at" : "2024-01-12T18:30:05Z",
      "diff_hunk" : "@@ -0,0 +1,164 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+## Possible test improvements\n+\n+- TODO: test import descriptors while background sync is in progress\n+- TODO: test loading a wallet (backup) on a pruned node\n+\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+START_HEIGHT = 199\n+SNAPSHOT_BASE_HEIGHT = 299\n+FINAL_HEIGHT = 399\n+\n+\n+class AssumeutxoTest(BitcoinTestFramework):\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        \"\"\"Use the pregenerated, deterministic chain up to height 199.\"\"\"\n+        self.num_nodes = 2\n+        self.rpc_timeout = 120\n+        self.extra_args = [\n+            [],\n+            [],\n+        ]\n+\n+    def setup_network(self):\n+        \"\"\"Start with the nodes disconnected so that one can generate a snapshot\n+        including blocks the other hasn't yet seen.\"\"\"\n+        self.add_nodes(2)\n+        self.start_nodes(extra_args=self.extra_args)\n+\n+    def run_test(self):\n+        \"\"\"\n+        Bring up two (disconnected) nodes, mine some new blocks on the first,\n+        and generate a UTXO snapshot.\n+\n+        Load the snapshot into the second, ensure it syncs to tip and completes\n+        background validation when connected to the first.\n+        \"\"\"\n+        n0 = self.nodes[0]\n+        n1 = self.nodes[1]\n+\n+        # Mock time for a deterministic chain\n+        for n in self.nodes:\n+            n.setmocktime(n.getblockheader(n.getbestblockhash())['time'])\n+\n+        self.sync_blocks()\n+\n+        n0.createwallet('w')\n+        w = n0.get_wallet_rpc(\"w\")\n+\n+        # Generate a series of blocks that `n0` will have in the snapshot,\n+        # but that n1 doesn't yet see. In order for the snapshot to activate,\n+        # though, we have to ferry over the new headers to n1 so that it\n+        # isn't waiting forever to see the header of the snapshot's base block\n+        # while disconnected from n0.\n+        for _ in range(100):\n+            self.generate(n0, nblocks=1, sync_fun=self.no_op)\n+            newblock = n0.getblock(n0.getbestblockhash(), 0)\n+\n+            # make n1 aware of the new header, but don't give it the block.\n+            n1.submitheader(newblock)\n+\n+        # Ensure everyone is seeing the same headers.\n+        for n in self.nodes:\n+            assert_equal(n.getblockchaininfo()[\n+                         \"headers\"], SNAPSHOT_BASE_HEIGHT)\n+\n+        w.backupwallet(\"backup_w.dat\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1450796060",
      "id" : 1450796060,
      "in_reply_to_id" : 1450778587,
      "line" : 84,
      "node_id" : "PRRC_kwDOABII585WeWQc",
      "original_commit_id" : "997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "original_line" : 84,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : 84,
      "pull_request_review_id" : 1818822123,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450796060/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-12T18:30:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450796060",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1450797858"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450797858"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It looks like we don't have any other tests that have a failure in `CWallet::Create`, which I don't think is that surprising since generally the wallet needs to be corrupted for that to happen.",
      "commit_id" : "997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "created_at" : "2024-01-12T18:32:18Z",
      "diff_hunk" : "@@ -0,0 +1,164 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+## Possible test improvements\n+\n+- TODO: test import descriptors while background sync is in progress\n+- TODO: test loading a wallet (backup) on a pruned node\n+\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+START_HEIGHT = 199\n+SNAPSHOT_BASE_HEIGHT = 299\n+FINAL_HEIGHT = 399\n+\n+\n+class AssumeutxoTest(BitcoinTestFramework):\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        \"\"\"Use the pregenerated, deterministic chain up to height 199.\"\"\"\n+        self.num_nodes = 2\n+        self.rpc_timeout = 120\n+        self.extra_args = [\n+            [],\n+            [],\n+        ]\n+\n+    def setup_network(self):\n+        \"\"\"Start with the nodes disconnected so that one can generate a snapshot\n+        including blocks the other hasn't yet seen.\"\"\"\n+        self.add_nodes(2)\n+        self.start_nodes(extra_args=self.extra_args)\n+\n+    def run_test(self):\n+        \"\"\"\n+        Bring up two (disconnected) nodes, mine some new blocks on the first,\n+        and generate a UTXO snapshot.\n+\n+        Load the snapshot into the second, ensure it syncs to tip and completes\n+        background validation when connected to the first.\n+        \"\"\"\n+        n0 = self.nodes[0]\n+        n1 = self.nodes[1]\n+\n+        # Mock time for a deterministic chain\n+        for n in self.nodes:\n+            n.setmocktime(n.getblockheader(n.getbestblockhash())['time'])\n+\n+        self.sync_blocks()\n+\n+        n0.createwallet('w')\n+        w = n0.get_wallet_rpc(\"w\")\n+\n+        # Generate a series of blocks that `n0` will have in the snapshot,\n+        # but that n1 doesn't yet see. In order for the snapshot to activate,\n+        # though, we have to ferry over the new headers to n1 so that it\n+        # isn't waiting forever to see the header of the snapshot's base block\n+        # while disconnected from n0.\n+        for _ in range(100):\n+            self.generate(n0, nblocks=1, sync_fun=self.no_op)\n+            newblock = n0.getblock(n0.getbestblockhash(), 0)\n+\n+            # make n1 aware of the new header, but don't give it the block.\n+            n1.submitheader(newblock)\n+\n+        # Ensure everyone is seeing the same headers.\n+        for n in self.nodes:\n+            assert_equal(n.getblockchaininfo()[\n+                         \"headers\"], SNAPSHOT_BASE_HEIGHT)\n+\n+        w.backupwallet(\"backup_w.dat\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1450797858",
      "id" : 1450797858,
      "in_reply_to_id" : 1450778587,
      "line" : 84,
      "node_id" : "PRRC_kwDOABII585WeWsi",
      "original_commit_id" : "997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "original_line" : 84,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : 84,
      "pull_request_review_id" : 1818824937,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450797858/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-12T18:32:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450797858",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1450807950"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450807950"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> I think it's more likely that the database isn't fully closed yet even though the `CWallet` should be destructed.\r\n\r\nMaybe it's because of `-unsafesqlitesync`, going to try turning that off for the test.",
      "commit_id" : "997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "created_at" : "2024-01-12T18:45:15Z",
      "diff_hunk" : "@@ -0,0 +1,164 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+## Possible test improvements\n+\n+- TODO: test import descriptors while background sync is in progress\n+- TODO: test loading a wallet (backup) on a pruned node\n+\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+START_HEIGHT = 199\n+SNAPSHOT_BASE_HEIGHT = 299\n+FINAL_HEIGHT = 399\n+\n+\n+class AssumeutxoTest(BitcoinTestFramework):\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        \"\"\"Use the pregenerated, deterministic chain up to height 199.\"\"\"\n+        self.num_nodes = 2\n+        self.rpc_timeout = 120\n+        self.extra_args = [\n+            [],\n+            [],\n+        ]\n+\n+    def setup_network(self):\n+        \"\"\"Start with the nodes disconnected so that one can generate a snapshot\n+        including blocks the other hasn't yet seen.\"\"\"\n+        self.add_nodes(2)\n+        self.start_nodes(extra_args=self.extra_args)\n+\n+    def run_test(self):\n+        \"\"\"\n+        Bring up two (disconnected) nodes, mine some new blocks on the first,\n+        and generate a UTXO snapshot.\n+\n+        Load the snapshot into the second, ensure it syncs to tip and completes\n+        background validation when connected to the first.\n+        \"\"\"\n+        n0 = self.nodes[0]\n+        n1 = self.nodes[1]\n+\n+        # Mock time for a deterministic chain\n+        for n in self.nodes:\n+            n.setmocktime(n.getblockheader(n.getbestblockhash())['time'])\n+\n+        self.sync_blocks()\n+\n+        n0.createwallet('w')\n+        w = n0.get_wallet_rpc(\"w\")\n+\n+        # Generate a series of blocks that `n0` will have in the snapshot,\n+        # but that n1 doesn't yet see. In order for the snapshot to activate,\n+        # though, we have to ferry over the new headers to n1 so that it\n+        # isn't waiting forever to see the header of the snapshot's base block\n+        # while disconnected from n0.\n+        for _ in range(100):\n+            self.generate(n0, nblocks=1, sync_fun=self.no_op)\n+            newblock = n0.getblock(n0.getbestblockhash(), 0)\n+\n+            # make n1 aware of the new header, but don't give it the block.\n+            n1.submitheader(newblock)\n+\n+        # Ensure everyone is seeing the same headers.\n+        for n in self.nodes:\n+            assert_equal(n.getblockchaininfo()[\n+                         \"headers\"], SNAPSHOT_BASE_HEIGHT)\n+\n+        w.backupwallet(\"backup_w.dat\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1450807950",
      "id" : 1450807950,
      "in_reply_to_id" : 1450778587,
      "line" : 84,
      "node_id" : "PRRC_kwDOABII585WeZKO",
      "original_commit_id" : "997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "original_line" : 84,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : 84,
      "pull_request_review_id" : 1818841542,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450807950/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-12T18:45:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450807950",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1450812828"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450812828"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I wonder why it's called unsafe :-)",
      "commit_id" : "997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "created_at" : "2024-01-12T18:51:35Z",
      "diff_hunk" : "@@ -0,0 +1,164 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2023-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test for assumeutxo wallet related behavior.\n+See feature_assumeutxo.py for background.\n+\n+## Possible test improvements\n+\n+- TODO: test import descriptors while background sync is in progress\n+- TODO: test loading a wallet (backup) on a pruned node\n+\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+START_HEIGHT = 199\n+SNAPSHOT_BASE_HEIGHT = 299\n+FINAL_HEIGHT = 399\n+\n+\n+class AssumeutxoTest(BitcoinTestFramework):\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        \"\"\"Use the pregenerated, deterministic chain up to height 199.\"\"\"\n+        self.num_nodes = 2\n+        self.rpc_timeout = 120\n+        self.extra_args = [\n+            [],\n+            [],\n+        ]\n+\n+    def setup_network(self):\n+        \"\"\"Start with the nodes disconnected so that one can generate a snapshot\n+        including blocks the other hasn't yet seen.\"\"\"\n+        self.add_nodes(2)\n+        self.start_nodes(extra_args=self.extra_args)\n+\n+    def run_test(self):\n+        \"\"\"\n+        Bring up two (disconnected) nodes, mine some new blocks on the first,\n+        and generate a UTXO snapshot.\n+\n+        Load the snapshot into the second, ensure it syncs to tip and completes\n+        background validation when connected to the first.\n+        \"\"\"\n+        n0 = self.nodes[0]\n+        n1 = self.nodes[1]\n+\n+        # Mock time for a deterministic chain\n+        for n in self.nodes:\n+            n.setmocktime(n.getblockheader(n.getbestblockhash())['time'])\n+\n+        self.sync_blocks()\n+\n+        n0.createwallet('w')\n+        w = n0.get_wallet_rpc(\"w\")\n+\n+        # Generate a series of blocks that `n0` will have in the snapshot,\n+        # but that n1 doesn't yet see. In order for the snapshot to activate,\n+        # though, we have to ferry over the new headers to n1 so that it\n+        # isn't waiting forever to see the header of the snapshot's base block\n+        # while disconnected from n0.\n+        for _ in range(100):\n+            self.generate(n0, nblocks=1, sync_fun=self.no_op)\n+            newblock = n0.getblock(n0.getbestblockhash(), 0)\n+\n+            # make n1 aware of the new header, but don't give it the block.\n+            n1.submitheader(newblock)\n+\n+        # Ensure everyone is seeing the same headers.\n+        for n in self.nodes:\n+            assert_equal(n.getblockchaininfo()[\n+                         \"headers\"], SNAPSHOT_BASE_HEIGHT)\n+\n+        w.backupwallet(\"backup_w.dat\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28838#discussion_r1450812828",
      "id" : 1450812828,
      "in_reply_to_id" : 1450778587,
      "line" : 84,
      "node_id" : "PRRC_kwDOABII585WeaWc",
      "original_commit_id" : "997b9a73e5166b4244f7c5b4fe144d524f3005f4",
      "original_line" : 84,
      "original_position" : 84,
      "original_start_line" : null,
      "path" : "test/functional/wallet_assumeutxo.py",
      "position" : 84,
      "pull_request_review_id" : 1818849464,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28838",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450812828/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-12T18:51:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450812828",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   }
]
