[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/28878).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [theuni](https://github.com/bitcoin/bitcoin/pull/28878#issuecomment-1812867807) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n",
      "created_at" : "2023-11-15T02:41:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28878#issuecomment-1811719586",
      "id" : 1811719586,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28878",
      "node_id" : "IC_kwDOABII585r_KWi",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1811719586/reactions"
      },
      "updated_at" : "2023-11-15T16:31:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1811719586",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-11-15T02:55:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28878#issuecomment-1811729882",
      "id" : 1811729882,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28878",
      "node_id" : "IC_kwDOABII585r_M3a",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1811729882/reactions"
      },
      "updated_at" : "2023-11-15T02:55:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1811729882",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.\r\n\r\nIs this next after #28438? Or something else first?",
      "created_at" : "2023-11-15T16:31:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28878#issuecomment-1812867807",
      "id" : 1812867807,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28878",
      "node_id" : "IC_kwDOABII585sDirf",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 1,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1812867807/reactions"
      },
      "updated_at" : "2023-11-15T16:31:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1812867807",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Playing around locally, I was also able to drop the include in:\r\n```bash\r\n$ git diff --stat\r\n src/bitcoin-util.cpp            | 1 -\r\n src/coins.cpp                   | 1 -\r\n src/core_read.cpp               | 1 -\r\n src/kernel/coinstats.cpp        | 1 -\r\n src/rest.cpp                    | 1 -\r\n src/script/bitcoinconsensus.cpp | 1 -\r\n src/zmq/zmqpublishnotifier.cpp  | 1 -\r\n```\r\n\r\n(I didn't mess with the tests, maybe could drop some there too).\r\n\r\nAlso worth pointing out: libbitcoinkernel now only requires `version.h` for `signet.cpp`, which I assume will go away in one of these follow-ups.\r\n\r\nEdit: Not that the header dependency matters at all for libbitcoinkernel. It's just indicative imo that we're moving the right direction if it ends up un-tethered.",
      "created_at" : "2023-11-15T18:19:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28878#issuecomment-1813031718",
      "id" : 1813031718,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28878",
      "node_id" : "IC_kwDOABII585sEKsm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 1,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 2,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1813031718/reactions"
      },
      "updated_at" : "2023-11-15T21:28:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1813031718",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased after #28438 was merged.\r\n\r\n> Is this next after #28438? Or something else first?\r\n\r\nEither this or #28451 seem good to go; I think they conflict due to the \"Convert some CDataStream..\" commit here though; shouldn't be a hard rebase in either case though, I think.\r\n\r\n> Playing around locally, I was also able to drop the include in:\r\n\r\nTaken.\r\n\r\n> Also worth pointing out: libbitcoinkernel now only requires `version.h` for `signet.cpp`, which I assume will go away in one of these follow-ups.\r\n\r\nThat just needs `SpanReader` and `CVectorWriter` to be updated to not need a version.",
      "created_at" : "2023-11-16T01:48:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28878#issuecomment-1813628680",
      "id" : 1813628680,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28878",
      "node_id" : "IC_kwDOABII585sGccI",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1813628680/reactions"
      },
      "updated_at" : "2023-11-16T01:48:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1813628680",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28878#discussion_r1395782019"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28878"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1395782019"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit in efa9eb6d7c8012fe4ed85699d81c8fe5dd18da1e: `inline` is implied by `template` and can be removed.",
      "commit_id" : "83986f464c59a6517f790a960a72574e167f3f72",
      "created_at" : "2023-11-16T14:30:03Z",
      "diff_hunk" : "@@ -450,7 +450,7 @@ inline unsigned int GetSizeOfVarInt(I n)\n }\n \n template<typename I>\n-inline void WriteVarInt(CSizeComputer& os, I n);\n+inline void WriteVarInt(SizeComputer& os, I n);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28878#discussion_r1395782019",
      "id" : 1395782019,
      "line" : 453,
      "node_id" : "PRRC_kwDOABII585TMfGD",
      "original_commit_id" : "efa9eb6d7c8012fe4ed85699d81c8fe5dd18da1e",
      "original_line" : 453,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 23,
      "pull_request_review_id" : 1734526484,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28878",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1395782019/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-16T15:09:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1395782019",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28878#discussion_r1395784487"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28878"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1395784487"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why remove the `explicit`? Shouldn't matter in this context, but when in doubt, I'd prefer to keep it, unless there is a reason to remove it?",
      "commit_id" : "83986f464c59a6517f790a960a72574e167f3f72",
      "created_at" : "2023-11-16T14:31:52Z",
      "diff_hunk" : "@@ -1070,22 +1070,21 @@ struct ActionUnserialize {\n /* ::GetSerializeSize implementations\n  *\n  * Computing the serialized size of objects is done through a special stream\n- * object of type CSizeComputer, which only records the number of bytes written\n+ * object of type SizeComputer, which only records the number of bytes written\n  * to it.\n  *\n  * If your Serialize or SerializationOp method has non-trivial overhead for\n  * serialization, it may be worthwhile to implement a specialized version for\n- * CSizeComputer, which uses the s.seek() method to record bytes that would\n+ * SizeComputer, which uses the s.seek() method to record bytes that would\n  * be written instead.\n  */\n-class CSizeComputer\n+class SizeComputer\n {\n protected:\n     size_t nSize{0};\n \n-    const int nVersion;\n public:\n-    explicit CSizeComputer(int nVersionIn) : nVersion(nVersionIn) {}\n+    SizeComputer() {}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28878#discussion_r1395784487",
      "id" : 1395784487,
      "line" : 1087,
      "node_id" : "PRRC_kwDOABII585TMfsn",
      "original_commit_id" : "efa9eb6d7c8012fe4ed85699d81c8fe5dd18da1e",
      "original_line" : 1087,
      "original_position" : 50,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 50,
      "pull_request_review_id" : 1734526484,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28878",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1395784487/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-16T15:09:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1395784487",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28878#discussion_r1395786545"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28878"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1395786545"
         }
      },
      "author_association" : "MEMBER",
      "body" : "unrelated nit in the first commit: Can remove the `()`, which achieve nothing in this context.",
      "commit_id" : "83986f464c59a6517f790a960a72574e167f3f72",
      "created_at" : "2023-11-16T14:33:22Z",
      "diff_hunk" : "@@ -1099,7 +1098,7 @@ class CSizeComputer\n     }\n \n     template<typename T>\n-    CSizeComputer& operator<<(const T& obj)\n+    SizeComputer& operator<<(const T& obj)\n     {\n         ::Serialize(*this, obj);\n         return (*this);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28878#discussion_r1395786545",
      "id" : 1395786545,
      "line" : 1104,
      "node_id" : "PRRC_kwDOABII585TMgMx",
      "original_commit_id" : "efa9eb6d7c8012fe4ed85699d81c8fe5dd18da1e",
      "original_line" : 1104,
      "original_position" : 62,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 62,
      "pull_request_review_id" : 1734526484,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28878",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1395786545/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-16T15:09:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1395786545",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28878#discussion_r1395789229"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28878"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1395789229"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Same (`inline`)",
      "commit_id" : "83986f464c59a6517f790a960a72574e167f3f72",
      "created_at" : "2023-11-16T14:34:38Z",
      "diff_hunk" : "@@ -1108,31 +1107,29 @@ class CSizeComputer\n     size_t size() const {\n         return nSize;\n     }\n-\n-    int GetVersion() const { return nVersion; }\n };\n \n template<typename I>\n-inline void WriteVarInt(CSizeComputer &s, I n)\n+inline void WriteVarInt(SizeComputer &s, I n)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28878#discussion_r1395789229",
      "id" : 1395789229,
      "line" : 1113,
      "node_id" : "PRRC_kwDOABII585TMg2t",
      "original_commit_id" : "efa9eb6d7c8012fe4ed85699d81c8fe5dd18da1e",
      "original_line" : 1113,
      "original_position" : 73,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 73,
      "pull_request_review_id" : 1734526484,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28878",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1395789229/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-16T15:09:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1395789229",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28878#discussion_r1396049970"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28878"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1396049970"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Unrelated to this PR, but I think we could make this much more efficient by adding a serializer override that keeps a running tally of serialized size? That way size is calculated as a side-effect of the actual serialization and prepended to the stream, rather than running all the way through twice.\r\n\r\nNo idea if this path is hot enough to bother messing with that.\r\n",
      "commit_id" : "83986f464c59a6517f790a960a72574e167f3f72",
      "created_at" : "2023-11-16T16:57:49Z",
      "diff_hunk" : "@@ -89,7 +89,9 @@ struct PSBTProprietary\n template<typename Stream, typename... X>\n void SerializeToVector(Stream& s, const X&... args)\n {\n-    WriteCompactSize(s, GetSerializeSizeMany(s.GetVersion(), args...));\n+    SizeComputer sizecomp;\n+    SerializeMany(sizecomp, args...);\n+    WriteCompactSize(s, sizecomp.size());\n     SerializeMany(s, args...);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28878#discussion_r1396049970",
      "id" : 1396049970,
      "line" : 95,
      "node_id" : "PRRC_kwDOABII585TNggy",
      "original_commit_id" : "bf574a75016123309b894da895ab1c7a81731933",
      "original_line" : 95,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/psbt.h",
      "position" : 8,
      "pull_request_review_id" : 1734964223,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28878",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1396049970/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-16T17:12:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1396049970",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28878#discussion_r1396618046"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28878"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1396618046"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "A running tally doesn't help -- we need to write the size of the serialized data before we serialize it, so this would mean caching the serialization until we've finished first which would likely be a bigger waste of memory than running things through the size computation first is a waste of cpu. (I've looked at this at least twice with exactly the same idea already :smile:)",
      "commit_id" : "83986f464c59a6517f790a960a72574e167f3f72",
      "created_at" : "2023-11-17T02:29:30Z",
      "diff_hunk" : "@@ -89,7 +89,9 @@ struct PSBTProprietary\n template<typename Stream, typename... X>\n void SerializeToVector(Stream& s, const X&... args)\n {\n-    WriteCompactSize(s, GetSerializeSizeMany(s.GetVersion(), args...));\n+    SizeComputer sizecomp;\n+    SerializeMany(sizecomp, args...);\n+    WriteCompactSize(s, sizecomp.size());\n     SerializeMany(s, args...);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28878#discussion_r1396618046",
      "id" : 1396618046,
      "in_reply_to_id" : 1396049970,
      "line" : 95,
      "node_id" : "PRRC_kwDOABII585TPrM-",
      "original_commit_id" : "bf574a75016123309b894da895ab1c7a81731933",
      "original_line" : 95,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/psbt.h",
      "position" : 8,
      "pull_request_review_id" : 1735916762,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28878",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1396618046/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-17T02:29:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1396618046",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28878#discussion_r1396620277"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28878"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1396620277"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`explicit` is good for constructors that take a single argument to prevent accidental conversion, but seems useless for constructors that don't take an argument. (The real question is why leave a constructor there at all?)",
      "commit_id" : "83986f464c59a6517f790a960a72574e167f3f72",
      "created_at" : "2023-11-17T02:32:48Z",
      "diff_hunk" : "@@ -1070,22 +1070,21 @@ struct ActionUnserialize {\n /* ::GetSerializeSize implementations\n  *\n  * Computing the serialized size of objects is done through a special stream\n- * object of type CSizeComputer, which only records the number of bytes written\n+ * object of type SizeComputer, which only records the number of bytes written\n  * to it.\n  *\n  * If your Serialize or SerializationOp method has non-trivial overhead for\n  * serialization, it may be worthwhile to implement a specialized version for\n- * CSizeComputer, which uses the s.seek() method to record bytes that would\n+ * SizeComputer, which uses the s.seek() method to record bytes that would\n  * be written instead.\n  */\n-class CSizeComputer\n+class SizeComputer\n {\n protected:\n     size_t nSize{0};\n \n-    const int nVersion;\n public:\n-    explicit CSizeComputer(int nVersionIn) : nVersion(nVersionIn) {}\n+    SizeComputer() {}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28878#discussion_r1396620277",
      "id" : 1396620277,
      "in_reply_to_id" : 1395784487,
      "line" : 1087,
      "node_id" : "PRRC_kwDOABII585TPrv1",
      "original_commit_id" : "efa9eb6d7c8012fe4ed85699d81c8fe5dd18da1e",
      "original_line" : 1087,
      "original_position" : 50,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 50,
      "pull_request_review_id" : 1735920058,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28878",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1396620277/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-17T02:32:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1396620277",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28878#discussion_r1396620430"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28878"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1396620430"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "(leaving the nits for if it's otherwise necessary to retouch)",
      "commit_id" : "83986f464c59a6517f790a960a72574e167f3f72",
      "created_at" : "2023-11-17T02:33:06Z",
      "diff_hunk" : "@@ -450,7 +450,7 @@ inline unsigned int GetSizeOfVarInt(I n)\n }\n \n template<typename I>\n-inline void WriteVarInt(CSizeComputer& os, I n);\n+inline void WriteVarInt(SizeComputer& os, I n);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28878#discussion_r1396620430",
      "id" : 1396620430,
      "in_reply_to_id" : 1395782019,
      "line" : 453,
      "node_id" : "PRRC_kwDOABII585TPryO",
      "original_commit_id" : "efa9eb6d7c8012fe4ed85699d81c8fe5dd18da1e",
      "original_line" : 453,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 23,
      "pull_request_review_id" : 1735920256,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28878",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1396620430/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-17T02:33:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1396620430",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   }
]
