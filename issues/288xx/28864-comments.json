[
   {
      "author_association" : "MEMBER",
      "body" : "Note that this ultimately results in compile failure, but because we try and compile the `sha256_x86_shani.cpp` code, but fail because it `\"needs isa option -msse4.1\"`:\r\n```bash\r\nIn file included from /usr/lib/gcc/x86_64-linux-gnu/13/include/immintrin.h:39,\r\n                 from crypto/sha256_x86_shani.cpp:12:\r\nIn function 'void {anonymous}::Shuffle(__m128i&, __m128i&)',\r\n    inlined from 'void sha256_x86_shani::Transform(uint32_t*, const unsigned char*, size_t)' at crypto/sha256_x86_shani.cpp:87:12:\r\ncrypto/sha256_x86_shani.cpp:57:10: error: '__builtin_ia32_pblendw128' needs isa option -msse4.1\r\n   57 |     s1 = _mm_blend_epi16(t2, t1, 0xF0);\r\n      |          ^~~~~~~~~~~~~~~\r\nIn function 'void {anonymous}::Unshuffle(__m128i&, __m128i&)',\r\n    inlined from 'void sha256_x86_shani::Transform(uint32_t*, const unsigned char*, size_t)' at crypto/sha256_x86_shani.cpp:138:14:\r\ncrypto/sha256_x86_shani.cpp:64:10: error: '__builtin_ia32_pblendw128' needs isa option -msse4.1\r\n   64 |     s0 = _mm_blend_epi16(t1, t2, 0xF0);\r\n      |          ^~~~~~~~~~~~~~~\r\nIn function 'void {anonymous}::Unshuffle(__m128i&, __m128i&)',\r\n    inlined from 'void sha256d64_x86_shani::Transform_2way(unsigned char*, const unsigned char*)' at crypto/sha256_x86_shani.cpp:270:14:\r\ncrypto/sha256_x86_shani.cpp:64:10: error: '__builtin_ia32_pblendw128' needs isa option -msse4.1\r\n   64 |     s0 = _mm_blend_epi16(t1, t2, 0xF0);\r\n      |          ^~~~~~~~~~~~~~~\r\nIn function 'void {anonymous}::Unshuffle(__m128i&, __m128i&)',\r\n    inlined from 'void sha256d64_x86_shani::Transform_2way(unsigned char*, const unsigned char*)' at crypto/sha256_x86_shani.cpp:271:14:\r\ncrypto/sha256_x86_shani.cpp:64:10: error: '__builtin_ia32_pblendw128' needs isa option -msse4.1\r\n   64 |     s0 = _mm_blend_epi16(t1, t2, 0xF0);\r\n      |          ^~~~~~~~~~~~~~~\r\nIn function 'void {anonymous}::Unshuffle(__m128i&, __m128i&)',\r\n    inlined from 'void sha256d64_x86_shani::Transform_2way(unsigned char*, const unsigned char*)' at crypto/sha256_x86_shani.cpp:348:14:\r\ncrypto/sha256_x86_shani.cpp:64:10: error: '__builtin_ia32_pblendw128' needs isa option -msse4.1\r\n   64 |     s0 = _mm_blend_epi16(t1, t2, 0xF0);\r\n      |          ^~~~~~~~~~~~~~~\r\nIn function 'void {anonymous}::Unshuffle(__m128i&, __m128i&)',\r\n    inlined from 'void sha256d64_x86_shani::Transform_2way(unsigned char*, const unsigned char*)' at crypto/sha256_x86_shani.cpp:349:14:\r\ncrypto/sha256_x86_shani.cpp:64:10: error: '__builtin_ia32_pblendw128' needs isa option -msse4.1\r\n   64 |     s0 = _mm_blend_epi16(t1, t2, 0xF0);\r\n      |          ^~~~~~~~~~~~~~~\r\nmake[2]: *** [Makefile:14527: crypto/libbitcoin_crypto_x86_shani_la-sha256_x86_shani.lo] Error 1\r\n```\r\nand also because we then try and compile the sse4.1 code anyways:\r\n```bash\r\nIn file included from /usr/lib/gcc/x86_64-linux-gnu/13/include/immintrin.h:37,\r\n                 from crypto/sha256_sse41.cpp:8:\r\n/usr/lib/gcc/x86_64-linux-gnu/13/include/tmmintrin.h: In function '__m128i sha256d64_sse41::{anonymous}::Read4(const unsigned char*, int)':\r\n/usr/lib/gcc/x86_64-linux-gnu/13/include/tmmintrin.h:136:1: error: inlining failed in call to 'always_inline' '__m128i _mm_shuffle_epi8(__m128i, __m128i)': target specific option mismatch\r\n  136 | _mm_shuffle_epi8 (__m128i __X, __m128i __Y)\r\n      | ^~~~~~~~~~~~~~~~\r\ncrypto/sha256_sse41.cpp:55:28: note: called from here\r\n   55 |     return _mm_shuffle_epi8(ret, _mm_set_epi32(0x0C0D0E0FUL, 0x08090A0BUL, 0x04050607UL, 0x00010203UL));\r\n      |            ~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n/usr/lib/gcc/x86_64-linux-gnu/13/include/tmmintrin.h:136:1: error: inlining failed in call to 'always_inline' '__m128i _mm_shuffle_epi8(__m128i, __m128i)': target specific option mismatch\r\n  136 | _mm_shuffle_epi8 (__m128i __X, __m128i __Y)\r\n      | ^~~~~~~~~~~~~~~~\r\ncrypto/sha256_sse41.cpp:55:28: note: called from here\r\n   55 |     return _mm_shuffle_epi8(ret, _mm_set_epi32(0x0C0D0E0FUL, 0x08090A0BUL, 0x04050607UL, 0x00010203UL));\r\n      |            ~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nmake[2]: *** [Makefile:14520: crypto/libbitcoin_crypto_sse41_la-sha256_sse41.lo] Error 1\r\n```\r\n\r\nBoth of these can / should be fixed up.",
      "created_at" : "2023-11-14T15:52:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28864#issuecomment-1810503305",
      "id" : 1810503305,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28864",
      "node_id" : "IC_kwDOABII585r6haJ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1810503305/reactions"
      },
      "updated_at" : "2023-11-14T15:52:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1810503305",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   }
]
