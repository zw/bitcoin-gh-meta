[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Ping @jnewbery, since https://github.com/bitcoin/bitcoin/pull/21866#issuecomment-858536566 :relaxed: ",
      "created_at" : "2021-07-27T20:02:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-887796309",
      "id" : 887796309,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII58406rJV",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-27T20:02:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/887796309",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. Globals must fall!",
      "created_at" : "2021-07-27T21:48:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-887856830",
      "id" : 887856830,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII5840656-",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-27T21:48:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/887856830",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#23280](https://github.com/bitcoin/bitcoin/pull/23280) (init: Coalesce Chainstate loading sequence between {,non-}unittest codepaths by dongcarl)\n* [#23174](https://github.com/bitcoin/bitcoin/pull/23174) (validation: have LoadBlockIndex account for snapshot use by jamesob)\n* [#23095](https://github.com/bitcoin/bitcoin/pull/23095) (refactor: Use C++17 std::clamp by hebasto)\n* [#22981](https://github.com/bitcoin/bitcoin/pull/22981) (doc: Fix incorrect C++ named args by MarcoFalke)\n* [#22932](https://github.com/bitcoin/bitcoin/pull/22932) (Guard CBlockIndex::nStatus by cs_main, require GetBlockPos/GetUndoPos to hold cs_main by jonatack)\n* [#22918](https://github.com/bitcoin/bitcoin/pull/22918) (rpc: Add level 3 verbosity to getblock RPC call (#21245 modified) by kiminuo)\n* [#21726](https://github.com/bitcoin/bitcoin/pull/21726) (Improve Indices on pruned nodes via prune blockers by fjahr)\n* [#21702](https://github.com/bitcoin/bitcoin/pull/21702) (Implement BIP-119 Validation (CheckTemplateVerify) by JeremyRubin)\n* [#20827](https://github.com/bitcoin/bitcoin/pull/20827) (During IBD, prune as much as possible until we get close to where we will eventually keep blocks by luke-jr)\n* [#19888](https://github.com/bitcoin/bitcoin/pull/19888) (rpc, test: Improve getblockstats for unspendables by fjahr)\n* [#19873](https://github.com/bitcoin/bitcoin/pull/19873) (Flush dbcache early if system is under memory pressure by luke-jr)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-07-28T10:06:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-888183043",
      "id" : 888183043,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII58408JkD",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/888183043/reactions"
      },
      "updated_at" : "2021-10-16T06:58:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/888183043",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680503657"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680503657"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Hard NACK -- the signatures for the two versions of `DeploymentActiveAfter` (and `..At`) should only differ by whether they accept a `DeploymentPos` or a `BuriedDeployment`, otherwise we're back to having to edit bunches of call sites when burying deployments.\r\n\r\nBUT... I think you can get the result you're trying for by making `DeploymentActiveAfter` (and `..At`) inline member functions of `BlockManager`. Proof of concept at https://github.com/ajtowns/bitcoin/commits/202108-deplotmentstatus-blockmanager\r\n\r\nWould it be feasible to move `BlockManager` to its own module to reduce the amount of stuff validation.cpp does? Giving BlockManager a `CChainParams` member reference and having `CChainState` and `ChainstateManager` reference it via their BlockManager references, and also removing the `Consensus::Params` and `CChainParams` params from bunches of functions (including the `DeploymentActive..` ones) seems like it would be a win.",
      "commit_id" : "f741623c25455c20bff9eb1ddd10a4ac84dc5655",
      "created_at" : "2021-08-01T12:23:58Z",
      "diff_hunk" : "@@ -10,20 +10,17 @@\n \n #include <limits>\n \n-/** Global cache for versionbits deployment status */\n-extern VersionBitsCache g_versionbitscache;\n-\n /** Determine if a deployment is active for the next block */\n inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::BuriedDeployment dep)\n {\n     assert(Consensus::ValidDeployment(dep));\n     return (pindexPrev == nullptr ? 0 : pindexPrev->nHeight + 1) >= params.DeploymentHeight(dep);\n }\n \n-inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep)\n+inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep, VersionBitsCache& versionbitscache)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680503657",
      "id" : 680503657,
      "line" : 20,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MDUwMzY1Nw==",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 20,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/deploymentstatus.h",
      "position" : 15,
      "pull_request_review_id" : 719657071,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-01T13:59:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680503657",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680508909"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680508909"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Note that there shouldn't be any logical need for this to be cleared here -- the cached information doesn't become invalid when we load up different blocks, only if the consensus parameters are changed.",
      "commit_id" : "f741623c25455c20bff9eb1ddd10a4ac84dc5655",
      "created_at" : "2021-08-01T13:06:26Z",
      "diff_hunk" : "@@ -4106,7 +4107,6 @@ void UnloadBlockIndex(CTxMemPool* mempool, ChainstateManager& chainman)\n     LOCK(cs_main);\n     chainman.Unload();\n     if (mempool) mempool->clear();\n-    g_versionbitscache.Clear();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680508909",
      "id" : 680508909,
      "line" : 4111,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MDUwODkwOQ==",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 4109,
      "original_position" : 86,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 577,
      "pull_request_review_id" : 719657071,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-01T13:58:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680508909",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680513805"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680513805"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Should be `auto& i : warningcache` ??",
      "commit_id" : "f741623c25455c20bff9eb1ddd10a4ac84dc5655",
      "created_at" : "2021-08-01T13:44:15Z",
      "diff_hunk" : "@@ -4107,8 +4107,8 @@ void UnloadBlockIndex(CTxMemPool* mempool, ChainstateManager& chainman)\n     LOCK(cs_main);\n     chainman.Unload();\n     if (mempool) mempool->clear();\n-    for (int b = 0; b < VERSIONBITS_NUM_BITS; b++) {\n-        warningcache[b].clear();\n+    for (auto i : warningcache) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680513805",
      "id" : 680513805,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MDUxMzgwNQ==",
      "original_commit_id" : "6b0a3bc7bd80a8e0dc1f59dbc89bd211ac6a7c1e",
      "original_line" : 4110,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 719657071,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-01T13:58:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680513805",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680518852"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680518852"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Wouldn't another class in validation be better suited to host the deployment status? My goal was to move BlockManger to node/storage and have it deal with storage only, not validation. ",
      "commit_id" : "f741623c25455c20bff9eb1ddd10a4ac84dc5655",
      "created_at" : "2021-08-01T14:24:19Z",
      "diff_hunk" : "@@ -10,20 +10,17 @@\n \n #include <limits>\n \n-/** Global cache for versionbits deployment status */\n-extern VersionBitsCache g_versionbitscache;\n-\n /** Determine if a deployment is active for the next block */\n inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::BuriedDeployment dep)\n {\n     assert(Consensus::ValidDeployment(dep));\n     return (pindexPrev == nullptr ? 0 : pindexPrev->nHeight + 1) >= params.DeploymentHeight(dep);\n }\n \n-inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep)\n+inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep, VersionBitsCache& versionbitscache)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680518852",
      "id" : 680518852,
      "in_reply_to_id" : 680503657,
      "line" : 20,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MDUxODg1Mg==",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 20,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/deploymentstatus.h",
      "position" : 15,
      "pull_request_review_id" : 719668013,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-01T14:24:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680518852",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680522667"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680522667"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "@MarcoFalke Maybe? I look at deployment status as an expansion of Consensus::Params -- so more as input to validation than a result of it. If we switch to using the coinbase witness nonce for deployment signalling we'd need to change the way we store blocks so that it's easy to access that info without having to load every signalling block from disk, so it's kind-of storage related in that sense?",
      "commit_id" : "f741623c25455c20bff9eb1ddd10a4ac84dc5655",
      "created_at" : "2021-08-01T14:52:31Z",
      "diff_hunk" : "@@ -10,20 +10,17 @@\n \n #include <limits>\n \n-/** Global cache for versionbits deployment status */\n-extern VersionBitsCache g_versionbitscache;\n-\n /** Determine if a deployment is active for the next block */\n inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::BuriedDeployment dep)\n {\n     assert(Consensus::ValidDeployment(dep));\n     return (pindexPrev == nullptr ? 0 : pindexPrev->nHeight + 1) >= params.DeploymentHeight(dep);\n }\n \n-inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep)\n+inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep, VersionBitsCache& versionbitscache)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680522667",
      "id" : 680522667,
      "in_reply_to_id" : 680503657,
      "line" : 20,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MDUyMjY2Nw==",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 20,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/deploymentstatus.h",
      "position" : 15,
      "pull_request_review_id" : 719670647,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-01T14:52:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680522667",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r682041105"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/682041105"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> the signatures for the two versions of `DeploymentActiveAfter` (and `..At`) should only differ by whether they accept a `DeploymentPos` or a `BuriedDeployment`, otherwise we're back to having to edit bunches of call sites when burying deployments.\r\n\r\nOh I did not realize that this was the case! Note to self: add a code comment documenting this.\r\n\r\n> BUT... I think you can get the result you're trying for by making `DeploymentActiveAfter` (and `..At`) inline member functions of `BlockManager`. Proof of concept at https://github.com/ajtowns/bitcoin/commits/202108-deplotmentstatus-blockmanager\r\n\r\nThis looks good to me, and it seems like they would eventually end up having to interact with `BlockManager` anyway according to the following?\r\n\r\n> If we switch to using the coinbase witness nonce for deployment signalling we'd need to change the way we store blocks so that it's easy to access that info without having to load every signalling block from disk, so it's kind-of storage related in that sense?\r\n\r\n-----\r\n\r\n> Would it be feasible to move `BlockManager` to its own module to reduce the amount of stuff validation.cpp does? Giving BlockManager a `CChainParams` member reference and having `CChainState` and `ChainstateManager` reference it via their BlockManager references, and also removing the `Consensus::Params` and `CChainParams` params from bunches of functions (including the `DeploymentActive..` ones) seems like it would be a win.\r\n\r\nYes I think as part of some other work I'll have to pull validation apart anyway, I will look into this!",
      "commit_id" : "f741623c25455c20bff9eb1ddd10a4ac84dc5655",
      "created_at" : "2021-08-03T19:27:49Z",
      "diff_hunk" : "@@ -10,20 +10,17 @@\n \n #include <limits>\n \n-/** Global cache for versionbits deployment status */\n-extern VersionBitsCache g_versionbitscache;\n-\n /** Determine if a deployment is active for the next block */\n inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::BuriedDeployment dep)\n {\n     assert(Consensus::ValidDeployment(dep));\n     return (pindexPrev == nullptr ? 0 : pindexPrev->nHeight + 1) >= params.DeploymentHeight(dep);\n }\n \n-inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep)\n+inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep, VersionBitsCache& versionbitscache)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r682041105",
      "id" : 682041105,
      "in_reply_to_id" : 680503657,
      "line" : 20,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MjA0MTEwNQ==",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 20,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/deploymentstatus.h",
      "position" : 15,
      "pull_request_review_id" : 721567946,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-03T19:27:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/682041105",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r694260466"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/694260466"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"No more heap BlockIndices\" (6a897c0601dff4f116b1ab223595c5c2fac0e7a3)\r\n\r\nComment seems to lack a little context, maybe prefix with \"Because validation code takes pointers to the map's CBlockIndex objects, if we ever switch...\"",
      "commit_id" : "f741623c25455c20bff9eb1ddd10a4ac84dc5655",
      "created_at" : "2021-08-23T19:46:31Z",
      "diff_hunk" : "@@ -107,7 +107,12 @@ enum class SynchronizationState {\n };\n \n extern RecursiveMutex cs_main;\n-typedef std::unordered_map<uint256, CBlockIndex*, BlockHasher> BlockMap;\n+\n+// If we ever switch to another associative container, we need to either use a",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r694260466",
      "id" : 694260466,
      "line" : 111,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NDI2MDQ2Ng==",
      "original_commit_id" : "6a897c0601dff4f116b1ab223595c5c2fac0e7a3",
      "original_line" : 111,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 14,
      "pull_request_review_id" : 736503538,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-23T19:51:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/694260466",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed f741623c25 -> 6e6472e6dc\r\n- Address https://github.com/bitcoin/bitcoin/pull/22564#discussion_r694260466\r\n- Address https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680513805",
      "created_at" : "2021-08-24T17:57:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-904855311",
      "id" : 904855311,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII58417v8P",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-24T17:57:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/904855311",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed 6e6472e6dc -> 6bb9ed3f62:\r\n- Rebased on master",
      "created_at" : "2021-08-24T18:45:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-904886902",
      "id" : 904886902,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII584173p2",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-24T18:45:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/904886902",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695141648"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695141648"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Is this the same case for `warningcache` as well? If so, perhaps we'll just move the clearing logic to `SelectParams` and not move these two structures into `BlockManager`?",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-24T19:29:37Z",
      "diff_hunk" : "@@ -4106,7 +4107,6 @@ void UnloadBlockIndex(CTxMemPool* mempool, ChainstateManager& chainman)\n     LOCK(cs_main);\n     chainman.Unload();\n     if (mempool) mempool->clear();\n-    g_versionbitscache.Clear();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695141648",
      "id" : 695141648,
      "in_reply_to_id" : 680508909,
      "line" : 4091,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NTE0MTY0OA==",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 4091,
      "original_position" : 86,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 577,
      "pull_request_review_id" : 737608619,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-24T19:29:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695141648",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695824018"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695824018"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Move pindexBest{Header,Invalid} to BlockManager\" (9fdf6825bc6a3a27b23b7a1015afc33b3a62effd)\r\n\r\nIs there a reason these are moved to BlockManager class instead of ChainstateManager class? I don't see anywhere where the blockmanager class itself is accessing these members, and I don't see any references to this through any blockmanager reference except the ChainStateManager::m_blockman one. These are also set from chain state not block state, so it seems like these are more related to chain state functionality than  in block manager. Maybe ideally it would be a would be a private ChainStateManager member?\r\n\r\nI'm not sure about this and maybe it doesn't matter, but it would be good to at least hint at what the thinking is behind the move destination is in the commit description.",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-25T14:42:37Z",
      "diff_hunk" : "@@ -430,6 +427,11 @@ class BlockManager\n       */\n     std::set<CBlockIndex*> m_failed_blocks;\n \n+    CBlockIndex* pindexBestInvalid = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695824018",
      "id" : 695824018,
      "line" : 435,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NTgyNDAxOA==",
      "original_commit_id" : "9fdf6825bc6a3a27b23b7a1015afc33b3a62effd",
      "original_line" : 430,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 42,
      "pull_request_review_id" : 738449978,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-25T15:51:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695824018",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695841110"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695841110"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Move setDirty{BlockIndex,FileInfo} to BlockManager\" (feb62ff2a0af6fedfaa3078b1a512416cdf71264)\r\n\r\nShould just delete these old function declarations (now that they are member functions)",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-25T14:59:53Z",
      "diff_hunk" : "@@ -73,9 +73,9 @@ bool ReadRawBlockFromDisk(std::vector<uint8_t>& block, const FlatFilePos& pos, c\n bool ReadRawBlockFromDisk(std::vector<uint8_t>& block, const CBlockIndex* pindex, const CMessageHeader::MessageStartChars& message_start);\n \n bool UndoReadFromDisk(CBlockUndo& blockundo, const CBlockIndex* pindex);\n-bool WriteUndoDataForBlock(const CBlockUndo& blockundo, BlockValidationState& state, CBlockIndex* pindex, const CChainParams& chainparams);\n+// bool WriteUndoDataForBlock(const CBlockUndo& blockundo, BlockValidationState& state, CBlockIndex* pindex, const CChainParams& chainparams);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695841110",
      "id" : 695841110,
      "line" : 74,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NTg0MTExMA==",
      "original_commit_id" : "feb62ff2a0af6fedfaa3078b1a512416cdf71264",
      "original_line" : 76,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : 39,
      "pull_request_review_id" : 738449978,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-25T15:51:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695841110",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695846531"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695846531"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Move setDirty{BlockIndex,FileInfo} to BlockManager\" (feb62ff2a0af6fedfaa3078b1a512416cdf71264)\r\n\r\nCan these clears which are moved from `UnloadBlockIndex` to `BlockManager::Unload` be done in a different commit before all the other changes in this commit? It's confusing because `UnloadBlockIndex` isn't even calling `BlockManager::Unload` directly, but indirectly through the `ChainstateManager::Unload` method. Another reason it would be nice to have the change in a standalone commit would be to describe what is motivating the move.\r\n\r\nAdditionally, maybe separately it would be good to flatten the existing call chain here, because it doesn't seem to make much sense outwardly and seems unnecessarily complex. It seems like `ChainstateManager::Unload` is only called one place and could be removed and inlined. Also `CChainState::UnloadBlockIndex` looks like it's only called one place and could be removed and inlined. Another reason it would be great to drop that one is the confusing name clash between the member function and the global function.",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-25T15:05:44Z",
      "diff_hunk" : "@@ -3746,6 +3744,9 @@ void BlockManager::Unload() {\n \n     pindexBestInvalid = nullptr;\n     pindexBestHeader = nullptr;\n+\n+    setDirtyBlockIndex.clear();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695846531",
      "id" : 695846531,
      "line" : 3744,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NTg0NjUzMQ==",
      "original_commit_id" : "feb62ff2a0af6fedfaa3078b1a512416cdf71264",
      "original_line" : 3748,
      "original_position" : 133,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 508,
      "pull_request_review_id" : 738449978,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-25T15:51:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695846531",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695871478"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695871478"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Move setDirty{BlockIndex,FileInfo} to BlockManager\" (feb62ff2a0af6fedfaa3078b1a512416cdf71264)\r\n\r\nMoving these variables to BlockManager makes more sense to me than moving pIndexBest variables in the prior commit, but it would helpful to say why this move destination makes sense in the commit description. Maybe \"Move these variables to block manager because they are used to update the block index on disk. In the future it might make sense move more logic responsible for updating and writing the block index to the block manager class and make these variables private instead of public.\"",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-25T15:32:40Z",
      "diff_hunk" : "@@ -432,6 +432,12 @@ class BlockManager\n     /** Best header we've seen so far (used for getheaders queries' starting points). */\n     CBlockIndex *pindexBestHeader = nullptr;\n \n+    /** Dirty block index entries. */\n+    std::set<CBlockIndex*> setDirtyBlockIndex;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695871478",
      "id" : 695871478,
      "line" : 441,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NTg3MTQ3OA==",
      "original_commit_id" : "feb62ff2a0af6fedfaa3078b1a512416cdf71264",
      "original_line" : 436,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 48,
      "pull_request_review_id" : 738449978,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-25T15:51:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695871478",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695941754"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695941754"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I believe they are accessed by `BlockManager` here: https://github.com/bitcoin/bitcoin/blob/21438d55d553ae5bf3be7c0d4431aaf136db6c6b/src/validation.cpp#L3732-L3737\r\n\r\nAdditionally (and I'd like feedback on if this makes sense), it seems to me that variables whose type involve `CBlockIndex*` should likely live an die with the `BlockManager` since it owns the `BlockMap` entries to which these pointers are pointing.",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-25T16:59:12Z",
      "diff_hunk" : "@@ -430,6 +427,11 @@ class BlockManager\n       */\n     std::set<CBlockIndex*> m_failed_blocks;\n \n+    CBlockIndex* pindexBestInvalid = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695941754",
      "id" : 695941754,
      "in_reply_to_id" : 695824018,
      "line" : 435,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NTk0MTc1NA==",
      "original_commit_id" : "9fdf6825bc6a3a27b23b7a1015afc33b3a62effd",
      "original_line" : 430,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 42,
      "pull_request_review_id" : 738604066,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-25T16:59:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695941754",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695978717"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695978717"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> I believe they are accessed by `BlockManager` here:\r\n> \r\n> https://github.com/bitcoin/bitcoin/blob/21438d55d553ae5bf3be7c0d4431aaf136db6c6b/src/validation.cpp#L3732-L3737\r\n> \r\n> Additionally (and I'd like feedback on if this makes sense), it seems to me that variables whose type involve `CBlockIndex*` should likely live an die with the `BlockManager` since it owns the `BlockMap` entries to which these pointers are pointing.\r\n\r\nRegardless of what should happen with these two variables I would definitely push back against this logic. CBlockIndex pointers are used in all kinds of code that has nothing to do with the actual block index, just as convenient and easy way to refer to blocks. If you tried to move all CBlockIndex type variables into BlockManager, you would be moving validation logic and indexing logic (and even wallet logic prior to #10973) into the BlockManager class where it pretty clearly does not belong.\r\n\r\nI think class state should generally be located in the class accessing and updating that state. It doesn't usually make sense for one class to store state on behalf on another class that it never accesses or uses itself. And probably ideally, all of these classes would have private state that would not be directly manipulated by other classes at all.",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-25T17:41:34Z",
      "diff_hunk" : "@@ -430,6 +427,11 @@ class BlockManager\n       */\n     std::set<CBlockIndex*> m_failed_blocks;\n \n+    CBlockIndex* pindexBestInvalid = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695978717",
      "id" : 695978717,
      "in_reply_to_id" : 695824018,
      "line" : 435,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NTk3ODcxNw==",
      "original_commit_id" : "9fdf6825bc6a3a27b23b7a1015afc33b3a62effd",
      "original_line" : 430,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 42,
      "pull_request_review_id" : 738655462,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-25T17:41:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695978717",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695990703"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695990703"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Looking at your link more it does make some sense to me to keep these variables here if they can be derived directly from block index data like that.\r\n\r\nThe boundaries are definitely a little blurry here and in longer run I'd be inclined to want to move this logic out of the Block Manager class so it is just responsible storing the index data and not interpreting it so much. In short run I would add additional `CBlockIndex*&best_header` and `CBlockIndex*&best_invalid_header` output parameters so the LoadBlockIndex can keep the same logic and just return the information.\r\n\r\nBut now that I see what motivated moving these variables here, I don't think it's crazy to keep the variables here either. So you should do what seems best to you, and thanks for clarifying!",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-25T17:58:17Z",
      "diff_hunk" : "@@ -430,6 +427,11 @@ class BlockManager\n       */\n     std::set<CBlockIndex*> m_failed_blocks;\n \n+    CBlockIndex* pindexBestInvalid = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695990703",
      "id" : 695990703,
      "in_reply_to_id" : 695824018,
      "line" : 435,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NTk5MDcwMw==",
      "original_commit_id" : "9fdf6825bc6a3a27b23b7a1015afc33b3a62effd",
      "original_line" : 430,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 42,
      "pull_request_review_id" : 738670688,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-25T17:58:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695990703",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r696827015"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696827015"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"validation: Add missing cs_LastBlockFile locks in PruneAndFlush() and UnloadBlockIndex(). Add missing locking annotation for nLastBlockFile and fCheckForPruning.\" (ccd6ec5e620dbb3ae251b3511d00aaf3614e97da)\r\n\r\nI think `GUARDED_BY(cs_LastBlockFile)` should be added here to the `vinfoBlockFile` variable as well. The \"last block\" mutex name is confusing, but I believe the naming only ended up that way  because the vinfo variable was added in a later commit ed6d1a2c7be9d046d5e78330d5e163023a6b302a than the last block variables 5382bcf8cd23c36a435c29080770a79b5e28af42. From the code it looks pretty clearly like the mutex is meant to cover all the variables, and it seems to be always locked when accessing them (except during unloading/loading where other locks have been elided as well).",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-26T17:13:50Z",
      "diff_hunk" : "@@ -28,12 +28,12 @@ uint64_t nPruneTarget = 0;\n // TODO make namespace {\n RecursiveMutex cs_LastBlockFile;\n std::vector<CBlockFileInfo> vinfoBlockFile;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r696827015",
      "id" : 696827015,
      "line" : 29,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NjgyNzAxNQ==",
      "original_commit_id" : "ccd6ec5e620dbb3ae251b3511d00aaf3614e97da",
      "original_line" : 30,
      "original_position" : 3,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : 10,
      "pull_request_review_id" : 739739848,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-26T17:14:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696827015",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r697576048"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697576048"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"validation: Add missing cs_nBlockSequenceId lock in UnloadBlockIndex(). Add missing locking annotation for nBlockSequenceId.\" (7c3f21a5c16e83ef6baacbcd600d15a470ff1e5b)\r\n\r\nTwo notes for future improvements:\r\n\r\n- Looking at actual `nBlockSequenceId` uses, it is really just used as an atomic, and could be replaced with an atomic and the mutex could be eliminated with no change in behavior.\r\n- nBlockReverseSequenceId below should have GUARDED_BY(cs_main)",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-27T16:35:46Z",
      "diff_hunk" : "@@ -573,7 +573,7 @@ class CChainState\n      */\n     RecursiveMutex cs_nBlockSequenceId;\n     /** Blocks loaded from disk are assigned id 0, so start the counter at 1. */\n-    int32_t nBlockSequenceId = 1;\n+    int32_t nBlockSequenceId GUARDED_BY(cs_nBlockSequenceId) = 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r697576048",
      "id" : 697576048,
      "line" : 611,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NzU3NjA0OA==",
      "original_commit_id" : "7c3f21a5c16e83ef6baacbcd600d15a470ff1e5b",
      "original_line" : 576,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 119,
      "pull_request_review_id" : 740704160,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-27T17:08:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697576048",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r697585112"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697585112"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Move cs_LastBlockFile guarded objects to BlockManager\" (ca77cd53abb455847094cecdc11b217c64166de8)\r\n\r\nShould fully remove this declaration and the one below",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-27T16:50:58Z",
      "diff_hunk" : "@@ -55,11 +55,11 @@ FILE* OpenBlockFile(const FlatFilePos& pos, bool fReadOnly = false);\n /** Translation to a filesystem path */\n fs::path GetBlockPosFilename(const FlatFilePos& pos);\n \n-/** Get block file info entry for one block file */\n-CBlockFileInfo* GetBlockFileInfo(size_t n);\n+// /** Get block file info entry for one block file */\n+// CBlockFileInfo* GetBlockFileInfo(size_t n);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r697585112",
      "id" : 697585112,
      "line" : 57,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NzU4NTExMg==",
      "original_commit_id" : "ca77cd53abb455847094cecdc11b217c64166de8",
      "original_line" : 59,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : 25,
      "pull_request_review_id" : 740704160,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-27T17:08:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697585112",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r697587487"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697587487"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Move cs_LastBlockFile guarded objects to BlockManager\" (ca77cd53abb455847094cecdc11b217c64166de8)\r\n\r\nIt would seem better to keep this comment which is still summarizing behavior of this block of code.",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-27T16:55:05Z",
      "diff_hunk" : "@@ -39,11 +38,14 @@ BOOST_AUTO_TEST_CASE(validation_chainstate_resize_caches)\n     CChainState& c1 = WITH_LOCK(cs_main, return manager.InitializeChainstate(&mempool));\n     c1.InitCoinsDB(\n         /* cache_size_bytes */ 1 << 23, /* in_memory */ true, /* should_wipe */ false);\n-    WITH_LOCK(::cs_main, c1.InitCoinsCache(1 << 23));\n \n-    // Add a coin to the in-memory cache, upsize once, then downsize.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r697587487",
      "id" : 697587487,
      "line" : 44,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NzU4NzQ4Nw==",
      "original_commit_id" : "ca77cd53abb455847094cecdc11b217c64166de8",
      "original_line" : 44,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/test/validation_chainstate_tests.cpp",
      "position" : 25,
      "pull_request_review_id" : 740704160,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-27T17:08:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697587487",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r697594297"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697594297"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Move cs_LastBlockFile guarded objects to BlockManager\" (ca77cd53abb455847094cecdc11b217c64166de8)\r\n\r\nI guess this is a preexisting thing better to address in a different PR, but it seems wrong if cs_main is required to get a *pointer* to blockman from the chainman. I didn't look but ideally the blockman pointer would be set once in the chainman constructor and could just be const. Or even if it could not be const for some reason, it could be atomic and not require a validation lock.",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-27T17:07:00Z",
      "diff_hunk" : "@@ -84,7 +84,7 @@ BOOST_FIXTURE_TEST_CASE(scan_for_wallet_transactions, TestChain100Setup)\n {\n     // Cap last block file size, and mine new block in a new block file.\n     CBlockIndex* oldTip = m_node.chainman->ActiveChain().Tip();\n-    GetBlockFileInfo(oldTip->GetBlockPos().nFile)->nSize = MAX_BLOCKFILE_SIZE;\n+    (*WITH_LOCK(::cs_main, return &m_node.chainman->m_blockman)).GetBlockFileInfo(oldTip->GetBlockPos().nFile)->nSize = MAX_BLOCKFILE_SIZE;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r697594297",
      "id" : 697594297,
      "line" : 87,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NzU5NDI5Nw==",
      "original_commit_id" : "ca77cd53abb455847094cecdc11b217c64166de8",
      "original_line" : 87,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/test/wallet_tests.cpp",
      "position" : 5,
      "pull_request_review_id" : 740704160,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-27T17:08:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697594297",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r698659280"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/698659280"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Move fHavePruned to BlockManager\" (b40f35d7f0507fcfb71d1c950c5158d6ff5fdb5e)\r\n\r\nThis is another place like https://github.com/bitcoin/bitcoin/pull/22564#discussion_r697594297 where it looks like m_blockman is improperly annotated to require cs_main. In general, if you have a variable\r\n\r\n```c++\r\nT variable GUARDED_BY(mutex);\r\n```\r\n\r\nAnd you are writing `WITH_LOCK(mutex, return &variable);` you're just bypassing the annotation, and either the annotation is wrong and shouldn't be there, or it's right and you're introducing a possible race condition when the variable is accessed through the pointer later without the lock held.\r\n\r\nIt would be nice to drop the `m_blockman` annotation in this PR because it seems overly broad. Or if it's easier a comment could be added just to say why the annotation is bypassed here.",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-30T17:08:50Z",
      "diff_hunk" : "@@ -40,7 +40,7 @@ static void BlockToJsonVerbose(benchmark::Bench& bench)\n {\n     TestBlockAndIndex data;\n     bench.run([&] {\n-        auto univalue = blockToJSON(data.block, &data.blockindex, &data.blockindex, /*verbose*/ true);\n+        auto univalue = blockToJSON(WITH_LOCK(::cs_main, return std::ref(data.testing_setup->m_node.chainman->m_blockman)), data.block, &data.blockindex, &data.blockindex, /*verbose*/ true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r698659280",
      "id" : 698659280,
      "line" : 43,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5ODY1OTI4MA==",
      "original_commit_id" : "b40f35d7f0507fcfb71d1c950c5158d6ff5fdb5e",
      "original_line" : 43,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/bench/rpc_blockchain.cpp",
      "position" : 5,
      "pull_request_review_id" : 741875684,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-30T17:08:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/698659280",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708512723"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708512723"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Deleted as of d849178b9c36de80cded34a5305236282d7b24d6",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-14T18:07:22Z",
      "diff_hunk" : "@@ -73,9 +73,9 @@ bool ReadRawBlockFromDisk(std::vector<uint8_t>& block, const FlatFilePos& pos, c\n bool ReadRawBlockFromDisk(std::vector<uint8_t>& block, const CBlockIndex* pindex, const CMessageHeader::MessageStartChars& message_start);\n \n bool UndoReadFromDisk(CBlockUndo& blockundo, const CBlockIndex* pindex);\n-bool WriteUndoDataForBlock(const CBlockUndo& blockundo, BlockValidationState& state, CBlockIndex* pindex, const CChainParams& chainparams);\n+// bool WriteUndoDataForBlock(const CBlockUndo& blockundo, BlockValidationState& state, CBlockIndex* pindex, const CChainParams& chainparams);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708512723",
      "id" : 708512723,
      "in_reply_to_id" : 695841110,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584qOwvT",
      "original_commit_id" : "feb62ff2a0af6fedfaa3078b1a512416cdf71264",
      "original_line" : 76,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : null,
      "pull_request_review_id" : 754271400,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-14T18:07:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708512723",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708513880"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708513880"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "First note done in master, second note done by: b903d3b682bc1a779f924fb9da778ec295ab017b",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-14T18:09:05Z",
      "diff_hunk" : "@@ -573,7 +573,7 @@ class CChainState\n      */\n     RecursiveMutex cs_nBlockSequenceId;\n     /** Blocks loaded from disk are assigned id 0, so start the counter at 1. */\n-    int32_t nBlockSequenceId = 1;\n+    int32_t nBlockSequenceId GUARDED_BY(cs_nBlockSequenceId) = 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708513880",
      "id" : 708513880,
      "in_reply_to_id" : 697576048,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584qOxBY",
      "original_commit_id" : "7c3f21a5c16e83ef6baacbcd600d15a470ff1e5b",
      "original_line" : 576,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : null,
      "pull_request_review_id" : 754272925,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-14T18:09:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708513880",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708514137"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708514137"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Removed as of d849178b9c36de80cded34a5305236282d7b24d6",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-14T18:09:26Z",
      "diff_hunk" : "@@ -55,11 +55,11 @@ FILE* OpenBlockFile(const FlatFilePos& pos, bool fReadOnly = false);\n /** Translation to a filesystem path */\n fs::path GetBlockPosFilename(const FlatFilePos& pos);\n \n-/** Get block file info entry for one block file */\n-CBlockFileInfo* GetBlockFileInfo(size_t n);\n+// /** Get block file info entry for one block file */\n+// CBlockFileInfo* GetBlockFileInfo(size_t n);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708514137",
      "id" : 708514137,
      "in_reply_to_id" : 697585112,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584qOxFZ",
      "original_commit_id" : "ca77cd53abb455847094cecdc11b217c64166de8",
      "original_line" : 59,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : null,
      "pull_request_review_id" : 754273239,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-14T18:09:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708514137",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708514206"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708514206"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Removed as of d849178b9c36de80cded34a5305236282d7b24d6",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-14T18:09:31Z",
      "diff_hunk" : "@@ -55,11 +55,11 @@ FILE* OpenBlockFile(const FlatFilePos& pos, bool fReadOnly = false);\n /** Translation to a filesystem path */\n fs::path GetBlockPosFilename(const FlatFilePos& pos);\n \n-/** Get block file info entry for one block file */\n-CBlockFileInfo* GetBlockFileInfo(size_t n);\n+// /** Get block file info entry for one block file */\n+// CBlockFileInfo* GetBlockFileInfo(size_t n);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708514206",
      "id" : 708514206,
      "in_reply_to_id" : 697585112,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584qOxGe",
      "original_commit_id" : "ca77cd53abb455847094cecdc11b217c64166de8",
      "original_line" : 59,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : null,
      "pull_request_review_id" : 754273315,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-14T18:09:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708514206",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708514602"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708514602"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Fixed in 8fd345b98f8b8cb81a2c5c9e227405364d7b46a2",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-14T18:10:02Z",
      "diff_hunk" : "@@ -39,11 +38,14 @@ BOOST_AUTO_TEST_CASE(validation_chainstate_resize_caches)\n     CChainState& c1 = WITH_LOCK(cs_main, return manager.InitializeChainstate(&mempool));\n     c1.InitCoinsDB(\n         /* cache_size_bytes */ 1 << 23, /* in_memory */ true, /* should_wipe */ false);\n-    WITH_LOCK(::cs_main, c1.InitCoinsCache(1 << 23));\n \n-    // Add a coin to the in-memory cache, upsize once, then downsize.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708514602",
      "id" : 708514602,
      "in_reply_to_id" : 697587487,
      "line" : 44,
      "node_id" : "PRRC_kwDOABII584qOxMq",
      "original_commit_id" : "ca77cd53abb455847094cecdc11b217c64166de8",
      "original_line" : 44,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/test/validation_chainstate_tests.cpp",
      "position" : 25,
      "pull_request_review_id" : 754273823,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-14T18:10:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708514602",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708567724"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708567724"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "vinfo guarded in: 952482e8598c9bd38a7a4e382c0c791acda11ff4\r\ncs_LastBlockFile renamed in: 71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-14T19:27:08Z",
      "diff_hunk" : "@@ -28,12 +28,12 @@ uint64_t nPruneTarget = 0;\n // TODO make namespace {\n RecursiveMutex cs_LastBlockFile;\n std::vector<CBlockFileInfo> vinfoBlockFile;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708567724",
      "id" : 708567724,
      "in_reply_to_id" : 696827015,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584qO-Ks",
      "original_commit_id" : "ccd6ec5e620dbb3ae251b3511d00aaf3614e97da",
      "original_line" : 30,
      "original_position" : 3,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : null,
      "pull_request_review_id" : 754342417,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-14T19:27:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708567724",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708577418"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708577418"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Description added to fa455c0339561ca19a3edd6b249be962ae87194d",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-14T19:41:15Z",
      "diff_hunk" : "@@ -432,6 +432,12 @@ class BlockManager\n     /** Best header we've seen so far (used for getheaders queries' starting points). */\n     CBlockIndex *pindexBestHeader = nullptr;\n \n+    /** Dirty block index entries. */\n+    std::set<CBlockIndex*> setDirtyBlockIndex;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708577418",
      "id" : 708577418,
      "in_reply_to_id" : 695871478,
      "line" : 441,
      "node_id" : "PRRC_kwDOABII584qPAiK",
      "original_commit_id" : "feb62ff2a0af6fedfaa3078b1a512416cdf71264",
      "original_line" : 441,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 48,
      "pull_request_review_id" : 754354350,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-14T19:41:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708577418",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, will review in next few days",
      "created_at" : "2021-09-14T19:50:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-919464754",
      "id" : 919464754,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII5842zesy",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-14T19:50:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/919464754",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708801191"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708801191"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, `warningcache` only relies on the chain history, consensus params, and versionbitscache state. Moving the clearing logic to `SelectParams` would introduce a circular dependency though, I think?",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-15T03:04:45Z",
      "diff_hunk" : "@@ -4106,7 +4107,6 @@ void UnloadBlockIndex(CTxMemPool* mempool, ChainstateManager& chainman)\n     LOCK(cs_main);\n     chainman.Unload();\n     if (mempool) mempool->clear();\n-    g_versionbitscache.Clear();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708801191",
      "id" : 708801191,
      "in_reply_to_id" : 680508909,
      "line" : 3985,
      "node_id" : "PRRC_kwDOABII584qP3Kn",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 3985,
      "original_position" : 86,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 589,
      "pull_request_review_id" : 754621227,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-15T03:04:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708801191",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708839714"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708839714"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> This looks good to me, and it seems like they would eventually end up having to interact with `BlockManager` anyway according to the following?\r\n\r\nWell, using the cb wit nonce for activation signalling might never happen, and even if it does, I think it's a fair way off (since it would need getblocktemplate changes or stratumv2 or similar to make it even possible), so I wouldn't put too much weight on it, but it seems plausible.",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-15T05:02:35Z",
      "diff_hunk" : "@@ -10,20 +10,17 @@\n \n #include <limits>\n \n-/** Global cache for versionbits deployment status */\n-extern VersionBitsCache g_versionbitscache;\n-\n /** Determine if a deployment is active for the next block */\n inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::BuriedDeployment dep)\n {\n     assert(Consensus::ValidDeployment(dep));\n     return (pindexPrev == nullptr ? 0 : pindexPrev->nHeight + 1) >= params.DeploymentHeight(dep);\n }\n \n-inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep)\n+inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep, VersionBitsCache& versionbitscache)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708839714",
      "id" : 708839714,
      "in_reply_to_id" : 680503657,
      "line" : 20,
      "node_id" : "PRRC_kwDOABII584qQAki",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 20,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/deploymentstatus.h",
      "position" : 15,
      "pull_request_review_id" : 754664850,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-15T05:02:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708839714",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r712573048"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/712573048"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Not at all blocking and could be done in a separate commit, but might be nice to add a docstring describing purpose and usage of this member while all this is fresh in your head.",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-20T23:06:23Z",
      "diff_hunk" : "@@ -430,6 +427,11 @@ class BlockManager\n       */\n     std::set<CBlockIndex*> m_failed_blocks;\n \n+    CBlockIndex* pindexBestInvalid = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r712573048",
      "id" : 712573048,
      "line" : 435,
      "node_id" : "PRRC_kwDOABII584qeQB4",
      "original_commit_id" : "3ea18162a4d729db720ca14ff8363f539d375ab3",
      "original_line" : 430,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 42,
      "pull_request_review_id" : 759168474,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/712573048/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-28T14:37:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/712573048",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r712598917"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/712598917"
         }
      },
      "author_association" : "MEMBER",
      "body" : "https://github.com/bitcoin/bitcoin/pull/22564/commits/fa455c0339561ca19a3edd6b249be962ae87194d\r\n\r\nMight mention these changes somewhere in the commit message; I was surprised to see them here after reading it.",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-20T23:59:52Z",
      "diff_hunk" : "@@ -233,7 +227,7 @@ fs::path GetBlockPosFilename(const FlatFilePos& pos)\n     return BlockFileSeq().FileName(pos);\n }\n \n-bool FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigned int nHeight, CChain& active_chain, uint64_t nTime, bool fKnown = false)\n+bool BlockManager::FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigned int nHeight, CChain& active_chain, uint64_t nTime, bool fKnown = false)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r712598917",
      "id" : 712598917,
      "line" : 219,
      "node_id" : "PRRC_kwDOABII584qeWWF",
      "original_commit_id" : "fa455c0339561ca19a3edd6b249be962ae87194d",
      "original_line" : 230,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : 85,
      "pull_request_review_id" : 759168474,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/712598917/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-28T14:37:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/712598917",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r716945997"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/716945997"
         }
      },
      "author_association" : "MEMBER",
      "body" : "17f227f6d44bb417d0c6540e081d4d374bece6a7\r\n\r\nI think this forward declaration is probably outdated and doesn't seem necessary anymore - I was able to compile without it.",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-27T18:34:55Z",
      "diff_hunk" : "@@ -51,6 +51,8 @@ struct BIP9Stats {\n     bool possible;\n };\n \n+class VersionBitsCache;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r716945997",
      "id" : 716945997,
      "line" : 54,
      "node_id" : "PRRC_kwDOABII584qu7pN",
      "original_commit_id" : "17f227f6d44bb417d0c6540e081d4d374bece6a7",
      "original_line" : 54,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/versionbits.h",
      "position" : 4,
      "pull_request_review_id" : 759168474,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/716945997/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-28T14:37:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/716945997",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r716987095"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/716987095"
         }
      },
      "author_association" : "MEMBER",
      "body" : "https://github.com/bitcoin/bitcoin/pull/22564/commits/b48d7c010f644ed01e310ea4ab590580640a16b7\r\n\r\nTook me awhile to parse this name. I'm not opposed, it's kind of cute, but is it something we've used before? Maybe `newIndex`?",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-27T19:37:28Z",
      "diff_hunk" : "@@ -2800,20 +2800,21 @@ CBlockIndex* BlockManager::AddToBlockIndex(const CBlockHeader& block)\n     uint256 hash = block.GetHash();\n     BlockMap::iterator it = m_block_index.find(hash);\n     if (it != m_block_index.end())\n-        return it->second;\n+        return &it->second;\n \n     // Construct new block index object\n-    CBlockIndex* pindexNew = new CBlockIndex(block);\n+    CBlockIndex neue(block);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r716987095",
      "id" : 716987095,
      "line" : 2806,
      "node_id" : "PRRC_kwDOABII584qvFrX",
      "original_commit_id" : "b48d7c010f644ed01e310ea4ab590580640a16b7",
      "original_line" : 2806,
      "original_position" : 80,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 390,
      "pull_request_review_id" : 759168474,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/716987095/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-28T14:37:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/716987095",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r716998451"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/716998451"
         }
      },
      "author_association" : "MEMBER",
      "body" : "https://github.com/bitcoin/bitcoin/pull/22564/commits/b48d7c010f644ed01e310ea4ab590580640a16b7\r\n\r\nI'm not so worried about this function in particular since it's really only executed once on startup, but I've got to imagine there may be some performance implications if we're potentially introducing a lot of CBlockIndex value copying (vs. the pointers). \r\n\r\nThis does strike me as a pretty big change, especially for a PR that's nominally about deglobalization. I'm not opposed to including it here, but I just want to make sure that we've thought through all the implications and have made sure that this change is really only as significant as inclusion in a semi-related PR merits.\r\n\r\nDoes anyone have any historical notion of why we didn't have the block index hold values in the first place? For what it's worth, I'm definitely concept ACK on reducing CBlockIndex* usage.",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-27T19:54:21Z",
      "diff_hunk" : "@@ -3576,9 +3578,9 @@ bool BlockManager::LoadBlockIndex(\n     // Calculate nChainWork\n     std::vector<std::pair<int, CBlockIndex*> > vSortedByHeight;\n     vSortedByHeight.reserve(m_block_index.size());\n-    for (const std::pair<const uint256, CBlockIndex*>& item : m_block_index)\n+    for (std::pair<const uint256, CBlockIndex>& item : m_block_index)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r716998451",
      "id" : 716998451,
      "line" : 3581,
      "node_id" : "PRRC_kwDOABII584qvIcz",
      "original_commit_id" : "b48d7c010f644ed01e310ea4ab590580640a16b7",
      "original_line" : 3581,
      "original_position" : 148,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 506,
      "pull_request_review_id" : 759168474,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/716998451/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-28T14:37:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/716998451",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r717628411"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/717628411"
         }
      },
      "author_association" : "MEMBER",
      "body" : "https://github.com/bitcoin/bitcoin/pull/22564/commits/3de7842f50c44e6bed675048737e19a1d8ca5fa4\r\n\r\nThis is most easily reviewed with `--color-move=dimmed_zebra`.\r\n\r\nGiven that init reordering is notoriously tricky, we should probably be sure to test invocation of `bitcoind` with each flag that was moved here.",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-28T14:19:33Z",
      "diff_hunk" : "@@ -1211,114 +1211,14 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     assert(!node.connman);\n     node.connman = std::make_unique<CConnman>(GetRand(std::numeric_limits<uint64_t>::max()), GetRand(std::numeric_limits<uint64_t>::max()), *node.addrman, args.GetBoolArg(\"-networkactive\", true));\n \n+    // ********************************************************* Step 7: load block chain",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r717628411",
      "id" : 717628411,
      "line" : 1214,
      "node_id" : "PRRC_kwDOABII584qxiP7",
      "original_commit_id" : "3de7842f50c44e6bed675048737e19a1d8ca5fa4",
      "original_line" : 1214,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 4,
      "pull_request_review_id" : 759168474,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/717628411/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-28T14:37:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/717628411",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "For what it's worth, I benched this and there don't seem to be any significant performance implications to moving block index entries from `CBlockIndex` pointers to values.\r\n\r\n---\r\n\r\n\r\n|          bench name           |                                                                                                     command                                                                                                      |\r\n|-------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\r\n| ibd.local.range.500000.540000 | `bitcoind -dbcache=10000 -debug=coindb -debug=bench -listen=0 -connect=0 -addnode=127.0.0.1:8888 -prune=9999999 -printtoconsole=0 -assumevalid=000000000000000000176c192f42ad13ab159fdb20198b87e7ba3c001e47b876` |\r\n\r\n\r\n\r\n#### #22564 vs. $mergebase (absolute)\r\n|                  bench name                   |  x  |           #22564           |         $mergebase         |\r\n|-----------------------------------------------|----:|----------------------------|----------------------------|\r\n| ibd.local.range.500000.540000.total_secs      |   2 | 3122.0459 ( 10.1604)      | 3127.1493 ( 4.1510)       |\r\n| ibd.local.range.500000.540000.peak_rss_KiB    |   2 | 6345706.0000 ( 3578.0000) | 6356022.0000 ( 2906.0000) |\r\n| ibd.local.range.500000.540000.cpu_kernel_secs |   2 | 264.0400 ( 0.7700)        | 266.6600 ( 1.8000)        |\r\n| ibd.local.range.500000.540000.cpu_user_secs   |   2 | 13185.5400 ( 4.5500)      | 13150.5350 ( 14.1950)     |\r\n\r\n\r\n#### #22564 vs. $mergebase (relative)\r\n|                  bench name                   |  x  | #22564 | $mergebase |\r\n|-----------------------------------------------|----:|-------:|-----------:|\r\n| ibd.local.range.500000.540000.total_secs      |   2 |   1.00 |      1.002 |\r\n| ibd.local.range.500000.540000.peak_rss_KiB    |   2 |   1.00 |      1.002 |\r\n| ibd.local.range.500000.540000.cpu_kernel_secs |   2 |   1.00 |      1.010 |\r\n| ibd.local.range.500000.540000.cpu_user_secs   |   2 |   1.00 |      1.000 |\r\n",
      "created_at" : "2021-09-29T17:20:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-930377301",
      "id" : 930377301,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII5843dG5V",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-29T17:20:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/930377301",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723625367"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723625367"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> we're potentially introducing a lot of CBlockIndex value copying (vs. the pointers)\r\n\r\nI don't think we're introducing value copying because we're iterating with `std::pair<...>&`, but perhaps there's something I'm missing? When I asked him about it, ryanofsky also pointed out that the const reference was actually more dangerous since it could have created copies through implicit conversion.",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-10-06T19:48:15Z",
      "diff_hunk" : "@@ -3576,9 +3578,9 @@ bool BlockManager::LoadBlockIndex(\n     // Calculate nChainWork\n     std::vector<std::pair<int, CBlockIndex*> > vSortedByHeight;\n     vSortedByHeight.reserve(m_block_index.size());\n-    for (const std::pair<const uint256, CBlockIndex*>& item : m_block_index)\n+    for (std::pair<const uint256, CBlockIndex>& item : m_block_index)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723625367",
      "id" : 723625367,
      "in_reply_to_id" : 716998451,
      "line" : 3581,
      "node_id" : "PRRC_kwDOABII584rIaWX",
      "original_commit_id" : "b48d7c010f644ed01e310ea4ab590580640a16b7",
      "original_line" : 3581,
      "original_position" : 148,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 506,
      "pull_request_review_id" : 773159595,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723625367/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-06T19:48:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723625367",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723625689"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723625689"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, I think I'm going to work a bit more on this commit to see if I can make it more easily reviewable.",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-10-06T19:48:46Z",
      "diff_hunk" : "@@ -1211,114 +1211,14 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     assert(!node.connman);\n     node.connman = std::make_unique<CConnman>(GetRand(std::numeric_limits<uint64_t>::max()), GetRand(std::numeric_limits<uint64_t>::max()), *node.addrman, args.GetBoolArg(\"-networkactive\", true));\n \n+    // ********************************************************* Step 7: load block chain",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723625689",
      "id" : 723625689,
      "in_reply_to_id" : 717628411,
      "line" : 1214,
      "node_id" : "PRRC_kwDOABII584rIabZ",
      "original_commit_id" : "3de7842f50c44e6bed675048737e19a1d8ca5fa4",
      "original_line" : 1214,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 4,
      "pull_request_review_id" : 773160034,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723625689/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-06T19:48:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723625689",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723787975"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723787975"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Good idea, added in e78b6e5105",
      "commit_id" : "5b723331601fa09376a4d4c4452d8455bc174cdb",
      "created_at" : "2021-10-07T01:40:54Z",
      "diff_hunk" : "@@ -430,6 +427,11 @@ class BlockManager\n       */\n     std::set<CBlockIndex*> m_failed_blocks;\n \n+    CBlockIndex* pindexBestInvalid = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723787975",
      "id" : 723787975,
      "in_reply_to_id" : 712573048,
      "line" : 428,
      "node_id" : "PRRC_kwDOABII584rJCDH",
      "original_commit_id" : "3ea18162a4d729db720ca14ff8363f539d375ab3",
      "original_line" : 428,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 43,
      "pull_request_review_id" : 773366135,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723787975/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-07T01:40:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723787975",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723788163"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723788163"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "True! Fixed in f99156b575!",
      "commit_id" : "5b723331601fa09376a4d4c4452d8455bc174cdb",
      "created_at" : "2021-10-07T01:41:17Z",
      "diff_hunk" : "@@ -233,7 +227,7 @@ fs::path GetBlockPosFilename(const FlatFilePos& pos)\n     return BlockFileSeq().FileName(pos);\n }\n \n-bool FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigned int nHeight, CChain& active_chain, uint64_t nTime, bool fKnown = false)\n+bool BlockManager::FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigned int nHeight, CChain& active_chain, uint64_t nTime, bool fKnown = false)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723788163",
      "id" : 723788163,
      "in_reply_to_id" : 712598917,
      "line" : 219,
      "node_id" : "PRRC_kwDOABII584rJCGD",
      "original_commit_id" : "fa455c0339561ca19a3edd6b249be962ae87194d",
      "original_line" : 219,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : 85,
      "pull_request_review_id" : 773366539,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723788163/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-07T01:41:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723788163",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723788218"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723788218"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done! f5ad3509dc",
      "commit_id" : "5b723331601fa09376a4d4c4452d8455bc174cdb",
      "created_at" : "2021-10-07T01:41:31Z",
      "diff_hunk" : "@@ -51,6 +51,8 @@ struct BIP9Stats {\n     bool possible;\n };\n \n+class VersionBitsCache;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723788218",
      "id" : 723788218,
      "in_reply_to_id" : 716945997,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rJCG6",
      "original_commit_id" : "17f227f6d44bb417d0c6540e081d4d374bece6a7",
      "original_line" : 54,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/versionbits.h",
      "position" : null,
      "pull_request_review_id" : 773366616,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723788218/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-07T01:41:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723788218",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723788315"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723788315"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Hehe that's an artifact from me experimenting. Changed in 5bab523f31!",
      "commit_id" : "5b723331601fa09376a4d4c4452d8455bc174cdb",
      "created_at" : "2021-10-07T01:41:52Z",
      "diff_hunk" : "@@ -2800,20 +2800,21 @@ CBlockIndex* BlockManager::AddToBlockIndex(const CBlockHeader& block)\n     uint256 hash = block.GetHash();\n     BlockMap::iterator it = m_block_index.find(hash);\n     if (it != m_block_index.end())\n-        return it->second;\n+        return &it->second;\n \n     // Construct new block index object\n-    CBlockIndex* pindexNew = new CBlockIndex(block);\n+    CBlockIndex neue(block);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723788315",
      "id" : 723788315,
      "in_reply_to_id" : 716987095,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rJCIb",
      "original_commit_id" : "b48d7c010f644ed01e310ea4ab590580640a16b7",
      "original_line" : 2806,
      "original_position" : 80,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 773366740,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723788315/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-07T01:41:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723788315",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed 71bacd9 -> e78b6e5:\r\n- Addressed https://github.com/bitcoin/bitcoin/pull/22564#discussion_r712573048\r\n- Addressed https://github.com/bitcoin/bitcoin/pull/22564#discussion_r712598917\r\n- Addressed https://github.com/bitcoin/bitcoin/pull/22564#discussion_r716945997\r\n- Addressed https://github.com/bitcoin/bitcoin/pull/22564#discussion_r716987095\r\n\r\n",
      "created_at" : "2021-10-07T01:52:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-937379956",
      "id" : 937379956,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII584330h0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/937379956/reactions"
      },
      "updated_at" : "2021-10-07T01:52:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/937379956",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed e78b6e5 -> 5b72333:\r\n- Rebased over master",
      "created_at" : "2021-10-07T01:59:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-937382271",
      "id" : 937382271,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII584331F_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/937382271/reactions"
      },
      "updated_at" : "2021-10-07T01:59:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/937382271",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed 5b72333 -> 148bf14\r\n- Added `CBlockUndo` forward declaration\r\n- Made intermediate commits comply with lock annotations by adding `GUARDED_BY` annotations to `extern` declarations and fixing up code",
      "created_at" : "2021-10-08T22:16:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-939145083",
      "id" : 939145083,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII5843-jd7",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/939145083/reactions"
      },
      "updated_at" : "2021-10-08T22:16:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/939145083",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed 148bf148e198027b25894df429dd13b9ca9f60a1 -> 0898078ed59453cc850ebe08010e68e6dea51dbd:\r\n- Only move the `PeerManager` construction in \"init: Reset mempool and chainman via reconstruction\" so that it's more easily reviewable.",
      "created_at" : "2021-10-09T00:39:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-939192113",
      "id" : 939192113,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII5843-u8x",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/939192113/reactions"
      },
      "updated_at" : "2021-10-09T00:39:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/939192113",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-12-13T23:18:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-993000048",
      "id" : 993000048,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII5847L_pw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/993000048/reactions"
      },
      "updated_at" : "2021-12-13T23:18:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/993000048",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--13523179cfe9479db18ec6c5d236f789-->There hasn't been much activity lately and the patch still needs rebase. What is the status here?\r\n\r\n* Is it still relevant?  Please solve the conflicts to make it ready for review and to ensure the CI passes.\r\n* Is it no longer relevant?  Please close.\r\n* Did the author lose interest or time to work on this?  Please close it and mark it 'Up for grabs' with the label, so that it can be picked up in the future.\r\n",
      "created_at" : "2022-01-03T09:12:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1003956534",
      "id" : 1003956534,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII58471yk2",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1003956534/reactions"
      },
      "updated_at" : "2022-01-03T09:12:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1003956534",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Going to update this soon, @MarcoFalke would it make sense to rebase this on top of your #23974?",
      "created_at" : "2022-01-05T17:06:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1005909065",
      "id" : 1005909065,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII58479PRJ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1005909065/reactions"
      },
      "updated_at" : "2022-01-05T17:06:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1005909065",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Oh, apologies I missed that you (partly?) already did #23974 in here. I don't have a preference on how to proceed. Let me know if I should close my pull or something else.",
      "created_at" : "2022-01-05T18:37:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1005980794",
      "id" : 1005980794,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII58479gx6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1005980794/reactions"
      },
      "updated_at" : "2022-01-05T18:37:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1005980794",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Oh, apologies I missed that you (partly?) already did #23974 in here. I don't have a preference on how to proceed. Let me know if I should close my pull or something else.\r\n\r\nOh, I knew this code looked familiar and couldn't remember where I made these comments before. IMO, #23974 is really easy to understand, and already up to date, and this PR would ultimately be simpler rebased on top of #23974. But I'm not sure if it would significant extra work to do that, so I don't really have an informed opinion about merge order. Will ACK #23974 in any case",
      "created_at" : "2022-01-05T19:14:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1006005733",
      "id" : 1006005733,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII58479m3l",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1006005733/reactions"
      },
      "updated_at" : "2022-01-05T19:14:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1006005733",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   }
]
