[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#23578](https://github.com/bitcoin/bitcoin/pull/23578) (Add external signer taproot support by Sjors)\n* [#23502](https://github.com/bitcoin/bitcoin/pull/23502) (wallet: Avoid underpaying transaction fees when signing taproot spends by achow101)\n* [#21283](https://github.com/bitcoin/bitcoin/pull/21283) (Implement BIP 370 PSBTv2 by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-07-27T12:28:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-887470431",
      "id" : 887470431,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII58405blf",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/887470431/reactions"
      },
      "updated_at" : "2022-06-28T09:07:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/887470431",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept and Approach ACK. I was experimenting with a basic taproot n-of-m multisig using a single OP_CHECKSIGADD based script on top of this branch. Taproot fields in the PSBTs I was creating (and attempting to sign - although I haven't got that working yet) looked good when I inspected them. I did some very light testing of this, mostly sanity checks",
      "created_at" : "2021-09-01T14:24:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-910337349",
      "id" : 910337349,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII5842QqVF",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-01T14:24:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/910337349",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7217256?v=4",
         "events_url" : "https://api.github.com/users/mjdietzx/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mjdietzx/followers",
         "following_url" : "https://api.github.com/users/mjdietzx/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mjdietzx/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mjdietzx",
         "id" : 7217256,
         "login" : "mjdietzx",
         "node_id" : "MDQ6VXNlcjcyMTcyNTY=",
         "organizations_url" : "https://api.github.com/users/mjdietzx/orgs",
         "received_events_url" : "https://api.github.com/users/mjdietzx/received_events",
         "repos_url" : "https://api.github.com/users/mjdietzx/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mjdietzx/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mjdietzx/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mjdietzx"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Needs rebase due to silent merge conflict in `descriptor.cpp`.",
      "created_at" : "2021-11-22T15:53:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-975665627",
      "id" : 975665627,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII5846J3nb",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/975665627/reactions"
      },
      "updated_at" : "2021-11-22T15:53:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/975665627",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r762515005"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762515005"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`keypath` is ambiguous, maybe call this `m_tap_bip32_paths`?\r\n\r\nAlso, maybe add a comment above these new entries that refers to BIP 341.",
      "commit_id" : "58af8917bd80b0a918df1a5d38c4b63beae5306f",
      "created_at" : "2021-12-05T05:59:25Z",
      "diff_hunk" : "@@ -56,6 +65,12 @@ struct PSBTInput\n     CScriptWitness final_script_witness;\n     std::map<CPubKey, KeyOriginInfo> hd_keypaths;\n     std::map<CKeyID, SigPair> partial_sigs;\n+    std::vector<unsigned char> m_tap_key_sig;\n+    std::map<std::pair<XOnlyPubKey, uint256>, std::vector<unsigned char>> m_tap_script_sigs;\n+    std::map<std::pair<CScript, int>, std::set<std::vector<unsigned char>, ShortestVectorFirstComparator>> m_tap_scripts;\n+    std::map<XOnlyPubKey, std::pair<std::set<uint256>, KeyOriginInfo>> m_tap_keypaths;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r762515005",
      "id" : 762515005,
      "line" : 71,
      "node_id" : "PRRC_kwDOABII584tcw49",
      "original_commit_id" : "64dc0962d3644df0d6abf39ec4c8987eaef714e8",
      "original_line" : 71,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/psbt.h",
      "position" : 28,
      "pull_request_review_id" : 823352236,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762515005/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-05T06:54:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762515005",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r762516314"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762516314"
         }
      },
      "author_association" : "MEMBER",
      "body" : "57622204c81628f790a5355d2f7197d8ed23ebc1 : worth documenting that \"misc\" may include the inner key (with an empty set of hashes).",
      "commit_id" : "58af8917bd80b0a918df1a5d38c4b63beae5306f",
      "created_at" : "2021-12-05T06:17:02Z",
      "diff_hunk" : "@@ -74,6 +74,7 @@ struct SignatureData {\n     std::map<CKeyID, std::pair<CPubKey, KeyOriginInfo>> misc_pubkeys;\n     std::vector<unsigned char> taproot_key_path_sig; /// Schnorr signature for key path spending\n     std::map<std::pair<XOnlyPubKey, uint256>, std::vector<unsigned char>> taproot_script_sigs; ///< (Partial) schnorr signatures, indexed by XOnlyPubKey and leaf_hash.\n+    std::map<XOnlyPubKey, std::pair<std::set<uint256>, KeyOriginInfo>> taproot_misc_pubkeys;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r762516314",
      "id" : 762516314,
      "line" : 79,
      "node_id" : "PRRC_kwDOABII584tcxNa",
      "original_commit_id" : "57622204c81628f790a5355d2f7197d8ed23ebc1",
      "original_line" : 77,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/script/sign.h",
      "position" : 15,
      "pull_request_review_id" : 823352236,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762516314/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-05T06:54:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762516314",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r762517693"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762517693"
         }
      },
      "author_association" : "MEMBER",
      "body" : "48d5949aa94410b12263df9b7a3cbc4d7cd50b6f: having a fully decoded example in a functional test case would be handy ",
      "commit_id" : "58af8917bd80b0a918df1a5d38c4b63beae5306f",
      "created_at" : "2021-12-05T06:35:13Z",
      "diff_hunk" : "@@ -1081,6 +1081,43 @@ static RPCHelpMan decodepsbt()\n                                 {\n                                     {RPCResult::Type::STR_HEX, \"\", \"hex-encoded witness data (if any)\"},\n                                 }},\n+                                {RPCResult::Type::STR_HEX, \"taproot_key_path_sig\", /* optional */ true, \"hex-encoded signature for the Taproot key path spend\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r762517693",
      "id" : 762517693,
      "line" : 1084,
      "node_id" : "PRRC_kwDOABII584tcxi9",
      "original_commit_id" : "48d5949aa94410b12263df9b7a3cbc4d7cd50b6f",
      "original_line" : 1084,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 4,
      "pull_request_review_id" : 823352236,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762517693/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-05T06:54:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762517693",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r762518011"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762518011"
         }
      },
      "author_association" : "MEMBER",
      "body" : "833ecb8dec1a10e3bc1b8d5bcaf0b6839277f582 \"later\" -> \"in FillPSBT\"?",
      "commit_id" : "58af8917bd80b0a918df1a5d38c4b63beae5306f",
      "created_at" : "2021-12-05T06:39:29Z",
      "diff_hunk" : "@@ -357,10 +357,10 @@ bool SignPSBTInput(const SigningProvider& provider, PartiallySignedTransaction&\n     input.FromSignatureData(sigdata);\n \n     // If we have a witness signature, put a witness UTXO.\n-    // TODO: For segwit v1, we should remove the non_witness_utxo\n     if (sigdata.witness) {\n         input.witness_utxo = utxo;\n-        // input.non_witness_utxo = nullptr;\n+        // We can remove the non_witness_utxo if and only if there are no non-segwit or segwit v0\n+        // inputs in this transaction, so we can deal with this later.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r762518011",
      "id" : 762518011,
      "line" : 371,
      "node_id" : "PRRC_kwDOABII584tcxn7",
      "original_commit_id" : "833ecb8dec1a10e3bc1b8d5bcaf0b6839277f582",
      "original_line" : 363,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/psbt.cpp",
      "position" : 145,
      "pull_request_review_id" : 823352236,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762518011/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-05T06:54:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762518011",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r762518268"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762518268"
         }
      },
      "author_association" : "MEMBER",
      "body" : "833ecb8dec1a10e3bc1b8d5bcaf0b6839277f582: `non_witness_utxos` (also below)\r\n\r\nDon't do this for `SIGHASH_SINGLE` and `SIGNHASH_ANYONECANPAY`, since new non-taproot inputs might be added later? Or should whoever adds such an input just add them back in? Maybe add a functional test for this. ",
      "commit_id" : "58af8917bd80b0a918df1a5d38c4b63beae5306f",
      "created_at" : "2021-12-05T06:42:12Z",
      "diff_hunk" : "@@ -1894,6 +1894,30 @@ TransactionError CWallet::FillPSBT(PartiallySignedTransaction& psbtx, bool& comp\n         }\n     }\n \n+    // Figure out if any witness_utxos should be dropped",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r762518268",
      "id" : 762518268,
      "line" : 1897,
      "node_id" : "PRRC_kwDOABII584tcxr8",
      "original_commit_id" : "833ecb8dec1a10e3bc1b8d5bcaf0b6839277f582",
      "original_line" : 1897,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 22,
      "pull_request_review_id" : 823352236,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762518268/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-05T06:54:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762518268",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r762518840"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762518840"
         }
      },
      "author_association" : "MEMBER",
      "body" : "833ecb8dec1a10e3bc1b8d5bcaf0b6839277f582: maybe only do this if there actually _is_ a `non_witness_utxo`? Otherwise you might as well use a `go_drop` bool and loop over all inputs after this loop. Then you also wouldn't need to track the index.",
      "commit_id" : "58af8917bd80b0a918df1a5d38c4b63beae5306f",
      "created_at" : "2021-12-05T06:49:34Z",
      "diff_hunk" : "@@ -1894,6 +1894,30 @@ TransactionError CWallet::FillPSBT(PartiallySignedTransaction& psbtx, bool& comp\n         }\n     }\n \n+    // Figure out if any witness_utxos should be dropped\n+    std::vector<unsigned int> to_drop;\n+    for (unsigned int i = 0; i < psbtx.inputs.size(); ++i) {\n+        const auto& input = psbtx.inputs.at(i);\n+        int wit_ver;\n+        std::vector<unsigned char> wit_prog;\n+        if (input.witness_utxo.IsNull() || !input.witness_utxo.scriptPubKey.IsWitnessProgram(wit_ver, wit_prog)) {\n+            // There's a non-segwit input or Segwit v0, so we cannot drop any witness_utxos\n+            to_drop.clear();\n+            break;\n+        }\n+        if (wit_ver == 0) {\n+            // Segwit v0, so we cannot drop any witness_utxos\n+            to_drop.clear();\n+            break;\n+        }\n+        to_drop.push_back(i);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r762518840",
      "id" : 762518840,
      "line" : 1913,
      "node_id" : "PRRC_kwDOABII584tcx04",
      "original_commit_id" : "833ecb8dec1a10e3bc1b8d5bcaf0b6839277f582",
      "original_line" : 1913,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 38,
      "pull_request_review_id" : 823352236,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762518840/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-05T06:54:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762518840",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r762519033"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762519033"
         }
      },
      "author_association" : "MEMBER",
      "body" : "9b86c58d95539056981c2a04a7345b992b1ce70c: this seems like a bug fix, is there a test you could add that demonstrates this?",
      "commit_id" : "58af8917bd80b0a918df1a5d38c4b63beae5306f",
      "created_at" : "2021-12-05T06:52:16Z",
      "diff_hunk" : "@@ -149,6 +149,7 @@ static bool CreateTaprootScriptSig(const BaseSignatureCreator& creator, Signatur\n     auto it = sigdata.taproot_script_sigs.find(lookup_key);\n     if (it != sigdata.taproot_script_sigs.end()) {\n         sig_out = it->second;\n+        return true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r762519033",
      "id" : 762519033,
      "line" : 152,
      "node_id" : "PRRC_kwDOABII584tcx35",
      "original_commit_id" : "9b86c58d95539056981c2a04a7345b992b1ce70c",
      "original_line" : 152,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/script/sign.cpp",
      "position" : 4,
      "pull_request_review_id" : 823352236,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762519033/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-05T06:54:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/762519033",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763325503"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763325503"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Is there not? There are tests added which check for the presence of the taproot fields in psbts spending taproot inputs.",
      "commit_id" : "0d63ac5e89dc748d11dd37d69da3824ea66fa925",
      "created_at" : "2021-12-06T19:42:56Z",
      "diff_hunk" : "@@ -1081,6 +1081,43 @@ static RPCHelpMan decodepsbt()\n                                 {\n                                     {RPCResult::Type::STR_HEX, \"\", \"hex-encoded witness data (if any)\"},\n                                 }},\n+                                {RPCResult::Type::STR_HEX, \"taproot_key_path_sig\", /* optional */ true, \"hex-encoded signature for the Taproot key path spend\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763325503",
      "id" : 763325503,
      "in_reply_to_id" : 762517693,
      "line" : 1088,
      "node_id" : "PRRC_kwDOABII584tf2w_",
      "original_commit_id" : "48d5949aa94410b12263df9b7a3cbc4d7cd50b6f",
      "original_line" : 1088,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 13,
      "pull_request_review_id" : 824391405,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763325503/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-06T19:42:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763325503",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "In order to make this more testable, would it make sense to add support for OP_CHECKSIGADD-based multisig to descriptors first?",
      "created_at" : "2021-12-06T19:46:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-987125125",
      "id" : 987125125,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII58461lWF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/987125125/reactions"
      },
      "updated_at" : "2021-12-06T19:46:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/987125125",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> In order to make this more testable, would it make sense to add support for OP_CHECKSIGADD-based multisig to descriptors first?\r\n\r\nI think it is fine without those.",
      "created_at" : "2021-12-06T19:58:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-987138014",
      "id" : 987138014,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII58461ofe",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/987138014/reactions"
      },
      "updated_at" : "2021-12-06T19:58:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/987138014",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763341169"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763341169"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The existing tests already cover this case (try reverting this commit, the tests will fail).",
      "commit_id" : "0d63ac5e89dc748d11dd37d69da3824ea66fa925",
      "created_at" : "2021-12-06T19:59:46Z",
      "diff_hunk" : "@@ -149,6 +149,7 @@ static bool CreateTaprootScriptSig(const BaseSignatureCreator& creator, Signatur\n     auto it = sigdata.taproot_script_sigs.find(lookup_key);\n     if (it != sigdata.taproot_script_sigs.end()) {\n         sig_out = it->second;\n+        return true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763341169",
      "id" : 763341169,
      "in_reply_to_id" : 762519033,
      "line" : 152,
      "node_id" : "PRRC_kwDOABII584tf6lx",
      "original_commit_id" : "9b86c58d95539056981c2a04a7345b992b1ce70c",
      "original_line" : 152,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/script/sign.cpp",
      "position" : 4,
      "pull_request_review_id" : 824410937,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763341169/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-06T19:59:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763341169",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763373397"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763373397"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "0d63ac5e89dc748d11dd37d69da3824ea66fa925",
      "created_at" : "2021-12-06T20:40:35Z",
      "diff_hunk" : "@@ -56,6 +65,12 @@ struct PSBTInput\n     CScriptWitness final_script_witness;\n     std::map<CPubKey, KeyOriginInfo> hd_keypaths;\n     std::map<CKeyID, SigPair> partial_sigs;\n+    std::vector<unsigned char> m_tap_key_sig;\n+    std::map<std::pair<XOnlyPubKey, uint256>, std::vector<unsigned char>> m_tap_script_sigs;\n+    std::map<std::pair<CScript, int>, std::set<std::vector<unsigned char>, ShortestVectorFirstComparator>> m_tap_scripts;\n+    std::map<XOnlyPubKey, std::pair<std::set<uint256>, KeyOriginInfo>> m_tap_keypaths;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763373397",
      "id" : 763373397,
      "in_reply_to_id" : 762515005,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584tgCdV",
      "original_commit_id" : "64dc0962d3644df0d6abf39ec4c8987eaef714e8",
      "original_line" : 71,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/psbt.h",
      "position" : null,
      "pull_request_review_id" : 824452462,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763373397/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-06T20:40:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763373397",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763373485"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763373485"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Added some docs for this",
      "commit_id" : "0d63ac5e89dc748d11dd37d69da3824ea66fa925",
      "created_at" : "2021-12-06T20:40:43Z",
      "diff_hunk" : "@@ -74,6 +74,7 @@ struct SignatureData {\n     std::map<CKeyID, std::pair<CPubKey, KeyOriginInfo>> misc_pubkeys;\n     std::vector<unsigned char> taproot_key_path_sig; /// Schnorr signature for key path spending\n     std::map<std::pair<XOnlyPubKey, uint256>, std::vector<unsigned char>> taproot_script_sigs; ///< (Partial) schnorr signatures, indexed by XOnlyPubKey and leaf_hash.\n+    std::map<XOnlyPubKey, std::pair<std::set<uint256>, KeyOriginInfo>> taproot_misc_pubkeys;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763373485",
      "id" : 763373485,
      "in_reply_to_id" : 762516314,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584tgCet",
      "original_commit_id" : "57622204c81628f790a5355d2f7197d8ed23ebc1",
      "original_line" : 79,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/script/sign.h",
      "position" : null,
      "pull_request_review_id" : 824452583,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763373485/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-06T20:40:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763373485",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763373570"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763373570"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "0d63ac5e89dc748d11dd37d69da3824ea66fa925",
      "created_at" : "2021-12-06T20:40:51Z",
      "diff_hunk" : "@@ -357,10 +357,10 @@ bool SignPSBTInput(const SigningProvider& provider, PartiallySignedTransaction&\n     input.FromSignatureData(sigdata);\n \n     // If we have a witness signature, put a witness UTXO.\n-    // TODO: For segwit v1, we should remove the non_witness_utxo\n     if (sigdata.witness) {\n         input.witness_utxo = utxo;\n-        // input.non_witness_utxo = nullptr;\n+        // We can remove the non_witness_utxo if and only if there are no non-segwit or segwit v0\n+        // inputs in this transaction, so we can deal with this later.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763373570",
      "id" : 763373570,
      "in_reply_to_id" : 762518011,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584tgCgC",
      "original_commit_id" : "833ecb8dec1a10e3bc1b8d5bcaf0b6839277f582",
      "original_line" : 371,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/psbt.cpp",
      "position" : null,
      "pull_request_review_id" : 824452700,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763373570/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-06T20:40:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763373570",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763373756"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763373756"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It only matters for `SIGHASH_ANYONECANPAY`. I've added a check for that.",
      "commit_id" : "0d63ac5e89dc748d11dd37d69da3824ea66fa925",
      "created_at" : "2021-12-06T20:41:11Z",
      "diff_hunk" : "@@ -1894,6 +1894,30 @@ TransactionError CWallet::FillPSBT(PartiallySignedTransaction& psbtx, bool& comp\n         }\n     }\n \n+    // Figure out if any witness_utxos should be dropped",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763373756",
      "id" : 763373756,
      "in_reply_to_id" : 762518268,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584tgCi8",
      "original_commit_id" : "833ecb8dec1a10e3bc1b8d5bcaf0b6839277f582",
      "original_line" : 1911,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 824453005,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763373756/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-06T20:41:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763373756",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763373809"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763373809"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "0d63ac5e89dc748d11dd37d69da3824ea66fa925",
      "created_at" : "2021-12-06T20:41:17Z",
      "diff_hunk" : "@@ -1894,6 +1894,30 @@ TransactionError CWallet::FillPSBT(PartiallySignedTransaction& psbtx, bool& comp\n         }\n     }\n \n+    // Figure out if any witness_utxos should be dropped\n+    std::vector<unsigned int> to_drop;\n+    for (unsigned int i = 0; i < psbtx.inputs.size(); ++i) {\n+        const auto& input = psbtx.inputs.at(i);\n+        int wit_ver;\n+        std::vector<unsigned char> wit_prog;\n+        if (input.witness_utxo.IsNull() || !input.witness_utxo.scriptPubKey.IsWitnessProgram(wit_ver, wit_prog)) {\n+            // There's a non-segwit input or Segwit v0, so we cannot drop any witness_utxos\n+            to_drop.clear();\n+            break;\n+        }\n+        if (wit_ver == 0) {\n+            // Segwit v0, so we cannot drop any witness_utxos\n+            to_drop.clear();\n+            break;\n+        }\n+        to_drop.push_back(i);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763373809",
      "id" : 763373809,
      "in_reply_to_id" : 762518840,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584tgCjx",
      "original_commit_id" : "833ecb8dec1a10e3bc1b8d5bcaf0b6839277f582",
      "original_line" : 1927,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 824453077,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763373809/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-06T20:41:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763373809",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763593027"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763593027"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I noticed the presence checking tests, though perhaps checking against the fully decoded result could reveal more subtle issues.",
      "commit_id" : "f662b0c4713a286b8a8983b60d912c2bd291df92",
      "created_at" : "2021-12-07T03:04:25Z",
      "diff_hunk" : "@@ -1081,6 +1081,43 @@ static RPCHelpMan decodepsbt()\n                                 {\n                                     {RPCResult::Type::STR_HEX, \"\", \"hex-encoded witness data (if any)\"},\n                                 }},\n+                                {RPCResult::Type::STR_HEX, \"taproot_key_path_sig\", /* optional */ true, \"hex-encoded signature for the Taproot key path spend\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763593027",
      "id" : 763593027,
      "in_reply_to_id" : 762517693,
      "line" : 1088,
      "node_id" : "PRRC_kwDOABII584tg4FD",
      "original_commit_id" : "48d5949aa94410b12263df9b7a3cbc4d7cd50b6f",
      "original_line" : 1088,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 13,
      "pull_request_review_id" : 824725053,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763593027/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-07T03:04:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763593027",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763604873"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763604873"
         }
      },
      "author_association" : "MEMBER",
      "body" : "On your latest rebase f7b61d2, when I revert 9b86c58d95539056981c2a04a7345b992b1ce70c, then indeed `wallet_taproot.py` fails. Still, having the fix and test in the same commit would be much easier to folllow. Moving this bit from the test over to this commit does the trick:\r\n\r\n```patch\r\n-            res = self.psbt_offline.walletprocesspsbt(psbt)\r\n-            assert(res['complete'])\r\n+            res = self.psbt_offline.walletprocesspsbt(psbt=psbt, finalize=False)\r\n+\r\n+            // Check that pre-existing signatures in CreateTaprootScriptSig are actually used,\r\n+            // if a signature is found for the given key and leaf hash.\r\n+            decoded = self.psbt_offline.decodepsbt(res[\"psbt\"])\r\n```",
      "commit_id" : "f662b0c4713a286b8a8983b60d912c2bd291df92",
      "created_at" : "2021-12-07T03:41:56Z",
      "diff_hunk" : "@@ -149,6 +149,7 @@ static bool CreateTaprootScriptSig(const BaseSignatureCreator& creator, Signatur\n     auto it = sigdata.taproot_script_sigs.find(lookup_key);\n     if (it != sigdata.taproot_script_sigs.end()) {\n         sig_out = it->second;\n+        return true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763604873",
      "id" : 763604873,
      "in_reply_to_id" : 762519033,
      "line" : 152,
      "node_id" : "PRRC_kwDOABII584tg6-J",
      "original_commit_id" : "9b86c58d95539056981c2a04a7345b992b1ce70c",
      "original_line" : 152,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/script/sign.cpp",
      "position" : 4,
      "pull_request_review_id" : 824740257,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763604873/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-07T03:44:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763604873",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763610439"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763610439"
         }
      },
      "author_association" : "MEMBER",
      "body" : "11c1e17fd622e962d9d3987322a2b51b3181a1db : this is set, but otherwise unused.",
      "commit_id" : "f662b0c4713a286b8a8983b60d912c2bd291df92",
      "created_at" : "2021-12-07T03:59:51Z",
      "diff_hunk" : "@@ -65,6 +65,7 @@ typedef std::pair<CPubKey, std::vector<unsigned char>> SigPair;\n struct SignatureData {\n     bool complete = false; ///< Stores whether the scriptSig and scriptWitness are complete\n     bool witness = false; ///< Stores whether the input this SigData corresponds to is a witness input\n+    TxoutType spk_type = TxoutType::NONSTANDARD; ///< Stores the type of scriptPubKey the input spends",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763610439",
      "id" : 763610439,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584tg8VH",
      "original_commit_id" : "11c1e17fd622e962d9d3987322a2b51b3181a1db",
      "original_line" : 68,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/script/sign.h",
      "position" : null,
      "pull_request_review_id" : 824746913,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763610439/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-07T04:00:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763610439",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763622296"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763622296"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I've moved the change that causes the test failure into the previous commit.\r\n\r\nThe test isn't for this bug specifically, so I don't think it needs any special mention. The test was written first, and it just so happens that it triggered this bug.",
      "commit_id" : "f662b0c4713a286b8a8983b60d912c2bd291df92",
      "created_at" : "2021-12-07T04:38:35Z",
      "diff_hunk" : "@@ -149,6 +149,7 @@ static bool CreateTaprootScriptSig(const BaseSignatureCreator& creator, Signatur\n     auto it = sigdata.taproot_script_sigs.find(lookup_key);\n     if (it != sigdata.taproot_script_sigs.end()) {\n         sig_out = it->second;\n+        return true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763622296",
      "id" : 763622296,
      "in_reply_to_id" : 762519033,
      "line" : 152,
      "node_id" : "PRRC_kwDOABII584tg_OY",
      "original_commit_id" : "9b86c58d95539056981c2a04a7345b992b1ce70c",
      "original_line" : 152,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/script/sign.cpp",
      "position" : 4,
      "pull_request_review_id" : 824762233,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763622296/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-07T04:39:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763622296",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763622318"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763622318"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Removed",
      "commit_id" : "f662b0c4713a286b8a8983b60d912c2bd291df92",
      "created_at" : "2021-12-07T04:38:41Z",
      "diff_hunk" : "@@ -65,6 +65,7 @@ typedef std::pair<CPubKey, std::vector<unsigned char>> SigPair;\n struct SignatureData {\n     bool complete = false; ///< Stores whether the scriptSig and scriptWitness are complete\n     bool witness = false; ///< Stores whether the input this SigData corresponds to is a witness input\n+    TxoutType spk_type = TxoutType::NONSTANDARD; ///< Stores the type of scriptPubKey the input spends",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r763622318",
      "id" : 763622318,
      "in_reply_to_id" : 763610439,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584tg_Ou",
      "original_commit_id" : "11c1e17fd622e962d9d3987322a2b51b3181a1db",
      "original_line" : 68,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/script/sign.h",
      "position" : null,
      "pull_request_review_id" : 824762265,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763622318/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-07T04:38:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/763622318",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "re-utACK 57d354a0d7ba99478eab1afc4304202a07ef4bf7",
      "created_at" : "2021-12-09T03:10:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-989467053",
      "id" : 989467053,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII5846-hGt",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989467053/reactions"
      },
      "updated_at" : "2021-12-09T03:10:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989467053",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-12-10T22:25:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-991345371",
      "id" : 991345371,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII5847Frrb",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/991345371/reactions"
      },
      "updated_at" : "2021-12-10T22:25:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/991345371",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "re-utACK 8a675a00053db4621f7f27cf22e8d65713dff03b",
      "created_at" : "2021-12-13T07:17:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-992175334",
      "id" : 992175334,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII5847I2Tm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/992175334/reactions"
      },
      "updated_at" : "2021-12-13T07:17:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/992175334",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-12-13T08:38:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-992228865",
      "id" : 992228865,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII5847JDYB",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/992228865/reactions"
      },
      "updated_at" : "2021-12-13T08:38:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/992228865",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK, Approach ACK.\r\n\r\nWill hopefully find the time to test with a hardware wallet, HWI (single sig PSBT as Taproot multisig descriptor [not yet merged](https://github.com/bitcoin/bitcoin/pull/24043)) and do a code review/comparison with the BIP.\r\n\r\nWould certainly be nice to get this in and PR author has added high priority label. [External projects](https://github.com/cryptoadvance/specter-desktop/issues/1506) are waiting on it.\r\n\r\nedit: What hardware wallets can I test this with? Testnet/Signet coins and new PSBT fields? Just Coldcard?",
      "created_at" : "2022-02-01T11:12:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1026730370",
      "id" : 1026730370,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII5849MqmC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1026730370/reactions"
      },
      "updated_at" : "2022-02-01T11:25:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1026730370",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> edit: What hardware wallets can I test this with?\r\n\r\n@michaelfolkson Trezor supports Taproot with HWI (master).",
      "created_at" : "2022-02-19T15:21:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1046041956",
      "id" : 1046041956,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584-WVVk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1046041956/reactions"
      },
      "updated_at" : "2022-02-19T15:21:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1046041956",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/42201?v=4",
         "events_url" : "https://api.github.com/users/prusnak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prusnak/followers",
         "following_url" : "https://api.github.com/users/prusnak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prusnak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prusnak",
         "id" : 42201,
         "login" : "prusnak",
         "node_id" : "MDQ6VXNlcjQyMjAx",
         "organizations_url" : "https://api.github.com/users/prusnak/orgs",
         "received_events_url" : "https://api.github.com/users/prusnak/received_events",
         "repos_url" : "https://api.github.com/users/prusnak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prusnak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prusnak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prusnak"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Shall we try to merge this in time for 23.0? @achow101 @laanwj @MarcoFalke ",
      "created_at" : "2022-02-19T15:22:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1046041994",
      "id" : 1046041994,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584-WVWK",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1046041994/reactions"
      },
      "updated_at" : "2022-02-19T15:22:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1046041994",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/42201?v=4",
         "events_url" : "https://api.github.com/users/prusnak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prusnak/followers",
         "following_url" : "https://api.github.com/users/prusnak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prusnak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prusnak",
         "id" : 42201,
         "login" : "prusnak",
         "node_id" : "MDQ6VXNlcjQyMjAx",
         "organizations_url" : "https://api.github.com/users/prusnak/orgs",
         "received_events_url" : "https://api.github.com/users/prusnak/received_events",
         "repos_url" : "https://api.github.com/users/prusnak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prusnak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prusnak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prusnak"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This can't be merged because it needs rebase for several weeks due to a silent conflict",
      "created_at" : "2022-02-19T15:47:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1046046539",
      "id" : 1046046539,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584-WWdL",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1046046539/reactions"
      },
      "updated_at" : "2022-02-19T15:47:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1046046539",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Don't know anything about the silent conflict but we are past the [feature freeze](https://github.com/bitcoin/bitcoin/issues/22969) of February 15th too. Hopefully we can get a bunch of new Taproot stuff (e.g. https://github.com/bitcoin/bitcoin/pull/24043) in 24.0.",
      "created_at" : "2022-02-19T16:14:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1046052183",
      "id" : 1046052183,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584-WX1X",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1046052183/reactions"
      },
      "updated_at" : "2022-02-19T16:14:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1046052183",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> we are past the [feature freeze](https://github.com/bitcoin/bitcoin/issues/22969) of February 15th too.\r\n\r\nACK",
      "created_at" : "2022-02-19T16:25:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1046054402",
      "id" : 1046054402,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584-WYYC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1046054402/reactions"
      },
      "updated_at" : "2022-02-19T16:25:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1046054402",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/42201?v=4",
         "events_url" : "https://api.github.com/users/prusnak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prusnak/followers",
         "following_url" : "https://api.github.com/users/prusnak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prusnak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prusnak",
         "id" : 42201,
         "login" : "prusnak",
         "node_id" : "MDQ6VXNlcjQyMjAx",
         "organizations_url" : "https://api.github.com/users/prusnak/orgs",
         "received_events_url" : "https://api.github.com/users/prusnak/received_events",
         "repos_url" : "https://api.github.com/users/prusnak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prusnak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prusnak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prusnak"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This also needs review from more people (I'll re-ACK the rebase once those arrive).",
      "created_at" : "2022-02-21T14:59:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1046965850",
      "id" : 1046965850,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584-Z25a",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1046965850/reactions"
      },
      "updated_at" : "2022-02-21T14:59:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1046965850",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Hopefully we can get a bunch of new Taproot stuff (e.g. #24043) in 24.0.\r\n\r\nLet's add this PR (#22558) and PR #24043 to the [`24.0` Milestone](https://github.com/bitcoin/bitcoin/milestone/54), so they receive enough eyes?",
      "created_at" : "2022-02-21T15:04:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1046970844",
      "id" : 1046970844,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584-Z4Hc",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1046970844/reactions"
      },
      "updated_at" : "2022-02-21T15:05:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1046970844",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/42201?v=4",
         "events_url" : "https://api.github.com/users/prusnak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prusnak/followers",
         "following_url" : "https://api.github.com/users/prusnak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prusnak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prusnak",
         "id" : 42201,
         "login" : "prusnak",
         "node_id" : "MDQ6VXNlcjQyMjAx",
         "organizations_url" : "https://api.github.com/users/prusnak/orgs",
         "received_events_url" : "https://api.github.com/users/prusnak/received_events",
         "repos_url" : "https://api.github.com/users/prusnak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prusnak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prusnak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prusnak"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Approach ACK",
      "created_at" : "2022-02-21T15:11:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1046978061",
      "id" : 1046978061,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584-Z54N",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1046978061/reactions"
      },
      "updated_at" : "2022-02-21T15:11:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1046978061",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/11212268?v=4",
         "events_url" : "https://api.github.com/users/gruve-p/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gruve-p/followers",
         "following_url" : "https://api.github.com/users/gruve-p/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gruve-p/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gruve-p",
         "id" : 11212268,
         "login" : "gruve-p",
         "node_id" : "MDQ6VXNlcjExMjEyMjY4",
         "organizations_url" : "https://api.github.com/users/gruve-p/orgs",
         "received_events_url" : "https://api.github.com/users/gruve-p/received_events",
         "repos_url" : "https://api.github.com/users/gruve-p/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gruve-p/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gruve-p/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gruve-p"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r817816205"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/817816205"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: would these sizes be useful extracted as constants?",
      "commit_id" : "b704884935766748cf533577c1babacfb6d4b5a5",
      "created_at" : "2022-03-02T15:37:42Z",
      "diff_hunk" : "@@ -489,6 +569,101 @@ struct PSBTInput\n                     hash256_preimages.emplace(hash, std::move(preimage));\n                     break;\n                 }\n+                case PSBT_IN_TAP_KEY_SIG:\n+                {\n+                    if (!key_lookup.emplace(key).second) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input Taproot key signature already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Input Taproot key signature key is more than one byte type\");\n+                    }\n+                    s >> m_tap_key_sig;\n+                    if (m_tap_key_sig.size() < 64) {\n+                        throw std::ios_base::failure(\"Input Taproot key path signature is shorter than 64 bytes\");\n+                    } else if (m_tap_key_sig.size() > 65) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r817816205",
      "id" : 817816205,
      "line" : 582,
      "node_id" : "PRRC_kwDOABII584wvuKN",
      "original_commit_id" : "b704884935766748cf533577c1babacfb6d4b5a5",
      "original_line" : 582,
      "original_position" : 170,
      "original_start_line" : null,
      "path" : "src/psbt.h",
      "position" : 170,
      "pull_request_review_id" : 897753508,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/817816205/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-02T15:37:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/817816205",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r817817480"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/817817480"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: some of these blocks are not strictly necessary, e.g. in this case.",
      "commit_id" : "b704884935766748cf533577c1babacfb6d4b5a5",
      "created_at" : "2022-03-02T15:38:51Z",
      "diff_hunk" : "@@ -625,6 +837,55 @@ struct PSBTOutput\n                     DeserializeHDKeypaths(s, key, hd_keypaths);\n                     break;\n                 }\n+                case PSBT_OUT_TAP_INTERNAL_KEY:\n+                {\n+                    if (!key_lookup.emplace(key).second) {\n+                        throw std::ios_base::failure(\"Duplicate Key, output Taproot internal key already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Output Taproot internal key key is more than one byte type\");\n+                    }\n+                    UnserializeFromVector(s, m_tap_internal_key);\n+                    break;\n+                }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r817817480",
      "id" : 817817480,
      "line" : 849,
      "node_id" : "PRRC_kwDOABII584wvueI",
      "original_commit_id" : "b704884935766748cf533577c1babacfb6d4b5a5",
      "original_line" : 849,
      "original_position" : 322,
      "original_start_line" : null,
      "path" : "src/psbt.h",
      "position" : 322,
      "pull_request_review_id" : 897755174,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/817817480/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-02T15:38:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/817817480",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK. Testing this now because HWI [isn't signing one of my taproot inputs](https://github.com/bitcoin-core/HWI/issues/585) :( ",
      "created_at" : "2022-03-03T19:33:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1058412608",
      "id" : 1058412608,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584_FhhA",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1058412608/reactions"
      },
      "updated_at" : "2022-03-03T19:33:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1058412608",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@achow101 I wonder if you're still open to modifications of BIP371.\r\n\r\nThinking about later integration with MuSig(2), I think it's somewhat unfortunate that the currently suggested PSBT_IN_TAP_BIP32_DERIVATION field conveys both (a) which keys are participating in which leaves and (b) how those are derived. Post-MuSig2, I expect that often keys will be present that aren't directly BIP32-derived, but are a MuSig* aggregate of BIP32-derived keys. It's not impossible to integrate that on top here, but it'd involve some duplication.\r\n\r\nMy suggestion would be to have these fields:\r\n* PSBT_IN_TAP_KEY_SIG: unmodified\r\n* PSBT_IN_TAP_SCRIPT_SIG: unmodified\r\n* PSBT_IN_TAP_LEAF_SCRIPT: unmodified\r\n* PSBT_IN_TAP_KEY_TWEAK: concatenation of PSBT_IN_TAP_INTERNAL_KEY and PSBT_IN_TAP_MERKLE_ROOT; it conveys \"the output key is a tweak of this key with this Merkle root\".\r\n* PSBT_IN_TAP_KEY_IN_SCRIPT: like PSBT_IN_TAP_BIP32_DERIVATION now, but without the BIP32 path; it just conveys \"this key occurs in these leaves\".\r\n* PSBT_IN_TAP_BIP32_DERIVATION: like PSBT_IN_TAP_BIP32_DERIVATION, but without the list of leaf hashes. It can be used for (a) the output key directly (b) the internal key (provided in PSBT_IN_TAP_KEY_TWEAK) of (c) a key occurring in a leaf script (provided by PSBT_IN_TAP_KEY_IN_SCRIPT).\r\n\r\nI'm also happy to take this to the ML if you think this deserves more discussion.\r\n\r\nPing @sanket1729 @darosior @jonasnick.\r\n",
      "created_at" : "2022-03-03T19:52:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1058426300",
      "id" : 1058426300,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584_Fk28",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1058426300/reactions"
      },
      "updated_at" : "2022-03-03T19:54:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1058426300",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I wonder if you're still open to modifications of BIP371.\n\nBIP 371 is already in use in production, notably by Ledger. So I think it might be too late for any modifications.\n\ncc @bigspider",
      "created_at" : "2022-03-03T20:01:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1058432968",
      "id" : 1058432968,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584_FmfI",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1058432968/reactions"
      },
      "updated_at" : "2022-03-03T20:01:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1058432968",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Ok, no reason to change things in that case.",
      "created_at" : "2022-03-03T20:26:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1058452156",
      "id" : 1058452156,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584_FrK8",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1058452156/reactions"
      },
      "updated_at" : "2022-03-03T20:26:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1058452156",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "tACK b704884935766748cf533577c1babacfb6d4b5a5\r\n\r\nWas able to get a mixed taproot keypath + wpkh spend working on HWI with this PR\r\n\r\nHaven't looked through the code that much, only tested behavior and I was happy with the result.",
      "created_at" : "2022-03-03T21:39:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1058519857",
      "id" : 1058519857,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584_F7sx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1058519857/reactions"
      },
      "updated_at" : "2022-03-03T21:44:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1058519857",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Thanks @achow101 for the ping.\r\nAt this time, since we only support BIP-86 addresses, the only taproot field we rely on is PSBT_IN_TAP_BIP32_DERIVATION, where we assume that the list of hashes is indeed empty (so the expected value is a single byte 0x00, followed by 4 bytes for the fingerprint, followed by the derivation steps. ",
      "created_at" : "2022-03-04T00:20:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1058693418",
      "id" : 1058693418,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584_GmEq",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1058693418/reactions"
      },
      "updated_at" : "2022-03-04T00:20:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1058693418",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6681844?v=4",
         "events_url" : "https://api.github.com/users/bigspider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bigspider/followers",
         "following_url" : "https://api.github.com/users/bigspider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bigspider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bigspider",
         "id" : 6681844,
         "login" : "bigspider",
         "node_id" : "MDQ6VXNlcjY2ODE4NDQ=",
         "organizations_url" : "https://api.github.com/users/bigspider/orgs",
         "received_events_url" : "https://api.github.com/users/bigspider/received_events",
         "repos_url" : "https://api.github.com/users/bigspider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bigspider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bigspider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bigspider"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> where we assume that the list of hashes is indeed empty\r\n\r\nSo it seems that @sipa's suggestion can be implemented in a compatible way that does not break your usage of PSBT_IN_TAP_BIP32_DERIVATION",
      "created_at" : "2022-03-04T07:59:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1058925064",
      "id" : 1058925064,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584_HeoI",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1058925064/reactions"
      },
      "updated_at" : "2022-03-04T07:59:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1058925064",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/42201?v=4",
         "events_url" : "https://api.github.com/users/prusnak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prusnak/followers",
         "following_url" : "https://api.github.com/users/prusnak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prusnak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prusnak",
         "id" : 42201,
         "login" : "prusnak",
         "node_id" : "MDQ6VXNlcjQyMjAx",
         "organizations_url" : "https://api.github.com/users/prusnak/orgs",
         "received_events_url" : "https://api.github.com/users/prusnak/received_events",
         "repos_url" : "https://api.github.com/users/prusnak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prusnak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prusnak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prusnak"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-03-04T13:31:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1059164985",
      "id" : 1059164985,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584_IZM5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1059164985/reactions"
      },
      "updated_at" : "2022-03-04T13:31:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1059164985",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Leaving the `0x00` would not break anything as I understand it.\r\nIf desired in order to have a clean standard, I suppose we can have a reasonable upgrade path by letting the next version of the app to skip the `0x00` if present and keeping this loose check for some time.",
      "created_at" : "2022-03-04T15:28:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1059262707",
      "id" : 1059262707,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584_IxDz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1059262707/reactions"
      },
      "updated_at" : "2022-03-04T15:28:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1059262707",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6681844?v=4",
         "events_url" : "https://api.github.com/users/bigspider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bigspider/followers",
         "following_url" : "https://api.github.com/users/bigspider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bigspider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bigspider",
         "id" : 6681844,
         "login" : "bigspider",
         "node_id" : "MDQ6VXNlcjY2ODE4NDQ=",
         "organizations_url" : "https://api.github.com/users/bigspider/orgs",
         "received_events_url" : "https://api.github.com/users/bigspider/received_events",
         "repos_url" : "https://api.github.com/users/bigspider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bigspider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bigspider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bigspider"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> ... I expect that often keys will be present that aren't directly BIP32-derived, but are a MuSig* aggregate of BIP32-derived keys\r\n\r\nI was thinking most keys would be BIP32 derived keys of a Musig2 aggregate like `musig2(A,B,C)/*` or BIP32 derived keys of a Musig2 aggregate of BIP32-derived keys, like `musig2(A/*, B/*, C/*)/*`? The case you mention seems like `musgi2(A/*, B/*, C/*)` \r\n",
      "created_at" : "2022-03-07T12:24:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1060633560",
      "id" : 1060633560,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584_N_vY",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1060633560/reactions"
      },
      "updated_at" : "2022-03-07T12:24:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1060633560",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6881849?v=4",
         "events_url" : "https://api.github.com/users/sanket1729/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sanket1729/followers",
         "following_url" : "https://api.github.com/users/sanket1729/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sanket1729/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sanket1729",
         "id" : 6881849,
         "login" : "sanket1729",
         "node_id" : "MDQ6VXNlcjY4ODE4NDk=",
         "organizations_url" : "https://api.github.com/users/sanket1729/orgs",
         "received_events_url" : "https://api.github.com/users/sanket1729/received_events",
         "repos_url" : "https://api.github.com/users/sanket1729/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sanket1729/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sanket1729/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sanket1729"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @achow101 I wonder if you're still open to modifications of BIP371.\r\n\r\nSeems like we're in multi threaded conversation territory here with discussion of possible BIP 371 changes and review of this PR as is. I've opened an issue (#24492) to discuss possible BIP 371 changes in case that helps.\r\n\r\n> I'm also happy to take this to the ML if you think this deserves more discussion.\r\n\r\nOr alternatively I'll close the issue and possible BIP 371 changes can be taken to the mailing list. I definitely think an email to the mailing list is a good idea once those proposed changes have been solidified.",
      "created_at" : "2022-03-07T12:43:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1060647780",
      "id" : 1060647780,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584_ODNk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1060647780/reactions"
      },
      "updated_at" : "2022-03-07T12:43:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1060647780",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Seems like we're in multi threaded conversation territory here with discussion of possible BIP 371 changes and review of this PR as is. I've opened an issue (https://github.com/bitcoin/bitcoin/issues/24492) to discuss possible BIP 371 changes in case that helps.\r\n\r\n@sipa's [proposed changes](https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1058426300) won't be made to BIP 371 due to uncertainty over whether other projects have already deployed. Closed the issue.",
      "created_at" : "2022-03-11T19:38:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1065430893",
      "id" : 1065430893,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584_gS9t",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1065430893/reactions"
      },
      "updated_at" : "2022-03-11T19:38:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1065430893",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "re-utACK 28868805bbf263d75cbd02eb7d510f1e343b979f",
      "created_at" : "2022-03-16T10:10:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1068950962",
      "id" : 1068950962,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII584_tuWy",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1068950962/reactions"
      },
      "updated_at" : "2022-03-16T10:10:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1068950962",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I'm currently testing this PR with/against our PSBT implementation in `lnd`.\r\nI was able to get a BIP86 key spend working :tada: \r\n\r\nBut I can't seem to get `bitcoind` to recognize and sign for a key spend path with a merkle root provided.\r\nPerhaps that's not the scope for this PR? If so then I apologize.\r\n\r\nAccording to my question and the answer I got [here](https://bitcoin.stackexchange.com/questions/113489/taproot-signing-with-psbt-how-to-determine-signing-method), it should be enough to set the following fields:\r\n\r\n```\r\n    {\r\n      \"witness_utxo\": {\r\n        \"amount\": 4.00000000,\r\n        \"scriptPubKey\": {\r\n          \"asm\": \"1 5a7730b9788468ac1b90baac80005da4965496e4d88bcbac95bd3c83cd906f3a\",\r\n          \"desc\": \"addr(bcrt1ptfmnpwtcs352cxush2kgqqza5jt9f9hymz9uhty4h57g8nvsduaq6s9ypp)#q562pd9u\",\r\n          \"hex\": \"51205a7730b9788468ac1b90baac80005da4965496e4d88bcbac95bd3c83cd906f3a\",\r\n          \"address\": \"bcrt1ptfmnpwtcs352cxush2kgqqza5jt9f9hymz9uhty4h57g8nvsduaq6s9ypp\",\r\n          \"type\": \"witness_v1_taproot\"\r\n        }\r\n      },\r\n      \"taproot_bip32_derivs\": [\r\n        {\r\n          \"pubkey\": \"63cc52f06e0a91e3e6456631aa070221d58ccd1ed8c5b6639d4f88786dcd500f\",\r\n          \"master_fingerprint\": \"00000000\",\r\n          \"path\": \"m/86'/0'/0'/0/0\",\r\n          \"leaf_hashes\": [\r\n          ]\r\n        }\r\n      ],\r\n      \"taproot_internal_key\": \"63cc52f06e0a91e3e6456631aa070221d58ccd1ed8c5b6639d4f88786dcd500f\",\r\n      \"taproot_merkle_root\": \"6c2e4bb01e316abaaee288d69c06cc608cedefd6e1a06813786c4ec51b6e1d38\"\r\n    }\r\n```\r\n\r\nFull PSBT:\r\n```\r\ncHNidP8BAHECAAAAAT/GF0O3okL4iQV80uYewSbhqa7qWoD2nG489WsPxw9xAAAAAAD/////AoCT3BQAAAAAFgAUKpx5R067Qv191nSkawzjIGJAQ+ri6PoCAAAAABYAFIyIwvqKctH/eWgjlieETO9w55xoAAAAAAABASsAhNcXAAAAACJRIFp3MLl4hGisG5C6rIAAXaSWVJbk2IvLrJW9PIPNkG86IRZjzFLwbgqR4+ZFZjGqBwIh1YzNHtjFtmOdT4h4bc1QDxkAAAAAAFYAAIAAAACAAAAAgAAAAAAAAAAAARcgY8xS8G4KkePmRWYxqgcCIdWMzR7YxbZjnU+IeG3NUA8BGCBsLkuwHjFquq7iiNacBsxgjO3v1uGgaBN4bE7FG24dOAAAIgICZ5Cr1jOOzCBlO+GZ+Y3VSYA26Z/kFrcSYqzM00TKPjQY1G/d61QAAIABAACAAAAAgAEAAAADAAAAAA==\r\n```\r\n\r\nBut when I use `bitcoin-cli walletprocesspsbt` with that PSBT (the private key is definitely in the wallet, it's the same key I used for the previous BIP86 key spend), then I just get the same PSBT and `\"complete\": false` back.\r\n\r\nIs this me doing something wrong or is this out of scope for this PR?",
      "created_at" : "2022-04-30T13:57:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1113993551",
      "id" : 1113993551,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII585CZjFP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1113993551/reactions"
      },
      "updated_at" : "2022-04-30T13:57:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1113993551",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008879?v=4",
         "events_url" : "https://api.github.com/users/guggero/events{/privacy}",
         "followers_url" : "https://api.github.com/users/guggero/followers",
         "following_url" : "https://api.github.com/users/guggero/following{/other_user}",
         "gists_url" : "https://api.github.com/users/guggero/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/guggero",
         "id" : 1008879,
         "login" : "guggero",
         "node_id" : "MDQ6VXNlcjEwMDg4Nzk=",
         "organizations_url" : "https://api.github.com/users/guggero/orgs",
         "received_events_url" : "https://api.github.com/users/guggero/received_events",
         "repos_url" : "https://api.github.com/users/guggero/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/guggero/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/guggero/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/guggero"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@guggero Are you using a legacy or a descriptor wallet? Is the taproot output script being watched by the wallet (i.e. you imported the descriptor for it)?",
      "created_at" : "2022-04-30T15:58:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1114010892",
      "id" : 1114010892,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII585CZnUM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1114010892/reactions"
      },
      "updated_at" : "2022-04-30T15:58:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1114010892",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "It's a descriptor wallet but I didn't add that specific output descriptor to it. It's the same internal key as was used in the BIP86 test, so the key is there. I assumed the PSBT would be sufficient as the \"assembly instruction\" for the signature, since the private key is known to the wallet. But I guess I have to learn more about how descriptor wallets work in this context.\r\nI'll try again with the correct descriptor imported and watched by the wallet, that will very likely resolve my issue. Thanks!",
      "created_at" : "2022-05-02T08:30:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1114618295",
      "id" : 1114618295,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII585Cb7m3",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1114618295/reactions"
      },
      "updated_at" : "2022-05-02T08:30:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1114618295",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008879?v=4",
         "events_url" : "https://api.github.com/users/guggero/events{/privacy}",
         "followers_url" : "https://api.github.com/users/guggero/followers",
         "following_url" : "https://api.github.com/users/guggero/following{/other_user}",
         "gists_url" : "https://api.github.com/users/guggero/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/guggero",
         "id" : 1008879,
         "login" : "guggero",
         "node_id" : "MDQ6VXNlcjEwMDg4Nzk=",
         "organizations_url" : "https://api.github.com/users/guggero/orgs",
         "received_events_url" : "https://api.github.com/users/guggero/received_events",
         "repos_url" : "https://api.github.com/users/guggero/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/guggero/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/guggero/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/guggero"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">  since the private key is known to the wallet.\r\n\r\nAfaik we don't sign anything unless we explicitly watch the `scriptPubKey`, which (for descriptor wallets) is only the case if a descriptor has been imported. In addition, that descriptor must have the private key: a descriptor with just the xpub won't work even if we have the corresponding seed. See also #23417 and #23544.",
      "created_at" : "2022-05-02T11:02:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1114725500",
      "id" : 1114725500,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII585CcVx8",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1114725500/reactions"
      },
      "updated_at" : "2022-05-02T11:03:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1114725500",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Afaik we don't sign anything unless we explicitly watch the `scriptPubKey`, which (for descriptor wallets) is only the case if a descriptor has been imported.\r\n\r\nNo, descriptor wallets will sign if it sees any keys that it owns in the BIP32 derivation paths. I just forgot to update that to search the taproot BIP32 derivation paths too.\r\n",
      "created_at" : "2022-05-02T14:19:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1114951712",
      "id" : 1114951712,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII585CdNAg",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1114951712/reactions"
      },
      "updated_at" : "2022-05-02T14:19:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1114951712",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@guggero I've pushed some commits that should fix that problem. Can you try again?",
      "created_at" : "2022-05-02T15:32:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1115039817",
      "id" : 1115039817,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII585CdihJ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1115039817/reactions"
      },
      "updated_at" : "2022-05-02T15:32:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1115039817",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thank you very much, this fixed the \"key spend with script root\" test case.\r\nIs script path signing expected to work as well?\r\n\r\nI tried it and got a wrong result. But again, this could be due to me still using the internal and script leaf key from the BIP86 descriptor. But I guess the result is still kind of unexpected. Since I supplied a leaf hash in the BIP32 derivation info and a script with a control block, I don't expect a signature to be put into the final script witness:\r\n\r\n```\r\n$ bitcoin-cli walletprocesspsbt cHNidP8BAFICAAAAAV0virKr77xOIRw1FU3mHJUQ6oO7UmoEgIUUsED3ZRiuAQAAAAD/////AYCy5g4AAAAAFgAUy79OrU4hd2M3xvJMufO1pLdEWcUAAAAAAAEBKwCj4REAAAAAIlEgLWIhk/X61lqdbrKkZqR9AsFvT4JFt4lmaYWbtsDTy3ciFcBjzFLwbgqR4+ZFZjGqBwIh1YzNHtjFtmOdT4h4bc1QDyMgY8xS8G4KkePmRWYxqgcCIdWMzR7YxbZjnU+IeG3NUA+swCEWY8xS8G4KkePmRWYxqgcCIdWMzR7YxbZjnU+IeG3NUA85ARuXHYQK/Sy6fb774buzt5a3DU2Va/o8Pz27k/FkM3v/AAAAAFYAAIAAAACAAAAAgAAAAAAAAAAAARcgY8xS8G4KkePmRWYxqgcCIdWMzR7YxbZjnU+IeG3NUA8BGCAblx2ECv0sun2+++G7s7eWtw1NlWv6PD89u5PxZDN7/wAA\r\n{\r\n  \"psbt\": \"cHNidP8BAFICAAAAAV0virKr77xOIRw1FU3mHJUQ6oO7UmoEgIUUsED3ZRiuAQAAAAD/////AYCy5g4AAAAAFgAUy79OrU4hd2M3xvJMufO1pLdEWcUAAAAAAAEBKwCj4REAAAAAIlEgLWIhk/X61lqdbrKkZqR9AsFvT4JFt4lmaYWbtsDTy3cBCEIBQGcgRxlVx6JBG4e3xDCw24Pm8QBFlHpvISfrlUAP1ajvKnh9aAAKCDqGBk5BysaADcNy+KFoBGtRk5GrmhgOwVoAAA==\",\r\n  \"complete\": true\r\n}\r\n```\r\n\r\n<details>\r\n  <summary>decoded input PSBT</summary>\r\n<pre>\r\n{\r\n  \"tx\": {\r\n    \"txid\": \"0faa6cef74415fa47d8ba4c5fbc16ef13ffa6d5bebf5e13f3f07efe255ed54e2\",\r\n    \"hash\": \"0faa6cef74415fa47d8ba4c5fbc16ef13ffa6d5bebf5e13f3f07efe255ed54e2\",\r\n    \"version\": 2,\r\n    \"size\": 82,\r\n    \"vsize\": 82,\r\n    \"weight\": 328,\r\n    \"locktime\": 0,\r\n    \"vin\": [\r\n      {\r\n        \"txid\": \"ae1865f740b0148580046a52bb83ea10951ce64d15351c214ebcefabb28a2f5d\",\r\n        \"vout\": 1,\r\n        \"scriptSig\": {\r\n          \"asm\": \"\",\r\n          \"hex\": \"\"\r\n        },\r\n        \"sequence\": 4294967295\r\n      }\r\n    ],\r\n    \"vout\": [\r\n      {\r\n        \"value\": 2.50000000,\r\n        \"n\": 0,\r\n        \"scriptPubKey\": {\r\n          \"asm\": \"0 cbbf4ead4e21776337c6f24cb9f3b5a4b74459c5\",\r\n          \"desc\": \"addr(bcrt1qewl5at2wy9mkxd7x7fxtnua45jm5gkw9fxuurq)#0jsdd5lg\",\r\n          \"hex\": \"0014cbbf4ead4e21776337c6f24cb9f3b5a4b74459c5\",\r\n          \"address\": \"bcrt1qewl5at2wy9mkxd7x7fxtnua45jm5gkw9fxuurq\",\r\n          \"type\": \"witness_v0_keyhash\"\r\n        }\r\n      }\r\n    ]\r\n  },\r\n  \"global_xpubs\": [\r\n  ],\r\n  \"psbt_version\": 0,\r\n  \"proprietary\": [\r\n  ],\r\n  \"unknown\": {\r\n  },\r\n  \"inputs\": [\r\n    {\r\n      \"witness_utxo\": {\r\n        \"amount\": 3.00000000,\r\n        \"scriptPubKey\": {\r\n          \"asm\": \"1 2d622193f5fad65a9d6eb2a466a47d02c16f4f8245b7896669859bb6c0d3cb77\",\r\n          \"desc\": \"addr(bcrt1p943zryl4ltt948twk2jxdfraqtqk7nuzgkmcjenfskdmdsxnedmsfzxf2p)#nyv7jhkl\",\r\n          \"hex\": \"51202d622193f5fad65a9d6eb2a466a47d02c16f4f8245b7896669859bb6c0d3cb77\",\r\n          \"address\": \"bcrt1p943zryl4ltt948twk2jxdfraqtqk7nuzgkmcjenfskdmdsxnedmsfzxf2p\",\r\n          \"type\": \"witness_v1_taproot\"\r\n        }\r\n      },\r\n      \"taproot_scripts\": [\r\n        {\r\n          \"script\": \"2063cc52f06e0a91e3e6456631aa070221d58ccd1ed8c5b6639d4f88786dcd500fac\",\r\n          \"leaf_ver\": 192,\r\n          \"control_blocks\": [\r\n            \"c063cc52f06e0a91e3e6456631aa070221d58ccd1ed8c5b6639d4f88786dcd500f\"\r\n          ]\r\n        }\r\n      ],\r\n      \"taproot_bip32_derivs\": [\r\n        {\r\n          \"pubkey\": \"63cc52f06e0a91e3e6456631aa070221d58ccd1ed8c5b6639d4f88786dcd500f\",\r\n          \"master_fingerprint\": \"00000000\",\r\n          \"path\": \"m/86'/0'/0'/0/0\",\r\n          \"leaf_hashes\": [\r\n            \"1b971d840afd2cba7dbefbe1bbb3b796b70d4d956bfa3c3f3dbb93f164337bff\"\r\n          ]\r\n        }\r\n      ],\r\n      \"taproot_internal_key\": \"63cc52f06e0a91e3e6456631aa070221d58ccd1ed8c5b6639d4f88786dcd500f\",\r\n      \"taproot_merkle_root\": \"1b971d840afd2cba7dbefbe1bbb3b796b70d4d956bfa3c3f3dbb93f164337bff\"\r\n    }\r\n  ],\r\n  \"outputs\": [\r\n    {\r\n    }\r\n  ],\r\n  \"fee\": 0.50000000\r\n}\r\n</pre>\r\n</details>\r\n\r\n<details>\r\n<summary>decoded output PSBT</summary>\r\n<pre>\r\n{\r\n  \"tx\": {\r\n    \"txid\": \"0faa6cef74415fa47d8ba4c5fbc16ef13ffa6d5bebf5e13f3f07efe255ed54e2\",\r\n    \"hash\": \"0faa6cef74415fa47d8ba4c5fbc16ef13ffa6d5bebf5e13f3f07efe255ed54e2\",\r\n    \"version\": 2,\r\n    \"size\": 82,\r\n    \"vsize\": 82,\r\n    \"weight\": 328,\r\n    \"locktime\": 0,\r\n    \"vin\": [\r\n      {\r\n        \"txid\": \"ae1865f740b0148580046a52bb83ea10951ce64d15351c214ebcefabb28a2f5d\",\r\n        \"vout\": 1,\r\n        \"scriptSig\": {\r\n          \"asm\": \"\",\r\n          \"hex\": \"\"\r\n        },\r\n        \"sequence\": 4294967295\r\n      }\r\n    ],\r\n    \"vout\": [\r\n      {\r\n        \"value\": 2.50000000,\r\n        \"n\": 0,\r\n        \"scriptPubKey\": {\r\n          \"asm\": \"0 cbbf4ead4e21776337c6f24cb9f3b5a4b74459c5\",\r\n          \"desc\": \"addr(bcrt1qewl5at2wy9mkxd7x7fxtnua45jm5gkw9fxuurq)#0jsdd5lg\",\r\n          \"hex\": \"0014cbbf4ead4e21776337c6f24cb9f3b5a4b74459c5\",\r\n          \"address\": \"bcrt1qewl5at2wy9mkxd7x7fxtnua45jm5gkw9fxuurq\",\r\n          \"type\": \"witness_v0_keyhash\"\r\n        }\r\n      }\r\n    ]\r\n  },\r\n  \"global_xpubs\": [\r\n  ],\r\n  \"psbt_version\": 0,\r\n  \"proprietary\": [\r\n  ],\r\n  \"unknown\": {\r\n  },\r\n  \"inputs\": [\r\n    {\r\n      \"witness_utxo\": {\r\n        \"amount\": 3.00000000,\r\n        \"scriptPubKey\": {\r\n          \"asm\": \"1 2d622193f5fad65a9d6eb2a466a47d02c16f4f8245b7896669859bb6c0d3cb77\",\r\n          \"desc\": \"addr(bcrt1p943zryl4ltt948twk2jxdfraqtqk7nuzgkmcjenfskdmdsxnedmsfzxf2p)#nyv7jhkl\",\r\n          \"hex\": \"51202d622193f5fad65a9d6eb2a466a47d02c16f4f8245b7896669859bb6c0d3cb77\",\r\n          \"address\": \"bcrt1p943zryl4ltt948twk2jxdfraqtqk7nuzgkmcjenfskdmdsxnedmsfzxf2p\",\r\n          \"type\": \"witness_v1_taproot\"\r\n        }\r\n      },\r\n      \"final_scriptwitness\": [\r\n        \"6720471955c7a2411b87b7c430b0db83e6f10045947a6f2127eb95400fd5a8ef2a787d68000a083a86064e41cac6800dc372f8a168046b519391ab9a180ec15a\"\r\n      ]\r\n    }\r\n  ],\r\n  \"outputs\": [\r\n    {\r\n    }\r\n  ],\r\n  \"fee\": 0.50000000\r\n}\r\n</pre>\r\n</details>",
      "created_at" : "2022-05-03T12:44:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1116057071",
      "id" : 1116057071,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII585Cha3v",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1116057071/reactions"
      },
      "updated_at" : "2022-05-03T12:44:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1116057071",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008879?v=4",
         "events_url" : "https://api.github.com/users/guggero/events{/privacy}",
         "followers_url" : "https://api.github.com/users/guggero/followers",
         "following_url" : "https://api.github.com/users/guggero/following{/other_user}",
         "gists_url" : "https://api.github.com/users/guggero/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/guggero",
         "id" : 1008879,
         "login" : "guggero",
         "node_id" : "MDQ6VXNlcjEwMDg4Nzk=",
         "organizations_url" : "https://api.github.com/users/guggero/orgs",
         "received_events_url" : "https://api.github.com/users/guggero/received_events",
         "repos_url" : "https://api.github.com/users/guggero/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/guggero/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/guggero/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/guggero"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@guggero I haven't inspected things in detail, but I suspect that what's going on is that you've simply provided sufficient information in the PSBT to construct a key-path spend, so that's what it constructs (as it's smaller in witness size).",
      "created_at" : "2022-05-03T14:17:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1116154112",
      "id" : 1116154112,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII585ChykA",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1116154112/reactions"
      },
      "updated_at" : "2022-05-03T14:19:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1116154112",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@sipa is correct. We will always try to create a key path spend if enough information is available to do so. You've provided the internal key and the derivation path for the internal key, even if it also has a leaf hash.",
      "created_at" : "2022-05-03T14:25:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1116164133",
      "id" : 1116164133,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII585Ch1Al",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1116164133/reactions"
      },
      "updated_at" : "2022-05-03T14:25:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1116164133",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Ah, that makes a lot of sense, thank you for your answers, @sipa and @achow101 . Without the internal key and merkle root fields I get the expected witness stack :tada: \r\n\r\n<details>\r\n<summary>Here's my full test protocol.</summary>\r\n\r\n 1. import descriptor (`importdescriptors '[{\"desc\":\"tr(tprv8ZgxMBicQKsPekctUrTRdca69GwGek7eoSafZ23pNYEsyHctxwWfUjgsq8UKwo3cLDpViLRv84bxtsZevZ6w4ZJqtMMqDZbnVreNZYbe6bu/86'\"'\"'/0'\"'\"'/0'\"'\"'/0/0)#53fkwtjk\",\"timestamp\":\"now\"}]'`)\r\n 2. BIP 86 key spend\r\n     - send coins to `bcrt1pwr5wkkq5jfq8655dk929mar3588qncd0j24csyq22awcjwzh88mq5uhwph` (BIP86 key spend, internal key `63cc52f06e0a91e3e6456631aa070221d58ccd1ed8c5b6639d4f88786dcd500f`)\r\n    - create PSBT that references that output\r\n    - sign with walletprocesspsbt `cHNidP8BAHECAAAAAeFJXY+feoKbYaGLcgspwL36Hwl9Ehr5sF4Zy7nj4TpQAAAAAAAAAAAAAo3j+gIAAAAAFgAUD1vsYoxpaHURXVbiu/mxgWarqwiAdNIaAAAAABYAFCqceUdOu0L9fdZ0pGsM4yBiQEPqAAAAAAABASsAZc0dAAAAACJRIHDo61gUkkB9Uo2xVF30caHOCeGvkquIEApXXYk4Vzn2IRZjzFLwbgqR4+ZFZjGqBwIh1YzNHtjFtmOdT4h4bc1QDxkAAAAAAFYAAIAAAACAAAAAgAAAAAAAAAAAAAAA`\r\n \r\n 3. script root key spend\r\n    - send coins to `bcrt1ptfmnpwtcs352cxush2kgqqza5jt9f9hymz9uhty4h57g8nvsduaq6s9ypp` (script root key spend, internal key `63cc52f06e0a91e3e6456631aa070221d58ccd1ed8c5b6639d4f88786dcd500f`, merkle root `6c2e4bb01e316abaaee288d69c06cc608cedefd6e1a06813786c4ec51b6e1d38`)\r\n    - create PSBT that references that output\r\n    - sign with walletprocesspsbt `cHNidP8BAHECAAAAAT/GF0O3okL4iQV80uYewSbhqa7qWoD2nG489WsPxw9xAAAAAAD/////AoCT3BQAAAAAFgAUKpx5R067Qv191nSkawzjIGJAQ+ri6PoCAAAAABYAFIyIwvqKctH/eWgjlieETO9w55xoAAAAAAABASsAhNcXAAAAACJRIFp3MLl4hGisG5C6rIAAXaSWVJbk2IvLrJW9PIPNkG86IRZjzFLwbgqR4+ZFZjGqBwIh1YzNHtjFtmOdT4h4bc1QDxkAAAAAAFYAAIAAAACAAAAAgAAAAAAAAAAAARcgY8xS8G4KkePmRWYxqgcCIdWMzR7YxbZjnU+IeG3NUA8BGCBsLkuwHjFquq7iiNacBsxgjO3v1uGgaBN4bE7FG24dOAAAIgICZ5Cr1jOOzCBlO+GZ+Y3VSYA26Z/kFrcSYqzM00TKPjQY1G/d61QAAIABAACAAAAAgAEAAAADAAAAAA==`\r\n \r\n 4. script spend\r\n    - send coins to `bcrt1p943zryl4ltt948twk2jxdfraqtqk7nuzgkmcjenfskdmdsxnedmsfzxf2p` (script spend, internal key `63cc52f06e0a91e3e6456631aa070221d58ccd1ed8c5b6639d4f88786dcd500f`, merkle root `1b971d840afd2cba7dbefbe1bbb3b796b70d4d956bfa3c3f3dbb93f164337bff`)\r\n    - create PSBT that references that output\r\n    - sign with walletprocesspsbt `cHNidP8BAFICAAAAAV0virKr77xOIRw1FU3mHJUQ6oO7UmoEgIUUsED3ZRiuAQAAAAD/////AcBg0hEAAAAAFgAUy79OrU4hd2M3xvJMufO1pLdEWcUAAAAAAAEBKwCj4REAAAAAIlEgLWIhk/X61lqdbrKkZqR9AsFvT4JFt4lmaYWbtsDTy3ciFcBjzFLwbgqR4+ZFZjGqBwIh1YzNHtjFtmOdT4h4bc1QDyMgY8xS8G4KkePmRWYxqgcCIdWMzR7YxbZjnU+IeG3NUA+swCEWY8xS8G4KkePmRWYxqgcCIdWMzR7YxbZjnU+IeG3NUA85ARuXHYQK/Sy6fb774buzt5a3DU2Va/o8Pz27k/FkM3v/AAAAAFYAAIAAAACAAAAAgAAAAAAAAAAAAAA=`\r\n \r\n\r\n\r\n</details>\r\n\r\ntACK d5674f1",
      "created_at" : "2022-05-03T14:43:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1116183694",
      "id" : 1116183694,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII585Ch5yO",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1116183694/reactions"
      },
      "updated_at" : "2022-05-03T14:43:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1116183694",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008879?v=4",
         "events_url" : "https://api.github.com/users/guggero/events{/privacy}",
         "followers_url" : "https://api.github.com/users/guggero/followers",
         "following_url" : "https://api.github.com/users/guggero/following{/other_user}",
         "gists_url" : "https://api.github.com/users/guggero/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/guggero",
         "id" : 1008879,
         "login" : "guggero",
         "node_id" : "MDQ6VXNlcjEwMDg4Nzk=",
         "organizations_url" : "https://api.github.com/users/guggero/orgs",
         "received_events_url" : "https://api.github.com/users/guggero/received_events",
         "repos_url" : "https://api.github.com/users/guggero/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/guggero/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/guggero/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/guggero"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I was also testing this PR and found one minor issue.\r\n`analyzepsbt` command doesn't correctly determine next role as \"signer\" for taproot inputs. This is due to the fact that `SignTaproot` doesn't fill `SignatureData::missing_sigs`.\r\n\r\nI'm not sure what is the best way to fix this as it's not always possible to know which signatures are missing for taproot inputs. Based on my current understanding, I propose:\r\n1) fill in `SignatureData::missing_sigs`  as accurate as possible based on known information. Avoid providing wrong hints (e.g. when internal key is invalid)\r\n2) remove the check requiring `missing_sigs` to be non empty in `src/node/psbt.cpp:77`. I think the idea was to guide users as to what they need to proceed with the input. But this check is too strict for taproot as we don't always have this information, but still can determine that \"signer\" is the next role\r\n\r\n",
      "created_at" : "2022-05-04T07:14:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1116996595",
      "id" : 1116996595,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII585ClAPz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1116996595/reactions"
      },
      "updated_at" : "2022-05-04T07:14:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1116996595",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\n This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-05-18T00:45:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1129451985",
      "id" : 1129451985,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII585DUhHR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1129451985/reactions"
      },
      "updated_at" : "2022-05-18T00:45:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1129451985",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I was also testing this PR and found one minor issue.\r\nanalyzepsbt command doesn't correctly determine next role as \"signer\" for taproot inputs.\r\n\r\nIs resolving this is a blocker for the PR or, is it something better done in a follow-up?",
      "created_at" : "2022-06-14T06:28:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1154769587",
      "id" : 1154769587,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII585E1GKz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1154769587/reactions"
      },
      "updated_at" : "2022-06-14T06:28:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1154769587",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Is resolving this is a blocker for the PR or, is it something better done in a follow-up?\r\n\r\nI think it can be done in a followup.",
      "created_at" : "2022-06-15T03:13:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1155935586",
      "id" : 1155935586,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII585E5i1i",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1155935586/reactions"
      },
      "updated_at" : "2022-06-15T03:13:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1155935586",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> @guggero I've pushed some commits that should fix that problem. Can you try again?\r\n\r\nThose two new commits could use a test case.",
      "created_at" : "2022-06-15T09:11:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1156209901",
      "id" : 1156209901,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII585E6lzt",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1156209901/reactions"
      },
      "updated_at" : "2022-06-15T09:11:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1156209901",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r903764592"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/903764592"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should we assert the length of `pubkey` here to make sure this doesn't ever overflow the buffer?",
      "commit_id" : "2b006944f49126ed6310d4bb33bea05a1756466e",
      "created_at" : "2022-06-22T13:45:21Z",
      "diff_hunk" : "@@ -2180,6 +2180,19 @@ TransactionError DescriptorScriptPubKeyMan::FillPSBT(PartiallySignedTransaction&\n                     *keys = Merge(*keys, *pk_keys);\n                 }\n             }\n+            for (const auto& pk_pair : input.m_tap_bip32_paths) {\n+                const XOnlyPubKey& pubkey = pk_pair.first;\n+                for (unsigned char prefix : {0x02, 0x03}) {\n+                    unsigned char b[33] = {prefix};\n+                    std::copy(pubkey.begin(), pubkey.end(), b + 1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r903764592",
      "id" : 903764592,
      "line" : 2187,
      "node_id" : "PRRC_kwDOABII58413lpw",
      "original_commit_id" : "2b006944f49126ed6310d4bb33bea05a1756466e",
      "original_line" : 2187,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/wallet/scriptpubkeyman.cpp",
      "position" : 8,
      "pull_request_review_id" : 1015207484,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/903764592/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-22T13:45:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/903764592",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r903776002"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/903776002"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Will this size always fit in a byte? Might want to assert here.",
      "commit_id" : "2b006944f49126ed6310d4bb33bea05a1756466e",
      "created_at" : "2022-06-22T13:53:10Z",
      "diff_hunk" : "@@ -642,3 +642,18 @@ std::optional<std::vector<std::tuple<int, CScript, int>>> InferTaprootTree(const\n \n     return ret;\n }\n+\n+std::vector<std::tuple<uint8_t, uint8_t, CScript>> TaprootBuilder::GetTreeTuples() const\n+{\n+    assert(IsComplete());\n+    std::vector<std::tuple<uint8_t, uint8_t, CScript>> tuples;\n+    if (m_branch.size()) {\n+        const auto& leaves = m_branch[0]->leaves;\n+        for (const auto& leaf : leaves) {\n+            uint8_t depth = (uint8_t)leaf.merkle_branch.size();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r903776002",
      "id" : 903776002,
      "line" : 653,
      "node_id" : "PRRC_kwDOABII58413ocC",
      "original_commit_id" : "2b006944f49126ed6310d4bb33bea05a1756466e",
      "original_line" : 653,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/script/standard.cpp",
      "position" : 12,
      "pull_request_review_id" : 1015224043,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/903776002/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-22T13:53:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/903776002",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r903817111"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/903817111"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Agree, there's quite some magic values here (also repeated), having constants makes it easier to review.\r\n(or maybe expanding it, like `1 + 32 + 32`, as it's mentioned in the BIP)\r\n(oh, nm, that's for PSBT_IN_TAP_SCRIPT_SIG's keydata, not here)",
      "commit_id" : "2b006944f49126ed6310d4bb33bea05a1756466e",
      "created_at" : "2022-06-22T14:24:48Z",
      "diff_hunk" : "@@ -489,6 +569,101 @@ struct PSBTInput\n                     hash256_preimages.emplace(hash, std::move(preimage));\n                     break;\n                 }\n+                case PSBT_IN_TAP_KEY_SIG:\n+                {\n+                    if (!key_lookup.emplace(key).second) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input Taproot key signature already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Input Taproot key signature key is more than one byte type\");\n+                    }\n+                    s >> m_tap_key_sig;\n+                    if (m_tap_key_sig.size() < 64) {\n+                        throw std::ios_base::failure(\"Input Taproot key path signature is shorter than 64 bytes\");\n+                    } else if (m_tap_key_sig.size() > 65) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r903817111",
      "id" : 903817111,
      "in_reply_to_id" : 817816205,
      "line" : 582,
      "node_id" : "PRRC_kwDOABII58413yeX",
      "original_commit_id" : "b704884935766748cf533577c1babacfb6d4b5a5",
      "original_line" : 582,
      "original_position" : 170,
      "original_start_line" : null,
      "path" : "src/psbt.h",
      "position" : 170,
      "pull_request_review_id" : 1015283134,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/903817111/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-22T14:31:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/903817111",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r903834876"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/903834876"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Is using an assert here dangerous? I mean, the application shouldn't crash on an invalid PSBT.",
      "commit_id" : "2b006944f49126ed6310d4bb33bea05a1756466e",
      "created_at" : "2022-06-22T14:39:11Z",
      "diff_hunk" : "@@ -489,6 +569,101 @@ struct PSBTInput\n                     hash256_preimages.emplace(hash, std::move(preimage));\n                     break;\n                 }\n+                case PSBT_IN_TAP_KEY_SIG:\n+                {\n+                    if (!key_lookup.emplace(key).second) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input Taproot key signature already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Input Taproot key signature key is more than one byte type\");\n+                    }\n+                    s >> m_tap_key_sig;\n+                    if (m_tap_key_sig.size() < 64) {\n+                        throw std::ios_base::failure(\"Input Taproot key path signature is shorter than 64 bytes\");\n+                    } else if (m_tap_key_sig.size() > 65) {\n+                        throw std::ios_base::failure(\"Input Taproot key path signature is longer than 65 bytes\");\n+                    }\n+                    break;\n+                }\n+                case PSBT_IN_TAP_SCRIPT_SIG:\n+                {\n+                    if (!key_lookup.emplace(key).second) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input Taproot script signature already provided\");\n+                    } else if (key.size() != 65) {\n+                        throw std::ios_base::failure(\"Input Taproot script signature key is not 65 bytes\");\n+                    }\n+                    SpanReader s_key(s.GetType(), s.GetVersion(), Span{key}.subspan(1));\n+                    XOnlyPubKey xonly;\n+                    uint256 hash;\n+                    s_key >> xonly;\n+                    s_key >> hash;\n+                    std::vector<unsigned char> sig;\n+                    s >> sig;\n+                    if (sig.size() < 64) {\n+                        throw std::ios_base::failure(\"Input Taproot script path signature is shorter than 64 bytes\");\n+                    } else if (sig.size() > 65) {\n+                        throw std::ios_base::failure(\"Input Taproot script path signature is longer than 65 bytes\");\n+                    }\n+                    m_tap_script_sigs.emplace(std::make_pair(xonly, hash), sig);\n+                    break;\n+                }\n+                case PSBT_IN_TAP_LEAF_SCRIPT:\n+                {\n+                    if (!key_lookup.emplace(key).second) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input Taproot leaf script already provided\");\n+                    } else if (key.size() < 34) {\n+                        throw std::ios_base::failure(\"Taproot leaf script key is not at least 34 bytes\");\n+                    } else if ((key.size() - 2) % 32 != 0) {\n+                        throw std::ios_base::failure(\"Input Taproot leaf script key's control block size is not valid\");\n+                    }\n+                    std::vector<unsigned char> script_v;\n+                    s >> script_v;\n+                    assert(!script_v.empty());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r903834876",
      "id" : 903834876,
      "line" : 620,
      "node_id" : "PRRC_kwDOABII584132z8",
      "original_commit_id" : "2b006944f49126ed6310d4bb33bea05a1756466e",
      "original_line" : 620,
      "original_position" : 208,
      "original_start_line" : null,
      "path" : "src/psbt.h",
      "position" : 208,
      "pull_request_review_id" : 1015310100,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 1,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/903834876/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-22T14:39:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/903834876",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r903855841"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/903855841"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why this block isn't necessary?",
      "commit_id" : "2b006944f49126ed6310d4bb33bea05a1756466e",
      "created_at" : "2022-06-22T14:53:32Z",
      "diff_hunk" : "@@ -625,6 +837,55 @@ struct PSBTOutput\n                     DeserializeHDKeypaths(s, key, hd_keypaths);\n                     break;\n                 }\n+                case PSBT_OUT_TAP_INTERNAL_KEY:\n+                {\n+                    if (!key_lookup.emplace(key).second) {\n+                        throw std::ios_base::failure(\"Duplicate Key, output Taproot internal key already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Output Taproot internal key key is more than one byte type\");\n+                    }\n+                    UnserializeFromVector(s, m_tap_internal_key);\n+                    break;\n+                }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r903855841",
      "id" : 903855841,
      "in_reply_to_id" : 817817480,
      "line" : 849,
      "node_id" : "PRRC_kwDOABII5841377h",
      "original_commit_id" : "b704884935766748cf533577c1babacfb6d4b5a5",
      "original_line" : 849,
      "original_position" : 322,
      "original_start_line" : null,
      "path" : "src/psbt.h",
      "position" : 322,
      "pull_request_review_id" : 1015339426,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/903855841/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-22T14:53:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/903855841",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r903890801"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/903890801"
         }
      },
      "author_association" : "MEMBER",
      "body" : "From commit 088e8366765dc7002e9cbcb45654e0709e233cd5. It's also not clear to me why this would be safe.",
      "commit_id" : "2b006944f49126ed6310d4bb33bea05a1756466e",
      "created_at" : "2022-06-22T15:18:39Z",
      "diff_hunk" : "@@ -489,6 +569,101 @@ struct PSBTInput\n                     hash256_preimages.emplace(hash, std::move(preimage));\n                     break;\n                 }\n+                case PSBT_IN_TAP_KEY_SIG:\n+                {\n+                    if (!key_lookup.emplace(key).second) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input Taproot key signature already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Input Taproot key signature key is more than one byte type\");\n+                    }\n+                    s >> m_tap_key_sig;\n+                    if (m_tap_key_sig.size() < 64) {\n+                        throw std::ios_base::failure(\"Input Taproot key path signature is shorter than 64 bytes\");\n+                    } else if (m_tap_key_sig.size() > 65) {\n+                        throw std::ios_base::failure(\"Input Taproot key path signature is longer than 65 bytes\");\n+                    }\n+                    break;\n+                }\n+                case PSBT_IN_TAP_SCRIPT_SIG:\n+                {\n+                    if (!key_lookup.emplace(key).second) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input Taproot script signature already provided\");\n+                    } else if (key.size() != 65) {\n+                        throw std::ios_base::failure(\"Input Taproot script signature key is not 65 bytes\");\n+                    }\n+                    SpanReader s_key(s.GetType(), s.GetVersion(), Span{key}.subspan(1));\n+                    XOnlyPubKey xonly;\n+                    uint256 hash;\n+                    s_key >> xonly;\n+                    s_key >> hash;\n+                    std::vector<unsigned char> sig;\n+                    s >> sig;\n+                    if (sig.size() < 64) {\n+                        throw std::ios_base::failure(\"Input Taproot script path signature is shorter than 64 bytes\");\n+                    } else if (sig.size() > 65) {\n+                        throw std::ios_base::failure(\"Input Taproot script path signature is longer than 65 bytes\");\n+                    }\n+                    m_tap_script_sigs.emplace(std::make_pair(xonly, hash), sig);\n+                    break;\n+                }\n+                case PSBT_IN_TAP_LEAF_SCRIPT:\n+                {\n+                    if (!key_lookup.emplace(key).second) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input Taproot leaf script already provided\");\n+                    } else if (key.size() < 34) {\n+                        throw std::ios_base::failure(\"Taproot leaf script key is not at least 34 bytes\");\n+                    } else if ((key.size() - 2) % 32 != 0) {\n+                        throw std::ios_base::failure(\"Input Taproot leaf script key's control block size is not valid\");\n+                    }\n+                    std::vector<unsigned char> script_v;\n+                    s >> script_v;\n+                    assert(!script_v.empty());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r903890801",
      "id" : 903890801,
      "in_reply_to_id" : 903834876,
      "line" : 620,
      "node_id" : "PRRC_kwDOABII58414Edx",
      "original_commit_id" : "2b006944f49126ed6310d4bb33bea05a1756466e",
      "original_line" : 620,
      "original_position" : 208,
      "original_start_line" : null,
      "path" : "src/psbt.h",
      "position" : 208,
      "pull_request_review_id" : 1015390076,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/903890801/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-22T15:18:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/903890801",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r905173190"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/905173190"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`XOnlyPubKey` can only be 32 bytes, so I don't think it matters? It internally contains a uint256.",
      "commit_id" : "1db84e9aec90e6784cc24734571e4f5e723e1999",
      "created_at" : "2022-06-23T15:33:11Z",
      "diff_hunk" : "@@ -2180,6 +2180,19 @@ TransactionError DescriptorScriptPubKeyMan::FillPSBT(PartiallySignedTransaction&\n                     *keys = Merge(*keys, *pk_keys);\n                 }\n             }\n+            for (const auto& pk_pair : input.m_tap_bip32_paths) {\n+                const XOnlyPubKey& pubkey = pk_pair.first;\n+                for (unsigned char prefix : {0x02, 0x03}) {\n+                    unsigned char b[33] = {prefix};\n+                    std::copy(pubkey.begin(), pubkey.end(), b + 1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r905173190",
      "id" : 905173190,
      "in_reply_to_id" : 903764592,
      "line" : 2187,
      "node_id" : "PRRC_kwDOABII584189jG",
      "original_commit_id" : "2b006944f49126ed6310d4bb33bea05a1756466e",
      "original_line" : 2187,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/wallet/scriptpubkeyman.cpp",
      "position" : 8,
      "pull_request_review_id" : 1017236874,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/905173190/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-23T15:33:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/905173190",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Those two new commits could use a test case.\r\n\r\nDone.",
      "created_at" : "2022-06-23T19:02:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1164766225",
      "id" : 1164766225,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII585FbOwR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1164766225/reactions"
      },
      "updated_at" : "2022-06-23T19:02:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1164766225",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r905366130"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/905366130"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Added an assert.",
      "commit_id" : "1db84e9aec90e6784cc24734571e4f5e723e1999",
      "created_at" : "2022-06-23T19:02:51Z",
      "diff_hunk" : "@@ -642,3 +642,18 @@ std::optional<std::vector<std::tuple<int, CScript, int>>> InferTaprootTree(const\n \n     return ret;\n }\n+\n+std::vector<std::tuple<uint8_t, uint8_t, CScript>> TaprootBuilder::GetTreeTuples() const\n+{\n+    assert(IsComplete());\n+    std::vector<std::tuple<uint8_t, uint8_t, CScript>> tuples;\n+    if (m_branch.size()) {\n+        const auto& leaves = m_branch[0]->leaves;\n+        for (const auto& leaf : leaves) {\n+            uint8_t depth = (uint8_t)leaf.merkle_branch.size();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r905366130",
      "id" : 905366130,
      "in_reply_to_id" : 903776002,
      "line" : 654,
      "node_id" : "PRRC_kwDOABII58419spy",
      "original_commit_id" : "2b006944f49126ed6310d4bb33bea05a1756466e",
      "original_line" : 654,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/script/standard.cpp",
      "position" : 13,
      "pull_request_review_id" : 1017511662,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/905366130/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-23T19:02:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/905366130",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r905366464"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/905366464"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Changed the assert to just a check that `script_v` is not empty, and it will throw if it is.",
      "commit_id" : "1db84e9aec90e6784cc24734571e4f5e723e1999",
      "created_at" : "2022-06-23T19:03:18Z",
      "diff_hunk" : "@@ -489,6 +569,101 @@ struct PSBTInput\n                     hash256_preimages.emplace(hash, std::move(preimage));\n                     break;\n                 }\n+                case PSBT_IN_TAP_KEY_SIG:\n+                {\n+                    if (!key_lookup.emplace(key).second) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input Taproot key signature already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Input Taproot key signature key is more than one byte type\");\n+                    }\n+                    s >> m_tap_key_sig;\n+                    if (m_tap_key_sig.size() < 64) {\n+                        throw std::ios_base::failure(\"Input Taproot key path signature is shorter than 64 bytes\");\n+                    } else if (m_tap_key_sig.size() > 65) {\n+                        throw std::ios_base::failure(\"Input Taproot key path signature is longer than 65 bytes\");\n+                    }\n+                    break;\n+                }\n+                case PSBT_IN_TAP_SCRIPT_SIG:\n+                {\n+                    if (!key_lookup.emplace(key).second) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input Taproot script signature already provided\");\n+                    } else if (key.size() != 65) {\n+                        throw std::ios_base::failure(\"Input Taproot script signature key is not 65 bytes\");\n+                    }\n+                    SpanReader s_key(s.GetType(), s.GetVersion(), Span{key}.subspan(1));\n+                    XOnlyPubKey xonly;\n+                    uint256 hash;\n+                    s_key >> xonly;\n+                    s_key >> hash;\n+                    std::vector<unsigned char> sig;\n+                    s >> sig;\n+                    if (sig.size() < 64) {\n+                        throw std::ios_base::failure(\"Input Taproot script path signature is shorter than 64 bytes\");\n+                    } else if (sig.size() > 65) {\n+                        throw std::ios_base::failure(\"Input Taproot script path signature is longer than 65 bytes\");\n+                    }\n+                    m_tap_script_sigs.emplace(std::make_pair(xonly, hash), sig);\n+                    break;\n+                }\n+                case PSBT_IN_TAP_LEAF_SCRIPT:\n+                {\n+                    if (!key_lookup.emplace(key).second) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input Taproot leaf script already provided\");\n+                    } else if (key.size() < 34) {\n+                        throw std::ios_base::failure(\"Taproot leaf script key is not at least 34 bytes\");\n+                    } else if ((key.size() - 2) % 32 != 0) {\n+                        throw std::ios_base::failure(\"Input Taproot leaf script key's control block size is not valid\");\n+                    }\n+                    std::vector<unsigned char> script_v;\n+                    s >> script_v;\n+                    assert(!script_v.empty());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r905366464",
      "id" : 905366464,
      "in_reply_to_id" : 903834876,
      "line" : null,
      "node_id" : "PRRC_kwDOABII58419svA",
      "original_commit_id" : "2b006944f49126ed6310d4bb33bea05a1756466e",
      "original_line" : 620,
      "original_position" : 208,
      "original_start_line" : null,
      "path" : "src/psbt.h",
      "position" : null,
      "pull_request_review_id" : 1017512173,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/905366464/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-23T19:03:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/905366464",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "`mwallet_taproot.py` CI [failure](https://cirrus-ci.com/task/5083471289778176?logs=ci#L3012), probably not spurious?",
      "created_at" : "2022-06-24T13:11:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1165560720",
      "id" : 1165560720,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII585FeQuQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1165560720/reactions"
      },
      "updated_at" : "2022-06-24T13:13:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1165560720",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r906053988"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906053988"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```\r\n node1 stderr script/standard.cpp:498:53: runtime error: load of value 21, which is not a valid value for type 'bool'\r\n    #0 0x55ba8cce31d5 in TaprootBuilder::GetSpendData() const src/./src/script/standard.cpp:498:53\r\n    #1 0x55ba8cc138e9 in PSBTOutput::FillSignatureData(SignatureData&) const src/./src/psbt.cpp:225:49\r\n\r\nSUMMARY: UndefinedBehaviorSanitizer: invalid-bool-load script/standard.cpp:498:53 in \r\n```\r\nhttps://cirrus-ci.com/task/5083471289778176?logs=ci#L3013",
      "commit_id" : "1db84e9aec90e6784cc24734571e4f5e723e1999",
      "created_at" : "2022-06-24T13:17:32Z",
      "diff_hunk" : "@@ -177,6 +218,16 @@ void PSBTOutput::FillSignatureData(SignatureData& sigdata) const\n     for (const auto& key_pair : hd_keypaths) {\n         sigdata.misc_pubkeys.emplace(key_pair.first.GetID(), key_pair);\n     }\n+    if (!m_tap_internal_key.IsNull()) {\n+        sigdata.tr_spenddata.internal_key = m_tap_internal_key;\n+    }\n+    if (!m_tap_tree.IsEmpty()) {\n+        TaprootSpendData spenddata = m_tap_tree.GetSpendData();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r906053988",
      "id" : 906053988,
      "line" : 225,
      "node_id" : "PRRC_kwDOABII5842AUlk",
      "original_commit_id" : "1db84e9aec90e6784cc24734571e4f5e723e1999",
      "original_line" : 225,
      "original_position" : 83,
      "original_start_line" : null,
      "path" : "src/psbt.cpp",
      "position" : 83,
      "pull_request_review_id" : 1018466595,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906053988/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-24T13:17:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906053988",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r906062436"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906062436"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Indeed, somehow `m_parity` got set to 21. Digging to see how that was achieved.",
      "commit_id" : "1db84e9aec90e6784cc24734571e4f5e723e1999",
      "created_at" : "2022-06-24T13:25:53Z",
      "diff_hunk" : "@@ -177,6 +218,16 @@ void PSBTOutput::FillSignatureData(SignatureData& sigdata) const\n     for (const auto& key_pair : hd_keypaths) {\n         sigdata.misc_pubkeys.emplace(key_pair.first.GetID(), key_pair);\n     }\n+    if (!m_tap_internal_key.IsNull()) {\n+        sigdata.tr_spenddata.internal_key = m_tap_internal_key;\n+    }\n+    if (!m_tap_tree.IsEmpty()) {\n+        TaprootSpendData spenddata = m_tap_tree.GetSpendData();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r906062436",
      "id" : 906062436,
      "in_reply_to_id" : 906053988,
      "line" : 225,
      "node_id" : "PRRC_kwDOABII5842AWpk",
      "original_commit_id" : "1db84e9aec90e6784cc24734571e4f5e723e1999",
      "original_line" : 225,
      "original_position" : 83,
      "original_start_line" : null,
      "path" : "src/psbt.cpp",
      "position" : 83,
      "pull_request_review_id" : 1018479393,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906062436/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-24T13:25:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906062436",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r906069638"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906069638"
         }
      },
      "author_association" : "MEMBER",
      "body" : "My guess is that it's unitialized because `GetSpendData()` was called before `Finalize()`. We should probably have an assert for that.",
      "commit_id" : "1db84e9aec90e6784cc24734571e4f5e723e1999",
      "created_at" : "2022-06-24T13:34:03Z",
      "diff_hunk" : "@@ -177,6 +218,16 @@ void PSBTOutput::FillSignatureData(SignatureData& sigdata) const\n     for (const auto& key_pair : hd_keypaths) {\n         sigdata.misc_pubkeys.emplace(key_pair.first.GetID(), key_pair);\n     }\n+    if (!m_tap_internal_key.IsNull()) {\n+        sigdata.tr_spenddata.internal_key = m_tap_internal_key;\n+    }\n+    if (!m_tap_tree.IsEmpty()) {\n+        TaprootSpendData spenddata = m_tap_tree.GetSpendData();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r906069638",
      "id" : 906069638,
      "in_reply_to_id" : 906053988,
      "line" : 225,
      "node_id" : "PRRC_kwDOABII5842AYaG",
      "original_commit_id" : "1db84e9aec90e6784cc24734571e4f5e723e1999",
      "original_line" : 225,
      "original_position" : 83,
      "original_start_line" : null,
      "path" : "src/psbt.cpp",
      "position" : 83,
      "pull_request_review_id" : 1018490211,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906069638/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-24T13:34:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906069638",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r906173171"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906173171"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I've added a call to `Finalize` after parsing, so hopefully it works now.",
      "commit_id" : "7594c11bead57b73c3dc137b01561725d5ba26f1",
      "created_at" : "2022-06-24T15:27:25Z",
      "diff_hunk" : "@@ -177,6 +218,16 @@ void PSBTOutput::FillSignatureData(SignatureData& sigdata) const\n     for (const auto& key_pair : hd_keypaths) {\n         sigdata.misc_pubkeys.emplace(key_pair.first.GetID(), key_pair);\n     }\n+    if (!m_tap_internal_key.IsNull()) {\n+        sigdata.tr_spenddata.internal_key = m_tap_internal_key;\n+    }\n+    if (!m_tap_tree.IsEmpty()) {\n+        TaprootSpendData spenddata = m_tap_tree.GetSpendData();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r906173171",
      "id" : 906173171,
      "in_reply_to_id" : 906053988,
      "line" : 223,
      "node_id" : "PRRC_kwDOABII5842Axrz",
      "original_commit_id" : "1db84e9aec90e6784cc24734571e4f5e723e1999",
      "original_line" : 223,
      "original_position" : 83,
      "original_start_line" : null,
      "path" : "src/psbt.cpp",
      "position" : 81,
      "pull_request_review_id" : 1018641816,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906173171/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-24T15:27:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906173171",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r906206828"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906206828"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```\r\n'Finalize' has type 'const TaprootBuilder', but function is not marked const\r\n        m_tap_tree.Finalize(m_tap_internal_key)\r\n```",
      "commit_id" : "d94fffe683e2bffc0417e5bf72c2c78a9166e1e3",
      "created_at" : "2022-06-24T16:09:26Z",
      "diff_hunk" : "@@ -177,6 +218,16 @@ void PSBTOutput::FillSignatureData(SignatureData& sigdata) const\n     for (const auto& key_pair : hd_keypaths) {\n         sigdata.misc_pubkeys.emplace(key_pair.first.GetID(), key_pair);\n     }\n+    if (!m_tap_internal_key.IsNull()) {\n+        sigdata.tr_spenddata.internal_key = m_tap_internal_key;\n+    }\n+    if (!m_tap_tree.IsEmpty()) {\n+        TaprootSpendData spenddata = m_tap_tree.GetSpendData();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r906206828",
      "id" : 906206828,
      "in_reply_to_id" : 906053988,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5842A55s",
      "original_commit_id" : "1db84e9aec90e6784cc24734571e4f5e723e1999",
      "original_line" : 223,
      "original_position" : 83,
      "original_start_line" : null,
      "path" : "src/psbt.cpp",
      "position" : null,
      "pull_request_review_id" : 1018689986,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906206828/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-24T16:09:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906206828",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r906309702"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906309702"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed.",
      "commit_id" : "d94fffe683e2bffc0417e5bf72c2c78a9166e1e3",
      "created_at" : "2022-06-24T18:41:25Z",
      "diff_hunk" : "@@ -177,6 +218,16 @@ void PSBTOutput::FillSignatureData(SignatureData& sigdata) const\n     for (const auto& key_pair : hd_keypaths) {\n         sigdata.misc_pubkeys.emplace(key_pair.first.GetID(), key_pair);\n     }\n+    if (!m_tap_internal_key.IsNull()) {\n+        sigdata.tr_spenddata.internal_key = m_tap_internal_key;\n+    }\n+    if (!m_tap_tree.IsEmpty()) {\n+        TaprootSpendData spenddata = m_tap_tree.GetSpendData();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r906309702",
      "id" : 906309702,
      "in_reply_to_id" : 906053988,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5842BTBG",
      "original_commit_id" : "1db84e9aec90e6784cc24734571e4f5e723e1999",
      "original_line" : 223,
      "original_position" : 83,
      "original_start_line" : null,
      "path" : "src/psbt.cpp",
      "position" : null,
      "pull_request_review_id" : 1018840837,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906309702/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-24T18:41:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906309702",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907411768"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907411768"
         }
      },
      "author_association" : "MEMBER",
      "body" : "d94fffe683e2bffc0417e5bf72c2c78a9166e1e3: nit if you have to touch earlier commits, belongs in 324bba0d0b863f7bc3825d1efc3d405eb3894536",
      "commit_id" : "d94fffe683e2bffc0417e5bf72c2c78a9166e1e3",
      "created_at" : "2022-06-27T13:48:19Z",
      "diff_hunk" : "@@ -618,7 +618,7 @@ struct PSBTInput\n                     std::vector<unsigned char> script_v;\n                     s >> script_v;\n                     if (script_v.empty()) {\n-                        throw std::ios_base:failure(\"Input Taproot leaf script must be at least 1 byte\");\n+                        throw std::ios_base::failure(\"Input Taproot leaf script must be at least 1 byte\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907411768",
      "id" : 907411768,
      "line" : 621,
      "node_id" : "PRRC_kwDOABII5842FgE4",
      "original_commit_id" : "d94fffe683e2bffc0417e5bf72c2c78a9166e1e3",
      "original_line" : 621,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/psbt.h",
      "position" : 5,
      "pull_request_review_id" : 1020230356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907411768/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-27T14:53:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907411768",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907422218"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907422218"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I assume this works for individual private keys, but not for master keys?\r\n\r\nI also seems to work if you have an xpriv and the descriptor has been expanded far enough. Might be good to add a test case for that behaviour too.",
      "commit_id" : "d94fffe683e2bffc0417e5bf72c2c78a9166e1e3",
      "created_at" : "2022-06-27T13:57:44Z",
      "diff_hunk" : "@@ -723,5 +723,46 @@ def test_psbt_input_keys(psbt_input, keys):\n         )\n         assert_equal(psbt2[\"fee\"], psbt3[\"fee\"])\n \n+        self.log.info(\"Test signing inputs that the wallet has keys for but is not watching the scripts\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907422218",
      "id" : 907422218,
      "line" : 726,
      "node_id" : "PRRC_kwDOABII5842FioK",
      "original_commit_id" : "d94fffe683e2bffc0417e5bf72c2c78a9166e1e3",
      "original_line" : 726,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "test/functional/rpc_psbt.py",
      "position" : 4,
      "pull_request_review_id" : 1020230356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907422218/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-27T14:53:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907422218",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907424017"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907424017"
         }
      },
      "author_association" : "MEMBER",
      "body" : "d94fffe683e2bffc0417e5bf72c2c78a9166e1e3  where does the `509203ac0` keypath come from? I assume it's intentionally unspendable, but that's not super clear now.",
      "commit_id" : "d94fffe683e2bffc0417e5bf72c2c78a9166e1e3",
      "created_at" : "2022-06-27T13:59:26Z",
      "diff_hunk" : "@@ -723,5 +723,46 @@ def test_psbt_input_keys(psbt_input, keys):\n         )\n         assert_equal(psbt2[\"fee\"], psbt3[\"fee\"])\n \n+        self.log.info(\"Test signing inputs that the wallet has keys for but is not watching the scripts\")\n+        self.nodes[1].createwallet(wallet_name=\"scriptwatchonly\", disable_private_keys=True)\n+        watchonly = self.nodes[1].get_wallet_rpc(\"scriptwatchonly\")\n+\n+        eckey = ECKey()\n+        eckey.generate()\n+        privkey = bytes_to_wif(eckey.get_bytes())\n+\n+        desc = descsum_create(\"wsh(pkh({}))\".format(eckey.get_pubkey().get_bytes().hex()))\n+        if self.options.descriptors:\n+            res = watchonly.importdescriptors([{\"desc\": desc, \"timestamp\": \"now\"}])\n+        else:\n+            res = watchonly.importmulti([{\"desc\": desc, \"timestamp\": \"now\"}])\n+        assert res[0][\"success\"]\n+        addr = self.nodes[0].deriveaddresses(desc)[0]\n+        self.nodes[0].sendtoaddress(addr, 10)\n+        self.generate(self.nodes[0], 1)\n+        self.nodes[0].importprivkey(privkey)\n+\n+        psbt = watchonly.sendall([wallet.getnewaddress()])[\"psbt\"]\n+        psbt = self.nodes[0].walletprocesspsbt(psbt)[\"psbt\"]\n+        self.nodes[0].sendrawtransaction(self.nodes[0].finalizepsbt(psbt)[\"hex\"])\n+\n+        # Same test but for taproot\n+        if self.options.descriptors:\n+            eckey = ECKey()\n+            eckey.generate()\n+            privkey = bytes_to_wif(eckey.get_bytes())\n+\n+            desc = descsum_create(\"tr(50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0,pk({}))\".format(eckey.get_pubkey().get_bytes().hex()))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907424017",
      "id" : 907424017,
      "line" : 755,
      "node_id" : "PRRC_kwDOABII5842FjER",
      "original_commit_id" : "d94fffe683e2bffc0417e5bf72c2c78a9166e1e3",
      "original_line" : 755,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "test/functional/rpc_psbt.py",
      "position" : 33,
      "pull_request_review_id" : 1020230356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907424017/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-27T14:53:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907424017",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907439664"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907439664"
         }
      },
      "author_association" : "MEMBER",
      "body" : "58a1a0c7a3f813c887d349ea3670584aff3773ad : we could probably use a `GetSigningProvider` specifically for `XOnlyPubKey`, but that can wait.",
      "commit_id" : "d94fffe683e2bffc0417e5bf72c2c78a9166e1e3",
      "created_at" : "2022-06-27T14:14:16Z",
      "diff_hunk" : "@@ -2180,6 +2180,19 @@ TransactionError DescriptorScriptPubKeyMan::FillPSBT(PartiallySignedTransaction&\n                     *keys = Merge(*keys, *pk_keys);\n                 }\n             }\n+            for (const auto& pk_pair : input.m_tap_bip32_paths) {\n+                const XOnlyPubKey& pubkey = pk_pair.first;\n+                for (unsigned char prefix : {0x02, 0x03}) {\n+                    unsigned char b[33] = {prefix};\n+                    std::copy(pubkey.begin(), pubkey.end(), b + 1);\n+                    CPubKey fullpubkey;\n+                    fullpubkey.Set(b, b + 33);\n+                    std::unique_ptr<FlatSigningProvider> pk_keys = GetSigningProvider(fullpubkey);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907439664",
      "id" : 907439664,
      "line" : 2190,
      "node_id" : "PRRC_kwDOABII5842Fm4w",
      "original_commit_id" : "58a1a0c7a3f813c887d349ea3670584aff3773ad",
      "original_line" : 2190,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/wallet/scriptpubkeyman.cpp",
      "position" : 11,
      "pull_request_review_id" : 1020230356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907439664/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-27T14:53:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907439664",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907464091"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907464091"
         }
      },
      "author_association" : "MEMBER",
      "body" : "37f6d29df5405d0cbebbb4368a6dcbc95c8f00e5 : maybe just squash this entire commit into f5e58b6b3dfa1622d7c03f82318ef06eb6c6818c or f7c7be9794d868a91c25a743f00b3fd351589d5f and add a comment along the lines of the commit message?",
      "commit_id" : "d94fffe683e2bffc0417e5bf72c2c78a9166e1e3",
      "created_at" : "2022-06-27T14:36:46Z",
      "diff_hunk" : "@@ -230,16 +230,16 @@ static bool SignTaproot(const SigningProvider& provider, const BaseSignatureCrea\n     // Try key path spending.\n     {\n         KeyOriginInfo info;\n-        if (provider.GetKeyOriginByXOnly(spenddata.internal_key, info)) {\n-            auto it = sigdata.taproot_misc_pubkeys.find(spenddata.internal_key);\n+        if (provider.GetKeyOriginByXOnly(sigdata.tr_spenddata.internal_key, info)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907464091",
      "id" : 907464091,
      "line" : 233,
      "node_id" : "PRRC_kwDOABII5842Fs2b",
      "original_commit_id" : "37f6d29df5405d0cbebbb4368a6dcbc95c8f00e5",
      "original_line" : 233,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/script/sign.cpp",
      "position" : 6,
      "pull_request_review_id" : 1020230356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907464091/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-27T14:53:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907464091",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907473032"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907473032"
         }
      },
      "author_association" : "MEMBER",
      "body" : "4542ba12866c5f9e7bb0da186800f2f5e450bea6: `<= TAPROOT_CONTROL_MAX_NODE_COUNT `? See also `TaprootBuilder::Insert`. In `descriptor.cpp` we check `branches.size() > TAPROOT_CONTROL_MAX_NODE_COUNT`. ",
      "commit_id" : "d94fffe683e2bffc0417e5bf72c2c78a9166e1e3",
      "created_at" : "2022-06-27T14:45:23Z",
      "diff_hunk" : "@@ -642,3 +643,19 @@ std::optional<std::vector<std::tuple<int, CScript, int>>> InferTaprootTree(const\n \n     return ret;\n }\n+\n+std::vector<std::tuple<uint8_t, uint8_t, CScript>> TaprootBuilder::GetTreeTuples() const\n+{\n+    assert(IsComplete());\n+    std::vector<std::tuple<uint8_t, uint8_t, CScript>> tuples;\n+    if (m_branch.size()) {\n+        const auto& leaves = m_branch[0]->leaves;\n+        for (const auto& leaf : leaves) {\n+            assert(leaf.merkle_branch.size() < TAPROOT_CONTROL_MAX_NODE_COUNT);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907473032",
      "id" : 907473032,
      "line" : 654,
      "node_id" : "PRRC_kwDOABII5842FvCI",
      "original_commit_id" : "d94fffe683e2bffc0417e5bf72c2c78a9166e1e3",
      "original_line" : 654,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/script/standard.cpp",
      "position" : 20,
      "pull_request_review_id" : 1020230356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907473032/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-27T14:53:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907473032",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907782676"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907782676"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "b80de4c505bf6377f2e476133dce6f2a803f1fa1",
      "created_at" : "2022-06-27T20:44:57Z",
      "diff_hunk" : "@@ -618,7 +618,7 @@ struct PSBTInput\n                     std::vector<unsigned char> script_v;\n                     s >> script_v;\n                     if (script_v.empty()) {\n-                        throw std::ios_base:failure(\"Input Taproot leaf script must be at least 1 byte\");\n+                        throw std::ios_base::failure(\"Input Taproot leaf script must be at least 1 byte\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907782676",
      "id" : 907782676,
      "in_reply_to_id" : 907411768,
      "line" : 620,
      "node_id" : "PRRC_kwDOABII5842G6oU",
      "original_commit_id" : "d94fffe683e2bffc0417e5bf72c2c78a9166e1e3",
      "original_line" : 620,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/psbt.h",
      "position" : 209,
      "pull_request_review_id" : 1020760652,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907782676/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-27T20:44:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907782676",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907783371"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907783371"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> I assume this works for individual private keys, but not for master keys?\r\n\r\nYes, we're not doing the dumb thing from legacy wallets where the seed key is a legitimate key we can receive at.\r\n\r\n> I also seems to work if you have an xpriv and the descriptor has been expanded far enough. Might be good to add a test case for that behaviour too.\r\n\r\nYes, that's the point, the test already covers that? Unless you mean something else.",
      "commit_id" : "b80de4c505bf6377f2e476133dce6f2a803f1fa1",
      "created_at" : "2022-06-27T20:45:43Z",
      "diff_hunk" : "@@ -723,5 +723,46 @@ def test_psbt_input_keys(psbt_input, keys):\n         )\n         assert_equal(psbt2[\"fee\"], psbt3[\"fee\"])\n \n+        self.log.info(\"Test signing inputs that the wallet has keys for but is not watching the scripts\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907783371",
      "id" : 907783371,
      "in_reply_to_id" : 907422218,
      "line" : 726,
      "node_id" : "PRRC_kwDOABII5842G6zL",
      "original_commit_id" : "d94fffe683e2bffc0417e5bf72c2c78a9166e1e3",
      "original_line" : 726,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "test/functional/rpc_psbt.py",
      "position" : 13,
      "pull_request_review_id" : 1020761571,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907783371/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-27T20:45:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907783371",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907783789"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907783789"
         }
      },
      "author_association" : "MEMBER",
      "body" : "From `wallet_taproot.py`, which got it from the BIP. I've refactored that into `test_framework/key.py` so that it can be shared.",
      "commit_id" : "b80de4c505bf6377f2e476133dce6f2a803f1fa1",
      "created_at" : "2022-06-27T20:46:19Z",
      "diff_hunk" : "@@ -723,5 +723,46 @@ def test_psbt_input_keys(psbt_input, keys):\n         )\n         assert_equal(psbt2[\"fee\"], psbt3[\"fee\"])\n \n+        self.log.info(\"Test signing inputs that the wallet has keys for but is not watching the scripts\")\n+        self.nodes[1].createwallet(wallet_name=\"scriptwatchonly\", disable_private_keys=True)\n+        watchonly = self.nodes[1].get_wallet_rpc(\"scriptwatchonly\")\n+\n+        eckey = ECKey()\n+        eckey.generate()\n+        privkey = bytes_to_wif(eckey.get_bytes())\n+\n+        desc = descsum_create(\"wsh(pkh({}))\".format(eckey.get_pubkey().get_bytes().hex()))\n+        if self.options.descriptors:\n+            res = watchonly.importdescriptors([{\"desc\": desc, \"timestamp\": \"now\"}])\n+        else:\n+            res = watchonly.importmulti([{\"desc\": desc, \"timestamp\": \"now\"}])\n+        assert res[0][\"success\"]\n+        addr = self.nodes[0].deriveaddresses(desc)[0]\n+        self.nodes[0].sendtoaddress(addr, 10)\n+        self.generate(self.nodes[0], 1)\n+        self.nodes[0].importprivkey(privkey)\n+\n+        psbt = watchonly.sendall([wallet.getnewaddress()])[\"psbt\"]\n+        psbt = self.nodes[0].walletprocesspsbt(psbt)[\"psbt\"]\n+        self.nodes[0].sendrawtransaction(self.nodes[0].finalizepsbt(psbt)[\"hex\"])\n+\n+        # Same test but for taproot\n+        if self.options.descriptors:\n+            eckey = ECKey()\n+            eckey.generate()\n+            privkey = bytes_to_wif(eckey.get_bytes())\n+\n+            desc = descsum_create(\"tr(50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0,pk({}))\".format(eckey.get_pubkey().get_bytes().hex()))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907783789",
      "id" : 907783789,
      "in_reply_to_id" : 907424017,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5842G65t",
      "original_commit_id" : "d94fffe683e2bffc0417e5bf72c2c78a9166e1e3",
      "original_line" : 755,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "test/functional/rpc_psbt.py",
      "position" : null,
      "pull_request_review_id" : 1020762184,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907783789/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-27T20:46:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907783789",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907784560"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907784560"
         }
      },
      "author_association" : "MEMBER",
      "body" : "IMO it's a separate enough change that it should be its own commit.",
      "commit_id" : "b80de4c505bf6377f2e476133dce6f2a803f1fa1",
      "created_at" : "2022-06-27T20:47:23Z",
      "diff_hunk" : "@@ -230,16 +230,16 @@ static bool SignTaproot(const SigningProvider& provider, const BaseSignatureCrea\n     // Try key path spending.\n     {\n         KeyOriginInfo info;\n-        if (provider.GetKeyOriginByXOnly(spenddata.internal_key, info)) {\n-            auto it = sigdata.taproot_misc_pubkeys.find(spenddata.internal_key);\n+        if (provider.GetKeyOriginByXOnly(sigdata.tr_spenddata.internal_key, info)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907784560",
      "id" : 907784560,
      "in_reply_to_id" : 907464091,
      "line" : 233,
      "node_id" : "PRRC_kwDOABII5842G7Fw",
      "original_commit_id" : "37f6d29df5405d0cbebbb4368a6dcbc95c8f00e5",
      "original_line" : 233,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/script/sign.cpp",
      "position" : 43,
      "pull_request_review_id" : 1020763193,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907784560/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-27T20:47:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907784560",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907784632"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907784632"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed.",
      "commit_id" : "b80de4c505bf6377f2e476133dce6f2a803f1fa1",
      "created_at" : "2022-06-27T20:47:28Z",
      "diff_hunk" : "@@ -642,3 +643,19 @@ std::optional<std::vector<std::tuple<int, CScript, int>>> InferTaprootTree(const\n \n     return ret;\n }\n+\n+std::vector<std::tuple<uint8_t, uint8_t, CScript>> TaprootBuilder::GetTreeTuples() const\n+{\n+    assert(IsComplete());\n+    std::vector<std::tuple<uint8_t, uint8_t, CScript>> tuples;\n+    if (m_branch.size()) {\n+        const auto& leaves = m_branch[0]->leaves;\n+        for (const auto& leaf : leaves) {\n+            assert(leaf.merkle_branch.size() < TAPROOT_CONTROL_MAX_NODE_COUNT);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r907784632",
      "id" : 907784632,
      "in_reply_to_id" : 907473032,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5842G7G4",
      "original_commit_id" : "d94fffe683e2bffc0417e5bf72c2c78a9166e1e3",
      "original_line" : 654,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/script/standard.cpp",
      "position" : null,
      "pull_request_review_id" : 1020763289,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907784632/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-27T20:47:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907784632",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r908301882"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/908301882"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Yes, we're not doing the dumb thing from legacy wallets where the seed key is a legitimate key we can receive at.\r\n\r\nThat's not what I mean. I was referering to be able to sign with any key that derives from the seed, assuming a derivation path is given.\r\n\r\n> Yes, that's the point, the test already covers that? Unless you mean something else.\r\n\r\nThe test imports a single private key into the descriptor-less wallet, not an xpriv.",
      "commit_id" : "b80de4c505bf6377f2e476133dce6f2a803f1fa1",
      "created_at" : "2022-06-28T10:13:01Z",
      "diff_hunk" : "@@ -723,5 +723,46 @@ def test_psbt_input_keys(psbt_input, keys):\n         )\n         assert_equal(psbt2[\"fee\"], psbt3[\"fee\"])\n \n+        self.log.info(\"Test signing inputs that the wallet has keys for but is not watching the scripts\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r908301882",
      "id" : 908301882,
      "in_reply_to_id" : 907422218,
      "line" : 726,
      "node_id" : "PRRC_kwDOABII5842I5Y6",
      "original_commit_id" : "d94fffe683e2bffc0417e5bf72c2c78a9166e1e3",
      "original_line" : 726,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "test/functional/rpc_psbt.py",
      "position" : 13,
      "pull_request_review_id" : 1021480365,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/908301882/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-28T10:13:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/908301882",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK b80de4c505bf6377f2e476133dce6f2a803f1fa1",
      "created_at" : "2022-06-28T14:19:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1168789017",
      "id" : 1168789017,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22558",
      "node_id" : "IC_kwDOABII585Fqk4Z",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1168789017/reactions"
      },
      "updated_at" : "2022-06-28T14:19:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1168789017",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r908576543"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/908576543"
         }
      },
      "author_association" : "MEMBER",
      "body" : "We will only sign with child keys. Anything that requires deriving other child keys from master keys is not supported.",
      "commit_id" : "b80de4c505bf6377f2e476133dce6f2a803f1fa1",
      "created_at" : "2022-06-28T14:46:19Z",
      "diff_hunk" : "@@ -723,5 +723,46 @@ def test_psbt_input_keys(psbt_input, keys):\n         )\n         assert_equal(psbt2[\"fee\"], psbt3[\"fee\"])\n \n+        self.log.info(\"Test signing inputs that the wallet has keys for but is not watching the scripts\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22558#discussion_r908576543",
      "id" : 908576543,
      "in_reply_to_id" : 907422218,
      "line" : 726,
      "node_id" : "PRRC_kwDOABII5842J8cf",
      "original_commit_id" : "d94fffe683e2bffc0417e5bf72c2c78a9166e1e3",
      "original_line" : 726,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "test/functional/rpc_psbt.py",
      "position" : 13,
      "pull_request_review_id" : 1021878941,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22558",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/908576543/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-28T14:46:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/908576543",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   }
]
