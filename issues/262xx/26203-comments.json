[
   {
      "author_association" : "MEMBER",
      "body" : "@1440000bytes could you check if this fixes your issue? Thanks.",
      "created_at" : "2022-09-29T13:10:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#issuecomment-1262258217",
      "id" : 1262258217,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26203",
      "node_id" : "IC_kwDOABII585LPIgp",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262258217/reactions"
      },
      "updated_at" : "2022-09-29T13:10:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262258217",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Also includes a quick refactor.\r\n\r\nGenerally, we avoid throwing \"quick refactors\" into bug fixes. Especially if they are going to be backported. Or, at least the refactor should be a separate commit, so if it doesn't need backporting, it doesn't have to be. ",
      "created_at" : "2022-09-29T14:10:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#issuecomment-1262342590",
      "id" : 1262342590,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26203",
      "node_id" : "IC_kwDOABII585LPdG-",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262342590/reactions"
      },
      "updated_at" : "2022-09-29T14:10:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262342590",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Generally, we avoid throwing \"quick refactors\" into bug fixes.\r\n\r\nAlright, removed.",
      "created_at" : "2022-09-29T14:15:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#issuecomment-1262348604",
      "id" : 1262348604,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26203",
      "node_id" : "IC_kwDOABII585LPek8",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262348604/reactions"
      },
      "updated_at" : "2022-09-29T14:15:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262348604",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Added a unit test.",
      "created_at" : "2022-09-29T14:37:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#issuecomment-1262377254",
      "id" : 1262377254,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26203",
      "node_id" : "IC_kwDOABII585LPlkm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262377254/reactions"
      },
      "updated_at" : "2022-09-29T14:37:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262377254",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@aureleoules  I want to clarify one thing:\r\n\r\nIs this a bug only on Windows or other platforms? If its a bug on some linux distro as well it will be easier for me to test",
      "created_at" : "2022-09-29T17:03:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#issuecomment-1262558193",
      "id" : 1262558193,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26203",
      "node_id" : "IC_kwDOABII585LQRvx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262558193/reactions"
      },
      "updated_at" : "2022-09-29T17:04:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262558193",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/94559964?v=4",
         "events_url" : "https://api.github.com/users/1440000bytes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/1440000bytes/followers",
         "following_url" : "https://api.github.com/users/1440000bytes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/1440000bytes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/1440000bytes",
         "id" : 94559964,
         "login" : "1440000bytes",
         "node_id" : "U_kgDOBaLe3A",
         "organizations_url" : "https://api.github.com/users/1440000bytes/orgs",
         "received_events_url" : "https://api.github.com/users/1440000bytes/received_events",
         "repos_url" : "https://api.github.com/users/1440000bytes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/1440000bytes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/1440000bytes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/1440000bytes"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @aureleoules I want to clarify one thing:\r\n> \r\n> Is this a bug only on Windows or other platforms? If its a bug on some linux distro as well it will be easier for me to test\r\n\r\nOr maybe that should be job of testers.. Give me one day I will test it. ",
      "created_at" : "2022-09-29T17:52:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#issuecomment-1262616787",
      "id" : 1262616787,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26203",
      "node_id" : "IC_kwDOABII585LQgDT",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262616787/reactions"
      },
      "updated_at" : "2022-09-29T17:52:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262616787",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/94559964?v=4",
         "events_url" : "https://api.github.com/users/1440000bytes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/1440000bytes/followers",
         "following_url" : "https://api.github.com/users/1440000bytes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/1440000bytes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/1440000bytes",
         "id" : 94559964,
         "login" : "1440000bytes",
         "node_id" : "U_kgDOBaLe3A",
         "organizations_url" : "https://api.github.com/users/1440000bytes/orgs",
         "received_events_url" : "https://api.github.com/users/1440000bytes/received_events",
         "repos_url" : "https://api.github.com/users/1440000bytes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/1440000bytes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/1440000bytes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/1440000bytes"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This is a logic bug in the wallet. It's entirely platform independent.",
      "created_at" : "2022-09-29T18:45:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#issuecomment-1262678143",
      "id" : 1262678143,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26203",
      "node_id" : "IC_kwDOABII585LQvB_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 1,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262678143/reactions"
      },
      "updated_at" : "2022-09-29T18:45:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262678143",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> This is a logic bug in the wallet. It's entirely platform independent.\r\n\r\nsipa cannot be wrong. I tried a few things and didn't work as expected. I am high. Please give me a few days.",
      "created_at" : "2022-09-29T19:20:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#issuecomment-1262713705",
      "id" : 1262713705,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26203",
      "node_id" : "IC_kwDOABII585LQ3tp",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262713705/reactions"
      },
      "updated_at" : "2022-09-29T19:20:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262713705",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/94559964?v=4",
         "events_url" : "https://api.github.com/users/1440000bytes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/1440000bytes/followers",
         "following_url" : "https://api.github.com/users/1440000bytes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/1440000bytes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/1440000bytes",
         "id" : 94559964,
         "login" : "1440000bytes",
         "node_id" : "U_kgDOBaLe3A",
         "organizations_url" : "https://api.github.com/users/1440000bytes/orgs",
         "received_events_url" : "https://api.github.com/users/1440000bytes/received_events",
         "repos_url" : "https://api.github.com/users/1440000bytes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/1440000bytes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/1440000bytes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/1440000bytes"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25729](https://github.com/bitcoin/bitcoin/pull/25729) (wallet: Check max transaction weight in CoinSelection by aureleoules)\n* [#25685](https://github.com/bitcoin/bitcoin/pull/25685) (wallet: Faster transaction creation by removing pre-set-inputs fetching responsibility from Coin Selection by furszy)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-09-30T00:47:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#issuecomment-1262978761",
      "id" : 1262978761,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26203",
      "node_id" : "IC_kwDOABII585LR4bJ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262978761/reactions"
      },
      "updated_at" : "2022-09-30T00:47:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262978761",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I don't understand whats happening in this issue. I compiled PR branch and tested it on Windows, it fixes the previous error and bitcoind or bitcoin-qt does not crash. However, returns \"insufficient funds\".\r\n\r\n@sipa said this is platform independent but I tried to run the same command on Fedora with v24.0rc1 and it returns PSBT with a change:\r\n\r\nWindows (PR Branch):\r\n\r\n```\r\nbitcoin-cli listunspent\r\n\r\n[\r\n  {\r\n    \"txid\": \"e911734bf711009dd6057c88bc598df2d31c18d1cc6bd6c790a704b519d77e68\",\r\n    \"vout\": 0,\r\n    \"address\": \"2N7uBTqqQ99ArbgmBuw2AANsf24bMVdYxgp\",\r\n    \"label\": \"\",\r\n    \"redeemScript\": \"522102de62833c851509cf13c0c63e0dc3ef7b74f7d86b17e9090fab68c09830cb2f2e2103cf11a2bc1371dad3691bce59e37d85b12aae6b030b533d4e7c5aedeb47a5ec0e52ae\",\r\n    \"scriptPubKey\": \"a914a0bf75baf8f3a4ae761c2faa2516b8540e993d8987\",\r\n    \"amount\": 0.00100000,\r\n    \"confirmations\": 595,\r\n    \"spendable\": false,\r\n    \"solvable\": true,\r\n    \"desc\": \"sh(multi(2,[aa130fed]02de62833c851509cf13c0c63e0dc3ef7b74f7d86b17e9090fab68c09830cb2f2e,[00890d8d]03cf11a2bc1371dad3691bce59e37d85b12aae6b030b533d4e7c5aedeb47a5ec0e))#j8w6g6zg\",\r\n    \"parent_descs\": [\r\n    ],\r\n    \"safe\": true\r\n  }\r\n]\r\n\r\nbitcoin-cli walletcreatefundedpsbt \"[{\\\"txid\\\":\\\"e911734bf711009dd6057c88bc598df2d31c18d1cc6bd6c790a704b519d77e68\\\",\\\"vout\\\":0}]\" \"[{\\\"tb1q9fxp2p0sm93jdlul8v3svzn7x69zcd9ljsgans\\\":\\\"0.0009\\\"}]\"\r\n\r\nInsufficient funds (code -4)\r\n```\r\n\r\nFedora (v24.0rc1):\r\n\r\n```\r\nbitcoin-cli listunspent\r\n\r\n[\r\n  {\r\n    \"txid\": \"e911734bf711009dd6057c88bc598df2d31c18d1cc6bd6c790a704b519d77e68\",\r\n    \"vout\": 0,\r\n    \"address\": \"2N7uBTqqQ99ArbgmBuw2AANsf24bMVdYxgp\",\r\n    \"label\": \"\",\r\n    \"redeemScript\": \"522102de62833c851509cf13c0c63e0dc3ef7b74f7d86b17e9090fab68c09830cb2f2e2103cf11a2bc1371dad3691bce59e37d85b12aae6b030b533d4e7c5aedeb47a5ec0e52ae\",\r\n    \"scriptPubKey\": \"a914a0bf75baf8f3a4ae761c2faa2516b8540e993d8987\",\r\n    \"amount\": 0.00100000,\r\n    \"confirmations\": 595,\r\n    \"spendable\": false,\r\n    \"solvable\": true,\r\n    \"desc\": \"sh(multi(2,[aa130fed]02de62833c851509cf13c0c63e0dc3ef7b74f7d86b17e9090fab68c09830cb2f2e,[00890d8d]03cf11a2bc1371dad3691bce59e37d85b12aae6b030b533d4e7c5aedeb47a5ec0e))#j8w6g6zg\",\r\n    \"parent_descs\": [\r\n    ],\r\n    \"safe\": true\r\n  }\r\n]\r\n\r\nbitcoin-cli  walletcreatefundedpsbt \"[{\\\"txid\\\":\\\"e911734bf711009dd6057c88bc598df2d31c18d1cc6bd6c790a704b519d77e68\\\",\\\"vout\\\":0}]\" \"[{\\\"tb1q9fxp2p0sm93jdlul8v3svzn7x69zcd9ljsgans\\\":\\\"0.0009\\\"}]\"\r\n\r\n{\r\n  \"psbt\": \"cHNidP8BAHECAAAAAWh+1xm1BKeQx9ZrzNEYHNPyjVm8iHwF1p0AEfdLcxHpAAAAAAD9////AsYlAAAAAAAAFgAUJT0nNy2sgypq59m0DmCbgIWp0m6QXwEAAAAAABYAFCpMFQXw2WMm/587IwYKfjaKLDS/AAAAAAABAHICAAAAAQzC3aNgVZV/fAJNlVsvxAMFuTtvRKqlPocBAGlOSHxDAAAAAAD+////AqCGAQAAAAAAF6kUoL91uvjzpK52HC+qJRa4VA6ZPYmHm52Yh1IGAAAWABQN4fccLGiwTrWIb1+7fsWapgno0aOsAQABBEdSIQLeYoM8hRUJzxPAxj4Nw+97dPfYaxfpCQ+raMCYMMsvLiEDzxGivBNx2tNpG85Z432FsSquawMLUz1OfFrt60el7A5SriIGAt5igzyFFQnPE8DGPg3D73t099hrF+kJD6towJgwyy8uBKoTD+0iBgPPEaK8E3Ha02kbzlnjfYWxKq5rAwtTPU58Wu3rR6XsDgQAiQ2NACICAiOsbsXVfUGqw6ybbE+LIjii6xEJVH7K9GgwIxu6pruVEMw4p/EAAACAAQAAgAcAAIAAAA==\",\r\n  \"fee\": 0.00000330,\r\n  \"changepos\": 0\r\n}\r\n\r\n```\r\n\r\n",
      "created_at" : "2022-09-30T15:21:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#issuecomment-1263710998",
      "id" : 1263710998,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26203",
      "node_id" : "IC_kwDOABII585LUrMW",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1263710998/reactions"
      },
      "updated_at" : "2022-09-30T15:21:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1263710998",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/94559964?v=4",
         "events_url" : "https://api.github.com/users/1440000bytes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/1440000bytes/followers",
         "following_url" : "https://api.github.com/users/1440000bytes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/1440000bytes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/1440000bytes",
         "id" : 94559964,
         "login" : "1440000bytes",
         "node_id" : "U_kgDOBaLe3A",
         "organizations_url" : "https://api.github.com/users/1440000bytes/orgs",
         "received_events_url" : "https://api.github.com/users/1440000bytes/received_events",
         "repos_url" : "https://api.github.com/users/1440000bytes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/1440000bytes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/1440000bytes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/1440000bytes"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26203#discussion_r984799588"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/984799588"
         }
      },
      "author_association" : "MEMBER",
      "body" : "No coin selection is actually happening, as `m_allow_other_inputs` = false. The effective value is too *low*, not too high\r\n\r\n```suggestion\r\n    // Test that effective value is used to check the value of preset inputs.\r\n    // This test creates a coin in which the effective value is too low to cover the fees, but is higher than the target value.\r\n    // The coin is selected using coin control, with m_allow_other_inputs = false. SelectCoins should fail.\r\n```",
      "commit_id" : "1e60f5d4d5e9990e00ddbaa0cfacf3c5731d73f9",
      "created_at" : "2022-09-30T17:17:34Z",
      "diff_hunk" : "@@ -922,5 +922,52 @@ BOOST_AUTO_TEST_CASE(effective_value_test)\n     BOOST_CHECK_EQUAL(output5.GetEffectiveValue(), nValue); // The effective value should be equal to the absolute value if input_bytes is -1\n }\n \n+BOOST_AUTO_TEST_CASE(SelectCoins_effective_value_test)\n+{\n+    // Test that effective value is used in coin selection\n+    // This test creates an external coin with a high effective value\n+    // The coin will not be selected because its effective value is less than the target",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#discussion_r984799588",
      "id" : 984799588,
      "line" : 929,
      "node_id" : "PRRC_kwDOABII5846stlk",
      "original_commit_id" : "1e60f5d4d5e9990e00ddbaa0cfacf3c5731d73f9",
      "original_line" : 929,
      "original_position" : 8,
      "original_start_line" : 927,
      "path" : "src/wallet/test/coinselector_tests.cpp",
      "position" : 8,
      "pull_request_review_id" : 1127135103,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26203",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/984799588/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 927,
      "start_side" : "RIGHT",
      "updated_at" : "2022-09-30T17:38:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/984799588",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@1440000bytes  So IIUC you have 1 coin worth 0.001 BTC (as shown by your `listunspent`). You tried to create a transaction paying 0.0009 using `walletcreatefundedpsbt`, passing that coin in manually. Since you specified an input manually, `m_allow_other_inputs` is false.\r\nhttps://github.com/bitcoin/bitcoin/blob/f59e91511a3aa8b2770eeec7034ddc1a9dec918b/src/wallet/rpc/spend.cpp#L1659-L1663\r\nThis needs to fund the payment and the fees for the transaction, including the cost to spend the coin. 0.001 covers the payment and non-input fees, but not the cost to spend. So it is indeed the case that the wallet has insufficient funds.\r\n\r\ncause of the crash and why the fix works:\r\n\r\n`SelectionResult::AddInput` changes `m_use_effective` to true:\r\nhttps://github.com/bitcoin/bitcoin/blob/f59e91511a3aa8b2770eeec7034ddc1a9dec918b/src/wallet/spend.cpp#L584\r\nhttps://github.com/bitcoin/bitcoin/blob/f59e91511a3aa8b2770eeec7034ddc1a9dec918b/src/wallet/coinselection.cpp#L441-L445\r\n`GetSelectedValue()` is 0.001 and `GetSelectedEffectiveValue()` is something less than 0.0009.\r\nSo this condition doesn't hit:\r\nhttps://github.com/bitcoin/bitcoin/blob/f59e91511a3aa8b2770eeec7034ddc1a9dec918b/src/wallet/spend.cpp#L585\r\nBut the assertion does, since `selected_effective_value` is something less than 0.0009.",
      "created_at" : "2022-09-30T17:31:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#issuecomment-1263835951",
      "id" : 1263835951,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26203",
      "node_id" : "IC_kwDOABII585LVJsv",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1263835951/reactions"
      },
      "updated_at" : "2022-09-30T18:10:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1263835951",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I don't understand whats happening in this issue. I compiled PR branch and tested it on Windows, it fixes the previous error and bitcoind or bitcoin-qt does not crash. However, returns \"insufficient funds\".\r\n> \r\n> @sipa said this is platform independent but I tried to run the same command on Fedora with v24.0rc1 and it returns PSBT with a change:\r\n\r\n@1440000bytes: I missed this at first, but could you confirm that the first output you posted is resulting from running `PR/26203` (this branch) on Windows, and the second output is from running `v24.0rc1` on Fedora?",
      "created_at" : "2022-09-30T18:10:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#issuecomment-1263872013",
      "id" : 1263872013,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26203",
      "node_id" : "IC_kwDOABII585LVSgN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1263872013/reactions"
      },
      "updated_at" : "2022-09-30T18:10:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1263872013",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK.\r\n\r\nThe assert can also be reproduced by adjusting the amount in the psbt just between the regimes where it succeeds and the regime with insufficient funds. E.g. on an empty regtest datadir:\r\n```\r\n./bitcoind -regtest -fallbackfee=0.001\r\n./bitcoin-cli -regtest -generate 101\r\n./bitcoin-cli -regtest listunspent -> use txid in next call\r\n./bitcoin-cli -regtest walletcreatefundedpsbt \"[{\\\"txid\\\":\\\"<txid>\\\",\\\"vout\\\":0}]\" \"[{\\\"<some address>\\\":\\\"49.9999\\\"}]\"\r\n```\r\nwill lead to a crash on master (which is fixed by this PR).",
      "created_at" : "2022-09-30T18:43:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#issuecomment-1263901589",
      "id" : 1263901589,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26203",
      "node_id" : "IC_kwDOABII585LVZuV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1263901589/reactions"
      },
      "updated_at" : "2022-09-30T18:55:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1263901589",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> This needs to fund the payment and the fees for the transaction, including the cost to spend the coin. 0.001 covers the payment and non-input fees, but not the cost to spend. So it is indeed the case that the wallet has insufficient funds.\r\n\r\nWhat is cost to spend?\r\n\r\n> @1440000bytes: I missed this at first, but could you confirm that the first output you posted is resulting from running PR/26203 (this branch) on Windows, and the second output is from running v24.0rc1 on Fedora?\r\n\r\nYes\r\n\r\nand both have same config:\r\n\r\n```\r\n# Windows\r\n\r\nsignet=1\r\ntxindex=1\r\n\r\nsignet.rpcport=18332\r\nrpcuser=user\r\nrpcpassword=pass\r\n\r\nfallbackfee=0.0004\r\n\r\n\r\n# Fedora\r\n\r\nsignet=1\r\ntxindex=1\r\n\r\n[signet] \r\nrpcport=18332\r\nrpcuser=user\r\nrpcpassword=pass\r\n\r\nfallbackfee=0.0004\r\n\r\n```\r\n",
      "created_at" : "2022-09-30T18:52:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#issuecomment-1263908295",
      "id" : 1263908295,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26203",
      "node_id" : "IC_kwDOABII585LVbXH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1263908295/reactions"
      },
      "updated_at" : "2022-09-30T18:52:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1263908295",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/94559964?v=4",
         "events_url" : "https://api.github.com/users/1440000bytes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/1440000bytes/followers",
         "following_url" : "https://api.github.com/users/1440000bytes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/1440000bytes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/1440000bytes",
         "id" : 94559964,
         "login" : "1440000bytes",
         "node_id" : "U_kgDOBaLe3A",
         "organizations_url" : "https://api.github.com/users/1440000bytes/orgs",
         "received_events_url" : "https://api.github.com/users/1440000bytes/received_events",
         "repos_url" : "https://api.github.com/users/1440000bytes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/1440000bytes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/1440000bytes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/1440000bytes"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26203#discussion_r984871894"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/984871894"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I don't think we need this new method, as we have the necessary information in the callsite already (see below).",
      "commit_id" : "1e60f5d4d5e9990e00ddbaa0cfacf3c5731d73f9",
      "created_at" : "2022-09-30T18:57:46Z",
      "diff_hunk" : "@@ -344,6 +344,8 @@ struct SelectionResult\n     CAmount GetTarget() const { return m_target; }\n \n     SelectionAlgorithm GetAlgo() const { return m_algo; }\n+\n+    bool UseEffectiveValue() const { return m_use_effective; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#discussion_r984871894",
      "id" : 984871894,
      "line" : 348,
      "node_id" : "PRRC_kwDOABII5846s_PW",
      "original_commit_id" : "f560f6b8e4e8cb419b2003174a8e9b9bfa3db5ec",
      "original_line" : 348,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.h",
      "position" : 5,
      "pull_request_review_id" : 1127239533,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26203",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/984871894/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-30T19:21:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/984871894",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26203#discussion_r984876402"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/984876402"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "We always use the effective value of UTXOs except when the recipient pays the fees via SFFO, so you can go by the negation of the corresponding coin selection parameter:\r\n\r\n```suggestion\r\n        if (!coin_selection_params.m_subtract_fee_outputs && result.GetSelectedEffectiveValue() < nTargetValue) {\r\n            return std::nullopt;\r\n        } else if (result.GetSelectedValue() < nTargetValue) {\r\n            return std::nullopt;\r\n        }\r\n```\r\n\r\nPerhaps it would be nicer if we dropped the negation and swapped `if` and `else if` branches:\r\n\r\n```suggestion\r\n        if (coin_selection_params.m_subtract_fee_outputs && result.GetSelectedValue() < nTargetValue) {\r\n            return std::nullopt;\r\n        } else if (result.GetSelectedEffectiveValue() < nTargetValue) {\r\n            return std::nullopt;\r\n        }\r\n```\r\n\r\nor more compactly:\r\n\r\n```suggestion\r\n        if (result.GetSelectedEffectiveValue() < nTargetValue || coin_selection_params.m_subtract_fee_outputs && result.GetSelectedValue() < nTargetValue) {\r\n            return std::nullopt;\r\n        }\r\n```",
      "commit_id" : "1e60f5d4d5e9990e00ddbaa0cfacf3c5731d73f9",
      "created_at" : "2022-09-30T19:05:01Z",
      "diff_hunk" : "@@ -582,7 +582,13 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, CoinsResult& a\n     if (coin_control.HasSelected() && !coin_control.m_allow_other_inputs) {\n         SelectionResult result(nTargetValue, SelectionAlgorithm::MANUAL);\n         result.AddInput(preset_inputs);\n-        if (result.GetSelectedValue() < nTargetValue) return std::nullopt;\n+\n+        if (result.UseEffectiveValue() && result.GetSelectedEffectiveValue() < nTargetValue) {\n+            return std::nullopt;\n+        } else if (result.GetSelectedValue() < nTargetValue) {\n+            return std::nullopt;\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#discussion_r984876402",
      "id" : 984876402,
      "line" : 590,
      "node_id" : "PRRC_kwDOABII5846tAVy",
      "original_commit_id" : "f560f6b8e4e8cb419b2003174a8e9b9bfa3db5ec",
      "original_line" : 590,
      "original_position" : 10,
      "original_start_line" : 586,
      "path" : "src/wallet/spend.cpp",
      "position" : 10,
      "pull_request_review_id" : 1127239533,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26203",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/984876402/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 586,
      "start_side" : "RIGHT",
      "updated_at" : "2022-09-30T19:21:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/984876402",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26203#discussion_r984883970"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/984883970"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The effective value of a UTXO is `effValue = value - fee`, so rather than the effective value being too low to cover the fees, the effective value is too low to create the output after deducting the fees:\r\n\r\n```suggestion\r\n    // Test that the effective value is used to check whether preset inputs provide sufficient funds when subtract_fee_outputs is not used.\r\n    // This test creates a coin whose value is higher than the target but whose effective value is lower than the target.\r\n    // The coin is selected using coin control, with m_allow_other_inputs = false. SelectCoins should fail due to insufficient funds.\r\n```",
      "commit_id" : "1e60f5d4d5e9990e00ddbaa0cfacf3c5731d73f9",
      "created_at" : "2022-09-30T19:17:36Z",
      "diff_hunk" : "@@ -922,5 +922,52 @@ BOOST_AUTO_TEST_CASE(effective_value_test)\n     BOOST_CHECK_EQUAL(output5.GetEffectiveValue(), nValue); // The effective value should be equal to the absolute value if input_bytes is -1\n }\n \n+BOOST_AUTO_TEST_CASE(SelectCoins_effective_value_test)\n+{\n+    // Test that effective value is used in coin selection\n+    // This test creates an external coin with a high effective value\n+    // The coin will not be selected because its effective value is less than the target",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#discussion_r984883970",
      "id" : 984883970,
      "in_reply_to_id" : 984799588,
      "line" : 929,
      "node_id" : "PRRC_kwDOABII5846tCMC",
      "original_commit_id" : "1e60f5d4d5e9990e00ddbaa0cfacf3c5731d73f9",
      "original_line" : 929,
      "original_position" : 8,
      "original_start_line" : 927,
      "path" : "src/wallet/test/coinselector_tests.cpp",
      "position" : 8,
      "pull_request_review_id" : 1127239533,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26203",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/984883970/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 927,
      "start_side" : "RIGHT",
      "updated_at" : "2022-09-30T19:21:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/984883970",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26203#discussion_r985156739"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/985156739"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks, I pushed your first edited version for readability, the two others translate to another statement that is incorrect though.",
      "commit_id" : "d0d9cf7aea2ff36a14a19e6999400e4070b7b0c9",
      "created_at" : "2022-10-01T23:35:54Z",
      "diff_hunk" : "@@ -582,7 +582,13 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, CoinsResult& a\n     if (coin_control.HasSelected() && !coin_control.m_allow_other_inputs) {\n         SelectionResult result(nTargetValue, SelectionAlgorithm::MANUAL);\n         result.AddInput(preset_inputs);\n-        if (result.GetSelectedValue() < nTargetValue) return std::nullopt;\n+\n+        if (result.UseEffectiveValue() && result.GetSelectedEffectiveValue() < nTargetValue) {\n+            return std::nullopt;\n+        } else if (result.GetSelectedValue() < nTargetValue) {\n+            return std::nullopt;\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#discussion_r985156739",
      "id" : 985156739,
      "in_reply_to_id" : 984876402,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5846uEyD",
      "original_commit_id" : "f560f6b8e4e8cb419b2003174a8e9b9bfa3db5ec",
      "original_line" : 590,
      "original_position" : 10,
      "original_start_line" : 586,
      "path" : "src/wallet/spend.cpp",
      "position" : null,
      "pull_request_review_id" : 1127575872,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26203",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/985156739/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2022-10-01T23:48:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/985156739",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@MarcoFalke \r\n\r\nUse marcofalke... Don't do anything else I will kil you...\r\n",
      "created_at" : "2022-10-01T23:43:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#issuecomment-1264509672",
      "id" : 1264509672,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26203",
      "node_id" : "IC_kwDOABII585LXuLo",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 1,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1264509672/reactions"
      },
      "updated_at" : "2022-10-01T23:43:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1264509672",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/94559964?v=4",
         "events_url" : "https://api.github.com/users/1440000bytes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/1440000bytes/followers",
         "following_url" : "https://api.github.com/users/1440000bytes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/1440000bytes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/1440000bytes",
         "id" : 94559964,
         "login" : "1440000bytes",
         "node_id" : "U_kgDOBaLe3A",
         "organizations_url" : "https://api.github.com/users/1440000bytes/orgs",
         "received_events_url" : "https://api.github.com/users/1440000bytes/received_events",
         "repos_url" : "https://api.github.com/users/1440000bytes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/1440000bytes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/1440000bytes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/1440000bytes"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thank you @Xekyo @glozow @mzumsande for the reviews, I addressed your comments. Thanks @1440000bytes for testing.\r\npush diff here: https://github.com/bitcoin/bitcoin/compare/1e60f5d4d..d0d9cf7aea2ff36a14a19e6999400e4070b7b0c9",
      "created_at" : "2022-10-01T23:44:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#issuecomment-1264509780",
      "id" : 1264509780,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26203",
      "node_id" : "IC_kwDOABII585LXuNU",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1264509780/reactions"
      },
      "updated_at" : "2022-10-01T23:44:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1264509780",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Thank you @Xekyo @glozow @mzumsande for the reviews, I addressed your comments. Thanks @1440000bytes for testing. push diff here: https://github.com/bitcoin/bitcoin/compare/1e60f5d4d..d0d9cf7aea2ff36a14a19e6999400e4070b7b0\r\n\r\nPeople will respond. I am wrong but but will do.",
      "created_at" : "2022-10-01T23:50:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#issuecomment-1264510248",
      "id" : 1264510248,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26203",
      "node_id" : "IC_kwDOABII585LXuUo",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1264510248/reactions"
      },
      "updated_at" : "2022-10-01T23:50:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1264510248",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/94559964?v=4",
         "events_url" : "https://api.github.com/users/1440000bytes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/1440000bytes/followers",
         "following_url" : "https://api.github.com/users/1440000bytes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/1440000bytes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/1440000bytes",
         "id" : 94559964,
         "login" : "1440000bytes",
         "node_id" : "U_kgDOBaLe3A",
         "organizations_url" : "https://api.github.com/users/1440000bytes/orgs",
         "received_events_url" : "https://api.github.com/users/1440000bytes/received_events",
         "repos_url" : "https://api.github.com/users/1440000bytes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/1440000bytes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/1440000bytes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/1440000bytes"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Overall the change looks correct to me. I was trying to backport the test to see where the bug was introduced, but didn't succeed due to too many refactors. Is it a regression from 23.0 or not?",
      "created_at" : "2022-10-03T07:36:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#issuecomment-1265050946",
      "id" : 1265050946,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26203",
      "node_id" : "IC_kwDOABII585LZyVC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1265050946/reactions"
      },
      "updated_at" : "2022-10-03T07:36:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1265050946",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Happily, https://github.com/bitcoin/bitcoin/pull/25685 fixes this too.\r\n\r\nThat's good to hear, though I think this is more appropriate for a backport.\r\n#26242",
      "created_at" : "2022-10-04T09:05:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26203#issuecomment-1266633455",
      "id" : 1266633455,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26203",
      "node_id" : "IC_kwDOABII585Lf0rv",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1266633455/reactions"
      },
      "updated_at" : "2022-10-04T09:05:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1266633455",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   }
]
