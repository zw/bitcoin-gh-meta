{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "NONE",
   "body" : "#### ISSUE\r\nData directory locking fails over NFS\r\n\r\n#### CONTEXT\r\n\r\n\r\n```\r\n# data directory\r\nls -ahl\r\ntotal 12M\r\ndrwxrwx--- 5 bitcoin bitcoin   10 Dec 29 09:50 .\r\ndrwxrwx--- 3 bitcoin bitcoin    3 Dec 29 07:22 ..\r\n-rw-rw---- 1 bitcoin bitcoin  12K Dec 29 07:22 banlist.dat\r\ndrwxrwx--- 3 bitcoin bitcoin 2.9K Dec 29 08:03 blocks\r\ndrwxrwx--- 2 bitcoin bitcoin 1.4K Dec 29 08:08 chainstate\r\n-rw-rw---- 1 bitcoin bitcoin 9.6M Dec 29 07:22 debug.log\r\n-rw-rw---- 1 bitcoin bitcoin 243K Dec 29 07:22 fee_estimates.dat\r\n-rw-rw---- 1 bitcoin bitcoin 6.4M Dec 29 07:22 mempool.dat\r\n-rw-rw---- 1 bitcoin bitcoin 4.7M Dec 29 07:22 peers.dat\r\ndrwxrwx--- 4 bitcoin bitcoin   13 Dec 29 08:12 testnet3\r\n```\r\n\r\n```\r\nDec 29 17:50:50 bitcoin systemd[1]: Started BitcoinD Mainnet.\r\nDec 29 17:50:50 bitcoin bitcoind[567]: 2018-12-29T17:50:50Z Bitcoin Core version v0.17.0.1 (release build)\r\nDec 29 17:50:50 bitcoin bitcoind[567]: 2018-12-29T17:50:50Z InitParameterInteraction: parameter interaction: -whitelistforcerelay=1 -> setting -whitelistrelay=1\r\nDec 29 17:50:50 bitcoin bitcoind[567]: 2018-12-29T17:50:50Z Assuming ancestors of block 0000000000000000002e63058c023a9a1de233554f28c7b21380b6c9003f36a8 have valid signatures.\r\nDec 29 17:50:50 bitcoin bitcoind[567]: 2018-12-29T17:50:50Z Setting nMinimumChainWork=0000000000000000000000000000000000000000028822fef1c230963535a90d\r\nDec 29 17:50:50 bitcoin bitcoind[567]: 2018-12-29T17:50:50Z Using the 'sse4(1way),sse41(4way),avx2(8way)' SHA256 implementation\r\nDec 29 17:50:50 bitcoin bitcoind[567]: 2018-12-29T17:50:50Z Using RdRand as an additional entropy source\r\nDec 29 17:50:56 bitcoin bitcoind[567]: 2018-12-29T17:50:56Z ERROR: Error while attempting to lock directory /mnt/bitcoin/bitcoind/data/: No locks available\r\nDec 29 17:50:56 bitcoin bitcoind[567]: 2018-12-29T17:50:56Z Error: Cannot obtain a lock on data directory /mnt/bitcoin/bitcoind/data/. Bitcoin Core is probably already running.\r\nDec 29 17:50:56 bitcoin bitcoind[567]: Error: Cannot obtain a lock on data directory /mnt/bitcoin/bitcoind/data/. Bitcoin Core is probably already running.\r\n```\r\n```\r\n# data directory lock\r\nls -ahl\r\ntotal 12M\r\ndrwxrwx--- 5 bitcoin bitcoin   11 Dec 29 09:53 .\r\ndrwxrwx--- 3 bitcoin bitcoin    3 Dec 29 07:22 ..\r\n-rw-rw---- 1 bitcoin bitcoin  12K Dec 29 07:22 banlist.dat\r\ndrwxrwx--- 3 bitcoin bitcoin 2.9K Dec 29 08:03 blocks\r\ndrwxrwx--- 2 bitcoin bitcoin 1.4K Dec 29 08:08 chainstate\r\n-rw-rw---- 1 bitcoin bitcoin 9.6M Dec 29 07:22 debug.log\r\n-rw-rw---- 1 bitcoin bitcoin 243K Dec 29 07:22 fee_estimates.dat\r\n-rw------- 1 bitcoin bitcoin    0 Dec 29 09:50 .lock\r\n-rw-rw---- 1 bitcoin bitcoin 6.4M Dec 29 07:22 mempool.dat\r\n-rw-rw---- 1 bitcoin bitcoin 4.7M Dec 29 07:22 peers.dat\r\ndrwxrwx--- 4 bitcoin bitcoin   13 Dec 29 08:12 testnet3\r\n```",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 0,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15058/comments",
   "created_at" : "2018-12-29T17:57:29Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15058/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/15058",
   "id" : 394813517,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15058/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDU6SXNzdWUzOTQ4MTM1MTc=",
   "number" : 15058,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "Cannot lock data directory over NFS [0.17.1][0.17.0.1]",
   "updated_at" : "2018-12-29T22:36:51Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15058",
   "user" : {
      "avatar_url" : "https://avatars1.githubusercontent.com/u/5635253?v=4",
      "events_url" : "https://api.github.com/users/cluelessperson/events{/privacy}",
      "followers_url" : "https://api.github.com/users/cluelessperson/followers",
      "following_url" : "https://api.github.com/users/cluelessperson/following{/other_user}",
      "gists_url" : "https://api.github.com/users/cluelessperson/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/cluelessperson",
      "id" : 5635253,
      "login" : "cluelessperson",
      "node_id" : "MDQ6VXNlcjU2MzUyNTM=",
      "organizations_url" : "https://api.github.com/users/cluelessperson/orgs",
      "received_events_url" : "https://api.github.com/users/cluelessperson/received_events",
      "repos_url" : "https://api.github.com/users/cluelessperson/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/cluelessperson/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/cluelessperson/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/cluelessperson"
   }
}
