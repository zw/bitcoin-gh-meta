[
   {
      "body" : "IIRC, the first step that was proposed was to send along the full TXID list. That's already a big improvement on the current state of things (the entire transactions are in the blocks right now), while providing all the information needed to fetch whatever is missing.",
      "created_at" : "2014-02-27T15:12:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3754#issuecomment-36251413",
      "id" : 36251413,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3754",
      "updated_at" : "2014-02-27T15:12:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/36251413",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/566354?v=3",
         "events_url" : "https://api.github.com/users/christophebiocca/events{/privacy}",
         "followers_url" : "https://api.github.com/users/christophebiocca/followers",
         "following_url" : "https://api.github.com/users/christophebiocca/following{/other_user}",
         "gists_url" : "https://api.github.com/users/christophebiocca/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/christophebiocca",
         "id" : 566354,
         "login" : "christophebiocca",
         "organizations_url" : "https://api.github.com/users/christophebiocca/orgs",
         "received_events_url" : "https://api.github.com/users/christophebiocca/received_events",
         "repos_url" : "https://api.github.com/users/christophebiocca/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/christophebiocca/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/christophebiocca/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/christophebiocca"
      }
   },
   {
      "body" : "As this is more of a theoretical-level brainstorming proposal for the protocol I think you'd have more success on the mailing list than here.\r\n\r\nRequesting the TXID list for a block instead of receiving the entire block sounds like an optimization that could help reduce bandwidth up to 50% in case all the transactions were in the local mempool already. It would also possibly speed up the block propagation (less data is transferred BUT an extra roundtrip is needed). P2P protocol support would be needed to receive a list of individual transactions from a block to fill in the missing ones.\r\n\r\nNot sure about your query idea of tracking transactions seen by other nodes, that sounds like a lot of extra complexity for little gain. P2P protocols gain from being as simple as possible to avoid complex failure chains and abuses.\r\n",
      "created_at" : "2014-03-04T09:30:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3754#issuecomment-36606162",
      "id" : 36606162,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3754",
      "updated_at" : "2014-03-04T09:30:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/36606162",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "This is essentially about finding the right balance between bandwidth usage and latency.\r\n\r\nIf you have very high bandwidth between nodes, but low latency, then you probably just want to send the entire block, as first sending the txid list and letting the peer query the wanted transactions introduces an extra roundtrip.\r\n\r\nI actually experimented with using BIP37 for this purpose (request filtered blocks but with 100% filter), and it was both buggy and very slow. The problem was that the sender doesn't relay transactions again if it know they are already sent, but by the time the receiver requests a block, it may already have forgotten about them. The slowness was likely due to the per-block extra latency.",
      "created_at" : "2014-03-04T13:01:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3754#issuecomment-36621367",
      "id" : 36621367,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3754",
      "updated_at" : "2014-03-04T13:01:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/36621367",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Keeping the P2P protocol simple is a good point. I am wondering whether there are any efforts that play around with different block transmission schemes? \r\n\r\nWould it be possible to implement this in a more open way to be able to have the nodes configure for themselves the most efficient way to transport blocks and to have more experimentation? Like an interface to advertise 'block synchronization capabilities'? This way, people who want to try more experimental schemes of block synchronization could do so, while the main network is stable. High bandwidth nodes could simply clamp down all capabilities so that block synchronization happens just as it does now, whole blocks and no optimizations.\r\n\r\nOr would you worry then that too many people 'become experimental' and the complexity would expose the network to a potential exploit/DDOS attack?\r\n\r\nAlong another line of thought, I am wondering whether it would be a good idea/feasible/wanted to have an interface into the code that would allow to safely query the TXN cache and other potential sources of information that could help in reducing network bandwidth (purely read only) - and have a single method to inject 'new block data'? The injected data would then be hashed and the block hash compared to the injection and that way, this 'block sync injection method' should not adversely affect the main functionality of bitcoin? To be really sure, the injection method could also be rate limited - so in the case that the block injection fails/the block injection network/client goes rogue etc. the main client would fall back onto its usual block transmission scheme. \r\n\r\nI am thinking about something where one then could maybe even write something that is completely external to the main bitcoin client for block sync? Could the RPC interface be extended to allow that? Would it be a good idea?",
      "created_at" : "2014-03-20T18:05:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3754#issuecomment-38201093",
      "id" : 38201093,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3754",
      "updated_at" : "2014-03-20T18:05:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/38201093",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6801193?v=3",
         "events_url" : "https://api.github.com/users/bc-cb/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bc-cb/followers",
         "following_url" : "https://api.github.com/users/bc-cb/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bc-cb/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bc-cb",
         "id" : 6801193,
         "login" : "bc-cb",
         "organizations_url" : "https://api.github.com/users/bc-cb/orgs",
         "received_events_url" : "https://api.github.com/users/bc-cb/received_events",
         "repos_url" : "https://api.github.com/users/bc-cb/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bc-cb/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bc-cb/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bc-cb"
      }
   },
   {
      "body" : "@bc-cb : you mean initial block sync or optimizing the broadcasting of new blocks?\r\n\r\nI did some thinking about optimizing new block broadcasts a few days ago:  https://gist.github.com/gavinandresen/9603614\r\n",
      "created_at" : "2014-03-20T18:10:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3754#issuecomment-38201728",
      "id" : 38201728,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3754",
      "updated_at" : "2014-03-20T18:10:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/38201728",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "@gavinandresen: Oh, cool! So the main devs are working on it :-)\r\n\r\nYes, I meant broadcasting of new blocks. Initial block (re-)sync, I guess rsync etc. could be used? I was pondering about this for a while, due to the high impact on the orphan cost. I read and understood most of the Bitcoin code, but did not yet work on it, so my experience is quite limited - and I would like to know what's going on and what the sentiment is before even starting to even try to implement a patch.\r\n\r\nRegarding the more efficient block broadcast: I was thinking about having a flexible scheme where adjacent nodes could potentially apply even more sophisticated selectors to the block transmission, such as 'collect all txns from aaabc.. up to cde345..'  or 'all txns with fees in the range xxx ... yyy' or combinations thereof - a have a scheme with potentially multiple round trips.\r\n\r\nOf course, this is a lot of complexity and might be completely unneeded and even detrimental to the stability or performance of the network, would it be supported by default. I am thus rather wondering whether it would be possible to have an extension mechanism (maybe through the RPC interface?) to allow bolting on (lets say maybe in an external python process) a 'block transmitter' onto the core client, that it could use with a fall back to the default, full-block transmission?",
      "created_at" : "2014-03-21T04:52:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3754#issuecomment-38249111",
      "id" : 38249111,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3754",
      "updated_at" : "2014-03-21T04:52:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/38249111",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6801193?v=3",
         "events_url" : "https://api.github.com/users/bc-cb/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bc-cb/followers",
         "following_url" : "https://api.github.com/users/bc-cb/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bc-cb/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bc-cb",
         "id" : 6801193,
         "login" : "bc-cb",
         "organizations_url" : "https://api.github.com/users/bc-cb/orgs",
         "received_events_url" : "https://api.github.com/users/bc-cb/received_events",
         "repos_url" : "https://api.github.com/users/bc-cb/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bc-cb/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bc-cb/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bc-cb"
      }
   },
   {
      "body" : "@bc-cb For initial sync, we only care about maximizing bandwidth (not latency), and there are no separately-relayed transactions to consider reusing (as they wouldn't be accepted anyway). That means that for initial sync, downloading full blocks is by far the best option - anything fancy will just complicate things without benefit.\r\n\r\nFor downloading new blocks, we really do care about latency as it impacts propagation speed across the network. The question about whether full blocks or something more fancy is better depends on the ratios of bandwidth, latency, block size, processing speed, .... See my comments on @gavinandresen's gist.",
      "created_at" : "2014-03-21T18:18:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3754#issuecomment-38306596",
      "id" : 38306596,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3754",
      "updated_at" : "2014-03-21T18:18:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/38306596",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Closing, because I've started thinking the issues list shouldn't contain \"it'd be nice if...\" stuff.\r\n\r\nGoogle search for all the recent discussion on IBLTs and Matt's fast relay code for current thinking.",
      "created_at" : "2014-10-28T18:49:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3754#issuecomment-60810310",
      "id" : 60810310,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3754",
      "updated_at" : "2014-10-28T18:49:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60810310",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   }
]
