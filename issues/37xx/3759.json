{
   "assignee" : null,
   "body" : "See this report: https://bitcoin.stackexchange.com/questions/22716/bitcoind-sendfrom-round-amount-error\r\n\r\nI've been unable to reproduce it in either master or 0.8.6. However, in theory this could happen on architectures that have imprecise floating point types. Even though bitcoind itself doesn't rely on floating point types anywhere, Spirit JSON does use doubles internally for parsing values like 123.456 (and so do we in ValueFromAmount / AmountFromValue).\r\n\r\nMy first attempt was to try to fix this and make the parser use a fixed-point or string representation for JSON numbers (ie https://github.com/bitcoin/bitcoin/blob/master/src/json/json_spirit_reader_template.h#L499 ), but turned out to be a deep rabbit hole and doesn't solve the issue at the client side.\r\n\r\nSo this is my solution: add an option `-rpcstringamounts` to represent monetary amounts as strings in RPC. With this option any monetary amount will be emitted as a string with fixed 8 decimals, very easy to parse. Also this changes the parsing to accept the same format (by using the existing ParseMoney function).\r\n\r\nExample getinfo:\r\n\r\n    {\r\n        ...\r\n        \"balance\" : \"0.29099995\",\r\n        ...\r\n    }\r\n\r\nCommits should be self-documenting.\r\n",
   "closed_at" : "2014-06-12T11:58:22Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
      "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
      "followers_url" : "https://api.github.com/users/laanwj/followers",
      "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/laanwj",
      "id" : 126646,
      "login" : "laanwj",
      "organizations_url" : "https://api.github.com/users/laanwj/orgs",
      "received_events_url" : "https://api.github.com/users/laanwj/received_events",
      "repos_url" : "https://api.github.com/users/laanwj/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/laanwj"
   },
   "comments" : 20,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3759/comments",
   "created_at" : "2014-02-27T10:57:10Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3759/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/3759",
   "id" : 28409874,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3759/labels{/name}",
   "locked" : false,
   "milestone" : {
      "closed_at" : null,
      "closed_issues" : 112,
      "created_at" : "2013-12-05T10:34:42Z",
      "creator" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      },
      "description" : "",
      "due_on" : null,
      "id" : 505738,
      "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/milestones/14/labels",
      "number" : 14,
      "open_issues" : 2,
      "state" : "open",
      "title" : "0.10.0",
      "updated_at" : "2015-01-23T15:33:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/milestones/14"
   },
   "number" : 3759,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/3759.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3759",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/3759.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3759"
   },
   "state" : "closed",
   "title" : "Add option `-rpcamount` for monetary amounts as strings/satoshis in RPC",
   "updated_at" : "2015-01-15T14:52:13Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3759",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
      "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
      "followers_url" : "https://api.github.com/users/laanwj/followers",
      "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/laanwj",
      "id" : 126646,
      "login" : "laanwj",
      "organizations_url" : "https://api.github.com/users/laanwj/orgs",
      "received_events_url" : "https://api.github.com/users/laanwj/received_events",
      "repos_url" : "https://api.github.com/users/laanwj/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/laanwj"
   }
}
