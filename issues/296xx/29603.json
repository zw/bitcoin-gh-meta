{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "NONE",
   "body" : "### Please describe the feature you'd like to see added.\r\n\r\nBetter default settings, or fix to database cache handling\r\n\r\n### Is your feature related to a problem, if so please describe it.\r\n\r\nWhen doing IBD using default settings, on a relatively fast machine on relatively fast HDD everything works well until ~when segwit was activated. After that ETA estimate shot up from 4 days to 3 weeks. Investigating, my 1MB/s internet was downloading only about 15% of the time. The operating system became extremely laggy, and i found that the HDD was stuck on 100% IO load, doing 4-6MB/s read, plus the normal occasional writes for downloaded parts.\r\n\r\nI tried increasing db cache by 2x to 900MB, but absolutely nothing changed. RAM usage etc. same.\r\n\r\nSearching for issues i found that many \"fixed\" it by putting chainstate on SSD. This was not an option, so i started looking into putting it into a ramdrive. But then in a random comment about using a ramdrive someone said using more than 8000 dbcache makes the full chainstate fit into ram, essentially achieving the same. I was skeptical, since doubling it had not made any difference. But i decided to test it with 8500.\r\n\r\nAnd Bitcoin started working perfectly. Continuous download, low IO load, much faster write throughput. Something bordering unusable became smooth. So why is this a feature request instead of \"that's expected with such high db cache\"\r\n\r\nBecause even a device with only 3 gigs of ram can use a value of 8500 and start working well, instead of being useless. It takes something like 8 hours before bitcoin's RAM usage reaches 3 gigs when syncing at 1MB/s. And at this point one can restart bitcoin which frees the ram, and sync for another 8 hours.\r\n\r\nThis is very weird that there exists an undocumented \"threshold\" where dbcache's operation changes completely, starting to work as an actual cache, freeing the HDD from doing constant small random read operations.\r\n\r\n### Describe the solution you'd like\r\n\r\njust drop dbcache setting completely, let it grow as needed and when RAM starts to get full, just flush it as if restarting bitcoin. I wonder how many HDD:s have broken down due to weeks long constant 100% random read IO stress due to this issue, and how many users gave up on the idea of running a node because they thought their machine is not up to the task.\r\n\r\n### Describe any alternatives you've considered\r\n\r\nchange default setting to the minimum value that can support proper cache behavior after segwit blocks. Warn user that reducing the cache will cause extreme slowdown and disk stress when doing IBD after segwit blocks start, practically only doable with SSD.",
   "closed_at" : "2024-03-18T17:30:04Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/6353462?v=4",
      "events_url" : "https://api.github.com/users/reivanen/events{/privacy}",
      "followers_url" : "https://api.github.com/users/reivanen/followers",
      "following_url" : "https://api.github.com/users/reivanen/following{/other_user}",
      "gists_url" : "https://api.github.com/users/reivanen/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/reivanen",
      "id" : 6353462,
      "login" : "reivanen",
      "node_id" : "MDQ6VXNlcjYzNTM0NjI=",
      "organizations_url" : "https://api.github.com/users/reivanen/orgs",
      "received_events_url" : "https://api.github.com/users/reivanen/received_events",
      "repos_url" : "https://api.github.com/users/reivanen/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/reivanen/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/reivanen/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/reivanen"
   },
   "comments" : 8,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29603/comments",
   "created_at" : "2024-03-08T16:34:45Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29603/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/29603",
   "id" : 2176381162,
   "labels" : [
      {
         "color" : "981023",
         "default" : false,
         "description" : null,
         "id" : 326918230,
         "name" : "Resource usage",
         "node_id" : "MDU6TGFiZWwzMjY5MTgyMzA=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Resource%20usage"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29603/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "I_kwDOABII586BuPDq",
   "number" : 29603,
   "performed_via_github_app" : null,
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29603/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "state_reason" : "completed",
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29603/timeline",
   "title" : "Current default settings are broken, some fix is needed",
   "updated_at" : "2024-03-18T17:30:04Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29603",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/6353462?v=4",
      "events_url" : "https://api.github.com/users/reivanen/events{/privacy}",
      "followers_url" : "https://api.github.com/users/reivanen/followers",
      "following_url" : "https://api.github.com/users/reivanen/following{/other_user}",
      "gists_url" : "https://api.github.com/users/reivanen/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/reivanen",
      "id" : 6353462,
      "login" : "reivanen",
      "node_id" : "MDQ6VXNlcjYzNTM0NjI=",
      "organizations_url" : "https://api.github.com/users/reivanen/orgs",
      "received_events_url" : "https://api.github.com/users/reivanen/received_events",
      "repos_url" : "https://api.github.com/users/reivanen/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/reivanen/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/reivanen/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/reivanen"
   }
}
